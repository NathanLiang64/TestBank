      *@(#) LAST UPDATED ON 25/06/20 AT 10:21:05
      *@(#) THIS FILE OBTAINED FROM
      *@(#)    /fns/sccs/x/r/cob/s.BR0000.COB
      *@(#)    ON 25/07/17 AT 18:02:42
000010*** Start of PVCS Information *************************
000020* $Archive:   //fnssnap1/pvcs$/archives/Retail/cob/BR0000.COB-arc
000030* $Revision:   1.2  $
000040* $Modtime:   Sep 08 2001 12:47:56  $
000050* $Author:   pvcs  $
000060* $Date:   Sep 08 2001 14:35:42  $
000070* $Log:   //fnssnap1/pvcs$/archives/Retail/cob/BR0000.COB-arc  $
000080*
000090*   Rev 1.2   Sep 08 2001 14:35:42   pvcs
000100*Initial check in. BANCS 8.0 T
000110*** End of PVCS Information ***************************
000120*@(#) BR0000.COB version 80.23
000130*@(#) last updated on 01/08/09 at 14:33:03
000140*@(#) This file obtained from
000150*@(#)    /fns/sccs/t/r/cob/s.BR0000.COB
000160*@(#)    on 01/09/08 at 12:21:46
000170******************************************************************
000180*   (C) COPYRIGHT FINANCIAL NETWORK SERVICES PTY LTD. 1982       *
000190*       ALL RIGHTS RESERVED. NO PART OF THIS PROGRAM MAY         *
000200*       BE PHOTOCOPIED, REPRODUCED, TRANSLATED TO ANOTHER        *
000210*       PROGRAM LANGUAGE OR USED IN ANY WAY WITHOUT THE          *
000220*       PRIOR WRITTEN CONSENT OF FINANCIAL NETWORK SERVICES      *
000230*       OR THE AUTHORISED SELLING AGENT.                         *
000240*----------------------------------------------------------------*
000250*             FINANCIAL NETWORK SERVICES PTY LTD.                *
000260*               UNIT 6/70 ROSEHILL ST., REDFERN, 2016            *
000270*                   SYDNEY, AUSTRALIA.                           *
000280*                     TEL. 02-318-1088                           *
000290*                     FAX. 02-319-0008                           *
000300******************************************************************
000310******************************************************************
000320***                                                            ***
000330***  SYSTEM:- LOANS PRIMARY UPDATE                             ***
000340***                                                            ***
000350***  MODULE:- BR0000                                           ***
000360***                                                            ***
000370***  PROGRAM:-BR0000                                           ***
000380***                                                            ***
000390***  PURPOSE:-TO PROVIDE THE COMMON PROCESSING FOR             ***
000400***            ALL THE TRANSACTIONS RELATED TO THE LOANS       ***
000410***            SYSTEM. IT DOES ALL PRIMARY EDITING             ***
000420***            BEFORE PASSING THE TRNS TO INDIVIDUAL           ***
000430***            MODULES.  RESTART LOGGING AND CASHIER           ***
000440***            TOTALLING ETC ARE DONE IN THIS                  ***
000450***            PROGRAM. THE PROGRAM ALSO PASSES                ***
000460***            CONTROL TO SECOND UPDATE MODULE                 ***
000470******************************************************************
000480*                 P R O G R A M    H I S T O R Y
000490*  PROGRAMMERS INITIALS TOGETHER WITH THE "SPR" NUMBER MUST BE
000500*  REFLECTED IN COLUMNS 73-80 OF EVERY LINE/S CHANGED OR ADDED.
000510*
000520* PROGRAMMER : DATE :SPR NO :COMMENTS
000530*---------------------------------------------------------------
000540* K BOURKE   :020191:TSB 0052: PREVENT SPACE FOR JRNL 13507 AMT
000550*--------------------------------------------------------------
000560* R STUART   :300191: 4443   : IMPLEMENT PPP (MORT INS. DR)
000570*-------------------------------------------------------------
000580* R STUART   :050291: 4443   : RECALC DUES WHEN APPROV. AMT <>
000590*            :      :        :  APPLIC. AMT (ON APPROVL TXNS)
000600*-------------------------------------------------------------
000610* A GUESRY   :140391: 4475   : TO CATER FOR CROSS SELLING OF A
000620*            :      :        : SYSTEM
000630*-------------------------------------------------------------
000640* M DOWLING  :040291:  4903  : ADD NEW LOANS TXNS:
000650*            :      :        :   13033 : CREDIT PRINC ADJ
000660*            :      :        :   13051 : ARREARS PENALTY
000670*            :      :        :   13052 : PPP PREMIUM
000680*            :      :        :   13053 : DEBIT PRINC ADJ
000690*            :      :        :   13034 : ARREARS PENALTY REVERSAL
000700*            :      :        :   13035 : PPP PREMIUM CR ADJUST
000710*--------------------------------------------------------------
000720* R CHANDLER :180491: 4487   : TO CORRECT ERROR IN MOD. LON016
000730*----------------------------------------------------------------
000740* A GUESRY   :090591 : 5010  : INCREASE FIELD SIZES
000750*            :       :       : MODIFY DBIO CALLS
000760*            :       :       : MODIFY UT0020, UT0030 CALLS
000770*---------------------------------------------------------------
000780* A GUESRY   :260692 :UN0001 : TSB RETROFITS
000790*----------------------------------------------------------------
000800* ROBIN BALL :270593 :040136 : INITIALIZE AREAS WITH BINARY FIELDS
000810*---------------------------------------------------------------
000820* A GUESRY   :140793 :580138 : RELEASE 6.1
000830*------------------------------------------------------------
000840* ALAN PHUNG :190893 :580138 : RELEASE 6.1 BUGS FIX.
000850*            :       :       : -SETUP UT0460CA-COMMISSION-IND.
000860*------------------------------------------------------------
000870* S BURMAN   :231293 :610188 : RELEASE 6.1 BUGS FIX.
000880*            :       :       : -MOVE SAVE SO ALWAYS DONE
000890*------------------------------------------------------------
000900* A GUESRY   :210194 :610235 : LOANS PHASE II
000910*            :       :       : SPLIT APPROVAL, ADVANCE &
000920*            :       :       : DISCHARGE INTO BR0017,BR0024 &
000930*            :       :       : BR0025 RESPACE.TIVELY.
000940*            :       :       : RENAME BR0010,BR0024 TO BR0023 &
000950*            :       :       : BR0044.
000960*------------------------------------------------------------
000970* S FOWLER   :050294 :610298 : SET LANG-CODE PRIOR TO UT0500 CALL
000980*                            : TO ENSURE INST-LANG RECS RETRIEVED
000990*------------------------------------------------------------
001000* P O'KELLY  :220394 :PIBA R7: CALL BR0054 FRO TRANCODE 15073
001010*------------------------------------------------------------
001020* F WENCESLAO:230394 :610355 : FIX ATM REFRESH FOR TELEP
001030*------------------------------------------------------------
001040* L WALFORD  :060494 :610393 : 1) FIX THE END BROWSE FS0401
001050*                            : 2) FIX INITIALISATION OF UT0069
001060*                            : WHEN LOANS TRACKING SET TO
001070*                            : 'NO'.
001080*------------------------------------------------------------
001090* L CARPENTER:180494 :620007 : LOANS AUTOMATED CHARGING
001100*------------------------------------------------------------
001110* A LIM      :260494 :R8 2011: CHANGE PL-APPL-DATE TO RENEWAL DATE
001120*-----------------------------------------------------------------
001130* F WENCESLAO:030594 :610404 : RETROFIT CHANGES TO FIX BUG
001140*            :       :       : IN MULTI-CURRENCY PROCESSING
001150*------------------------------------------------------------
001160* P O'KELLY  :030594 :R5 2016: LOAN TYPE CHANGE-TRN CODE 17029
001170*--------------------------------------------------------------
001180* L CARPENTER:180894 :620021 : INCREASE SIZE OF 32100
001190*--------------------------------------------------------------
001200* ALAN PHUNG :180894 :620021 : UPDATE BORM-LST-ARR-DATE WHEN
001210*            :       :       : ACCOUNT CHANGES FROM NON-ARREARS
001220*            :       :       : TO ARREARS STATUS.
001230*-----------------------------------------------------------------
001240* F WENCESLAO:240894 :620022 : ADD FACILITY NO TO SCRN 12000/17000
001250*            :       :       : ADD CALL TO CI0012 TO LOAD FACILITY
001260*            :       :       : PARAMETERS
001270*-----------------------------------------------------------------
001280* ALEX LIM   :111094 : 2037  : RATE TABLE IMPLEMENTATION, ADD CALL
001290*            :       :       : TO UT0298 TO GET EFFECTIVE RATE
001300*-----------------------------------------------------------------
001310* SIE YOU TAN:130994 :620050 : INCREASE SIZE OF W100-DATE-FILE
001320*            :       :       : (OCCURS 120 TIMES) ADJUST THE CODE
001330*            :       :       : ACCORDINGLY.
001340*            :       :       : ADD STATUS CHECK BEFORE CALLING
001350*            :       :       : UT0019.
001360*-----------------------------------------------------------------
001370* M OMRAN    :200994 :620038 : ADD TRANSACTION 17465 TO BE CHECKED
001380*            :       :       : TO  CALL BR0001
001390*-----------------------------------------------------------------
001400* B AQABANI  :270994 :620069 : STOP TRANSACTION 10400 (LOANS SHORT
001410*            :       :       : ENQUIRY) FROM UPDATING (CASHIER
001420*            :       :       : TOTALS FILE CASI)
001430*-----------------------------------------------------------------
001440* MISHA T.   :300994 :620075 :  NEW REDEFINITIONS FOR INPUT AND
001450*            :       :       :  OUTPUT MESSAGE AREAS IN START
001460*            :       :       :  AREA - LINKAGE SECTION AND FOR
001470*            :       :       :  APPROPRIATE AREAS IN WORKING-STR.
001480*            :       :       :  SECTION FOR SCREENS  17451, 12000
001490*            :       :       :  AND 17000.
001500*-----------------------------------------------------------------
001510* D MORTENSEN:211094 : 2038  : REMOVE FULL-STOP IN E300- SO
001520*            :       :       : CASHIER STATUS IS ONLY CHECKED WHEN
001530*            :       :       : UT0019 IS CALLED
001540*-----------------------------------------------------------------
001550* ADEL SERHAN:271094 :620085 : CONSTRUCT LOAN ACCEPTANCE TXN 12440
001560*            :       :       : WHICH CHANGES BORM-STAT FROM 3 TO
001570*            :       :       : 5 AND CHANGE BORM-STAT VALUES.
001580*-----------------------------------------------------------------
001590* S LEE      :021194 : 2038  : DO NOT CALL FT0000 ,IF TXN COMES
001600*            :       :       :  FROM LM0000.
001610*-----------------------------------------------------------------
001620* S LEE      :151194 : 2038  : PUT "BR0054" PLACE BEFORE CHECKING
001630*            :       :       :  FINANCIAL TRANSACTION.
001640*-----------------------------------------------------------------
001650* ADEL SERHAN:061294 :620085 : MODIFY LOAN ACCEPTANCE TXN SO THAT
001660*            :       :       : LOAN ADVANCE REQUIRES ACCEPTANCE
001670*            :       :       : FOR SOME PRODUCTS WHILE ACCEPTANCE
001680*            :       :       : IS NOT NECESSARY FOR OTHERS.
001690*-----------------------------------------------------------------
001700* F WENCESLAO:301294 :620146 : INITIALIZE BR0011 AT STARTUP
001710*-----------------------------------------------------------------
001720* ALAN B     :311294 :620143 : ADDTL RTN TO SEE THAT ENTERD CHECK
001730*   VELASQUEZ                :  NO MATCHES THAT ON THE EXISTING
001740*                            :  RECORD
001750*-----------------------------------------------------------------
001760* C WHITELEGG:190195 :630041 : DO NOT ALLOW ZERO AMOUNT TXNS
001770*            :       :       : EVEN WITH SUPERVISOR OVERRIDE
001780*-----------------------------------------------------------------
001790* MISHA.T.   :180195 : 630030: PASING "0" TO UT0500 AS
001800*                              INSTITUTION'S LANGUAGE CODE.
001810*-----------------------------------------------------------------
001820* F WENCESLAO:250195 :630050 : BUG FIX ON NAME DISPLAYS FOR TRAN
001830*            :       :       : 17001, 17002 AND 17003 - IR 139.
001840*-----------------------------------------------------------------
001850* ADEL SERHAN:260195 : 620124: INCREESING THE OUTPUT LENGTH OF
001860*                              SCR17000 FROM 486 TO 503
001870*-----------------------------------------------------------------
001880* BRIAN COLE :310195 : 630010: ADD TRAN 10909 (AUTO DUES RESPONSE)
001890*-----------------------------------------------------------------
001900* MISHA.T.   :310195: 631012: BYPASSING A JOURNAL NUMBER MATCHING
001910*                             FOR OFF-LINE CORRECTION TRANSACTION,
001920*                             IF HAS NOT BEEN ENTERED.
001930*-----------------------------------------------------------------
001940* B G COLE   :070295: 631011: ADD PROCESSING FOR POST-TIME
001950*-----------------------------------------------------------------
001960* A GUESRY   :170295: 631015 : CORRECTLY PROCESS BORM-LST-ARR-DATE
001970*-----------------------------------------------------------------
001980* A GUESRY   :210295: 631015 : ACCOUNT ARREARS CONDITION ENQUIRY
001990*-----------------------------------------------------------------
002000* ADEL SERHAN:270295: 620124: ADDING A CALL FOR  BR0027  TO TXN
002010*                             17090, 17040,17041,17042.
002020*-----------------------------------------------------------------
002030* S LEE      :030395: 630070 : TO ADD JOURNAL FOR BACKDATED TXN
002040*-----------------------------------------------------------------
002050* B AQABANI  :080395: 620124 : ADD NEW TRANSACTION 10121
002060*            :      :        : LOANS CHEQUE REPAYMENT DISHONOUR)
002070*-----------------------------------------------------------------
002080* J BRADLEY  :080395: 630066 : 3RD CALL TO BR0011 - NO SUBSCRIPTS
002090*-----------------------------------------------------------------
002100* SIE YOU TAN:300395: 630083: ADD INTEREST CATAGORY FOR ATMS     *
002110*----------------------------------------------------------------*
002120* ALEX LIM   :070495: 640006 : MULTI CURRENCY - ERROR 850
002130*-----------------------------------------------------------------
002140* AYAD       :100495: 620124 : ADDING MULTI-OVERRIDE-AREA WHENEVER
002150*            :      :        :  CALLING BR0025.
002160*            :      :        : ADDING TWO FIELDS TO DISCH. AREA.
002170*            :      :        : REWRITE BORM FOR TR. NO. 13000.
002180*            :      :        : EXCEMPT DISCH.  FROM ERR 168.
002190*----------------------------------------------------------------
002200* B AQABANI  :190495: 620124: ADD PROCESSING FOR RE-DRAW TRNS
002210*                             + MOVE CORRECT FIELDS TO LETTER
002220*-----------------------------------------------------------------
002230* AYAD       :030595: 620124 : - READ BORV AND ACCUMULATES LOANS
002240*            :      :        :   REPAYMENTS
002250*            :      :        : - FIX AND USE CORR. IN DISCH ENQ
002260*---------------------------------------------------------------
002270* ALEX LIM   :040595: 700016 : TXN 15073 FIX JOURNAL FOR SY1000
002280*-----------------------------------------------------------------
002290* WALDO VELEZ:080595: ANZ005 : CREATE NEW TRANSACTION 10732 AND
002300*            :      :        : ADD NEW SCREEN 10732 FOR
002310*            :      :        : LOAN INTEREST ADJUSTMENT
002320*-----------------------------------------------------------------
002330* BRIAN COLE :160595: ANZ006 : CALL BR0001 FOR TRAN 17043
002340*-----------------------------------------------------------------
002350* MUBARIK ALI:160595: FPB001 : ADD NEW OPTION FOR ACCOUNT GROUP NO
002360*            :      :        : WHEN CALLING "UT5001".
002370*-----------------------------------------------------------------
002380* REINALOD C.:190595: 630015 : IMPLEMENTATION OF LOAN DECLINE
002390*            :      :        : LETTER
002400*-----------------------------------------------------------------
002410* BRIAN COLE :220595: ANZ006 : ERROR MSG FOR POSTING RESTRICTIONS
002420*-----------------------------------------------------------------
002430* B ASHWIN   :310595: ANZ003 : ADDED EXTRA CALL PARMS FOR UT0298
002440*            :      :        : ADDED CALL TO UT0018 FOR TRAN CODE
002450*            :      :        : 10422.
002460*-----------------------------------------------------------------
002470* BRIAN COLE :280695: ANZ006 : FIX BUG IN POSTING RESTRICTIONS
002480*-----------------------------------------------------------------
002490* A GUESRY   :290695: ANZ005 : FIX BUG IN LOAN INTEREST ADJUSTMENT
002500*-----------------------------------------------------------------
002510*K HUTCHINSON:020795: ANZ020 : ALTER CALL FOR UT0151.
002520*-----------------------------------------------------------------
002530*ADEL SERHAN :020895: 700029 : CHANGING THE GL-TXN-AREA TO A COPY
002540*            :      :        : BOOK (INPUT-MSG-GL).
002550*-----------------------------------------------------------------
002560* BRIAN COLE :020895: ANZ019 : SIMPLIFY CALL TO SY10SEND FOR
002570*                              JOURNAL FILE TO DATABASE CHANGE
002580*-----------------------------------------------------------------
002590*K HUTCHINSON:030895: ANZ020 : ADD INSPARM TO UT0016 LINKAGE.
002600*-----------------------------------------------------------------
002610* ADEL SERHAN:040895 :700029 : CONSTRUCT LOAN ACCEPTANCE CORRECTIO 
002620*            :       :       : TXN 12441 WHICH CHANGES BORM-STAT
002630*            :       :       : FROM 5 TO 3 .
002640*-----------------------------------------------------------------
002650*K HUTCHINSON:080895: ANZ020 : ALTER CALL TO UT5001.
002660*-----------------------------------------------------------------
002670*PS SUDHAKAR :100895 :ANZ023 : WRITE JOURNAL FOR SIGN CHANGE IN
002680*            :       :       : LOAN A/C BALANCE AND  GLCC
002690*            :       :       : IN THE JOURNAL ENTRY.
002700*-----------------------------------------------------------------
002710* BRIAN COLE :140895: ANZ019 : CHANGE JOURNAL TO A DATABASE FILE
002720*-----------------------------------------------------------------
002730* S KENNEDY  :170895: ANZ028 : INCREASE WA-OUTPUT-MSG-LENGTH FOR
002740*                            : SCREEN 17050 IN D400-SEND-NEXT
002750*-----------------------------------------------------------------
002760* K CHRISTOS :180895: ANZ311 : SENT THE OK FOR A LOAN REPAYMENT
002770*-----------------------------------------------------------------
002780* J. NELSON  :250895: ANZ038 : CORRECT BR0013 SEND FOR LOANS TRACK
002790*                            : WHEN MULTI-CURR UPDATE IN UT0460
002800*-----------------------------------------------------------------
002810*PS SUDHAKAR :250895: ANZ023 : MOVE INTEREST CATEGORY FOR JOURNAL
002820*                            : AND EDIT MASK GLCC XFER JOURNAL
002830*-----------------------------------------------------------------
002840*K MCALLISTER:290895: ANZ038 : FIX JOHN'S FIX EARLIER.
002850*-----------------------------------------------------------------
002860* K CHRISTOS :300895: ANZ311 : CHANGE TO MAKE B099-EXIT CONSISTENT
002870*-----------------------------------------------------------------
002880* PS SUDHAKAR:010995: ANZ023 : MOVE CURRENCY CODES TO JOURNAL FOR
002890*                            : INTERNAL A/C BAL. XFER TRAN. 98904
002900*----------------------------------------------------------------
002910* PETER HAN :050995 : 700034 : MAKE CHANGES TO THE CHARGE SYSTEM
002920*                            : CALLS SO THAT IT IS CONSISTENT WITH
002930*                            : THAT OF DEPOSIT SYSTEM. BR0023/24
002940*                            : WERE MODIFIED SO THAT THEY ALSO
002950*                            : CALL THE SYSTEM.
002960*----------------------------------------------------------------
002970* AYAD      :060995:730001   : USE INPUT-MSG-GL COPYBOOK
002980*----------------------------------------------------------------
002990* C. GARADO :110995:720002   : REMOVE REFERENCES TO UT0330
003000*----------------------------------------------------------------
003010*D.MORTENSEN:180995:730005: FIX CORRESPONDENCE PRODUCTION CODE.
003020*----------------------------------------------------------------
003030* JOSH HALL :260995: ANZ048  : STATEMENT ON CLOSE ACCOUNT.
003040*----------------------------------------------------------------
003050*ADEL SERHAN:021095:730007: CAFM TABLE IMPLEMENTATION, ADDING CODE
003060*           :      :      : TO GET EFFECTIVE RATE FROM CAFM TABLE
003070*                           IF CERTAIN PARAMETERS ARE SET UP FOR
003080*                           THE PRODUCT.
003090*----------------------------------------------------------------
003100* S KENNEDY  :101095: ANZ056 : RE-WRITE L200-TRANSLATE-DAYS TO
003110*                            : RETRIEVE DAYS FROM CLRD.
003120*-----------------------------------------------------------------
003130* R CHANDLER :121095: ANZ050 : POSTING AND REPORTING RSTRE DESCR.
003140*-----------------------------------------------------------------
003150* ADEL SERHAN:201095: 730046 : ADDING NEW FIELDS TO BORM TABLE
003160*                            : AND MOVE OTHERS TO NEW TABLES
003170*                            : POINTED TO BY FIELDS IN BORM,
003180*                            : (TO MAKE ROOM ON BORM).
003190*-----------------------------------------------------------------
003200*D.MORTENSEN:191095:730113: CORRECTION TO STATEMENT REQUEST ON
003210*                         : DISCHARGE OF ACCOUNT.
003220*-----------------------------------------------------------------
003230* PETER HAN :251095:730033: INSERT CALL TO CHARGE IN L500- PARA
003240*                         : GRAPH, TO HANDLE CORRECTIONS TO ADV
003250*                         : TXNS. THIS IS BECAUSE THE ORIGINAL
003260*                         : TXN MATCHING IS PERFORMED HERE, NOT
003270*                         : IN BR0024. ALSO ADD CS0000CA/RA TO
003280*                         : BR0024 CALLING PARAMETER LIST. FINALLY
003290*                         : ADD W600- IN LINES AFTER B099-EXIT.
003300*-----------------------------------------------------------------
003310* SHRIDHAR J:301095:ANZ061: BUG FIX
003320*-----------------------------------------------------------------
003330* AYAD      :311095:730118: CALL UT0022 AFTER RETURN. FROM BR0025
003340*-----------------------------------------------------------------
003350* MUBARIK ALI:311095:730079: REPLACE DEPPARM FIELDS WITH BORPARM.
003360*-----------------------------------------------------------------
003370* ADEL SERHAN:011195:730109: ADDING CODE FOR LOANS DAILY ARREARS
003380*                          : INTEREST PROCESSING.
003390*-----------------------------------------------------------------
003400* A GUESRY   :021195:730120:VALIDATE PROMO NO. PRIOR TO PROCESSING
003410*            :      :      :AND PASS IN LINKAGE UT0270CA AREA TO
003420*            :      :      :BR0023 & BR0024.
003430*-----------------------------------------------------------------
003440* ADEL SERHAN:091195:730109: FIXING A BUG HBS254,PENDING MESSAGE
003450*                          : OVERRIDING.
003460*-----------------------------------------------------------------
003470* A GUESRY   :091195:730123:PERFORM A COMMIT OF THE DATABASE FOR
003480*            :      :      :NPB'S UPDATED.
003490*-----------------------------------------------------------------
003500* B ASHWIN   :131195:ANZ059:INCLUDE BANK NUMBER AND REGION ID
003510*            :      :      : FIELDS ON CHQ DEPOSITS.
003520*-----------------------------------------------------------------
003530* S KENNEDY  :161195:ANZ068: ADD WA-REPAY-ITEMS DEF. AND VALIDATIO  
003540*-----------------------------------------------------------------
003550* B ASHWIN   :161195:ANZ059:FURTHER CHANGES FOR BANK NUMBER AND
003560*            :      :      : REGION ID FIELDS ON CHQ DEPOSITS.
003570*-----------------------------------------------------------------
003580*MILIND DIGHE:281195:ANZ064:PASS SWIFT REFERENCE NUMBER TO FT0000
003590*-----------------------------------------------------------------
003600* JOSH HALL  :291195:ANZ070: ADDED GENERIC TRANSFER NARRATIVE
003610*            :      :      : FIELD IN INPUT MESSAGE. ADDED
003620*            :      :      : PROCESSING TO POST A TYPE '20'
003630*            :      :      : TRANSACTION.
003640*---------------------------------------------------------------
003650* BRIAN COLE :051295:731046: FIX BUGS IN STAT TOTALS (IR920)
003660*---------------------------------------------------------------
003670* N. PAI     :141295:730179:ALLOW ENQUIRIES WHEN STATUS IS PENDING
003680*                            DISCHARGE OR DISCHARGED
003690*-----------------------------------------------------------------
003700* BRIAN COLE :271295:730195: FIX LOOPING ON LOAN ADVANCE (IR977)
003710*-----------------------------------------------------------------
003720* WALDO VELEZ:020195:ANZ066: REPLACE OTHER CASHIER-TOTAL-FUNCTION
003730*                          : INCLUDE STARTAREA AND SOC-PARAMS IN
003740*                          : UT0019 CALL PARAMETERS
003750*-----------------------------------------------------------------
003760* EMMA HUFFAM:110196:730216: SET UP JNRST-TRAN-DATE FOR GL TXNS
003770*-----------------------------------------------------------------
003780* BRIAN COLE :160196:ANZ076: ADD NEW TRANSACTION 17046 AND 10775
003790*                    730244  IMPACT ON PBIACC FIELD (ANZ IR 1148)
003800*-----------------------------------------------------------------
003810* A GANESH   :050296:730198:WRITE JOURNAL RECORD IF INTEREST IS
003820*                           TRANSFERRED (TR. NO. 13651)
003830*-----------------------------------------------------------------
003840* ADEL SERHAN:220296:730418: FIXING A BUG (I.R # FNS404,HBS295)
003850*                          : LEDGER CODE MANIPULATION + TXN 12411
003860*                          : REINSTATEMENT.
003870*-----------------------------------------------------------------
003880* ADEL SERHAN:290296:730477: FIXING BUG (I.R # FNS470).
003890*-----------------------------------------------------------------
003900* A GUESRY   :290296:730458: FIX CHQ ADVANCE PROCESSING
003910*-----------------------------------------------------------------
003920* ADEL SERHAN:040396:730481: FIXING A BUG HBS300,MAKING ERROR MES.
003930*                          : 139,195 OVERRIDABLE TO ALLOW FOR
003940*                          : REPAYMENT BEFORE ADVANCE OR APPROVAL
003950*                          : AS LONG AS THE REPAYMENT <  BALANCE
003960*-----------------------------------------------------------------
003970* S KENNEDY  :050396:730217: UTILISE UNCL-NO-INT-VAL.
003980*-----------------------------------------------------------------
003990* K CHRISTOS :070396:ANZ067: FNSB25 - EXTERNAL ACOUNTING INTERFACE
004000*-----------------------------------------------------------------
004010* J.NELSON   :070396:730284: IF ERROR FROM SY0010 SEND ERROR 155
004020*-----------------------------------------------------------------
004030* J.NELSON   :070396:730439: DO NOT CALL UT0270 WITH MNMPARM CB
004040*-----------------------------------------------------------------
004050* K CHRISTOS :080396:ANZ067: EXTERNAL ACCOUNTING INTERFACE TO
004060*            :      :      : FINET AND PEOPL SOFT
004070*-----------------------------------------------------------------
004080* C GARADO   :080396:HBS008: ALLOW NOTICE-PROCESS-IND
004090*                            PROCESSING FOR 12000 & 17000
004100*-----------------------------------------------------------------
004110* N. PAI     :150306:730501: UPDATE LAST ARREARS DATE AFTER INT.
004120*                              CALC IN B080 PARA.
004130*-----------------------------------------------------------------
004140* W. MAZIOUN :180396:730322: OVERRIDABLE ERROR MSG IN CASE OF TXN
004150*            :      :      : 12477 AND 12577.
004160*-----------------------------------------------------------------
004170* J MCRAE    :200396:730526: KEEP DISCHARGE AREA IN SYNC WITH
004180*            :      :      : BR0025 CHANGES.  DELETE UNUSED ITEMS.
004190*-----------------------------------------------------------------
004200* H CATLEY   :210396:730600: ZERO JNRST-AMOUNT FOR 12440, 12441
004210*-----------------------------------------------------------------
004220* SURESH BABU:210396:730538: INCREASE BR0001-OUTPUT-MSG-LENGTH,
004230*            :      :      : INCLUDE ABEX IN BR0001-INPUT-MSG AREA
004240*-----------------------------------------------------------------
004250* JOSH HALL  :270396:730436: REMOVE OVERWRITING OF TYPE '01' TXN.
004260*-----------------------------------------------------------------
004270* JOSH HALL  :270369:730475: REMOVE UNCONDITIONAL SETTING OF
004280*            :      :      : INTEREST IN X710.
004290*-----------------------------------------------------------------
004300* J MCRAE    :280396:730526: NEW FIELD WA-INPUT-PROMO-CODE
004310*-----------------------------------------------------------------
004320*K HUTCHINSON:290396:730621: PASS TODAY'S DATE AS TRANSACTION DATE   
004330*            :      :      : UT0069 AFTER CALLING BR0001.
004340*-----------------------------------------------------------------
004350*K HUTCHINSON:290396:730614: ENSURE OTHER JOURNL AMOUNT FIELDS HAV 
004360*            :      :      : SAME SIGN AS JNRST-AMOUNT.
004370*-----------------------------------------------------------------
004380*K MCALLISTER:010496:733010: FIX PROBLEM WITH DISCHARGE JRNLS
004390*-----------------------------------------------------------------
004400* S KENNEDY  :040496:ANZ068: REMOVE 10121 FROM WA-CHQ-REPAY-TRCODE
004410*-----------------------------------------------------------------
004420* AYAD       :090496:ANZ080: ADD MATCHED-RATE TO SCR12000, SCR1700 
004430*-----------------------------------------------------------------
004440* M SHARMILA :190496:740003: LOAN ADVANCE BY TRANSFER TO DEP ACCOU  
004450*-----------------------------------------------------------------    
004460* A.K.SINGH  :210496:740013: CHECK FOR OVERRIDE AUTHORISATION FOR
004470*            :      :      : STOPPED ACCT. IF PRESENT,ALLOW TXN
004480*----------------------------------------------------------------
004490* A.K.SINGH  :210496:740016: NEW SCREEN 13045 FOR LOAN DISCHARGE
004500*            :      :      : VIA TRANSFER FROM DEPOSIT ACCT.
004510*----------------------------------------------------------------
004520* M SHARMILA :230496:740003: CHECK DIGIT VALIDATION FOR WA-DEP-ACC     
004530*            :      :      : LOAN ADVANCE BY TRANSFER TO DEP ACCOU  
004540*-----------------------------------------------------------------     
004550* A GUESRY   :030596:733171: DO NOT REFRESH (X800) PARA IF ERROR
004560*            :      :      : IN BR0023.
004570*-----------------------------------------------------------------
004580* JOYCE OH   :060596:733161: INITIALISE BR0005
004590*-----------------------------------------------------------------     
004600* A.K.SINGH  :100596:740016: READ CAST AFTER CALL TO BR0024 TO UPD   
004610*            :      :      : CASHIERS TOTAL ON DEPOSIT SIDE.
004620*----------------------------------------------------------------
004630* M SHARMILA :130596:740021: CHECK FOR  BORM-TERM-BASIS AND BRANCH    
004640*            :      :      : ACCORDINGLY
004650*-----------------------------------------------------------------       
004660* A.K.SINGH  :130596:740023: LOAN REPAYMENT VIA TRANSFER FROM DEPO   
004670*            :      :      : ACCOUNT.
004680*----------------------------------------------------------------
004690* BRIAN COLE :200596:ANZ076: ENHANCE 17046
004700*-----------------------------------------------------------------
004710* A GANESH   :210596:740022: INCLUSION OF GROUP CODE IN GLCC
004720*-----------------------------------------------------------------
004730* AGNES RUPAC:270596:NBG007: ALLOW FOR BILLS DISCOUNTED.
004740*-----------------------------------------------------------------
004750* JOYCE OH   :030696:730214: REPLACE 10906 TRAN CODE WITH 906 AND
004760*            :      :      : REMOVE TRAN CODES 10900/2/3/4/5/9.
004770*----------------------------------------------------------------
004780* EMMA HUFFAM:040696:733173: MODS FOR FNSB25 - ALLOW FOR SUSPENSE
004790*            :      :      : POSTINGS, FIX PROBLEMS WITH OVERRIDE
004800*            :      :      : PARA, UPDATE ONL REJECT REFERRAL SYST
004810*----------------------------------------------------------------- 
004820* WENG NG    :200596:IR2892 : IF JNRST-XCURR-IND = 1 TREAT TXN AS
004830*                           : CROSS CURRENCY WHEN WRITING TO GLIF
004840*-----------------------------------------------------------------      
004850* JOYCE OH   :050696:730214: FNSB45 - INCLUDE ADDITIONAL T/C
004860*            :      :      : 10901/3, 10951/3, 10971/3.
004870*            :      :      : **AMENDMENT TO SPEC SINCE MODIFICATIO 
004880*            :      :      : ON 03/06/96**.
004890*            :      :      : ALSO REMOVE WRITE TO JOURNAL FOR THES 
004910*----------------------------------------------------------------
004920* A.K.SINGH  :060696:740023:  BEFORE CALLING UT0460
004930*            :      :      : -SETUP UT0460CA-COMMISSION-IND.
004940*-----------------------------------------------------------------
004950* A.MILLER   :090696:NBG003: MOVE BORM-IR FIELDS TO TABLE BIRM.
004960*                          : DON'T CHECK ORIGIONAL TRAN WHEN
004970*                          : BORP-PRIORITY-CODE IS SET IN L500.
004980*-----------------------------------------------------------------
004990* J. BRADLEY :140696:730574: RETRO - OFFLINE CORRECTION MODS
005000*-----------------------------------------------------------------
005010* A GUESRY   :140696:NBG003: UPDATE UNPAID BUCKETS
005020*-----------------------------------------------------------------
005030* MAHESH C.U :200696:740062: MESSAGE SETTINGS (IR$1070)
005040*-----------------------------------------------------------------
005050*  JOYCE OH  :260696:730214: FNSB45 - ADD EXTRA FIELDS FOR WA-IN00   
005060*            :      :      : PASSALONG AND CALL UT0014 USING
005070*            :      :      : WA-IN0014-CALL-CODE ALSO.
005080*-----------------------------------------------------------------
005090* T CARDENAS :260696:740026: MODIFIED ADDRESS LINES TO
005100*                          : ADDRESS LINE 4.
005110*-----------------------------------------------------------------
005120*J.NELSON    :100596:733212: MODIFY CALL AREA TO UT0017
005130*-----------------------------------------------------------------
005140* B ASHWIN   :030796:740092: 2101593, ERROR 551 INVALID CLEARING A   
005150*-----------------------------------------------------------------
005160* B ASHWIN   :030796:740096: DISALLOW REPAYMENT S/O FROM BATCH IF    
005170*                          : REPAYMENT > LOAN BALANCE
005180*-----------------------------------------------------------------
005190* P. DUNCAN  :080796:740014: DISALLOW CASHIER RECORD ACCESS FOR
005200*                          : ATM TRANSACTIONS
005210*-----------------------------------------------------------------
005220* A.K.SINGH  :150796:74Q025 : CORRECTING SIGN FOR GLIF AMOUNT FOR
005230*                           :  A 98904 GENERATED BY AN ACCT TYPE/
005240*                           :  INT CATEGORY CHANGE.
005250*-----------------------------------------------------------------
005260* EMMA HUFFAM:010896:74Q046 : FIX TRANSFER PROBLEMS
005270*            :      :       : - REMOVE ACCESS OF INVM RECORD
005280*            :      :       :   (THIS IS DONE IN UT0800)
005290*            :      :       : - SET UT0060 CALL PARAMETERS CORRECT  
005300*            :      :       : SET UP EPIP SRCE CORRECTLY
005310*-----------------------------------------------------------------
005320* HAERAN LEE :020896:733150: RETROFIT - INCREASE 17051 MESSAGE
005330*                          :            LENGTH
005340*-----------------------------------------------------------------
005350* HAERAN LEE :050896:733319: RETROFIT - AUTO A/C NO   BY A/C TYPE
005360*-----------------------------------------------------------------
005370* C GARADO   :080896:733310: AMEND CHK DGT CALL  (RETRO)
005380*-----------------------------------------------------------------
005390* H. YANG    :080896:733337: GENERIC CHARGE TRANSACTIONS
005400*                          : ADD BORV-01-PROMO-NO, REMOVE
005410*                          : BORV-01-LEDG-CODE.
005420*-----------------------------------------------------------------
005430* HAERAN LEE :080896:733371:MODS TO ALLOW VARIABLE BANK ACCOUNTS
005440*                          :FOR BANK/SOCIETY CHEQUES BY FUNCTION
005450*                          :(RETROFIT)
005460*-----------------------------------------------------------------
005470* H. YANG    :130896:733331: MODIFY NEW PB PRINT - RETROFEIT
005480*-----------------------------------------------------------------
005490* SHRIDHAR,J :160896: 74Q075:REMOVE 'ACCEPT INPUT FROM OPERATOR'
005500*            :      :       :(VIA CONS-UT8500) AND STOP RUN STMTS
005510*            :      :       :IN MAINLINE PROGRAMS
005520*-----------------------------------------------------------------
005530* N. PAI     :190896:740121 :CONSIDER 17000 TXN FOR GLCC-XFER
005540*                           FOR CHANGE IN CATG
005550*--------------------------------------------------------------
005560* WENG NG    :090896:P50091 : ALLOW A ZERO DISCHARGE
005570*-----------------------------------------------------------------     
005580* SHARMILA   :230896:74Q092 : INSERT ELSE WHICH SEEMS TO HAVE GOT
005590*                            ACCIDENTALLY DELETED WHEN POPULATING
005600*                              JNRST-GL-CLASS-CODE
005610*-----------------------------------------------------------------       
005620*SYED MOHD. K:270896:74Q070 : 17046 - MOVE BORM-LOAN-BAL TO JNRST-
005630*                           : AMOUNT FOR USE IN SECONDARY UPDATE.
005640*-----------------------------------------------------------------
005650*FELIX SURESH:300896:74Q106 :20060 NOT TO BE GEN IN 11045
005660*                           :COMMENT THE ZEROING OF UT0460CA-COMM
005670*                           :ISSION-IND
005680*-----------------------------------------------------------------
005690*SHARMILA M :050996:74Q112 :POST JOURNAL ENTRY AFTER CALL TO GL002 
005700*-----------------------------------------------------------------  
005710*SYED MOHD. K:120996:74Q134 : CHANGE INT. ACCRUED ADJUSTMENT TO
005720*                           : 5 DECIMALS.
005730*-----------------------------------------------------------------
005740*A.K.SINGH   :200996:74Q150 : SET UP WA-OVER-RIDE FOR TXNS 12477
005750*                           : AND 12577.
005760*-----------------------------------------------------------------
005770*K. KILGORE  :250996:74Q170 : USE SELL RATE RATHER THAN BUY RATE
005780*                           : IN TXN 11045.
005790*-----------------------------------------------------------------
005800* JOSH HALL  :250996:740148 : RETRO FIT CODE BY J. NELSON.
005810*                           : CALL UT0460 WITH CREDIT/DEBIT TYPE I   
005820*-----------------------------------------------------------------  
005830* MAHESH C.U :031096:74Q174 :REMOVAL OF HARD CODED MESSAGE.
005840*-----------------------------------------------------------------  
005850* ANUP PAI   :061096:74Q198 :CORRECTIONS TO AVOID TRUNCATION OF NA      
005860*                           : TXN 17451
005870*-----------------------------------------------------------------     
005880* M SHARMILA :101096:74Q200 :S/O REPAYMENT AMOUNT IN EXCESS OF BAL      
005890*                            FIELDS NOT POPULATED.
005900*-----------------------------------------------------------------       
005910* K.KAMEL    :101096:733360 : FOR CLAWBACK HISTORY. "UT0909"
005920*----------------------------------------------------------------
005930* SANTOSH C  :151096:74Q205 : MODIFICATIONS HAVE BEEN INC. TO PROC   
005940*                           : TRANSFERS REQUESTS FROM DAY JOURNAL
005950*                           : PROCESSING
005960*-----------------------------------------------------------------       
005970* A.K.SINGH  :231096:740180 : POPULATE OUTPUT BALANCE CORRECTLY IN      
005980*                           : PARA FOR LOANS CARRY FORWARD PASSBOO  
005990*-----------------------------------------------------------------       
006000* GANESH A   :241096:74Q230 : INCLUDING PARA TO LOAD TXTM. TRAN 10       
006010*                           : BRINGING SYSTEM DOWN AS THE SUBSCRIP  
006020*                           : TXT-1 & TXT-2 WERE OUT OF RANGE
006030*-----------------------------------------------------------------       
006040* J.NELSON  :260996:IR1235 : WHEN CALLING UT0460 WITH CHQ. DEPOSIT
006050*                          : PASS COMMISSION-IND OF '10' (TRANSFER  
006060*                          : THIS IS DUE TO CHQ. DEP. POSTING TO
006070*                          : OUTWARD CLEARING ACCOUNT.
006080*                          : WHEN POSTING TO OUTWARD CLEARING, POS 
006090*                          : DEBIT (20X50) NOT CREDIT (20X30)
006100*-----------------------------------------------------------------  
006110*W. MAZIOUN:051196:740166:CALL UT7400 TO UPDATE CELM & CUSL
006120*-----------------------------------------------------------------  
006130* J.NELSON   :161196:740232 : DO NOT UPDATE TELLER TOTALS FOR THE
006140*                           : GENERATED G/L TXN DUE TO OUTWARD
006150*                           : CLEARING TXNS
006160*-----------------------------------------------------------------  
006170* M SHARMILA :181196:IR3802 : S/O IN XS OF LOAN BALANCE
006180*-----------------------------------------------------------------  
006190*MINIMOL M   :281196:IR3841 :RETROFIT FOR 74Q205 FOR SANTOSH
006200*                           :MODIFIED CODE AS TO BE ABLE TO SET UP
006210*                           :STANDING ORDER (10901)
006220*-----------------------------------------------------------------  
006230* SANTOSH C  :081296:IR3757 :MOVE ZEROS TO NEW PASLONG FIELDS ADDE 
006240*-----------------------------------------------------------------  
006250* SANTOSH C  :091296:IR3757 :MOVE ZEROS TO NEW PASLONG FIELDS ADDE 
006260*-----------------------------------------------------------------  
006270* JAY POORUN :101296:IR3757 :PASSED WA-PASSALONG TO CS0000 AND CS0        
006280*-----------------------------------------------------------------      
006290* H GREWAL   :131296:IR1511 :INCLUDE CALL TO UT0681 TO UPDATE FACI      
006300*                           :BASED ON LIMIT CLEARED BALANCE INDICA   
006310*-----------------------------------------------------------------      
006320*FELIX SURESH:161296:IR1776 : SEPERATE COMMISION GL AC FOR FCY/LCY       
006330*SURESH HM                  : UT0460 TO GET COMMISSION AMOUNT FOR      
006340*-----------------------------------------------------------------      
006350* WENG NG    :111296: 50395: ENSURE INTEREST ADJUSTMENT TRXNS HAVE        
006360*----------------------------------------------------------------
006370* H GREWAL   :231296:IR2385: RETROFIT FOR 750006 FOR L.MCCORMACK
006380*                          : NEW CALLING PARAMETERS MULTI-OVERRIDE     
006390*                          : FOR UT0681 THEREFORE MUST BE PASSED T        
006400*----------------------------------------------------------------
006410*SANTOSH C   :080197:I60317: MODIFIED BR0017 NOT TO SEND O.K MESSA   
006420*            :      :      : O.K MESSAGE WOULD NOW BE SENT FROM BR    
006430*                          :THIS HAS BEEN DONE SO AS TO TRAP ERROR 
006440*                          :GENERATED  BY CHARGES SYSTEM.
006450*-----------------------------------------------------------------
006460* WENG NG    :100197:I60320: REPLACE DATE-BORR-SOP WITH BORM-APPRV      
006470*----------------------------------------------------------------
006480* WENG NG    :130197:I60351: WHEN PERFORMING A 10732 - 'INT. ADJ.'
006490*                          : THE MAX. INT. THAT MAY BE DEBITED IS
006500*                          : BORM-INT-ACCR + BORM-INT-ADJUSTMENT
006510*                          : BORM-BPI-ACCR
006520*----------------------------------------------------------------
006530* H GREWAL   :290197:I60350: AVOID WRITING REFERRALS TWICE DURING         
006540*                          : IN M000-ADVANCE-VALIDATE & Q260-POST-        
006550*----------------------------------------------------------------
006560* G S BABU   :310197:I60033: RETROFIT FOR IR60033,KEEP THE INPUT A      
006570*            :      :      : NO AS TO ACC NO FOR LOAN TRANS.FROM O  
006580*            :      :      : INST.TRANS
006590*----------------------------------------------------------------
006600* H GREWAL   :060297:I60509: RETROFIT FOR 740331 FOR AYAD - LOAN A      
006610*                          : BY TRANSFER NOT WORKING - LATER REVER   
006620*----------------------------------------------------------------
006630* SANTOSH C  :050297:I60432: CALL  UT0681 TO UPDATE FACILITY
006640*                          : IRRESPECTIVE OF THE LIMIT INDICATOR
006650*-----------------------------------------------------------------
006660* H GREWAL   :070297:I60692: LOAN ADVANCE - BPI INC INCORRECTLY CO      
006670*                          : FOR ARREARS FIGURES
006680*----------------------------------------------------------------
006690* A RUPAC    :070297:I60549: LOAN ADVANCE - ADD MSG-ERR-FLAG CHECK
006700*            :             : AFTER CALL TO BR0024 AND BR0023.
006710*----------------------------------------------------------------
006720* MINIMOL M  :090297:I60646:AVOID  TELLER TOTALLING IN SOD IN E300
006730*                          :TELLER-TOT-PARA
006740*----------------------------------------------------------------
006750* SANTOSH C  :090297:I60432: ADDITIONAL CHECKS  AFTER CALLING
006760*                          : UT0681 TO UPDATE FACILITY
006770*                          : IRRESPECTIVE OF THE LIMIT INDICATOR
006780*-----------------------------------------------------------------
006790* M SHARMILA :130297:I60566: USE THE CORRECT CURRENCIES FOR GTWY T   
006800*-----------------------------------------------------------------     
006810* M SHARMILA :200297:I60816: LCI ACCR. / BPI ACCR. WRONG
006820*-----------------------------------------------------------------     
006830* SURESH H M :260297:IR3307: PERFORM FACILITY UPDATION AFTER LOAN
006840*                          : DISCHARGE WITH PROPER AMOUNT
006850*-----------------------------------------------------------------     
006860* MINIMOL M  :010397:I61169: INCORRECT BALANCE
006870*-----------------------------------------------------------------     
006880* ANUP PAI   :060397:I61030: DISCHARGE TRANSACTIONS CREDIT THE LOA       
006890*            :      :      : AND SHOULD HAVE A NEGATIVE JOURNAL AM  
006900*-----------------------------------------------------------------     
006910* J.NELSON   :120397:I60481: UTILISE COPYBOOK FOR PASSALONG AREA,    
006920*                          : GET COPYBOOK IN SYNC FOR MODULES USIN 
006930*                          : THE COPYBOOK
006940*-----------------------------------------------------------------    
006950*SYED MOHD. K:130397:I61437: SET UP JNRST-TRANSFER-TXN-BR FOR XXX4    
006960*                          : TRANSACTIONS.
006970*-----------------------------------------------------------------    
006980*SYED MOHD. K:140397:I61030: SET UP JNRST-TRANSFER-TXN-BR FOR 1304 
006990*                          : TRANSACTION.
007000*-----------------------------------------------------------------    
007010*M SHARMILA:190397:I61625: DO NOT MOVE 0 IF ERR-MSG RETURNED FROM       
007020*                          IS 197.
007030*-----------------------------------------------------------------        
007040* H GREWAL   :210397:I61575: TXN GETS COMMITTED AFTER RECORD HELD      
007050*-----------------------------------------------------------------        
007060* M SHARMILA:240397:I61543: DO A DISCHARGE IF THE STANDING ORDER I        
007070*                           BALANCE.
007080*-----------------------------------------------------------------        
007090*SYED MOHD. K:260397:I61031: WRITE JOURNAL AMOUNT FOR 13651 AS -VE
007100*-----------------------------------------------------------------    
007110*SYED MOHD. K:020497:I61577: WRITE BASE EQUIV. AMTS WITH A MINUS(-      
007120*                          : FOR 13045, 11155 AND 16155 TRANSACTIO   
007130*-----------------------------------------------------------------    
007140* ANUP PAI   :120497:I61810: MOVE CORRECT BRANCH DURING SUSPENSING   
007150*                          : REJECTED DJ TRANSACTIONS.
007160*-----------------------------------------------------------------    
007170*K MCALLISTER:150497:I61883: REMOVE USAGE OF DRAWDOWN TYPE FIELD
007180*_________________________________________________________________     
007190*P DUNCAN    :200497:I62207: FIXED AN ILLEGAL EXIT FROM E200 PROCE    
007200*-----------------------------------------------------------------    
007210*K MCALLISTER:210497:I61838: ADD NEW CALL FIELD TO UT0681
007220*_________________________________________________________________     
007230*M SHARMILA:220497:I61648: WRONG SIGN ON 13509 AMOUNTS AND LCY AMO   
007240*                          NOT POPULATED FOR 13509 GENERATED DURIN 
007250*                          CROSS CURRENCY 11055
007260*-----------------------------------------------------------------      
007270* FELIX S.  :290497:I62258: INITIALISE WA-SAVE-COMM-FLAG, WA-SAVE-      
007280*                         : -FLAG
007290*-----------------------------------------------------------------      
007300*A.K.SINGH :060597:I62444: CALL B3000-CHECK- PARA AFTER CALL TO BB   
007310*                          IN B001-PROCESS-CHARGE PARA TO UPDATE T  
007320*                          UTILISED AMOUNT.
007330*-----------------------------------------------------------------      
007340* MINIMOL M  :060597:I62327: MODIFIED TO UPDATE TREASUY CUSTOMER L     
007350*-----------------------------------------------------------------      
007360* G S BABU   :080597:I62468: INITIALIZING WA-TRANSLATED-CLEAR-DAYS
007370*-----------------------------------------------------------------      
007380*A.K.SINGH :060597:I62176: WRITE JOURNAL FOR T/C 17046 AND PREVENT
007390*                          PROCESSING OF T/C 98904 FOR LOAN ACCT
007400*                          AMENDMENT OTHER THEN ACCT-TYPE/INT-CAT        
007410*-----------------------------------------------------------------      
007420* JEREMY LAU :140597:I62705: FIX ERROR BEING IGNORED WHEN CHARGES      
007430*                          : AND OVER LIMIT.
007440*-----------------------------------------------------------------      
007450* MINIMOL M  :160597:I62752 : LOANS ONLINE LOOPING
007460*-----------------------------------------------------------------     
007470* SHRIDHAR J :160597:I62607 :CONTRA'S FOR 13651 AND 1053 DO NOT RE       
007480*-----------------------------------------------------------------     
007490* M SHARMILA :170597:I62601: PREVENT GL TRANSACTIONS BEING GENERAT      
007500*                            TRICKLE FEED TRANSACTIONS.
007510*-----------------------------------------------------------------     
007520* P O'KELLY  :190597:I62590: SET JNRST-OLD-GLCC AND JNRST-NEW-GLCC     
007530*            :      :      : A BRANCH OR ACCT TYPE CHANGE (17046)       
007540*            :      :      : ALSO SET UT0099CA-BRANCH CORRDCTLY ON  
007550*            :      :      : 17046 BRANCH CHANGE.
007560*-----------------------------------------------------------------       
007570*A.K.SINGH :260597:I62176: PREVENT PROCESSING OF TXN 98904 FOR LOA 
007580*                          AMENDMENT OTHER THEN ACCT-TYPE/INT-CAT        
007590*-----------------------------------------------------------------      
007600*M.OVINGTON:280597:I61125: PROCESS DEBIT ADJ TXNS AS REVERSE CREDI     
007610*                          PREVENT ADJUSTMENTS TO ADVANCED AMOUNTS 
007620*-----------------------------------------------------------------      
007630*C GARADO  :230198:760008: CORRESPONDENCE RETROFIT FROM TBT
007640*                 :VERSION 74.84
007650*                 :TBT186: ADD ACCOUNT TYPE AND INTEREST CAT
007660*                 :                    TO CALL TO CP0010
007670*-----------------------------------------------------------------      
007680* A. TANIOUS :030298:760006: FEES AND CHARGES UPGRADE FROM REL 7.6 
007690*-----------------------------------------------------------------      
007700* H. YANG    :270298:760009 : FIX ERROR MESSAGE HANDLING
007710*-----------------------------------------------------------------  
007720* H. YANG    :020398:760024 : ENHANCEMENENT FOR PERFORMANCE
007730*                           : - REMOVE MULTIPLE "UT0500" CALL
007740*                           : - BRHM ACCESS THRU MEMORY TABLE
007750*-----------------------------------------------------------------  
007760* H. YANG    :110398:760027 : FIX OVERRIDE SIZE AND "UT0060" ABORT
007770*-----------------------------------------------------------------  
007780* H. YANG    :260398: 760031 : FIX PASSBOOK LINE PRINT HANDLING
007790*-----------------------------------------------------------------
007800* H. YANG    :070598:760037: SORT OUT DELAY TIMER
007810*----------------------------------------------------------------
007820* P.MATARAGE :030898:760080: ANZ-RTFD
007830*            :      :      : CORRECTION DEBIT TRANSFER RESULTS IN
007840*            :      :      : LARGE TXN AMOUNT
007850*----------------------------------------------------------------
007860* P CHARTERIS:040998:760108:PAYMENTS RETROFIT.
007870*-----------------------------------------------------------------    
007880* P.MATARAGE :111198:760166: ADDITIONAL APPROVAL PROMO CODE(CTCB)
007890*----------------------------------------------------------------
007900* H. YANG    :131198:760148: CTCB MISC. BUG FIX
007910*----------------------------------------------------------------- 
007920* J. JAMBU   :181198:760172: INVALID DECIMALS FOR TWD AGAINST USD
007930*----------------------------------------------------------------- 
007940* J. JAMBU   :191198:760188: SEVERITY CODE 1 DOES NOT WORK ON ELM.
007950*----------------------------------------------------------------- 
007960* J. JAMBU   :201198:760191: LOAN NPB RETURNS ERR 552.
007970*----------------------------------------------------------------- 
007980* J. JAMBU   :201198:760193: TR 10130 DOES NOT VALIDATE NON
007990*            :      :      : VALUE DAYS OF 6
008000*----------------------------------------------------------------- 
008010* J. JAMBU   :201198:760196: TR 12476 RETURNS ERROR 3080.
008020*----------------------------------------------------------------- 
008030* H. YANG    :271198:760213: PENDING CHARGE FOR LOAN
008040*----------------------------------------------------------------- 
008050* R NEILANDS :101298:760167: RETROFIT TELEPAC/IVR INTERFACE
008060*            :      :      : TRANSACTION REFRESH
008070*            :      :      : ING:HEL001 HEL007 ICU: 74I012 74I052
008080*-----------------------------------------------------------------      
008090* M. MIAO    :230798:74I007: ATM FEE DEVELOPMENT:
008100*            :      :      : - INTRODUCE "FEE DRIVER" TXN 19200.
008110*            :      :      :   THIS TXN IS USED TO CHARGE FEE FOR
008120*            :      :      :   ATM BALANCE INQ. TXN AND DECLINED A  
008130*            :      :      :   FIN. TRANSACTION.
008140*            :      :      :   ONLY FEE CHARGE PROCESSING IS APPLI  
008150*            :      :      :   TO THIS TXN.
008160*            :      :      : - CALL UT0270 FOR TXN 12120, MAKE FEE
008170*            :      :      :   CHARGEABLE FOR PATICULAR CARD MANAG     
008180*            :      :      :   TXN.
008190*-----------------------------------------------------------------      
008200* M. MIAO    :021198:74I007: FIX BUG FOR TXN 12120/19200 FOR PROMO
008210*            :      :      : CODE OVERRIDE
008220*-----------------------------------------------------------------      
008230* PADMAKUMARA:111198:760229: STOP BACDATED FIN.TXN BEYOND SOP DATE
008240*    MATARAGE:      :      : ERR-191 (ING)
008250*----------------------------------------------------------------
008260* PADMAKUMARA:010399:760098: CORRECT LEAP YEAR FEB. DAYS
008270*    MATARAGE:      :      : (Y2K RELATED)
008280*----------------------------------------------------------------
008290* H. YANG    :170399:760249: FIX OLRR CORRECTION OPTION
008300*----------------------------------------------------------------- 
008310* H. YANG    :250399:760258: REMOVE HARDCODE OUTPUT CODE(30)
008320*----------------------------------------------------------------- 
008330* I. KENT    :090499:760265: FIX WROMG AMOUNT FOR 10750 TXN
008340*----------------------------------------------------------------- 
008350* H. YANG    :160499:760279: EFT ACK SENT FROM INTER
008360*----------------------------------------------------------------- 
008370* I. KENT    :200499:760290: INT ADJ CR (10730) , SEND THE CORRECT
008380*                          : TXN TO UT0069 FOR INT RECALC
008390*-----------------------------------------------------------------
008400* R NEILANDS :270499:760167 : REPLACE COBOL SWITCHES BY INSPARM
008410*-----------------------------------------------------------------
008420* H. YANG    :110599:760311: FIX 17046 JOURNAL ERROR
008430*----------------------------------------------------------------- 
008440* H. YANG    :120599:760313: REPLACE DBIO CODES(4X/5X) TO 6X
008450*----------------------------------------------------------------- 
008460* I. KENT    :270599:760328: FIX REFERENCE POINTER BEFORE CALLING
008470*                          :  DBIO FOR BLDVUU
008480*----------------------------------------------------------------- 
008490* B.JAVIER   :280599:760330: CHANGE ERRMSG 192 TO 126.
008500*----------------------------------------------------------------- 
008510* PADMAKUMARA:010699: 760334: SUP.OVERRIDE MESSAGE FOR 11060
008520*    MATARAGE:      :       :
008530*-----------------------------------------------------------------
008540* A. TANIOUS :020699:760336 : UPDATE INT ACCR BEFORE CALLING UT090 
008550*-----------------------------------------------------------------
008560* H. CALARA  :030699:760338 : GET CORRECT SOP DATE/PREV CAPITALI-
008570*            :              : ZATION DATE.
008580*-----------------------------------------------------------------
008590* E. UY      :080699:760345 : MODIFY CALL PARAMETERS TO BR0017 TO
008600*            :      :       : INCLUDE ADDITIONAL AREA FOR UT0290
008610*-----------------------------------------------------------------
008620*A. TANIOUS  :280699:760410 : UPDATE BORM AFTER CALLING CS0090, IT
008630*            :      :       : WAS COMMENTED OUT.
008640*-----------------------------------------------------------------
008650* R NEILANDS :230799:760167 : ICU RETRO, FORMAT 2XXXX TX FOR
008660*                           : TELEPAC REJECTS,
008670*                           : FORMAT "08" NOT ">R" FOR 19200 &
008680*                           : 19210 TRANSACTIONS,
008690*                           : CATER FOR TRANSFERS & WA-ATM-SEQ-NO
008700*-----------------------------------------------------------------
008710* PADMAKUMARA:260899: 760476: FIX DISPLAY ON TXN 10450, 32101 FOR
008720*    MATARAGE:      :       : INT ADJESTMENT DISPLAY(10732)
008730*            :      :       : BR0000 NOT MOVING BRNCH & TELL NO
008740*            :      :       : CORRECTLY FOR TXN 10732
008750*-----------------------------------------------------------------
008760* J CHANCO   :270899: EUR001: EURO COMPLIANCE USING TXN 10401
008770*-----------------------------------------------------------------
008780* H. YANG    :100999:760500 : NEW "BR0055" FOR STATEMENT "I" OPTIO 
008790*-----------------------------------------------------------------
008800* E UY       :100999:MIC001 : CPM - PASS INSTITUTION TO UT0310
008810*-----------------------------------------------------------------
008820* I. KENT    :170999:760503 : FIX REWRITE MASTER AFTER CALLING CHA    
008830*                           : MODULE
008840*-----------------------------------------------------------------
008850* I. KENT    :170999:760505 : FIX PROBLEM WITH BASIC BALANCE ADJUS     
008860*-----------------------------------------------------------------
008870* FCATABAS   :210999:EUR001 : ADD NEW TXN CODE 10701 FOR EURO COUN        
008880*            :      :       : OF STATEMENT
008890*-----------------------------------------------------------------
008900* FCATABAS   :061099:EUR001 : COMMENTED OUT CPM-PASS INSTITUTION T        
008910*-----------------------------------------------------------------
008920* A TANIOUS  :111099:760508 : REMOVE TIER RATE
008930*-----------------------------------------------------------------
008940* I. KENT    :300999:760512 : FIX PROBLEM WITH TREASURY EXPOSURE
008950*-----------------------------------------------------------------
008960* E UY       :150999:MIC001 : CPM - PASS INSTITUTION TO UT0310
008970*-----------------------------------------------------------------
008980* B.JAVIER   :030999:24H002 : BANCS 24HR IMPLEMENTATION.
008990*                           : NEW ARCHITECTURE.
009000*-----------------------------------------------------------------
009010* MSMOLINA   :101199:24H002 : FIX MEMORY BOUNDARY ERROR IN CAL TO        
009020*-----------------------------------------------------------------
009030* R NEILANDS :101299:24H002 : CALL EI0085 WITH RECOVERY FLAG
009040*-----------------------------------------------------------------
009050* R NEILANDS :221299:24H009 :REMOVE NESTED COPY REPLACING FOR MVS
009060*-----------------------------------------------------------------
009070* I KENT     :241299:NLB002 : RETROFIT OF NLB DEVELOPMENT FOR           
009080*------------:      :       :-------------------------------------      
009090* G. MCRAE   :260698:SUP002 : FIX LOG ????                              
009100*------------:      :       :-------------------------------------      
009110* A. GABOR   :260698:SUP002 :FIX TRAILING SIGN ABEND FOR 12410          
009120*------------:      :       :-------------------------------------      
009130* H. YANG    :280898:SUP004: MVS STABILISATION.                         
009140*------------:      :       :-------------------------------------      
009150* VICTOR SUNG:090998:SUP004: CALL UT8500 INSTEAD OF DISPLAY             
009160*------------:      :       :-------------------------------------      
009170* H YANG     :171199:760534 :CALL UT0310                                
009180*            :271199:760543 :MOVE STARTAREA LEDGER CODE                 
009190*------------:      :       :-------------------------------------      
009200* C SPEYER   :170699:CINT01A:CONFORM FINE RATE FOR ARREARS INCR         
009210*------------:      :       :-------------------------------------      
009220* YN KIM     :130799:CINT02A:CREATE NEW TRANSACTIONS AND SCREENS        
009230*            :      :       :OF 10731,10751,10733 FOR LOAN TOM          
009240*            :      :       :INFLATION ADJUSTMENT                       
009250*------------:      :       :-------------------------------------      
009260* FIELDHOUSE :130799:CLON05 :CALL BR0030 FOR TXNS 12594, 12595,         
009270*            :      :       :12596 OR 12597.                            
009280*------------:      :       :-------------------------------------      
009290* YN KIM     :190799:CINT02A:CREATE NEW TXN 31512 FOR TOM JNRST         
009300*            :      :       :WHEN CLOSING IN BR0025 AREA                
009310*------------:      :       :-------------------------------------      
009320* C NILSSON  :050899: CY2K02:Y2K CHANGES. RETROFIT.                     
009330*------------:      :       :-------------------------------------      
009340* W EASTON   :090899:CINT07A:FORCED INTEREST CAPITALIZATION             
009350*------------:      :       :-------------------------------------      
009360* YN KIM     :120899:NLB0032:PASS INTEREST ADJUSTMENT TO UT0069         
009370*------------:      :       :-------------------------------------      
009380* W EASTON   :120899:CINT07A:FORCED INTEREST CAPITLIZATION              
009390*------------:      :       :-------------------------------------      
009400* W EASTON   :180899:CINT05A:DISCOUNT RATE ENQUIRY                      
009410*------------:      :       :-------------------------------------      
009420* Y.C KIM    :190899:NLB0068:ARREARS INTEREST ACCRUED                   
009430*------------:      :       :-------------------------------------      
009440* C SPEYER   :200899:NLB0069:FIX CONFORM ARREARS ACCRUAL CALC           
009450*------------:      :       :-------------------------------------      
009460* W EASTON   :240899:CINT07A:FIX IR                                     
009470*------------:      :       :-------------------------------------      
009480* W EASTON   :250899:NLB0094:FIX IR                                     
009490*------------:      :       :-------------------------------------      
009500* Y.N.KIM    :300899:NLB1031:TRN AMOUNT SHOULD NOT BE NEGATIVE          
009510*            :      :       :AND PROMO NO SHOULD BE CHECKED WHEN        
009520*            :      :       :TRN 10730,10731,10750,10751                
009530*------------:      :       :-------------------------------------      
009540* C FRASER   :200999:NLB0057:CHANGE SUSP KEY FOR EXTENDED MNEMONIC      
009550*------------:      :       :-------------------------------------      
009560* C FRASER   :191099:CINT03T:ADD SOC PARAMS TO BR0030 CALL              
009570*------------:      :       :-------------------------------------      
009580* FIELDHOUSE :201099:CINT03Q:ADD FCC ADJ TO JNRST AND LOG DISCHRGE      
009590*------------:      :       :-------------------------------------      
009600* DAVID HEATH:221199:CTRE03 : PRIME UT7400CA-CONTROL-CNTR FIELD.        
009610*------------:      :       :-------------------------------------      
009620* Y.N.KIM    :061299:NLB0110: FIX BORV DETAILS FOR INT ADJUST TRN       
009630* C SPEYER   :      :       :                                           
009640*------------:      :       :-------------------------------------      
009650* FIELDHOUSE :161299:CLON05 :CALL BR0030 FOR NEW TXN 12600              
009660*-----------------------------------------------------------------      
009670* J HIGGS    :060200:NLB019 : ADD UNPAID TOM INT TO UT0095CA            
009680*-----------------------------------------------------------------      
009690* GREG MCRAE :120200:NLB019 : CHANGE BSB FROM PIC 9(6) TO X(12)         
009700*-----------------------------------------------------------------      
009710* MSMOLINA   :180200:24H019 : BYPASS when mode is reposting             
009720*-----------------------------------------------------------------      
009730* MSMOLINA   :200200:24H024 : fix for GENRIC enquiry in new arch.       
009740*            :      :       : also, delete display statements ref.
009750*            :      :       :  no. NLB0099
009760*-----------------------------------------------------------------      
009770* MSMOLINA   :230200:24H024 : temp remove fix for GENERIC eqnuiry       
009780*-----------------------------------------------------------------      
009790* JOJO PUNO  :080300:NLB059 : USE INPUTMSL COPYBOOK IN PLACE OF
009800*            :      :       : INPUT-MSG-GL TO MEET MVS STANDARDS
009810*-----------------------------------------------------------------      
009820* MSMOLINA   :080300:24H031 : fix to disaaprove loan when appl-amt
009830*            :      :       : exceeeds customer limits          
009840*-----------------------------------------------------------------      
009850* EG ASPIRAS :100300:NLB063 : ADD ACCOUNT/CHANNEL LINKAGE PROCESSI  
009860*-----------------------------------------------------------------
009870* PADMAKUMARA:230300:NLB080 : FIX BPI INCR CALC WHEN FCC <> 0
009880*    MATARAGE:      :       : 
009890*-----------------------------------------------------------------
009900* MSMOLINA   :230300:24H024 : fix for GENERIC eqnuiry  in new arch
009910*-----------------------------------------------------------------
009920* P VERGEL   :300300:MVS006 : RETROFIT NLB FIXES (MVS101 IN COMMEN       
009930*-----------------------------------------------------------------
009940* EG ASPIRAS :030400:24H031 : UNCOMMENT PERFORM OF B3300 TO REINST   
009950*                           : CUSTOMER LIMIT CHECKING
009960*-----------------------------------------------------------------
009970* H CALARA   :140500:NLB115 : UPDATE CUSM STATEMENT FIELDS
009980*            :240500:24H024 : PERMANENTLY REMOVE WS-OL-APPL-FLAG
009990*-----------------------------------------------------------------
010000* C SPEYER   :260500:NLB122 : ADD 11035 TO CASH REPAY TXNS
010010*-----------------------------------------------------------------
010020* J CHANCO   :050600:NLB122 : ADDED VALIDATION FOR INITIALIZATION
010030*-----------------------------------------------------------------
010040* S VU       :140600:24H045 : WHEN PERFORM TXN 10422 IF FROM-DATE 
010050*                           : IS NOT ENTERED, SYSTEM SHOULD DEFAUL 
010060*                           : TO LOAN APPROVAL DATE
010070*-----------------------------------------------------------------
010080* T TRAN     :030700:24H053 : LOAN APPROVAL SHOULD ONLY UPDATE
010090*            :      :       : LIMIT IN BR0017
010100*-----------------------------------------------------------------
010110* EAP        :111000:763026 : IB CHANGES
010120*-----------------------------------------------------------------    
010130* I KENT     :291100:TRE906 : FIX UTILISATION AMOUNT AT PRODUCT LE   
010140*-----------------------------------------------------------------   
010150* PADMAKUMARA:010301:800006 : CUSTOMER & LOAN ACC CREATION AT
010160*    MATARAGE:      :       : NIGHT
010170*-----------------------------------------------------------------
010180* J CHANCO   :070301:800030 : RETROFIT the following:
010190* E DAPROZA  :040900:NLB205 : Retrofit NBD Fixes for Multi-currenc 
010200*                           : issues
010210* F CATABAS  :140900:NLB210 : (1) Allow to enter amount in the
010220*                           :     REPAYMENT AMOUNT field of the sc    
010230*                           :     if multi-currency
010240*-----------------------------------------------------------------   
010250* L MA       :080301:800028 : BUG FIX FOR IR562. NOT VALIDATE "NON
010260*            :      :       : VALUE DAYS" FOR CREDIT REPAYMENT TXN 
010270*-----------------------------------------------------------------
010280* M.OVINGTON :060301:Key008 :CATER FOR KEYMATRIX 30 DAY LOAN PROCE  
010290*-----------------------------------------------------------------
010300* LG CAGA    :020501:NLB264:UPDATE BORM-TOM-ACRU-AMT IF BACKDT TXN       
010310*            :      :      :ADD NEW FIELD TO UT0069CA (INT-START-D  
010320*-----------------------------------------------------------------
010330* W. MAZIOUN :070501:KEY017: Retofit code (done by Lito) for 
010340*            :      :      : KeyMatrix (SEG).
010350*-----------------------------------------------------------------  
010360* H CATLEY   :140501:KEY008: Journal int returned from BR0023
010370*-----------------------------------------------------------------  
010380* H CATLEY   :220501:KEY008: Journal generated txns from 11064
010390*-----------------------------------------------------------------  
010400* L CAGA     :280501:NLB264: Add new fields to UT0069CA for Arrear  
010410*                          : Access ARRS table for arrears (COFM a    
010420*-----------------------------------------------------------------  
010430* H CATLEY   :220501:KEY020: Allow for extra jrnl recs returned fr  
010440*                          : BR0023 and BR0024
010450*                          : Allow for extra int fields on closure
010460*                          : Calculate int incr on first advance
010470*                          : if accrue method is 6
010480*-----------------------------------------------------------------  
010490* J CHANCO   :150601:800082 : MOVED ATM FIELDS TO STRTREST
010500*-----------------------------------------------------------------
010510*            :      :       : RETROFIT SPR 800088         
010520* A GABOR    :040101:LON14S : TELLER NO ADDED IN CP0010CA COPYBOOK
010530*            :090101:LON14S : POST DATE ADDED IN CP0010CA COPYBOOK
010540*            :130101:LON14S : ADD TRXNS 19000/19001. CALL UTCORR 
010550*            :      :       : TO VALIDATE CORRESPONDANCE DETAILS
010560*-----------------------------------------------------------------
010570* C ROGERS   :250601:800085 : INCREASE LENGTH OF SCR17000
010580*-----------------------------------------------------------------
010590* H CATLEY   :260601:KEY020: PERFORM B700 PARA FOR 12690 / 12691    
010600*-----------------------------------------------------------------  
010610* J CHANCO   :060701:800082: CORRECTED ASSIGNMENT OF "V" TO "U"
010620*                            FOR STRTREST ATM FIELDS TO MATCH LINK   
010630*-----------------------------------------------------------------
010640* I ACOSTA   :130701:800074: RETROFIT LB0511 BY W.MAZIOUN
010650*                          : CORRECT HANDLING OF THE DISCHARGE
010660*                          : ENQUIRY TRANSACTIONS (13000/32110)
010670*-----------------------------------------------------------------
010680* H CATLEY   :260601:KEY033: ADD CODING FOR 12522 (12422 CORRECTIO  
010690*-----------------------------------------------------------------  
010700* I KENT     :090701:TRE937: CALL UTRSEC FOR UNSECURED LOAN
010710*                          : (RETROFIT FOR UNSECURED LOAN)
010720*-----------------------------------------------------------------  
      * MIKE TIEN  :210901:TB0008 : RESERVED ACCOUNT NUMBER
      *-----------------------------------------------------------------
      * JAKE CUNA  :021001:TB0015 : ADD A MESSAGE ALERT FOR FT0000, WHEN
      *                           : THE CUSTOMER STATUS FLAG IS CHANGED TO 1,
      *                           : THE SYSTEM SHOULD RETURN A
      *                           : "WHEREABOUTS UNKNOWN" WARNING MESSAGE.
      *--------------------------------------------------------------------
      * KADDY HUANG:100102:TB0007 : INCREASE LENGTH OF OUTPUT TO BR0001
      *                           : FOR ADDED AO RELATIONSHIP MANAGER
      *-----------------------------------------------------------------
      * RIZA LADIA :181201:TB0027 : DAILY CASH DEBIT/CREDIT TRANS LIMITS
      *                           : MONITORING; INTRO NEW BOIS FILE FOR TIB
      *-----------------------------------------------------------------
      * N Z Oblan  :110202:TB0023 : Call new program to update EXPOSURE
      *                           : Limit (UT0683)
      *-----------------------------------------------------------------
      * RIZA LADIA :240302:TB0069 : INCREASE LENGTH OF OUTPUT TO BR0001
      *                           : FOR ADDED FIELD REQUIREMENTS OF TIB
      *                           : INTRO TRAN 17076/17026 TIB NEGO RATES
      *                           : STORE RATES/RATE HISTORY FOR
      *                           : COMBIN. NEGO RATES UPON FIRST ADVANCE
      *-----------------------------------------------------------------
      * MIKE TIEN  :030402:TB0070 : MAXIMUM AMD MINIMUM REPAYMENT
      *-----------------------------------------------------------------
      * ALEX NERIA :080502:TB0081 : ADD NEW SCREEN 17079 AND 17453
      *-----------------------------------------------------------------
      * M.CASTILLO :140502:TB0082 : BYPASS APPROVE AND ACCEPT TRANSACTIONS
      *-----------------------------------------------------------------
      * N.Z. OBLAN :140502:TB0084 : REPAYMENT APPLICATION                 
      *            :      :TB0023 : GROUP FACILITY LIMIT PROCESSING       
      *-----------------------------------------------------------------
      * MIKE TIEN  :270402:TB0088 : ADD NEW TRANSCATION 17455 AND 17456
      *                           : NEW PROGRAM BR0088
      *-----------------------------------------------------------------
      * CYN M ROXAS:110502:TB0091 : ADD LOGGING OF BUCKET TO JRNL
      *-----------------------------------------------------------------
      * M.CASTILLO :140502:TB0094 : INCREASE THE LENGTH OF TRANS 17003 
      *-----------------------------------------------------------------
      * S. SANTOS  :020502:TB0096 : INTEREST PENALTY WAIVE
      *-----------------------------------------------------------------
      * WRCASTRO   :220502:TB0101 : ADD GRACE-PERIOD TO 12000/17000 TXN
      *-----------------------------------------------------------------
      * N Z Oblan  :100602:TB0084 : Add exposure 2 and 3 for consumer loans
      *-----------------------------------------------------------------
      * RIZA LADIA :100602:TB0069 : IR#32 Negotiated rates tbl will only
      *            :      :       : be used by combination negotiated - 
      *            :      :       : Consumer loans
      *-----------------------------------------------------------------
      * JOYCE HONG :140602:TB0107 : TIB IR FIXING
      *-----------------------------------------------------------------
      * M CASTILLO :310702:TB0117 : CALL UT0151 TO COMPUTE THE CHK DGT OF
      *                           : THE ACCT NO BEING CREATED WHEN
      *                           : SOC-ACCT-NO-FORMAT = 4
      *------------------------------------------------------------------
      * Cyn M Rojas:150802:TB0120 : Add validation for Interbranch
      *            :      :       : processing
      *------------------------------------------------------------------
      * J CHANCO   :170802:TB0125 : Add CUSTOMER BASED FEE 
      * JOEL BAJO  :270902:       : ACCESS CSCP VIA ALT-KEY
      *            :      :       : REPL CSCP-CUSTOMER-TYPE W/ -VIP-TYPE
      *------------------------------------------------------------------
      * S SANTOS   :270902:TB0070 : Revisit min and max repayment validation
      *                           : Add additional validation
      *---------------------------------------------------------------------
      * M CASTILLO :021002:TB0117 : RESERVE ACCOUNT NUMBER VALIDATIONS
      *---------------------------------------------------------------------
      * N. BENDIJO  :TB0165:271102 : ADD NEW TRANSACTION 17032
      *---------------------------------------------------------------------
      * R SORIANO  :270902:TB0152 : CALLS UT0028 MODULE TO PROCESS
      *                           : BROKERAGE/REFERRAL COMMISSIONS
      *------------------------------------------------------------------
      * KRodriguez :200902:TB0099 : INCLUDE THE FOLLOWING TO PRINCIPAL
      *                           : REPAYMENT TRANSACTIONS (13031/13131)
      *                           : 1. ADD FIELD TO INDICATE RECALCULA-
      *                           :    TION TYPE TO BE USED DURING PRIN-
      *                           :    CIPAL REPAYMENT
      *                           : 2. ADD HANDLING OF LOAN TERM REDUC-
      *                           :    TION AND LOAN REPAYMENT AMOUNT
      *                           :    RECALCULATION
      *------------------------------------------------------------------
      * KRodriguez :121202:TB0091 : ADD CHECK REPAYMENT FOR PDC
      *------------------------------------------------------------------- 
      * RIZA LADIA :211002:TB0069 : final FS / addtl requirements
      *                           : - new int plus accrual history enquiry
      *---------------------------------------------------------------------
      * V. DANO JR :TB0144:251002 : VALIDATE TELLER LIMIT (FSBRA0006)
      *-----------------------------------------------------------------
      * C.VILLAR   :TB0157:121002 : INSURANCE PREMIUM                 
      *-----------------------------------------------------------------
TB0105* C P BALISI :191202:TB0105 : ADD THE FF TXNS:
TB0105*                           :  17035 - LOAN EXTENSION
TB0105*                           :  17047 - LOAN RENEWAL
TB0105*                           :  17039 - LOAN PENDING RENEWAL INSTR
TB0105*                           :  17099 - LOAN PENDING RENWL INSTR PROMPT
TB0105*----------------------------------------------------------------
      * M.CASTILLO :251102:TB0082 : CREATE NEW TRNCODE 11057 11157 16057 16157
      *            :      :       : CORR/LOAN ADV TRANSFER TO GL
      *            :      :       : CORR/BACK VALUE LOAN ADV TRANSFER TO GL
      *-----------------------------------------------------------------
TB0102* BERVE SON  :010903:TB0102 : add txn 13110/13145/13046/13146/13011/
TB0102*                           : 13111 for discharge.
TB0102* BERVE SON  :020802:TB0102 : ADD CODE FOR NON-PERFORMING-LOANS
TB0102*------------------------------------------------------------------
      * Cyn M Rojas:301202:TB0104 : increased output msg length of scr1700
TB0172*-----------------------------------------------------------------
TB0172* B. TULAYAN :261202:TB0172 : CREATE NEW TRANSACTION  10447
TB0172*            :      :       : DISPLAY ADVANCE FEE DETAILS
TB0172*-----------------------------------------------------------------
TB0172* B. TULAYAN :080103:TB0172 : CREATE NEW TRANSACTION
TB0172*            :      :       : 13062/13162,13052/13152
TB0172*            :      :       : CALL UT0028 TO PROCESS CASH ADVANCE
TB0172*            :      :       : FOR CUSTOMER/ VIA TRANSFER.
TB0172*-----------------------------------------------------------------
TB0095* JTRAGANDAP :241002:TB0095 : FSLON0032: PENALTY REQUIREMENTS
TB0095*-----------------------------------------------------------------
TB0158* D.CUNANAN  :TB0158:TB0158 : FSLON0003 : INTEREST & PENALTY
TB0158*            :      :       : ADJUSTMENT
TB0158*-----------------------------------------------------------------
TB0158* F GONZALES :050203:TB0161 : FSLON0018 : ADD TXN 17086,17087,17089
TB0158*            :      :       : FOR NPL ENQUIRY
TB0158*-----------------------------------------------------------------
TB0198* BERVE SON  :160103:TB0198 : ADD PRROCESSING FOR 17033 (AGREE-
TB0198*                             MENT IND. MAINTENANCE)
TB0198*-----------------------------------------------------------------
TB0147*P CARANDANG :151102:TB0147 : CALL UTOVRD FOR SUPERVISORY OVERRIDE
TB0147*------------------------------------------------------------------
TB0155* D. CUNANAN :130203:TB0155 : FSLON0041 : ACCOUNT TRANSFER PROCESS
TB0155*------------------------------------------------------------------
TB0172* JOEL BAJO  :130203:TB0152 : REPOSITION CALL TO UT0028; INCLUDE
TB0172*                             BOISMAST/BORPARM IN LINKAGE AREA
TB0172*-----------------------------------------------------------------
TB0137* JOEL BAJO  :240203:TB0137 : FIX CALL PARAMS TO GL0023 - INCLUDED
TB0137*                           : UTVTACCA
TB0137*-----------------------------------------------------------------
TB0168* C VILLAR                  : ADD TXN 19099 AND 19098 AND THE UPDATE
TB0168*                           : OF SUBS RECORD
TB0168*-----------------------------------------------------------------
TB0223* BERVE SON  :110203:TB0223 : ADD PRROCESSING FOR 17034/17466/17467
TB0223*                             (DEFERRED REPAYMENT SCHEDULE).
TB0223*            :300403:TB0223 : ADD VALIDATIN FOR DEFERRED REPAYMENT.
TB0223*-----------------------------------------------------------------
TB0211* F GONZALES :070303:TB0211 : ADD BAD DEBT PROCESSING
TB0211*------------------------------------------------------------------
TB0190* JOEL BAJO  :200303:TB0190 : INTRODUCE GENERIC CUSTOMER INC/EXP.
TB0190* ROMMEL SORIANO            : TXNS - COLLECT/RECOLLECT/REFUND
TB0190*-----------------------------------------------------------------
      * RIZA LADIA :210303:TB0169 : FSLON0058 - NEW ACCOUNT OPENING
      *                           : ADD LOAN ACCT ADDITIONAL DETAIL TRANS
      *                           : 12006,12007,12008, 17036,17037,17038
      *-----------------------------------------------------------------
TB0215* YAKEE      :100203:TB0215 : FSLON0045 - TYPE
TB0215*                           : AMENT TO CALL BR0005 FOR THE FF:TRANCODE
TB0215*                           : 10722 - REPAYMENT CARD PRINT SCREEN   
TB0215*                           : 10723 - ACCT OUTSTANDING BALANCE PROOF REQ
TB0215*                           : 10724 - STATEMENT PRINT PROMPT SCREEN     
TB0215*                           : 10725 - POST OFC REM SLIP REPRINT SCR     
TB0215*                           : 10726 - REPAYMENT RECEIPT REPRINT SCR     
TB0215*                           : 10727 - INT REPAYMENT LIST REPRINT SCR    
TB0215*                           : 10728 - INT REPAYMENT LIST ENQ SCR
TB0215*-----------------------------------------------------------------
TB0159*MANIBAN     :260303:TB0236 : ADD 10460 TRANSACTION
TB0159*-----------------------------------------------------------------
      *LAI CASTILLO:290303:TB0236 : Accommodate Multiple Drawdown FSCIF0017
      */RIZA LADIA                
      *-----------------------------------------------------------------
      *M TAN       :140303:I40871 : Initialize UTOVRD error code
      *------------------------------------------------------------------
      *C VILLAR    :150403:TB0102 : ADDED TXN 13005 CALLING BR0018
      *------------------------------------------------------------------
TB0232*BERVE SON   :160403:TB0232 : BACKDATED REPAYMENT/CLOSURE MODIFICATIONS
TB0232*            :130503:TB0232 : MIN/MAX VALIDATION FIX FOR NORMAL
TB0232*            :      :       : AND BACKDATED REPAYMENT
TB0232*-----------------------------------------------------------------
TB0099*K RODRIGUEZ :230403:TB0099 : ADD CONDITION IN MIN/MAX REPAY VALIDATION
TB0099*-----------------------------------------------------------------------
TB0137* JK ESCANER :070503:TB0137 : ADD PROCESS FOR CAR LOAN SUBSIDY PROJ
TB0137*----------------------------------------------------------------------
TB0255* M ANIBAN   :100503:TB0255 : ADD 10915 and 10916 FOR YOUBE NEW2 JOINT
TB0255*                           : INSURANCE
      *-----------------------------------------------------------------
      * Cyn M Rojas:140503:TB0235 : ADD SAVED FIXED RATE FOR YOUBE LOANS
      *            :      :       : ADD VALIDATION FOR BLDVNI STRT DATE
      *            :      :       : LIMIT BACKDATE DAYS TO PREVIOUS DUE
      *            :      :       :    DATE OR TO 31 DAYS 
      *-----------------------------------------------------------------
      * JOEL BAJO  :170503:TP0026 : SKIP INT CALC FOR CUST-INC-EXP-FEES
      *            :190503:TB0172 : LEGAL-FEE1-DUE & LEGAL-FEE2-DUE SHLD
      *                           : BE 0 FOR TXN 13031
      *-----------------------------------------------------------------
      *C VILLAR    :200503:TB0196 : INCREASE MSG LENGTH OF 17000        
      *-----------------------------------------------------------------
TB0249* P CARANDANG:050503:TB0249 : LOAN SUPERVISOR OVERRIDE
TB0249*-----------------------------------------------------------------
TB0190* R SORIANO  :220503:TB0190 : ADDED INITIALIZATION CALL FOR UT0820
TB0190*-----------------------------------------------------------------
TB0226* C.SANTILLAN:200503:TB0226 : REFRESH MASK
TB0226*                           : REPLACE ALL "EI0085" TO "MI0095"
TB0226*                           : REPLACE ALL "EI0090" TO "MI0090"
TBN226*                           : SCHEDULE 85007 CUSTOMER LEVEL
TBN226*                           : IVR GRANT IS NO (CLCM-FLAG-NO)
TB0226*-----------------------------------------------------------------
      *EG ASPIRAS  :300503:SC0221 : ALLOW MULTIPLE DRAWDOWN FOR CREDIT
      *                           : TYPE "M"
      *-----------------------------------------------------------------
      * CBCORRAL   :300503:SC0377 : FIX READNEXT PROB IN INOD FOR MORT COMBI
      *-----------------------------------------------------------------
      * CBCORRAL   :300503:SC0398 : ADDL OD DETAILS NEEDED ON MORT COMBI CREATION
      *-----------------------------------------------------------------
      * FGONZALES  :060603:SC0460 : FIXED IR0460
      *-----------------------------------------------------------------
      * EG ASPIRAS :070603:SC0397 : BACK OUT SC0460 FIX
      *-----------------------------------------------------------------
TB0277* C.SANTILLAN:070603:TB0277 : ADDED CALL OF UT9008 TO SAVE INP-MSG
TB0277*                           : USE FOR ATM TRANSACTION
TB0277*-----------------------------------------------------------------
      * CPCHEN     :100603:SC0556 : THE INTER-BRANCH ENQUIRY WAS ALLOWED
      *                             WHEN ED2 IB-ALLOWED-FLAG=Y
      *-----------------------------------------------------------------
TB0267* J MADAMBA  :100603:TB0267 : CMINT0012- TO ADD FINANCIAL TRANSACTION MESSAGES
TB0267*                           : TO "EFTM" WHICH WILL BE USE FOR REVERSAL
TB0267*-----------------------------------------------------------------
      * EG ASPIRAS :100603:SC0827 : MOVE DEFAULT VALUE OF START METHOD
      *                           : FROM BORP-START-METH FOR TXN 12008
      *-----------------------------------------------------------------
      * JENNIFOR   :100603:SC0781 : FIXED SC0781
      *-----------------------------------------------------------------
SC0847* B. SON     :120603:SC0847 : INITIALIZE INT. ACCRUAL FOR ADVANCE
SC0847*            :              : PAYMENT.
SC0847*-----------------------------------------------------------------
SC0811* RIZA LADIA :130603:SC0811 : SCR12006/17036 Actl add apprv amt is
SC0811*                             info only and not BORM-ADD-LOAN-APP
SC0811*-----------------------------------------------------------------
SC0796* JENNIFOR   :140603:SC0796 : FIXED SCR0796. ADD GLDV TXN AND GLIF
SC0796*            :              : WHEN REPAY BY GL ACCOUNT.
SC0796*-----------------------------------------------------------------
      * EG ASPIRAS :150603:SC0883 : MOVE CALCULATION OF MIN DUE AMT FOR
      *                           : YOUBE LOANS FROM BR0024
      *-----------------------------------------------------------------
SC0553* D CUNANAN  :160603:SC0553 : FIX VALUE FOR BORM-DUE AMOUNT UPON 
SC0553*                           : PRINCIPAL REPAYMENT REPAY CALC = 2
SC0553*-----------------------------------------------------------------
SC0985* BERVE SON  :170603:SC0985 : DO NOT PERFORM H000-CALC-INT RTN
SC0985*            :      :       : FOR BACKDATED ADVANCE SINCE THEY
SC0985*            :      :       : ARE ALREADY COMPUTED IN BR0024.
SC0553*-----------------------------------------------------------------
TB0095* R SORIANO  :180603:TB0095 : SKIP MIN/MAX VALIDATION DURING
TB0095*            :      :       : MATURITY REPAYMENT
SC0553*-----------------------------------------------------------------
SC1231* M ANIBAN   :210603:SC1023 : correct calcalation of preferential
SC1231*                           : interest period
SC1231*----------------------------------------------------------------
SC1006* BERVE SON  :230603:SC1006 : Allow principal transaction with
SC1006*            :      :       : amount = loan balance.
SC1006*----------------------------------------------------------------
TB0274* S.Y. Tan   : 230603:TB0274: Credit Card Payment Customisation
TB0274*-----------------------------------------------------------------
SC1267* P CARANDANG:250603:SC1267 : HANDLE SUP FOR 12008 WHEN TRANSFERRED
SC1267*                           : TO 10915
SC1267*-----------------------------------------------------------------
SC1352* BERVE SON  :250603:SC1352 : Save borm record and restore borm 
SC1352*            :      :       : record when posting to GL account.
SC1352*-----------------------------------------------------------------
SC1223* JGONZALES  :260603:SC1225 : Remove screen 17032
SC1223*-----------------------------------------------------------------
SC1341* BERVE SON  :270603:SC1341 : Do not call H000-CALC-INT routine
SC1341*            :      :       : for prin. credit and correction.
SC1341*-----------------------------------------------------------------
TB0266* V. DAnO Jr :270603:TB0266 : FSADL004 - VOUCHER PRINTING Retrofit
TB0266*-----------------------------------------------------------------
SC1227* BERVE SON  :280603:SC1227 : Fix int. rate for min/max validation.
SC1227*-----------------------------------------------------------------
SC1313* BERVE SON  :280603:SC1313 : Do not call H000-CALC-INT for corr. 
SC1313*            :      :       : of repayments.
SC1313*-----------------------------------------------------------------
SC1278* RICKY TONG :280603:SC1278 : ADD SOC-DISP-DATE-FORMAT IN UT0018 LINKAGE
SC1278*-----------------------------------------------------------------------
SC1518* JGONZALES  :300603:SC1518 : CHANGE CONDITION FOR REPAY TRANS
SC1518*                           : WHEN LAST TERM
SC1518*-----------------------------------------------------------------
SC1520* CPCHEN     :020703:SC1520 : 17467 WILL NOT CALL UT0069
SC1520*-----------------------------------------------------------------------
SC3409* J MADAMBA  : 020703: TB0267: FRCMINT0012- EFTM - SC3409
SC3409*-------------------------------------------------------------------------
SC1476* CPCHEN     :030703:SC1476 : 17036 WILL CALL UTOVRD
SC1476*-----------------------------------------------------------------------
SC1650* J GONZALES :040703:SC1650 :  RECOMP OF DUE AMOUNT WHEN REPAY SCHED =B
SC1650*----------------------------------------------------------------------
SC1640* JENNIFOR   :040703:SC1640 : FIX TXN17046, HOME BRANCH AND PRODUCT TYPE
SC1640*                             CAN NOT BE UNPUTED AT THE SAME TIME.
SC1640*-----------------------------------------------------------------------
TB0267* J MADAMBA  : 190503 TB0267: Added new transaction codes 14045, 14055, 14400
TB0267*-----------------------------------------------------------------------
SC1668* BERVE SON  :050703:SC1668 : ADD 16046 TRAN FOR G/L TRANSFER FOR
SC1668*            :              : BACKDATED REPAYMENTS.
SC1668*----------------------------------------------------------------------
SC0375* R SORIANO  :040703:SC0375 : DISPLAYS DATA FROM CIEA INSTEAD OF BOIS
SC0375*            :      :       : FOR BROKERAGE COMMISSION FIELDS
SC1669*            :070703:SC1669 : INCLUDED BUSS-COMM FIELD PROCESSING
SC0375*----------------------------------------------------------------------
SC1543* BERVE SON  :070703:SC1543 : CHECK IF PRIORITIZED BEFORE ADDING TO
SC1543*            :      :       : MIN/MAX VALIDATION
SC1543*----------------------------------------------------------------------
SC1740* J GONZALES :080703:SC1740 : CALL UT0075 TO RECALCULATE DUE-AMT,
SC1740*                           : INT-INCR, NEXT DUE DATE FOR NORMAL 
SC1740*                           : REPAYMENT AND PRINCIPAL CREDIT
SC1740*----------------------------------------------------------------------
SC1743* A-SAM      :070703:SC1743 : 17036 WILL CALL UTOVRD
SC1743*----------------------------------------------------------------------
SC1681* A-SAM      :090703:SC1681 : DON'T RE-CALCULATE DUE-AMT WHEN
SC1681*                             REPAYMENT REPAY SCHED 'F'
SC1681*----------------------------------------------------------------------
SC1214* MCCASTILLO :090703:SC1214 : TO FIX THE CORRECTION OF ADVANCE
SC1214*                             TRANSACTIONS
SC1214*----------------------------------------------------------------------
SC1864* J GONZALES :100703:SC1864 : Fixed recalculation of due-amount
SC1864*                           : for repay-sched = 'G'
SC1864*----------------------------------------------------------------------
      * JOEL BAJO  :100703:SC1867 : FIX LINKAGE AREA OF 17048
      *----------------------------------------------------------------------
SC1605* BERVE SON  :100703:SC1605 : RECOMPUTE DUE AMOUNT FOR AGREED INSTALLMENT
SC1605*            :      :       : ACCOUNTS AFTER SETUP OF NEGOTIATED REPAYMENT
SC1605*----------------------------------------------------------------------
SC1701* A-SAM      :110703:SC1701 : SET 10241 10242 10243 10244 CHK SUP
SC1701*---------------------------------------------------------------------
SC1551* RICKY TONG :110703:SC1551 : SEND ACCT-TYPE/INTCAT FOR BANCSLINK WORKFLOW
SC1551*---------------------------------------------------------------------
SC1667* BERVE SON  :110703:SC1667 : Recompute DUE-AMT, INCR using new codes
SC1667*            :              : in H000-CALC-INT.
SC1667*----------------------------------------------------------------------
      * CBCORRAL   :120703:SC1171 : AUTO PRINC REPAYMENT THRU STANDING ORDER
      *----------------------------------------------------------------------
      * JOEL BAJO  :130703:SC1867 : 17048 NOW JUST A RETURN (ENQUIRY) SCREEN
      *----------------------------------------------------------------------
SC1742* BERVE SON  :130703:SC1742 : ALLOW LAST TERM REPAYMENTS FOR COMMERCIAL
SC1742*            :      :       : ACCOUNTS.
SC1742*            :140703:SC1742 : FOR REPAY_SCHED "B" ALLOW INTEREST ONLY 
SC1742*            :      :       : PAYMENTS FOR COMMERCIAL LOANS FOR LAST PAY.
SC1742*---------------------------------------------------------------------
SC1961* BERVE SON  :140703:SC1961 : USE COMPUTATION OF DUE-AMT IN H000-CALC-INT
SC1961*            :      :       : ROUTINE FOR BACKDATED ADVANCE TRAN.
SC1961*---------------------------------------------------------------------
SC2076* BERVE SON  :150703:SC2076 : DO NOT RECOMP. NEXT DUE DATE AND LAST UNPAID
SC2076*            :      :       : DUE DATE.
SC2076*---------------------------------------------------------------------
SC2000* BERVE SON  :150703:SC2000 : FIX EFF-DATE IN CALLING UT0075 IN PARAGRAPH
SC2000*            :      :       : H000-CALC-INT.
SC2000*---------------------------------------------------------------------
SC2078* MCCASTILLO :150703:SC2078 : MOVE BORP-BRKR-DEDUCT-COMM-AMT TO
SC2078*            :      :       : WA-12006-BUS-COMM.
SC2078*---------------------------------------------------------------------
SC1779* BERVE SON  :160703:SC1779 : FIX UPDATE OF BORM-INT-ACCR FOR NORMAL REPAY.
SC1779*---------------------------------------------------------------------
SC1794* J GONZALES :180703:SC1794 : RECOMP OF DUE AMT FOR REPAY SCHED = "K"
SC1794*---------------------------------------------------------------------
SC2192* BERVE SON  :180703:SC2192 : ADD PROCESSING FOR FLOATINF RATE BACKDATED
SC2192*            :      :       : ADVANCE.
SC2192*---------------------------------------------------------------------
SC2206* A-SAM      :180703:SC2206 : CHECK REPAYMENT WHEN CASH TXN
SC2206*---------------------------------------------------------------------
SC2144* JENNIFOR   :180703:SC2144 : EXECUTE TXN11044, THE INT INCR SHOULD
SC2144*            :      :       : BE CHANGED WITH THE LOSS OF PRINCIPAL
SC2144*---------------------------------------------------------------------
SC2200* RICKY TONG :180703:SC2200 : SEND ACCT-TYPE/INTCAT FOR BANCSLINK WORKFLOW
SC2200*---------------------------------------------------------------------
SC1857* EG ASPIRAS :180703:SC1857 : GRACE PERIOD PROCESSING FOR YOUBE
SC1857*---------------------------------------------------------------------
SC1574* JEREMY LAU :190703:SC1574 : FIX UT0820 LINKAGE
SC1574*---------------------------------------------------------------------
SC2241* CPCHEN     :190703:SC2241 : ERROR HANDLE WHEN BR0001/UT0001
SC2241*                             RETURN ERROR MESSAGE
SC2241*---------------------------------------------------------------------
SC2285* CPCHEN     :210703:SC2285 : PRINCIPAL CREDIT SHOULD NOT MOVE
SC2285*                             VALUE TO UT0075CA-CALC-EQUAL-PRIN
SC2285*---------------------------------------------------------------------
TB0280* C.SANTILLAN: 100703: TB0280: ADD CALL OF UT9008 FOR PROMO NO (CMINT0014)
TB0280*-------------------------------------------------------------------------
      *RS MARCELINO: 220703:TB0273 : FOR FEDI BILLS PAYMENT CHARGES
      *---------------------------------------------------------------------
      * CPCHEN     : 230703:SC2292 : RECALC SH INCLUDE REPAY-SCHED='G'
      *---------------------------------------------------------------------
SC2452* BERVE SON  : 230703: SC2452: ALLOW DISCHARGE AFTER MATURITY
SC2452*---------------------------------------------------------------------
      * CPCHEN     : 230703:SC2374 : PRIN CREDIT NEED TO UPD INT-INCR IN
      *                              ANY RECALC INDICATOR
      *---------------------------------------------------------------------
SC2380* A-SAM       :220703:SC2380 : CASH TXN More Than SOC-DCSH-LIMT-DR
SC2380*                              Show WANRING MESSAGE  
SC2380*-----------------------------------------------------------------
      *V. DAnO JR  : 230703:SC2272 : LOG FISRT ADVANCE DATE IN BOIS,
      *                            : IF DRAW DOWN TRANSACTION.
      *---------------------------------------------------------------------
SC2459* BERVE SON  : 230703:SC2459 : ZERO OUT INT. INCR IF LOAN BAL. IS ZERO.
SC2459*------------------------------------------------------------------
SC2420* JEREMY LAU : 230703:SC2420 : FIX INCORRECT JNRST GLCC 
SC2420*------------------------------------------------------------------
SC2462* A-SAM      : 240703:SC2462 : RESET FEE-CHRG-TYPE-11045
SC2462*------------------------------------------------------------------
SC2269* A-SAM      :240703:SC2269 : CHANGE ERR MSG FOR REPAYMENT
SC2269*-----------------------------------------------------------------
SC2355* M ANIBAN   :250703:SC2355 : ERROR MESSAGE IS WRONG WHEN ACCT
SC2355*                             NOT ADVANCE
SC2355*------------------------------------------------------------------
SC2150* CPCHEN     :250703:SC2150 : FORCE TO MOVE 0 WHEN ACCOUNT WAS
SC2150*                             SOLD TO AMC
SC2150*------------------------------------------------------------------
SC2538* CPCHEN     :260703:SC2538 : AFTER DISCHARGE, MOVE 0 TO DUE-AMT &
SC2538*                             INT-ACCR WHEN ENQUIRY
SC2538*------------------------------------------------------------------
SC2606* CPCHEN     :280703:SC2606 : WHEN VALIDATE THE INPUT AMT,CONSIDER
SC2606*                             THE PENALTY BY CALLING 'UT0072'
SC2606*------------------------------------------------------------------
SC2593* MANIBAN    :290703:SC2593 : FIX FOR IR2593 - MIN DUE AMOUNT
SC2593*------------------------------------------------------------------
SC1514* CANDICE C  :260703:SC1514 : FIX WARNING MSG WHEN TODAY CR/DR
SC1514*                             ACUMLATION AMT OVER LIMIT
SC1514*-----------------------------------------------------------------
SC2527* A-SAM      :290703:SC2527 : (29) SAVE-DATA COPY TO UT0060-SAVE
SC2527*-----------------------------------------------------------------
      *C.S GODOY :290703:TB0212 : INCREASED THE RECORD SIZE TO 982.     TB0212-C
      *-----------------------------------------------------------------TB0212-C
SC2681* CPCHEN     :300703:SC2681 : FIXED THE LOGICAL COMPARISON
SC2681*------------------------------------------------------------------
SC1599*JK ESCANER  :310703:SC1599 : POPULATE THE PROPER BUCKET AMTS 
SC1599*            :      :       :   TO JRNL AMT FIELD
SC1599*            :      :       : FIX BUCKET JRNL TRAN  CODE    
SC1599*            :180803:       : BUCKET CODES SHLD BE M,L,A,D,I,C,Z,X,T,R
SC1599*------------------------------------------------------------------
SC2620* BERVE SON  :310703:SC2620 : ALLOW SUBSIDY DETAILS ENQUIRY EVEN IF
SC2620*            :      :       : ACCOUNT ALREADY DISCHARGED.
SC2620*------------------------------------------------------------------
SC0865* MCCASTILLO :310703:SC0865 : INITIALIZE UT5001CA-CALL-AREA TO CORRECT
SC0865*            :      :       : THE PROCESSING OF AUTO ACCT NUMBERING.
SC0865*------------------------------------------------------------------
SC2437* CPCHEN     :010803:SC2437 : CONSIDER THE BUCV AFTER WAIVING
SC2437*------------------------------------------------------------------
SC2156* JK ESCANER :020803:SC2156 : FIX FOR SCR 2156 - WRITE TO JR TABLE
SC2156*            :      :       : POPULATE JNRST-TRANSFER-TXN-BRANCH
SC2156*            :      :       :  FOR TXN 11044, 11144, 11048, 11148
SC2156*------------------------------------------------------------------
SC2439* BERVE SON  :040803:SC2439 : FIX MIN/MAX VALIDATION FOR DEFERRED LOANS.
SC2439*------------------------------------------------------------------
SC2292* CPCHEN     :060803:SC2292 : REPAY-SCHED='G',BASE ON LOAN-REPAY
SC2292*------------------------------------------------------------------
SC2691* J MADAMBA  :060803:SC2691 : FIXED TWO TIMES REPLY OF BANCS TO TPS-
SC2691*                           : INITIATED SHORT INQUIRY TRANSACTION (10400)
SC2691*------------------------------------------------------------------
SC2943* J GONZALES :060803:SC2943 : REMOVE MIN/MAX VALIDATION FOR
SC2943*                           : REPAY SCHED = "J" 
SC2943*------------------------------------------------------------------
      * G QUIJANO  :060803:SC0273 : CALL "UTHIST" CALL-CODE = 01
      *                             IN INITIALIZATION PART TO SPEED UP
      *                             READING IN SUCEEDING CALL   
      *------------------------------------------------------------------
      * A-SAM      :070803:SC2981 : CASH TXN MORE THEN 3000000 NEED SUP
      *                             13010 ADD REAPY AMT TO TOD-CASH-DR
      *                    SC2998 : REAPYMENT TXN DON'T NEED CHK STAT 50
      *------------------------------------------------------------------
      * A-SAM      :070803:SC2936 : (05) TXN DON'T NEED CHK STAT 50
      *------------------------------------------------------------------
      * KUGAR LIN  :080803:SC2881 : SCHEDULE 85007 WHEN CLCM MRNF
      *------------------------------------------------------------------
      * JOEL BAJO  :080803:SC3071 : ADD RT-INCR TO EFF RT IN PARAG XLOAD
      *------------------------------------------------------------------
      * KUGAR LIN  :090803:SC2417 : DISPLAY MESSAGE WHEN CUSTOMER IS DECEASED.
      *------------------------------------------------------------------
      * CPCHEN     :090803:SC3118 : NO NEED TO CHECK BUCKET PRIORITIZED
      *                             OR NOT IN THE NORMAL REPAYMENT
      *------------------------------------------------------------------
SC3174* BERVE SON  :110803:SC3174 : FIX ZERO OUT INT. ACCR FOR GL REPAYMENTS.
SC3174*------------------------------------------------------------------
SC3158* BERVE SON  :110803:SC3158 : FIX COMP. OF DUE AMT AFTER GRACE PERIOD.
SC3158*------------------------------------------------------------------
SC3120* R SORIANO  :120803:SC3120 : BANK-RATE FIELD DEFAULT VAL IN 12006
SC3120*            :      :       : MUST BE A/C RATE FROM 12000
SC3120*------------------------------------------------------------------
SC2882* S.Y. TAN   :120803:SC2882 : FIXED IR 2882
SC2882*------------------------------------------------------------------
      * CPCHEN     :140803:SC3295 : ADJUST THE VALIDATION WHEN ACCOUNT
      *                             WAS MATURED
      *------------------------------------------------------------------
SC2345* JENNIFOR   :140803:SC2345 : FIXED THE CORRECTION TXN FOR 13131.
SC2345*------------------------------------------------------------------
SC3189* J GONZALES :140803:SC3189 : REMOVE VALIDATION OF PRINCIPAL RECALC
SC3189*                           : TYPE IN BR0000  
SC3189*------------------------------------------------------------------ 
TP0053* F GONZALES :150803:TP0053 : FIXXED TRAN TIME OUT VIA REPAYMENT
TP0053*                             NPL. fom YOU-BE
TP0053*------------------------------------------------------------------
S20175* RICKY TONG :150803:SC0367 : ADD ALL-BRANCH MIMA VALIDATION.
SC0367*------------------------------------------------------------------
      * CPCHEN     :160803:SC2159 : GET ORIGINAL REPAY-PRIN-RECALC-IND
      *                             BY READING BUCV
      *------------------------------------------------------------------
      * JOYCE HONG :160803:SC2591 : FIX CONDITION FOR EXECUTING UTOVRD.COB
      *------------------------------------------------------------------
      * CPCHEN     :180803:SC3170 : FIX CONDITION FOR CHECKING CASH LIMIT
      *------------------------------------------------------------------
SC3511* BERVE SON  :180803:SC3511 : SAVE BORM BEFORE CALL TO UT0014.
SC3511*------------------------------------------------------------------
SC3441* SYT        :190803:SC3441 : FIX BUCKETS BALANCE XFER for txn 17046
SC3441*------------------------------------------------------------------
SC3314* B. TULAYAN :200803:SC3314 :REMOVE GL POSTING OF TXN 11048 11148
SC3314*------------------------------------------------------------------
SC3572* BERVE SON  :200803:SC3572 :Change error message from 190 to 4150 for
SC3572*                           :backdated transactions.
SC3572*------------------------------------------------------------------
SC3569* BERVE SON  :200803:SC3569 : FIX ADJUSTMENT OF ACCRUAL FOR BACKDATED
SC3569*                           : ADVANCE WHEN LOAN HAS ALREADY AN ACCRUAL.
SC3569*------------------------------------------------------------------
SC3535* J MADAMBA  :210803:SC3535 : IMPLEMENT NEW COPYBOOKS CONTAINING
SC3535*                           : TRANSACTION CODES WITH NO REFRESH
SC3535*                           : (short enquiry return screens, et al)
SC3535*------------------------------------------------------------------
      * JOEL BAJO  :210803:SC2676 : ADD GUARANTEE LOAN PROCESSING
      *------------------------------------------------------------------
      * CBCORRAL   :210803:SC3366 : BYP VALIDATION FOR OFFSITE TXN
      *------------------------------------------------------------------
SC3625* B.TULAYAN  :210803:SC3625 : FIX GLIF ENTRY FOR ADJUST TXN
SC3625*------------------------------------------------------------------
      * CPCHEN     :230803:SC3737 : REVISE THE FORMULA OF MIN/MAX
      *                             REPAY AMOUNT
      *------------------------------------------------------------------
SC3673* BERVE SON  :230803:SC3673 : REVISE PROCESSING OF AGREEMENT INSTALL
SC3673*                             REPAYMENT.
SC3673*------------------------------------------------------------------
SC3773* M GARCIA   :230803:SC3773 : DEFAULT VALUE OF ACCESS FLAG TO Y
SC3773*-----------------------------------------------------------------
SC3658* BERVE SON  :250803:SC3658 : FOR BACKDATE PRIN. CREDIT AMOUNT IS
SC3658*                             POSITIVE.
SC3658*------------------------------------------------------------------
SC3775* LISA MA    :250803:SC3775 : SET WA-REPAY-DEFER-DAYS TO 0 FOR 14010
SC3775*            :      :       : AND 14030 FOR ATM TXNS.
SC3775*------------------------------------------------------------------
SC1772* Y.N. KIM   :230803:SC1772 : FIX JRNL SIGN FOR CLOS TXN AMT & WRITE
SC1772*            :      :       : NON-FINANCIAL TXN FOR CLOS MAIN TXN.
SC1772*------------------------------------------------------------------
SC3739* BERVE SON  :260803:SC3739 : MOVE ADVANCE AMOUNT FOR CALLING UT0683.
SC3739*------------------------------------------------------------------  
SC2371* BERVE SON  :270803:SC2371 : Fix value for JRNST-TXN-TRANSFER-BRANCH. 
SC2371*------------------------------------------------------------------    
SC2759* BERVE SON  :270803:SC2759 : Fix GL entries for 16046 tansaction.  
SC2759*------------------------------------------------------------------ 
SC2760* BERVE SON  :280803:SC2760 : Fix GL entries for 16146 tansaction. 
SC2760*------------------------------------------------------------------
SC3719* A-SAM      :280803:SC3719 : SET SUBS-STOP-DATE WHEN DISCHARGE
SC3719*------------------------------------------------------------------
SC3109* B.TULAYAN  :280803:SC3109 : CREATE GLIF ENTRY FOR PENALTY TXN.
SC3109*------------------------------------------------------------------
      * JOEL BAJO  :280803:SC3840 : FIX LINKAGE AREA OF UT0028
      *------------------------------------------------------------------
      * KUGAR LIN  :280803:SC2419 : ADD FUNC TO SHOW USER-DEF-CODES.
      *------------------------------------------------------------------
SC3429* BERVE SON  :280803:SC3429 : Fix validation of Agreement Installment.
SC3429*------------------------------------------------------------------   
SC3849* Y.N. KIM   :280803:SC3849 : FIX JRNL TRF BRCH FOR 11X48/16X48 TXNS.
SC3849*------------------------------------------------------------------
SC2302* Y.N. KIM   :280803:SC2302 : FIX JRNL HOME BR FOR GL TXNS(NO SUSP).
SC2302*------------------------------------------------------------------
      * CPCHEN     :290803:SC4030 : REMOVE THE VALIDATION
      *------------------------------------------------------------------
      * CPCHEN     :290803:SC3992 : VALIDATE THE AMOUNT OF ADJUSTMENT
      *------------------------------------------------------------------
SC3922* B. TULAYAN :280803:SC3922 : DEFAULT HIGH INT FROM PRODUCT PARAM.
SC3922*------------------------------------------------------------------
SC3970* BERVE SON  :290803:SC3970 : INCLUDE ADV. CORR. IN H000-CALC-INT.      
SC3970*------------------------------------------------------------------
SC4036* A-SAM      :290830:SC4036 : SUBS-STOP-REASON DESC IN CHINESE
SC4036*------------------------------------------------------------------
      * KUGAR LIN  :300803:SC4085 : FIX FUNC TO SHOW USER-DEF-CODES.
      *-----------------------------------------------------------------
SC3865* BERVE SON  :300803:SC3865 : Post neg. rate after creation.       
SC3865*------------------------------------------------------------------
SC4095* BERVE SON  :300803:SC4095 : No validation for correction of repay for
SC4095*            :      :       : agreement installment repayment.         
SC4095*------------------------------------------------------------------    
SC2046* MANIBAN    :020903:SC2046 : ADDED NEW TXN 17468 & 17469 FOR
SC2046*                             AOID-TRANSFER
SC2046*-------------------------------------------------------------------
SC3712* MANIBAN    :020903:SC3712 : IR FIX 3712
SC3712*-------------------------------------------------------------------
      * KUGAR LIN  :030903:SC0204 : AMEND FUNC TO SHOW USER-DEF-CODES.
      *------------------------------------------------------------------
SC4127* BERVE SON  :030903:SC4127 : DO NOT PROCESS TRN 17467 IN H000-CALC.
SC4127*------------------------------------------------------------------
SC4259* CPCHEN     :040903:SC4259 : FIX THE PARAMETER FOR READING BLDVNN
SC4259*------------------------------------------------------------------
      * A-SAM      :040903:SC4159 : CHECK MIN-MAX USE WA-BAD-DEBT-IND-2
      *------------------------------------------------------------------
SC2263* FGONZALES  :050903:SC2263 : FIX GLIF MANUAL TRANSFER OF NPL/BD
SC2263*------------------------------------------------------------------
SC3144* F GONZALES:050903: SC3144 :  GLIF ENTRY FOR 18214 18215
SC3144*--------------------------------------------------------------------
SC4330* CPCHEN     :060903:SC4330 : IGNORE THE PAID P BUCKET ; WHEN A
SC4330*                             BUCV EXIST, NO NEED TO CALC PENALTY
SC4330*------------------------------------------------------------------
SC3121* MANIBAN    :060903:SC3121 : CORRECT THE GLIF ENTRY FOR txn98904
SC3121*-------------------------------------------------------------------
SC4091* BERVE SON :060903: SC4091 : RECOMPUTE DUE AMOUNT AFTER CANCEL OF   
SC4091*                           : DEFERRED PERIOD.                       
SC4091*--------------------------------------------------------------------
SC4430* BERVE SON  :080903:SC4430 : FIX POSTING OF NEGOTIATED FLOATING RATES
SC4430*                             AFTER MAINTENANCE.                      
SC4430*------------------------------------------------------------------   
      * A-SAM      :080903:SC4246 : WRITE BUCV WHEN P-AMT < 0 THEN * -1
      *-----------------------------------------------------------------
SC4387* BERVE SON  :080903:SC4387 : FIX GLIF ENTRIES FOR AGREEMENT BUCKETS 
SC4387*------------------------------------------------------------------  
S20175* KUGAR LIN  :090903:SC3838 : FIX ALL BRANCH MIMA RETRY LIMIT
      *------------------------------------------------------------------
      * CPCHEN     :100903:SC3441 : SOME BUCKETS HAVE TO TRANSFER BOTH
      *                             CONTROL AND CONTRA IN TXN 17046
      *-----------------------------------------------------------------
      * CPCHEN     :100903:SC4000 : WRITE JR01 FOR INT-ACCR IN 17046
      *-----------------------------------------------------------------
      * LISA MA    :100903:SC4420 : NOT REQUIRED TO LOG BUCKETS IF UT0094
      *                             NOT CALLED BEFORE.
      *------------------------------------------------------------------
SC4475* BERVE SON  :110903:SC4475 : CREATE JOURNAL ENTRIES FOR UNBILLED  
SC4475*                             INTEREST AFTER DISCHARGE.            
SC4475*------------------------------------------------------------------
SC4506* A-SAM      :110903:SC4506 : EARLY REPAY ADD OUTPUT AFTER PRINTER
SC4506*------------------------------------------------------------------
SC4561* FGONZALES  :110903:SC4561 : BY PASS H000-CALC-INT WHEN BAD-DEBT
SC4561*------------------------------------------------------------------
      * CPCHEN     :110903:SC4472 : RECALC DUE-AMT IF PRIN DEFERRED
      *                             PERIOD EXPIRED
      *------------------------------------------------------------------
      * JOYCE HONG :110903:SC4274 : FIX SUP-OVERRIDE FOR TXN 13031
      *------------------------------------------------------------------
      * MANIBAN    :110903:SC2908 : fix ir 2908
      *------------------------------------------------------------------
      * J MADAMBA  :110903:SC4465 : FIX OUTPUT FORMAT FOR TPS INITIATED TRXN WITH FLAG 1 = 6
      *------------------------------------------------------------------
SC3975* R SORIANO  :110903:SC3975 : MOVED RECEIPT PRINTING FROM UT0028
SC3975*------------------------------------------------------------------
SC4554* B. TULAYAN :120903:SC4554 : FIX PENALTY GLIF ENTRY.
SC4554*------------------------------------------------------------------
      * PENNY HUANG:120903:SC3842 : FIX LON TO GEN TXN  (11048/16048)
      *                             21055/26155 FOR SRN TRN-CODE USE.
      *------------------------------------------------------------------
SC4404* LISA MA    :130903:SC4404 : NEED DISPLAY ERROR WHEN ERROR NO 459
SC4404*------------------------------------------------------------------
SC3173* FGONZALES  :130903:SC3173 : GLIF ENTRY FOR MISC-INCOME OF NPL CASH
SC3173*------------------------------------------------------------------
SC4485* BERVE SON  :130903:SC4485 : Fix tranfer txn branch for disch. via GL
SC4485*------------------------------------------------------------------   
SC4333* B. TULAYAN :130903:SC4333 : FIX GLIF INTERBRANCH ADJUSTMENT TXN
SC4333*------------------------------------------------------------------
SC4631* A-SAM      :130903:SC4631 : BACKDATING IN CORRECTION DON'T SUP
SC4631*------------------------------------------------------------------
SC4446* C.SANTILLAN:150903:SC4446 : ADD LON DETAILS FOR REFRESH
SC4446*------------------------------------------------------------------
      * V DAnO JR  :150903:ST0038 : SAVE ORIGINAL TRAN CODE USE FOR VOUCHER, SOME
      *                           : TRANSACTION DONT RETURN ORIGNAL TRAN CODE
      *                           : CAUSE OF VOUCHER TRANSACTION ERR
      *-------------------------------------------------------------------------
SC4645* CPCHEN     :150903:SC4645 : COULD NOT OVERRIDE IF PENALTY SETTING
SC4645*                             TXN WAS DONE (17085)
SC4645*------------------------------------------------------------------
SC4203* J MADAMBA  :150903:SC4203: NO SUPERVISOR OVERRIDE FOR TPS INITIATES TRXN
SC4203*------------------------------------------------------------------
SC4719* J MADAMBA  :160903:SC4719: REFER TO IR 4719
SC4719*----------------------------------------------------------------------
      * V DAnO JR  :160903:ST0038 : RETURN PREVIOUS TRAN CODE USING "OL" FOR
      *                           : COLL/ADVANCE TRANSACTION
      *-------------------------------------------------------------------------        
SC4682* JEREMY LAU :160903:SC4682: FIX 10240 JNRST-GL-CLASS-CODE
SC4682*----------------------------------------------------------------------
SC4680* Berve Son  :160903:SC4680 : FORCE BILLING FOR 17033 SCREEN.      
SC4680*------------------------------------------------------------------
SC1959* FGONZALES  :170903:SC1959 : NPL DISCHARGE
SC1959*-----------------------------------------------------------------
SC4726* BERVE SON  :170903:SC4726 : ALLOW ZERO AMOUNT CANCEL FOR DEFFERED INT.
SC4726*------------------------------------------------------------------     
SC4465* J MADAMBA  :170903:SC4465 : IR 4465
SC4465*-----------------------------------------------------------------------
SC4148* BERVE SON  :170903:SC4148 : Fix TRANSFER-TXN-BRANCH FOR 11046/11146
SC4148*------------------------------------------------------------------ 
SC4781* J MADAMBA  :170903:SC4781 : INITIALISE FEE-AMT 
SC4781*------------------------------------------------------------------
      * PENNY HUANG:170903:SC3833 : FIX LON TO GEN TXN  (11045/11046)
      *-------------------------------------------------------------------------
SC4490* LISA MA    :170903:SC4490 : COMMENT OUT ST-ATM-UPDT-FLAG = "U", SO ATM
SC4490*                           : TXN WILL UPDATE BORM.
SC4490*-----------------------------------------------------------------------
SC3491* CPCHEN     :190903:SC3491 : WRITE THE BALANCE OF CIEA TO JR01
SC3491*                             WHEN BRANCH CHANGED
SC3491*------------------------------------------------------------------
SC4799* BERVE SON  :190903:SC4799 : FIX CALL TO UT0312 IN J200 ROUTINE.       
SC4799*-----------------------------------------------------------------------
SC4803* J MADAMBA  :190903:SC4803 : FIXED WRITING OF JR01 FOR 14060 TRNSACTION CODE
SC4803*-----------------------------------------------------------------------
SC4881* BERVE SON  :190903:SC4881 : FIX GLIF ENTRIES FOR AGREE INSTALLMENT.
SC4881*------------------------------------------------------------------  
SC4276* J MADAMBA  :210903:SC4276 : FIXED "RF" MESSAGE FORMAT OUTPUT
SC4276*------------------------------------------------------------------  
SC4914* J MADAMBA  :210903:SC4914 : FIXED AVAILABLE BALANCE FOR ATM LOAN TRXNS
SC4914*------------------------------------------------------------------  
SC3909* J MADAMBA  :210903:SC3909 : FIXED SIGNATORIES VALUE FOR "RF" MESSAGE
SC4914*------------------------------------------------------------------  
SC4881* BERVE SON  :220903:SC4881 : FIX GLIF ENTRIES FOR AREARS OF AGR. INS.
SC4881*------------------------------------------------------------------   
SC4932* CPCHEN     :230903:SC4932 : NO RECALC FOR REPAYMENT IN ADVANCE
SC4932*------------------------------------------------------------------
SC4696* FGONZALES  :230903:SC4696 : TRANFER CORRECTION GLIF ENTRY
SC4696*-----------------------------------------------------------------
SC4890* J MADAMBA  :230903:SC4890 : UPDATE LOAN BALANCE FOR LOAN ATM TRXN
SC4890*-----------------------------------------------------------------
SC4383* CPCHEN     :230903:SC4383 : SET FIELDS FOR MULTI-PERIOD RATE AFTER 17026
SC4383*------------------------------------------------------------------
SC5014* FGONZALES  :230903:SC5014 : TRANFER NPL TO BAD-DEBT GLIF
SC5014*-----------------------------------------------------------------
SC4691* B. TULAYAN :230903:SC4691 : DEFAULT CONTRACT RATE BASED ON BASED ID
SC4691*-----------------------------------------------------------------
SC4522* LISA MA    :230903:SC4522 : REWRITE FEDI FUNCTION                
SC4522*-----------------------------------------------------------------
SC3909* J MADAMBA  :240903:SC3909 : FIX HOME BRANCH FOR 14010 AND 14030 TRXNS
SC0909*-----------------------------------------------------------------
SC4907* BERVE SON  :240903:SC4907 : FIX UPDATE OF EXPOSURE DURING REPAYMENT.
SC4907*                           : PRINCIPAL BUCKETS ONLY SHOULD BE USED.  
SC4907*-----------------------------------------------------------------    
SC5098* BERVE SON  :240903:SC5098 : FIX BACKDATE ADV. W/ FLOATING RATES.
SC5098*-----------------------------------------------------------------    
SC4954* B. TULAYAN :250903:SC4954 : CREATE TXN 25 FOR TEMP RECEIVABLE
SC4954*-----------------------------------------------------------------
SC3909* J MADAMBA  :250903:SC3909 : FIXED "0111" ERROR MESSAGE FOR A SUCCESSFUL TRXN(INTERNAL PROMO)
SC3909*-----------------------------------------------------------------
SC5098* BERVE SON  :250903:SC5098 : FIX BACKDATE ADV. W/ FLOATING RATES.
SC5098*-----------------------------------------------------------------    
SC5121* B. TULAYAN :270903:SC5121 : FIX TEMP RECEIVABLE FOR YOUBE
SC5121*-----------------------------------------------------------------
SC5138* CPCHEN     :290903:SC5138 : SET CORRECT TO_ACCT FOR PREMIUM
SC5138*-----------------------------------------------------------------
SC3972* LISA MA    :270903:SC3972 : FIX CALL UT9008 ERROR
SC3972*-------------------------------------------------------------------------
SC5203* MCCASTILLO :290903:SC5203 : FOR CANCELLED LOAN ACCTS, CHECK IF IT IS
SC5203*                           : LINKED TO AN EXPO FAC, IF YES RETURN THE
SC5203*                           : AMT TO THE EXPO FAC AND REMOVE THE LINK
SC5203*-----------------------------------------------------------------
SC3974* CBCORRAL   :290903:SC3974 : ROUND MIN DUE AMT TO HANDLE SO USING
SC3974*                           : REPAY SCHED G
SC3974*-----------------------------------------------------------------
SC5037* BERVE SON  :290903:SC5037 : FIX UPDATE OF EXPO. DURING DISCH.     
SC5037*------------------------------------------------------------------ 
SC4775* LISA MA    :300903:SC4775 : FIX WA-DEBIT-REPAY-TRCODE RELATED PROBLEM
SC4775*-------------------------------------------------------------------------
SC5150* B.TULAYAN  :300903:SC5150 : POPULATE BORV-34 FOR PREF INT
SC5150*------------------------------------------------------------------
SC5206* LISA MA    :300903:SC5206 : ADD VIRTUAL ACCOUNT VALIDATION           
SC5206*-------------------------------------------------------------------------
SC5150* MIKE TIEN  :011003:SC5259 : ENABLE DISCHARGED ACCT. IN TXN.10724 & 10726      
SC5150*------------------------------------------------------------------             
      * LISA MA    :011003:SC5265 : ADD NEW VALUE "B" FOR STRT-AREA-VIRTUAL-ACCT-FLAG
      *--------------------------------------------------------------------------
SC5219* CPCHEN     :011003:SC5219 : UPDATING RATE-EXP-DATE WHEN CREATING
SC5219*                             NEW RECORD OF BLDVNI
SC5219*------------------------------------------------------------------
SC4701* F GONZALES :011003:SC4701 : GLIF ENTRY TRANSFER 52 TO 54
SC4701
SC4701*------------------------------------------------------------------
      * LISA MA    :011003:SC5266 : IF EFT TRNASACTION ERROR, NEED TO RETURN ORIGINAL
      *            :      :       : TXN CODE SENT BY TPS
      *--------------------------------------------------------------------------
      * J MADAMBA  :021003:SC5293 : FIXED OUTPUT DATA FOR TRXN CODE 14045
      *--------------------------------------------------------------------------
      * JOEL BAJO  :021003:SC0289 : EXCLUDE BATCH TXNS FROM SC0367
      *--------------------------------------------------------------------------
SC5286* CPCHEN     :021003:SC5286 : FIX 17026 CAN'T AUTO LINK 85007
SC5286*                           : WHEN CREATE NEW A/C THE RATE TYPE = 2
SC5286*------------------------------------------------------------------
SC5300* CPCHEN     :021003:SC5300 : RECALC DUE-AMT WHEN 16044 / 16048
SC5300*------------------------------------------------------------------
      * EA TAN     :021003:SC4446 : FIX CODE OF SC4446
      *------------------------------------------------------------------
SC5306* CPCHEN     :031003:SC5306 : SET 13609 FOR CORRECTION OF DISCH
SC5306*                           : CIR541 IS FOR DATA CONVERSION
SC5306*------------------------------------------------------------------
ST0049*Austine H.  :031003:ST0049 : ADD CHK OF YOUBE BACKDATE CORR. 
ST0049*------------------------------------------------------------------
SC5130* LISA MA    :031003:SC5130 : CHANGE "UT9008" CALLING AREA
SC5130*-------------------------------------------------------------------------
SC5138* CPCHEN     :041003:SC5138 : SET CORRECT TO_ACCT FOR PREMIUM
SC5138*-----------------------------------------------------------------
SC5340* LISA MA    :041003:SC5340 : FIX OTC TXN WRITE TO VTPV RECORD
SC5340*-------------------------------------------------------------------------
      * JOEL BAJO  :051003:SC4745 : DON'T CHANGE GLCC FOR 921 ACCTS WHEN
      *            :      :       : BALANCE CHANGES
      *------------------------------------------------------------------
ST0054* JK ESCANER :060903:ST0054 : POPULATE FORM 1OF VOUCHER PRINTING
ST0054*            :      :       :FOR ADV TXN (11055, 16055, 11057, 16067,11060)
ST0054*------------------------------------------------------------------
ST0055* MANIBAN    :060903:ST0055 : POPULATE FORM77  VOUCHER PRINTING
ST0055*            :      :       : FOR REPAYMENT TXN
ST0055*------------------------------------------------------------------
SC5378* LISA MA    :061003:SC5378 : FOR FEDI TXN 1045/11045/11055, FROM TXN AMT
SC5378*            :      :       : IS GREATER THEN TO TXN AMT, IF IT CONTAINS
SC5378*            :      :       : NET TRANSMISSION FEE.
SC5378*-------------------------------------------------------------------------
      * M SANCHEZ  :061003:SC5366 : PASS STARTAREA IN UTOVRD CALL
      *-------------------------------------------------------------------------
      * JOEL BAJO  :061003:TB0266 : VOUCHER PRINTING
      *-------------------------------------------------------------------------
SC5286* AUSTINE H. :071003:SC5286 : FIXED CONDITION OF 17026->85007
SC5286*-------------------------------------------------------------
SC4624* R SORIANO  :071003:SC4624 : FIX PASSING OF ACCT-NO TO UT0800 UPON 11057
SC4624*            :      :       : TO CREATE TYPE-36 TXN IN 450
SC4624*-------------------------------------------------------------------------
      * JOEL BAJO  :071003:SC5348 : MOVE FIX TO SC3314 AFTER UPDT OF FAC LIMITS
      *-------------------------------------------------------------------------
      * JOYCE HONG :081003:SC5458 : BYPASS CALLING UT9998 TO UPDATE STMT-FREQ OF CUSM
      *-------------------------------------------------------------------------
SC0224* CPCHEN     :071003:SC0224 : FIXED MULTIPLE RATE
SC0224*-------------------------------------------------------------
      * Austine H.   :081003:SC5286 : GET IDNO FROM A/C WHEN SEND
      *                             : SCR 85007
      *------------------------------------------------------------------
      * Austine H. :091003:SC5028: FIXED CHECK REPAY AMT 
      *------------------------------------------------------------------
SC5100* F GONZALES :091003:SC5100 : FIX CORR FROM 53 TO 52
SC5100*-------------------------------------------------------------
SC5381* BERVE SON  :101003:SC5381 : FIX REPAY AMT AFTER REPAY DURING MAT. 
SC5381*------------------------------------------------------------------ 
SC5173* F GONZALES :101003:SC5473 : GLIF ENTRY TRANSFER CORR 54 TO 52
SC5173*------------------------------------------------------------------
      * CPCHEN     :101003:SC5571: FIXED VARIABLE LENGTH
      *------------------------------------------------------------------
      * JOEL BAJO  :101003:SC4463 : WRITE 13509 TO JRNL FOR ADV REPAYMENT
      *-------------------------------------------------------------------------
SC5190* F GONZALES :101030:SC5190 : FIX GFLIF CORR OF 54 TO 53
SC5190*-----------------------------------------------------------------
SC5381* BERVE SON  :111003:SC5381 : FIX COND. IN D200- TO STILL CHECK MIN/MAX
SC5381*                           : PAYMENTS AFTER MAT. WHEN THERE ARE STILL 
SC5381*                           : ARREARS.                                 
SC5381*------------------------------------------------------------------    
SC4066* F GONZALES :121003:SC5473 : GLIF ENTRY REPAY 13045/13046
SC4066*------------------------------------------------------------------
SC5557* B. TULAYAN :121003:SC5557 : FIX GLIF ENTRY FOR TXN 11155 
SC5557*------------------------------------------------------------------
SC2857* CBCORRAL   :121003:SC2857 : FIX MORT COMBI AUTO REPAY VALIDATION
SC2857*------------------------------------------------------------------
SC4921* F GONZALES :131003:SC4921 : FIX GFLIF ENTRY NPL TO NORMAL
SC4921*-----------------------------------------------------------------
SC5558* J MADAMBA  :141003:SC5558 : FIXED PROBLEM RAISED IN IR 5558
SC5558*-----------------------------------------------------------------
SC5695* J MADAMBA  :141003:SC5695 : FIXED PROBLEM RAISED IN IR 5695
SC5695*-----------------------------------------------------------------
SC3356* F GONZALES :141003:SC3356 : GLIF ENTRY REPAY FOR MISC INCOME
SC3356*------------------------------------------------------------------
SC5651* AT LIM     :151003:SC5651 : ADD USER TOTAL IF GL TRANSFER ACCTS
SC5651*------------------------------------------------------------------
SC5380* F GONZALES :151003:SC5380 : WHEN CORR OF CLOSURE TRAN
SC5380*                           : WA-ACCT-BAL-BEF-TXN >= 0
SC5380*------------------------------------------------------------------
SC5753* MANIBAN    :161003:SC5753 : fir fix 5753
SC5753*------------------------------------------------------------------
SC5624* J MADAMBA  :161003:SC5624 : ir fix (5624)
SC5624*------------------------------------------------------------------
SC5639* RITA HUANG :171003:SC5639 : UPDATE DEP/GL SIDE CASHIER TOTAL FOR
SC5639*            :      :       : TXN 44 46 48 57
SC5639*------------------------------------------------------------------
SC5579* B. TULAYAN :171003:SC5579 : DIS.PENDING DISCHARDE TXN 10240/10243
SC5579*------------------------------------------------------------------
SC4690* JOYCE HONG :191003:SC4690 : REQD OVERRIDE FOR ADVANCE TXN IF CIF
SC4690*                           : REJECTED
SC4690*------------------------------------------------------------------
SC5826* M SANCHEZ  :191003:SC5826 : REMOVE SUPOVRD WHEN APP_AMT NOT > 0  
SC5826*            :      :       : IF ACCT IS YOUBE
SC5826*------------------------------------------------------------------
SC4453* J MADAMBA  :201003:SC4453 : VIRTUAL ACCT REFRESH PROCESSING
SC4453*------------------------------------------------------------------
SC5844* J MADAMBA  :201003:SC5844 : FIXED DOUBLE POSTING IN JR01
SC5844*------------------------------------------------------------------
      * N Z Oblan  :211003:SC5612 : Teller totals update for transfer trans.
      *------------------------------------------------------------------
SC5863* BERVE SON  :211003:SC5863 : FIX GLIF ENTRIES FOR CANCEL OF DEF. INT. 
SC5863*------------------------------------------------------------------    
      * A T LIM    :211003:SC2383 : UPDATE NET AMOUNT OF TXN 13062/13162 TO
      *                           : TELLER TOTALS
      *--------------------------------------------------------------------
SC5028* CPCHEN     :211003:SC5028 : FIXED CHECK OF INSTALLMENT AGREEMENT
SC5028*------------------------------------------------------------------
SC5863* BERVE SON  :211003:SC5863 : ADD GLIF ENTRIES FOR 13509.
SC5863*------------------------------------------------------------------    
      * J CHANCO   :221003:SC5868 : Fix TRANCODE assignment for reposting
      *                           : Removed all exhibit named and display
      *                           : Fix acct num display in 85007
      *------------------------------------------------------------------    
      * J MADAMBA  :221003:SC5960 : FIX CHANNEL TYPE VALUE AND BILL-DATA IN VTPV
      *------------------------------------------------------------------    
      * A T LIM    :221003:SC5854 : REREAD CAST TABLE AFTER UT0028
      *------------------------------------------------------------------
S20175* C.SANTILLAN:221003:SC5938 : Exclude ASYNC TXN on BRANCH-MIMA
      *------------------------------------------------------------------
      * J MADAMBA  :231003:SC5824 : FIX TRN CODE ENTRY IN JOURNAL FOR ATM INITIATED
      *                           : TRXNS
      *------------------------------------------------------------------
      * J MADAMBA  :241003:SC5986 : FIXED PRBLEM FOR IR 5986
      *------------------------------------------------------------------
      * J MADAMBA  : 241003:SC4453: POPULATE REFRESH TYPE
      *------------------------------------------------------------------
      * V. DAnO JR :241003:ST0029 : Implement for all ATM Tellers Totals
      *-----------------------------------------------------------------
      * C.SANTILLAN:261003:ST0058 : ADD CALL OF UT1000 TO GET BRANCH FROM 
      *                             & TO , FACILITATE CHANGE FROM F4 TO F3
      *-----------------------------------------------------------------
      * JEREMY LAU :251003:SC6000 : ALLOW JR01 FOR ATM TXN FROM NON ATM CHANNELS
      *-----------------------------------------------------------------
      * EG ASPIRAS :261003:ST0049 : YOUBE BACKDATING                                    
      *-----------------------------------------------------------------
      * KUGAR LIN  :271003:SC4464 : FIX USER-DEF-CODES
      *------------------------------------------------------------------
      * CPCHEN     :271003:SC6058 : FIX GLIF FOR INSURANCE PREMIUM
      *-----------------------------------------------------------------
      * JOESON SU  :271003:SC3827 : FIX PURCHASE CARD PAYMENT ADD RF TYPE
      *-----------------------------------------------------------------
      * JOEL BAJO  :271003:SC5612 : FIX TOTALS FOR WA-CAST-GEN TXNS
      *------------------------------------------------------------------
      * S. Y. TAN  :291003:TB0285 : CUSTOMISATION FOR COMM. RECOLLECTION
      *------------------------------------------------------------------
      * LISA MA    :281003:SC6077 : USE SOC-SETTLE-BRANCH FOR FEDI FISC FEE
      *---------------------------------------------------------------------
      * PCARANDANG :281003:SC6069 : FIX GLIF FOR CORRECTION OF ADVANCE
      *--------------------------------------------------------------------
      * CBCORRAL   :281003:SC5976 : HANDLE CHANGE OF SA IN MORT COMBI ACCT CREAT
      *--------------------------------------------------------------------
      * BERVE SON  :301003:SC4463 : ADD GLIF CORRECTION FO ADV. REPAY (13609)
      *--------------------------------------------------------------------
      * J MADAMBA  :301003:SC5862 : FIXED ISSUES RAISED IN IR 5862: GLIF ENTRIES FOR TRXN 14010
      *--------------------------------------------------------------------
      * EG ASPIRAS :301003:SC5753 : FIX INT INCR AFTER PREF PRD EXPIRES
      *--------------------------------------------------------------------
SC5843* F GONZALES :311003:SC5843 : TRANSFER 921-NORMAL TO NPL
SC5843*-----------------------------------------------------------------
      * KUGAR LIN  :311003:SC4656 : ADD SPECIAL ACCOUNT SUP OVERRIDE
      *------------------------------------------------------------------
      * J ESCANER  :311003:ST0071 : ADD PROCESSING FOR BULK REMITTANCE
      *------------------------------------------------------------------
      * CBCORRAL   :311003:SC6100 : ADD GUARANTOR IN LOAN/OD DATA MAPPING
      *------------------------------------------------------------------
      * CPCHEN     :011103:SC2790 : FIX THE VALIDATION FOR 10732
      *--------------------------------------------------------------------
      * J MADAMBA  :011103:SC4593 : FIXED GLIF ENTRIES FOR TRXN 14150
SC5673*-----------------------------------------------------------------
SC5673* TERA LIN   :311003:SC5673 : MODIFY VCHR075-LOAN-ACCT-NME,
SC5673*                             VHCR075-END-DATE
      *--------------------------------------------------------------------
SC4463* BERVE SON  :021103:SC4463 : CORRECT SIGN OF JOURNAL AMUNT FOR 13509
SC4463*-----------------------------------------------------------------   
      * JEREMY LAU :021103:SC5573 : SEND ACCT OPEN OKAY AFTER VOUCHER
      *--------------------------------------------------------------------
      * MANIBAN    :031103:SC4509 : No sup override for 17468 & 17469 txn
      *--------------------------------------------------------------------
SC5537* BERVE SON  :031103:SC5537 : Recomp. int. incr for corr. of disch. tran.
SC5537*-----------------------------------------------------------------   
      * S. Y. TAN  :291003:TB0284 : OFFSET LOAN CUSTOMISATION
      *--------------------------------------------------------------------
SC5678* ANDYWU     :041103:SC5678 : ADD VCHR077-TRF-ACCT-NO,VCHR077-DAYS,
SC5678*                             VCHR077-DUE-DAYS
SC5678*------------------------------------------------------------------- 
SC2442* A-SAM      :041103:SC2442 : BYPASS ERR-3765 WHEN BATCH
SC2442*-----------------------------------------------------------------
      * JOEL BAJO  :041103:SC5647 : FIX TOTALS FOR 13x31, 11x44, 11x48,
      *                             16x44, 16x48
      *------------------------------------------------------------------
      *  MGARCIA   :041103:SC5775 : FIX GLI ENTRIES FOR ATM TXN
      *------------------------------------------------------------------
      * R SORIANO  :231003:SC5708 : Fixed to allow to DISPLAY ONLY 17050,
      *            :      :       : 17000 and 17036 if loan account is
      *            :      :       : already discharged
      *------------------------------------------------------------------
SC5681* TERA LIN   :051103:SC5681 : MODIFY VCHR077-PRINCIPAL-AMT,
SC5681*-------------------------------------------------------------------
SC5662* LISA MA    :071103:SC5662 : ADD MORE CONDITION FOR SCHEDULE 85007
SC5662*-------------------------------------------------------------------
SC6329* J MADAMBA  :071103:SC6329 : FIXED MULTIPLE POSTING OF REFRESH MSSAGE TO REFRESH TBLE
SC6329*-------------------------------------------------------------------
SC4241* A-SAM      :081103:SC4241 : ON-BATCH RE-CALC WA-INPUT-AMT
SC4241*-------------------------------------------------------------------
      * M GARCIA   :081103:SC6248 : DONT ASK OVERRIDE FOR TPS INIT TXN
      *-----------------------------------------------------------------
      * JOEL BAJO  :081103:SC5647 : FIX SIDE-EFFECT OF SC5681 ON SC5647
      *-----------------------------------------------------------------
      * MIKE  TIEN :081103:SC6274 : FIX 11057 VOUCHER PRINT
      *-----------------------------------------------------------------
      * PEGGY HUANG:051103:SC6275 : FIX 11044 VOUCHER PRINT    
      *------------------------------------------------------------------
      * AUSTINE H  :091103:SC6233 : CHANGE TRICKLE FEED SOURE G/L
      *------------------------------------------------------------------
      * BERVE SON  :101103:SC6148 : ADD 2 FIELDS FOR SCREEN 17033.
      *                           : GENERATE 13509 GLIF FOR INT. AMT IN 17033
      *------------------------------------------------------------------
      * JENNIFOR   :101103:SC6189 : ADD VOCHER PRINTER FOR FORM 77 IN TXN17467
      *------------------------------------------------------------------
      * KUGAR LIN  :111003:SC4464 : REMOVE THE FUNC. OF USER-DEF-CODES
      *------------------------------------------------------------------
      * F CATABAS  :111103:SC6172 : FIX CASHIER TOTALS OF TXN 17467
      *            :      :       : (PROMPT SCREEN 17034)
      *-------------------------------------------------------------------
      * V DAnO JR  :111103:ST0029 : FIX TPS, MORTGAGE, FEDI TELLERS TOTALS
      *-------------------------------------------------------------------
      * MANIBAN    :111103:SC6279:  FIX IR 6279
      *                   :SC6276:  FIX 6276
      *                   :SC6096
      *-------------------------------------------------------------------
      * BERVE SON  :121103:SC6271 : GLIF FOR 18403/18503 FOR backdate corr.
      *------------------------------------------------------------------  
      * MIKE  TIEN :121103:SC6355 : FIX VCHR077-TERM ERROR IN 11045 11010 11046
      *-----------------------------------------------------------------
      * MIKE  TIEN :121103:SC6401 : FIX GLIF IN 11041 11141
      *----------------------------------------------------------------- 
SC6427* B TULAYAN  :131103:SC6427 : FIX REPAY RECALC ON FULL DRAWDOWN
SC6427*------------------------------------------------------------
      * JOEL BAJO  :141103:SC5647 : FIX SIDE-EFFECT OF CHANGE IN
      *                   :       :  CHINESE BANCSLINK SCREEN
      *-----------------------------------------------------------------
      * CPCHEN     :151103:SC6478 : CORR FOR FIRST-ADV IN BACKDATING,
      *                             BYPASS CALLING UT0076
      *                    SC6507 : FIX MATURITY REPAYMENT
      *                    SC6442 : FIX THE CALL CODE FOR UT0075
      *                    SC5059 : RECALC DUE-AMT IF SET AGR-IND TO 0
      *------------------------------------------------------------------
SC6418* BERVE SON  :151103:SC6418 : FIX BORV HISTORY FOR RATE CHANGE.
SC6418*------------------------------------------------------------   
      * MIKE  TIEN :121103:SC6449 : FIX VCHR077 PRINCIPAL AND PENALTY ERROR FOR 11048     
      *------------------------------------------------------------------                 
      * PEGGY HUANG:141103:SC6379 : FIX 10723 .IF THE ACCT IS DISCHARGE 
      *                            THE CERTIFICATE CAN BE PRINT
      *------------------------------------------------------------------
      * MANIBAN    :151103:sc6497 : fix sc6497
      *            :161103:SC6480 : int rate missing
      *------------------------------------------------------------------
      * J MADAMBA  :151103:SC5862 : 14011 processing
      *------------------------------------------------------------------
      * BERVE SON  :171103:SC6465 : CONSIDER INTEREST ADJUSTMENT FOR     
      *                           : BRANCH/ACCT TYPE CHANGE GLIF ENTRIES.
      *------------------------------------------------------------------
      * V DAnO JR  :171103:ST0029 : FINE TUNE OLR TO VOUCHER PRINTING
      *                           : COLL/ADV
      *------------------------------------------------------------------
      * CPCHEN     :191103:SC6499 : ADD OFFSET AMOUNT TO TXN-AMT
      *                           : WHEN DUE-REPAY-TYPE = 2
      *------------------------------------------------------------------
      * DCUNANAN   :191103:SC6594 : FIX IR 6594 BYPASS INT MAINTAINACE
      *                           : WHEN THE PREF RATE IS ZERO
      *------------------------------------------------------------------
      * A-SAM      :191103:SC6581 : EARLY PRINCPAL REPAYMENT FOR VCHR077
      *                             PENALTY=PENALTY+PENALTY ADJUSTMENT
      *------------------------------------------------------------------
      * PCARANDANG :181103:ST0083 : FINE TUNE MULTIPLE OVERRIDE FOR UTOVRD
      *------------------------------------------------------------------
      * SCHANCO    :191103:SC6472 : NO EFTM VALIDATION FOR TRICKLE TRANS
      *------------------------------------------------------------------
      * S.Y. TAN   :201103:SC6655 : GENERATE 13509 FOR INTEREST PAYMENT 
      *                           : AFTER MATURITY DATE 
      *------------------------------------------------------------------
SC6545* F GONZALES :201103:SC6545 : ACCEPT REPAYMENT EVEN REPAYAMENT IS
SC6545*                           : > THAN PRINCIPAL IF ACCOUNT IS NPL/B
SC6545*------------------------------------------------------------------
SC6555* DCUNANAN   :201103:SC6555 : FIX JRNL-AMOUNT FOR BACK-DATED CORR
SC6555*                           : FOR ADVANCE 16157 16160 AND 16155
SC6555*------------------------------------------------------------------
SC6548* RITA HUANG :201103:SC6548 : FIX VOUCHER PRINTING
SC6548*------------------------------------------------------------------
SC6544* RITA HUANG :211103:SC6544 : FIX 13046 VOUCHER PRINTING
SC6544*------------------------------------------------------------------
      * MIKE  TIEN :211103:SC6401 : FIX GLIF IN 11041 11141(VERSION 2)    
      *-----------------------------------------------------------------  
SC6376* MCCASTILLO :231103:SC6376 : FOR CANCELLED LOAN ACCT, RETURN THE
SC6376*                           : APPLICATION AMT TO THE FACILITY
SC6376*------------------------------------------------------------------
      * CPCHEN     :241103:SC6656 : FIX DUMMY-AMT FOR GLIF ENTRIES
      *------------------------------------------------------------------
SC6714* R SORIANO  :211103:SC6714 : ADDITIONAL FIX FOR SC6096
SC6714*------------------------------------------------------------------
SC6542* TVILLAMOR  :251103:SC6542 : FIX VOUCHER FORM77 PRINTING
SC6542*------------------------------------------------------------------
SC6783* C.SANTILLAN:261103:SC6783 : NO JOURNAL FOR 14011 TXN 
SC6783*------------------------------------------------------------------
SC4584* J MADAMBA  :261103:SC4584 : Fixed erroneous glif entries for 14050/14150
SC4584*------------------------------------------------------------------
ST0096* BERVE SON  :261103:ST0096 : FIX VALIDATION OF DECIMALS.
ST0096*------------------------------------------------------------------
SC6771* RITA HUANG :271103:SC6771 : FIX 63058 VOUCHER PRINTING
SC6771*------------------------------------------------------------------
SC6789* C.SANTILLAN:271103:SC6789 : NO JOURNAL FOR ATM TXN   
SC6789*------------------------------------------------------------------
      * J CHANCO   :281103:ST0095 : POPULATE 'TO' ACCT DETAILS for EFT trans
      *------------------------------------------------------------------
SC6895* F GONZALES :281103:SC6895 : FOR NPL VOUCHER PRINTING
SC6895*------------------------------------------------------------------
CS6906* BERVE SON  :291103:SC6906 : FIX LOOPING PROBLEM FOR VCHR PRINT.
CS6906*------------------------------------------------------------------
SC6855* B. TULAYAN :291103:SC6855 : FIX GLIF YOUBE 98904 INTERNAL TXN
SC6855*------------------------------------------------------------------
      * M SANCHEZ  :291103:ST0081 : ADD PROCESS FOR REVALUATION
      *------------------------------------------------------------------
SC6939* B. TULAYAN :011203:SC6939 : VALIDATE AUTHOR ID IN 10732 TXN.
SC6939*------------------------------------------------------------------
      * EMMY       :011203:ST0099 : ADD YOUBE-SPECIFIC VALIDATION FOR 
      *                           : BACKDATING BEYOND CONVERSION DATE
      *------------------------------------------------------------------
ST0097* BERVE SON  :012303:ST0097 : DO NOT USE INT-ADJUSTMENT FOR
ST0097*                           : ADVANCE.
ST0097*------------------------------------------------------------------
      * SYT        :011203:SC6965 : FIX REPOST ATM FIN TXN USING VIRTUAL ACCOUNT
      *----------------------------------------------------------------------
      * V DAnO JR  :241103:ST0038 : Implement CM Forms from 142 to 157
      *----------------------------------------------------------------------
      * RITA HUANG :021203:SC6548 : VCHR077-STRT-DATE ERROR FOR DISCHARGE TXN
      *------------------------------------------------------------------
SC6828* CPCHEN     :031203:SC6828 : ADD INSURANCE PREMIUM VOUCHER PRINTING
SC6828*------------------------------------------------------------------
SC6383* A-SAM      :031203:SC6383 : FOR DISCHARGE - PDC VOUCHER PRINTING
SC6383*------------------------------------------------------------------
      * JEREMY LAU :011203:SC6937 : FIX UTOVRD PROBLEM
      *------------------------------------------------------------------
      * TVILLAMOR  :021203:SC6541 : FIX FORM077 PRINTING
      *------------------------------------------------------------------
      * LISA MA    :021203:SC7006 : FIX 11055 FEDI BP TXN PROCESS
      *------------------------------------------------------------------
      * JEREMY LAU :031203:SC7016 : FIX 63042 to DEP OVERRIDE
      *------------------------------------------------------------------
      * CBCORRAL   :031203:SC6967 : FIX DUE AMT ON LOAN LAST TERM 
      *------------------------------------------------------------------
      * J MADAMBA  :031203:SC6800 : 14011,14030 & 14045 SHLD CHECK MAX & MIN REPAYMENT
      *------------------------------------------------------------------
      * EMMY       :031203:ST0102 : YOUBE NPL/BAD DEBT              
      *------------------------------------------------------------------
      * BERVE SON  :041203:SC7038 : ALLOW LAST TERM PAYMENTS FOR CONSUMER
      *                           : LOANS AND INTEREST ONLY ACCOUNTS.
      *------------------------------------------------------------------
      * V DAnO JR  :041203:SC7050 : FIX VOUCHER "P" BUCV IF EXCESS
      *                           : PRINCIPAL AMOUNT ACCUMULATE
      *                           : AND FIX REFRESH ERROR MESSAGE "MI0090"
      *-------------------------------------------------------------------
      * BERVE SON  :041203:SC7082 : FIX LOOPING PROBLEM IN 13010 TRAN.
      *-------------------------------------------------------------------
      * TVILLAMOR  :041203:SC6804 : FIX FORM075 PRINTING FOR YOUBE ACCT
      *-------------------------------------------------------------------
      * BERVE SON  :051203:SC7072 : CALL UTOVRD WITH 6055 TRAN FOR 
      *                           : BACKDATED TRAN.
      *------------------------------------------------------------------
      * J MADAMBA  :061203:SC7053 : FIXED INCORRECT PASSING OF DATA TO UT0024
      *------------------------------------------------------------------
      * DCUNANAN   :061204:SC6878 : FIX TRAN DATE FOR TEMPORARY RECIEVABLE
      *------------------------------------------------------------------
      * MANIBAN    :061204:SC7101 : ir7101 - int increment in 10400
      *------------------------------------------------------------------
      * LISA MA    :061203:SC7107 : MOVE LINK-SIGN TO STRT-AREA-SIGN FOR JOURNL
      *-------------------------------------------------------------------
      * C.SANTILLAN:011203:SC6854 : FIX PROC FOR VIRTUAL ACCT (ENTCODE-901-905)
      *                           : 14055 - 4045 change to 24046
      *            :121203:SC6854 : 14030 TXN GEN 24056(NON-TIB JRNL AND GLIF)
      *            :171203:SC7181 : NEW APPROACH VA NON-TIB ATM TXN
      *----------------------------------------------------------------------
      * R SORIANO  :071203:ST0055 : REMOVE BUCV IO FOR VOUCHER PRINTING
      *----------------------------------------------------------------------
      * CPCHEN     :081203:SC6997 : J/K ALSO NEED TO VALIDATE INPUT-AMT
      *-------------------------------------------------------------------
      * J MADAMBA  :081203:SC7166 : NO TERLLER PROCESSING IF TRXN FR MORTGAGE
      *-------------------------------------------------------------------
      * LISA MA    :081203:SC7178 : UTOVRD NEED TO INPUT ED2 SUPERVISOR OVERRIDE FLAG
      *-------------------------------------------------------------------
      * CPCHEN     :091203:SC7171 : BYPASS VALIDATION OF 10732 IF ACCT
      *                             IS OFFSET-LOAN & USES TRICKLE FEED
      *-------------------------------------------------------------------
      * EMMY       :091203:SC7190 : FIX JRNL ENTRIES FOR 13528/13628 TXNS
      *------------------------------------------------------------------
      * MANIBAN    :101203:SC7187 : fix for 13011 error
      *------------------------------------------------------------------
      * J MADAMBA  :101203:SC7253 : fine tuning refresh mechanism
      *------------------------------------------------------------------
      * V DAnO JR  :111203:SC7280 : Fix 10242, system response 155.
      *                           : Remove UTVSAVE
      *------------------------------------------------------------------
      * DCUNANAN   :121203:SC7197 : FIX IR 7197 JOURNAL POSTING FOR
      *                           : YOUBE BACKDATING TRAN
      *------------------------------------------------------------------
      * JOYCE HONG :111203:SC7230 : BYPASS SUPERVISOR OVERRIDE IF REPOST-TXN
      *------------------------------------------------------------------
      * M TAN      :111203:SC7260 : FIX GLIF FOR REPAYMENT AFTER BRANCH CHANGE
      *------------------------------------------------------------------
      * JKB ALDAY  :121203:SC7213 : FIX VOUCHER PRINT ON TXN 17003
      *------------------------------------------------------------------
      *C.SANTILLAN :121203:SC7181 : Add UTVTACCA-CALL-PARAM on call of UT0820
      *------------------------------------------------------------------
      *MANIBAN       :1212:SC7304  : yoube voucher
      *------------------------------------------------------------------
      * TVillamor  :121203:SC7298  : Fix TRN10243 Voucher Printing
      *------------------------------------------------------------------
      * RITA HUANG :131203:SC7312 : NO NEED TO DISPLAY RATE FOR CAR LOAN
      *                           : DISCHARGE VOUCHER PRINTING
      *------------------------------------------------------------------
      * JEREMY LAU :131203:SC7355 : DOUBLE CHECK ORIGINAL INPUT TRAN'S ED2P
      *----------------------------------------------------------------------
      * CPCHEN     :131203:SC7314 : SORD AMT WILL INCLUDE OFFSET AMOUNT
      *                             IF DUE-REPAY-TYPE = 1
      *------------------------------------------------------------------
      * J MADAMBA  :151203:SC7333 : IR 7333
      *------------------------------------------------------------------
      * EA TAN     :151203:SC7323 : FIX NARRATIVE FOR VTPV TPS INITIATED
      *------------------------------------------------------------------
      * B. TULAYAN :151203:SC7418 : FIX GIF FOR INTEREST BILLED(INSTALL AGREE)
      *------------------------------------------------------------------
      * TVillamor  :151203:SC7219 : Fix Voucher Printing for Agree amt
      *------------------------------------------------------------------
      * A-SAM      :051203:SC7091 : 16XXX FOR FEDI TXN
      *-----------------------------------------------------------------
      * V. DAnO JR :171203:ST0029 : Fine tune 17003 for voucher printing
      *-----------------------------------------------------------------
      * LISA MA    :171203:SC7495 : ONLY BANCSLINK TXN WILL CALL "FT0000" AGAIN.
      *-----------------------------------------------------------------
      * MIKE TIEN  :171203:SC7375  : CHANG READNEXT TO READ INOD IN 17036  
      *-----------------------------------------------------------------   
      * MIKE TIEN  :181203:SC7375  : CHANG READ TO READNEXT INOD IN 12006    
      *-----------------------------------------------------------------     
      * R SORIANO  :191203:SC5707  : UPDATE SUBS STAT UPON DISCHARGE
      *-----------------------------------------------------------------     
      * LISA MA    :191203:SC7546 : GEN TXN NEED WRITE PROFIT CODE TO JNRST
      *-----------------------------------------------------------------
      * J MADAMBA  :191203:TB0212 : added codes for >R ouput code
      *-----------------------------------------------------------------
      * EMMY       :191203:SC7018 : REJECT ADV CORR ON THE SAME DAY IF       
      *                           : THERE ARE FIN TXNS IN BETWEEN
      *-----------------------------------------------------------------
      * J MADAMBA  :201903:SC6897 : yet another codes for refresh
      *-----------------------------------------------------------------
      * JENNIFOR   :201203:SC7567 : FIX TXN17026 FOR SUPERVISOR OVERRIDE
      *-----------------------------------------------------------------
      * TVILLAMOR  :211203:SC7399 : FIX PRINREPAY VOUCHER PRINTING
      *-----------------------------------------------------------------
      * JEREMY LAU :221203:SC7541 : NO REVALUTATION SUP FOR REPAY&DISCHARGE
      *-----------------------------------------------------------------
      * LISA MA    :241203:SC7685 : ALLOW FEDI TXN NET RECEIVABLE < RECEIVED
      *----------------------------------------------------------------------
      * LISA MA    :251203:SC7630 : MOVE THE PARAGRAPH TO CALL "UT9008" SEPARATELY
      *----------------------------------------------------------------------
      * A-SAM      :251203:SC7689 : FIX SUPERVISOR OVERRIDE ON TRF-TXN
      *-----------------------------------------------------------------
      * AUSTINE H. :251203:SC7677 : FIXED TRAFER-BRCH OF JR01 
      *                             WHEN TRAN '20' 
      *------------------------------------------------------------------------
      * Y. N. KIM  :251203:SC7628 : FIX CGL-POSTING-IND FOR GL BY 11x46.
      *-----------------------------------------------------------------
      * TVILLAMOR  :261203:SC7587 : FIX ARRAMT CALCULATION
      *-----------------------------------------------------------------
      * CBCORRAL   :261203:SC7615 : HANDLE OFFLINE VALIDATION ON LOAN CREATION
      *-----------------------------------------------------------------
      * M SANCHEZ  :261203:SC7697 : FIX VALUE OF VCHR077-RATE
      *-----------------------------------------------------------------
      * BERVE SON  :271203:SC7752 : FIX 13509 FOR ADVANCE PMT AGREE INSTALL
      *----------------------------------------------------------------------
      * J MADAMBA  :271203:TB0212 : populate omni-td-acct
      *----------------------------------------------------------------------
      * Y. N. KIM  :281203:SC7301 : FIX GLIF TRF BRCH FOR 11x41 TXN.
      *----------------------------------------------------------------------
      * J MADAMBA  :281203:TB0212 : added codes to fix >R messages format
      *----------------------------------------------------------------------
      * JENNIFOR   :281203:SC7749 : FIX VOUCHER PRINT FOR TXN17467
      *----------------------------------------------------------------------
      * MANIBAN    :291203:SC7033 : voucher print for yoube and car loan
      *                             ( for repayment)
      *----------------------------------------------------------------------
      * CPCHEN     :291203:SC7091 : ADD NEW TXN FOR YOUBE 19060/19062/
      *                             19050/19055/19011/19030/19045
      *-----------------------------------------------------------------
      * KUGAR LIN  :301203:SC7758 : RESTORE STRT-AREA-TRN-NO AFTER BR0029
      *------------------------------------------------------------------
      * JENNIFOR   :301203:SC7814 : FIX TXN17026 FOR MULTIPLE PERIOD RATE
      *------------------------------------------------------------------
      * JOYCE HONG :301203:SC6871 : CURRENCY DECIMAL VALIDATION  
      *------------------------------------------------------------------
      * V DAnO JR  :301203:SC7399 : EARLY REPAY REFRESH SCREEN AFTER RECALC
      *------------------------------------------------------------------
      * AUSTINE H. :311203:SC7483 : DISABLE REPAY NBL,WRITE OFF FROM PDC
      *-----------------------------------------------------------------
      * A-SAM      :311203:SC7865 : CHECK MIN-AMOUNT WITH ARRS-AMT
      *------------------------------------------------------------------
      * MCCASTILLO :010104:TS0081  : REPAYMENT SHLD NOT CALL UTFACO
      *-----------------------------------------------------------------
      * EA TAN     :010104:SC7443  : FIX SENDING OF CLOSURE TO FEP
      *            :      :        : MOVED FROM BR0025, NEED SUCCESS OVRD
      *-----------------------------------------------------------------
      * LISA MA    :020104:SC7808 : NOT REQUIRED GENERATE 98903 FOR 17047
      *-------------------------------- -------------------------------------
      * RITA HUANG :030104:SC7923 : IF BORP-INT-RATE-PRINT = 'N' NO NEED
      *                           : TO DISPLAY RATE FOR VOUCHER PRINTING
      *------------------------------------------------------------------
      * J MADAMBA  :040104:SC7253 : addt'l codes for refresh
      *------------------------------------------------------------------
      * F GONZALES :050104:SC7791 : GLIF ENTRY for 52 - 54 if 921 FLAG > 0
      *-------------------------------- -------------------------------------
      * A-SAM      :050104:SC7982 : TXN-DT < LAST-ACCT-TYPE-CHANGE NOT <=
      *------------------------------------------------------------------
      * S. Y. TAN  :050104:ST0115 : YOUBE STATEMENT INQUIRY
      *------------------------------------------------------------------
      * JOYCE HONG :060104:SC7843 : COLLATERAL/GUARANTEE UPDATING FOR 17000/17036
      *------------------------------------------------------------------
      * MANIBAN    :060104:SC7866 : glif entry NPL transfer to Bad Debt(52 - 54)
      *------------------------------------------------------------------
      * PEGGY HUANG:111203:SC7289 : FIX 10726 OUTPUT PRINT            
      *----------------------------------------------------------------------
      * A-SAM      :060104:SC8017 : 16044 DON'T CHECK TXN-AMT / BAL
      *------------------------------------------------------------------
      * M SANCHEZ  :070104:SC8001 : PUT SYSOUT DISPLAYS ON 108 ERRORS
      *------------------------------------------------------------------
      * A-SAM      :070104:SC8040 : REPAYMENT THRU STANDING ORDER
      *-----------------------------------------------------------------
      * Y. N. KIM  :070104:SC7989 : GLDM WAS NOT UPDATED FOR 11x57.
      *------------------------------------------------------------------
      * EA TAN     :080104:SC7957 : Fix >R of 16045
      *------------------------------------------------------------------
      * S. Y. TAN  :090104:SC8006 : STOP CALLING UT0078 IF LOAN-STAT =50
      *                           : AND LOAN_BAL = 0
      *------------------------------------------------------------------
      * EMMY       :090104:SC8034 : FIX BORV TYPE 27 TXN FOR YOUBE ADV
      *                           : CORRECTION                                
      *-----------------------------------------------------------------
      * JOESON SU  :090104:SC7637 : FIX WRITE LRTP TABLE DUPM PROBLEM
      *-----------------------------------------------------------------
      * JEREMY LAU :100104:SC8088 : INIT WS-TRANSFER-IND FOR YOUBE
      *-----------------------------------------------------------------
      * C.SANTILLAN:100104:SC8070 : MOVE STRT-AREA-BRANCH TO JNRST-BRCH
      *                           : FOR 13509 JOURNAL
      *-----------------------------------------------------------------
      * LISA MA    :100104:SC8085 : FIX VIRTUAL ACCT BULK POSTING
      *------------------------------------------------------------------
      * V.DAnO JR  :120104:SC7868 : FIX TIMEOUT AND BLANK SCREEN 0 FLAG
      *------------------------------------------------------------------
      * CPCHEN     :130104:SC8046 : FIX DUE-AMT WHEN REM-REPAYS = 1
      *-----------------------------------------------------------------
      * B. TULAYAN :130104:SC8008 : REJECT REPAY SCHED "B" FROM ATM TXN
      *------------------------------------------------------------------
      * DCUNANAN   :130104:SC8127 : FIX TEMP PAYMENT FOR YOUBE ACCOUNT
      *------------------------------------------------------------------
      * CPCHEN     :130104:CS7091 : 140XX OF YOUBE ARE STILL USED
      *-----------------------------------------------------------------
      * C.SANTILLAN:130104:SC8064 : EXCLUDE MOVING OF PROMO CODE TO 
      *                             ATM LOAN TXN CREDIT (JNRST-BATCH-NO)
      *-----------------------------------------------------------------
      * B. TULAYAN :130104:SC8128 : INCL MORT-COMBI IN VALIDATION OF ADV AMT.
      *-------------------------------------------------------------------
      * J MADAMBA  :140104:TB0212 : Error trapping for YOUBE backdating trxns
      *-------------------------------------------------------------------
      * M SANCHEZ  :150104:ST0081 : ALLOW NEG LMT IF REVAL-FLAG = "S"
      *------------------------------------------------------------------
      * MANIBAN    :160104:SC8200 : include borm-record-area/bois-record
      *                             in UTCIEA linkage area
      * ----------------------------------------------------------------
      * JOEL BAJO  :160104:SC7548 : ASSORTED FIXES FOR ACCTS WITH ADD'L
      *                             BILLING AT MATURITY
      * ----------------------------------------------------------------
      * DCUNANAN   :180104:SC8263 : FIX GLIF ENTRY FOR INTER BRANCH TRAN
      *                           : FOR YOUBE
      * ----------------------------------------------------------------
      * F GONZALES :180104:SC8163 : FIX PAYMENT PRIORITY FOR
      *                           : CUSTOMER AND GL SEGMENT
      *------------------------------------------------------------------
      * EMMY       :180104:SC8294 : BYPASS CODE IF YOUBE                  
      *-----------------------------------------------------------------
      * DCUNANAN   :180104:SC8291 : FIX GLIF FOR YOUBE 98904 ADV CORR
      *-----------------------------------------------------------------
      * RITA HUANG :190104:ST0121 : CM-LON-030
      *------------------------------------------------------------------
      * RIZA LADIA :190104:SC8290 : CORRECT MIN AMT REPAYMENT WHEN REPAY-
      *                           : MENT SCHED "B" 
      *------------------------------------------------------------------
      * V DAnO JR  :190104:SC8298 : Fix populated data for Repayment Stat=50
      *------------------------------------------------------------------
      * B. TULAYAN :190104:SC8333 : FIX AUTHOR ID VAL  IN 10732 TXN
      *------------------------------------------------------------------
      * JOEL BAJO  :190104:SC8330 : FIX DUES RECALC AFTER PAYMENT
      * ----------------------------------------------------------------
      * LISA MA    :200104:SC8350 : FIX FEDI BP TXN NIGHT MODE IMAGE
      *---------------------------------------------------------------------
      * DCUNANAN   :210104:SC8276 : FIX 98904 ENTRY FOR YOUBE
      *---------------------------------------------------------------------
      * RIZA LADIA :220104:SC8033 : RETROFIT CHANGES FOR IR8033/JAG
      *---------------------------------------------------------------------
      * CBCORRAL   :230104:SC8301 : AUTO DEB NOT PERMITTED FOR MATURED ACCT
      *-------------------------------------------------------------------
      * DCUNANAN   :230104:SC8395 : BYPASS CALCULATION OF RATE EXP DT IF
      *                           : THE START METHOD EQUAL 07
      *-------------------------------------------------------------------
      * B. TULAYAN :230104:SC8399 : FIX INT ADJUSTMENT IN BACK PRIN REPAY
      *---------------------------------------------------------------------
      * J MADAMBA  :230104:TB0212 : eftm
      *---------------------------------------------------------------------
      * JOEL BAJO  :240104:SC7548 : FIX MIN/MAX VALIDATION FOR MATURITY
      *                           : BILLING
      * ----------------------------------------------------------------
      * M LOGATOC  :240104:SC8404 : DON'T ALLOW SKLI TXNS 
      *---------------------------------------------------------------------
      * JOEL BAJO  :250104:SC7548 : REPL BORP-COMMERCIAL WITH BORP-COMML
      * ----------------------------------------------------------------
      * JENNIFOR   :250104:SC8336 : FIX CREDIT PRINCIPAL WITH LOAN BAL NOT >
      *                           : LOAN REPAY
      * ----------------------------------------------------------------
      * RIZA LADIA :250104:SC8458 : OVERRIDE ZERO OUT OF INT ACCR WHEN BAL
      *                           : IS ZERO     
      * ----------------------------------------------------------------
      * J ESCANER  :250104:SC8507 : NOT ALLOWED WHEN REPAYMENT WITHIN
      *                            : DEFERRED PERIOD
      * ----------------------------------------------------------------
      * C.SANTILLAN:280104:SC8535 : COMMENT OUT CODES REDUNDANT CODES
      * ----------------------------------------------------------------
      * B. TULAYAN :300104:SC8627 : FIX GLIF 11057 YOUBE TXN
      *-----------------------------------------------------------------
      * AUSTINE H. :300104:SC8620 : CHANGE PDC REPAYMENT RULE
      *-----------------------------------------------------------------
      * BERVE SON  :010204:SC8690 : NO VOUCHER PRINTING WHEN ERROR.
      *-----------------------------------------------------------------
      * JOESON SU  :010204:SC8686 : FIX PURCHASE CARD PERFORM
      *-----------------------------------------------------------------
      * CBCORRAL   :010204:SC8692 : NO AUTO PRINC REP WHEN MORT NOT LINK
      *-----------------------------------------------------------------
      * MCCASTILLO :010204:SC8711 : ZERO OUT BORM-INT-INCR IF LON-BAL = 0
      *-----------------------------------------------------------------
      * MCCASTILLO :010204:SC8720 : VALIDATE ALL MANUALLY INPUTTED ACCOUNT
      *                             NUMBERS. IT SHLD BE ON ANUM RANGE
      *------------------------------------------------------------------
      * BERVE SON  :030204:SC8772 : DO NOT ALLOW ATM TRANS FOR BAD DEBT.
      *-----------------------------------------------------------------
      *B. TULAYAN  :030204:SC8777 : FIX MIN AMOUNT VALIDATION
      *-----------------------------------------------------------------
      * B. TULAYAN :030204:SC8745 : NO 98904 GLIF, IF AMT SIGN NOT CHANGE
      *----------------------------------------------------------------
      * J MADAMBA  :040204:SC8782 : DO not change the promode code from 'f4' to 'f3'
      *                           : if txn is CGL even the brach of fr/to are the same
      *            :050204:SC8782 : implemented for all virtual accounts
      *----------------------------------------------------------------
      * BERVE SON  :040204:SC8783 : FIX MIN/MAX VALIDATION.
      *----------------------------------------------------------------
      * DCUNANAN   :040204:SC8580 : BYPASS WRITING OF REC IN BRTH FOR
      *                           : YOUBE IF THE PRODUCT HAS A TIER GRP
      *----------------------------------------------------------------
      * C.SANTILLAN:050204:SC8776 : UTILIZED WA-VIRTUAL-TO-BRANCH AS
      *                           : VAR FOR VA-CGL-B TYPE ATM FRM BRNCH
      *----------------------------------------------------------------
      * M SANCHEZ  :050204:SC8756 : DO NOT ALLOW REPAYMNT TXNS FRM OTHR
      *                           : CHANNELS IF ACCT IS NPL OR BAD DEBT
      *----------------------------------------------------------------
      * F GONZALES :050204:SC8812 : 13011/13111 NO GLIF IF BAD DEBT 54
      *----------------------------------------------------------------
      * EA TAN     :060204:ST0132 : ST0132 - HOT FIX 05022004 FOR SC8686
      *-----------------------------------------------------------------
      * R SORIANO  :060204:SC8804 : FIX SUBSIDY DISCHARGE CORRECTION
      *-----------------------------------------------------------------
      * JOEL BAJO  :060204:SC8758 : FIX DUES RECALC FOR REPAY-SCHED="K"
      *-----------------------------------------------------------------
      * BERVE SON  :070204:SC8774 : OVERRIDE FOR REJ CUSTOMER FOR 17047
      *-----------------------------------------------------------------
      * CPCHEN     :070204:SC8740 : CODES FOR FIRST TRICKLE FEED OF
      *                             OFFSET LOAN AFTER SYSTEM GO LIVE
      *-----------------------------------------------------------------
      * M SANCHEZ  :080204:SC8888 : REPAY AMT MUST BE FULL AMT OF TERM
      *                           : BEFORE MATURITY 
      *-----------------------------------------------------------------
      * V DAnO JR  :080204:SC8851 : FIX CAPTION OF PDC VOUCHER DISCHAGE
      *-----------------------------------------------------------------
      * J MADAMBA  :080204:TB0212 : Fix the output message of 19055 using CGL acct as TO acct
      *-----------------------------------------------------------------
      * DCUNANAN   :080204:SC8912 : FIX BORM GL CLASS CODE
      *-----------------------------------------------------------------
      * V DAnO JR  :080204:SC8908 : FIX BLANK SCREEN AFTER VOUCHER
      *-----------------------------------------------------------------
      * JENNIFOR   :080204:SC8479 : SYSTEM DOES NOT ALLOW LOAN BAL < 0
      *-----------------------------------------------------------------
      * JEREMY LAU :080204:SC8878 : FIX 98904 WHEN PROD CHANGE
      *-----------------------------------------------------------------
      * J MADAMBA  :090204:TB0212 : bypass >R if online txn
      *-----------------------------------------------------------------
      * LISA MA    :090204:SC8921 : INITIALIZE WA-STORE-TFR-SYST AND FIX
      *            :      :       : JNRST-TRANSFER-BRANCH IN UT0820
      *-----------------------------------------------------------------
      * EMMY       :090204:SC8927 : BYPASS CODE IF YOUBE                  
      *-----------------------------------------------------------------
      * J MADAMBA  :090204:TB0212 : Bypass any EFTM processsing when reposting 
      *-----------------------------------------------------------------
      * M SANCHEZ  :090204:SC8888 : FIX MIN-MAX LMT VALIDTN ON CONS LOAN
      *-----------------------------------------------------------------
      * Y. N. KIM  :090204:ST0137 : POPULATE ERROR NO WHEN NO ERR DEFINED
      *------------------------------------------------------------------
      * EA TAN     :100204:ST0142 : Finetune Linkages
      *-----------------------------------------------------------------
      * J ESCANER  :110204:SC8568 : REPAYMENT NOT ALLOWED FOR CTA ACCT
      *                           :  WHERE MAT DT = ADVANCE DT
      *-----------------------------------------------------------------
      * Y. N. KIM  :110204:SC8950 : FIX POPULATING WA-BAD-DEBT-IND.
      *------------------------------------------------------------------
      * B. TULAYAN :110204:SC8939 : FIX DUE AMOUNT AFTER DISCHARGE CORR
      *-----------------------------------------------------------------
      * DCUNANAN   :120204:SC8733 : WRITE BRTH FOR YOUBE ACCT
      *                    SC8891 : ADD VALIDATION TO WRITE IN BRTH
      *-----------------------------------------------------------------
      * EMMY       :130204:SC9001 : FIX BRTH FOR YOUBE FIXED RATE ACCTS
      *-----------------------------------------------------------------
      * EMMY       :130204:SC9003 : FIX INT INCREMENT FOR YOUBE             
      *-----------------------------------------------------------------
      * BERVE SON  :130204:SC8858 : FIX COND. FOR SKIPPING D200-MIN
      *-----------------------------------------------------------------
      * CPCHEN     :150204:ST0152 : SEARCHING THE VALID BUCV
      *-----------------------------------------------------------------
      * J MADAMBA  :150204:ST0153 : FIX ACCOUNT CREATION PROBLEM IN YOUBE SCORING
      *-----------------------------------------------------------------
      * EMMY       :150204:SC9044 : FIX SENDING OF DATA IN BR0056
      *-----------------------------------------------------------------
      * B. TULAYAN :160204:SC9037 : FIX CAR LOAN REPAYMENT
      *-----------------------------------------------------------------
      * EMMY       :170204:SC9088 : ALLOW YOUBE TO TRANSACT 10732
      *-----------------------------------------------------------------
      * MCCASTILLO :170204:SC9090 : COMPLETE THE LINE OF CODES
      *-----------------------------------------------------------------
      * J MADAMBA   :170204:ST0159 : ADDED NEW FIELD IN ALT KEY 1 OF EFTM TO SOLVE
      *                            : DUPM PROBLEM IN PRODUCTION FOR ATM INIT TXNS
      *-----------------------------------------------------------------
      * BERVE SON  :170204:SC9118 : FIX 171 VALIDATION IN D200-MIN-MAX
      *-----------------------------------------------------------------
      * B. TULAYAN :170204:SC9119 : ALLOW TO PERFORM COLLECT TXN IF STAT =20
      *-----------------------------------------------------------------
      * B. TULAYAN :190204:ST0161 : ONLY CALL MI0095 IF THERE IS NO ERROR
      *-----------------------------------------------------------------
      * J ESCANER  :200204:SC9066 : FOR UPFRONT LOAN -  INTEREST AMT 
      *                           : INTERNAL TXN 13509/13609 SHLD NOT 
      *                           : BE CREATED IF AMT IS ZERO
      *-----------------------------------------------------------------
      * CBCORRAL   :200204:SC9068 : DEFAULT OD DETAILS FOR LOAN CREATION/
      *                           : LOAN DETAILS AFTER               
      *                   :SC9178 : USE INT DUE IF GREATER THAN MIN PC
      *-----------------------------------------------------------------
      * AUSTINE H  :200204:SC9142 : FIX LAST TERM REPAYMENT WHERE PDC
      *-----------------------------------------------------------------
      * V. DAnO JR :200204:SC9192 : IMPLEMENT CAST UPDATE DURING REPOST-TXN
      *-----------------------------------------------------------------
      * LISA MA    :210204:SC9232 : FIX ATM TXNS FROM IVR AND IB CHANNEL
      *-----------------------------------------------------------------
      * J MADAMBA  :230204:SC9268 : FIX UNUPDATED EFTM DURING CORRECTION
      *-----------------------------------------------------------------
      * JOESON SU  :240204:SC9184 : FIX PURCHASE CARD STOP PERFORM
      *-----------------------------------------------------------------
      * B. TULAYAN :240204:SC9328 : ADD VAL FOR REPAY AMT NOT > DISCH AMT
      *-----------------------------------------------------------------
      * BERVE SON  :250204:SC9299 : SKIP AGREE INSTALL VALID FOR PRIN CREDIT.
      *-----------------------------------------------------------------     
      * CBCORRAL   :250204:SC9324 : DO NOT PROCESS PRINC REP FOR RESERVED
      *                           : AMT LESS THAN DEP CURR BAL
      *-----------------------------------------------------------------
      * DCUNANAN   :260204:SC9353 : PUT ADDITIONAL VALIDATION FOR CORRECTION
      *-----------------------------------------------------------------
      * BERVE SON  :230204:SC9006 : CHANGE DATE CALLING FOR UT0075 IN D200-
      *-----------------------------------------------------------------   
      * DCUNANAN   :280204:SC9457 : VALIDATE BACKDATE TXN DATE FOR YOUBE IT
      *                           : SHOULD NOT < THE LAST FIN DATE OF ACCT
      *-----------------------------------------------------------------   
      * EMMY       :010304:SC9485 : MOVE 4141 VALIDATION TO UT0081         
      *-----------------------------------------------------------------
      * KUGAR LIN  :030304:SC9527 : SEND WHEREABOUT-UNKNOWN MESSAGE ONLY
      *                             WHEN STRT-BANCSLINK
      *-----------------------------------------------------------------
      * F GONZALED :030304:SC9454 : BACKDATED TXN IS NOT ALLOWED IF 
      *                             ACCOUNT IS NPL/BADDEBT
      *-----------------------------------------------------------------
      * M SANCHEZ  :040304:SC8879 : ERROR 10722 IF LOAN NOT YET ADVANCED
      *-----------------------------------------------------------------
      * BERVE SON  :060304:SC9557 : FIX INT INCR. DURING 11020 REPAYMENT
      *-----------------------------------------------------------------
      * JEREMY LAU :060304:SC9409 : FIX UT0800 SUP LOOPING
      *-----------------------------------------------------------------
      * BERVE SON  :080304:SC9586 : FiX INT INCR. FOR ATM TXNS.         
      *-----------------------------------------------------------------
      *  CBCORRAL  :080304:SC9469 : INCLUDE BORP-CONSMR-MORT-COMBI FROM THE
      *                           : VALIDATION OF CUSM-REJECTED-STATUS
      *-------------------------------------------------------------------
      * BERVE SON  :100304:SC9006 : RESTORE CODES OF SC9006 AFTER TESTING.
      *-----------------------------------------------------------------
      * V. DAnO JR :100304:SC9453 : FIX 17033 VOUCHER AGREE-IND = 2 to 0
      *-----------------------------------------------------------------
      * PENNY HUANG:110304:SC9608 : ADD UTVTACCA-CALL-PARAM  TO UT0800 LINKAGE
      *------------------------------------------------------------------
      * V. DAnO JR :120304:SC9645 : FIX 16045/16046/11046 TRF ACCT VCHR
      *-----------------------------------------------------------------
      * JOYCE HONG :130304:SC9599 : CALL UT0850 TO ROLLBACK DB AND UPDATE
      *            :      :       : INVE TABLE WHEN ERROR 3592/3593
      *-----------------------------------------------------------------
      * JKB ALDAY  :170304:SC9302 : CMLON023 - YOUBE INT/PRIN ADJUSTMENT
      *-----------------------------------------------------------------
      * PENNY HUANG:170304:SC9693 : FXI VTPV WRITE DOUBLE
      *-----------------------------------------------------------------
      * CBCORRAL   :170304:SC9576 : VALIDATE SO REP WHEN INP AMT > LOAN BAL
      *-----------------------------------------------------------------
      * DCUNANAN   :200304:SC9654 : MIN DUE CALCULATION FOR YOUBE
      *-----------------------------------------------------------------
      * C.SANTILLAN:220304:SC9610 : OVER THE COUNTER BACKDATED CORRECTION
      *                           : SET FLAG, GEN 24143/24153 IN BR24/23
      *-----------------------------------------------------------------
      * J ESCANER  :230304:SC9750 : ALLOW TXN 11010 WHEN LOAN BAL
      *                              LESS THAN DUE AMOUNT
      *-----------------------------------------------------------------
      * J ESCANER  :050304:SC9559 : IF API TRICKLE FEED AND LAST TERM
      *                              REJECT THE TRANSACTION (PRSB)
      *-----------------------------------------------------------------
      * J MADAMBA  :250304:SC9732 : CORRECT COMPUTATION OF AVAIL BALANCE IN >R
      *-----------------------------------------------------------------
      * BERVE SON  :260304:SC9828 : INIALIZE WA-PASS-TRN-NO TO AVOID NO 
      *                           : POSTING IN DEPOSIT SIDE.            
      *-----------------------------------------------------------------
      * V DAnO JR  :290304:SC9808 : ADD VCHR PARAMETER IN BR0038 10832/10872
      *-----------------------------------------------------------------
      * CBCORRAL   :290304:SC9330 : FIX FOR LAST TERM (SO TXN)              
      *                    SC9775 : HANDLE INT > PRIN (SO TXN) 
      *-----------------------------------------------------------------
      * V DAnO JR  :220304:SC9292 : CATER VCHR PENALTY AFTER MATURITY REPAYMENT
      *-----------------------------------------------------------------
      * CBCORRAL   :310304:SC9881 : REPLACE DUP ERR CODE          
      *-----------------------------------------------------------------
      * F GONZALES :310304:SC9862 : ROUND AMT FOR NPL/BAD DEBT FOR GLIF ENTRY
      *-----------------------------------------------------------------
      * J ESCANER  :010404:SC9391 : GENERATE ADDTL JRNL FOR 11041/11141
      *-----------------------------------------------------------------
      * F GONZALES :060404:SC9759 : FIX CORRECTION 11155 TXN WITH INSURANCE
      *                             PREMIUM.
      *-----------------------------------------------------------------
      * AUTINE H   :070404:SC9927 : FIXED PDC MATURITY REPAYMENT 
      *-----------------------------------------------------------------
      * JOYCE HONG :090404:SC8877 : COMMENT OUT ERR155 SETTING AFTER B620-
      *-----------------------------------------------------------------
      * EMMY       :090404:SC9814 : DO NOT BYPASS IF FIRST ADV             
      *-----------------------------------------------------------------
      * BERVE SON  :120404:SC9514 : CHG MIN/MAX VALIDATION FOR COMMERCIAL "B"
      *-----------------------------------------------------------------     
      * NATHAN     :120404:SC9950 : ACT-TYPE = "790" CAN CHANGE RATE
      *-----------------------------------------------------------------
      * F GONZALES :130404:SC9959 : SAVE WA-EDIT-MASK FOR SOME ROUTINE
      *                           : AND MOVE IT BACK
      *-----------------------------------------------------------------
      * BERVE SON  :120404:SC9514 : FIX SOME COND IN MIN/MAX FOR COMM. "B"
      *-----------------------------------------------------------------     
      * BERVE SON  :140404:SC9797 : RECOMP DUE WHEN ACCT TYPE CHANGE    
      *-----------------------------------------------------------------
      * EMMY       :140404:SC9872 : MOVE LOGIC OF MIN DUE CALC             
      *-----------------------------------------------------------------
      * EMMY       :150404:S10003 : SAVE FIRST ADV DATE FOR ATM TXNS       
      *-----------------------------------------------------------------
      * J MADAMBA  :160404:SC9984 : REJECT CORRECTION TXN TRYING TO CORRECT THE PREV CORRECTION TXN
      *-----------------------------------------------------------------
      * J MADAMBA  :160404:SC9944 : CORRECT COMPUTATION OF AVAILABLE BALANCE IN >R
      *-----------------------------------------------------------------
      * JOEL BAJO  :190404:SC9393 : ADDITIONAL FIX FOR SC9391
      *-----------------------------------------------------------------
      * F GONZALES :200404:S10006 : IF ACCT IS NPL/BAD DEBT NO GLIF ENTRIES
      *                             FOR 13011/13111 transaction
      *-----------------------------------------------------------------
      * V. DAnO JR :220404:SC9216 : FIX INTERNAL VCHR FORM5 & SWAP ACCT
      *-----------------------------------------------------------------
      * RICKY TONG :230404:SC9973 : BILL PAYMENT NEED TO WRITE VTPV
      *-----------------------------------------------------------------
      * A-SAM      :220404:S10012 : FIX TXTM OF PDC VOUCHER DISCHAGE
      *-----------------------------------------------------------------
      * EMMY       :270404:S10032 : BYPASS 98904 PROCESSING IF NON-FIN 
      *                           : TXN FOR YOUBE ACCTS
      *-----------------------------------------------------------------
      * DCUNANAN   :270404:S10074 : VALIDATION FOR YOUBE SCREEN 17034
      *-----------------------------------------------------------------
      * CBCORRAL   :280404:S10042 : FIX NEGATIVE SA BALANCE AFTER PRINC
      *                           : REPAYMENT
      *-----------------------------------------------------------------
      * BERVE SON  :290404:SC9640 : DO NOT CONSIDER LOAN TERM FOR MATURITY
      *-----------------------------------------------------------------  
      * V. DANO JR :030504:S10077 : FIX YOUBE VCHR FORM77 FOR START/END DATE
      *-----------------------------------------------------------------
      * MAGGIE LIN :040504:S10108 : IF YOUBE ACCOUNT
S20175*                             DO NOT PRODUCE AUTOMATIC MIMA SLIP.
      *-----------------------------------------------------------------
      * EMMY       :050504:SC9929 : ADD REV FEE ADJ/WAIVE TXN          
      *----------------------------------------------------------------------
      * MCCASTILLO :110504: S10104 : CORRECT THE CALLING OF "UTFACO"
      *----------------------------------------------------------------*
      * JESCANER   :130504:SC9389 : ALLOW REPAYMENT FOR CTA ACCT
      *                           : WHEN MAT DT = ADVANCE DT
      *----------------------------------------------------------------*
      * F GONZALES :170504: S10157 : ROUND AMT.
      *----------------------------------------------------------------*
      * JESCANER   :190504:SC7653 : COMMENT ROUTINE THAT POPULATES
      *                             BOIS-LAST-BPI-INT-DATE
      *----------------------------------------------------------------*
      * DCUNANAN   :210504:S10203 : ADDITIONAL VALIDATION FOR ERROR NO 135
      *----------------------------------------------------------------*
      * ALFRED LIN :280504: S10229 : CHANGE THE YOUBE ADVANCE FROM FORIGEN
      *                              13540 13640 PROMO-NO
      *----------------------------------------------------------------*
      * CBCORRAL   :070604: SC9859 : REPAY REM LOAN BAL AND INT ON RENEWED  
      *                              MORT COMBI ACCT      
      *----------------------------------------------------------------*
      * C.SANTILLAN:070604: S10190 : MAKE TXN 11041/11141 IB WITH INTERNAL
      *                              TXN CODE OF 29483
      *----------------------------------------------------------------*
      * RITA HUANG :04062004:S10257 :NPL/BAD DEBT WAIVE FUNCTION       *
      *----------------------------------------------------------------*
      * CPCHEN     :080604:S10056 :  FIX HIGHER-INT-RATE IN 12008      *
      *-----------------------------------------------------------------
      * JESCANER   :140604:S10219 : HANDLE THE VALIDATION WHEN ACCT 
      *                           : CREDIT TYPE WAS CHANGED FROM M TO R
      *-----------------------------------------------------------------
      * A-SAM      :170604:S10332 : FIX DUE-AMT WHEN BAL = 0 & I-DUE > 0
      *-----------------------------------------------------------------
      * DCUNANAN   :240604:S10328 : FIX GLCC FOR BAL = 0 WHEN CHG ACT TYPE
      *-----------------------------------------------------------------
      * A-SAM      :280604:SC9987 : ADD TXN 17200 TO UPDATE NEXT-DUE-DT
      *----------------------------------------------------------------
      * MCASTILLO  :300604: S10389 :ADD MULTI-OVERRIDE-AREA IN THE     *
      *                            :LINKAGE                            *
      *----------------------------------------------------------------*
      * NATHAN     :150604:S10329 :  ADD HOLD-AMT & DIS-PROMO-CODE     *
      *            :      :       :               & DIS-EXP-DATE       *
      *-----------------------------------------------------------------
      * AUSTINE    :240604:SC9582 : WRITE GLDV-36 WHEN CHKQUE TXN(20)
      *-----------------------------------------------------------------
      * DCUNANAN   :070704:S10330 : ADDITIONAL VALIDATION FOR YOUBE TXN 12410
      *-----------------------------------------------------------------
      * NATHAN     :160704:S10464 : ACT-TYPE = 7501,PAY-AMT CAN GRANT  *
      *            :      :       : THAN LOAN-BAL                      *
      *-----------------------------------------------------------------
      * CBCORRAL   :210704:S10458 : USE 921 COMPONENT IN CHANGE OF PROD/
      *                             BRANCH FOR NON ZERO 921 FLAG
      *----------------------------------------------------------------*
      * B. TULAYAN :220704:S10457 : DONT ALLOW ZERO ADJ AMT IN 10732 TXN
      *-----------------------------------------------------------------
      * JENNIFOR   :290704:S10453 : ADD AUTO LINKING MORTGAGE FUNCTION
      *                           : WHEN OPEN LOAN ACCT
      *-----------------------------------------------------------------
      * BERVE SON  :030804:S10535 : VALIDATE GLDM STATUS FOR TRANSFER   
      *                             TRANSACTIONS.                       
      *-----------------------------------------------------------------
      * JESCANER   :050804:S10445 : FIX NARRATIVE TRANSFER TRANSACTION
      *                              TO GL SYSTEM
      *-----------------------------------------------------------------
      * JESCANER   :050804:S10534 : FIX VALIDATION FOR PROJECT ID 
      *-----------------------------------------------------------------
      * JGONZALES  :120804:ST0170 : NEW REQUIREMENT OF OFFSET LOAN
      *-----------------------------------------------------------------
      * DCUNANAN   :130804:S10578 : USE PROMO CODE TO OVRD GL FOR YOUBE
      *-----------------------------------------------------------------
      * DCUNANAN   :130804:S10529 : NPL BACKDATE REP FOR YOUBE
      *-----------------------------------------------------------------
      * A-SAM      :170804:S10578 : FIX IR S10578
      *-----------------------------------------------------------------
      * JENNIFOR   :180804:S10454 : FIX AUTO LINKING MORTGAGE FUNCTION
      *-----------------------------------------------------------------
      * RITA HUANG :200804:S10623 : CONTROL PROMO CODE IN UT0028 NO NEED
      *            :      :       : TO HARD CODE TXN-CODE
      *------------------------------------------------------------------
      * BERVE SON  :230804:S10597 : FIX COMPUTATION OF ARREARS FOR      
      *                           : DEFERRED INT. WITH ADJ.             
      *-----------------------------------------------------------------
      * NATHAN     :230804:S10606 : SUPPORT EAI PROJECT
      *------------------------------------------------------------------
      * BERVE SON  :260804:S10597 : ADDITIONAL FIX : FIX COND FOR DEFFERED
      *                           : MIN/MAX VALIDATION.                   
      *------------------------------------------------------------------ 
      * J MADAMBA  :270804:S10527 : COUNTECHECK EFTM TABLE FOR TXN OCCURENCE
      *                             BEFORE PROCEEDING
      *            :300804:       : Initialize variables for error
      *------------------------------------------------------------------ 
      * DCUNANAN   :300804:S10656 : FOR YOUBE ACCT BOIS-LAST-UNPAID-DUE-DATE
      *                           : SHOULD ALWAYS BE EQUAL TO BOIS-NEXT-DUE-DATE
      *------------------------------------------------------------------ 
      * JENNIFOR   :310804:S10646 : FIX TXN12410 FOR MORTGAGE PRODUCT
      *------------------------------------------------------------------
      * TERA LIN   :010904:S10649 : NPL OR BAD_DEBT YOUBE ACCOUNT STILL ALLOW TO
      *                             REPAYMENT FROM NON_BANCSLINK CHANNEL
      *------------------------------------------------------------------
      * CBCORRAL   :020904:S10575 : SHOULD DET ADV REP MADE ON THE LAST TERM
      *                             BEFORE SO IS POSTED          
      *----------------------------------------------------------------*
      * DCUNANAN   :100904:S10711 : REMOVE PROMO CODE OVR FOR GL FOR 
      *                           : PROMO CODE "F9" IF CORR TXN
      *----------------------------------------------------------------*
      * EA TAN     :060704:S10333 : ADD NEW 2 FIELDS
      *                             YB-NEXT-DUE-DATE YB-MIN-DUE-AMOUNT
      *            :150804:S10333 : BYPASS 19045 / 19245
      *----------------------------------------------------------------*
      * DCUNANAN   :160904:S10725 : ADD TXN 10882 FOR YOUBE
      *----------------------------------------------------------------*
      * DCUNANAN   :160904:S10730 : ACT TYPE 7501 ONLY ALLOWED TO WITHDR
      *                           : OVERSEAS  
      *----------------------------------------------------------------*
      * NATHAN     :170904:S10739 : STAT = 40 CAN DO 63058,FEE-TYPE = 014
      *----------------------------------------------------------------*
      *HAROLD HUANG:210904:S10745 : REMOVE 1.ATM FLAG CHECK
      *                           :        2.ATM CARD STATUS CHECK
      *----------------------------------------------------------------*
      * DCUNANAN   :290904:S10743 : YOUBE ACCT NOT ALLOWED FOR TXN
      *                           : 11048,16048,11044,16044 AND 13031
      *----------------------------------------------------------------*
      * HAROLD     :081004:S10774 : ADD SETTLEMENT DATE IN EFTM
      *----------------------------------------------------------------*
      * DCUNANAN   :111004:S10780 : VALIDATE PROMO CODE IN CORR FOR YOUBE
      *----------------------------------------------------------------*
      * NATHAN     :111004:S10835 : FIX BUG.
      *----------------------------------------------------------------*
      * DCUNANAN   :121004:S10805 : FIX TEMP REC AMT IN VOUCHER PRINT
      *----------------------------------------------------------------*
      * B TULAYAN  :072604:S10467 : HANDLING OF REPAY FREQUENCY         
      * BERVE SON  :121004:S10467 : FIX RECOMP. OF INT. INCR/DUE AMT
      *                           : DURING BACKDATE ADVANCE.   
      *-----------------------------------------------------------------
      * JANE       :131004:S10839 : DISPLAY TELLER NO, BR NO AND TERM NO
      *                           : FOR TXN TYPE 34 IN TXN 10450
      *-----------------------------------------------------------------
      * JESCANER   :211004:S10830 : FIX MIN/MAX VALIDATION
      *                           : FOR CONSUMER W/ BAL = 0 & INT > 0 
      *-----------------------------------------------------------------
      * J MADAMBA  :221004:S10838 : ADDED COUNTER CHECKING AND CHANGE "459"
      *                           : TO "132"
      *-----------------------------------------------------------------
      * BERVE SON  :271004:S10736 : FIX  COMP. OF ARR PEN. FOR CAR LOAN 
      *                           : WITH ZERO INTEREST.                 
      *-----------------------------------------------------------------
      * RITA HUANG :091104:S10925 : TXN 10832/10872/10882/10892 IS ONLY
      *            :      :       : FOR YOUBE
      *------------------------------------------------------------------
      * BERVE SON  :191104:S10971 : ALLO 16120 BACKDATE CORRECTION.     
      *-----------------------------------------------------------------
      * M LOGATOC  :080704:NR0001 : INITIALIZE READING OF DBIO-CALL-PARAM
      *            :      :       : FOR NORMALIZATION.
      * RICKY TONG :220704:       : CHANGE X(65) TO X(102) ACCORDING TO FT0000
      *-----------------------------------------------------------------
      * RICKY TONG :020904:NQ0009 : RETROFIT S10445
      *-----------------------------------------------------------------
      * RICKY TONG :140904:NR0011 : BORV-27-TRN-CODE SHOULD NOT BE 0
      *            :      :NR0017 : BORV-34-POST-DATE CHANGED TO BORV-34-TRN-DATE
      *-----------------------------------------------------------------
      * BERVE SON  :221104:SC8758 : FIX "K" RECOMPUTATION OF DUE AMT.   
      *-----------------------------------------------------------------
      * MAGGIE LIN :261104:S10975 : IF 62000-12006 COME FROM MORTGAGE
S20175*                             DO NOT PRODUCE AUTOMATIC MIMA SLIP.
      *---------------------------------------------------------------------
      * NATHAN     :300704:S10614 : ADDITIONAL 19093 / 19095 TO PROCESS
      *-----------------------------------------------------------------
      * A-SAM      :171104:S10968 : CREATE NEW SOURCE-CODE - 15 FOR RMS
      *-----------------------------------------------------------------
      * A-SAM      :031204:S10842 : 7501-0401 CANNOT CHANGE TO YPUBE
      *-----------------------------------------------------------------
      * C.H.WANG   :021204:S10982 : ADD NEW TXNs FOR SRNM G/L TRANSFER
      *-----------------------------------------------------------------
      * RICKY TONG :121704:NN0001 : RETROFIT SC8758,S10975,S10614,S10968,S10842,S10982
      *-----------------------------------------------------------------
      * F GONZALES :131204:S11004 : FIX 13011 - NO CASH IN COUNT
      * RICKY TONG :122004:NN0002 : RETROFIT S11004
      *-----------------------------------------------------------------
      * DCUNANAN   :271204:S11041 : INCLUDE HIGH INT FOR MIN DUE AMT FOR YOUBE
      * RICKY TONG :030105:NN0004 : RETROFIT S11041
      *-----------------------------------------------------------------
      * CPCHEN     :050105:S11115 : FIX RATE EFFECTIVE ON 17026
      *-----------------------------------------------------------------
      * J MADAMBA  :060105:S10913 : USE COPYBOOK VARS WHEN CALLING UT9008
      *-----------------------------------------------------------------
      * BERVE SON  :110105:S11142 : SKIP ERROR 171 WHEN ACCOUNT IS IN ARREARS
      *-----------------------------------------------------------------
      * J MADAMBA  :120105:S10913 : FIX INCORRECT RETROFIT
      *-----------------------------------------------------------------
      * NATHAN     :130105:S11144 : ADD STRT-TXN-MORTGAGE CAN DO 17046
      *-----------------------------------------------------------------
      * RICKY TONG :140105:NN0005 : RETROFIT S10913,S11142,S11144
      *-----------------------------------------------------------------
      * CPCHEN     :140105:S10970 : FIX UT0312CA-EFF-DATE FOR INST AGR.
      *                   :S11115 : FIX RATE EFFECTIVE ON 17026
      *-----------------------------------------------------------------
      * DCUNANAN   :180105:S11111 : NEW FUNC TEMP PAY WAVE 10862
      *-----------------------------------------------------------------
      * RICKY TONG :210105:NN0005 : RETROFIT S10970,S11115,S11111
      *-----------------------------------------------------------------
      * NATHAN     :210105:S11178 : FIX IR-10614 BUG.
      * RICKY TONG :210105:NN0005 : RETROFIT S11178
      *-----------------------------------------------------------------
      * NATHAN     :170205:NQ0081 : FIX BR0000 INCORRECT ERROR FLAG
      * JEREMY LAU :170205:NQ0081 : RETROFIT
      *-----------------------------------------------------------------
      * HAROLD     :070305:S11192 : FIX IR-10711 BUG
      *-----------------------------------------------------------------
      * BERVE SON  :080305:S11219 : FIX SUPERVISOR OVERRIDE FOR 11057/16057
      *-----------------------------------------------------------------   
      * RITA HUANG :100305:S11222 : FIX 16046 BUG FOR POST OFFICE REMITT
      *            :      :       : SLIP REPAYMENT
      *-----------------------------------------------------------------
      * RITA HUANG :100305:S11226 : DO NOT ALLOW BACKDATE DISCHARGE FOR
      *            :      :       : SOME PRODUCT
      *-----------------------------------------------------------------
      * C.H.LIN    :100305:S11239 : PRINT 16044/16048'S NRTV(FORM-077)
      *-----------------------------------------------------------------   
      * NATHAN     :140105:S11173 : ADD TWO FIELD FOR CAR-PRODUCT USE
      *            :      :       : ACT-TYPE = 7101,CAT = 0201 & 0301
      *-----------------------------------------------------------------
      * CHINYI HSU :190105:S11151 : ADD TXN CODE 10893 FOR SVD
      *------------------------------------------------------------------
      * BERVE SON  :240105:S11177 : NO JOURNAL FOR TRAN 17467 WHEN DEF INT
      *                           : DATE IS <= STRT-AREA-POST-DT.         
      *------------------------------------------------------------------ 
      * TERA   LIN :021405: S11271 : FIX THE 10728 DISPLAY ERROR
      *------------------------------------------------------------------
      * C.H.LIN    :210305:S11303 : PRINT DISCHARGE TRN'S CLOSE-IND
      *----------------------------------------------------------------- 
      * NATHAN     :160205:S11313 : ACT-TYPE = 7906 CAN DO NPL
      *-----------------------------------------------------------------
      * RITA HUANG :280305:S11281 : 16120 BACKDATE CORRECTION FOR GEN SIDE
      *            :      :       : USE 25155 INSTEAD OF 20045
      *-----------------------------------------------------------------
      * TERA LIN   :280305:S11274 :  CHECK THE CUSM-REJECTED-STATU
      *            WHEN TRN-NO = '17047' AND LOAN-CLASS = '1','2','3'
      *-----------------------------------------------------------------
      * A-SAM      :220305:S11301 : YOUBE & FINE-METH = 14 RE-CALCULATE
      *                             MIN-DUE-AMT
      *-----------------------------------------------------------------
      * CHINYI HSU :300305:S11215 : 7501-0401 CAN CHANGE ORIGINAL PRODUCT
      *----------------------------------------------------------------
      * DCUNANAN   :310305:S11200 : FIX GLIF FOR INT TRAN FOR YOUBE W/ PROMO CODE
      *----------------------------------------------------------------
      * NATHAN     :310305:S11331 : SOME PRODUCT HAVE LEGAL FEE CAN'T
      *            :      :       : RECEIVE DUE-AMT
      *-----------------------------------------------------------------
      * A-SAM      :040105:S11337 : BLDV-NI-RATE-FLAG CHK EFR-CHNG-IND
      *-----------------------------------------------------------------
      * NATHAN     :040405:S11331 : REMARK IR-11331 CONDITION.
      *-----------------------------------------------------------------
      * A-SAM      :040705:S11351 : YOUBE & FINE-METH = 14 CHANGE LIMIT
      *                             MIN-DUE-AMT RE-CALCULATE
      *-----------------------------------------------------------------
      * JANE HUANG :040805:S11218 : YOUBE TEMPORARILY STOP NOT ALLOW WITHDRAW TXN
      *----------------------------------------------------------------
      * NATHAN     :130405:S11368 : ADD NPL-TO-NORMAL GLIF
      *-----------------------------------------------------------------
      * BERVE SON  :180405:S11009 : FIX RECOMP. OF "G" DURING 17026 SETUP
      *----------------------------------------------------------------- 
      * MAGGIE LIN :280305:S11214 : CHANGE IB VALIDATION RULES
      *-----------------------------------------------------------------
      * A-SAM      :220305:S11409 : FIX IR S11301
      *-----------------------------------------------------------------
      * A-SAM      :220305:S11417 : FIX IR S11351                           
      *-----------------------------------------------------------------                  
      * MAGGIE LIN :060505:S11382 : POPULATE FN PROMO FOR IB ATM TRANSFER
      *------------------------------------------------------------------
      * CHINYI HSU :120505:S11415 : FIX PRINCIPAL-AMT IN VOUCHER PRINT
      *-----------------------------------------------------------------
      * RITA HUANG :180505:S11454 : FIX 16120
      *-----------------------------------------------------------------
      * GUMI HUANG :190505:S11402 : ACCOUNT CLOSE DO THE REFRESH TO EAI
      *------------------------------------------------------------------------
      * DCUNANAN   :260505:S11455 : YOUBE INSTALLMENT
      *------------------------------------------------------------------------
      * CHINYI HSU :260505:S11323 : ADD NEW FUNCTION FOR YOUBE INSTALLMENT
      *------------------------------------------------------------------------
      * TERA LIN   :250505:S11483 : ADD 1 VIRTUAL ACNO RECORD AT FORM-75
      *------------------------------------------------------------------------
      * BERVE SON  :270505:S10542 : NEW TIB REQUIREMENT: BACKDATE CORR.   
      *                             FOR CASH AND OTHER CHANNEL REPAYMENTS.
      *-----------------------------------------------------------------  
      * NATHAN     :020605:S11504 : FIX IR 11504
      *-----------------------------------------------------------------
      * TERA LIN   :020605:S11487 : NOT DISPLAY VCHR077-RATE WHEN
      *                             BORP-INT-RATE-PRINT = 'N'
      *------------------------------------------------------------------------
      * DCUNANAN   :210605:S11542 : FIX INT ACCR FOR NIGHT MODE TXN FOR YOUBE
      *------------------------------------------------------------------------
      * NATHAN     :170605:S11555 : ACT-TYPE = 7906 CAN DO BAD-DEBT
      *------------------------------------------------------------------------
      * A-SAM      :280605:S11372 : UPDATE YB VCHR-START-DT WHEN BAL = 0
      *-----------------------------------------------------------------
      * DCUNANAN   :300605:S11584 : PUT VALUE IN JNRST-TRANSFER-TXN-BRANCH FOR 
      *                           : YOUBE INSTALMENT
      *-----------------------------------------------------------------
      * NATHAN     :010705:S11577 : FIX IR-11577
      *------------------------------------------------------------------------
      * CHINYI HSU :050705:S11567 : WHEN BAD-DEBT-IND:00 TO 51,MAKE DISAGREE
      *-----------------------------------------------------------------
      * A-SAM      :060705:S11604 : CURRENCY PAIR CANN'T REPAYMENT FOR
      *                             TIF A/C WHEN THE SAME CUSTOMER
      *-----------------------------------------------------------------
      * CHINYI HSU :130705:S11626 : FIX BUG
      *-----------------------------------------------------------------
      * DCUNANAN   :130705:S11550 : FIX BRTH FOR YOUBE FIRST ADV
      *-----------------------------------------------------------------
      * RITA HUANG :140705:S11605 : FIX GLIF FOR YOUBE NPL WAIVE FUNC
      *----------------------------------------------------------------*
      * CHINYI HSU :250705:S11575 : STAT=01 NOT ALLOW REPAYMENT
      *-----------------------------------------------------------------
      * NATHAN     :270705:S11289 : FIX IR-11289
      *-----------------------------------------------------------------
      * JESCANER   :280705:S11616 : FIX GLIF INT WHEN BACKDATE 
      *                           : CORR FR NPL TO NORM  
      *-----------------------------------------------------------------
      * JESCANER   :280705:S11624 : NO NEED TO BILL DEFERRED INT 
      *                           : WHEN DOING ADVANCE REPAYMENT
      *-----------------------------------------------------------------
      * A-SAM      :290705:S11634 : YOUBE TERM BY TERM AT MATURITY DON'T
      *                             RE CALCULATION DUE AMOUNT
      *------------------------------------------------------------------
      * DCUNANAN   :020805:S11649 : YOUBE BACKDATE BEYOND LST FIN DATE
      *------------------------------------------------------------------
      * CLARE HUANG:040805:S11617 : NEW REQUIREMENT FOR BACKDATE TRANS 16129
      *------------------------------------------------------------------
      * DCUNANAN   :110805:s11476 : TIER FUNC FOR NEW PRODUCT FOR YOUBE ACCT
      *------------------------------------------------------------------
      * CANDICE C  :110805:S11650 : ADD FIELD IN FORM 77 OF YOUBE
      *------------------------------------------------------------------
      * CANDICE C  :110805:S11651 : ADD FROM 77 FOR 12410 OF YOUBE
      *------------------------------------------------------------------
      * RITA HUANG :180805:S11659 : ADD FUN FOR BAD DEBT IND 59
      *------------------------------------------------------------------
      * JESCANER   :190805:S11727 : FIX HANDLING OF ARREARS PENALTY
      *                           : IN MIN AND MAX REPAYMENT VALIDATION
      *------------------------------------------------------------------
      * NATHAN     :110805:S11717 : SVD CAN'T ADVANCE IN OTHER COUNTRY
      *-----------------------------------------------------------------
      * CLARE HUANG:300805:S11759 : FIX BACKDATE CLOSURE CORRECTION TXN
      *------------------------------------------------------------------
      * DCUNANAN   :310805:S11743 : MODIFY MIN DUE COMPUTATION FOR YOUBE ACCT
      *------------------------------------------------------------------
      * CLARE HUANG:310805:S11671 : SEPARATE PDCPOST BGL FOR SMB
      *------------------------------------------------------------------
      * NATHAN     :260805:S11736 : ACT-TYPE = 7906 BAD CUSTOMER SPECIAL
      *            :      :       : PROCESS
      *-----------------------------------------------------------------
      * RITA HUANG :080905:S11778 : RENEW UNBILLING FUN
      *------------------------------------------------------------------
      * CLARE HUANG:130905:S11757 : SEND MSG TYPE 53 WHEN DRAWDOWN WITH SUBS
      *------------------------------------------------------------------
      * CANDICE C  :080905:S11787 : NO PRINT INT START AND END DATE
      *            :      :       : FOR YOUBE TEMP REPAYMENT
      *------------------------------------------------------------------
      * TERA  LIN  :260805:S11761 : UPDATE NPL LOGIC FOR NON-YOUBE AUTO-NPL
      *-------------------------------------------------------------------
      * NATHAN     :091605:S11796 : ACT-TYPE = "790" CAN'T CHANGE RATE
      *-----------------------------------------------------------------
      * A-SAM      :091505:S11789 : ADD NEW TXN:10245 FOR L M X Z
      *-------------------------------------------------------------------
      * CHINYI HSU :290905:S11833 : WHEN TRN-NO=17200 AND SET YOUBE TEMP =Y
      *                             PASS SUPERVISOR GRANT
      *-------------------------------------------------------------------
      * RITA HUANG :093005:S11843 : ENQUIRY 17076 AFTER MATURITY DATE NO
      *            :      :       : NEED TO POST TYPE '34' TXN
      *-----------------------------------------------------------------
      * GUMI HUANG :051005:S11751 : FIX REFRESH-TYPE >$ BUG
      *-----------------------------------------------------------------
      * CHINYI HSU :071005:S11847 : OVERRIDE JNRST-BATCH-NO WHEN PROMO-CODE=B4
      *-------------------------------------------------------------------
      * NATHAN     :251005:S11877 : ADD NEW PROMO CODE 'T4' PROCESS FLOW
      *-----------------------------------------------------------------
      * CLARE HUANG:251105:S11911 : ADD OUTPUT CODE 03 FOR ADVANCE TXN
      *            :      :       : REMOVE S11757
      *------------------------------------------------------------------
      * JOESON SU  :251105:S11874 : FIX VISA DEBIT ERROR HANDEL
      *------------------------------------------------------------------
      * GUMI HUANG :061205:S11926 : BILL PAYMENT FIX 11145/11155 REVERSE
      *-----------------------------------------------------------------
      * JANE HUANG :061205:S11929: UPDATE EXPOSURE FACILITY AFTER REPAYMENT FROM ATM CHANNEL
      *-----------------------------------------------------------------
      * CANDICE C  :061205:S11773: ADD CANC-CLOSE-IND TO SCR12410 FOR YOUBE
      *-----------------------------------------------------------------
      * A-SAM      :141205:S11977: CHECK DATE WHEN ADVANCE-PAYMENT
      *-----------------------------------------------------------------
      * C.P.HUNG   :061205:S11927 : WHEN CUST-WHEREABOUTS-UNKNOWN DISPLAY MSG
      *------------------------------------------------------------------
      * CHINYI HSU :221205:S11990: AVAILABLE LIMIT > 0,BUT STOP-TRAN-IND =Y
      *                            DISPLAY AVAILABLE LIMIT=0
      *-----------------------------------------------------------------
      * CHINYI HSU :221205:S11993: FIX WHEN ADVANCE AMOUNT <= TEMPORARY
      *                            CREDIT,VCHR075-REV-RCVBLE IS ERROR
      *-------------------------------------------------------------------
      * CLARE HUANG:050106:S12049: FIX OUTPUT CODE 03 FOR 11057
      *------------------------------------------------------------------
      * RITA HUANG :120106:S12055  : WHILE PREV-DUE-DATE > TXN-DATE, DO
      *            :      :        : NOT ALLOW MULTIPLE DRAWDOWN AND
      *            :      :        : PRINCIPAL CREDIT FOR CREDIT TYPE "R"
      *------------------------------------------------------------------
      * TERA LIN   :120106:S12068: FIX DISCHARGE PROOF
      *------------------------------------------------------------------
      * CANDICE C  :170106:S12062: YB CAN NOT DO TXN 12410 FOR GL-BUCKET-DUE(2) > ZERO
      *------------------------------------------------------------------
      * NATHAN     :170106:S12078: STAT = 20 CAN DO TRN-CODE:17200
      *------------------------------------------------------------------
      * CHINYI HSU :250106:S12067: MODIFY WAIVE TXN FOR LOAN AND YOUBE
      *-----------------------------------------------------------------
      * CLARE HUANG:170206:NR2001  : 1.REPLACE FIELD NAME BORV BY BOCT
      *            :      :        : 2.REPLACE CALLING DBIO BY CALLING UTBOCT
      *                               *****  RETFOFIT FOR S12193 ****
      *---------------------------------------------------------------- 
      * RITA HUANG :180106:S12060  : ADD THE 622 OPEN ANY BRANCH ACCOUNT
      *-----------------------------------------------------------------
      * CLARE HUANG:160206:S12056  : CHANGE INSU PREMIUM PROCESS FLOW
      *------------------------------------------------------------------
      * A-SAM      :230206:S12116  : FIX IR S12078
      *----------------------------------------------------------------
      * A-SAM      :080306:S12000  : PROCESS FOR PENDING PRINCIPAL DUE
      *----------------------------------------------------------------
      * HAROLD     :160306:S11953  : 19093 REJECT SUSPECT ACCOUNT
      *----------------------------------------------------------------
      * CHINYI HSU :200306:S12142: DEBATABLE-AMT>0 DON'T ALLOW CANCEL LOAN
      *-----------------------------------------------------------------
      * NATHAN     :220206:S12157: ALLOW NPL & BAD ACCOUNT CAN CHANGE 
      *            :      :      : PRODUCT
      *------------------------------------------------------------------
      * RITA HUANG :230306:S12147: PASS BOIS TO BR0015
      *-----------------------------------------------------------------
      * CHINYI HSU :300306:S12198: FIX IR11550 BUG
      *-----------------------------------------------------------------
      * RITA HUANG :310306:S12212: FIX IR12060 BUG
      *-----------------------------------------------------------------
      * RITA HUANG :100406:S12237: FIX IR12060 BUG
      *-----------------------------------------------------------------
      * CHINYI HSU :070406:S12218: WHEN MATURITY DISPLAY AVAILABLE LIMIT=0
      *-----------------------------------------------------------------
      * DAVID CHEN :120406:S12215: FOR API 17003, PUT WA-DUE-AMT-ROUND
      *                            TO INPUT-MESSAGE
      *-----------------------------------------------------------------
      * CLARE HUANG:310306:NR2001: END OF NR2001 **** S12193 *****
      *---------------------------------------------------------------- 
      * CANDICE C  :180506:S12263: FIX ATM CORRECT ADVANCE BUG
      *----------------------------------------------------------------
      * CHINYI HSU :220506:S12277: WHEN BORP-CONSMR AND BORP-SUB-TYPE=
      *                            "F" OR "A" PASS SUPERVISOR GRANT
      *-----------------------------------------------------------------
      * A-SAM      :150506:S12273: STANDING ORDER SKIP CHECK REPAY-TYPE
      *----------------------------------------------------------------
      * JOESON SU  :300506:S12336 : FIX VISA DEBIT FOR OVERSEA WITHDRAW
      *---------------------------------------------------------------------
      * NATHAN     :010606:S12332: HAVE HOLD TRANS NEED TO CALL UT0011
      *            :      :      : FOR CHECK OTHER COUNTRY LIMIT
      *------------------------------------------------------------------
      * RITA HUANG :061606:S12363: 17200 FUN 11
      *---------------------------------------------------------------------
      * TERA LIN   :200606:S12383: NO TO CHECK SUPERVISOR WHEN DEP  AND LOAN
      *                           THE SAME CUSTOMERIMIT
      *------------------------------------------------------------------
      * A-SAM      :062206:S12371: TXN 17200 USE API AND AUTO ADJUSTMENT
      *------------------------------------------------------------------
      * CANDICE C  :110506:S12384: ADD FUNCTION FOR 7501(1317/1337/1357)
      *----------------------------------------------------------------
      * CLARE HUANG:070606:S12328: NEW TXN 17300
      *----------------------------------------------------------------
      * CANDICE C  :130706:S12441: FIX PRE RECEIVABLE REPAY FOR 7501(1317/1337/1357)
      *----------------------------------------------------------------
      * A-SAM      :180706:S12372: FIX IR S12371
      *------------------------------------------------------------------
      * NATHAN     :190706:S12417: ADD 1 FIELD (TRANFER CONFER DATE)
      *            :      :      : NEED TO MAKE BILLING WHEN CUSTOMER
      *            :      :      : OVER
      *------------------------------------------------------------------
      * CANDICE C  :180706:S12453: ADD CHECK BORP-RECEIVABLE-YES FOR BATCH REPAY
      *------------------------------------------------------------------
      * CLARE HUANG:250706:S12394: NEW TXN 16101
      *----------------------------------------------------------------
      * CANDICE C  :020806:S12488: FIX BACKDATE CORRECT PRE-RECEIVABLE REPAYMENT
      *------------------------------------------------------------------
      * C.H.LIN    :310706:S12474: 12007,17037 UPDATE BOIS-PROMO-TELLER
      *            :      :      : PROMO-TELLER CHANGED, SUPV AUTH NEEDED
      *------------------------------------------------------------------
      * NATHAN     :140806:S12524: ADD FOR AMC PROCESS
      *-----------------------------------------------------------------
      * GUMI HUANG :230806:S12259: 12410 ACCOUNT CLOSE REFRESH TO EAI
      *------------------------------------------------------------------
      * NATHAN     :060906:S12564: PROCESS 10892 ABOUT AMC PRODUCT
      *------------------------------------------------------------------
      * CANDICE C  :080906:S12513: ADD SUP TELLER FOR 17038
      *----------------------------------------------------------------
      * OPHELIA.H  :010906:S12532: ADD NEW TRANSACTION 9015
      *------------------------------------------------------------------
      * A-SAM      :220906:S12590: CONFER AUTO TRANSFER TO NORMAL ACT
      *----------------------------------------------------------------
      * C.P.HUNG   :280906: S12520 : ALERT CRM "WHEREABOUTS UNKNOWN" WARNING MSG
      *-----------------------------------------------------------------
      * MAGGIE LIN :231006:S12648: 19093 REJECT CUSM-CUSTOMER-STATUS 005/006
      *-----------------------------------------------------------------
      * CANDICE C  :271006:S12668: ADD 18403 GLIF FOR 16030
      *-----------------------------------------------------------------
      * CHINYI HSU :271006:S12649: MODIFY WA-GENR-TX-CNT <> 0 PROCESS
      *-----------------------------------------------------------------
      * RITA HUANG :011106:S12701: NPL TRF TO CONFER PRODUCT
      *---------------------------------------------------------------------
      * RITA HUANG :021106:S12703: FIX IR12701
      *---------------------------------------------------------------------
      * NATHAN     :031106:S12696: ADD PROCESS 17200-FUNC-14
      *-----------------------------------------------------------------
      * CANDICE C  :091106:S12622: ADD YOUBE REFRESH FOR NEW NPL SYSTEM
      *----------------------------------------------------------------
      * RITA HUANG :211106:S12697: 17033 BUG FIX
      *----------------------------------------------------------------
      * KAO,TSUI-HUAN :111206:S12735: FIX  E250-LOG-DISCH.
      *       BORM-UNEARNED-INT SHOULD BE WRITTEN INTO GLIF WHEN CLOSED
      *---------------------------------------------------------------------
      * CANDICE C  :271106:S12746: ADD READINT AMDC FOR YOUBE REFRESH
      *----------------------------------------------------------------
      * NATHAN     :151206:S12777: FIX FOR PERFORMANCE
      *-----------------------------------------------------------------
      * CANDICE C  :221206:S12786: FIX FOR NEW NPL REFRESH SYSTEM
      *-----------------------------------------------------------------
      * JOESON SU  :221206:S12725: POPULATE FN PROMO FOR E-ATM TRANSFER
      *------------------------------------------------------------------------
      * NATHAN     :090107:S15020: ADD PROCESS GL-LINK FUNCTION
      *-----------------------------------------------------------------
      * A-SAM      :240107:NR2003: PERFORMANCE TUNING FOR READING BOCT
      *                            *****  RETFOFIT FOR S12672 ****
      *-----------------------------------------------------------------
      * A-SAM      :250107:S15043: 17200 ADD FUN 15
      *---------------------------------------------------------------------
      * CHINYI HSU :010207:S12794: FOR NEW NPL REFRESH ADD TXN-CODE
      *-----------------------------------------------------------------
      * CANDICE C  :030307:S12770 : WRITE VIR AC OF 36 TYPE FOR 11057/16057
      *                           : ADD 11063/11163/16063/16163
      *-----------------------------------------------------------------
      * A-SAM      :150307:S15149: BORP ADD STANDING ORDER MIN REPAYMENT
      *---------------------------------------------------------------------
      * MAGGIE LIN :070507:S15219: ADD YOUBE-INT-RATE IN RF MSG
      *-----------------------------------------------------------------
      * JANE HUANG :051007:S15241: ADD ADJ AUTH ID TML
      *-----------------------------------------------------------------
      * A-SAM      :100507:S15112: ALLOW BAD DEBT 13011/12410 FROM API
      *-----------------------------------------------------------------
      * RITA HUANG :100507:S15228: ALLOW ATM REPAY TXNS FOR NPL/BAD DEBT
      *----------------------------------------------------------------
      * MAGGIE LIN :160507:S15326: SAVE BORM REOCRD BEFORE PERFORM V700-
      *----------------------------------------------------------------
      * JANE HUANG :170507:S15078: FIX GL POSTING OF AGREED ACCT INTEREST
      *----------------------------------------------------------------
      * JENNIFOR   :170507:S15296: ADD VIP CODE FOR FEE TRANSACTION/EVENT
      *-----------------------------------------------------------------
      * CHINYI HSU :170507:S15320: NEED TO SUP.OVERRIDE FOR 10872
      *---------------------------------------------------------------------
      * JANE HUANG :220507:S15321: ALLOW PDC AUTO REPAYMENT FOR NPL, BAD BEBT ACCT
      *------------------------------------------------------------------
      * C.P.HUNG   :300507:S15361 : SVIP DO SUPER OVERRIDE
      *------------------------------------------------------------------
      * KUGAR LIN  :210507:S15266 : ADD BENEFIT CODE
      *-----------------------------------------------------------------
      * A-SAM      :130707:S15418 : RE USE FIELD BORM-DISCH-FEE-CODE
      *-----------------------------------------------------------------
      * Tsui-huan, Kao:052207:S15349: CHECK FACM(FACD)-COLM-AMT
      *----------------------------------------------------------------
      * TERA LIN   :072407:S15456 : ALLOW NPL/BAD DEBT REPAYMENT WHILE
      *                             ACT-TYPE-7
      *-----------------------------------------------------------------
      * CHINYI HSU :020807:S15449: FIRST-ADV AND BOIS-START-METHOD = "07"
      *                            INSERT BRTH
      *---------------------------------------------------------------------
      * A-SAM      :070907:S15238 : ADD INSU-RATE
      *---------------------------------------------------------------------
      * C.H.LIN    :091007:S15519: TUNING 12410:
      *            :      :      :  ADD REPAY-SRC(RE USE: MORTGAGE-INSU)
      *            :      :      :  DIVIDE LOANER-PROC-NO INTO 5 FIELDS
      *-----------------------------------------------------------------
      * NATHAN     :090407:S15492: NPL CORRECT TO NORMAL CAN DO WHEN OVER
      *            :      :      : NEXT-DUE-DATE
      *-----------------------------------------------------------------
      * A-SAM      :280907:S15542 : REPAY-SCHED = N STANDING ORDER
      *------------------------------------------------------------------
      * A-SAM      :190907:S15573 : CHECK WA-INS-FLAG
      *---------------------------------------------------------------------
      * CHINYI HSU :280907:S15562: START-METHOD = "07" SET PREF-RATE ADD BRTH
      *---------------------------------------------------------------------
      * AGNES LIN  :041007:S15599: CHANGE CALL UTOVRD FOR 10872
      *---------------------------------------------------------------------
      * CHINYI HSU :081007:S15509: MODIFY CONDITION FOR PRE-RECEIVE
      *---------------------------------------------------------------------
      * CHINYI HSU :191007:S15609: MODIFY CANCEL LOAN VALUE OF WA-DUMMY-AMT
      *---------------------------------------------------------------------
      * CHINYI HSU :261007:S15622: FIX BUG FOR PRE-RECEIVE : M
      *---------------------------------------------------------------------
      * RITA HUANG :311007:S15644: FIX BUG FOR 13042 SRNM FUN
      *---------------------------------------------------------------------
      * RITA HUANG :091107:S15642: AUTO CLOSURE FOR BORP-COMML
      *---------------------------------------------------------------------
      * HAROLD     :151107:S15187: EXTRA CHARGE FOR VISA DEBIT OVERSEAS TXN
      *---------------------------------------------------------------------
      * CHINYI HSU :301107:S15672: NOT SUB-TYPE='I' CAN TO DO 11057/16057
      *---------------------------------------------------------------------
      * CHINYI HSU :261207:S15700: ADD 18403 GLIF FOR 19011 19030 19045
      *---------------------------------------------------------------------
      * RITA HUANG :170108:S15600: ADD NEW TXN 17204
      *---------------------------------------------------------------------
      * CHINYI HSU :250108:S15769: VCHR077 DATE NEED NOT TO READ YENQ
      *---------------------------------------------------------------------
      * AGNES  LIN :240108:S15781: TXN-RESTRICTED-1 SKIP BUCKET-14 > 0
      *---------------------------------------------------------------------
      * NATHAN     :130208:S15728: OD NPL ACCT CAN CHANGE TO NORMAL
      *---------------------------------------------------------------------
      * AGNES  LIN :220208:S15799: 17003 DR/CR SAME GLCLASS STILL WRITE JRNL
      *---------------------------------------------------------------------
      * NATHAN     :130208:S15727: ADD PROCESS BANK-RATE
      *---------------------------------------------------------------------
      * CHINYI HSU :290208:S15779: TXN 12410 CAN TO UPDATE MICV-STATUS
      *---------------------------------------------------------------------
      * RITA HUANG :130308:S15787: FIX ADV CORR TXN
      *---------------------------------------------------------------------
      * NATHAN     :270208:S15813: ADD PROCESS SOURCE-ADV-DATE
      *---------------------------------------------------------------------
      * NATHAN     :010408:S15846: FIX API AUTO CONFER BUG FOR AMC
      *---------------------------------------------------------------------
      * TERA LIN   :290108:S15788  : ADD NEW PCC-CODE FIELD IN 10732
      *------------------------------------------------------------------
      * AGNES  LIN :210408:S15877: FIX FOR 10724 ONLY KEYIN ID
      *---------------------------------------------------------------------
      * T.S. KAO   :250408:S15903 : Adding new field in txn12000/17000
      *                             using BR0001-OLDEST-BDATE-DATE
      *-----------------------------------------------------------------
      * TERA  LIN  :220408: S15893: TXN 10729 ADD YOUBE TYPE ACCT-TYPE
      *-----------------------------------------------------------------
      * TERA LIN   :050208:S15922 : ADD SUB-TYPE "K" "L"
      *----------------------------------------------------------------
      * A-SAM      :150508: S15955: AUTO TRANSFER BR-CONFER
      *-----------------------------------------------------------------
      * NATHAN     :120508: S15942: CHANGE INSP FLOW
      *-----------------------------------------------------------------
      * A-SAM      :130608:S15963: PROCESS 17200 FUN-10 & API & OD ACT
      *-----------------------------------------------------------------
      * A-SAM      :170608:S15993: FIX IR S15963
      *-----------------------------------------------------------------
      * AGNES LIN  :070508: S15879: ADD HINT MESSAGE FOR FINANCE TXN
      *-----------------------------------------------------------------
      * T.S. KAO   :280508:S15967 : USING BORM-VALUER-CODE FOR MAINTENCE
      *                             BRANCH
      *-----------------------------------------------------------------
      * NATHAN     :180608: S15988: ADD CHECK ,OPEN TELLER NOT EQUAL ADVANCE
      *            :      :       : TELLER
      *---------------------------------------------------------------------
      * TERA LIN   :200608: S15999: FOR NEW NPL REFRESH ADD PROD-REORG-CREDIT
      *---------------------------------------------------------------------
      * TERA LIN   :062408:S16000 : ADD FIELD 12007-BANK-RATE,SUB-PROJ
      *----------------------------------------------------------------
      * A-SAM      :140708:S16013 : ADD CHK FOR SECOND ROUND PUB-CONFER
      *----------------------------------------------------------------
      * CHS        :250708: S15998: ADD 98924 FOR 921 NORMAL TO NPL
      *---------------------------------------------------------------------
      * AGNES LIN  :220708:S16038 : FOR 17046 CHANGE DEF-BUCKET CGL
      *----------------------------------------------------------------
      * AGNES LIN  :070808:S16064 : FOR 17046 BOIS-EFR-CHNG-IND = '1'
      *----------------------------------------------------------------
      * AGNES LIN  :210808:S16100 : CHECK 17076 FOR SOLDIER-LOAN
      *----------------------------------------------------------------
      * NATHAN     :080908: S16101: ADD PROCESS USAGE LOAN PRODUCT
      *---------------------------------------------------------------------
      * AGNES LIN  :021008: S15871: SUB-TYPE = F HAS NEW FUNCTION FOR CONFER
      *---------------------------------------------------------------------
      * JOESON SU  :221008: S16061: FIX REPOST TXN FOR RUNM-STATUS = 1
      *-----------------------------------------------------------------
      * NATHAN     :061108: S16238: FIX IR-15871 BUG.
      *---------------------------------------------------------------------
      * RITA HUANG :061108: S16235: 13047/13147/15047/15147
      *---------------------------------------------------------------------
      * Tsui-huan, Kao:13102008:S16081: UPfront Loan, adding txn-13730/13830
      *                                  replacing  13509/13609
      *------------------------------------------------------------------
      * NATHAN     :171108: S16269: ONLY CASH CARD CONFER USE NEW FUNCTION
      *---------------------------------------------------------------------
      * RITA HUANG :201108: S16271: 17046 RECAL DUE AMT
      *---------------------------------------------------------------------
      * CHS        :221008: S16201: ON-LINE ADD TXN 11030
      *---------------------------------------------------------------------
      * AGNES LIN  :051208: S16275: CHECK 17076 FOR CHINA AIRLINES LOAN
      *----------------------------------------------------------------
      * AGNES LIN  :121208:S16261 : AUTO TRANSFER CONFER A/C FROM EFLOW
      *---------------------------------------------------------------------
      * NATHAN     :181208: S16253: FIX BOIS-RATE-EXP-DATE ERR WHEN 17026
      *            :      :       : BLDV-NI-RATE CANCEL
      *---------------------------------------------------------------------
      * RIO YEN    :131208: S16272: REMOVE CHECK FOR REAL-BR-NO
      *---------------------------------------------------------------------
      * A-SAM      :080109: S16329: STAT = 40 CAN DO 63042,FEE-TYPE =011
      *----------------------------------------------------------------*
      * TERA LIN   :090109:S15544 : MOVE STRT-AREA-POST-DT TO LST-MNT-DATE
      *                             WHEN TX-10732
      *---------------------------------------------------------------------
      * AGNES LIN  :100109: S16343: CHECK CURRENCY FROM 17200
      *---------------------------------------------------------------------
      * RITA HUANG :060209: S16369: REPAY TO YOUBE A/C
      *---------------------------------------------------------------------
      * A-SAM      :130209: S15466: FIX ACCR FOR NIGHT MODE TXN FOR LOAN
      *---------------------------------------------------------------------
      * NATHAN     :250209: S16426: ADD PROCESS PRODUCT-GROUP (11)
      *---------------------------------------------------------------------
      * A-SAM      :060309: S16317: FOR BOIS-BAD-DEBT-AMT
      *---------------------------------------------------------------------
      * PENNY HUANG:011909:S16453 : WA-LIMIT-AMT 50 BSTITUTE FOR 100
      *---------------------------------------------------------------------
      * NATHAN     :110309: S16378: USAGE LOAN CAN CANCEL LOAN
      *---------------------------------------------------------------------
      * CHS        :260209: S16409: ADD PROCESS FOR USAGE LOAN OPEN A/C
      *---------------------------------------------------------------------
      * PENNY HUANG:031809: S16461: WA-LIMIT-AMT 50 SUBSTITUTE FOR 100
      *---------------------------------------------------------------------
      * RITA HUANG :190309: S16459: FIX 17053 50-->51
      *---------------------------------------------------------------------
      * RIO YEN    :100409: S16458: ADD REPAY-PRN-RECALC FOR FORM-77
      *---------------------------------------------------------------------
      * CHS        :300309:S16105 : TXN 11030 ADD API CHANNEL
      *---------------------------------------------------------------------
      * NATHAN     :030409: S16347: FIX BACKDATE DISCHARGE BUG
      *---------------------------------------------------------------------
      * RITA HUANG :160409: S16484: 12000/17000 NEED SUP.OVERRIDE WHEN
      *            :      :       : APP-AMT > BORP-MAX-LOAN
      *---------------------------------------------------------------------
      * RIO YEN    :240409: S16480: 12410 CHECK MISC-FEE2-DUE
      *---------------------------------------------------------------------
      * AGNES LIN  :170409: S16466: FOR CAPPED/COLLAR FUNC
      *---------------------------------------------------------------------
      * RITA HUANG :240409: S16485: REPAY TO YOUBE A/C
      *---------------------------------------------------------------------
      * RIO YEN    :220509: S16503: RENEW WRITE JRNL
      *---------------------------------------------------------------------
      * A-SAM      :050609: S16559: FIX S16503
      *---------------------------------------------------------------------
      * CHS        :060509: S16482: REPAYMENT OF THE AMOUNT OF CHECK AND PROMPTS
      *---------------------------------------------------------------------
      * RIO YEN    :191609: S16542: 16045 NOT SKIP BAD_DEBT_IND WHEN RENEW
      *---------------------------------------------------------------------
      * A-SAM      :070809: S16579: MODIFY SUP.OVERRIDE 5318 5319 RULE
      *---------------------------------------------------------------------
      * RITA HUANG :100709: S16564: FOREIGN LABORER LOAN
      *---------------------------------------------------------------------
      * NATHAN     :160709: S16510: PROCESS FOREIGN LABORER LOAN
      *---------------------------------------------------------------------
      * SCOTT LEE  :130509:S15848 : CHANGE THE VIP TYPE FROM 99 TO XX
      *-----------------------------------------------------------------
      * AGNES LIN  :140809: S16588: FOR AUTO LINK 17085
      *-----------------------------------------------------------------
      * A-SAM      :210809: S16618: REPAYMENT VIA DEP CHECK REPAYMENT ID
      *                             IS ONESELF OR GUARANTOR
      *-----------------------------------------------------------------
      * RITA HUANG :250809: S16665: FOR FIRST ADV TO UPDATE PENALTY SETTING
      *-----------------------------------------------------------------
      * RITA HUANG :070909: S16668: YOUTH LOAN
      *-----------------------------------------------------------------
      * A-SAM      :110909: S16661: YB CHECK INT-ACCR IN THIS TERM
      *------------------------------------------------------------------
      * A-SAM      :250909: S16682: SME VALUER-CODE FOR MAINTENCE BRANCH
      *-----------------------------------------------------------------
      * NATHAN     :161009: S16708: FIX IR-15456
      *-----------------------------------------------------------------
      * A-SAM      :161009: S16725: PENDING DISCHARGE SETUP DEFER
      *-----------------------------------------------------------------
      * TH, KAO    :261009:S16739 : ADDING FIELDS FOR BDI & FTP
      *------------------------------------------------------------------
      * A-SAM      :271109: S16663: S16618 ADD TRICKLE-TXN CONDITION
      *------------------------------------------------------------------
      * TH, KAO    :091209: S16788 : FIXED BUG: CALLING GL0023 INIT
      *------------------------------------------------------------------
      * TH, KAO    :050110: S16813 : SUBS LOAN
      *------------------------------------------------------------------
      * RITA HUANG :290110: S16757 : NEW REPAY METHOD FUN
      *------------------------------------------------------------------
      * OPHELIA.H  :050310: S16182 : REMOVE CICE
      *------------------------------------------------------------------
      * A-SAM      :050310: S16759 : FIX S16618
      *------------------------------------------------------------------
      * TH, KAO    :032610: S16866 : OD TRF TO LOAN SKIP ERR-134 CHECK
      *------------------------------------------------------------------
      * CPCHEN     :160410: S16901 : NPL CHANGE PROD TO TIB-CONFER
      *------------------------------------------------------------------
      * RITA HUANG :210510: S16938 : INIT WA-TR-NA-REAL-BR-NO WHEN
      *                              NOT AUTO ACCT NO
      *------------------------------------------------------------------
      * TH, KAO    :020610: S16945 : 11057 FOR MLOAN
      *------------------------------------------------------------------
      * NATHAN     :030610: S16900 : ADD READ BRTH
      *------------------------------------------------------------------
      * RITA HUANG :090710: S16963 : ADD HINT MESSAGE FOR PRINCIPAL REPAYMENT
      *------------------------------------------------------------------
      * RITA HUANG :150710: S16977 : NOT INCLUDE ACT-TYPE-709
      *------------------------------------------------------------------
      * TH, KAO    :100910: S17013 : wh input amt < due amt & brch622 &
      *                                 txn-11048 then sup-5342
      *-----------------------------------------------------------------
      * CPCHEN     :230910: S16997 : SPLIT INTEREST FROM 1822/1823
      *------------------------------------------------------------------
      * RITA HUANG :011010: S16976 : FOREIGN-LABORER
      *------------------------------------------------------------------
S20175* TH, KAO    :100910: S17003 : WHEN TX-11045 OVER 4S MIMA ERR,
      *                              AND  USER-TYPE IS 67, THEN
      *                              RETURN SUP CODE 5340
      *------------------------------------------------------------------
      * CPCHEN     :151010: S17043 : FIX 1822-001 => 1822-200
      *------------------------------------------------------------------
      * CPCHEN     :140111: S17067 : 3RD PERIOD EARLY CLOSURE PENALTY
      *----------------------------------------------------------------
      * A-SAM      :032510: S16871 : CALL UTROUT FOR WBS
      *------------------------------------------------------------------
      * RITA HUANG :250311: S17144 : NEW FUNCTION FOR BAD DEBT REPAYMENT
      *----------------------------------------------------------------
      * A-SAM      :040710: S17168 : FIX CHANGE ACT_TYPE
      *------------------------------------------------------------------
      * CPCHEN     :080411: S17121 : 17200 FUNC A1 ALSO EXPORT GL
      *----------------------------------------------------------------
      * RIO YEN    :290511: S17173 : ADD FEE TYPE FOR 63052
      *------------------------------------------------------------------
      * CPCHEN     :060511: S17182 : FIX 17046 FOR BYPASS BUCKET 14 &
      *                              GENERATE GLIF FOR PRE-RECEIVABLE
      *------------------------------------------------------------------
      * CPCHEN     :160611: S17192 : NPL ALSO CAN RUN 17200 FUNC 11
      *------------------------------------------------------------------
      * TH KAO     :240611: S17239 : ADD FEE TYPE FOR 63052
      *------------------------------------------------------------------
      * A-SAM      :240611: S17064 : ADD STANDING ORDER FOR BUCKET 14
      *------------------------------------------------------------------
      * A-SAM      :070711: S17250 : STANDING ORDER CHECK FOR BUCKET 14
      *------------------------------------------------------------------
      * A-SAM      :073111: S17197 : ADD HINT MESSAGE FOR ALBPS
      *------------------------------------------------------------------
      * RITA HUANG :290711: S17263 : CAR LOAN CREDIT PRINCIPAL REPAYMENT
      *----------------------------------------------------------------
      * CPCHEN     :050811: S17240 : FIX NIGHT MODE INT
      *------------------------------------------------------------------
      * A-SAM      :260811: S17255 : YOUTH LOAN 100 YEAR
      *-----------------------------------------------------------------
      * RITA HUANG :260811: S17280 : FIX NEW REPAY METHOD FUN
      *----------------------------------------------------------------
      * CPCHEN     :290911: S17282 : NEW TXN 16102
      *-----------------------------------------------------------------
      * A-SAM      :111111: S17301 : 17200 FUNC A3 ALSO EXPORT GL
      *----------------------------------------------------------------*
      * CPCHEN     :151111: S17306 : BONUS POINTS EXCHANGE
      *----------------------------------------------------------------*
      * A-SAM      :251111: S17326 : ADD HINT MESSAGE FOR AUTO-DBT-ACCNO
      *----------------------------------------------------------------*
      * CPCHEN     :161211: S17341 : FIX S17250
      *----------------------------------------------------------------*
      * HAROLD     :201211: S17331 : CANCEL IB & EATM TXN - PROMO CODE F2
      *-----------------------------------------------------------------
      * HAROLD     :040112: S17209 : VD TXN ADD STRT-BIZTALK-CR-CARD-TXN
      *-----------------------------------------------------------------
      * CPCHEN     :020212: S17384 : FIX LAST TERM PAYMENT
      *----------------------------------------------------------------*
      * A-SAM      :170212: S17327 : FIX PRODUCT GROUP 12 ~ 16
      *-----------------------------------------------------------------
      * TH  KAO    :200412: S17448 : prod-72,73 repayment allow to be less then due amt
      *-----------------------------------------------------------------
      * A-SAM      :110512: S17454 : FIX S17064
      *-----------------------------------------------------------------
      * A-SAM      :061512: S17474 : INVALID TRAN-CODE SKIP CALL ED2P
      *----------------------------------------------------------------*
      * CPCHEN     :150612: S17464 : CHANGE ACCT STAT FR CLOSE TO OPEN
      *----------------------------------------------------------------*
      * A-SAM      :030812: S17432 : 17200 FUNC A5 AUTO CLOSURE ADJUST
      *----------------------------------------------------------------
      * A-SAM      :070812: S17525 : FIX INT-ACCR FOR 13509
      *----------------------------------------------------------------
      * A-SAM      :231112: S17599 : BYPASS DC & CDC AUTO-CLSR
      *----------------------------------------------------------------
      * A-SAM      :141212: S17579 : ADD LINKAGE FOR 12695(BR0009)
      *----------------------------------------------------------------
      * RITA HUANG :210313: S17676 : FOREIGN-LABORER REPAY USE INPUT AMT
      *----------------------------------------------------------------
      * CPCHEN     :170413: S17697 : SME ALLOW MNT-BRANCH OR 622
      *----------------------------------------------------------------
      * TH  KAO    :310513: S17719 : ALBPS FROM API, BYPASS MSG-1494
      *----------------------------------------------------------------
      * CPCHEN     :170713: S17743 : NO PRIN CREDIT RESTRICTION
      *                              FOR CONFER OF CAR-LOAN
      *----------------------------------------------------------------
      * A-SAM      :260713: S17726 : CALL UT9002 FOR WBS UTL/REL
      *------------------------------------------------------------------
      * TH  KAO    :060913: S17770 : FIX BUG FOR TXN-16157
      *----------------------------------------------------------------
      * A-SAM      :170913: S17736 : REMARK S17326
      *------------------------------------------------------------------
      * TH KAO     :111013: S17808 : PROMPT MSG FOR 17000-GRACE PERIOD
      *----------------------------------------------------------------
      * A-SAM      :171013: S17727 : FIX SUBS-STOP-DATE
      *----------------------------------------------------------------
      * RITA HUANG :171013: S17816 : LIMIT USER-TYPE = 67 & 39 PROCESS
      *                              TRAN 13010/13045/13046 FOR YOUBE
      *------------------------------------------------------------------
      * TH KAO     :251013: S17813 : 13043/13143 OPEN FOR CLOSING ACCT
      *----------------------------------------------------------------
      * TH KAO     :110813: S17824 : prod-74 repay allow to be less than due amt
      *------------------------------------------------------------------
      * CPCHEN     :031213: S17830 : 16145 ALLOW INPUT-DATE = TODAY
      *------------------------------------------------------------------
      * TH KAO     :061213: S17848 : fix 63042 for SUP
      *------------------------------------------------------------------
      * CPCHEN     :080114: S17862 : NO PRIN CREDIT RESTRICTION FOR 622
      *------------------------------------------------------------------
      * A-SAM      :210214: S17870 : FIX S17727
      *----------------------------------------------------------------
      * TH KAO     :280314: S17908 : 17037 SKIP TO 17085
      *-----------------------------------------------------------------
      * CPCHEN     :100614: S17755 : NEW PROD : I-LOAN
      *------------------------------------------------------------------
      * JT.Lin     :051214: B17951 : Parameter flat file change to DB table
      *--------------------------------------------------------------------
      * A-SAM      :100715: S18252 : 10725 ADD SEL-ADDR
      *------------------------------------------------------------------
      * RITA HUANG :160715: S18279 : ADD NEW TXN 17205
      *---------------------------------------------------------------------
      * KTH        :310715: S18344 : CAR LOAN FIX FINE RATE
      *---------------------------------------------------------------------
      * A-SAM      :081015: S18365 : PENALTY USE BANK_RATE WHEN RATE = 0
      *---------------------------------------------------------------------
      * A-SAM      :081015: S18379 : ADD 17000 FILED LENGTH
      *---------------------------------------------------------------------
      * A-SAM      :031115: S18398 : 13158 OPEN FOR CLOSING ACCT
      *---------------------------------------------------------------------
      * CPCHEN     :301215: S18413 : CHANGE TXN CODE WHEN LAST TERM
      *                              PAYMENT & TXN COME FROM FEP/ATM
      *------------------------------------------------------------------
      * JOESON SU  :200116: S18391 : ADD STRT-DIB-TXN
      *-----------------------------------------------------------------
      * HAROLD     :220116: S18374 : FIX BALANCE REFRESH
      *---------------------------------------------------------------------
      * A-SAM      :040616: S18533 : INIT WS-TEMP-VIRTUAL-TYPE,FOR >L
      *---------------------------------------------------------------------
      * A-SAM      :080716: S18530 : FIX RECEIVABLE-YES
      *---------------------------------------------------------------------
      * A-SAM      :080516: S18577 : ONLY YOUBE PROD CLOSE CALL-ATM
      *---------------------------------------------------------------------
      * HAROLD     :010916: S18566 : REMOVE REFRESH TYPE ">L"
      *---------------------------------------------------------------------
      * A-SAM      :120117: S18597 : REPAY_AMT NOT RECALC WHEN INT > DUE
      *------------------------------------------------------------------
      * A-SAM      :160617: S18753 : DISPLAY ERROR ERR-FLAG=1 & MESG=0
      *------------------------------------------------------------------
      * A-SAM      :290617: S18788 : DISPLAY ERROR ERR-FLAG=1 & MESG=0
      *------------------------------------------------------------------
      * A-SAM      :151217: S18857 : INITILA FOR API TXN
      *------------------------------------------------------------------
      * A-SAM      :011918: S18829 : FIX 17033 AGREE-IND = 2 to 0
      *-----------------------------------------------------------------
      * HAROLD     :290319: S19100 : CHANGE PROMO NO FOR STRF TXN <=500
      *------------------------------------------------------------------
      * A-SAM      :090719: S19220 : ADD PENALTIES TRAN-AMT FROM BUCV P
      *-----------------------------------------------------------------
      * JACKIE Y.  :180719: S19226 : FIX YOUBE PENALTY
      *------------------------------------------------------------------
      * A-SAM      :051019: S19269 : ADD PROD FOR PB
      *------------------------------------------------------------------
      * HAROLD     :011119: S19311 : FIX VTPV-KEY
      *------------------------------------------------------------------
      * REDHSU     :201119: S19314 : CLOSE-PEN-METH ADD ITEM 6
      *------------------------------------------------------------------
      * REDHSU     :280420: S19421 : ADD 17085 CLOSE-PEN-METH ITEM 6
      *------------------------------------------------------------------
      * ATIRA R    :300320: B19392 : CHANGES TO USE COPYBOOK DLAYHERECA
      *------------------------------------------------------------------
      * ATIRA R    :140520: B19432 : FIX TO CALL DLAYHERE ONLY WHEN DBIO-
      *                              STAT IS HELD
      *------------------------------------------------------------------
      * JACKIE Y.  :310720: S19468 : CHECK ACH SUBMITTED FILE
      *------------------------------------------------------------------
      * JACKIE Y.  :240820: S19472 : ADD CURRENCY EXCHANGE FOR WBS
      *------------------------------------------------------------------
      * JACKIE Y.  :030920: S19484 : ADJUST OD CHECK SORD-ACCT
      *------------------------------------------------------------------
      * JACKIE Y.  :161020: S19470 : ADJUST GL-CLASS-CODE FOR MDT
      *------------------------------------------------------------------
      * RHYS HONG  :061020: S19524 : ADD NEW TXN 17211 17212 17213
      *------------------------------------------------------------------
      * REDHSU     :030221: S19351 : 17200 FUNC A7 A8
      *----------------------------------------------------------------
      * MICKY      :032521: S19653 : FIX OPEN ACCT IN NIGHT
      *----------------------------------------------------------------
      * JACKIE Y.  :072221: S19705 : ADD TXN 17215 FOR RICHART
      *------------------------------------------------------------------
      * MICKY      :081821: S19747 : FIX FOR RICHART TXN
      *------------------------------------------------------------------
      * MICKY      :083121: S19753 : ADD DELAYHERE FOR BORM
      *------------------------------------------------------------------
      * MICKY      :092221: S19771 : FIX BRTH DATA FOR RICHART
      *------------------------------------------------------------------
      * JACKIE Y.  :160222: S19833 : ADDING FIELDS FOR GREEN-LOAN
      *------------------------------------------------------------------
      * CH.LIN     :230322: S19775 : ENHANCE S15879 +MSG, IF CASH >=500K
      *------------------------------------------------------------------
      * JACKIE Y.  :130422: S19927 : CHANGE SENSITIVE VARIABLE
      *------------------------------------------------------------------
      * JACKIE Y.  :160622: S19967 : ADDING NAVY-FIGHTING LOAN CHECK
      *-------------------------------------------------------------------
      * XINYI      :111122: S20054 : ADD SME-ALLOWED-TXN 10729,
      *                              FOR BRANCH 628
      *-------------------------------------------------------------------
      * GILL CHEN  :150223: B19902 : FS-AP003 FEE MASK AND STRTAREA EXPANSION
      *-------------------------------------------------------------------
      * H.C. LEE   :030523: B19893 : AP005 FOR DIGIT ACCOUNT
      *------------------------------------------------------------------
      * JOYCE HONG :220523: B19901 : FS-AP002 SET NEW FIELDS OF CS0000CA
      *------------------------------------------------------------------
      * JACKIE Y.  :020623: S20175 : CHANGE SENSITIVE WORDING
      *------------------------------------------------------------------
      * CCLIN      :171023: B20330 : To remove TPSR digital data
      *------------------------------------------------------------------
      * RICKY      :112123: S20383 : DISCHAGE CAN 17034-E
      *------------------------------------------------------------------
      * XINYI      :181223: S20318 : ADD TXN 17216 FOR PRIN REPAY ENQIRY
      *------------------------------------------------------------------
      * KENNYWU    :221223: S20355 : ADD  FIELDS FOR TWO-HOUSE-IND
      *------------------------------------------------------------------
      * MICKY      :012524: S20486 : FOR MLWM
      *-----------------------------------------------------------------
      * MICKY      :022224: S20498 : FIX CORR ADV TRANS
      *-----------------------------------------------------------------
      * KENNYWU    :060224: S20487 : ADD  HINT MESSAGE FOR 10430
      *------------------------------------------------------------------
      * MICKY      :032524: S20520 : ADJUST BR0025 WA-MSG-ERR-FLAG
      *-----------------------------------------------------------------
      * ALEX       :071124: S20611 : FT0000 SEND OK FOR WEB(N)/DIB(Y)
      *-----------------------------------------------------------------
      * XINYI      :260824: S20630 : REMOVE SOLDIER-LOAN FROM AUTO-DEBT
      *-----------------------------------------------------------------
      * MICKY      :091824: S20647 : ADD UTMLWM GTE
      *-----------------------------------------------------------------
      * XINYI      :100424: S20657 : 16101 ALLOW INPUT-DATE = TODAY
      *-----------------------------------------------------------------
      * RICKY      :171024: S20669 : ADDING FIELDS FOR SRP
      *-----------------------------------------------------------------
      * ALEX       :131124: S20687 : 17200 FUN A9
      *-----------------------------------------------------------------
      * ALEX       :261224: S20699 : ADDING FIELDS FOR ONE-HOUSE-IND
      *-----------------------------------------------------------------
      * RICKY      :210225: S20759 : OUTPUTMSG INITIALIZE
      *                              FOR 13031 13131 11044 11048 11148
      *-----------------------------------------------------------------
      * RICKY      :244025: S20771 : ADD PROD FOR FBOND 7421-XXXX
      *-----------------------------------------------------------------
      * MICKY      :040725: S20751 : REMOVE MLWM SORD
      *-----------------------------------------------------------------
      * RICKY      :020525: S20744   SME MATAIAN BRCH ADD 0080 0006 0015
      *-----------------------------------------------------------------
      * MICKY      :061825: S20780 : CAR LOAN 17084 PEN CAL DATE
      *-----------------------------------------------------------------
      /
       IDENTIFICATION DIVISION.
010760 PROGRAM-ID. BR0000.
010770 AUTHOR. KAPS AND I.HASSAN.
010780* DESC. LOANS ONLINE MODULE
010790*
010800 INSTALLATION. FINANCIAL NETWORK SERVICES PTY LTD.
010810 DATE-WRITTEN. SEP 23, 1981.
010820 DATE-COMPILED. XXXXXXXXXX.
010830/
010840 ENVIRONMENT DIVISION.
010850 CONFIGURATION SECTION.
010860 SOURCE-COMPUTER. VAX.
010870 OBJECT-COMPUTER. VAX.
010880 SPECIAL-NAMES.
010890*    SWITCH-1 ON STATUS IS ATM-ONLY-REFRESH
010900*    SWITCH-2 OFF STATUS IS NO-REFRESH
010910     CONSOLE IS CONS.
010920*    SYMBOLIC CHARTERS ARE HEXADECIMAL.
010930 INPUT-OUTPUT SECTION.
010940 FILE-CONTROL.
B17951*    SELECT FS0401 ASSIGN TO
B17951*    "DTEPARAM"
B17951*    ORGANIZATION IS RELATIVE
B17951*    ACCESS MODE IS SEQUENTIAL.
010990*
011000 DATA DIVISION.
011010 FILE SECTION.
B17951*FD  FS0401.
B17951*01  ONPARAM-REC.
B17951*    COPY DTEPARM IN LIBRYMIS.
011050/
011060 WORKING-STORAGE SECTION.
     /
S12770 01  WA-SAVE-INPUT-AC-NO         PIC 9(16).
S12770 01  WA-VIR-AC-FOR-REORG-AC.
S12770     03 VIR-AC-ENTERPRISE-CODE   PIC X(5).
S12770        88 VALID-VIR-AC          VALUE "00901"
S12770                                       "00902"
S12770                                       "00904"
S12770                                       "00905".
S12770     03 VIR-AC-ID                PIC X(11).
SC9732 01  WA-OD-LINE-AMT            PIC 9(14) COMP.
S12383 01  WA-DEP-AVAIL-BAL          PIC S9(14)V999.
S15672 01  WA-LOAN-ACCT              PIC X(1).
S15672     88 WA-LOAN-ACCT-Y         VALUE "Y".
S16100 01 WS-PROJ-CODE               PIC X(04).
S16100    88 WS-SOLDIER-LOAN         VALUE "N800" "H800" "P800" "Q800"
S19967                                     "Q700" "N804" "H804" "U804"
S16100                                     "Q799" "U800" "U799" "U798".
S16275    88 WS-CHINA-LOAN           VALUE "Q798".
S16484 01  WA-SAVE-APP-AMT           PIC S9(14)V999.
S17848 01  MISCE.
S17848     05  WA-FEE-TYPE           PIC 999.
S17848     88  WA-FEE-TYPE-NO-SUP    VALUE 713, 714, 721, 723,
S17848                                731, 732, 733, 734, 735, 736,
S17848                                741, 742, 743, 744, 745, 746.
S20487 01  WK-TW0-HOUSE-IND          PIC X(01).
S20487     88 WK-TWO-HOUSE-IND-OK    VALUE "1" "3" "4" "5" "6".
S20699 01  WK-ONE-HOUSE-IND          PIC X(01).
S20699     88 WK-ONE-HOUSE-IND-OK    VALUE "1" "3" "4".
S20744 01  WA-TMP-BRANCH             PIC 9999.
S20744     88 WA-SME-BRANCH          VALUE 0015, 0080, 0006, 0622, 0063,
S20744                                     0011.
     /
SC9732 01  UTINOD-CALL-AREA.
SC9732     COPY UTINODCA IN LIBRYMIS.
S12384
S12384 01  WA-REPAY-PRN-RECALC        PIC X(1).
S12384     88 WA-REPAY-PRN-RECALC-Y   VALUE "Y".
S15509     88 WA-REPAY-PRN-RECALC-M   VALUE "M".
S12524 01  WS-PROMO-NO                PIC X(02).
S12524     88 WS-AMC-PROMO-NO         VALUE "DE".
S15813 01  WA-PRODUCT-GROUP-AREA.
S15813     03  WA-PRODUCT-GROUP       PIC 99.
S15813         88  VALID-HOUSE-LOAN   VALUE 10 THRU 19.
S15813         88  VALID-POLICY-LOAN  VALUE 10.
S16426         88  VALID-POLICY-LOAN2 VALUE 11.
S16668         88  VALID-YOUTH-LOAN   VALUE 14.
S16813         88  VALID-SUBS-LOAN    VALUE 15.
S17255         88  VALID-POLICY-YUN   VALUE 16.
S15813     03  WA-SOURCE-ADV-DATE     PIC S9(09) BINARY.
S15813     03  WA-SOURCE-REPAY-DAY    PIC 99.
S15813     03  WA-TEMP-MATURITY-DT    PIC S9(09) BINARY.
S15813     03  WA-FLOAT-RATE          PIC S9(02)V9(05).
S15813     03  WA-BANK-RATE           PIC S9(02)V9(05).
S15813     03  WA-CUST-RATE           PIC S9(02)V9(05).
S16253     03  WS-NEW-EXP-DATE        PIC S9(09) BINARY.
S11773
S11773 01  WA-BORM-INT-TOTAL          PIC S9(12) VALUE 0.
S11773 01  WA-LOANER-CLOSE-IND        PIC X(1).
S11773     88 WA-LOANER-TRANSFER      VALUE "T".
S11773     88 WA-LOANER-SECURITY      VALUE "S".
S15519     88 WA-LOANER-RECLAIM       VALUE "X".
S11773
S11773 01  WA-LOANER-NEW-ID-TYPE      PIC 9(02).
S11773     88 WA-VALID-ID-TYPE        VALUE 11 12 21.
S11773     88 WA-ID-TYPE-CORP         VALUE 21.
S11773
S11773 01  WA-DISCH-REASON-CD                  PIC 99 VALUE ZEROES.
S11773     88  WA-VALID-DISCH-CD               VALUE 01 THRU 75.
S11773     88  WA-CANCEL-CD                    VALUE 01 THRU 09.
     /
S11773     COPY UT0159CA IN LIBRYMIS.
ST0159 01  WS-ORIG-ACCT-NUM              PIC 9(17).
TB0212
TB0212 01  WA-CONV-DATE.
TB0212     03 WA-CONV-CC                    PIC 9(2).
TB0212     03 WA-CONV-YY                    PIC 9(2).
TB0212     03 WA-CONV-MM                    PIC 9(2).
TB0212     03 WA-CONV-DD                    PIC 9(2).
TB0212
S11977 01  WA-LAST-ADV-PYMT-DATE.
S11977     03 WA-LAST-ADV-PYMT-DD           PIC 9(02).
S11977     03 WA-LAST-ADV-PYMT-MM           PIC 9(02).
S11977     03 WA-LAST-ADV-PYMT-CC           PIC 9(02).
S11977     03 WA-LAST-ADV-PYMT-YY           PIC 9(02).
SC6854 01  WA-ATM-VIRTUAL.
SC6854   03 WA-VIRT-ATM-ACCT.
SC6854      05 WA-VIRT-ATM-ENT-CODE PIC 9(5).
SC6854      05 WA-VIRT-FILLER       PIC 9(11).
SC6854   03 WA-STORE-TFR-SYST       PIC X(3).
SC6096 01 WA-SAVE-BORM-LOAN-TERM     PIC 99V99.
       01 WA-SAVE-BORM-INT-RATE      PIC S9(14)V999.
       01 WA-SAVE-BORM-ADV-DATE      PIC S9(9) BINARY.
ST0137 01 WA-DISP-ORIG-INP-MSG       PIC X(75).
S12078 01 WA-17200-WORK-AREA.
S12078    03 WA-17200-OLD-ACT-TYPE   PIC X(04).
S12078    03 WA-17200-OLD-CAT        PIC X(04).
S12078    03 WA-17200-NEW-ACT-TYPE   PIC X(04).
S12078    03 WA-17200-NEW-CAT        PIC X(04).
S15727 01 WS-COMM-AREA.
S15727    03 WS-BANK-RATE            PIC S99V9999.
S15727    03 WS-CIEA-TYPE            PIC 9(03).
S15727       88 BROKERAGE-FEE-TYPE   VALUE 702.
S11173 01 WA-PRODUCT-CODE            PIC X(8).
S11173 01 WA-PRODUCT-CODE-R REDEFINES WA-PRODUCT-CODE.
S11173    03 WA-PRODUCT-1            PIC X(4).
S11173    03 WA-PRODUCT-2            PIC X(4).
SC6855 01 WS-TRANSFER-IND            PIC X.
SC7548 01 WA-RESTORE-REPAY-IND       PIC X.
SC7548    88 WA-RESTORE-REPAY     VALUE "Y".
SC6855 01 WS-BORM-GL-CLASS-CODE      PIC X(25) VALUE SPACES.
SC7546 01  WA-PROF-CODE-NARR.
SC7546     05 WA-PROF-CODE-TYPE        PIC X(2).
SC7546     05 WA-PROF-CODE-DETAIL      PIC X(14).
S12746
S12746 01  UTAMDCCA-CALL-AREA.
S12746     COPY UTAMDCCA IN LIBRYMIS.
S15228 01  WA-ATM-ALLOW                PIC X.
S19100 01  WA-STRF-FEE-FLG             PIC X.
S19100 01  WA-STRF-PROMO-NO            PIC X(2).
S19100 01  STRA-RECORD-AREA.
S19100     COPY STRAMAST IN LIBRYMIS.
S15466
S15466 01  UT0086CA-CALL-AREA.
S15466     COPY UT0086CA IN LIBRYBOR.
SC2691***
SC2691*** AMEND ALL TRANSACTION CODES HERE
SC2691*** THAT DOES NOT NEED TO WRITE TO REFRESH TABLE
SC2691***
SC2691*01 WS-NO-REFRESH-TRN-NO           PIC 9(6) VALUE 0.         SC3535
SC2691*    88 REFRESH-OFF                VALUE 32105.              SC3535
SC3535      COPY MI0090RF IN LIBRYATM.
SC3535
SC4465*----*
SC4465 01  MREF-DATA-TPS.
SC4465     COPY TPSNOTTX IN LIBRYATM.
SC4465*----*
SC4465 02  WS-RF-AMOUNT                  PIC S9(14)V999
SC4465                                   TRAILING SEPARATE.
SC5203 01  WA-RESERVED-AMT               PIC S9(14)V999 COMP.
SC5203 01  WS-NO-REC-FOUND               PIC X(01) VALUE SPACES.
ST0055 01  WA-PRINCIPAL-AMT1               PIC S9(14)V999 COMP.
SC6172 01  WA-WAIVE-AMOUNT              PIC S9(14)V999 COMP VALUE 0.
SC4954 01  YOUBE-27-PRIN-CRE-AMT         PIC S9(14)V999 COMP.
SC4954 01  YOUBE-27-TEMP-AMT             PIC S9(14)V999 COMP.
SC4954 01  YOUBE-TEMP-BAL                PIC S9(14)V999 COMP.
SC4954 01  YOUBE-PREV-TEMP-BAL           PIC S9(14)V999 COMP.
ST0055 01  WA-BR0023-DUE-AMT               PIC S9(14)V999.
SC7033 01  WA-BORM-LOAN-BAL              PIC S9(14)V999 COMP.
SC7033 01  WA-BOIS-REV-RECEIVABLE-DUE    PIC S9(14)V999 COMP.
SC7033 01  WA-BOIS-PREV-DUE-DATE         PIC S9(9) BINARY.
SC7033 01  WA-BOIS-NEXT-DUE-DATE         PIC S9(9) BINARY.
S19468 01  WA-BLDV-PP-ACHDT              PIC S9(9) BINARY.
NR2001*SC7033 01  WA-BORV-TRN-CODE              PIC S9(7) COMP.
NR2001 01  WA-BOCT-TRN-CODE              PIC S9(7) COMP.
SC7033 01  WA-BIN-DATE                   PIC S9(9) BINARY.
S11177 01  WA-BOIS-DEF-INT-END-DTE       PIC S9(9) BINARY.
SC7033 01  WA-DDMMCCYY-DATE              PIC 9(8).
SC6427 01  WS-SAVE-BORM-STAT             PIC 99.
       01  WS-SAVE-REFER                 PIC X(4).
       01  WS-SV-REFER REDEFINES WS-SAVE-REFER
                                         PIC S9(9) BINARY.
S10971 01  WA-FIND-JRNL-NO               PIC 9(6) COMP.   
S10971 01  WA-FIND-TRN-DATE              PIC S9(9) BINARY.
S10971 01  WA-FIND-ACCT-NO               PIC 9(16).       
       01  WS-BUCV-RECORD-FOUND      PIC X     VALUE "N".
       01  BUCV-RECORD-CODE          PIC X     VALUE SPACE.
ST0055     88  BUCV-RECORD-NO-MORE             VALUE "Y".
SC5203 01  WS-SUB                        PIC 9(02) VALUE ZEROES.
SC2593 01  WA-TODAY-DATE                 PIC 9(8).
SC4921 01  WA-TMP-GL-P                   PIC S9(14)V999 COMP.
SC4276 01  WS-UT0035CA-AREA.
SC4276     COPY UT0035CA IN LIBRYMIS.
ST0142 01  PDCS-RECORD-AREA.                               
ST0142     COPY PDCSMAST IN LIBRYMIS  REPLACING ==(PDCS)== 
ST0142                                         BY ==PDCS==.
S16182*S12520 01  UTCICE-CALL-AREA.
S16182*S12520     COPY UTCICECA IN LIBRYMIS
S16182*S12520                      REPLACING ==(UTCICECA)== BY ==UTCICECA==.
S10333 01  WS-TMP-DISCHARGE-AMOUNT       PIC S9(14)V999 VALUE ZEROES.
SC6939 01  UT5003-CALL-AREA.
SC6939     COPY UT5003CA IN LIBRYMIS.
S15779 01  WK5003-GROUP.
S15779     03  WK5003-CALL-CODE          PIC 9(02).
S15779     03  WK5003-ID-NO-G.
S15779         05  WK5003-ID-TYPE        PIC X(02).
S15779         05  WK5003-ID-NO.
S15779             07  WK5003-ID-NO1     PIC X(10).
S15779             07  WK5003-ID-SEQ     PIC X(01).
S15779             07  WK5003-ID-SEQ9    REDEFINES WK5003-ID-SEQ
S15779                                   PIC 9(01).
S15779             07  FILLER            PIC X(03).
S15779     03  WK5003-CIF-NO-G.
S15779         05  WK5003-CIF-NO         PIC 9(16).
S15779         05  WK5003-CIF-CHK        PIC 9(01).
S15779     03  WK5003-FULL-CIF-NO        REDEFINES WK5003-CIF-NO-G
S15779                                   PIC 9(17).
SC6939 01  WS-UT5003CA-ID-NO             PIC X(16).
S15779
S15779 01  MICM-MICV-SYSTEM              PIC X(8) VALUE
S15779                                            "MICMMICV".
TB0273 01  WA-FEDI-WORKING-STORAGE.
TB0273     05  VTPV-COUNTER              PIC 9 VALUE 0.
TB0273     05  READ-VTAM-RETURN-CD       PIC 9.
SC4522     05  WA-FEDI-BP-POST-FLAG      PIC 9 VALUE 0.
SC4522         88 FEDI-NO-GL             VALUE 0.
SC4522         88 FEDI-FROM-TO-GL        VALUE 1.
SC4522     05  WA-FEDI-BP-FLAG           PIC X VALUE "N".
SC4522         88 FEDI-NOT-BP-TXN        VALUE "N".
SC4522         88 FEDI-BP-TXN            VALUE "Y".
SC4522     05  WA-FEDI-FEE-FLAG          PIC X VALUE "N".
SC4522         88 FEDI-NO-FEE            VALUE "N".
SC4522         88 FEDI-FEE               VALUE "Y".
SC6077     05  WA-SETT-BRCH-FLAG         PIC X VALUE "N".
SC6077         88 USE-HOME-BRCH          VALUE "N".
SC6077         88 USE-SETT-BRCH          VALUE "Y".
ST0152     05  WA-WITH-AMT-FLAG          PIC 9.
ST0152         88 WITH-AMOUNT            VALUE 1.
SC8350     05  WA-SAVE-FEDI-FROM-AC      PIC 9(16).
SC8350     05  WA-SAVE-FEDI-TO-AC        PIC 9(16).
SC4522     05  WA-FEDI-COM-CODE          PIC 9(5).
SC4522     05  WA-FEDI-ACCT              PIC 9(16).
SC4522     05  WA-FEDI-PAY-TYPE          PIC 9(3).
SC4522     05  WA-FEDI-FEES.
SC4522         07  WA-HAND-RECEIVABLE    PIC 9(6).
SC4522         07  WA-HAND-RECEIVED      PIC 9(6).
SC4522         07  WA-NET-RECEIVABLE     PIC 9(6).
SC4522         07  WA-NET-RECEIVED       PIC 9(6).
SC4522         07  WA-CHARGE-TYPE        PIC X.
SC4522         07  WA-VAL-FLG            PIC X.
SC4522         07  WA-VAL-FIELD1         PIC X(30).
SC4522         07  WA-VAL-FIELD2         PIC X(30).
SC5378         07  WA-FEDI-TO-TXN-AMT    PIC S9(14)V999.
SC6077     05  WA-SAVE-BORM-CUSTOMER-NO  PIC 9(16).
SC6077     05  WA-SAVE-BORM-BRANCH-NO    PIC 9(6).
SC6077     05  WA-SAVE-BORM-CURRENCY     PIC XXX.
B19902*SC6077     05  WA-SAVE-STRT-AREA         PIC X(1132).
B19902     05  WA-SAVE-STRT-AREA         PIC X(1182).
SC6077     05  WA-SAVE-DUMMY-TRN-NO      PIC 9(6).
SC6077     05  WA-SAVE-PROMO-NO          PIC X(2).
TB0273     05  SAVE-TXN-NO               PIC 9(5).
TB0273     05  WA-FISC-SUSP-ACCT         PIC X(16).
TB0273     05  WA-FISC-SUSP-AMT          PIC 9(6).
TB0273     05  WA-BRCH-SUSP-ACCT         PIC X(16).
TB0273     05  WA-BRCH-SUSP-AMT          PIC 9(6).
TB0273     05  WA-BRHND-SUSP-ACCT        PIC X(16).
TB0273     05  WA-BRHND-SUSP-AMT         PIC 9(6).
TB0273     05  WA-BRNET-SUSP-ACCT        PIC X(16).
TB0273     05  WA-BRNET-SUSP-AMT         PIC 9(6).
TB0273     05  WA-FISCHND-SUSP-ACCT      PIC X(16).
TB0273     05  WA-FISCHND-SUSP-AMT       PIC 9(6).
TB0273     05  WA-INPUT-ACCT             PIC 9(16).
TB0273     05  FEDI-ACCOUNT              PIC 9(16).
TB0273     05  FEDI-AMOUNT               PIC 9(6).
S11483     05  SAVE-W800-TO-ACNO         PIC 9(16) VALUE ZEROS.
TB0273     05  SAVE-W800-TO-ACCT         PIC 9(16).
TB0273     05  SAVE-W800-FROM-ACCT       PIC 9(16).
SC4522     05  WA-SAVE-UTVTACCA-AREA     PIC X(300).
TB0273     05  SAVE-INPUT-MESSAGE        PIC X(983).
TB0273     05  WA-TRAN-X                       PIC 9(6).
TB0273     05  REDEFINES WA-TRAN-X.
TB0273         10  FILLER                      PIC 999.
TB0273         10  CORR-FLAG                   PIC 9.
TB0273             88  CORRECTION-TXN          VALUE 1.
TB0273         10  FILLER                      PIC 99.
TB0273             88  CASH-TXN                VALUE 10.
S19311     05  WA-VTPV-KEY-AREA.
S19311         07  WA-VTPV-KEY           PIC X(21).
S19311         07  WA-VTPV-JRNL-NO       PIC 9(6).
SC6828 01  WA-INS-PREMIUM-AREA.
SC6828     03  WA-INS-FLAG               PIC X.
SC6828     03  WA-INS-FROM-ACCT          PIC 9(16).
SC6828     03  WA-INS-TXN-AMT            PIC S9(14)V999 COMP.
SC6828     03  WA-INS-TRF-DATE           PIC 9(8).
SC6828     03  WA-INS-TO-ACCT            PIC 9(16).
B19902*SC6828     03  WA-INS-STRT-AREA-DATA     PIC X(150).
B19902     03  WA-INS-STRT-AREA-DATA     PIC X(200).
S12056     03  WA-INS-FLAG-2             PIC X.
S12056     03  WA-INS-FROM-ACCT-2        PIC 9(16).
S12056     03  WA-INS-TXN-AMT-2          PIC S9(14)V999 COMP.
S12056     03  WA-INS-TRF-DATE-2         PIC 9(8).
S12056     03  WA-INS-TO-ACCT-2          PIC 9(16).
B19902*S12056     03  WA-INS-STRT-AREA-DATA-2   PIC X(150).
B19902     03  WA-INS-STRT-AREA-DATA-2   PIC X(200).
S12056     03  WA-INS-INC-BGL.
S12056         05  WA-INS-INC-BGL-1      PIC X(3).
S12056         05  WA-INS-INC-BGL-2      PIC X(3).
S12056         05  WA-INS-INC-BGL-3      PIC X(10).
S12056     03  WA-INS-EXP-BGL.
S12056         05  WA-INS-EXP-BGL-1      PIC X(3).
S12056         05  WA-INS-EXP-BGL-2      PIC X(3).
S12056         05  WA-INS-EXP-BGL-3      PIC X(10).
S12056     03  WA-SAV-BOR-ACCT           PIC 9(16).
S12056     03  WA-SAV-BOR-ACCT-R REDEFINES
S12056         WA-SAV-BOR-ACCT           PIC X(16).
S12056     03  WA-SAVE-INV-BR            PIC 9999.
SC2383 01  WA-DUMMY-USER-TCODE           PIC 9(6).
SC2383     88  WA-DUMMY-CA-CUST                VALUE 13062
SC2383                                               13162.
SC7443 01  WA-SV-OUTPUT-MESSAGE.                    
SC7443     03  WA-SV-OUTPUT-ERR-MSG-NO   PIC 9999.  
SC7443     03  WA-SV-OUTPUT-MSG-LENGTH   PIC 9999.  
SC7443     03  WA-SV-OUTPUT-MSG          PIC X(983).
SC7443 01  WA-SV-INPUT-MESSAGE           PIC X(982).
SC7443 01  WA-SV-AREAS.                             
SC7443     03  WA-SV-STRT-AREA-TRN-NO    PIC 9(6).  
B19902     03  WA-SV-STRT-AREA-DATA      PIC X(200).
B19902*SC7443     03  WA-SV-STRT-AREA-DATA      PIC X(150).
SC9216 01  INPUT-INTERNAL-FORM.
SC9216     03 WA-25045-FROM-ACCT            PIC 9(16).
SC9216     03 WA-25045-AMOUNT               PIC S9(14)V999
SC9216                       SIGN IS TRAILING SEPARATE.
SC9216     03 FILLER                        PIC X(12).
SC9216     03 WA-25045-DESC                 PIC X(14).
SC9216     03 WA-25045-TO-ACCT              PIC 9(15).
SC9216     03 FILLER                        PIC X(31).
SC9216     03 WA-25045-DATE                 PIC 9(8).
SC9216     03 FILLER                        PIC X(120).
SC9216     03 WA-25045-CORR-JRNL            PIC 9(6).
SC9216     03 FILLER                        PIC X(742).
S15238 01  WA-INSU-AMT                   PIC S9(14).
SC5863 01  WA-SAVE-GL-BR-NO              PIC 9(4) VALUE 0.
SC5863 01  WA-SAVE-GL-ACCT-TYPE          PIC 9(4) VALUE 0.
SC5863 01  WA-SAVE-GL-INT-CAT            PIC 9(4) VALUE 0.
S16013 01  WS-SAVE-GL-CLASS-CODE         PIC X(25) VALUE SPACES.
ST0071 01  WA-SAVE-FEE-AMT               PIC 9(5) VALUE 0.
ST0071 01  WA-SAVE-FEE-ACCT              PIC 9(16) VALUE 0.
ST0071 01  WA-SAVE-TXN-DATE              PIC X(8) VALUE SPACES.
S11372 01  WA-SAVE-Y-TXN-DATE            PIC S9(9) BINARY.
SC6401 01  WA-SAVE-W41-I-SYSTEM          PIC X(3).           
SC7752 01  WA-AGREE-INT-AMT              PIC S9(14)V999 COMP.
SC7752 01  WA-OLD-BOIS-AGREE-INT         PIC S9(14)V999 COMP.
S11624 01  WA-OLD-BOIS-DEF-BUCKET-AMT    PIC S9(14)V999 COMP.
S16579 01  WA-ORIGINAL-ARREARS-CTR       PIC S9(6) COMP.
S11927 01  WA-SAVE-CUST-STATUS           PIC 9(3) VALUE 0.
TB0273 01  WA-VTPV-RECORD-AREA.
TB0273     COPY VTPVMAST IN LIBRYINV.
TB0273 01  WA-VTAM-RECORD-AREA.
TB0273     COPY VTAMMAST IN LIBRYMIS.
S16503 01  WA-RENB-RECORD-AREA.
S16503     COPY RENBMAST IN LIBRYMIS
S16503     REPLACING ==(RENB)== BY ==RENB==.
S16503     COPY RENBALT  IN LIBRYMIS.
TB0273 01  UTSHRE-CALL-AREA.
TB0273     COPY UTSHRECA     IN LIBRYMIS.
TB0273     COPY SHREMAST     IN LIBRYMIS
TB0273     REPLACING ==(SHRE)==     BY ==UTSHRECA==.
SC3719 01  WA-SUBS-AREA.
SC3719     COPY SUBSMAST   IN LIBRYBOR
SC3719     REPLACING ==(SUBS)==     BY ==SUBS==.
SC6383 01  PDCM-RECORD-AREA.
SC6383     COPY PDCMMAST IN LIBRYMIS  REPLACING ==(PDCM)==
SC6383                                       BY ==PDCM==.
SC6383 01  WA-PDC-DESC.
SC6383     05  WA-PDC-DESC-1               PIC X(12).
SC6383     05  WA-PDC-DESC-2               PIC X(12).
SC6383     05  WA-PDC-DESC-3               PIC X(06).
S16866 01  WA-OD-ACCT-NO-AREA.
S16866     05  WA-OD-ACCT-NO               PIC 9(16).
S16866     05  WA-OD-ACCT-NO-R REDEFINES WA-OD-ACCT-NO.
S16866         07  WA-OD-ACCT-NO-SPACE     PIC 9(02).
S16866         07  WA-OD-ACCT-NO-BRANCH    PIC 9(04).
S16866         07  WA-OD-ACCT-NO-TYPE      PIC 9(02).
S16866             88  VALID-OD-TRF-TO-LON VALUE 70.
S16866         07  WA-OD-ACCT-NO-SERIES    PIC 9(08).
S16866*
TB0273 01  TO-ACCOUNT-NO.
TB0273     05  WS-ENTERPRISE-CD            PIC 9(5).
TB0273         88  ENT-BILLS-PAY  VALUE   69999.
TB0273     05  WS-SHRE-CD                  PIC 9(5).
TB0273     05  WS-PAYCODE                  PIC 999.
TB0273     05  WS-FILLER                   PIC 999.
S10913* use new copybook
S10913/
S10913     COPY STLMCA IN LIBRYMIS.
S10913/
TB0277*S10913 01  WL-CALL-AREA.
TB0277*S10913     COPY UT9008CA IN LIBRYMIS.
TB0277*S10913     05  L-UT9008-SOC-NO             PIC 9(3).
TB0277*S10913     05  L-UT9008-TRN-NO             PIC 9(6).
SC3972*S10913     05  L-UT9008-SOC-BANK-NO        PIC 9(3).
SC5130*S10913     05  L-UT9008-CHANNEL-TYPE       PIC X.
TB0277*S10913     05  L-UT9008-INPUT-MSG          PIC X(982).
TB0277*S10913     05  L-UT9008-JNRST-SETLMNT-DT   PIC S9(9) BINARY.
SC3972*S10913     05  L-UT9008-TRAN-TYPE          PIC 99.
SC5130*S10913     05  L-ATM-TRANSACTION           PIC X(50).
SC3972*S10913     05  L-UT9008-PROMO-NO           PIC XX.
TB0277*    05  L-ATM-TRANSACTION           PIC 9(18).         TB0280
TB0277
TB0277 01  WS-SETLMNT-DT                   PIC S9(9) BINARY.
S10774 01  WA-ATM-9008.
S10774     05  WA-EFTM-SETLMNT-DT          PIC 9(8).
S10774     05  WA-TRAN-TYPE                PIC 99.
S15187 01  WA-VDEFEE-AREA.
S15187     05  WA-OVRS-VDEFEE              PIC 9V9999.
S15187     05  FILLER                      PIC X(25).
S16038 01  WA-BOIS-BUCKET-DUE              PIC S9(14)V999.
TB0277****END
TB0267 01  WS-EFTM-ALT.
TB0267     COPY EFTMALT1         IN LIBRYATM
TB0267     REPLACING ==:EFTM:== BY ==EFTM==.
TB0219 01  WA-DEP-NO-W PIC 9(17) VALUE ZEROES.
TB0219 01  WA-DEP-NO-X.
TB0219     05  FILLER                              PIC X.
TB0219     05  WA-DEP-NO                           PIC X(16).
TB0219* 
TB0219 01  WA-BRXFER-JRNL                          PIC 9(6).
TB0219 01  WA-PRIORITY-CDE                         PIC X(2).
SC3974 01  WA-DUE-AMT-ROUND                        PIC S9(14) COMP.
SC3441 01  WA-BUCKET-FLAG                          PIC X.
SC4000 01  WA-ACCRUAL                              PIC X.
SC1599 01  WA-BUCKET-TRAN-X                        PIC 9(7).
SC1599 01  FILLER REDEFINES WA-BUCKET-TRAN-X.
SC1599     05  FILLER                              PIC 99.
SC1599     05  WA-BUCKET-TRAN                      PIC 9(5).
SC1599 01  FILLER REDEFINES WA-BUCKET-TRAN-X.
SC1599     05  FILLER                              PIC 9.
SC1599     05  WA-BUCKET-TRAN-NO                   PIC 9(6).
SC4881 01  WA-CORR-BUCKET-TRAN                     PIC 9(6).
SC4907*01  WA-SAVE-DUMMY-AMT                       PIC 9(6).
SC6656 01  WA-SAVE-DUMMY-AMT                       PIC S9(14)V999 COMP.
SC5037 01  WA-SAVE-EXP-BORM-BAL                    PIC S9(14)V999.
SC5651 01  WA-CAST-GL-FLAG                         PIC X.
SC5651     88  WA-CAST-GEN                           VALUE "1".
SC8878 01  WA-98904-FLAG                           PIC X.
SC8878     88 WA-98904-BRANCH-CHANGE                 VALUE "B".
SC8878     88 WA-98904-PROD-CHANGE                   VALUE "P".
TB0219*
TB0219 01  WA-BUCKETS-TRAN-WORK-AREA.
TB0219     03  WA-BUCKETS-TRAN-CODE  OCCURS 200
TB0219                               INDEXED BY IX-BU.
TB0219         05  WA-BU-PRIORITY-CODE         PIC X(1).
TB0219         05  WA-BU-TRAN-CODE             PIC 9(5).
SC4881         05  WA-BU-CORR-TRAN-CODE        PIC 9(5).
TB0219     03  WA-MAX-BUCKET-TRANS             PIC 9(3) VALUE 200.
TB0219     03  WA-BUCKET-TRANS-COUNT           PIC 9(3) VALUE 0.
TB0219     03  WA-TRN-CTR                      PIC 99   VALUE 0.
TB0219     03  WA-EOF-FLAG                     PIC 9    VALUE 0.
TB0219         88  WA-END-OF-FILE                       VALUE 1.
TB0219     03  FILLER                          PIC 9    VALUE 0.
TB0219         88  WA-INITIAL-CALL                      VALUE 0.
TB0219         88  WA-INITIAL-END                       VALUE 1.
TB0219     03  WA-MAX-HIST                     PIC 99  VALUE 15.
TB0219 01  WA-DISPLAY-AREA.
TB0219     03  WA-DISP-TRAN-CODE               PIC Z(5)9.
TB0219     03  WA-DISP-BTRN-CTR                PIC Z(5)9.
TB0219     03  WA-BTRN-REC-CTR                 PIC S9(6) COMP.
SC1171 01  WA-MORT-COMBI-VAR.
SC1171     05  WA-PRINCIPAL-AMT           PIC S9(14)V999 COMP.
SC1171     05  WA-REM-BAL                 PIC S9(14)V999 COMP.
SC1171     05  WA-SAVE-EFF-DATE           PIC S9(9) BINARY.
SC4561 01  WA-TEMP-INT-INCR               PIC S9(12)V9(5) COMP.
TB0120 01  PROGNAME                       PIC X(6) VALUE "BR0000".
TB0235**--
TB0235 01  WA-YOUBE-VARS.
TB0235     03  WA-YOUBE-BKDT-DAYS              PIC 99.
TB0235     03  WA-YOUBE-ALLOW-BKDT-DAYS        PIC 99 VALUE 31.
ST0049     03  WA-YOUBE-BKDT-CORR-DAYS         PIC 9999.
S11617 01  WA-CON-BKDT-CORR-DAYS               PIC 9999.
S12332*S11717 01  WA-CLMT-CHANNEL                     PIC X(3) VALUE "ATM".
S12332*S11717 01  WA-TABLE-NAME                       PIC X(4) VALUE SPACES.
S12336 01  WA-CLMT-FOUND-FLG                   PIC X.
S12336     88 WA-CLMT-FOUND-NO                 VALUE "N".
S12336 01  WA-OVRS-WD-CHK-DATE                 PIC S9(9) BINARY
S12336                                         VALUE 38599.
SC2882 01  WA-12000-SAVE-TRN-NO                PIC 9(6) VALUE 0.
SC5286*01  WA-SAVE-UT0068-MSG-NO               PIC 9(4) VALUE 0.
SC5286 01  WA-DUMMY-KEY.
SC5286         05  WA-SOC-NO                   PIC 999.
SC5286         05  WA-CUST-NO                  PIC 9(16).
SC5286         05  FILLER                      PIC X(12).
TB0117**--
TB0117 01 WA-INPUT-KEY-CHOP.
TB0117    05 FILLER                                  PIC 9(02).
TB0117    05 WA-INPUT-KEY-13                         PIC 9(13).
TB0117    05 WA-INPUT-KEY-14                         PIC 9(01).
TB0117 01 WA-GROUP-TYPE                              PIC 9(04).
TB0117**--
TB0266
TB0266 01  WA-VOUCHER-EXTENDED-INFO.
TB0266     COPY VCHR-XTND-INFO IN LIBRYMIS.
TB0266
TB0266 01  WS-VOUCHER-VARIABLES.
TB0266     03 WS-TRIGER-VCTR           PIC 9     VALUE 0.
TB0266     03 WS-VCHR-TRANS            PIC 9(6)  VALUE 0.
ST0038     03 WS-VCHR-ORG-TRANCODE     PIC 9(6)  VALUE 0.
ST0038     03 WS-STRT-ORG-TRANCODE     PIC 9(6)  VALUE 0.
ST0038     03 WS-VCHR-CALC-AMT         PIC S9(14)V999 VALUE 0.
SC9453     03 WA-SAVE-AGREE-INT-BUCKET PIC S9(14)V999 VALUE 0.
SC9453     03 WA-SAVE-AGREE-ARR-BUCKET PIC S9(14)V999 VALUE 0.
S18829     03 WA-ADD-AGREE-INT-BUCKET  PIC S9(14)V999 VALUE 0.
SC6542     03 WS-STRT-ORG-INPUT-MSG    PIC X(982).
S10077     03 WS-VCHR-READRSW          PIC 9     VALUE 0.
S10077     03 WS-VCHR-STRT-DATE        PIC S9(9) BINARY.
S10077     03 WS-VCHR-END-DATE         PIC S9(9) BINARY.
ST0054     03 WS-REQD-VCHR-TC          PIC 9(6).
ST0054        88  WS-REQD-VCHR         VALUE 11055, 16055, 11057,
SC6542                                       16155, 16157,
S11455                                       11068, 11069,
S11455                                       16068, 16069,
S11455                                       11168, 11169,
S11455                                       16168, 16169,
S11323                                       11058, 11158,
S11323                                       16058, 16158,
S12770                                       11063, 16063,
SC6276                                       16067, 11060, 16057.
ST0054*SC6276                                16067, 11060.
ST0054        88  WS-VCHR-FORM1        VALUE 11055, 16055, 11057,
SC6542                                       16155, 16157,
S11455                                       11068, 11069,
S11455                                       11168, 11169,
S11455                                       16068, 16069,
S11455                                       16168, 16169,
S11323                                       11058, 11158,
S12770                                       11063, 16063,
S11323                                       16058, 16158,
SC6276                                       16067, 11060, 16057.
ST0054*SC6276                                16067, 11060.
SC6096        88  WS-DCHARGE           VALUE 13045, 13046, 13010,
S16235*SC6794                                       13011,
S16235                                       13011, 13047, 15047,
S18413                                       14028, 19028,
S18413                                       14041, 19041,
SC6581                                       15045, 15046.
S16235*SC6542        88  WS-DCHARGE-BACKD-COR VALUE 15145, 15146.
S16458        88  WS-DCHARGE-COR       VALUE 13145, 13146.
S16235        88  WS-DCHARGE-BACKD-COR VALUE 15145, 15146 15147.
SC6497        88  WS-BRCH-ACCT-CHANGE  VALUE 17046.
S11402        88  WS-DCHARGE-REFRESH   VALUE 13010, 13045, 13046,
S11402                                       13011, 15045, 15046,
S12259                                       12410,
S18413                                       14028, 19028,
S18413                                       14041, 19041,
S11402                                       13110, 13145, 13146,
S11402                                       13111, 15145, 15146.
S18413        88  WS-ATM-DISCH         VALUE 14028, 19028,
S18413                                       14041, 19041.
TB0266
TB0143 01 BR0090CA-CALL-AREA.
TB0143    03 BR0090CA-CALL-FACILITY-NO               PIC 9(16).
TB0143    03 BR0090CA-CALL-ID-NO.
TB0143       05 BR0090CA-CALL-ID-NUM                 PIC X(14).
TB0143       05 BR0090CA-CALL-ID-TYPE                PIC X(2).
S10077 01  YENQ-RECORD-AREA.
S10077     COPY YENQMAST   IN LIBRYBOR.
TB0155*
TB0155*** FSLON0041 - ACCOUNT TRANSFER PROCESS
TB0155*** YAKEE
TB0155*
TB0155 01  WORKING-VARIABLES-17046.
TB0155     05 WS-CIEA-EOF                 PIC 9
TB0155        VALUE ZEROES.
TB0155     05 WS-CIEA-IDX                 PIC 9
TB0155        VALUE ZEROES.
TB0155     05 WS-BOIS-EOF                 PIC 9
TB0155        VALUE ZEROES.
TB0155     05 WS-TRAN-TEMP                PIC 9(5)
TB0155        VALUE ZEROES.
TB0155     05 WS-UN-AMORTIZED-AMT         PIC S9(14)V999
TB0155        VALUE ZEROES.
SC1599*
SC1599 01  WORKING-VARIABLES-SC1751.
SC1599     05 WS-HOLD-JRNST-BALANCE       PIC S9(14)V999
SC1599                                    VALUE ZEROES.
SC1599     05 WS-HOLD-JRNST-AMOUNT        PIC S9(14)V999
SC1599                                    VALUE ZEROES.
APLEXD*-----------------------------------------------------------------
APLEXD 01  WA-OUTPUT-SAVE-AREA            PIC X(1000).
APLEXD 01  PBOOK-I                        PIC 9(3).
APLEXD 01  CHQ-I                          PIC 9(3).
APLEXD 01  RCPT-I                         PIC 9(3).
APLEXD 01  WA-SAVE-ERROR-AREA             PIC X(70).
APLEXD 01  WS-REFRESH-FLAG                PIC X.
APLEXD     88  WS-NO-REFRESH              VALUE "Y".
APLEXD*-----------------------------------------------------------------
TB0091 01  WA-PTR-BK                      PIC S9(5) COMP.
TB0091 01  WA-ZERO                        PIC S9(5) COMP VALUE 0.
TB0211 01  WA-GL-INDX                     PIC S9(4) COMP.
TB0069 01  WA-NEGO-RATE-FOUND-FLAG        PIC X.
TB0069 01  WA-FIRST-ADV-FLAG              PIC X  VALUE "N".
TB0069     88  WA-FIRST-ADV               VALUE "Y".
TB0084 01  WA-EXP                         PIC 99 VALUE 0.
TRE937*
SC8620 01  WA-ACT-TYPE-AA. 
SC8620     03 WA-ACT-GROUP                PIC 9(01).
SC8620     03 FILLER                      PIC X(03).  
TRE937 01  UTRSECCA-CALL-PARAM.
TRE937     COPY UTRSECCA IN LIBRYMIS.
TB0219 01  BTRN-RECORD-AREA.
TB0219     COPY BTRNMAST IN LIBRYBOR.
TB0158*
TB0158*** FSLON0003: WAIVE (INTEREST/PENALTIES)
TB0158*
TB0158 01  WA-VARIABLE-TEMP.
TB0158     05 WS-10240-INDX               PIC 9(2)
TB0158        VALUE ZEROES.
TB0158 01  WS-10240-JRNL-SRC.
TB0158     05 10240-JRNL-IND                      PIC 9(1).
TB0158     05 10240-JRNL-DETAIL OCCURS 30 TIMES.
TB0158        10 10240-JRNL-TRAN-CODE             PIC 9(6).
TB0158        10 10240-JRNL-ACTUAL-AMT            PIC S9(14)V999.
TB0158        10 10240-JRNL-BALANCE-AMT           PIC S9(14)V999.
NR2001*TB0158        10 10240-JRNL-BORV-CODE             PIC 9(2).
NR2001        10 10240-JRNL-BOCT-CODE             PIC 9(2).
TB0158        10 10240-JRNL-TYPE                  PIC X(2).
S12524        10 10240-JRNL-PROMO-NO              PIC X(2).
TB0158*
TB0215*
TB0215*** FSLON0045 - TYPE
TB0215*
TB0215 01  BR0005-MISC-VARIABLE.
TB0215     03 BR0005-JOURNAL-FLAG         PIC 9(1)
TB0215             VALUE ZEROES.
TB0027 01  WA-CURR-TRCODE                 PIC 9(6)  VALUE ZEROES.
TB0027     88  WA-CASH-DEBIT-ADD                    VALUE 10010
TB0027                                                    11010
TB0027                                                    15010
SC1514                                                    13010
SC1514                                                    13031
TB0027                                                    16010
SC7091                                                    19011
SC7091                                                    19111
SC4890                                                    14010
SC5862                                                    14011
SC5862                                                    14111
SC4890                                                    14110
S16453                                                    13012.
TB0027     88  WA-CASH-CREDIT-ADD                   VALUE 10060
TB0027                                                    11060
TB0027                                                    15060
TB0027                                                    16060
SC7091                                                    19060
SC4803                                                    14060
S16453                                                    13061
S16453                                                    13062.
TB0027     88  WA-CASH-DEBIT-LESS                   VALUE 10110
TB0027                                                    11110
TB0027                                                    15110
SC1514                                                    13110
SC1514                                                    13131
TB0027                                                    16110.
TB0027     88  WA-CASH-CREDIT-LESS                  VALUE 10160
TB0027                                                    11160
TB0027                                                    15160
TB0027                                                    16160.
SC0367     88  WA-TFR-FROM-DEP-ACCT                 VALUE 11044
SC0367                                                    11045
SC0367                                                    13042
SC0367                                                    13043
SC0367                                                    13045
SC0367                                                    15045
SC0367                                                    16044
SC0367                                                    16045
SC0367                                                    17467.
S16482     88  WA-REPAY-SUPR-OVR-Y                  VALUE 11046
S16482                                                    11049
S16482                                                    16046
S16482                                                    16049.
S16618     88  WA-RPYMT-VIA-DEP                     VALUE 11045
S16618                                                    16045.
S17263     88  WA-PRIN-CREDIT-TRF                   VALUE 11044
S17263                                                    16044
S17263                                                    11048
S17263                                                    16048.
S19468     88  WA-ACH-POPUP-CHK                     VALUE 11010
S19468                                                    16010
S19468                                                    11045
S19468                                                    11046
S19468                                                    16045
S19468                                                    16046
S19468                                                    11049
S19468                                                    16049
S19468                                                    11030
S19468                                                    16030
S19468                                                    13031
S19468                                                    11044
S19468                                                    11048
S19468                                                    16044
S19468                                                    16048
S19468                                                    13010
S19468                                                    13045
S19468                                                    13046
S19468                                                    13047
S19468                                                    13011
S19468                                                    15045
S19468                                                    15046
S19468                                                    15047.
TB0027 01  WA-CASH-DB-LOAN-ERR-MSG           PIC X(44)
TB0027        VALUE "TODAY CASH DEBIT LOAN AMT EXCEEDED LIM".
TB0027 01  WA-CASH-CR-LOAN-ERR-MSG           PIC X(45)
TB0027        VALUE "TODAY CASH CREDIT LOAN AMT EXCEEDED LIM".
011200 01  WA-TEMP-DATE                      PIC 9(8).
S15519 01  WA-PROC-SIGN-DATE                 PIC X(8).
S15519 01  WA-PROC-SIGN-YYYYMMDD-R REDEFINES WA-PROC-SIGN-DATE.
S15519         05  WA-PROC-SIGN-CCYY         PIC 9(4).
S15519         05  FILLER  REDEFINES  WA-PROC-SIGN-CCYY.
S15519             07  WA-PROC-SIGN-CC       PIC 9(2).
S15519             07  WA-PROC-SIGN-YY       PIC 9(2).
S15519         05  WA-PROC-SIGN-MM           PIC 99.
S15519             88  WA-PROC-SIGN-MM-OK      VALUE 01 THRU 12.
S15519         05  WA-PROC-SIGN-DD           PIC 99.
S15519 01  WA-REMAINDER                      PIC 9     VALUE 0.
S15519 01  WA-LEAP-REM                       PIC 99    VALUE 0.
S15519 01  WA-FEB-DAYS                       PIC 99    VALUE 0.
S15963 01  WA-OD-TO-LOAN                     PIC X     VALUE "N".
S15963 01  WA-SAVE-STRTAREA.
S15963     03  WA-SAVE-ST-AREA-TRN-NO          PIC 9(6).
B19902     03  WA-SAVE-ST-AREA-DATA            PIC X(200).
B19902*S15963     03  WA-SAVE-ST-AREA-DATA            PIC X(150).
S15963     03  WA-SAVE-ST-AREA-INPUT-MSG       PIC X(982).
SC5381                               
SC5381 01  UT0078CA-CALL-AREA.       
SC5381     COPY UT0078CA IN LIBRYBOR.
TB0099/
NR2001*TB0099 01  GLDV-RECORD-AREA.
NR2001*TB0099     COPY GLDVVARV IN LIBRYGEN.
NR2001 01  GECT-RECORD-AREA.
NR2001     COPY GECTVARV IN LIBRYGEN REPLACING ==(GECT)==
NR2001                               BY        ==GECT==.
TB0099/
TB0099 01  UTSRNMCA-CALL-AREA.
TB0099     COPY UTSRNMCA IN LIBRYMIS.
TB0099
TB0219 01  INOD-RECORD-AREA.
TB0219     COPY INODMAST IN LIBRYINV.
TB0219 01  INOD-ALTERNATE-KEY.
TB0219     COPY INODALT  IN LIBRYINV.
S15963 01  INOD-ALT3-AREA.
S15963     COPY INODALT3 IN LIBRYINV.
TB0219/
TB0099 01  ST-DBIO-CALL-AREA.
TB0099     03  ST-DBIO-CALL-CODE                 PIC 99.
TB0099
S12332*S11717 01  CLMT-RECORD.
S12332*S11717     COPY CLMTMAST IN LIBRYMIS.
S12725 01  TELM-RECORD-AREA.
S12725     COPY TELMMAST IN LIBRYMIS.
S12725
S12725 01  WS-TELM-DB-PARAMS.
S12725     03  WS-TELM-PARAM.
S12725         05  WS-TELM-FUNC                PIC 99.
S12725         05  FILLER                      PIC X(20).
S12725         05  WS-TELM-SAVE-REFER          PIC XXXX.
S12725         05  FILLER                      PIC X.
S12725         05  WS-TELM-LOCK-FLAG           PIC X VALUE "0".
S12725         05  FILLER                      PIC X(474).
S12725     03  WS-TELM-KEY.
S12725         05  WS-TELM-SOC-NO              PIC 999.
S12725         05  WS-TELM-TELLER              PIC 9(16).
S12725         05  FILLER                      PIC X(12).
S12725     03  WS-TELM-STATUS-1                PIC XXXX.
S12725     03  WS-TELM-SYS.
S12725         05  FILLER                      PIC XXXX VALUE "TELM".
S12725         05  FILLER                      PIC XXXX VALUE SPACES.
TB0157
TB0157 01  WA-UTINSPCA-AREA.
TB0157     COPY UTINSPCA IN LIBRYMIS.
TB0157 01  WA-PREMUIM-ROUNDED                  PIC S9(14)V99.
TB0137 01  UTVTACCA-CALL-PARAM.
TB0137     COPY UTVTACCA IN LIBRYINV.
TB0016**--
           COPY RELMVALS IN LIBRYMIS.
       01  UT0400-CALL-AREA.
           COPY UT0400CA IN LIBRYMIS.
           COPY RELMMAST IN LIBRYMIS.
TB0016**--
011210 01  WA-INVM-RECORD-AREA.
011220     COPY INVMMAST IN LIBRYINV.
SC0367/
SC0367 01  INVE-RECORD-AREA.
SC0367     COPY INVEMAST IN LIBRYINV.
SC0367/
S19927 01  WA-PSWD.
SC0367     03 FILLER                    PIC X.
SC0367     03 WA-PSWD-2                 PIC X.
SC0367     03 FILLER                    PIC XX.
SC0367     03 WA-PSWD-3                 PIC X.
SC0367     03 FILLER                    PIC X.
SC0367     03 WA-PSWD-1                 PIC X.
SC0367     03 FILLER                    PIC X.
SC0367     03 WA-PSWD-4                 PIC X.
SC0367     03 FILLER                    PIC X.
SC0367 01  WS-PSWD.
SC0367     03 WS-PSWD-2                 PIC X.
SC0367     03 WS-PSWD-3                 PIC X.
SC0367     03 WS-PSWD-1                 PIC X.
SC0367     03 WS-PSWD-4                 PIC X.
SC0367 01  WA-PSWD-CTR                  PIC 99.
011240 01  WA-GENERATED-TXN.
011250     03  WA-GEN-TXN-CODE               PIC 9(6) COMP.
011260     03  WA-GEN-AMOUNT                 PIC S9(14)V999 COMP.
011270     03  WA-GEN-BALANCE                PIC S9(14)V999 COMP.
011280 01  WA-30DL-FACTOR                    PIC 9(4).
011290 01  WA-30DL-NO-DAYS                   PIC 9(4).
011300 01  WA-NO-INT-DAYS-YR                 PIC 9(3).
NR2001*011310 01  WA-BORV-RECIEPT-AREA              PIC X(65).
NR2001 01  WA-BOCT-RECIEPT-AREA.
NR2001     COPY BOCTSIZE IN LIBRYBOR
NR2001          REPLACING ==(BOCT)== BY ==BOCT==.
011320 01  WA-SAVE-INPUT-ACCT-NO             PIC 9(16).
011330 01  WA-SUB                            PIC 9(3).
SC3441 01  WA-SUB1                           PIC 9(3) VALUE 0.
TB0069 01  WA-SUB-BLDVNI                     PIC 9(3).
TB0096 01  WA-MAX-SUB                        PIC 99 VALUE 10.
TB0096 01  WA-UT94-FLAG                      PIC X VALUE "N".
TB0096 01  TEMP-TERM-NO                      PIC 9(04).
TB0096 01  TEMP-SEQ-NO                       PIC 9(04).
S16997 01  WA-GRACE-DAYS                     PIC 9(5).
S16997**SC1857 01  WA-GRACE-DAYS                     PIC 9(3).
011340 01  WA-TXN775-MSG-TEXT.
011350     03  WA-TXN775-CTR-AMT             PIC X.
011360     03  WA-TXN775-ADJM                PIC Z(11)9.999-.
011370 01  WA-CHK-ACCT-CD                    PIC XXX.                         
011380 01  WA-CHK-CURR-CD                    PIC XXX.                         
011390 01  WA-CHK-CURR-AMT                   PIC S9(14)V999                   
011400                                       TRAILING SEPARATE.               
TB0219 01  WA-EXP-IDX                        PIC 9     VALUE 0.
TB0169 01  WA-CHG-FAC-IND                    PIC X     VALUE "N".
011410 01  WA-CHK-BASE-AMT                   PIC S9(14)V999                   
011420                                       TRAILING SEPARATE.               
TRE906 01  WA-TEMP-ACT-TYPE                  PIC 9(08).
011440 01  UT9000-CALL-AREA.
011450     COPY UT9000CA IN LIBRYMIS.
NLB115 01  UT9998-CALL-AREA.
NLB115     COPY UT9998CA IN LIBRYMIS.
011480 01  WA-TEXT-AVAIL-FLAG          PIC X(5).
011490     88  WA-TEXT-AVAIL            VALUE "TRUE".
011500     88  WA-NO-TEXT-AVAIL         VALUE "FALSE".
011510 01  UT0197-CALL-CODE            PIC 9(2) VALUE 0.
011520/
TB0008 01  KEY-RNUM-AREA.
TB0008     03  KEY-RNUM-INST-NO                PIC 999.
TB0008     03  KEY-RNUM-BRANCH-NO              PIC 9(4).
TB0008     03  KEY-RNUM-ACCT-TYPE              PIC 9(4).
TB0008     03  KEY-RNUM-RESERVE-ACCT-NO        PIC 9(16).
TB0008 01  RNUM-DATA-REC-WA.
TB0008     COPY RNUMMAST IN LIBRYMIS.
SC8720 01  ANUM-DATA-REC-WA.
SC8720     COPY ANUMMAST IN LIBRYMIS.
TB0008 01  AUTO-ACCT-FLAG                      PIC X.
TB0008 01  AUTO-ACCT-IND                       PIC X.
SC9862 01  WA-ROUND-AMNT-0                 PIC S9(17) COMP.
TB0223 01  WA-DEF-BILL-DUE-AMT             PIC S9(14)V999 VALUE 0.
SC2439 01  WA-DEF-AMORT-AMT                PIC S9(14)V999 VALUE 0.
TB0070 01  WA-WORK-INPUT                   PIC S9(14)V999 COMP VALUE 0.
TB0070 01  WA-WORK-MIN-AMT                 PIC S9(14)V999 VALUE 0.
TB0070 01  WA-WORK-MAX-AMT                 PIC S9(14)V999 VALUE 0.
S16269 01  WA-CALC-DUE-AMT                 PIC S9(14)V999 VALUE 0.
S16997 01  WA-NON-TAX-AMT                  PIC S9(14)V999 VALUE 0.
S16997 01  WA-TAX-CUT-DT                   PIC S9(9) BINARY
S16997                                                    VALUE 40178.
TB0070 01  WA-NEW-DUE-AMT                  PIC S9(14)V999 VALUE 0.
TB0070 01  WA-INT-DUE                      PIC S9(14)V999 VALUE 0.
TB0070 01  WA-PRIN-DUE                     PIC S9(14)V999 VALUE 0.
TB0070 01  WA-LEGAL                        PIC S9(14)V999 VALUE 0.
TB0070 01  WA-INTEREST                     PIC S9(14)V999 VALUE 0.
SC9037 01  WA-INT-DUE-14                   PIC S9(14)V999 VALUE 0.
SC7587 01  WA-INTEREST-B4-ADJ              PIC S9(14)V999 VALUE 0.
TB0070 01  WA-PENALTY                      PIC S9(14)V999 VALUE 0.
SC6189 01  WA-DEF-INT-AMT                  PIC S9(14)V999 VALUE 0.
SC4330 01  WA-A-BUCV-EXIST                 PIC 9.
SC4330     88 PENALTY-NO-EXIST             VALUE 0.
SC4330     88 PENALTY-EXIST                VALUE 1.
ST0055 01 WA-INDEX                         PIC 999.
ST0055 01 WA-BUCV-NO-RECORD                PIC X  VALUE "N".
ST0055       88 BUCV-NO-RECORD                    VALUE "Y".
TB0070 01  WA-DEF-INT                      PIC S9(14)V999 VALUE 0.
TB0070 01  WA-WORK-EXCESS                  PIC S9(14)V999 COMP VALUE 0.
TB0070*01  WA-TERM-CTR                     PIC 99.
SC5571 01  WA-TERM-CTR                     PIC 9(4).
TB0070 01  WA-TERM-CTR2                    PIC 99.
TB0070 01  WA-EOF                          PIC X.
TB0070 01  WA-BUCV-AREA.
TB0070     COPY BUCVVARV IN LIBRYBOR.
SC2159     COPY BUCVALT  IN LIBRYBOR.
SC2159     COPY BUCVALT2 IN LIBRYBOR.
TB0070 01  UT0075CA-CALL-AREA.
TB0070     COPY UT0075CA IN LIBRYBOR.
CS4463 01  WA-SAVE-TRN-TXN-BRANCH              PIC S9(4) COMP.
TB0102 01  WA-TRAN-NO-MORE-FLAG                PIC X VALUE "N".
TB0102     88  WA-TRAN-NO-MORE                 VALUE "Y".
TB0159
TB0159 01  WA-ADV-DATE-DDMMCCYY.
TB0159     03  WA-ADV-DATE                     PIC 9(8).
TB0159     03  WA-ADV-DATE-R REDEFINES WA-ADV-DATE.
TB0159       05  WA-ADV-DATER-DD               PIC 99.
TB0159       05  WA-ADV-DATER-MM               PIC 99.
SC1231           88 WA-ADV-MONTH-31  VALUE 01 03 05 07 08 10 12.
TB0159       05  WA-ADV-DATER-CC               PIC 99.
TB0159       05  WA-ADV-DATER-YY               PIC 99.
011530 01  WA-AUDT-AREA.
011540     02  WA-AUDT-FUNCTION                PIC 9(02) VALUE 01.
011550     02  WA-AUDT-STATUS                  PIC X(04).
011560     02  WA-AUDT-RRN                     PIC 9(06).
011570  COPY AUDTHEADER IN LIBRYMIS.
011580         03  WA-AUDT-OLD-IMAGE.
011590             COPY INVMAREA  IN LIBRYINV.
011600         03  WA-AUDT-NEW-IMAGE.
011610             COPY INVMAREA  IN LIBRYINV.
011620         03  FILLER                      PIC X(135).
011630/
011640 01  MS0010CA-AREA.
011650     COPY MS0010CA IN LIBRYMIS.
011660/
011670*   760167 TELEPAC REFRESH MODULE AREAS.
011680*TB0226 01  LS-EI0085CA.
011690*TB0226     COPY EI0085CA IN LIBRYATM.
TB0226 01  LS-MI0095CA.
TB0226     COPY MI0095CA IN LIBRYATM.
TBN226 01  WA-CLCM-REC.
TBN226     COPY CLCMMAST IN LIBRYMIS.
011700/
011710 01  LS-RFSH-AREA.
011720     COPY PASARFSH IN LIBRYMIS.
011730/
TB0099 01  FACM-AREA.
TB0099     COPY FACMMAST IN LIBRYMIS.
TB0099/
SC0883 01  BMPT-RECORD-AREA.
SC0883     COPY BMPTPARM IN LIBRYBOR.
SC0883/
011740 01  WS-EFTM-AREA.
011750     COPY EFTMMAST IN LIBRYATM
011760          REPLACING ==:EFTM:== BY ==EFTM==.
011770/
SC3409 01  TMP-EFTM-AREA.
SC3409     COPY EFTMMAST         IN LIBRYATM
SC3409          REPLACING ==:EFTM:== BY ==EFTMTMP==.
SC3409 01  UTEFTM-CALL-AREA.
SC3409     COPY UTEFTMCA IN LIBRYATM.
SC3409     COPY EFTMMAST IN LIBRYATM
SC3409     REPLACING  ==:EFTM:== BY ==EFTMCA==.
TB0212     COPY EFTMALT1         IN LIBRYATM
TB0212     REPLACING ==:EFTM:== BY ==EFTMCA==.
TB0212
SC3409
011780     COPY UT9100CA IN LIBRYMIS.
011790/
011800     COPY BR0023CA IN LIBRYBOR.
  
011820     COPY BR0024CA IN LIBRYBOR.
011830/
SC9302 01  BR0038CA-CALL-PARAM.
SC9302     COPY BR0038CA IN LIBRYBOR.
S11778 01  BR0032CA-CALL-PARAM.
S11778     COPY BR0032CA IN LIBRYBOR.
SC9302/
011840*TB0226 01  LS-MI0090CA-CALL-AREA.
011850*TB0226     COPY MI0090CA IN LIBRYATM.
TB0226     01  LS-MI0090CA-CALL-AREA.
TB0226         COPY MI0090CA IN LIBRYATM.
011860 01  LS-MREF-AREA.
011870     COPY MREFMAST IN LIBRYATM
011880          REPLACING ==:MREF:== BY ==MREF==.
011890*  NESTED COPY REPLACING STATEMENTS DO NOT WORK ON MVS *24H009*
011900   03    MREF-DATA-NO-TXNS
011910           REDEFINES MREF-DATA-AREA.
011920           COPY EFTRNOTX IN LIBRYATM.
011930*    05  FILLER                            PIC X(190).            TB0212-C
011930     05  FILLER                            PIC X(872).            TB0212-C  
011940   03    MREF-DATA-WITH-TXNS
011950           REDEFINES MREF-DATA-AREA.
011960           COPY EFTRTXNH IN LIBRYATM.
S18374     05  FILLER                            PIC X(394).
011970*    05  FILLER                            PIC X(32).             TB0212-C
S18374*011970     05  FILLER                            PIC X(714).     TB0212-C
011980   03    MREF-CIF-DATA
011990           REDEFINES MREF-DATA-AREA.
012000           COPY EFTCIFTX IN LIBRYATM.
SC0883
SC0883 01  YOUBE-WORK-AREA.
SC0883     03  WA-MIN-DUE-AMT             PIC S9(14)V999.
S16661     03  WA-INT-TOTAL               PIC S9(14).
S16661     03  WA-INT-ACCR-R              PIC S9(14)V999.
SC0883     03  WA-MAX-AMOUNT              PIC 9(10).
SC0883     03  WA-PAYMT-RATIO             PIC 9(3)V9(2).
SC0883     03  WA-FIX-MIN-REPAYMENT       PIC 9(10).
SC0883     03  WA-REV-RECEIVABLE          PIC S9(14)V999.
SC0883     03  RANGE-FOUND-SW             PIC 9.
SC0883         88 RANGE-FOUND             VALUE 1.
SC0883     03  CTR                        PIC 99.
S11542     03  WA-INT-FROM-DATE           PIC S9(9) BINARY.
S11542     03  WA-INT-TO-DATE             PIC S9(9) BINARY.
S11542     03  WA-INT-RATE-CALC           PIC 99V9999.     
S11542     03  WA-GRACE-INT-DAYS          PIC 9(3).        
S18577     03  WA-YB-FLAG                 PIC X.
S18577         88 WA-YOUBE-PROD           VALUE "Y".
012010/
012020 01  WS-STD-DATE.
012030     03  WS-STD-DD                      PIC 99.
012040     03  WS-STD-MM                      PIC 99.
012050     03  WS-STD-CC                      PIC 99.
012060     03  WS-STD-YY                      PIC 99.
TRE937 01  WA-TEMP-TERM                       PIC 9(3).                       
TRE937 01  WA-TEMP-TERM-R REDEFINES WA-TEMP-TERM                              
TRE937                                        PIC X(3).                       
012100 01  WS-POST-DATE.
012110     03    WS-POST-CC                   PIC 99.
012120     03    WS-POST-YY                   PIC 99.
012130     03    WS-POST-MM                   PIC 99.
012140     03    WS-POST-DD                   PIC 99.
012150 01  WS-TEMP-TIME-8              PIC 9(08).
012160 01  WS-TEMP-TIME-8-R REDEFINES WS-TEMP-TIME-8.
012170     05  WS-TEMP-TIME-6          PIC 9(06).
012180     05  FILLER                  PIC 9(02).
012190 01  WA-WORK-BAL-BEFORE          PIC S9(14)V999.
012200 01  WA-WORK-BAL-AFTER           PIC S9(14)V999.
012210*TB0226 01  EI0090-REFRESH-FLAG         PIC X.
TB0226 01  MI0090-REFRESH-FLAG         PIC X.
TBN226 01  WA-FOR-85007.
TBN226     03 WA-IDNO-KEY.
TBN226        05 WA-ID-NO              PIC X(14).
TBN226        05 WA-ID-TYPE            PIC X(2).
012220 01  WA-DUMMY-TRACER-NO          PIC 9(6).
012230 01  WA-PROCESSED-FEE-FLAG           PIC 9.                              
012240 01  W100-DUD                        PIC 9(4).
012250 01  W100-REMAINDER                  PIC 9.
012260 01  W100-CAPN-FREQ                  PIC 99.
012270 01  W100-REPAY-CAPN-FREQ            PIC 99.
012280 01  W100-DD                         PIC 9(4).
012290 01  WA-WORK-BAL                     PIC S9(14)V999 COMP VALUE 0.
012300 01  WS-RESPONSE-SENT-FLAG           PIC X.
TB0099 01  WA-BORM-DUE-AMT                 PIC S9(14).
S17003 01  SV-BORM-DUE-AMT                 PIC S9(14)  VALUE 0.
TB0099 01  WA-TMP-LST-TERM-PAID                PIC S9(6) COMP.
TB0099 01  WA-BOIS-LST-ADV-DTE             PIC S9(9) BINARY.
TB0099 01  WA-DUE-DAYS-TMP2                PIC 9(3)V9(6).
TB0099 01  WA-DUE-DAYS                     PIC 9(3)V9(6).
TB0099 01  WA-INT-RATE-TMP                 PIC S9(3)V9(4).
TB0099 01  WA-DUE-DAYS-P                   PIC V999.
TB0099 01  WA-DUE-DAYS-R                   PIC V99.
TB0099 01  WA-DUE-DAYS-TMP                 PIC 9(3)V9(6).
TB0099 01  WA-DUE-DAYS-TMP1                PIC 9(3)V9(6).
TB0099 01  WA-REM-TERM-TMP                 PIC S9(5) COMP.
TB0099 01  WA-TMP-REM-REPAYS               PIC S9(5) COMP.
TB0091 01  WA-TMP-REM-REPAYS-D             PIC S9(5) COMP.
TB0099 01  WA-REM-REPAYS-TMP               PIC S9(5) COMP.
TB0099 01  WA-PAID-TERM-CORR               PIC 9(5).
TB0099 01  WA-REM-TERM-CORR                PIC S9(5) COMP.
TB0099 01  WA-REPAY-AMT-TMP-CORR           PIC S9(14)V999.
TB0099 01  WA-REPAY-AMT-TMP1-CORR          PIC S9(14).
TB0099 01  WA-NEXT-TERM-CORR               PIC S9(6) COMP.
TB0099 01  WA-PAID-TERM                    PIC 9(5).
TB0099 01  WA-REM-TERM                     PIC S9(5) COMP.
TB0099 01  WA-NEXT-TERM                    PIC S9(6) COMP.
SC1518 01  WA-LAST-TERM                    PIC 9(5) VALUE 0.
S18413 01  WA-UNPAID-TERM                  PIC 9(5)  COMP.
TB0099 01  WA-NEXT-TERM-NUM                PIC 9(6).
TB0099 01  WA-TERM-NUM-R REDEFINES WA-NEXT-TERM-NUM.
TB0099     05 FILLER                       PIC 9(4).
TB0099     05 WA-TERM-R1                   PIC 9(2).
TB0099 01  WA-DUE-AMT                      PIC S9(14)V999 COMP.
TB0099 01  WA-DUE-AMT-TEMP                 PIC S9(14)V999 COMP.
TB0099 01  WA-PRINCIPAL-DUE                PIC S9(14)V999 COMP.
TB0099 01  WA-LOAN-BAL                     PIC S9(14)V999 COMP.
TB0099 01  WA-LOAN-BAL-TMP                 PIC S9(14)V999 COMP.
TB0099 01  WA-LOAN-REPAY                   PIC S9(14)V999 COMP.
TB0099 01  WA-REPAY-AMT-TMP                PIC S9(14)V999.
TB0099 01  WA-REPAY-AMT-TMP1               PIC S9(14).
TB0099 01  WA-TMP-TXN-DTE                  PIC S9(9) BINARY.
TB0099 01  WA-TMP-NXT-DUE-DTE              PIC S9(9) BINARY.
CIR541 01  WA-TMP-DAYS                     PIC S9(5) COMP.
S10736 01  WA-PRN-DAYS                     PIC S9(5) COMP.  
S10736 01  WA-PRN-NXT-DUE-DTE              PIC S9(9) BINARY.
S12060 01  WA-BRHM-BSB.
S12060     02 WA-BRHM-OPEN-FLAG            PIC X(1).
S16564*S12060        88 WA-BRHM-OPEN-OK           VALUE '2'.
S16564        88 WA-BRHM-OPEN-OK           VALUE "1" "2".
S12060     02 WA-BRHM-BSB-FILLER           PIC X(9).
TB0099 01  WA-TMP-LST-ADV-PYMT-DTE.
TB0099     02 WA-TMP-LST-ADV-PYMT-DTE-DD   PIC 99.
TB0099     02 WA-TMP-LST-ADV-PYMT-DTE-MM   PIC 99.
TB0099     02 WA-TMP-LST-ADV-PYMT-DTE-CC   PIC 99.
TB0099     02 WA-TMP-LST-ADV-PYMT-DTE-YY   PIC 99.
TB0099 01  WA-TMP-LST-ADV-PYMT-DTE1        PIC S9(9) BINARY.
TB0099 01  WA-TMP-POST-DTE.
TB0099     02 WA-TMP-POST-DTE-DD           PIC 99.
TB0099     02 WA-TMP-POST-DTE-MM           PIC 99.
TB0099     02 WA-TMP-POST-DTE-CC           PIC 99.
TB0099     02 WA-TMP-POST-DTE-YY           PIC 99.
TB0091 01  WA-TMP-PREV-DUE-DTE.
TB0091     02 WA-TMP-PREV-DTE-DD           PIC 99.
TB0091     02 WA-TMP-PREV-DTE-MM           PIC 99.
TB0091     02 WA-TMP-PREV-DTE-CC           PIC 99.
TB0091     02 WA-TMP-PREV-DTE-YY           PIC 99.
TB0091 01  WA-TMP-PREV-DUE-DTE1            PIC S9(9) BINARY.
TB0099 01  WA-TMP-POST-DTE1                PIC S9(9) BINARY.
TB0099 01  WA-PREV-DUE-DTE                 PIC S9(9) BINARY.
TB0099 01  WA-NEXT-DUE-DTE                 PIC S9(9) BINARY.
SC1794 01  WA-RECALC-IND                   PIC 9 VALUE 0.
SC2159 01  WA-BUCV-WORK-AREA.
SC2159     03  WA-BUCV-TERM-NO             PIC 9(4) VALUE 0.
SC2159     03  FILLER                      PIC 9.
SC2159         88 WA-SEARCH-BUCV-START     VALUE 0.
SC2159         88 WA-SEARCH-BUCV-END       VALUE 1.
SC2159         88 WA-SEARCH-BUCV-FOUND     VALUE 2.
012310 01  XREF-RECORD-AREA.
012320     COPY XREFMAST IN LIBRYMIS.
012330*
012340     COPY XREFALT  IN LIBRYMIS.
012350*
012360 01  WS-EXTN-REF-NUM                     PIC X.
012370 01  WS-INTN-REF-NUM                     PIC X.
012380 01  WA-COUNTER                          PIC 9(2).
012390 01  WA-LIMIT1                           PIC 9(2).
012400 01  WA-LIMIT2                           PIC 9(2).
NLB205 01  WA-SET-UT0296-CALL-2                PIC X.
012420*
012430 01  WS-INTN-REF-NO                      PIC X(25).
012440 01  WS-INTN-REF-NO-R1 REDEFINES WS-INTN-REF-NO.
012450   03 WS-INTN-REF-NO-CHAR                PIC X OCCURS 25.
012460*
012470 01  WS-EXTN-REF-NO                      PIC X(25).
012480 01  WS-EXTN-REF-NO-R REDEFINES WS-EXTN-REF-NO.
012490   03 FILLER                             PIC X(8).
012500   03 WS-EXTN-REF-NO-NUM                 PIC 9(17).
012510 01  WS-EXTN-REF-NO-R1 REDEFINES WS-EXTN-REF-NO.
012520   03 WS-EXTN-REF-NO-CHAR                PIC X OCCURS 25.
012530*
012540/
012550 01  W-PROGRAM-NAME                      PIC X(6) VALUE "BR0000".
012560 01  WA-GL-TRANSACTION-FLAG              PIC X VALUE "N".
012570 01  WA-ACT-BAL-BEF-TXN               PIC S9(14)V999 COMP VALUE 0.      
TB0152 01  WA-UT28-SAVE-AREA.
TB0152     03  WA-SAV-STRT-AREA-TRN-NO         PIC 9(6).
B19902*TB0152     03  WA-SAV-STRT-AREA-DATA           PIC X(150).
B19902     03  WA-SAV-STRT-AREA-DATA           PIC X(200).
TB0152     03  WA-SAV-BORM-RECORD-AREA         PIC X(983).
TB0152     03  WA-SAV-GLDM-RECORD-AREA         PIC X(983).
TB0152     03  WA-SAV-LINK-AREA                PIC X(110).
TB0152     03  WA-SAV-EDIT-MASK                PIC X(32).
TB0152     03  WA-SAV-DUMMY-TRN-NO             PIC 9(6).
TB0152     03  WA-SAV-INPUT-MSG.
TB0152         05  WA-SAV-IN-ACCT-NO           PIC 9(16).
TB0152         05  WA-SAV-IN-AMOUNT            PIC S9(14)V999
TB0152                                         TRAILING SEPARATE.
TB0152         05  FILLER                      PIC X(03).
TB0152         05  WA-SAV-IN-PROMO-NO          PIC XX.
TB0152         05  WA-SAV-IN-TRN-DATE          PIC 9(8).
TB0152         05  FILLER                      PIC X(17).
TB0152         05  WA-SAV-IN-TRF-ACCT-NO       PIC 9(16).
TB0152         05  FILLER                      PIC X(153).
TB0152         05  WA-SAV-IN-TRACER-NO         PIC 9(6).
TB0152         05  FILLER                      PIC X(58).
TB0152         05  WA-SAV-IN-TAX-CODE          PIC X.
TB0152         05  WA-SAV-IN-SYSTEM            PIC X(3).
TB0152         05  WA-SAV-IN-EXP-TYPE          PIC 9(3).
TB0152         05  WA-SAV-IN-PAYEE-ID          PIC S9(16)
TB0152                                         TRAILING SEPARATE.
TB0152         05  FILLER                      PIC X(284).
TB0152         05  WA-SAV-IN-NARRATIVE         PIC X(50).
TB0152         05  FILLER                      PIC X(327).
TB0152     03  WA-TMP-DATE.
TB0152         05  WA-TMP-DD                   PIC 99.
TB0152         05  WA-TMP-MM                   PIC 99.
TB0152         05  WA-TMP-CC                   PIC 99.
TB0152         05  WA-TMP-YY                   PIC 99.
TB0152     03  WA-TMP-ERR-MSG-NO               PIC 9(4).
TB0152 01  WA-UT28-PARAM.
TB0152     COPY UT28PARM IN LIBRYCHG.
SC3840 01  DUMMY-CTAP-RECORD.
SC3840     COPY CTAPMAST IN LIBRYCTA.
012590*------------------------- ANZ023 ----------------------------
012600*
012610* FOLLOWING VARIABLES INCLUDED FOR GLCC PROCESSING.
012620*
012630     COPY GLCCWORK IN LIBRYMIS.
012640*
012650     COPY UT0099CA IN LIBRYMIS.
012660*
012670 01  WA-GLCC-VARS.
012680     05  WA-ACCT-BAL-BEF-TXN       PIC S9(14)V999 COMP VALUE 0.
012690     05  WA-GLCC-XFER-AMOUNT       PIC S9(14)V999 COMP VALUE 0.
012700     05  WA-SIGNED-TXN-AMOUNT      PIC S9(14)V999 COMP VALUE 0.
012710     05  WA-SOUR-GL-CLASS-CODE     PIC X(25) VALUE SPACES.
012720     05  WA-DEST-GL-CLASS-CODE     PIC X(25) VALUE SPACES.
SC3491     05  WA-GL-CLASS-CODE-S        PIC X(25) VALUE SPACES.
SC3491     05  WA-GL-CLASS-CODE-D        PIC X(25) VALUE SPACES.
SC3491     05  WA-SAVE-GL-CLASS-CODE     PIC X(25) VALUE SPACES.
012730     05  WA-SAVE-COMPONENT-1       PIC 9(17) VALUE ZEROES.
012740     05  WA-SAVE-COMPONENT-2       PIC 9(17) VALUE ZEROES.
012750     05  WA-SAVE-CUST-SEGMENT      PIC 9(10) VALUE ZEROES.
012760     05  WA-17046-BRANCH-CHANGE    PIC X     VALUE "N".
012770 01  WA-SAVE-UT0296CA-AREA.
012780     COPY UT0296SS IN LIBRYMIS.
012790*
012800 01  UT0120CA-CALL-AREA.
012810     COPY UT0120CA IN LIBRYMIS.
012820*
012830 01  WA-SAVE-TRN-NO                      PIC 9(6).
TB0099 01  WA-TMP-SAVE-TRN-NO                  PIC 9(6).
B19902*012840  01  WA-SAVE-EDIT-MASK                   PIC X(54).
B19902 01  WA-SAVE-EDIT-MASK                   PIC X(74).
012850*-------------------- ANZ023 --------------------------------
012860 01  WA-UNCL-BAL-BEF-TXN           PIC S9(14)V999 COMP VALUE 0.
012870 01  WA-UNCL-BAL-AFT-TXN           PIC S9(14)V999 COMP VALUE 0.
012880 01  WA-ACCT-BAL-AFT-TXN           PIC S9(14)V999 COMP VALUE 0.
012890 01  WA-ACCT-BAL-DIFF              PIC S9(14)V999 COMP VALUE 0.
012900 01  WA-UNCL-BAL-DIFF              PIC S9(14)V999 COMP VALUE 0.
012910 01  WA-ACCT-UNCL-DIFF             PIC S9(14)V999 COMP VALUE 0.
012920 01  WA-FACI-UPDT-AMT              PIC S9(14)V999 COMP VALUE 0.
012930 01  WA-NO-FACILITY-FLAG           PIC X.
012950 01  WA-HOME-BR                          PIC X VALUE "N".
012960 01  WA-STORE-HME-BRH                    PIC 9(4).
SC6274 01  WA-GLDM-LEDGER-NAME                 PIC X(20) VALUE SPACE.       
SC2302 01  WA-GLDM-BRANCH                      PIC 9(4) VALUE 0.
SC2302 01  WA-POST-TO-GL-FLAG                  PIC X VALUE SPACE.
SC2302     88  WA-POST-TO-GL                   VALUE "Y".
012970 01  WA-TABLE                    PIC X(32) VALUE LOW-VALUES.
012980 01  FILLER REDEFINES WA-TABLE.
012990     05  WA-TABLE-ENTRY OCCURS 32 TIMES PIC 9.
013000 01  WA-TR-STATE                         PIC X(3) VALUE SPACES.
013010 01  WA-HM-STATE                         PIC X(3) VALUE SPACES.
013020 01  WA-STORE-SAVE-REFER                 PIC X(4).
TB0069 01  WA-REFER-X.
TB0069     05  WA-REFER-COMP                   PIC 9(9) COMP.
013030 01  WA-DUP-COUNT                        PIC 99 COMP VALUE 0.
013040 01  WA-STORE-REFER-AREA                 PIC S9(4) COMP.
013050*01  WA-DISPLAY-NUMBER1                  PIC 9(17).               TB0267
013050 01  WA-DISPLAY-NUMBER1                  PIC 9(18).
013060 01  WA-DISPLAY-NUMBER2                  PIC 9(17).
013070 01  WA-CALL-UT0460-FLAG                 PIC 9     VALUE 0.
013080 01  WA-DELAY-1SECS                      PIC S9(15) BINARY
013090                                         VALUE 100.
013100 01  WA-X710-STORE-BAL                   PIC S9(14)V999 COMP.
013110 01  WA-TOTAL-REPAY                      PIC S9(14)V999 COMP.
013120 01  WA-FOUND-IND                          PIC X.
013130  88 FOUND-NEW-RATE                        VALUE "Y".
013140  88 NEW-RATE-NOT-FOUND                    VALUE "N".
013150  88 NEW-RATE-IN-PROGRESS                  VALUE "P".
013160 01  WA-NEW-RATE-FOUND                     PIC X VALUE "Y".
013170 01  WA-NEW-RATE-NOT-FOUND                 PIC X VALUE "N".
013180 01  WA-IN-PROGRESS                        PIC X VALUE "P".
013190 01  WA-CAFM-TYPE                          PIC X.
013200  88 CAP-IN-FORCE                          VALUE "1" "3".
013210  88 FLOOR-IN-FORCE                        VALUE "2" "3".
013220  88 NO-CAP-OR-COLLARS                     VALUE "0".
013230  88 FIXED-IN-FORCE                        VALUE "4".
013240  88 CAP-COLLARS-ALLOWED                   VALUE "5".
S16466  88 CAP-COLLARS-FLEXIBLE                  VALUE "6".
013250 01  WA-BSHR-INT-ACCR                   PIC S9(12)V9(5) COMP.
013260 01  WA-BSHR-CAP-VAL                    PIC S9(14)V9(3) COMP.
013270 01  WA-TOTAL-CHRG                      PIC S9(14)V999 COMP.
TB0016**--
       01  WA-FAC-NO-16                       PIC 9(16) VALUE ZEROES.
       01  WA-FLAGS.
           05  WA-RCNF-RELM                   PIC X(01) VALUE SPACES.
           05  WA-GTE-TO-LON-CTR              PIC 9(09) VALUE ZEROES.
S16618 01  WA-FUND-GUAR                       PIC X(01) VALUE SPACES.
TB0016**--
TB0082**--
TB0082 01  WA-SAVE-STAMPED-AMT                PIC S9(14)V999.
TB0082 01  WA-FOUND-SW                        PIC X(01) VALUE SPACES.
       01  WA-REAL-DATE                       PIC S9(9) BINARY.
       01  WA-ADVANCE-AMOUNT                  PIC S9(14)V999
                                                  TRAILING SEPARATE.
TB0082**--
013280 01  WA-COMMISSION-PASSALONG.
013290     03  WA-BAL-BEFORE-COMMISSION        PIC S9(14)V999
013300                                              TRAILING SEPARATE.
013310     03  WA-COMMISSION-AMOUNT            PIC S9(14)V999
013320                                              TRAILING SEPARATE.
013330     03  WA-COMM-CORR-AMOUNT             PIC S9(14)V999
013340                                             TRAILING SEPARATE.
013350     03  WA-BORM-INS-PREMIUM             PIC S9(14)V999 COMP.
013360     03  WA-BORM-LOAN-BAL-EX-PPP         PIC S9(14)V999 COMP.
013370     03  WA-PPP-PREM-TXN-CODE            PIC 9(6).
013380     03  WA-PPP-EDIT-MASK-1-2.
013390         05  WA-PPP-EDIT-MASK-1          PIC X(34).
B19902*013400         05  WA-PPP-EDIT-MASK-2          PIC X(20).
B19902         05  WA-PPP-EDIT-MASK-2          PIC X(40).
013410     03  WA-PPP-LEDGER-CODE              PIC 99.
013420     03  WA-PPP-PREM-SUB-LEDG            PIC 99.
013430 01  BR0025-CALL-AREA.
013440     03  BR0025CA-INT-RATE               PIC 99V9999.
013450     03  BR0025CA-INT-DUE-DT             PIC S9(9) BINARY.
013460     03  BR0025CA-AMT-1.
013470         05  BR0025CA-UNEARNT-INT-REBATE PIC S9(14)V999.
013480         05  WA-STORE-LOAN-BAL-1         PIC S9(14)V999.
013490         05  WA-STORE-ARREARS-1          PIC S9(14)V999.
013500     03  BR0025CA-AMT-2.
013510         05  BR0025CA-ACCRUED-INT        PIC S9(14)V999.
013520         05  WA-STORE-LOAN-BAL-2         PIC S9(14)V999.
013530         05  WA-STORE-ARREARS-2          PIC S9(14)V999.
013540     03  BR0025CA-AMT-2A.                                                
013550         05  BR0025CA-ACCRUED-INT-2A     PIC S9(14)V999 VALUE 0.         
SC4881         05  BR0025CA-AGR-INT REDEFINES                 
SC4881             BR0025CA-ACCRUED-INT-2A     PIC S9(14)V999.
013560         05  WA-STORE-LOAN-BAL-2A        PIC S9(14)V999 VALUE 0.         
013570         05  WA-STORE-ARREARS-2A         PIC S9(14)V999 VALUE 0.         
013580     03  BR0025CA-AMT-3.
013590         05  BR0025CA-IR-SUBSIDY         PIC S9(14)V999.
013600         05  WA-STORE-LOAN-BAL-3         PIC S9(14)V999.
013610         05  WA-STORE-ARREARS-3          PIC S9(14)V999.
013620     03  BR0025CA-AMT-4.
013630         05  BR0025CA-ARREARS-PENALTY    PIC S9(14)V999.
SC4881         05  BR0025CA-AGR-ARR REDEFINES                 
SC4881             BR0025CA-ARREARS-PENALTY    PIC S9(14)V999.
013640         05  WA-STORE-LOAN-BAL-4         PIC S9(14)V999.
013650         05  WA-STORE-ARREARS-4          PIC S9(14)V999.
013660     03  BR0025CA-AMT-5.
013670         05  BR0025CA-ACCRUED-FEE        PIC S9(14)V999.
013680         05  WA-STORE-LOAN-BAL-5         PIC S9(14)V999.
013690         05  WA-STORE-ARREARS-5          PIC S9(14)V999.
013700     03  BR0025CA-AMT-6.
013710         05  BR0025CA-MISC-DEBIT         PIC S9(14)V999.
013720         05  WA-STORE-LOAN-BAL-6         PIC S9(14)V999.
013730         05  WA-STORE-ARREARS-6          PIC S9(14)V999.
013740     03  BR0025CA-AMT-7.
013750         05  BR0025CA-SHARE-CAP-VAL      PIC S9(14)V999.
013760         05  WA-STORE-LOAN-BAL-7         PIC S9(14)V999.
013770         05  WA-STORE-ARREARS-7          PIC S9(14)V999.
013780     03  BR0025CA-AMT-8.
013790         05  BR0025CA-SHARE-INT-REFUND   PIC S9(14)V999.
013800         05  WA-STORE-LOAN-BAL-8         PIC S9(14)V999.
013810         05  WA-STORE-ARREARS-8          PIC S9(14)V999.
013820     03  BR0025CA-AMT-9.
013830         05  BR0025CA-DISCH-PENALTY      PIC S9(14)V999.
013840         05  WA-STORE-LOAN-BAL-9         PIC S9(14)V999.
013850         05  WA-STORE-ARREARS-9          PIC S9(14)V999.
013860     03  BR0025CA-AMT-10.
013870         05  BR0025CA-DISCH-TAX          PIC S9(14)V999.
013880         05  WA-STORE-LOAN-BAL-10        PIC S9(14)V999.
013890         05  WA-STORE-ARREARS-10         PIC S9(14)V999.
013900     03  BR0025CA-AMT-11.
013910         05  BR0025CA-TOM-INFL-AMT       PIC S9(12)V9(5) VALUE 0.
013920         05  WA-STORE-LOAN-BAL-11        PIC S9(14)V999 VALUE 0.
013930         05  WA-STORE-ARREARS-11         PIC S9(14)V999 VALUE 0.
013940     03  BR0025CA-AMT-11A.
013950         05  BR0025CA-TOM-INFL-AMT-11A   PIC S9(12)V9(5) VALUE 0.        
013960         05  WA-STORE-LOAN-BAL-11A       PIC S9(14)V999 VALUE 0.         
013970         05  WA-STORE-ARREARS-11A        PIC S9(14)V999 VALUE 0.         
013980     03  BR0025CA-FCC-PRNC-ADJ-12.                                       
013990         05  BR0025CA-FCC-PRNC-ADJ       PIC S9(12)V9(5) VALUE 0.        
014000         05  WA-STORE-LOAN-BAL-12        PIC S9(14)V999 VALUE 0.         
014010         05  WA-STORE-ARREARS-12         PIC S9(14)V999 VALUE 0.         
014020     03  BR0025CA-CGL-INT-ACCR           PIC S9(14)V999 VALUE 0.
014030     03  BR0025CA-AMT-LAST.
014040         05  BR0025CA-DISCH-AMOUNT       PIC S9(14)V999.
014050/
014060 01  WA-WORK-AREA-BACKDATED.
014070     03 WA-MARG-INT-ACCR-BEFORE          PIC S9(14)V999.
014080     03 WA-MARG-INT-ACCR-AFTER           PIC S9(14)V999.
014090     03 WA-BASE-INT-ACCR-BEFORE          PIC S9(14)V999.
014100     03 WA-BASE-INT-ACCR-AFTER           PIC S9(14)V999.
014110 01  WA-MISC-WRK-AREA.
014120     02  WA-COMM-TEMP-DD                 PIC 99.
014130     02  WA-REBT-DD                      PIC 99.
014140     02  WA-POST-2ND-PASS-IND            PIC 9   VALUE 0.
014150         88  WA-POST-1ST-PASS                    VALUE 0.
014160         88  WA-POST-2ND-PASS                    VALUE 1.
014170/
014180 01  WA-IN0014-CALL-CODE                 PIC 99.
014190 01  WA-ORIG-JRNL-NO                     PIC 9(6) COMP.
014200 01  WA-ORIG-TXN-EVT                     PIC 9(6) COMP.
014210 01  WA-ORIG-POST-DATE                   PIC S9(9) BINARY.
014220 01  WA-ORIG-POST-TIME                   PIC S9(9) COMP.
014230 01  WA-ORIG-POST-SEQ                    PIC X(1).
014240 01  WS-UT0500-SAVE-INST-NO              PIC 9(3) VALUE ZEROES.
014250 01  WS-UT0500-SAVE-CUSM-NO              PIC 9(16) VALUE ZEROES.
014260/
014270 01  WA-JRNL-CALL-AREA.
014280     COPY JNRST IN LIBRYMIS.
014290/
014300 01  SY0010CA-COMMON-AREA.
014310     COPY SY0010CA IN LIBRYMIS.
014320/
014330 01  WA-GLD-CODE.
014340     COPY GLDCODES IN LIBRYBOR.
014350/
014360 01  UT0290CA-CALL-AREA.
014370     COPY UT0290CA IN LIBRYMIS.
014380/
014390 01  UT0298CA-CALL-AREA.
014400     COPY UT0298CA IN LIBRYMIS.
014410/
014420*
014430 01  UT0310CA-REC.
014440     COPY UT0310CA IN LIBRYMIS.
TB0095
TB0095 01  UT0072CA-CALL-AREA.
TB0095     COPY UT0072CA IN LIBRYBOR.
S16503
S16503 01  UT0145CA-CALL-AREA.
S16503     COPY UT0145CA IN LIBRYMIS.
014450/
014460*
014470*01  UT0330CA-CALL-PARAM.
014480*    COPY UT0330CA IN LIBRYMIS.
014490/
014500 01  UT0296-CALL-AREA.
014510     COPY UT0296CA IN LIBRYMIS.
014520/
014530 01  EPIP-RECORD-AREA.
014540     COPY EPIPMAST IN LIBRYMIS.
014560     COPY UTEPIPCA IN LIBRYMIS.
014580     COPY UTOLRRCA IN LIBRYMIS.
014600 01  UT0730-CALL-AREA.
014610     COPY UT0730CA IN LIBRYMIS.
014630 01  UTBRHMCA-CALL-AREA.
014640     COPY UTBRHMCA IN LIBRYMIS.
014660 01  UTBRHMRA-CALL-AREA.
014670     COPY UTBRHMRA IN LIBRYMIS
014680          REPLACING ==(UTBRHMRA)== BY ==UTBRHMRA==.
014700 01  WA-ACCESS-EPIP                            PIC X.
014710 01  WA-OLRR-FLAG                              PIC X.
014720 01  WA-OLRR-ERROR                             PIC X.
014730 01  WA-TELLER-ERROR-CTR                       PIC 99.
014740 01  WA-ERROR-OVERRIDE.
014750     03  WA-POSTING-INSTRUCTION                PIC X.
014760     03  WA-REFER-FLAG                         PIC X.
014780 01  UT0460-CALL-AREA.
014790     COPY UT0460CA IN LIBRYMIS.
014800*
014810/
014820 01  WA-WORK-SYSTEM.
014830     03  WA-WORK-SYSTEM-ID              PIC X.
014840     03  WA-WORK-SECTION-ID             PIC XX.
014860 01  UT0017-CALL-AREA.
014870     COPY UT0017CA IN LIBRYMIS.
014880*
014890 01  WA-UT0017-KEY.                                                      
014900     03  FILLER                 PIC XX VALUE "BR".                       
014910     03  WA-UT0017-REPLICA      PIC 99.                                  
CHRIS      03  FILLER                 PIC X(4032).                             
014930*
014940 01  UT0200-CALL-AREA.                                                   
014950     COPY UT0200CA IN LIBRYINV.                                          
SC0367     COPY DEPPARM IN LIBRYINV.
SC0367     COPY UT0200RT IN LIBRYINV.
014960*
014970 01  UT0251CA-CALL-AREA.                                                 
014980     COPY UT0251CA IN LIBRYMIS.                                          
014990*
015000     COPY UT0270CA IN LIBRYMIS.
015010/
015020*  *** PARAMETERS FOR CALLING LANGUAGE MASTER
015030*
015040 01  LNGM-KEY-AREA.
015050     03  WA-INST-NO                       PIC 999.
015060     03  WA-LANGUAGE-CODE                 PIC 99.
015070*
015080 01  LNGM-AREA.
015090     COPY LNGMMAST IN LIBRYMIS.
015100/
015110 01  TXTM-LOAD-FLAG                     PIC 9 VALUE 0.
015120*
015130 01  TXTM-DATA.
015140     03  TXTM-INST-TABLE         OCCURS 2 INDEXED BY TXT-1.
015150         05  TXTM-INST                  PIC 999.
015160         05  TXTM-LANG-TABLE     OCCURS 2 INDEXED BY TXT-2.
015170             07  TXTM-LANG              PIC 99.
015180             07  TXTM-DATA-TABLE.
015190                 09  TXTM-LINE          PIC X(40)
015200                                 OCCURS 4 INDEXED BY TXT-3.
015210             07  TXTM-DATA-FIELDS REDEFINES TXTM-DATA-TABLE.
015220                 09  WA-NAMEIS          PIC X(40).
015230                 09  WA-CHARGE-ERR      PIC X(40).
015240                 09  WA-CHARGE-GT30     PIC X(40).
015250                 09  WA-EXCEEDS-WDL.
015260                     11  FILLER         PIC X(29).
015270                     11  WA-EXCEED-BY   PIC Z(10)9.
015280 01  WA-TXN-AMT                         PIC S9(14)V999 COMP.
015290/
015300************************************************
015310*  LETTERS BY CORRESPONDANCE AREAS
015320*************************************************
015330 01  CP0010CA-PARAM.
015340     COPY CP0010CA IN LIBRYMIS.
015350 01  CP0010-RECORD-AREA-ONE PIC X(983).
015360 01  WA-INVM-AREA REDEFINES CP0010-RECORD-AREA-ONE.
015370     02  WA-INVM-DATA       PIC X(983).
015380 01  WA-LIMM-AREA REDEFINES CP0010-RECORD-AREA-ONE.
015390         COPY LIMMMAST IN LIBRYMIS.
015400     03  FILLER                      PIC X(422).
015410 01  CP0010-RECORD-AREA-TWO          PIC X(3128).
015420 01  WA-CPLIM01-AREA REDEFINES CP0010-RECORD-AREA-TWO.
015430         COPY CPLIM01 IN LIBRYMIS.
015440 01  WA-BORM-AREA REDEFINES CP0010-RECORD-AREA-TWO.
015450     02  WA-BORM-DATA       PIC X(983).
015460     02  WA-BR0025CA-DATA   PIC X(740).                                  
015470     02  WA-COFL-DATA       PIC X(500).                                  
015480     02  FILLER             PIC X(905).                                  
015490*    02  FILLER             PIC X(1405).                                 
015500 01  CP0010-RECORD-AREA-THREE        PIC X(200).
015510 01  CP0010-TRN-AREA REDEFINES CP0010-RECORD-AREA-THREE.
015520         COPY CPTRN01 IN LIBRYMIS.
015530/
015540************************************************
015550*  CHARGES SYSTEM WORK AREAS
015560*************************************************
015570 01  WA-GEN-CHR-AREAS.
015580     03  WA-GEN-CHR-AREA OCCURS 3 INDEXED BY WAGCRIDX1.
015590         05  FILLER                      PIC X(603).
015600*
015610 01  WA-TOTAL-CHR-CNT                    PIC 9(4) COMP.
015620 01  WA-TOT-HOW-APPLY-3                  PIC S9(9)V99 COMP.
015630 01  WA-STORE-CALC-FEE                   PIC S9(14)V999 COMP.
015650 01  WA-STORE-EDIT-MASK-13000.
015660     03  FILLER                          PIC X(32).
B19902     03  WA-STORE-FEE-MASK-13000         PIC X(40).
B19902*015670     03  WA-STORE-FEE-MASK-13000         PIC X(20).
015690 01  WA-STORE-INPUT-EDIT-MASK.
015700     03  FILLER                          PIC X(28).
015710     03  WA-STORE-INPUT-BITS             PIC X(4).
B19902     03  WA-STORE-INPUT-FEE-MASK         PIC X(40).
B19902*015720     03  WA-STORE-INPUT-FEE-MASK         PIC X(20).
015730*
015740 01  WA-CS0000RA-STATUS                  PIC 99 VALUE 0.
015750 01  WA-CS0090RA-STATUS                  PIC 99 VALUE 0.
015760*******************************************************
015770*  CALL AREAS FOR CHARGES SYSTEM
015780*******************************************************
015790 01  WA-CS0000CA-CALL-AREA.
015800     COPY CS0000CA IN LIBRYCHG.
015810*
015820 01  WA-CS0000RA-RETURN-AREA.
015830     COPY CS0000RA IN LIBRYCHG.
015840*
015850 01  WA-TSB0384-WORK-AREAS.
015860     03  WA-SAVE-CS0000RA-CHRG           PIC X(2530).
015870     03  WA-SAVE-CS0000RA-DIRT           PIC X(2530).
015880     03  WA-COMP-CHRG-IND                PIC X.
015890         88  WA-COMP-CHRG                VALUE "Y".
015900     03  WA-COMP-DIRT-IND                PIC X.
015910         88  WA-COMP-DIRT                VALUE "Y".
015920     03  WA-SAVE-BORM-CHARGES.
015930         05  FILLER OCCURS 10.
015940             07  FILLER                  PIC S9(5) COMP.
015950             07  FILLER                  PIC S9(14)V999 COMP.
015960     03  WA-CLOSED-DR-CR-AMT             PIC S9(14)V999 COMP.
015970*
015980 01  WA-CS0007CA-CALL-AREA.
015990     COPY CS0007CA IN LIBRYCHG.
016000*
016010 01  WA-CS0007RA-RETURN-AREA.
016020     COPY CS0007RA IN LIBRYCHG.
016030*
016040 01  WA-CS0090CA-CALL-AREA.
016050     COPY CS0090CA IN LIBRYCHG.
TB0125
TB0125 01  WA-CS0012CA-CALL-AREA.
TB0125     COPY CS0012CA IN LIBRYCHG.
TB0125*
TB0125 01  WA-CS0012RA-RETURN-AREA.
TB0125     COPY CS0012RA IN LIBRYCHG.
TB0125*
TB0125 01  WS-CSCP-REC.
TB0125     COPY CSCPMAST  IN LIBRYCHG.
TB0125*
TB0125     COPY CSCPALT   IN LIBRYCHG.
016060/
NR2001*016070 01  BORV-RECORD-AREA.
NR2001*016080     COPY BORVVARV IN LIBRYBOR.
016090*NR0001 01  BORV-RECORD-AREA-2                  PIC X(65).
016100*NR0001 01  BORV-RECORD-AREA-3                  PIC X(65).
016110*NR0001 01  BORV-RECORD-AREA-4                  PIC X(65).
016120*NR0001 01  BORV-RECORD-AREA-5                  PIC X(65).
016130*NR0001 01  BORV-RECORD-AREA-6                  PIC X(65).
016140*NR0001 01  BORV-RECORD-AREA-7                  PIC X(65).
016150*NR0001 01  BORV-RECORD-AREA-8                  PIC X(65).
016160*NR0001 01  BORV-RECORD-AREA-9                  PIC X(65).
NR2001 01  UTBOCTCA-CALL-AREA.
NR2001     COPY UTBOCTCA IN LIBRYBOR
NR2001          REPLACING ==(UTBOCTCA)== BY ==UTBOCTCA==.
NR2001 01  BOCT-RECORD-AREA.
NR2001     COPY BOCTVARV IN LIBRYBOR
NR2001          REPLACING ==(BOCT)== BY ==BOCT==.
NR2001 01  WS-BOCT-TRAN-TYPE                          PIC 9(2).
TB0198 
TB0198 01  WA-AGREE-INSTALL-VARS.
TB0198     05  WA-REPAY-NN-FOUND-FLAG          PIC X VALUE "N".
TB0198         88  WA-REPAY-NN-FOUND           VALUE "Y".
TB0198     05  WA-AGR-TRANSFER-FLAG            PIC X VALUE " ".
TB0198     05  WA-AGREE-REPAY-DT-BIN           PIC S9(9) BINARY.
TB0198     05  WA-AGREE-START-DT-BIN           PIC S9(9) BINARY.
TB0198     05  WA-AGREE-END-DT-BIN             PIC S9(9) BINARY.
TB0198     05  WA-AGREE-END-DT                 PIC 9(8).
TB0198     05  WA-AGR-SUB                      PIC 99 VALUE 0.
TB0223     05  WA-JR01-TRAN-DATE               PIC S9(9) BINARY.
SC3429     05 WA-BLDVNN-SUB                    PIC 99 VALUE ZERO.  
SC3429     05 WA-AGR-REPAY                     PIC S9(14)v999 COMP.
SC3429     05  WA-START-DATE-BIN               PIC S9(9) BINARY.   
SC3429     05 WA-BLDVNN-FOUND                  PIC X VALUE SPACES. 
TB0198
TB0232 01  WA-BACKDATED-VARS.
TB0232     03  WA-BACKDATED-FLAG             PIC X VALUE SPACE.
TB0232     03  WA-BACK-ADJ-SUB               PIC 9(3) VALUE ZEROES.
TB0232     03  WA-BACK-ADJ-AMT               PIC S9(14)V999 COMP.
TB0232     03  WA-LOC-END-FLAG               PIC X VALUE SPACES.
TB0232         88 WA-LOC-END                 VALUE "Y".
SC2192     03  WA-LOADED-ALL                 PIC X VALUE SPACES.
SC2192     03  WA-SAVE-ADV-DATE-BIN          PIC S9(9) BINARY.
SC3569     03  WA-SAVE-INT-ACCR              PIC S9(12)v9(5) BINARY.
TB0232
SC3865 01  WA-UPDATE-INT-INCR                PIC X VALUE SPACES.
SC4430 01  WA-INT-RATE-A-NEG                 PIC S99V9999.
SC3865 01  WA-SAVE-INT-RATE                  PIC S999V9999 COMP.
SC3158 01  wA-PREV-BOIS-GRACE-PERIOD         PIC 9(4) VALUE 0.
SC8046 01  WA-SV-REM-REPAYS                  PIC S9(5) COMP.
SC5098 01  WA-BACK-LOADED-RATE               PIC X VALUE SPACES.
TB0232/
SC1543 01  WA-UTHIST-VALIDATIONS.
SC1543     03 WA-PRIORITIZED-FLAG              PIC X VALUE SPACES.
SC1543        88 WA-PRIORITIZED                VALUE "Y".
SC1543     03 WA-UTHIST-SUB                    PIC 99 VALUE ZEROES.
SC1543     03 WA-BOIS-SUB                      PIC 99 VALUE ZEROES.
SC1543     03 WA-BUCKET-CDE                    PIC XX VALUE SPACES.
SC1543/
SC1543 01  UTHISTCA-CALL-PARAM.
SC1543     COPY UTHISTCA IN LIBRYBOR.
SC1543/
TB0232 01  UT0076CA-CALL-PARAM.
TB0232     COPY UT0076CA IN LIBRYBOR.
016170/
016180 01  WS-BLDV-FC-RECORD-AREA.                                             
016190     COPY BLDVFC IN LIBRYBOR.                                            
016200/
016210 01  WA-BLDV-AREA-MM.
016220     COPY BLDVMM IN LIBRYBOR.
TB0069/
TB0069 01  WA-BLDV-AREA-NI.
TB0069     COPY BLDVNI IN LIBRYBOR.
016230/
016240 01  WA-BLDV-AREA-WW.
016250     COPY BLDVWW IN LIBRYBOR.
016260/
016270 01  WA-BLDV-AREA-UU.
016280     COPY BLDVUU IN LIBRYBOR.
016290/
SC3429 01  WS-BLDV-AREA-NN.        
SC3429     COPY BLDVNN IN LIBRYBOR.
SC3429/                            
016300 01  CUSM-RECORD-AREA.
016310     COPY CUSMMAST IN LIBRYMIS.
016320/
S16618 01  WA-GTEM-AREA.
S16618     COPY GTEMMAST IN LIBRYMIS.
S16618
016330 01  BCOV-RECORD-AREA.
016340     COPY BCOVVARV IN LIBRYBOR.
016350/
016360 01  BLNF-RECORD-AREA.
016370 COPY BLNFMAST IN LIBRYBOR.
016380/
TB0069 01  BRTH-RECORD-AREA.
TB0069     COPY BRTHMAST IN LIBRYBOR.
TB0069/
S15266 01  UTBFTVCA-CALL-AREA.
S15266     COPY UTBFTVCA  IN LIBRYMIS.
S15848 01  UTVIPCCA-CALL-PARAM.
S15848     COPY UTVIPCCA IN LIBRYMIS.
016390 01  ARRS-RECORD-AREA.
016400   02  ARRSPHYS.
016410     COPY ARRSMAST IN LIBRYBOR.
016420*01  CASHIER-CURRENCY                    PIC XXX.
016430 01  CASHIER-CALL-AREA.
016440     COPY CASHCALL IN LIBRYMIS.
016450*
016460 01  CASHIER-TOTALS.
016470     02  CASHIER-TOTAL-FUNCTION          PIC 99.
016480     02  CASHIER-TOTAL-STATUS            PIC 999.
016490     02  CASHIER-TOTAL-REFER             PIC X(4).
016500     02  CASHIER-RECORD-AREA.
016510     COPY CASTMAST IN LIBRYMIS.
016520/
S15779 01  ID-SUB                              PIC 99 COMP VALUE 0.
S15779 01  WA-HELD-COUNT                       PIC S9(4)  COMP.
S15779 01  WA-DELAY-TIME                       PIC S9(15) COMP
S15779                                                 VALUE 100.
S15779 01  WA-MICV-AREA.
S15779     COPY MICVVARV IN LIBRYMIS.
S15779
S15779 01  WA-MICM-AREA.
S15779     COPY MICMMAST IN LIBRYMIS.
S15779
S15813 01  WA-PRJP-AREA.
S15813     COPY PRJPMAST IN LIBRYBOR
S15813     REPLACING ==(PRJP)== BY ==PRJP==.
S15813*
016530 01  WA-CUSV-AREA-AA.
016540     COPY CUSVAA IN LIBRYMIS.
016550*
016560 01  WA-CUSV-AREA-A3.
016570     COPY CUSVA3 IN LIBRYMIS.
016580/
016590 01  WA-CUSV-AREA-BB.
016600     COPY CUSVBB IN LIBRYMIS.
016610*
016620 01  WA-CUSV-AREA-B3.
016630     COPY CUSVB3 IN LIBRYMIS.
016640/
016650 01  WA-CUSV-AREA-CC.
016660     COPY CUSVCC IN LIBRYMIS.
016670/
016680 01  WA-CUSV-AREA-DD.
016690     COPY CUSVDD IN LIBRYMIS.
016700/
016710 01  WA-CUSV-AREA-D1.
016720     COPY CUSVD1 IN LIBRYMIS.
016730/
016740 01  WA-CUSV-AREA-EE.
016750     COPY CUSVEE IN LIBRYMIS.
016760/
TB0099 01  UT0312CA-CALL-AREA.
TB0099     COPY UT0312CA IN LIBRYBOR.
TB0099/
016770 01  WA-CUSV-AREA-ZZ.
016780     COPY CUSVZZ IN LIBRYMIS.
016790/
SC4522 01  UT0038-CALL-AREA.
SC4522     COPY UT0038CA IN LIBRYMIS.
SC4522/
016800 01  WA-JNRST-SAVE-DATA.
016810     03  WA-JNRST-OLD-ALPHA              PIC X(40).
016820     03  WA-JNRST-OLD-PCODE              PIC X(8).
016830     03  WA-JNRST-HOME-BR                PIC 9(4) COMP.
016840/
016850 01  WA-CUSV-AREA-MM.
016860     COPY CUSVMM IN LIBRYMIS.
016870/
016880 01  SUSP-RECORD-AREA.
016890     COPY SUSPMAST IN LIBRYMIS.
016900*
016910 01  GL-PASSALONG.
016920     COPY GLPASSWS IN LIBRYGEN.
016930*
S10614 01  WA-FEP-OUTBOUND.
S10614     03  WA-FEP-INPUT-AREA               PIC X(982).
S10614     03  WA-FEP-ACCT-AVAIL-BAL           PIC S9(14)V999.
S10614     03  WA-FEP-ACCT-BAL                 PIC S9(14)V999.
S10614*
016940*01  ST-CALL-CODE.                                                       
016950*        03  ST-DBIO-CALL-CODE           PIC 99.                         
016960*        03  FILLER                      PIC X(20).                      
016970*        03  ST-DBIO-SAVE-REFER          PIC XXXX.                       
016980*        03  FILLER                      PIC X.                          
016990*        03  ST-DBIO-LOCK-FLAG           PIC X.                          
017000*        03  FILLER                      PIC X(474).                     
017010 01  DBIO-CALL-RECORD-AREA.                                              
017020     03  DBIO-CALL-RECORD                PIC X(2560).                    
017030 01  CALL-FUNCTION                       PIC X(8).
017040 01  DB-PROC-PARAMS.
017050     03  DB-PROC-PARAM.
017060         05  DB-PROC-FUNC                PIC 99.
017070         05  FILLER                      PIC X(20).
017080         05  DB-PROC-SAVE-REFER          PIC XXXX.
017090         05  FILLER                      PIC X.
017100         05  DB-PROC-LOCK-FLAG           PIC X.
017110         05  FILLER                      PIC X(474).
017120     03  DB-PROC-KEY.
017130         05  DB-PROC-SOC-NO              PIC 999.
017140         05  DB-PROC-BRANCH              PIC 9(16).
017150         05  FILLER                      PIC X(12).
017160     03  DB-PROC-STATUS-1                PIC XXXX.
017170     03  DB-PROC-SYS                     PIC X(8).
017180*****  SPR NO. 760338  *****
017190 01 WA-GET-SOP.
017200     03  WA-13500-FOUND-SW               PIC X  VALUE "N".
017210         88  WA-88-13500-FOUND                  VALUE "Y".
017220     03  WA-END-OF-SEARCH-SW             PIC X  VALUE "N".
017230         88  WA-88-END-OF-SEARCH                VALUE "Y".
017240     03  WA-PREV-SOP-DATE                PIC S9(9)  BINARY.
017260 01  WA-COMROL-PARAM.
017270     03  WA-COMROL-CALL-CODE             PIC 99.
017280     03  FILLER                          PIC X(20).
017290     03  WA-COMROL-CALL-SAVE-REFER       PIC XXXX.
017300     03  FILLER                          PIC X.
017310     03  WA-COMROL-LOCK-FLAG             PIC X.
017320     03  FILLER                          PIC X(474).
017330 01  WA-COMROL-SYSTEM                    PIC X(8).
017340 01  WA-COMROL-ACCT-NO                   PIC X(31).
017350 01  WA-COMROL-STATUS                    PIC XXXX.
017360/
017370 01  WA-GL-TXN-AREA.
017380     COPY INPUTMSL IN LIBRYGEN.                                           
017390*
017400     COPY SUSPID IN LIBRYMIS.
017410*
017420 01      WA-SAVE-SUSP-RECORD-AREA        PIC X(100) VALUE SPACES.
017430 01      WA-SUSP-SYSTEM                  PIC X(8) VALUE "SUSP".
017440 01      WA-SUSP-STATUS                  PIC XXXX.
017450 01      WA-SUSP-KEY.
017460   03    WA-SUSP-INST                    PIC 999.
017470   03    WA-SUSP-BRANCH                  PIC 9999.
017480   03    WA-SUSP-TYPE.
017490     05  WA-SUSP-TYPE-CURRENCY           PIC XXX.
017500     05  WA-SUSP-TYPE-FILLER             PIC X.
017510*    05  WA-SUSP-TYPE-ID                 PIC X(13) VALUE SPACES.          
017520     05  WA-SUSP-TYPE-ID                 PIC X(19) VALUE SPACES.          
017530*
017540 01      WA-SUSP-MAST                    PIC X(983).
017550 01      WA-SUSP-ACCT-NO                 PIC 9(16).
017560 01      WA-SUSP-CUST-NO                 PIC 9(16).
017570 01      WA-SUSP-HOME-BR                 PIC 9(4).
B19902*017580 01      WA-SUSP-EDIT-MASK               PIC X(52).
B19902 01      WA-SUSP-EDIT-MASK               PIC X(74).
B19902*017590 01      WA-SUSP-STARTAREA               PIC X(1132).
B19902 01      WA-SUSP-STARTAREA               PIC X(1182).
017600 01      WA-SUSP-INPUT-MESSAGE           PIC X(982).
017610 01      WA-SUSP-TRAN-CODE               PIC 9(6).
017620 01      WA-REJECT-MSG                   PIC X(40) VALUE
017630                         "TRANS.POSTED TO SUSPENSE ACCOUNT".
017640 01      WA-LIMIT-AMT                    PIC S9(14)V999 COMP.
017650 01      WA-3900-OVERRIDE                PIC XX VALUE SPACES.
017660*
017670 01  UTEXPTCA-AREA.
017680     COPY UTEXPTCA IN LIBRYTRE.
017690*
017700*    FEE REDIRECTION STUFF
017710*
017720 01  WA-CNT                              PIC 99 VALUE ZEROES.
017730 01  WA-FEE-CNT                          PIC 99.
017740 01  WA-20-FEE-NARR.
017750     03 WA-20-FEE-TXT                    PIC X(20).
017760     03 FILLER                           PIC X.
017770     03 WA-20-TRF-FROM-TXT               PIC X(8).
017780     03 FILLER                           PIC X.
017790     03 WA-20-FROM-ACCT-NO               PIC X(20).
017800 01  WA-TFRFRM-FLAG                      PIC X VALUE "N".
017810 01  WA-SAVE-INVM-AREA                   PIC X(983).
017820 01  WA-SAVE-TX-IND-FLAG                 PIC X.
017830 01  WA-CHK-FOR-FEE-BEAR                 PIC X VALUE "N".
017840     88  WA-IT-IS-FEE-BEAR-ACCT          VALUE "Y".
017850 01  WA-SAVE-BORM-RECORD-AREA            PIC X(983).
SC1352 01  WA-SAVE-BORM-RECORD-AREA-GL         PIC X(983).
017860 01  WA-FEE-BEAR-BORM-RECORD-AREA        PIC X(983).
017870 01  WA-PREV-BORM-RECORD-AREA            PIC X(983).
017880 01  WA-TRAN-CODE                        PIC 9(6).
017890 01  WA-TRAN-CODE-R REDEFINES WA-TRAN-CODE.
017900     03  WA-TRAN-CODE-6                  PIC 9(2).
017910     03  WA-TRAN-CODE-4                  PIC 9.
017920     03  WA-TRAN-CODE-3                  PIC 9.
017930     03  WA-TRAN-CODE-2                  PIC 99.
B19902*017940 01  WA-FEE-BEAR-EDIT-MASK-AREA          PIC X(54).
B19902 01  WA-FEE-BEAR-EDIT-MASK-AREA          PIC X(74).
017950 01  WA-FEE-BEAR-MASK.
017960     03  WA-STORE-PARAM-TABLE            PIC X
017970                                         OCCURS 32 TIMES.
017980 01  WA-SAVE-OUTPUT-MSG                  PIC X(983).
017990*
018000 01  WA-WORK-AREA.
018010     03  WA-SAVE-FROM-ACCT               PIC 9(16).
018020     03  WS-SAVE-TXN-CURRENCY            PIC XXX VALUE SPACES.
018030     03  WA-SAVE-FROM-BRANCH             PIC 9999.
018040     03  WA-SAVE-ORIG-TRAN               PIC 9(6).
018050     03  WA-SAVE-TO-BRANCH               PIC 9999.
018060     03  WS-SAVE-DISC-CURRENCY           PIC XXX VALUE SPACES.
018070     03  WA-SAVE-TXN-AMT                 PIC S9(14)V999 VALUE 0.
018080     03  WA-SAVE-ACCT-AMT                PIC S9(14)V999 VALUE 0.
018090     03  WA-SAVE-CHANGE-AMT              PIC S9(14)V999 VALUE 0.
018100     03  WA-SAVE-ARREARS                 PIC S9(14)V999 VALUE 0.
018110     03  WA-SAVE-ARR-INT-INCR            PIC S9(14)V999 VALUE 0.
018120     03  WA-REBATE                       PIC S9(14)  VALUE 0.
018130     03  WA-ACCT-CURR-CD                 PIC XXX  VALUE SPACES.
018140     03  4XSTARS                         PIC X(4) VALUE "****".
018150     03  WA-STORE-TRN-NO-2               PIC 9(6).
018160* 760167 EFTI WS VARIABLES COPIED FROM PASSOTHR IN LIBRYMIS.
018170     03  WA-INVM-INT-ADJUST              PIC S9(12)V9(5) COMP.
018180     03  WA-INVM-DR-INT-ADJUST           PIC S9(12)V9(5) COMP.
018190     03  WA-INVM-INT-AVAIL               PIC S9(12)V9(5) COMP.
018200     03  WA-INVM-DR-INT-AVAIL            PIC S9(12)V9(5) COMP.
018210     03  WA-SAVE-COMMISSION-AMT          PIC S9(14)V999.
018220     03  WA-VAL-ARRS                     PIC S9(14)V999.
018230     03  FILLER                          PIC X.
018240     03  WA-TRN-DATE-98                  PIC 9(8).
018250     03  WA-TRN-DATE-X4                  PIC S9(9) BINARY.
018260     03  WA-CR-INT                       PIC S9(14)V999 BINARY.
018270     03  WA-DR-INT                       PIC S9(14)V999 BINARY.
018280     03  WA-STATEMENT-REQD               PIC X.
018290*  760167 END.
018300*    03  SAVE-WA-ATM-FIELD               PIC X(32).                     
018310     03  WS-AMT                          PIC S9(14)V999 VALUE 0.
SC5647     03  WA-TOT-TXN-AMT                  PIC S9(14)V9(3) VALUE 0.
018320     03  WA-CHANGE-CURR                  PIC XXX  VALUE SPACES.
018330     03  WA-TEMP-YRS                     PIC 99.
018340     03  WA-DAYS-IN-MNTH                 PIC 99.
018350     03  WS-DAYS-IN-YEAR                 PIC 9(3) VALUE 0.                
018360     03  WA-TERM                         PIC 9(4) VALUE 0.
018370     03  WA-TEMP-MTHS                    PIC 99.
018380     03  WA-LOAN-REFRESH-FLAG            PIC X    VALUE SPACE.
018390     03  WA-STORE-TRN-NO                 PIC 9(6) VALUE 0.
018400     03  WA-CAST-LOCK-FLAG               PIC 9    VALUE 0.
018410     03  WA-CHANGE-FLAG                  PIC 9 VALUE 0.
018420     03  WA-AUTO-DISCH-FLAG              PIC X VALUE SPACE.
018430     03  WA-START-FLAG                   PIC 9 VALUE 0.
018440     03  WA-RSRT-THREAD-NO               PIC 99 VALUE 0.
018450     03  WA-IR-TXN-FLAG                  PIC X.
018460     03  WA-MM-SUB                       PIC 99.
018470     03  WA-INT-FREQ                     PIC 99.
018480     03  WA-PAY-DAY                      PIC 99.
018490     03  WA-INT-SUBSIDY                  PIC S9(14)V999.
018500     03  WA-TYPE                         PIC 9999.
018510     03  WA-TYPE-R REDEFINES WA-TYPE.
018520         05  WA-TYPE-CHAR1               PIC 9.
018530         05  WA-TYPE-CHAR2               PIC 9.
018540         05  WA-TYPE-CHAR3               PIC 9.
018550         05  WA-TYPE-CHAR4               PIC 9.
018560     03  WA-LEDG-CODE                    PIC 9999.
018570     03  WA-LEDG-CODE-R REDEFINES WA-LEDG-CODE.
018580         05  WA-LEDG-CODE1               PIC 9.
018590         05  WA-LEDG-CODE2               PIC 9.
018600         05  WA-LEDG-CODE3               PIC 9.
018610         05  WA-LEDG-CODE4               PIC 9.
018620     03  WA-REPAY-TRCODE                 PIC 9(6).
TB0190         88  WA-CUST-INC-EXP-MAINT           VALUE 12003 12004
TB0190                                                   12005 10447
TB0190                                                   10427 10428.
TB0190         88  WA-CUST-INC-EXP-ENQUIRY         VALUE 10427 10428.
TB0190         88  WA-CUST-INC-EXP-FEES            VALUE 11054 11154
TB0190                                                   13012 13112
TB0190                                                   13013 13113
TB0190                                                   13042 13142
TB0190                                                   13043 13143
TB0190                                                   13052 13152
TB0190                                                   13058 13158
TB0190                                                   13061 13161
TB0190                                                   13062 13162.
TB0285         88  WA-RECOLL-COMM                  VALUE 11041 11141.
S12794         88  WA-YOUBE-WAVE-TRCODE            VALUE 10832 10862
S12794                                                   10872 10882
S12794                                                   10892 10893.
S12794         88  WA-WAVE-TRCODE                  VALUE 10732 10241
S12794                                                   10242 10243
S12794                                                   10244 10245.
018630         88  WA-CREDIT-REPAY-TRCODE          VALUE 10030
018640                                                   10130
018650                                                   11030
018660                                                   11130
018670                                                   15030
018680                                                   15130
018690                                                   16030
018700                                                   16130.
018710         88  WA-DEBIT-REPAY-TRCODE           VALUE 10050
018720                                                   10150
018730                                                   11050
018740                                                   11150
018750                                                   15050
018760                                                   15150
018770                                                   16050
018780                                                   16150.
018790         88  WA-CASH-REPAY-TRCODE                 VALUE 10010
018800                                                        10110
018810                                                        11010
018820                                                        11035           
018830                                                        11110
018840                                                        14010
SC5862                                                        14011
SC5862                                                        14111
SC7091                                                        19011
SC7091                                                        19111
018850                                                        14110
018860                                                        15010
018870                                                        15110
018880                                                        16010
018890                                                        16110
018900                                                        18010
018910                                                        18110.
SC6507         88  WA-TRF-REPAY-TRCODE                  VALUE 11045
SC6507                                                        11046
S10982                                                        11049.
S10982         88  WA-TRAN-SRNM-RECON                   VALUE 11049
S10982                                                        11149
S10982                                                        16049
S10982                                                        16149.
S16235         88  WA-DISCH-SRNM-RECON                  VALUE 13047
S16235                                                        13147
S16235                                                        15047
S16235                                                        15147.
018920         88  WA-CHQ-REPAY-TRCODE                  VALUE 10020
018930                                                        10120
018940                                                        11020
018950                                                        11120
018960                                                        15020
018970                                                        15120
018980                                                        16020
018990                                                        16120.
ST0029     03  WA-TRAN-BIT REDEFINES WA-REPAY-TRCODE.
ST0029         05 FILLER                       PIC 9(2).
ST0029         05 WA-OLR-TRANX                 PIC 9.
ST0029            88 WA-OLR-TRAN               VALUE 3.
ST0029         05 FILLER                       PIC 9(3). 
SC5266     03  WA-ORIG-EFT-TRN-NO              PIC 9(6) VALUE 0.
019000     03  WA-RATE-FOUND                   PIC 9 VALUE 0.
019010*
019020     03  WA-TIER-METHOD                  PIC 99.
019030     03  WA-TIER-METH REDEFINES WA-TIER-METHOD.
019040         05  WA-TIER-METH-1              PIC 9.
019050         05  WA-TIER-METH-2              PIC 9.
019060     03  WA-TIER-LEVEL                   PIC 9(4).
019070     03  WA-TIER-SUB                     PIC 9(4).
019080*
019090     03  WA-SOURCE-CODE                  PIC 99.
019100     03  WA-SRCE-CDE-PARTS REDEFINES WA-SOURCE-CODE.
019110         05  WA-SRCE-CDE-1               PIC 9.
019120         05  WA-SRCE-CDE-2               PIC 9.
019130*
019140     03  WA-STORE-LN-BAL-IN              PIC S9(14)V999 COMP.
019150     03  WA-STORE-ACCR-INT          PIC S9(14)V999 COMP.
019160     03  WA-STORE-ACCR-SHRE-INT     PIC S9(14)V999 COMP.
019170     03  WA-STORE-EOM-BAS-IN             PIC S9(14)V999 COMP.
019180     03  WA-STORE-EOY-BAS-IN             PIC S9(14)V999 COMP.
019190     03  WA-ARREARS                      PIC S9(14)V999 COMP.
019200     03  WS-ARREARS-AMT                  PIC S9(14)V999 COMP              
019210                                             VALUE 0.                     
019220     03  WA-TEMP-DIS-INT                 PIC S9(12)V9(5) COMP.
019230     03  WA-WORK-INT                     PIC S9(12)V9(5) COMP.
019240     03  WA-WORK-INT-0                   PIC S9(12).
019250     03  WA-WORK-INT-1                   PIC S9(12)V9.
019260     03  WA-WORK-INT-2                   PIC S9(12)V99.
019270     03  WA-SHARE-REFUND                 PIC S9(14)V999 COMP.
019280     03  WA-MISC-DB                      PIC S9(14)V999 COMP.
019290     03  WA-BIT-1-FLAG                   PIC 9.
019300     03  WA-WORK-FIELD                   PIC S9(9) BINARY.
019310     03  WA-DUMMY-BAL                    PIC S9(14)V999 VALUE 0.
019320     03  WA-WORK-AMT                     PIC S9(14)V999 COMP.
019330     03  WA-LIM-TOL-FLAG                 PIC 9.
019340     03  WA-ACCT-TYPE-AMT                PIC S9(14)V999 COMP.
019350     03  WA-I                            PIC 99.
019360     03  WA-ONLINE-EOF                   PIC X.
019370     03  WA-TRN-DATE                     PIC 9(8).
019380     03  WA-TRN-DATE-R REDEFINES WA-TRN-DATE.
019390         05  WA-TRN-DD                   PIC 99.
019400         05  WA-TRN-MM                   PIC 99.
019410         05  WA-TRN-CCYY.
019420             07  WA-TRN-CC               PIC 99.
019430             07  WA-TRN-YY               PIC 99.
019440         05  WA-TRN-CCYY-R REDEFINES WA-TRN-CCYY
019450                                         PIC 9(4).
019460     03  WA-STORE-TXN-DT                 PIC S9(9) BINARY.
019470     03  WA-DATE-FILE-KEY.
019480         05  WA-DATE-FILE-MM             PIC 99.
019490         05  WA-DATE-FILE-CC             PIC 99.
019500         05  WA-DATE-FILE-YY             PIC 99.
019510     03  WA-DATE-RCD-FOUND               PIC X.
019520     03  WA-STRT-TRN-NO-TMP              PIC 9(6).
019520     03  WA-DUMMY-TRN-NO                 PIC 9(6).
TB0278         88 WA-FEDI-TRANSFER-TXN   VALUES  1045  11045 11055
TB0278                                           1050  11050  1145
TB0278                                          11145  11155  1150
SC4522                                           1130  11130
TB0278                                          11150   1030 11030
SC7091                                           16030 16130 16045
SC7091                                           16145 16050 16150
SC7091                                           16055 16155.
SC4522         88 WA-FEDI-BP-TXN         VALUES  1045  11045 11055
S11926*SC4522                                    1145  11045 11055
S11926                                           1145  11145 11155
SC7091                                           16045 16145
SC7091                                           16055 16155.
SC4490         88 WA-LEDGE-SUB-TXN       VALUES  14030 14045 14050
SC4490                                           14055 14060 14062
SC4490                                           14130 14145 14150
SC7091                                           19011 19030 19045
SC7091                                           19111 19130 19145
SC7091                                           19050 19055 19060
SC7091                                           19150 19155 19160
SC7091                                           19062 19162
SC4490                                           14155 14160 14162.
S19100         88 WA-ATM-STRF-TXN        VALUES  14045 14145 19045
S19100                                           19145.
S20054         88 WA-SME-ALLOWED-TXN     VALUES  10729.
S20486         88 WA-MLWM-TXN            VALUES  11044 11045
S20486                                           13045 15045
S20486                                           16044 16045
S20486                                           16010
S20486                                           .
019530     03  WA-DUMMY-TRN-NO-R  REDEFINES WA-DUMMY-TRN-NO.
019540         05  FILLER                      PIC 9.
019550         05  WA-DUMMY-FST-ONE            PIC 9.
019560           88  WA-DUMMY-LOAN-TXN             VALUE 1.
019570         05  FILLER                      PIC X(2).
019580         05  WA-DUMMY-LST-TWO            PIC 99.
019590           88  WA-DUMMY-CR-DB-TXN            VALUE 30, 32, 40, 47,
019600                                                   50, 52, 53, 90.
TB0070           88  WA-REPAYMENT-TXN              VALUE 10, 20, 45, 46,
S10982                                                   11, 30, 49.
019610     03  WA-DUMMY-GL-TRN-NO              PIC 9(6).
019620     03  WA-DUMMY-GL-TRN-NO-R REDEFINES WA-DUMMY-GL-TRN-NO.
019630         05  FILLER                      PIC X.
019640         05  WA-DUMMY-GL-TRN-NO-2        PIC 9.
019650         05  WA-DUMMY-GL-TRN-NO-3        PIC 9.
019660         05  WA-DUMMY-GL-TRN-NO-4        PIC 9.
019670         05  WA-DUMMY-GL-LST-TWO         PIC 99.
019680     03  WA-INT-DUE-DT                   PIC S9(9) BINARY.
S16466*019690     03  WA-INT-RATE-A                   PIC 99V9999.
S16466     03  WA-INT-RATE-A                   PIC S99V9999.
TB0069     03  WA-INT-RATE-BASM                PIC 99V9999.
019700     03  WA-INT-DATE-A                   PIC S9(9) BINARY.
019710     03  WS-FINE-RATE                    PIC S99V99999 VALUE 0.           
SC4522     03  WA-BORM-CURRENCY                PIC XXX.
SC4522     03  WA-TEMP-AMT2                    PIC S9(14)V999.
SC4522     03  WA-DEBIT-AMT                    PIC S9(14)V999.
019720*
019730     03  WA-PROC-DDMMCCYY.
019740         05  WA-PROC-DD                  PIC 99.
019750         05  WA-PROC-MM                  PIC 99.
019760         05  WA-PROC-CCYY.
019770             07  WA-PROC-CC              PIC 99.
019780             07  WA-PROC-YY              PIC 99.
019790         05  WA-PROC-CCYY-R REDEFINES WA-PROC-CCYY
019800                                         PIC 9(4).
019810     03  WA-PROC-DT-BINARY               PIC S9(9) BINARY.
019820*
019830     03  WA-WORK-DDMMCCYY.
019840         05  WA-WORK-DD                  PIC 99.
019850         05  WA-WORK-MM                  PIC 99.
019860         05  WA-WORK-CCYY.
019870             07  WA-WORK-CC              PIC 99.
019880             07  WA-WORK-YY              PIC 99.
019890         05  WA-WORK-CCYY-R REDEFINES WA-WORK-CCYY
019900                                         PIC 9(4).
019910*
019920     03  WA-INT-ST-DATE                  PIC S9(9) BINARY.
019930     03  WA-TODAY-BINARY-DATE            PIC S9(9) BINARY.
TB0069     03  WA-ADV-DATE-BIN                 PIC S9(9) BINARY.
S10467     03  WA-ADV-DATE-BIN-SAVE            PIC S9(9) BINARY.
SC8733     03  WA-TEMP-PREF-DATE               PIC S9(9) BINARY.
019940     03  WA-TXN-COUNT                    PIC 99.
019950     03  WA-DUMMY-AMT                    PIC S9(14)V999 VALUE 0.
019960     03  WA-DUMMY-AMT1                   PIC S9(14)V999 VALUE 0.
019970     03  WS-APP-AMOUNT                   PIC S9(14)V999 VALUE 0.
019980     03  WA-50PC-ADV                     PIC S9(14)V999 VALUE 0.
019990     03  WA-STORE-AMOUNT                 PIC 9(14)V999.
020000     03  WA-TRN-MATCH-FOUND              PIC X.
020010     03  WA-STORE-LEDG-CODE              PIC 9.
020020     03  WA-STORE-LST-FIN-DT             PIC S9(9) BINARY.
020030     03  WA-STORE-TOT-TRNS               PIC XXXX.
020040     03  WA-DUMMY-TRN-NO-1               PIC 9(6).
020050     03  WA-DUMMY-TRN-NO-1-R  REDEFINES WA-DUMMY-TRN-NO-1.
020060         05  WA-DUMMY-TRN-NO-11          PIC 9.
020070         05  WA-DUMMY-TRN-NO-21          PIC 9.
020080         05  WA-DUMMY-TRN-NO-31          PIC 9.
020090         05  WA-DUMMY-TRN-NO-41          PIC 9.
020100         05  WA-DUMMY-TRN-NO-51          PIC 9.
020110         05  WA-DUMMY-TRN-NO-61          PIC 9.
020120     03  WA-DUMMY-TRN-NO-2               PIC 9(6).
020130     03  WA-DUMMY-TRN-NO-2-R  REDEFINES WA-DUMMY-TRN-NO-2.
020140         05  WA-DUMMY-TRN-NO-12          PIC 9.
020150         05  WA-DUMMY-TRN-NO-22          PIC 9.
020160         05  WA-DUMMY-TRN-NO-32          PIC 9.
020170         05  WA-DUMMY-TRN-NO-42          PIC 9.
020180         05  WA-DUMMY-TRN-NO-52          PIC 9.
020190         05  WA-DUMMY-TRN-NO-62          PIC 9.
020200     03  WA-DUMMY-CHQ-NO.
020210         05  WA-DUMMY-CHQ-7              PIC 9(7).
020220         05  WA-DUMMY-CHQ-LAST           PIC 9.
020230     03  WA-INPUT-MESSAGE-AREA           PIC X(982).
020240     03  WA-INPUT-TRN-NO                 PIC 9(6).
020250     03  WA-INPUT-TRN-EXPAND REDEFINES WA-INPUT-TRN-NO.
020260         05  WA-INPUT-TRN-1              PIC 99.
020270         05  FILLER                      PIC 9(4).
S17474     03  WA-MESSAGE-TRN-NO               PIC 9(6).
S17474         88 WA-MSG-TRN-NO        VALUES  600001 THRU 600010.
020280     03  WA-INPUT-PROMO                  PIC XX.
020290     03  WA-LNFUND-EOF                   PIC 9 VALUE 0.
020300     03  WA-END-COMB                     PIC 9.
020310     03  WA-COMB-CNT                     PIC 9.
020320     03  WA-TODAYS-DATE-R.
020330         05  WA-TODAY-DD-R               PIC XX.
020340         05  FILLER                      PIC X VALUE "/".
020350         05  WA-TODAY-MM-R               PIC XX.
020360         05  FILLER                      PIC X VALUE "/".
020370         05  WA-TODAY-CC-R               PIC XX.
020380         05  WA-TODAY-YY-R               PIC XX.
020390     03  WA-TIME                         PIC 9(8).
020400     03  WA-TIME-R  REDEFINES WA-TIME.
020410         05  WA-HH                       PIC XX.
020420         05  WA-MM                       PIC XX.
020430         05  FILLER                      PIC X(4).
020440     03  WA-DISPLAY-TIME.
020450         05  WA-DISPLAY-HH               PIC XX.
020460         05  FILLER                      PIC X VALUE "/".
020470         05  WA-DISPLAY-MM               PIC XX.
020480     03  WA-ACTUAL-YIELD                 PIC S9(15)V999.
020490     03  WA-ACT-CUM-YIELD                PIC S9(15)V999.
020500     03  WA-YIELD                        PIC S9(15)V999.
020510     03  WA-CUM-YIELD                    PIC S9(15)V999.
020520     03  WA-CUM-TOT-AMT                  PIC S9(15)V999 VALUE 0.
020530     03  WA-CUM-TOT-USED                 PIC S9(15)V999 VALUE 0.
020540     03  WA-AMOUNT-STORE                 PIC S9(14)V999 VALUE 0.
020550     03  WA-FEE-STORE                    PIC S9(14)V999 VALUE 0.
020560     03  WA-BORM-AMT1                    PIC S9(14)V999 VALUE 0.
020570     03  WA-INT-AVAILABLE                PIC S9(12)V9(5) VALUE 0.
020580     03  WA-TOM-AVAILABLE                PIC S9(12)V9(5) VALUE 0.        
020590     03  WA-33-MSG-AREA.
020600         05 WA-33-MSG-TEXT               PIC X(6).
020610         05 WA-33-MSG-AMT                PIC -9(7).9(5).
020620     03  WA-TXN-STATUS.
020630         05  WA-NPB-STAT                 PIC 9.
020640         05  WA-BKD-STAT                 PIC 9.
020650     03  WA-TXN-STAT REDEFINES WA-TXN-STATUS
020660                                         PIC 99.
020670     03  WA-CANCEL-REASON.
020680         05  WA-CANCEL-CODE              PIC 99.
020690         05  FILLER                      PIC XXX VALUE " -".
020700         05  WA-CANCEL-MSG               PIC X(15).
020710     03  WA-EDIT-BAL-AMT                 PIC X(19).
020720     03  WA-EDIT-BAL-AMT-1 REDEFINES WA-EDIT-BAL-AMT
020730                                         PIC Z(13)9.999-.
020740     03  WA-EDIT-BAL-AMT-2 REDEFINES WA-EDIT-BAL-AMT.
020750         05  FILLER                      PIC X(01).
020760         05  WA-EDITED-AMT-2             PIC Z(13)9.99-.
020770     03  WA-EDIT-BAL-AMT-3 REDEFINES WA-EDIT-BAL-AMT.
020780         05  FILLER                      PIC X(02).
020790         05  WA-EDITED-AMT-3             PIC Z(13)9.9-.
020800     03  WA-EDIT-BAL-AMT-4 REDEFINES WA-EDIT-BAL-AMT.
020810         05  FILLER                      PIC X(04).
020820         05  WA-EDITED-AMT-4             PIC Z(13)9-.
020830     03  WA-SAVE-NAME-1                  PIC X(30) VALUE SPACES.
020840     03  WA-SAVE-NAME-2                  PIC X(30) VALUE SPACES.
S11604     03  WA-DEP-ACC-NO                   PIC 9(16) VALUE ZEROS.
S15848     03  WA-CSCP-IND                     PIC 99.
020850*-- USED FOR 13651
020860 01  WA-SAVE-TFR-TXN-BRANCH              PIC 9999.
020870*
020880 01  WA-WORK-AMOUNT                      PIC S9(14)V999 COMP.
020890 01  WA-VA-DUMMY-AMOUNT.
020900     03  WA-VA-AMT                       PIC S9(14)V999
020910                                         TRAILING SEPARATE.
020920     03  WA-VA-AMT-0 REDEFINES WA-VA-AMT.
020930         05  FILLER                      PIC X(14).
020940         05  WA-DECS-0                   PIC 999.
020950         05  FILLER                      PIC X.
020960     03  WA-VA-AMT-1 REDEFINES WA-VA-AMT.
020970         05  FILLER                      PIC X(15).
020980         05  WA-DECS-1                   PIC 99.
020990         05  FILLER                      PIC X.
021000     03  WA-VA-AMT-1 REDEFINES WA-VA-AMT.
021010         05  FILLER                      PIC X(16).
021020         05  WA-DECS-2                   PIC 9.
021030         05  FILLER                      PIC X.
021040 01  WA-CURRENCY                         PIC XXX.
021050 01  WA-ACCEPT-TIME.
021060     03  WA-ACCEPT-HH                    PIC 99.
021070     03  WA-ACCEPT-MI                    PIC 99.
021080     03  WA-ACCEPT-SS                    PIC 9999.
021090 01  WA-ACCEPT-TIME-R.
021100     03  WA-ACCEPT-HH-R                  PIC 99.
021110     03  WA-ACCEPT-MI-R                  PIC 99.
021120 01  WA-ACCEPT-DATE.
021130     03  WA-ACCEPT-CC                    PIC 99.
021140     03  WA-ACCEPT-YY                    PIC 99.
021150     03  WA-ACCEPT-MM                    PIC 99.
021160     03  WA-ACCEPT-DD                    PIC 99.
021170 01  WA-ACCEPT-DATE-R.
021180     03  WA-ACCEPT-DD-R                  PIC 99.
021190     03  WA-ACCEPT-MM-R                  PIC 99.
021200     03  WA-ACCEPT-CC-R                  PIC 99.
021210     03  WA-ACCEPT-YY-R                  PIC 99.
021220 01  WA-ACCEPT-DATE-U REDEFINES WA-ACCEPT-DATE-R PIC 9(8).
021230 01  WA-BOR-BFY.
021240     03  WA-BFY-DD                       PIC 99.
021250     03  WA-BFY-MM                       PIC 99.
021260     03  WA-BFY-CC                       PIC 99.
021270     03  WA-BFY-YY                       PIC 99.
021280 01  WA-STORE-ACT-CORR-AMT               PIC S9(14)V999 COMP.
021290 01  WA-NCR-WORK-FIELDS.
021300     03  WA-TF-AC-NO                     PIC 9(16).
021310     03  WA-TF-AC-NO-R REDEFINES WA-TF-AC-NO.
021320         05  FILLER                      PIC 9(15).
021330         05  WA-TF-AC-NO-1               PIC 9.
021340 01  WA-SORT-KEY-FLAGS.
021350     03  WA-BEGIN-FLG                    PIC X.
021360         88  WA-BEGIN                    VALUE "Y".
021370     03  WA-END-ARRAY-FLG                PIC X.
021380         88  WA-END-ARRAY                VALUE "Y".
021390     03  WA-FINISH-FLG                   PIC X.
021400         88  WA-FINISH                   VALUE "Y".
021410 01  WA-BOR-BFY-BIN                      PIC S9(9) BINARY.
021420 01  WA-DATA-FORMAT.
021430     03  WA-DATA.
021440         05  WA-CUS-ACC-NO               PIC X(20).
021450         05  WA-CUS-ACC-PRIM             PIC X(20).
021460***      05  FILLER                      PIC X(654).
021470         05  FILLER                      PIC X(713).
021480     03  WA-LNFUND-DATA REDEFINES WA-DATA.
021490         05  WA-LNF-INT-RATE             PIC 99.99.
021500         05  FILLER                      PIC X(4).
021510         05  WA-LNF-TOT-AMT              PIC X(19).
021520         05  FILLER                      PIC X(4).
021530         05  WA-LNF-AMT-USED             PIC X(19).
021540         05  FILLER                      PIC X(4).
021550         05  WA-LNF-YIELD                PIC 99.99.
021560***      05  FILLER                      PIC X(634).
021570         05  FILLER                      PIC X(693).
021580     03  WA-LNFUND-DATA1 REDEFINES WA-DATA.
021590         05  WA-LNF-DATE                 PIC X(10).
021600         05  WA-LNF-TIME                 PIC X(5).
021610***      05  FILLER                      PIC X(679).
021620         05  FILLER                      PIC X(738).
021630 01  WA-BCOV-KEY.
021640     03  WA-BCOV-SOCIETY                 PIC XXX.
021650     03  WA-BCOV-CONDITION-NO            PIC 9999.
021660 01  WA-BYPASS-ENQ-FLG                   PIC X VALUE SPACE.
021670 01  WA-BANK-NUMBER                      PIC X(4) VALUE ZEROES.
021680 01  WA-REGION-ID                        PIC X(4) VALUE ZEROES.
021690 01  WA-COUNT                            PIC 99 VALUE ZEROES.
021700/
021710 01  MULTI-OVERRIDE-AREA.
021720     COPY MULTIOVR IN LIBRYMIS.
021730/
021740 01  UT0060-WORK-AREA.
021750   03  LOCATED-FLAG                       PIC X.
021760   03  WK-TELLER-INDEX                    PIC 99.
021770   03  WK-ERROR-INDEX                     PIC 99.
021780   03  WK-ERROR-OVERRIDE                  PIC XX.
021790   03  WK-BATCH-TANDEM                    PIC X.
021800   03  FILLER                             PIC X(42).
021810*
021820 01  W100-CAPT-DAY                        PIC 99.
021830 01  W100-PROC-DDMMCCYY                   PIC 9(08).
021840 01  FILLER  REDEFINES  W100-PROC-DDMMCCYY.
021850     03  W100-PROC-DD                     PIC 9(02).
021860     03  FILLER                           PIC 9(06).
021870 01  W100-CONS-RESPONSE.
021880     03  W100-CONS-A                       PIC X.
021890     03  FILLER                          PIC X(29).
021900*
021910 01  WA-CORR-EDIT-MASK.
021920     03  WA-CORR-PARAM-TABLE            PIC X
021930         OCCURS 32 TIMES.
021950 01  WA-SAVE-TRAN-CODE                   PIC 9(6).
021960 01  WA-SAVE-PROC-BITS                   PIC X(32).
SC5378 01  WA-SAVED-MASK REDEFINES WA-SAVE-PROC-BITS.
SC5378     03  WA-SAVED-PARAM-TABLE      PIC X
SC5378         OCCURS 32 TIMES.
021970 01  WA-EDIT-MASK.
021980     03  WA-INPUT-PARAM-TABLE            PIC X
021990         OCCURS 32 TIMES.
SC7018 01  WA-BIT-MASK.                                     
SC7018     03  WA-BIT                          PIC X        
SC7018         OCCURS 32 TIMES.                             
022000 01  WA-STORE-EDIT-MASK.
022010   02  WA-STORE-EDIT-MASK-1.
022020     03  WA-STORE-MNUMONIC               PIC X(4).
022030     03  WA-STORE-MNUMONIC-R REDEFINES WA-STORE-MNUMONIC.
022040         05  WA-STORE-GROUP              PIC 99.
022050         05  WA-STORE-SUB-GROUP          PIC 99.
022060     03  WA-STORE-SIGN                   PIC X.
022070     03  WA-ST-TOTS-MASK1                PIC X(10).
022080     03  WA-ST-TOTS-MASK2                PIC X(10).
022090     03  WA-ST-ENQ-CODE                  PIC 9(4).
022100     03  FILLER                          PIC X(5).
B19902   02  WA-STORE-EDIT-MASK-2              PIC X(40).
B19902*022110   02  WA-STORE-EDIT-MASK-2              PIC X(20).
022120*
022130 01  WA-INPUT-EDIT-MASK-1-2.
022140     03  WA-INPUT-EDIT-MASK-1            PIC X(34).
B19902     03  WA-INPUT-EDIT-MASK-2            PIC X(40).
B19902*022150    03  WA-INPUT-EDIT-MASK-2            PIC X(20).
022160/
022170 01  WA-UT0220-SAVE-CALL-KEY.
022180     03  WA-UT0220-SAVE-SOC-NO           PIC 9(3) VALUE 0.
022190     03  WA-UT0220-SAVE-GRP-NO           PIC 9(3) VALUE 0.
022200 01  WA-UT0220-CALL-AREA.
022210     COPY UT0220CA IN LIBRYMIS.
022220     COPY INSPARM IN LIBRYMIS.
022230/
022240 01  UT0096CA-AREA.                                                       
022250     COPY UT0096CA IN LIBRYMIS                                            
022260     REPLACING ==(UT0096CA)== BY ==UT0096CA==.                            
022270/                                                                         
022280 01  UT0350-CALL-AREA.
022290     03  UT0350-CALL-CODE                PIC 99.
022300     03  UT0350-CALL-STATUS              PIC 9.
022310     03  UT0350-CALL-KEY.
022320         05  UT0350-SOC-NO               PIC 9(3).
022330         05  UT0350-GRP-NO               PIC 9(3).
022340     03  UT0350-CALL-REC                 PIC X(582).
022350/
022360 01  LINK-AREA.
022370     COPY SYSPCALL IN LIBRYMIS.
022380/
022390 01  UT0500-CALL-PARAM.
022400     COPY UT0500CA IN LIBRYMIS.
022410/
022420     COPY UT2000CA IN LIBRYBOR.
022430     COPY BORPARM IN LIBRYBOR.
022440*
022450 01   WA-SAVE-BORPARM   PIC X(1600).
022460/
B17951*    COPY UT2010CA IN LIBRYBOR.
B17951*    COPY BIRPARM IN LIBRYBOR.
022490/
022500     COPY UT2100CA IN LIBRYBOR.
022510/
022520*
022530*  ** PARAMETERS FOR CALLING SUB-PROGRAM UT0060
022540*
022550 01  UT0060CA-AREA.
022560     COPY UT0060CA IN LIBRYMIS.
TB0147
TB0147 01  UTOVRDCA-AREA.
TB0147     COPY UTOVRDCA IN LIBRYMIS.
S11757 01  UT0082-CALL-AREA.
S11757     COPY UT0082CA IN LIBRYMIS.
S20486*
S20486 01  UTMLWM-CALL-PARAM.
S20486     COPY UTMLWMCA IN LIBRYMIS.
022570/
022580 01  ALL-WORKAREAS.
022590     03  DATE1                           PIC S9(9) BINARY.
022600     03  DATE2                           PIC S9(9) BINARY.
022610     03  WA-CALC-DATE                    PIC S9(9) BINARY.
022620     03  ROUND-AGE                       PIC 999.
022630     03  WA-DMY                          PIC S9(9) BINARY.
022640     03  WA-SEARCH-RATE-DATE             PIC S9(9) BINARY.
022650     03  WA-DMY-1                        PIC S9(9) BINARY.
022660     03  WA-005-DISDATE                  PIC 9(8).
022670     03  WA-040-REB                      PIC S9(14)V999 COMP.
022680     03  WA-050-CREB                     PIC S9(14)V999 COMP.
022690     03  WA-060-NREB                     PIC S9(14)V999 COMP.
022700     03  WA-TAX                          PIC 99.9999.
022710     03  WA-TAX-DISP REDEFINES WA-TAX PIC X(7).
022720     03  WA-BORM-FEE                     PIC 99999.99-.
022730     03  WA-FEE-DISP REDEFINES WA-BORM-FEE PIC X(9).
TB0082**--
TB0082     03  WA-FORMAT-LOAN-ACCT-NO          PIC Z(14).
TB0082     03  WA-SAVE-TRN-CODE                PIC 9(6).
TB0082     03  WA-SAVE-BRCH-NO                 PIC 9(4) VALUE 0.
TB0082     03  WA-PREV-DUE-DATE                PIC S9(9) BINARY.
SC4690     03  WA-SAVE-LOAN-ACCT-NO            PIC 9(16).
S11877*
S11877 01  WA-T4-WORKING-AREA.
S11877     03  WA-SAVE-T4-TRN-CODE             PIC 9(06).
S11877     03  WA-SAVE-T4-INPUT-MSG            PIC X(982).
S11877     03  WA-T4-TRN-CODE                  PIC 9(06) VALUE 10430.
S11877     03  WA-T4-TYPE                      PIC X(01) VALUE "C".
S11877     03  WA-T4-SEGMENT                   PIC X(01) VALUE "C".
S11877     03  SW-T4-FLAG                      PIC X(01) VALUE "N".
S11877*
S11911 01  WA-ADV-WORKING-AREA.
S11911     03  WA-SAVE-ADV-INPUT-MSG           PIC X(982).
S11911     03  WA-SAVE-ADV-INPUT-MSG-R  REDEFINES
S11911         WA-SAVE-ADV-INPUT-MSG.
S11911         05  WA-SAVE-ACCT-1              PIC 9(16).
S11911         05  WA-SAVE-OTH-1               PIC X(48).
S11911         05  WA-SAVE-ACCT-2              PIC 9(16).
S11911         05  WA-SAVE-OTH-2               PIC X(685).
S11911         05  FILLER                      PIC X(217).
TB0082**--
022740/
022750* ADD YOUR LINKAGE INTERFE AREAS HERE.
022760*
022770**** LINKAGE AREA FOR PKING AND UNPACKING OF BYTES ******
022780 01  PUAREA.
022790     03  FIELD-A                         PIC X(32).
022800     03  FIELD-B                         PIC X(4).
022810 01  DBIO-AREA.
022820     03  DBIO-01-AREA.
022830         05  DBIO-01-SYSTEM              PIC X(3).
022840         05  FILLER                      PIC X(5).
022850         05  DBIO-01-KEY.
022860             07  DBIO-01-SOC-NO          PIC 999.
022870             07  DBIO-01-ACCT-NO         PIC 9(16).
022880         05  DBIO-01-RETURN-STATUS       PIC X(4).
022890***      05  FILLER                      PIC S9(4) COMP-4.
022900     03  DBIO-32-AREA  REDEFINES DBIO-01-AREA.
022910         05  DBIO-32-SYSTEM              PIC X(3).
022920         05  FILLER                      PIC X(5).
022930         05  DBIO-32-KEY.
022940             07  DBIO-32-SOC-NO          PIC 999.
022950             07  DBIO-32-ACCT-NO         PIC 9(16).
022960         05  DBIO-32-RETURN-STATUS       PIC X(4).
022970/
TB0099 01  DBIO-AREA1.
TB0099     03  DBIO-07-AREA.
TB0099         05  DBIO-07-SYSTEM              PIC X(3).
TB0099         05  FILLER                      PIC X(5).
TB0099         05  DBIO-07-KEY.
TB0099             07  DBIO-07-SOC-NO          PIC 999.
TB0099             07  DBIO-07-ACCT-NO         PIC 9(16).
TB0099         05  DBIO-07-RETURN-STATUS       PIC X(4).
TB0099         05  DBIO-07-TRN-POINTER         PIC S9(4) BINARY.
TB0099         05  DBIO-07-TRN-CODE-AREA.
TB0099             07  DBIO-07-TRN-CODE        PIC 99    COMP.
TB0099     03  DBIO-12-AREA  REDEFINES DBIO-07-AREA.
TB0099         05  DBIO-12-SYSTEM-AREA.
TB0099             07 DBIO-12-SYSTEM           PIC X(3).
TB0099             07 FILLER                   PIC X(5).
TB0099         05  DBIO-12-KEY.
TB0099             07  DBIO-12-SOC-NO          PIC 999.
TB0099             07  DBIO-12-ACCT-NO         PIC 9(16).
TB0099         05  DBIO-12-RETURN-STATUS       PIC X(4).
TB0099         05  DBIO-12-TRN-POINTER         PIC S9(4) BINARY.
TB0099         05  FILLER                      PIC XX.
TB0099/
022980     COPY DBIOCALL IN LIBRYMIS.
022990     COPY UTCORRCA IN LIBRYMIS.
023000 01  COFL-RECORD.
023010     COPY COFLMAST IN LIBRYMIS.
023030/
023040 01  STORE-CUST-ACCT-NO                  PIC 9(16).
S19484*TB0169 01  WA-MEMB-CUST-AC                     PIC 9(16).
S19484 01  WA-MEMB-CUST-AC.
S19484     03 WA-MEMB-CUST-AC-6         PIC X(06).
S19484     03 WA-MEMB-CUST-AC-2         PIC X(02).
S19484        88 WA-MEMB-OD                 VALUE "70".
S19484     03 WA-MEMB-CUST-AC-8         PIC X(08).
023050 01  W100-I                              PIC 99 VALUE 0.
023060 01  WA-CUSV-KEY.
023070   03  WA-CUSV-SOC-NO                    PIC 999.
023080   03  WA-CUSV-ACCT-NO                   PIC 9(16).
023090   03  FILLER                            PIC X(12).
023100 01  WA-BORM-KEY REDEFINES WA-CUSV-KEY.
023110   03  WA-BORM-SOC-NO                    PIC 999.
023120   03  WA-BORM-ACCT-NO                   PIC 9(16).
023130   03  FILLER                            PIC X(12).
023140 01  DB-LNF-KEY REDEFINES WA-CUSV-KEY.
023150   03  DB-LNF-SOC-NO                     PIC 999.
023160   03  DB-LNF-INT-RATE                   PIC 99V99.
023170   03  FILLER                            PIC X(24).
023180 01  STORE-BORM-AREA.
023190     COPY BORMMAS7 IN LIBRYBOR.
023200*
S18566*TB0274 01 WS-TEMP-VIRTUAL-TYPE               PIC 9(4).
S18566*TB0274 01 WS-TEMP-VIRTUAL-TYP1 REDEFINES WS-TEMP-VIRTUAL-TYPE.
S18566*Tb0274    03 WS-TEMP-VIRTUAL-FLG             PIC  9.
S18566*TB0274       88 WA-VIRTUAL-ACT-TYPE          VALUE 8.
S18566*          03 FILLER                          PIC 9(3).
TB0274 01 LRTP-RECORD-AREA.
TB0274     COPY LRTPMAST IN LIBRYMIS.
023220 01  UTCLRDCA-CALL-AREA.
023230     COPY UTCLRDCA IN LIBRYMIS
023240          REPLACING ==(UTCLRDCA)== BY ==UTCLRDCA==.
023250 01  WA-CLRD-CODE.
023260     03 WA-CLRD-CODE-1                   PIC X.
023270     03 WA-CLRD-CODE-2                   PIC X.
023280 01  WA-CLRD-CODE-9
023290     REDEFINES WA-CLRD-CODE              PIC 99.
023300 01  WA-TRANSLATED-DEFER-DAYS            PIC 9(4).
023310 01  WA-TRANSLATED-CLEAR-DAYS            PIC 9(4).
023330 01  WA-GLDM-OLD-IMAGE.
023340     03  FILLER                          PIC X(983).
023350/
023360 01  CH0000-CALL-AREA.
023370     COPY CH0000CA IN LIBRYMIS.
023380/
023390 01  UT1996CA-CALL-AREA.
023400     COPY UT1996CA IN LIBRYMIS.
023410/
023420     COPY UT1999CA IN LIBRYMIS.
023430/
023440     COPY UT0020CA IN LIBRYMIS.
023450/
023460     COPY UT0030CA IN LIBRYMIS.
023470/
023480     COPY UPTELLCA  IN LIBRYMIS.
023490     COPY UT0151CA  IN LIBRYMIS.
023500     COPY UT0152CA  IN LIBRYMIS.
023510/
B19392     COPY DLAYHERECA IN LIBRYMIS.
S17579 01  BR0009-LINKAGE.
S17579     COPY BR0009CA IN LIBRYBOR.
S17579/
023520 01  UT0069-LINKAGE.
023530*.................................................................
023540*        CALL-CODE:-AC 01 -USED TO INITIALISE INT MODULE         .
023550*                     02 -USED FOR TOTAL INTEREST CALCULATION   .
023560*                     03 -USED FOR INCREMENT CALCULATION ONLY   .
023570*                     04 -USED FOR INCR CALC AFTER INT CHARGING .
023580*        RET-STATUS:-00 -SUCCESSFUL                            .
023590*                     01 -UNSUCCESSFUL                          .
023600*        FUN-CODE:-   1 -NORMAL TRAN                           .
023610*                      2 -BACKDATED BEYOND LAST FIN. DATE       .
023620*                          (CR.AMT TOTALLY RECALCULATED)       .
023630*                      3 -BACKDATED BUT NOT BEYOND LAST FIN. DT .
023640*                          (AFFECT ON CR.AMT ONLY CALCULATED)  .
023650*                   NOTE -THIS FLAG IS SET BY INT MODULE        .
023660*                                                                .
023670*.................................................................
023680     COPY UT0069CA IN LIBRYBOR.
023690/
SC0367*01  DEPP-RECORD-AREA.                                                   
SC0367*    COPY DEPPARM IN LIBRYINV.
023720/
023730     COPY UT4001CA IN LIBRYMIS.
023740/
023750     COPY UT0093CA IN LIBRYMIS.
023760/
023770     COPY UT5001CA IN LIBRYMIS.
023780/
023790     COPY UT7300CA IN LIBRYTRE.
023800/
023810     COPY UT0681CA IN LIBRYMIS.
TB0023/
TB0023     COPY UT0683CA IN LIBRYMIS.
TB0023/
S17726 01  UT9002CA-CALL-AREA.
S17726     COPY UT9002CA IN LIBRYMIS.
S17726
S17726 01  WA-87000-ACTION                     PIC X(10) VALUE SPACES.
023830 01  WA-FLAGS.
023840   03  WA-NO-MORE-FLAG                   PIC X VALUE "N".
023850     88  WA-NO-MORE                      VALUE "Y".
023860   03  WA-ERROR-FLAG                     PIC X VALUE "N".
023870     88  WA-ERROR                        VALUE "Y".
023880   03  WA-FOUND-R-FLAG                   PIC X VALUE "N".
023890     88  WA-FOUND                        VALUE "Y".
023910 01  WA-GATEWAY-TRANCODE                 PIC X.
023920     88  WA-GATEWAY-TXNS                 VALUE "Y".
023940 01  ACFR-AREA.
023950     COPY ACFRMAST IN LIBRYMIS.
S19468 01  BLDV-AREA-PP.
S19468     COPY BLDVPP   IN LIBRYBOR.
TB0023 01  XFAR-AREA.
TB0023     COPY XFARMAST IN LIBRYMIS.
SC5203
SC5203 01  XPFM-AREA.
SC5203     COPY XPFMMAST IN LIBRYMIS.
SC5203
023970 01  TPPR-RECORD-AREA.
023980     COPY TPPRMAST IN LIBRYMIS.
024000     COPY UTTPPRCA IN LIBRYMIS.
024020 01 UT7400CA-CALL-AREA.
024030    COPY UT7400CA IN LIBRYTRE.
024040/
024050 01 UT7770CA-CALL-AREA.
024060    COPY UT7770CA IN LIBRYTRE.
024070/
024080     COPY BR0022CA IN LIBRYBOR.
024090******************************************************************
024100*
024110*    TRACKING FACILITY AND RELATED FUNCTIONS TRANSACTION CODES
024120*
024130*    INCLUDE ANYWHERE IN WORKING STORAGE
024140*
024150     COPY TRAK IN LIBRYBOR.
024160 01  TRAK-WORKS.
024170     03  TRAK-BINARY PIC S9999 BINARY VALUE 0.
024180     03  TRAK-ALPHA REDEFINES TRAK-BINARY.
024190         05  FILLER PIC X.
024200         05  TRAK-CHAR PIC X.
024210     03  TRAK-DISPLAY PIC 9999.
024220     03  TRAK-TRAN    PIC 99999.
024230/
024240 01  WA-IN0014-PASSALONG.
024250     COPY UT0014CA IN LIBRYBOR.
024260     03  IN0014-INPUT-MESSAGE.
024270         05  IN0014-INPUT-ACCT-NO        PIC 9(16).
024280         05  IN0014-INPUT-AMOUNT         PIC S9(14)V999
024290                                         SIGN TRAILING SEPARATE.
024300         05  IN0014-INPUT-FREQ           PIC 99.
024310         05  IN0014-INPUT-CODE           PIC X.
024320         05  IN0014-CHARGE-INDICATOR     PIC 9.
024330         05  IN0014-INPUT-CDATE          PIC 9(8).
024340         05  FILLER                      PIC X(8).
024350         05  IN0014-INPUT-RECACC-NO      PIC 9(17).
024360         05  IN0014-INPUT-REC-SYS        PIC X(3).
024370         05  IN0014-INPUT-COMMENTS       PIC X(25).
024380         05  FILLER                      PIC X(25).
024390         05  IN0014-INPUT-ADD-1          PIC X(40).
024400         05  FILLER                      PIC X(10).
024410         05  IN0014-INPUT-NAME           PIC X(32).
024420         05  IN0014-INPUT-INFORCE        PIC XXX.
024430         05  IN0014-INPUT-START-DATE     PIC 9(8).
024440*        05  IN0014-INPUT-BSB            PIC 9(6).                      
024450         05  FILLER                      PIC X(6).                      
024460         05  IN0014-SWEEP-TRANS          PIC X.
024470         05  IN0014-FROM-ACC-CURRENCY    PIC XXX.
024480         05  IN0014-INPUT-SEC-CODE       PIC 9(4).
024490         05  IN0014-INPUT-AMT-CCY       PIC XXX.
024500         05  IN0014-CHANGE-AMOUNT        PIC S9(14)V999
024510                                         TRAILING SEPARATE.
024520         05  IN0014-CHANGE-FREQ          PIC 99.
024530         05  IN0014-CHANGE-CODE          PIC X.
024540         05  IN0014-INPUT-PRIORITY       PIC 99.
024550         05  IN0014-SWEEP-TRANS-NO       PIC 9(6).
024560         05  FILLER                      PIC X(6).
024570         05  IN0014-TO-ACC-COMMENTS      PIC X(25).
024580         05  FILLER                      PIC X(19).
024590         05  IN0014-INSURANCE-TRANS      PIC X.
024600         05  IN0014-CHANGE-END-DATE      PIC 9(8).
024610         05  IN0014-TO-ACC-CURRENCY      PIC XXX.
024620         05  IN0014-INPUT-RECNME         PIC X(40).
024630         05  IN0014-INPUT-ADD-2          PIC X(40).
024640         05  IN0014-INPUT-ADD-3          PIC X(40).
024650         05  FILLER                      PIC X(106).
024660         05  IN0014-FROM-ACC-SYSTEM      PIC XXX.
024670         05  IN0014-INPUT-TDATE          PIC 9(8).
024680         05  IN0014-CHARGE-AMOUNT        PIC S9(14)V999
024690                                     SIGN TRAILING SEPARATE.
024700         05  FILLER                      PIC X(227).
024710         05  IN0014-INPUT-POST-CODE      PIC X(8).
024720*        05  FILLER                      PIC X(167).                    
024730         05  FILLER                      PIC X(90).                     
024740         05  IN0014-INPUT-BSB            PIC X(12).                     
024750         05  FILLER                      PIC X(65).                     
024770/
024780******************************************************************
024790*
024800*    OUTPUT AREA FOR TRANSACTIONS
024810*
024820******************************************************************
024830   02    IN0014-OUTPUT-MESSAGE.
024840*
024850     03  IN0014-OUTPUT-ERR-MSG-NO        PIC 9(4).
024860     03  IN0014-OUTPUT-MSG-LENGTH        PIC 9(4).
024870     03  IN0014-OUTPUT-MSG               PIC X(983).
024880*
024890     03  IN0014-OUTPUT-MSG-RR  REDEFINES IN0014-OUTPUT-MSG.
024900         05  IN0014-OUTPUT-DATA-SET      PIC X(4).
024910         05  IN0014-OUTPUT-STATUS        PIC X(4).
024920         05  FILLER                      PIC X(975).
024930   02    IN0014-BORM-RECORD-AREA.
024940     03  BORM-DATA-REC-WA                PIC X(983).
024950   02    IN0014-STATUS-LEVEL-1           PIC 99.
024960   02    IN0014-STATUS-LEVEL-2           PIC 99.
024970   02    IN0014-STATUS-LEVEL-3           PIC 99.
024980   02    IN0014-STATUS-LEVEL-4           PIC 99.
024990   02    IN0014-CHQ-CLEAR-DAYS           PIC 9(4).
025000   02    IN0014-NPB-CALL-CODE            PIC XX.
025010   02    FILLER                          PIC X(916).
025020/
025030/
025040 01      WA-SAVE-BORM-AREA               PIC X(983).
SC5130 01      WA-SAVE-UTVTAC-AREA             PIC X(200).
025050 01      SEC-KEY-AREA.
025060   03    SEC-SOC-NO                      PIC 999.
025070   03    SEC-KEY-NO                      PIC 9(16).
025080   03    FILLER                          PIC X(12).
025090 01      SEC-SYSTEM                      PIC X(8).
025100 01      SEC-STATUS                      PIC XXXX.
025110*
025120 01      UT0450-CALL-AREA.
025130         COPY UT0450CA IN LIBRYMIS.
025140*
025150/
025160 01      WA-PASSALONG.
025170     COPY PASALONG IN LIBRYMIS.
025180*
025190*
025200*NCR-SHARED-STORAGE SECTION.
025210 01  W100-DATE-FILE.
025220*     03  W100-DATE-TAB OCCURS 50 TIMES
025230* INCREASE SIZE OF W100-DATE-FILE TO OCCUR 120 TIMES
025240* (SIE YOU)
025250      03  W100-DATE-TAB OCCURS 120 TIMES
025260         INDEXED BY DATE-1.
025270         05  W100-DATE-MMYYYY            PIC 9(6).
B17951         05  W100-DATE-MMYYYY-R REDEFINES W100-DATE-MMYYYY.
B17951             07  W100-DATE-MM            PIC 9(2).
B17951             07  W100-DATE-YYYY          PIC 9(4).
025280         05  W100-BORR-TAX-SOY           PIC S9(9) BINARY.
025290         05  W100-BORR-TAX-EOY           PIC S9(9) BINARY.
025300         05  W100-DATE-SOP               PIC S9(9) BINARY.
025310         05  W100-DATE-EOY               PIC S9(9) BINARY.
025320         05  W100-DATE-BOM               PIC S9(9) BINARY.
025330         05  W100-DATE-EOM               PIC S9(9) BINARY.
025340         05  W100-NO-DAYS-YR             PIC S9(9) BINARY.
025350*        05  W100-BOR-SOP-RUN            PIC S9(9) BINARY.
025360         05  W100-NO-DAYS-MTH            PIC 9(2).
025370*
025380 01  W300-FILLER.
025390      03  FILLER                        PIC X(48) VALUE
025400          "013102280331043005310630073108310930103111301231".
025410 01  W300-DATE-R REDEFINES W300-FILLER.
025420      03  W300-PREV-DATE-TAB OCCURS 12 TIMES INDEXED BY
025430                         PREV-DATE.
025440          05  W300-DATE-MM             PIC 99.
025450          05  W300-DATE-MM-DAYS        PIC 99.
025460 01  WA-START-OF-DAY-FLAG                PIC 99 VALUE 0.
025470*01  WA-LNF-FLAG                         PIC 9  VALUE 0.
025480*NBG003
025490 01  BIRM-RECORD.
025500     COPY BIRM IN LIBRYBOR.
025510*
025520     COPY UT8500CA IN LIBRYMIS.
025530     COPY UT8500FU IN LIBRYMIS.
025540     COPY DBIOMODCA IN LIBRYMIS.
025550/
025560     COPY BBLC IN LIBRYBOR.
025570/
025580 01  DBIOMOD-RECORD2.
025590     COPY BSHR IN LIBRYBOR.
025600     COPY DBIOORAST IN LIBRYMIS.
025610/
025620     COPY DBIOMODNAME IN LIBRYMIS.
025630/
025640 01  BR0001-CALL-AREA.
025650     COPY BR0001CA IN LIBRYBOR.
025660/
TB0084 01  UT0094CA-CALL-PARAM.
TB0084     COPY UT0094CA IN LIBRYBOR.
TB0084/
TB0161 01  UT0073CA-CALL-AREA.
TB0161     COPY UT0073CA IN LIBRYBOR.
TB0161/
025670 01  UT0095CA-CALL-PARAM.
025680     COPY UT0095CA IN LIBRYBOR.
025690/
TB0096 01  WA-REASON-CODE-REC.
TB0096     COPY RSNCMAST IN LIBRYMIS.
TB0096/
TB0070     COPY BADDEBT  IN LIBRYBOR.
025710/
025720 01  WA-SAVE-INPUT-MSG            PIC X(983).
025730*
025740 01  WA-OTHER-SAVE-AREAS.
025750     COPY UT80010 IN LIBRYMIS.
025780     COPY     UT0909CA  IN  LIBRYMIS.
025800 01  CHECK-RESPONSE-AREA.                                                
025810     COPY CHECKRES IN LIBRYMIS.                                          
025820*
025830     COPY PBOOKCA IN LIBRYMIS                                            
025840     REPLACING ==(PBOOKCA)== BY ==PBOOKCA==.                             
TB0015*
TB0015 01  WS-SAVE-AREA.
TB0015     03  WS-UT0500RA-CUSM-STATUS-SAVE    PIC 999 VALUE 0.
TB0015         88  CUST-WHEREABOUTS-UNKNOWN    VALUE 1.
TB0015         88  CUST-IS-DECEASED            VALUE 2.
TB0015         88  CUST-IS-INACTIVE            VALUE 999.
TB0015     03  WS-SAVE-OUTPUT-MESSAGE.
TB0015         05  WS-SAVE-OUTPUT-ERR-MSG-NO   PIC 9999.
TB0015         05  WS-SAVE-OUTPUT-MSG-LENGTH   PIC 9999.
TB0015         05  WS-SAVE-OUTPUT-MSG          PIC X(983).
TB0027*
TB0027 01  BOIS-RECORD.
TB0027     COPY BOISMAST IN LIBRYBOR.
TB0027*
SC0375 01  CIEP-AREA.
SC0375     COPY CIEPMAST IN LIBRYCHG
SC0375          REPLACING ==(CIEP)== BY ==CIEP==.
SC0375
SC0375 01  UTCIEACA-CALL-PARAM.
SC0375     COPY UTCIEACA IN LIBRYCHG.
SC3491 01  UTCIEPCA-CALL-PARAM.
SC3491     COPY UTCIEPCA IN LIBRYCHG.
TB0096 01  UT0094-DATA OCCURS 10 TIMES.
TB0096     03 UT0094-INST-NO                  PIC 9(3).
TB0096     03 UT0094-ACCT-NO                  PIC 9(16).
TB0096     03 UT0094-TERM-NO                  PIC 9(4).
TB0096     03 UT0094-BUCKET-CODE              PIC X(2).
TB0096     03 UT0094-SEQUENCE-NO              PIC 9(4).
TB0096     03 UT0094-TXN-DATE                 PIC 9(9).
TB0096     03 UT0094-RECORD-STATUS            PIC 9(2).
TB0096     03 UT0094-TXN-IND                  PIC X.
TB0096     03 UT0094-TXN-AMT                  PIC S9(14)V999 COMP.
TB0096     03 UT0094-BASED-AMT                PIC S9(14)V999 COMP.
TB0096     03 UT0094-BASED-RATE               PIC S9(3)V9(4) COMP.
TB0096     03 UT0094-BASED-DAYS               PIC S9(5) COMP.
TB0096     03 UT0094-BASED-DATE               PIC S9(9) BINARY.
TB0096     03 UT0094-BASED-TO-DATE            PIC S9(9) BINARY.
TB0096     03 UT0094-ADJ-REASON-CODE          PIC X(4).
TB0096     03 FILLER                          PIC X(27).
TB0096*
ST0058     COPY UT1000CA IN LIBRYMIS.
ST0081 01  UTFACRCA-CALL-AREA.
ST0081     COPY UTFACRCA IN LIBRYMIS.
ST0081
ST0081 COPY UTFACOCA IN LIBRYMIS.
ST0081
ST0081 01  WA-DRAWDOWN-TYPE                    PIC X.
ST0081     88  WA-NEGATIVE-DRAWDOWN            VALUE "Y".
ST0081 01  WA-HDR-CUST-NO                      PIC 9(16).
ST0081 01  WA-PARENT-CIF-NO                    PIC 9(16) COMP.
ST0121 01  WA-BORM-ACT-TYPE.
ST0121     03  WA-BORM-ACT-TYPE-1-3            PIC 999.
ST0121         88 WA-ACT-TYPE-790              VALUE 790.
S16977         88 WA-ACT-TYPE-709              VALUE 709.
ST0121     03  WA-BORM-ACT-TYPE-4              PIC 9.
S11409 01  WA-BORM-ACT-TYPE-Y  REDEFINES WA-BORM-ACT-TYPE PIC 9999.
S11409         88 WA-ACT-TYPE-B-YB             VALUE 7301.
S15456 01  WA-BORM-ACT-TYPE-R  REDEFINES WA-BORM-ACT-TYPE.
S15456     03  WA-BORM-ACT-TYPE-1-1            PIC 9.
S15456         88 WA-ACT-TYPE-PERSONAL         VALUE 7.
S15456     03  WA-BORM-ACT-TYPE-2-4            PIC 9(3).
S16963 01  WA-BORM-ACT-TYPE-7  REDEFINES WA-BORM-ACT-TYPE.
S16963     03  WA-BORM-ACT-TYPE-1-2            PIC 99.
S16963         88 WA-ACT-TYPE-70-77            VALUE 70, 77.
S19468         88 WA-ACT-TYPE-71-73            VALUE 71
S19468                                               73.
S16963     03  WA-BORM-ACT-TYPE-3-4            PIC 99.
S20486 01  WA-BORM-ACT-TYPE-M  REDEFINES WA-BORM-ACT-TYPE.
S20486     03  WA-BORM-ACT-TYPE-2-M            PIC 9(02).
S20486         88 VALID-CAR-LOAN-M             VALUE 71.
S20486         88 VALID-SME-CAR-LOAN-M         VALUE 85.
S20486         88 VALID-HOUSE-LOAN-M           VALUE 70 72 77.
S20486     03  WA-BORM-ACT-TYPE-4              PIC 9(02).
S10229 01  WA-13540-PROMO-NO                   PIC XX.
S17306 01  WA-10732-RSN-CD                     PIC 9(4).
S17306     88 WA-BONUS-EXCHANGE                VALUE 36.
S17306 01  WA-20-CHQ-PAYEE.
S17306     03 WA-CONST-TEXT                    PIC X(6) VALUE "BONUS-".
S17306     03 WA-BONUS-TEXT                    PIC X(44).
S17197 01  WA-BR-NO                            PIC 9(4).
S17197     88 WA-ACCOUNT-SERVICE-CENTER        VALUE 0622.
S18365 01  WA-CAR-LOAN                         PIC X(01).
S18365     88  WA-CAR-LOAN-0                   VALUE "Y".
S18365 01  WA-BASED-AMT                        PIC S9(14)V999 COMP.
S19220 01  WS-BASED-RATE                       PIC S99V9999.
S19220 01  WA-COMML-HOUSE-IND                  PIC X(01).
S19220     88  WA-COMML-HOUSE                  VALUE "Y".
B17951 01 WS-DISP-FILE                         PIC X(4) VALUE SPACE.
B17951 01  ONPARAM-REC.
B17951     COPY DTEPMAST IN LIBRYMIS
B17951     REPLACING ==(DTEP)== BY ==DATE==.
025860 LINKAGE SECTION.
025880 01  UT0008CA-CALL-AREA.                                                 
025890     COPY UT0008CA IN LIBRYMIS                                           
025900     REPLACING ==(UT0008CA)== BY ==BR0000==.                             
025920 01  STARTAREA.
025930     COPY STRTAREA IN LIBRYMIS.
025940     03  WA-INPUT-MSG.
025950         05  WA-INPUT-KEY.
025960             07  WA-INPUT-ACCT-NO        PIC 9(16).
025970         05  WA-INPUT-KEY-R REDEFINES WA-INPUT-KEY    PIC 9(16).
025980         05  FILLER  REDEFINES  WA-INPUT-KEY.
025990           07  FILLER                    PIC XXX.
026000           07  WA-INPUT-KEY-BRANCH       PIC 9999.
026010           07  FILLER                    PIC X(9).
026020         05  WA-INPUT-AMT            PIC S9(14)V999
026030                                     SIGN IS TRAILING SEPARATE.
026040         05  FILLER                      PIC X(267).
026050         05  WA-ATM-JRNL-NO              PIC 9(6).
026060         05  WA-ATM-UPDT-FLAG            PIC X.
026070         05  WA-OUTPUT-TXN-DATE          PIC XX.
026080         05  WA-OUTPUT-CLEAR-CODE        PIC XX.
026090         05  FILLER                      PIC X(658).
026100         05  WA-INPUT-MSG-CODE           PIC 99.
026110         05  FILLER                      PIC X(10).
SC4465*----*
SC4465     03 FILLER  REDEFINES WA-INPUT-MSG.
SC4465         05  FILLER                      PIC X(655).
SC4465         05  WA-RISK-LEVEL               PIC X(3).
SC4465         05  WA-BANCS-ID-TRF-ACCT        PIC 9(3).
SC4465         05  WA-ACCT-NO-TRF-IN           PIC 9(17).
SC4465         05  WA-ATM-TRACE-NO             PIC X(10).
SC4465         05  WA-SETTLEMENT-DATE          PIC 9(8).
SC4465         05  WA-FISC-TXN-CODE            PIC 9(4).
SC4465         05  WA-BANCS-ID-FROM-ACCT       PIC 9(3).
SC4465         05  FILLER                      PIC X(279).
SC4465*----*
SC4522     03  FEDI-11X45-11X55  REDEFINES WA-INPUT-MSG.
SC4522         05  FILLER                       PIC X(605).    
SC4522         05  NARRATIVE-11045              PIC X(50).
SC6541         05  NARRATIVE-16048 REDEFINES NARRATIVE-11045.
SC6541             10 FILLER                    PIC X(13).
SC6541             10 NARRA-16048               PIC X(37).
SC4522         05  FILLER                       PIC X(36).
SC4522         05  VAL-FLG-11045                PIC X.
SC4522         05  VAL-FIELD1-11045             PIC X(30).
SC4522         05  VAL-FIELD2-11045             PIC X(30).
SC4522         05  NET-RECEIVABLE-11045         PIC 9(6).
SC4522         05  NET-RECEIVED-11045           PIC 9(6).
SC4522         05  CHARGE-TYPE-11045            PIC X.
SC4522         05  DEP-ACCT-PSWD-11045          PIC X(4).
SC4522         05  BP-GL-TXN-FLAG               PIC X.
SC4522         05  BP-GL-SYSTEM                 PIC X(3).
SC4522         05  BP-GL-ORIG-ACCT              PIC X(16).
SC5378         05  FEDI-TO-TXN-AMT              PIC S9(14)V999.
SC5378         05  FILLER                       PIC X(176).            
SC4522     03  FEDI-11030-11130  REDEFINES WA-INPUT-MSG.
SC4522         05  FILLER                       PIC X(694).
SC4522         05  VAL-FLG-11030                PIC X.
SC4522         05  VAL-FIELD1-11030             PIC X(30).
SC4522         05  VAL-FIELD2-11030             PIC X(30).
SC4522         05  FILLER                       PIC X(227).
SC4522     03  FEDI-11050-11150  REDEFINES WA-INPUT-MSG.
SC4522         05  FILLER                       PIC X(694).
SC4522         05  VAL-FLG-11050                PIC X.
SC4522         05  VAL-FIELD1-11050             PIC X(30).
SC4522         05  VAL-FIELD2-11050             PIC X(30).
SC4522         05  HAND-RECEIVABLE-11050        PIC 9(6).
SC4522         05  HAND-RECEIVED-11050          PIC 9(6).
SC4522         05  NET-RECEIVABLE-11050         PIC 9(6).
SC4522         05  NET-RECEIVED-11050           PIC 9(6).
SC4522         05  CHARGE-TYPE-11050            PIC X.
SC4522         05  FILLER                       PIC X(202).
TB0267     03  FILLER REDEFINES WA-INPUT-MSG.
TB0267*        05  FILLER                      PIC X(52).
TB0267         05  FILLER                      PIC X(35).
TB0267         05  WS-CORRECTION-JRNL-NO       PIC 9(6).
TB0267         05  FILLER                      PIC X(941).
026120     03  WA-LOAN-DELETE REDEFINES WA-INPUT-MSG.
026130         05  WA-DEL-INT-RATE             PIC 99V99.
026140         05  FILLER                      PIC X(978).
026150     03  WA-TRFR-TO-LON-ACCT REDEFINES WA-INPUT-MSG.
026160         05  FILLER                      PIC X(54).
026170         05  WA-LON-ACCT-NO              PIC X(16).
026180         05  FILLER                      PIC X(912).
NLB205     03  FILLER REDEFINES WA-INPUT-MSG.
NLB205         05  FILLER                      PIC X(54).
NLB205         05  WA-LON-ACCT-17              PIC X(17).
NLB205         05  FILLER                      PIC X(911).
026230     03  WA-LOAN-FUNDS REDEFINES WA-INPUT-MSG.
026240         05  FILLER                      PIC 9(10).
026250         05  WA-LOAN-AMOUNT              PIC S9(14)V999
026260                                         TRAILING SEPARATE.
026270         05  WA-INT-RATE                 PIC 99V99.
026280         05  FILLER                      PIC X(950).
SC1171     03  WA-OFFSYS-REPAY     REDEFINES WA-INPUT-MSG.
SC1171         05  WA-OS-REPAY-KEY.
SC1171             07  WA-OS-REPAY-INP-ACCT-NO    PIC 9(16).
SC1171         05  WA-OS-REPAY-AMOUNT             PIC S9(14)V999
SC1171             SIGN IS TRAILING SEPARATE.
SC1171         05  WA-OS-REPAY-MORTGAGE           PIC 9.
SC1171         05  WA-OS-REPAY-SUB-LEDG-CODE      PIC 99.
SC1171         05  WA-OS-REPAY-PROMO              PIC XX.
SC1171         05  WA-OS-REPAY-TXN-DATE           PIC 9(8).
SC1171         05  FILLER                         PIC 9(17).
SC1171         05  WA-OS-REPAY-DEP-ACCT-NO        PIC 9(16).
SC1171*SC4755  05  FILLER                         PIC X(901).
SC4755*SC9775  05  FILLER                         PIC X(883).
SC9775         05  FILLER                         PIC X(865).
SC9775         05  WA-OS-INT-DUE-AMOUNT           PIC S9(14)V999
SC9775             SIGN IS TRAILING SEPARATE.
SC4755         05  WA-OS-MIN-DUE-AMOUNT           PIC S9(14)V999
SC4755             SIGN IS TRAILING SEPARATE.
SC1171         05  WA-OS-REPAY-FLAG               PIC X.
026290*********************  REPAYMENT  TYPE  TRANSACTIONS  ************
026300******************************************************************
026310     03  WA-REPAY-INPUT-MESSAGE REDEFINES WA-INPUT-MSG.
026320         05  WA-REPAY-INPUT-KEY.
026330             07  WA-REPAY-INPUT-ACCT-NO    PIC 9(16).
026340         05  WA-REPAY-AMOUNT               PIC S9(14)V999
026350             SIGN IS TRAILING SEPARATE.
026360         05  WA-REPAY-MORTGAGE             PIC 9.
026370         05  WA-REPAY-SUB-LEDG-CODE        PIC 99.
026380         05  WA-REPAY-PROMO                PIC XX.
026390         05  WA-REPAY-TXN-DATE             PIC 9(8).
TB0212         05  FILLER REDEFINES WA-REPAY-TXN-DATE.
TB0212             07 W800-DD                  PIC 9(2).
TB0212             07 W800-MM                  PIC 9(2).
TB0212             07 W800-CC                  PIC 9(2).
TB0212             07 W800-YY                  PIC 9(2).
026400         05  WA-REPAY-CLEAR-CODE           PIC XX.
026410         05  WA-REPAY-BANK-NUMBER          PIC X(4).
026420         05  WA-REPAY-REGION-ID            PIC X(4).
026430         05  WA-REPAY-ITEMS                PIC 999.
026440         05  WA-REPAY-DEFER-DAYS           PIC 99.
TB0099         05  WA-REPAY-PRIN-RECALC          PIC X.
TB0099             88 WA-VALID-PRIN-RECALC       VALUE "0" "1" "2".
SC4506*S11604  05  FILLER                        PIC X(3).
S11604         05  FILLER                        PIC X.
SC4506         05  BR0023-DEP-ACC-NO             PIC 9(16).
S15788         05  BR0023-PCC-CODE             PIC X(06).
S15788         05  FILLER                      PIC X(148).
SC4506*S11604  05  FILLER                        PIC X(152).
S15788*S11604         05  FILLER                        PIC X(154).
SC4506*        05  FILLER                        PIC X(171).
SC2159         05  WA-REPAY-TRACER-NO            PIC 9(6).
SC3109         05  FILLER                        PIC X(2).
SC3109         05  BR0023-PRIN-PEN-IND           PIC X.
SC3109         05  BR0023-PENALTY-AMT            PIC S9(14)V999
SC3109             SIGN IS TRAILING SEPARATE.
SC3109         05  BR0023-WAIVE-AMT              PIC S9(14)V999
SC3109             SIGN IS TRAILING SEPARATE.
SC4506         05  BR0023-DUE-AMT                PIC S9(14)V999
SC4506             SIGN IS TRAILING SEPARATE.
SC4506         05  BR0023-REASON-CODE            PIC 9(4).
S15241         05  FILLER                        PIC X(12).
S15241         05  BR0023-AUTH-ID                PIC X(16).
S15241         05  FILLER                        PIC X(653).
S15241*SC4506         05  FILLER                        PIC X(681).
SC4506*        05  FILLER                        PIC X(703).
SC2159*        05  FILLER                        PIC X(742).
SC2159**       05  FILLER                        PIC X(919).
TB0099*         05  FILLER                        PIC X(920).
S10982     03  WA-11049-INPUT-MSG REDEFINES WA-INPUT-MSG.
S10982         05  FILLER                        PIC X(80).
S10982         05  WA-11049-SRN-NO               PIC 9(12).
S10982         05  WA-11049-ACCTNOCHQNO          PIC 9(16).
S10982         05  FILLER                        PIC X(134).
S10982         05  WA-11049-NARR                 PIC X(50).
S10982         05  WA-11049-NAME-1               PIC X(30).
S10982         05  FILLER                        PIC X(660).
026460******************  ADVANCE  TYPE  TRANSACTIONS  *****************
026470******************************************************************
026480     03  WA-ADV-INPUT-MSG REDEFINES WA-INPUT-MSG.
026490         05  WA-ADV-ACCT-NO                PIC 9(16).
026500         05  WA-ADV-AMOUNT                 PIC S9(14)V999
026510                                           TRAILING SEPARATE.
026520         05  WA-ADV-MORTGAGE-NO            PIC X.
026530         05  WA-ADV-SUB-LEDG-CODE          PIC 99.
026540         05  WA-ADV-PROMO                  PIC XX.
026550         05  WA-ADV-TXN-DATE               PIC 9(8).
026560         05  WA-ADV-CHQ-NO                 PIC 9(8).
026570         05  WA-ADV-NAMES.
026580             07  WA-ADV-NAME-1             PIC X(30).
026590             07  WA-ADV-NAME-1-R REDEFINES WA-ADV-NAME-1.
026600                 09  WA-ADV-1ST-BYTE       PIC X.
026610                 09  FILLER                PIC X(29).
026620             07  WA-ADV-NAME-2             PIC X(30).
026630         05  WA-DEP-ACCT-TRF REDEFINES WA-ADV-NAMES.                      
026640             07  FILLER                    PIC X(9).
026650             07  WA-DEP-ACCT-NO            PIC 9(16).
026660*            07  WA-DEP-ACCT-CKD           PIC 9.
026670             07  FILLER                    PIC X(35).
026680         05  WA-ADV-LOC REDEFINES WA-ADV-NAMES.
026690             07  WA-ADV-LOC-ACCT-NO        PIC 9(16).
026700             07  WA-ADV-INV-ACCT-NO        PIC 9(16).
026710             07  WA-ADV-ID-NO              PIC X(15).
026720             07  WA-ADV-ACCT-TYPE          PIC 9(4).
026730             07  WA-ADV-INT-CAT            PIC 9(4).
026740             07  WA-ADV-TERM               PIC 9(4).
026750             07  FILLER                    PIC X.
026760         05  WA-ADV-LOC-CORR REDEFINES WA-ADV-NAMES.
026770             07  WA-CORR-LOC-ACCT          PIC 9(16).
026780             07  FILLER                    PIC X(44).
026790         05  WA-ACT-FEE                    PIC S9(14)V999
026800                                               TRAILING SEPARATE.
026810         05  WA-AVAIL-AMT                  PIC S9(14)V999
026820                                               TRAILING SEPARATE.
SC0367         05  FILLER                       PIC X(544).
SC0367         05  WA-DEP-ACCT-PSWD             PIC X(4).
S11455         05  FILLER                        PIC X(66). 
S11455         05  WA-ADV-AMORT-TERM             PIC 9(2).  
S11455         05  WA-ADV-AMORT-FLAG             PIC X(1).  
S11455         05  WA-ADV-AMORT-JRNL-NO          PIC 9(6).  
S11455         05  FILLER                        PIC X(208).
SC0367*S11455  05  FILLER                       PIC X(283).
026830*        05  FILLER                       PIC X(831).
026840********** MULTI CURRENCY REPAYMENT & ADVANCE NEW FIELDS *********
026850******************************************************************
026860     03  WA-MULTI-CURRENCY-NEW-FIELDS REDEFINES WA-INPUT-MSG.
026870         05  FILLER                        PIC X(150).
026880         05  WA-MULTI-ACCT-CURR-CD         PIC XXX.
026890         05  WA-MULTI-CURR-AMT             PIC S9(14)V999
026900                                               TRAILING SEPARATE.
026910         05  WA-MULTI-CURR-AMT-CURR-CD     PIC XXX.
026920         05  WA-MULTI-BASE-CURR-AMT        PIC S9(14)V999
026930                                               TRAILING SEPARATE.
026940         05  WA-MULTI-COMMISSION           PIC S9(14)V999
026950                                               TRAILING SEPARATE.
026960         05  WA-MULTI-CHANGE               PIC S9(14)V999
026970                                               TRAILING SEPARATE.
026980         05  WA-MULTI-RATE-TYPE            PIC 99.
026990         05  WA-MULTI-CURR-VERSION         PIC XXXX.
027000         05  WA-MULTI-CORR-JRNL-NO         PIC 9(6).
027010         05  FILLER                        PIC X(742).
027020     03  WA-APPR-INPUT-MSG REDEFINES WA-INPUT-MSG.
027030         05  WA-APP-ACCT-NO                PIC 9(16).
027040         05  WA-APP-AMOUNT                 PIC S9(14)V999
027050                                               TRAILING SEPARATE.
027060         05  WA-APP-MORTGAGE-NO            PIC 9.
027070         05  WA-APP-SUB-LEDG-CODE          PIC 99.
027080         05  WA-APP-PROMO                  PIC XX.
027090         05  WA-APP-TXN-DATE               PIC 9(8).
027100         05  FILLER                        PIC X(935).
027110     03  WA-CANC-INPUT-MSG REDEFINES WA-INPUT-MSG.
027120         05  WA-CANC-ACCT                  PIC 9(16).
027130         05  WA-CANC-REAS-CODE             PIC 99.
027140         05  WA-CANC-REASON                PIC X(15).
027150         05  WA-CANC-SUB-LEDG-CODE         PIC 99.
S11773         05  WA-CANC-CLOSE-IND             PIC X.
S11773         05  WA-CANC-NEW-ID-TYPE           PIC 9(02).
S11773         05  WA-CANC-NEW-ID                PIC X(10).
S11773         05  WA-CANC-PROC-NO               PIC X(25).
S15519         05  WA-LOANER-PROC-NO-R REDEFINES WA-CANC-PROC-NO.
S15519             07  WA-LOANER-PROC-SIGN-DAY     PIC X(7).
S15519             07  WA-LOANER-PROC-SIGN-DAY-R REDEFINES
S15519                 WA-LOANER-PROC-SIGN-DAY.
S15519                 09  WA-LOANER-PROC-SIGN-YYY PIC 9(3).
S15519                 09  WA-LOANER-PROC-SIGN-MM  PIC 9(2).
S15519                 09  WA-LOANER-PROC-SIGN-DD  PIC 9(2).
S15519             07  WA-LOANER-PROC-LOTNO        PIC X(1).
S15519             07  WA-LOANER-PROC-TYPE         PIC X(1).
S15519             07  WA-LOANER-PROC-DATE         PIC X(5).
S15519             07  WA-LOANER-PROC-DATE-R REDEFINES
S15519                 WA-LOANER-PROC-DATE.
S15519                 09  WA-LOANER-PROC-DATE-YYY PIC 9(3).
S15519                 09  WA-LOANER-PROC-DATE-MM  PIC 9(2).
S15519             07  WA-LOANER-PROC-TRF-DATE     PIC X(5).
S15519             07  WA-LOANER-PROC-TRF-DATE-R REDEFINES
S15519                 WA-LOANER-PROC-TRF-DATE.
S15519                 09  WA-LOANER-PROC-TRF-YYY  PIC 9(3).
S15519                 09  WA-LOANER-PROC-TRF-MM   PIC 9(2).
S15519             07  WA-LOANER-PROC-FILLER       PIC X(6).
S15519         05  WA-CANC-REPAY-SOURCE          PIC X.
S15519         05  FILLER                        PIC X(908).
S15519*S11773  05  FILLER                        PIC X(909).
027160*S11773  05  FILLER                        PIC X(947).
027170     03  WA-FREE-MSG REDEFINES WA-INPUT-MSG.
027180         05  WA-MSG-ACNO                   PIC 9(16).
027190         05  WA-MSG-NO                     PIC 99.
027200         05  WA-MSG-TEXT                   PIC X(18).
027210         05  WA-MSG-JRNL-NO                PIC 9(6).
027220         05  FILLER                        PIC X(940).
027230     03  WA-CORR-TRAN REDEFINES WA-INPUT-MSG.
027240         05  FILLER                        PIC X(234).
027250         05  WA-TRE-ACNO                   PIC 9(06).
027260         05  FILLER                        PIC X(742).
027270     03  WA-INPUT-DISCH-MSG REDEFINES WA-INPUT-MSG.
027280         05  WA-DISCH-I-ACCT-NO                PIC 9(16).
027290         05  WA-DISCH-I-TRAN-130X0.
027300             07  WA-DISCH-I-AMOUNT             PIC S9(14)V999
027310                                           TRAILING SEPARATE.
027320             07  WA-DISCH-I-SUB-LEDG-CODE      PIC 99.
027330             07  WA-DISCH-I-CHQ-CLEAR-CODE     PIC XX.
027340             07  FILLER                        PIC X(6).
027350         05  WA-DISCH-I-ENQUIRY-TRAN-13000
027360                 REDEFINES WA-DISCH-I-TRAN-130X0.
027370             07  FILLER                        PIC X(18).
027380             07  WA-DISCH-I-QUOTE-EXPIRY-DATE  PIC 9(8).
027390             07  WA-DISCH-I-SAVE-QUOTE-FLAG    PIC X.
027400             07  WA-DISCH-I-LOC-CODE           PIC X.
027410         05  WA-DISCH-I-ALL-TRANS.
027420             07  WA-DISCH-I-WAIVE-PENALTY-FLAG PIC X.
027430             07  WA-DISCH-I-INT-REBATE-PERC    PIC 9(3).
027440             07  WA-DISCH-I-TRAN-DATE          PIC 9(8).
S12786             07  FILLER REDEFINES WA-DISCH-I-TRAN-DATE.
S12786                 10 WA-DISCH-DD                PIC 9(2).
S12786                 10 WA-DISCH-MM                PIC 9(2).
S12786                 10 WA-DISCH-CC                PIC 9(2).
S12786                 10 WA-DISCH-YY                PIC 9(2).
027450             07  WA-DISCH-I-PROMO-CODE         PIC XX.
027460             07  FILLER                        PIC X(6).
027470*ADDING DEPOSIT ACCT FOR DISCH VIA TRANFER
027480         05  WA-DEP-TRF-ACCT-NO                PIC X(16).
027490*        05  WA-DEP-TRF-ACCT-CKD               PIC 9.
TB0102**** FSLON0014 - TIB Specs. for Discharge
TB0102         05  FILLER                            PIC X.
TB0102         05  WA-DISCH-I-JRNL-NO                PIC 9(7).
TB0102         05  WA-DISCH-I-REASON.
TB0102             07  WA-DISCH-I-REASON-CD          PIC XX.
TB0102         05  WA-DISCH-I-INT-BUCKET             PIC S9(14)V99.
TB0102         05  WA-DISCH-I-LOAN-BAL               PIC S9(14)V99.
027500*REDUCING FILLER FROM 924 TO 907
027510*        05  FILLER                            PIC X(902).
TB0102         05  FILLER                            PIC X(860).
S18413     03  WA-14041-FIELDS REDEFINES WA-INPUT-MSG.
S18413         05  FILLER                        PIC X(655).
S18413         05  WA-14041-ATM-INFO             PIC X(33).
S18413         05  FILLER                        PIC X(11).
S18413         05  WA-14041-LOANER-DATA          PIC X(38).
S18413         05  WA-14041-REPAY-SOURCE         PIC X(1).
S18413         05  FILLER                        PIC X(244).
S18413     03  WA-14028-FIELDS REDEFINES WA-INPUT-MSG.
S18413         05  FILLER                        PIC X(234).
S18413         05  WA-14028-LOANER-DATA          PIC X(38).
S18413         05  WA-14028-REPAY-SOURCE         PIC X(1).
S18413         05  FILLER                        PIC X(332).
S18413         05  WA-14028-ATM-INFO             PIC X(74).
S18413         05  FILLER                        PIC X(303).
S16235     03  WA-13047-INPUT-MSG REDEFINES WA-INPUT-MSG.
S16235         05  FILLER                        PIC X(292).
S16235         05  WA-13047-NAME-1               PIC X(30).
S16235         05  WA-13047-SRN-NO               PIC 9(12).
S16235         05  WA-13047-ACCTNOCHQNO          PIC X(16).
S16235         05  WA-13047-NARR                 PIC X(50).
S16235         05  FILLER                        PIC X(582).
027520     03  WA-ADJUSTMENTS REDEFINES WA-INPUT-MSG.
027530         05  WA-ADJ-ACCT-NO              PIC 9(16).
027540         05  WA-ADJ-AMT                  PIC S9(14)V999
027550                                         TRAILING SEPARATE.
027560         05  WA-ADJ-MORTGAGE-NO          PIC 9.
027570         05  WA-ADJ-SUB-LEDG-CODE        PIC 99.
027580         05  WA-ADJ-PROMO                PIC XX.
027590         05  WA-ADJ-TXN-DATE             PIC 9(8).
TB0096         05  WA-ADJ-WAIVE                PIC X.
TB0096         05  FILLER                      PIC X(934).
027600*        05  FILLER                      PIC X(935).
027610     03  WA-PROP-DET-INPUT REDEFINES WA-INPUT-MSG.
027620         05  WA-PROP-MEMB-NO             PIC 9(16).
027630         05  WA-PROP-COST                PIC S9(14)V999 TRAILING
027640                                         SEPARATE.
027650         05  WA-PROP-VAL                 PIC S9(14)V999
027660                                         TRAILING SEPARATE.
027670         05  WA-LATEST-VAL               PIC S9(14)V999
027680                                         TRAILING SEPARATE.
027690         05  WA-VALUE-DATE               PIC 9(8).
027700         05  WA-LAST-VALUE               PIC 9(8).
027710         05  WA-PURCHASE-DATE            PIC 9(8).
027720         05  WA-PROP-AGE                 PIC 99.
027730         05  WA-CONSTR-CODE              PIC 9.
027740         05  WA-COUNCIL-CODE             PIC 9.
027750         05  WA-ORIG-LVR                 PIC 999V99.
027760         05  WA-LATEST-LVR               PIC 999V99.
027770         05  FILLER                      PIC X(874).
027780     03  WA-INCOME-DET-INPUT REDEFINES WA-INPUT-MSG.
027790         05  WA-INCOME-MEMB-NO           PIC 9(16).
027800         05  WA-INCOME-1                 PIC S9(14)V999
027810                                         TRAILING SEPARATE.
027820         05  WA-INCOME-2                 PIC S9(14)V999
027830                                         TRAILING SEPARATE.
027840         05  WA-BIRTH-DATE-1             PIC 9(8).
027850         05  WA-BIRTH-DATE-2             PIC 9(8).
027860         05  FILLER                      PIC X(914).
027870     03  WA-INSURANCE-DET-INPUT REDEFINES WA-INPUT-MSG.
027880         05  WA-INSU-MEMB-NO             PIC 9(16).
027890         05  WA-INSU-COVER               PIC S9(14)V999
027900                                         TRAILING SEPARATE.
027910         05  WA-INSU-DUE                 PIC S9(14)V999
027920                                         TRAILING SEPARATE.
027930         05  WA-INSU-CO                  PIC XX.
027940         05  WA-POLICY-TYPE              PIC XX.
027950         05  WA-INSU-DUE-DATE            PIC 9(8).
027960         05  WA-POLICY-NO                PIC X(10).
027970         05  WA-MPI-MORT-INSU-CDE        PIC X.
027980         05  FILLER                      PIC X(907).
027990******************************************************************
028000*    THE FOLLOWING DETAILS HAVE BEEN ADDED TO CATER FOR
028010*    THE MORTGAGE TRACKING FACILITY
028020**********  SCREEN    12000      *********************************
028030     03  WA-MORT-TR-NEW-ACCT REDEFINES WA-INPUT-MSG.
TB0169***-- start new 12000 / 17000 screen format
028040         05  WA-TR-NEW-ACCT-NO             PIC 9(16).
TB0008         05  WA-TR-NER-ACCT-NO-R REDEFINES WA-TR-NEW-ACCT-NO.
TB0117             07 ACCT-NO-SPACE              PIC 9(2).
TB0117             07 ACCT-NO-BRANCH-MAIN.
TB0117                09 ACCT-NO-FIRST           PIC 9(1).
TB0117                   88 ACCT-NO-FIRST-2      VALUE 2.
TB0117                09 ACCT-NO-BRANCH          PIC 9(3).
TB0117             07 ACCT-NO-TYPE               PIC 9(2).
TB0117             07 ACCT-SERIES                PIC 9(8).
028050         05  WA-TR-NA-CUSTOMER-NO          PIC 9(16).
028060         05  WA-TR-NA-INPUT-ID             PIC X(16).
028070         05  WA-TR-NA-NAME-1               PIC X(60).
TB0169         05  WA-TR-NA-PROD-NAME            PIC X(20).
TB0169         05  WA-TR-NA-BUS-DEP-SUPV         PIC X(11).
TB0169         05  WA-TR-NA-BUS-SALES-ID         PIC X(11).
TB0169         05  WA-TR-NA-TIB-ACCT-IND         PIC X(1).
TB0069         05  WA-TR-NA-APPROVAL-DATE        PIC 9(8).
TB0069         05  WA-TR-NA-MATURITY-DATE        PIC 9(8).
TB0169         05  WA-TR-NA-COST-OF-FUND         PIC 9(1).
028190         05  WA-TR-NA-PURPOSE              PIC 9(2).
TB0169         05  FILLER                        PIC X(2).
TB0069         05  WA-TR-NA-INT-RATE-N           PIC S999V9(4)
TB0069                                           TRAILING SEPARATE.
028520         05  WA-TR-NA-RT-INCR              PIC S99V9(5)
028530                                           TRAILING SEPARATE.
TB0169         05  WA-TR-NA-RATE-EXP             PIC 9(8).
TB0069         05  WA-TR-NA-NEGO-RATE-IND        PIC X(1).
028230         05  WA-TR-NA-LOAN-TERM            PIC 9(4).
013680         05  WA-TR-NA-TERM-BASIS           PIC X(1).
013760         05  WA-TR-NA-REPAY-DAY            PIC 99.
013770         05  WA-TR-NA-REPAY-FREQ           PIC 99.
TB0069         05  WA-TR-NA-REPAY-SCHED          PIC X(1).
028220         05  WA-TR-NA-APPLN-DATE           PIC 9(8).
028200         05  WA-TR-NA-APPLN-AMT            PIC S9(14)V999
028210                                           TRAILING SEPARATE.
TB0104         05  WA-TR-NA-SO-AUTO-DBT-ACCNO    PIC 9(17).
TB0082         05  WA-TR-NA-COLL-REQD-FL         PIC X(1).
TB0082         05  WA-TR-NA-COLLATERAL-NO        PIC 9(17).
TB0169         05  WA-TR-NA-DUE-DTE-IND          PIC X(1).
TB0169*TB0020  05  WA-TR-NA-CRE-TYPE             PIC 9(1).
TB0020         05  WA-TR-NA-CRE-TYPE             PIC X(1).
TB0169         05  WA-TR-NA-PROJ-ID              PIC X(8).
TB0082         05  WA-TR-NA-FST-DRAWDOWN-LENGTH  PIC 9(4).
TB0069         05  WA-TR-NA-STRETCH-TERM         PIC 9(4).
TB0101         05  WA-TR-NA-GRACE-PERIOD         PIC 9(4).
TB0169         05  WA-TR-NA-COST-RATE            PIC S9(3)V9(4)
TB0169                                         TRAILING SEPARATE.
TB0169         05  FILLER                        PIC X(6).
028150         05  WA-TR-NA-TYPE                 PIC 9(4).
028160         05  WA-TR-NA-TYPE-R    REDEFINES WA-TR-NA-TYPE
028170                                           PIC X(4).
028180         05  WA-TR-NA-INT-CAT              PIC 9(4).
TB0169         05  WA-TR-NA-COST-RATE-ID         PIC X(4).
TB0169         05  WA-TR-NA-COST-CODE            PIC X(4).
TB0069         05  WA-TR-NA-REMIT-SLIP-IND       PIC X(1).
TB0069         05  WA-TR-NA-REPAY-RCPT-IND       PIC X(1).
TB0169         05  WA-TR-NA-SER-FILED-DOC        PIC X(14).
TB0082         05  WA-TR-NA-COLL-MULTI-FL        PIC X(1).
TB0023         05  WA-TR-NA-FAC-REF-CODE         PIC 9(8).
TB0023         05  WA-TR-NA-FST-DRAWDOWN-PERIOD  PIC 9(8).
TB0076         05  WA-TR-NA-DUE-RCLC-IND         PIC X(1).
TB0076         05  WA-TR-NA-EFR-CHG-IND          PIC X(1).
TB0143         05  WA-TR-NA-FACILITY-NO.
TB0143             07 WA-TR-NA-FAC-NO-16         PIC 9(16).
TB0143             07 WA-TR-NA-FAC-CHK-DGT       PIC 9.
TB0169         05  WA-TR-NA-COST-EXP             PIC 9(8).
TB0169         05  WA-TR-NA-PROJ-CODE            PIC X(4).
TB0169         05  WA-TR-NA-LOAN-CLASS           PIC X.
TB0169         05  FILLER                        PIC X(8).
028320         05  WA-TR-NA-NOTICE-CUST-NO       PIC 9(16).
TB0169         05  FILLER                        PIC X(11).
028410         05  WA-TR-NA-INSU-CUST            PIC 9(16).
TB0169         05  WA-TR-EXPOSURE-NO        PIC 9(17).
TB0169         05  WA-TR-BREAKDOWN          PIC X(12).
TB0169         05  WA-TR-EXPOSURE-2-3 OCCURS 2.
TB0169             07  WA-TR-EXPOSURE-NOX   PIC 9(17).
TB0169             07  WA-TR-BREAKDOWNX     PIC X(12).
TB0169         05  WA-TR-CAR-REGIS-RETURN OCCURS 3.
TB0169             07  WA-TR-CAR-REGIS-RET  PIC X.
TB0169               88 CAR-REGIS-RETURNED     VALUE "1".
S12060         05  WA-TR-NA-OLD-COLL-NO          PIC 9(17).
S12060         05  WA-TR-NA-COST-BASE-ID         PIC X(4).
S12060         05  WA-TR-NA-REAL-BR-NO           PIC X(4).
S12060         05  WA-TR-NA-STATEMENT-FREQUENCY  PIC X.
S12060             88 WA-TR-NA-SF-VALID-STMT-FREQ
S12060                                           VALUE "N" "S" "P"
S12060                                                 "D" "W" "F"
S12060                                                 "T" "M" "Q"
S12060                                                 "H" "Y" " ".
S12060             88 WA-TR-NA-SF-NO-STATEMENT   VALUE "N".
S12060             88 WA-TR-NA-SF-STATEMENT-FULL VALUE "S".
S12060             88 WA-TR-NA-SF-END-OF-PERIOD  VALUE "P".
S12060             88 WA-TR-NA-SF-DAILY          VALUE "D".
S12060             88 WA-TR-NA-SF-WEEKLY         VALUE "W".
S12060             88 WA-TR-NA-SF-FORTNIGHTLY    VALUE "F".
S12060             88 WA-TR-NA-SF-TWICE-MONTHLY  VALUE "T".
S12060             88 WA-TR-NA-SF-MONTHLY        VALUE "M".
S12060             88 WA-TR-NA-SF-QUARTERLY      VALUE "Q".
S12060             88 WA-TR-NA-SF-HALF-YEARLY    VALUE "H".
S12060             88 WA-TR-NA-SF-YEARLY         VALUE "Y".
S12060         05  WA-TR-NA-OFFSET-ACCT-IND      PIC 9.
S12060         05  WA-TR-NA-DUE-REPAY-TYPE       PIC 9.
S16409         05  WA-TR-NA-OLDEST-BDATE-DATE    PIC 9(08).
S16409         05  WA-TR-NA-INSU-GRANT-FLAG      PIC X(01).
S16409         05  WA-TR-NA-OD-NO                PIC 9(16).
S16757         05  FILLER                        PIC X(32).
S16757         05  WA-TR-NA-REPAY-METHOD         PIC X.
S16757         05  WA-TR-NA-ADD-DUES             PIC 9(14).
S16757         05  FILLER                        PIC X(344).
S16757*S16409         05  FILLER                        PIC X(391).
S16409*S12060         05  FILLER                        PIC X(416).
TB0169*S12060  05  FILLER                        PIC X(444).
028680         05  WA-TR-NA-MSG-CODE             PIC 9(2).
028690         05  FILLER                        PIC X(10).
TB0169***-- end of new 12000 / 17000 screen format
TB0169***-- old 12000/17000 definition commented out
028040***      05  WA-TR-NEW-ACCT-NO             PIC 9(16).
TB0008***      05  WA-TR-NER-ACCT-NO-R REDEFINES WA-TR-NEW-ACCT-NO.
TB0008**--         07 ACCT-NO-SPACE              PIC X(3).
TB0008**--         07 ACCT-NO-BRANCH             PIC 9(4).
TB0008**--         07 ACCT-NO-TYPE               PIC 9(2).
TB0008**--         07 FILLER                     PIC X(7).
TB0117***          07 ACCT-NO-SPACE              PIC 9(2).
TB0117***          07 ACCT-NO-BRANCH-MAIN.
TB0117***             09 ACCT-NO-FIRST           PIC 9(1).
TB0117***                88 ACCT-NO-FIRST-2      VALUE 2.
TB0117***             09 ACCT-NO-BRANCH          PIC 9(3).
TB0117***          07 ACCT-NO-TYPE               PIC 9(2).
TB0117***          07 ACCT-SERIES                PIC 9(8).
028050***      05  WA-TR-NA-CUSTOMER-NO          PIC 9(16).
028060***      05  WA-TR-NA-INPUT-ID             PIC X(16).
028070***      05  WA-TR-NA-NAME-1               PIC X(60).
028080***      05  WA-TR-NA-ADDRESS-1            PIC X(40).
028090***      05  WA-TR-NA-ADDRESS-2            PIC X(40).
028100***      05  WA-TR-NA-ADDRESS-3            PIC X(40).
028110***      05  WA-TR-NA-NATIONALITY-CD       PIC XXX.
028120***      05  WA-TR-NA-ADDRESS-4            PIC X(40).
028130***      05  WA-TR-NA-POST-CODE            PIC X(8).
028140***      05  WA-TR-NA-GL-CLASS-CODE        PIC X(25).
028150***      05  WA-TR-NA-TYPE                 PIC 9(4).
028160***      05  WA-TR-NA-TYPE-R    REDEFINES WA-TR-NA-TYPE
028170***                                        PIC X(4).
028180***      05  WA-TR-NA-INT-CAT              PIC 9(4).
028190***      05  WA-TR-NA-PURPOSE              PIC 9.
028200***      05  WA-TR-NA-APPLN-AMT            PIC S9(14)V999
028210***                                        TRAILING SEPARATE.
028220***      05  WA-TR-NA-APPLN-DATE           PIC 9(8).
028230***      05  WA-TR-NA-LOAN-TERM            PIC 9(4).
028240***      05  WA-TR-NA-DOWN-PAYMENT         PIC S9(14)V999
028250***                                        TRAILING SEPARATE.
028260***      05  WA-TR-NA-REM-REPAYS           PIC 9(4).
028270***      05  WA-TR-NA-ENDOW-EXP-DTE        PIC 9(8).
028280***      05  WA-TR-NA-ENDOW-AMT            PIC S9(14)V999
028290***                                        TRAILING SEPARATE.
028300***      05  WA-TR-NA-MAIL-INDIC           PIC X.
028310***      05  WA-TR-NA-NOTICE-INDIC         PIC X.
028320***      05  WA-TR-NA-NOTICE-CUST-NO       PIC 9(16).
028330*        05  WA-TR-NA-LEGAL-CD             PIC 999.
028340*        05  WA-TR-NA-BUSINESS-CD          PIC 9(5).
028350***      05  WA-TR-NA-STAT-FREQ            PIC X.
028360***      05  WA-TR-NA-STAT-CYCL            PIC 99.
028370***      05  WA-TR-NA-STAT-DAY             PIC 99.
028380***      05  FILLER                        PIC X(3).
028390***      05  WA-TR-NA-LANG-CODE            PIC 99.
028400***      05  WA-TR-NA-INSU-CODE            PIC X.
028410***      05  WA-TR-NA-INSU-CUST            PIC 9(16).
028420*---     05  WA-TR-NA-FACILITY-NO          PIC 9(17).
TB0143***      05  WA-TR-NA-FACILITY-NO.
TB0143***          07 WA-TR-NA-FAC-NO-16         PIC 9(16).
TB0143***          07 WA-TR-NA-FAC-CHK-DGT       PIC 9.
028430***      05  WA-TR-NA-PAY-DAY              PIC 99.
028440***      05  WA-TR-NA-REPAY-FREQ           PIC 99.
028450***      05  WA-TR-NA-DUE-AMT           PIC S9(14)V999
028460***                                        TRAILING SEPARATE.
028470***      05  WA-TR-NA-REPAY-AMT REDEFINES WA-TR-NA-DUE-AMT
028480***                                        PIC S9(14)V999
028490***                                        TRAILING SEPARATE.
028500***      05  WA-TR-NA-INT-DAY              PIC 99.
028510***      05  WA-TR-NA-INT-FREQ             PIC 99.
028520***      05  WA-TR-RT-INCR                 PIC S99V9(5)
028530***                                        TRAILING SEPARATE.
028540***      05  WA-TR-FINE-CDE                PIC 99.
028550***      05  WA-TR-NA-REDRAW-IND           PIC X.
028560***      05  WA-TR-PDCC-VAL                PIC S9(14)V999
028570***                                        TRAILING SEPARATE.
028580*        05  FILLER                        PIC X(471).
028590***      05  FILLER                        PIC X(30).
028600***      05  WA-TR-NA-NOTICE-PROC          PIC X.
028610***      05  WA-ABEX-IND                   PIC X.
028620***      05  WA-MATCHED-RATE               PIC S999V9(4)
028630***                                        TRAILING SEPARATE.
028640***      05  WA-TR-NA-CLAWB-PRD            PIC 999.
028650***      05  WA-TR-NA-CLAWB-DATE           PIC 9(8).
028660***      05  WA-TR-NA-TRMN-PRD             PIC 999.
028670***      05  FILLER                        PIC X(408).
028680***      05  WA-TR-NA-MSG-CODE             PIC 9(2).
028690***      05  FILLER                        PIC X(10).
TB0169***-- end of old 12000/17000 definition commented out
028700     03  WA-TR-STAT-DETAILS  REDEFINES WA-INPUT-MSG.
028710*        05  FILLER                        PIC X(128).                  
028720         05  FILLER                        PIC X(108).                  
028730         05  WA-TR-NA-BORR-TYPE            PIC 9(4).
028740         05  WA-TR-NA-GROUP                PIC 99.
028750         05  WA-TR-NA-SUBGROUP             PIC 99.
028760         05  WA-TR-NA-INT-RATE             PIC S999V9(4)
028770                                           TRAILING SEPARATE.
028780         05  WA-TR-INT-CONC                PIC S999V9(4)
028790                                           TRAILING SEPARATE.
028800         05  WA-TR-INT-CONC-MOV            PIC S999V9(4)
028810                                           TRAILING SEPARATE.
028820         05  WA-TR-INT-CONC-MOV-AD         PIC S999V9(4)
028830                                           TRAILING SEPARATE.
028840         05  WA-TR-RT-INCR-MOV             PIC S999V9(4)
028850                                           TRAILING SEPARATE.
028860         05  WA-TR-RT-INCR-MOV-AD          PIC S999V9(4)
028870                                           TRAILING SEPARATE.
028880         05  WA-TR-NA-DUES-START-DATE      PIC 9(8).
028890         05  WA-TR-REPAY-SCHED             PIC X.
028900         05  WA-TR-INT-START-DTE           PIC 9(8).
028910         05  WA-TR-INT-METHOD              PIC X.
028920         05  WA-TR-NA-PEND-DUES-RATE       PIC S999V9(4)
028930                                           TRAILING SEPARATE.
028940         05  WA-TR-NA-PEND-DUES-DATE       PIC 9(8).
028950         05  WA-TR-NA-PEND-DUES-AMT        PIC S9(14)V999
028960                                           TRAILING SEPARATE.
028970         05  WA-TR-ADD-LOAN-CDE            PIC 9.
028980         05  WA-TR-NA-ADD-DUES-AMT         PIC S9(14)V999
028990                                           TRAILING SEPARATE.
029000         05  WA-TR-INT-CAP-PERC            PIC 99V99.
029010         05  WA-TR-INT-TAX-YTD             PIC S9(14)V999
029020                                           TRAILING SEPARATE.
029030         05  WA-TR-NA-DISCHARGE-MTHS       PIC 9(4).
029040         05  WA-TR-FIXED-RT-PER            PIC 9(4).
029050         05  WA-TR-INST-NOT-DAYS           PIC 9(4).
029060         05  WA-TR-SPECIAL-LOAN-CDE        PIC X.
029070         05  WA-TR-REASON-ARR-CDE          PIC 99.
029080         05  WA-TR-SOURCE-CDE              PIC 99.
029090         05  WA-TR-SETTLEMENT-CDE          PIC X.
029100         05  WA-TR-PL-APP-REF-DEC          PIC X.
029110         05  WA-TR-NA-MISC-DB-1            PIC S9(6)V999
029120                                           TRAILING SEPARATE.
029130         05  WA-TR-NA-MISC-DB-LEDG-1       PIC 9.
029140         05  WA-TR-NA-MISC-DB-SUBLEDG-1    PIC 99.
029150         05  WA-TR-NA-MISC-DB-2            PIC S9(6)V999
029160                                           TRAILING SEPARATE.
029170         05  WA-TR-NA-MISC-DB-LEDG-2       PIC 9.
029180         05  WA-TR-NA-MISC-DB-SUBLEDG-2    PIC 99.
029190         05  WA-TR-NA-MISC-DB-3            PIC S9(6)V999
029200                                           TRAILING SEPARATE.
029210         05  WA-TR-NA-MISC-DB-LEDG-3       PIC 9.
029220         05  WA-TR-NA-MISC-DB-SUBLEDG-3    PIC 99.
029230*        05  FILLER                        PIC X(647).                  
029240         05  FILLER                        PIC X(667).
029250     03  WA-TR-USER-CODE-DTLS  REDEFINES WA-INPUT-MSG.
029260         05  FILLER                      PIC X(128).
029270         05  WA-TR-NA-DISCH-REF          PIC X(4).
029280         05  WA-TR-SECURITY-AGE          PIC 99.
029290         05  WA-TR-SEC-METHOD-CDE        PIC 99.
029300         05  WA-TR-SEC-LSD-CDE           PIC X.
029310         05  WA-TR-CONSTRUCTION-CDE      PIC 9.
029320         05  WA-TR-COUNCIL-CODE          PIC 9.
029330         05  WA-TR-REGISTRY-CDE          PIC 9.
029340         05  WA-TR-RATIO-VAL-CDE         PIC 9.
029350         05  WA-TR-VALUER-CDE            PIC 9(4).
029360         05  WA-TR-SOLICITOR-CDE         PIC 9(4).
029370         05  WA-TR-MPI-CODE              PIC 9.
029380         05  WA-TR-MORTGAGE-INSURANCE    PIC X.
029390         05  WA-TR-NA-SERV-FEE-CDE       PIC 99.
029400         05  WA-TR-LOC-CDE               PIC 9.
029410         05  WA-TR-ID-DOC                PIC X(20).
029420         05  WA-TR-ID-NO                 PIC X(15).
029430         05  FILLER                      PIC X(793).
029440     03  WA-REFERRAL-INPUT REDEFINES WA-INPUT-MSG.
029450         05  WA-REF-ACCT-NO              PIC 9(16).
029460         05  WA-REFEREE-TELL-NO          PIC 9(5).
029470         05  FILLER                      PIC X(961).
029480     03  WA-REFERRAL-KNOW REDEFINES WA-INPUT-MSG.
029490         05  WA-REF-K-ACCT-NO          PIC 9(16).
029500         05  WA-REFERRER                 PIC X(30).
029510         05  WA-REF-KNOW-FLAG          PIC X.
029520         05  FILLER                      PIC X(935).
029530     03  WA-INTRAN-12426  REDEFINES WA-INPUT-MSG.
029540         05  WA-12426-ACCT               PIC 9(16).
029550         05  WA-12426-APPROVED           PIC S9(14)V999
029560                                         TRAILING SEPARATE.
029570         05  WA-12426-ADVANCED           PIC S9(14)V999
029580                                         TRAILING SEPARATE.
029590         05  WA-12426-UNDRAWN            PIC S9(14)V999
029600                                         TRAILING SEPARATE.
029610         05  WA-12426-FULLYDRAWN         PIC X.
029620         05  FILLER                      PIC X(911).
029630*
029640     03  WA-SEC-DOC-MOVE REDEFINES WA-INPUT-MSG.
029650         05  WA-SEC-DOC-ACCT-NO          PIC 9(16).
029660         05  WA-SEC-DOC-NO               PIC 99.
029670         05  WA-SEC-DOC-DESCR            PIC X(30).
029680         05  WA-SEC-DOC-FROM-LOC         PIC 9999.
029690         05  WA-SEC-DOC-TO-LOC           PIC 9999.
029700         05  FILLER                      PIC X(926).
029710     03  WA-TITLE-DET-INPUT REDEFINES WA-INPUT-MSG.
029720         05  WA-TITLE-ACCT-NO            PIC 9(16).
029730         05  WA-TITLE-SEARCH-DATE        PIC 9(8).
029740         05  WA-TITLE-VOLUME             PIC X(6).
029750         05  WA-TITLE-FOLIO-NO           PIC X(6).
029760         05  WA-TITLE-LOT-NO             PIC X(6).
029770         05  WA-TITLE-DEP-PLAN-NO        PIC X(6).
029780         05  WA-TITLE-IDENTIFIER         PIC X(25).
029790         05  WA-TITLE-STRATA-PLAN        PIC X(6).
029800         05  WA-TITLE-OLD-SYSTEM-NO      PIC X(6).
029810         05  WA-TITLE-BOOK               PIC X(6).
029820         05  WA-TITLE-DETAILS            PIC X(20).
029830         05  WA-TITLE-INST-1             PIC X(20).
029840         05  WA-TITLE-INST-2             PIC X(20).
029850         05  WA-TITLE-AMOUNT-1           PIC S9(14)V999
029860                                     SIGN TRAILING SEPARATE.
029870         05  WA-TITLE-AMOUNT-2           PIC S9(14)V999
029880                                     SIGN TRAILING SEPARATE.
029890         05  WA-TITLE-REPAY-1            PIC S9(14)V999
029900                                     SIGN TRAILING SEPARATE.
029910         05  WA-TITLE-REPAY-2            PIC S9(14)V999
029920                                     SIGN TRAILING SEPARATE.
029930         05  FILLER                      PIC X(759).
029940     03  WA-MEMB-SOL-INPUT  REDEFINES WA-INPUT-MSG.
029950         05  WA-MEMB-SOL-ACCT-NO         PIC 9(16).
029960*S12147  05  WA-MEMB-SOL-NAME            PIC X(30).
029970*S12147  05  WA-MEMB-SOL-ADD1            PIC X(30).
029980*S12147  05  WA-MEMB-SOL-ADD2            PIC X(30).
029990*S12147  05  WA-MEMB-SOL-ADD3            PIC X(30).
S12147         05  WA-MEMB-SOL-ADD1            PIC X(40).
S12147         05  WA-MEMB-SOL-ADD2            PIC X(40).
030000         05  WA-MEMB-SOL-POSTCODE        PIC 9(8).
030010*S12147  05  WA-MEMB-SOL-DX-NO           PIC X(6).
030020*S12147  05  WA-MEMB-SOL-DX-TOWN         PIC X(20).
030030*S12147  05  FILLER                      PIC X(812).
S12147         05  WA-MEMB-EXPI-DATE           PIC 9(8).
S12147         05  FILLER                      PIC X(870).
030040     03  WA-STAMPED-AMT-DETS REDEFINES WA-INPUT-MSG.
030050         05  WA-STAMPED-ACCT             PIC 9(16).
030060         05  WA-STAMPED-AMT              PIC S9(14)V999
030070                                     SIGN TRAILING SEPARATE.
030080         05  FILLER                      PIC X(948).
030090     03  WA-SPEC-CONDS-DTLS REDEFINES WA-INPUT-MSG.
030100         05  WA-SPEC-CONDS-ACCT-NO       PIC 9(16).
030110         05  WA-SPEC-COND-NO             PIC 9999.
030120         05  WA-SPEC-COND-VERSION        PIC 99.
030130         05  WA-SPEC-COND-DESC           PIC X(30).
030140         05  WA-SPEC-COND-STAGE          PIC X.
030150         05  WA-SPEC-COND-BRING-UP.
030160             07  WA-SPEC-COND-NO-PERIODS PIC 99.
030170             07  WA-SPEC-COND-PERIOD     PIC X.
030180             07  WA-SPEC-COND-BUP-STAGE  PIC X.
030190         05  WA-SPEC-COND-INSERT OCCURS 5
030200                             INDEXED BY WA-SPEC-COND-IX2.
030210             07  WA-SPEC-COND-DATA-DESC  PIC X(20).
030220             07  WA-SPEC-COND-DEFLT-DATA PIC X(25).
030230         05  FILLER                      PIC X(700).
030240     03  WA-SPEC-COND-DTLS REDEFINES WA-INPUT-MSG.
030250         05  WA-SP-COND-ACCT-NO          PIC 9(16).
030260         05  WA-SP-COND-NO               PIC 9999.
030270         05  WA-SP-COND-VERS             PIC 99.
030280         05  WA-SP-COND-DESC             PIC X(30).
030290         05  WA-SP-COND-RESPONSE         PIC X.
030300         05  FILLER                      PIC X(929).
030310     03  WA-SP-COND-BRING-UP REDEFINES WA-INPUT-MSG.
030320         05  WA-SP-COND-COUNT-NO       PIC 9(16).
030330         05  WA-SP-COND-NUMBER           PIC 9999.
030340         05  WA-SP-COND-VERSION          PIC 99.
030350         05  WA-SP-COND-DESCRIP          PIC X(30).
030360         05  WA-SP-COND-NO-PERS          PIC 99.
030370         05  WA-SP-COND-PER              PIC X.
030380         05  WA-SP-COND-STAGE            PIC X.
030390         05  FILLER                      PIC X(926).
030400     03  WA-12000-DETS REDEFINES WA-INPUT-MSG.
030410         05  FILLER                      PIC X(304).
030420         05  WA-12000-ACT-TYPE           PIC 9(4).
030430         05  WA-12000-ACT-CTG            PIC 9(4).
030440         05  FILLER                      PIC X(670).
030450     03  BR0005-DETS REDEFINES WA-INPUT-MSG.
030460         05  BR0005-INPUT-KEY            PIC 9(16).
030470         05  BR0005-PAGE-COUNT           PIC 99.
030480         05  FILLER                      PIC X(15).
030490         05  BR0005-DEVICE-TYPE          PIC X.
030500         05  FILLER                      PIC X(948).
TB0096     03 WA-10231-INPUT-MSG REDEFINES WA-INPUT-MSG.
TB0096         05 WA-10231-ACCT-NO          PIC 9(16).
TB0096         05 WA-10231-BCKT-CD          PIC XX.
TB0096         05 WA-10231-BCKT-DESC        PIC X(30).
TB0096         05 WA-10231-BCKT-DET OCCURS 10.
TB0096            07 WA-10231-TERM-NO       PIC 9(4).
TB0096            07 WA-10231-BASE-DATE     PIC 9(8).
TB0096            07 WA-10231-BASE-AMT      PIC S9(14)V999
TB0096                                   TRAILING SEPARATE.
TB0096            07 WA-10231-INT-RATE      PIC S9(3)V9(4)
TB0096                                   TRAILING SEPARATE.
TB0096            07 WA-10231-IND           PIC X.
TB0096            07 WA-10231-ADW-AMT       PIC S9(6)V99
TB0096                                   TRAILING SEPARATE.
Tb0096            07 WA-10231-REASON-CD     PIC 9(4).
TB0096            07 WA-10231-SEQ-NO        PIC X(4).
TB0096         05 WA-10231-ACTION           PIC X.
TB0096         05 WA-10231-PROMO            PIC XX.
TB0096         05 FILLER                    PIC X(371).
030510     03  BR17018-DETS REDEFINES WA-INPUT-MSG.
030520         05  WA-PROP-ACCT-NO             PIC 9(16).
030530         05  WA-PROP-LESSEE-NAME         PIC X(30).
030540         05  WA-PROP-LEASE-START-DATE    PIC 9(8).
030550         05  WA-PROP-LEASE-EXPIRY-DATE   PIC 9(8).
030560         05  WA-PROP-RENTAL-AMOUNT       PIC S9(14)V999
030570                                         TRAILING SEPARATE.
030580         05  FILLER                      PIC X(902).
030590     03  BR17019-DETS REDEFINES WA-INPUT-MSG.
030600         05  WA-MORT-ACCT-NO             PIC 9(16).
030610         05  WA-MORT-OCC OCCURS 3 INDEXED BY WA-MORT-IX.
030620             07  WA-MORT-MORTGAGEE       PIC X(12).
030630             07  WA-MORT-RANK            PIC 9(1).
030640             07  WA-MORT-AMOUNT          PIC S9(14)V999
030650                                         TRAILING SEPARATE.
030660             07  WA-MORT-RATE            PIC 99V9999.
030670             07  WA-MORT-REPAYMENT       PIC S9(14)V999
030680                                         TRAILING SEPARATE.
030690         05  FILLER                      PIC X(801).
030700     03  BR17020-DETS REDEFINES WA-INPUT-MSG.
030710         05  WA-COSN-ACCT-NO             PIC 9(16).
030720         05  WA-COSN-COSIGNOR-NAME       PIC X(30).
030730         05  WA-COSN-COSIGNOR-ADD1       PIC X(30).
030740         05  WA-COSN-COSIGNOR-ADD2       PIC X(30).
030750         05  WA-COSN-COSIGNOR-ADD3       PIC X(30).
030760         05  WA-COSN-POSTCODE            PIC 9(8).
030770         05  WA-COSN-SEC-CODE            PIC X(2).
030780         05  WA-COSN-SEC-DESC            PIC X(20).
030790         05  FILLER                      PIC X(816).
030800     03  BR17021-DETS REDEFINES WA-INPUT-MSG.
030810         05  WA-JUDG-ACCT-NO             PIC 9(16).
030820         05  WA-JUDG-JUDGE-DATE          PIC 9(8).
030830         05  WA-JUDG-JUDGE-AMOUNT        PIC S9(14)V999
030840                                         TRAILING SEPARATE.
030850         05  WA-JUDG-JUDGE-RATE          PIC 9(2)V9(4).
030860         05  WA-JUDG-SURRENDER-DATE      PIC 9(8).
030870         05  WA-JUDG-JUDGE-DETAILS       PIC X(30).
030880         05  FILLER                      PIC X(896).
030890     03  BR17022-DETS REDEFINES WA-INPUT-MSG.
030900         05  WA-NEGP-ACCT-NO             PIC 9(16).
030910         05  WA-NEGP-OCC OCCURS 15 INDEXED BY WA-NEGP-IX.
030920             07  WA-NEGP-START-DATE      PIC 9(8).
030930             07  WA-NEGP-CYCLE           PIC X(2).
030940             07  WA-NEGP-FREQUENCY       PIC X(1).
030950             07  WA-NEGP-REPAYMENT       PIC S9(14)V999
030960                                         TRAILING SEPARATE.
030970         05  FILLER                      PIC X(531).
030980     03  BR17023-DETS REDEFINES WA-INPUT-MSG.
030990         05  WA-AGRE-ACCT-NO             PIC 9(16).
031000         05  WA-AGRE-START-DATE          PIC 9(8).
031010         05  WA-AGRE-AGREED-AMT          PIC S9(14)V999
031020                                         TRAILING SEPARATE.
031030         05  WA-AGRE-FREQUENCY           PIC X(2).
031040         05  WA-AGRE-CYCLE               PIC X(2).
031050         05  WA-AGRE-CONTT-METH        PIC X(6).
031060         05  WA-AGRE-ARREARS-REASON      PIC X(30).
031070         05  WA-AGRE-LOAN-OFFICER        PIC S9(7)
031080                                         TRAILING SEPARATE.
031090         05  FILLER                      PIC X(892).
031100     03  BR17024-DETS REDEFINES WA-INPUT-MSG.
031110         05  WA-EXTN-ACCT-NO             PIC 9(16).
031120         05  WA-EXTN-EXTENSION-FEES      PIC S9(14)V999
031130                                         TRAILING SEPARATE.
031140         05  WA-EXTN-EXTENSION           PIC X(2).
031150         05  WA-EXTN-EXTENSION-REASON    PIC X(30).
031160         05  WA-EXTN-LOAN-OFFICER        PIC S9(7)
031170                                         TRAILING SEPARATE.
031180         05  FILLER                      PIC X(908).
031190     03  BR17025-DETS REDEFINES WA-INPUT-MSG.
031200         05  WA-COLL-ACCT-NO             PIC 9(16).
031210         05  WA-COLL-COLLATERAL-TYPE     PIC X(12).
031220         05  WA-COLL-ABS-CODE            PIC X(3).
031230         05  WA-COLL-COLLATERAL-AMT      PIC S9(14)V999
031240                                         TRAILING SEPARATE.
031250         05  WA-COLL-COLLATERAL-VAL      PIC S9(14)V999
031260                                         TRAILING SEPARATE.
031270         05  WA-COLL-COLLATERAL-DESC     PIC X(30).
031280         05  WA-COLL-COVERAGE            PIC X(12).
031290         05  WA-COLL-EXPOSURE-CODE       PIC X(5) OCCURS 3.
031300         05  FILLER                      PIC X(858).
031310     03  BR17029-DETS REDEFINES WA-INPUT-MSG.
031320         05  WA-17029-ACCT-NO            PIC 9(16).
031330         05  WA-17029-TXN-TYPE           PIC XX.
NR2001*031340         05  WA-17029-BORV46             PIC X.
NR2001         05  WA-17029-BOCT46             PIC X.
031350         05  WA-17029-TYPE               PIC 9999.
031360         05  WA-17029-CAT                PIC 9999.
031370         05  WA-17029-AMOUNT             PIC S9(14)V999 COMP.
031380         05  WA-17029-RATE               PIC S999V9999 COMP.
031390         05  WA-17029-MAT-DATE           PIC S9(9) COMP.
031400         05  WA-17029-PREBOOK-CTR        PIC 99.
031410         05  WA-17029-PREBOOK-FIRST-DATE PIC S9(9) COMP.
031420         05  FILLER                      PIC X(933).
031430* AXS
031440     03  BR-17090-INPUT-MSG REDEFINES WA-INPUT-MSG.
031450         05  WA-ACCT-NO                  PIC 9(16).
031460         05  WA-FUNCTION                 PIC X.
031470         05  FILLER                      PIC X(965).
031480     03  BR-17040-INPUT-MSG REDEFINES WA-INPUT-MSG.
031490         05  WA-ACCT-NO                  PIC 9(16).
031500         05  WA-FUNCTION                 PIC X.
031510         05  WA-NEXT-SCRN                PIC X.
031520         05  WA-ARRAY OCCURS 4 TIMES.
031530                07  WA-START-DATE        PIC 9(8).
031540                07  WA-END-DATE          PIC 9(8).
031550                07  WA-OPTION-TYPE       PIC X.
031560                07  WA-RATE-TABLE        PIC 9(4).
031570                07  WA-RATE-TERM         PIC 9(4).
031580                07  WA-HIGH-RATE         PIC S9(3)V9(4)
031590                                        TRAILING SEPARATE.
031600                07  WA-LOW-RATE          PIC S9(3)V9(4)
031610                                        TRAILING SEPARATE.
031620                07  WA-ACTION            PIC X.
031630         05  MORE-TO-FOLLOW              PIC X(30).
031640         05  FILLER                      PIC X(766).
031650     03  BR-17041-INPUT-MSG REDEFINES WA-INPUT-MSG.
031660         05  WA-ACCT-NO                  PIC 9(16).
031670         05  WA-FUNCTION                 PIC X.
031680         05  WA-ARRAY OCCURS 2 TIMES.
031690                07  WA-START-DATE-41          PIC 9(8).
031700                07  WA-END-DATE-41            PIC 9(8).
031710                07  WA-OPTION-TYPE-41         PIC X.
031720                07  WA-RATE-TABLE-41          PIC 9(4).
031730                07  WA-RATE-TERM-41           PIC 9(4).
031740                07  WA-HIGH-RATE-41           PIC S9(3)V9(4)
031750                                          TRAILING SEPARATE.
031760                07  WA-LOW-RATE-41            PIC S9(3)V9(4)
031770                                          TRAILING SEPARATE.
031780         05  FILLER                      PIC X(883).
031790     03  BR-17042-INPUT-MSG REDEFINES WA-INPUT-MSG.
031800         05  WA-ACCT-NO                  PIC 9(16).
031810         05  WA-FUNCTION                 PIC X.
031820         05  WA-START-DATE-42            PIC 9(8).
031830         05  WA-END-DATE-42              PIC 9(8).
031840         05  WA-OPTION-TYPE-42           PIC X.
031850         05  WA-RATE-TABLE-42            PIC 9(4).
031860         05  WA-RATE-TERM-42             PIC 9(4).
031870         05  WA-HIGH-RATE-42             PIC S9(3)V9(4)
031880                                         TRAILING SEPARATE.
031890         05  WA-LOW-RATE-42              PIC S9(3)V9(4)
031900                                         TRAILING SEPARATE.
031910         05  FILLER                      PIC X(924).
TB0198     03  BR17033-DETS REDEFINES WA-INPUT-MSG.
TB0198         05  BR17033-ACCT-NO             PIC 9(16).
TB0198         05  BR17033-AGREE-IND           PIC 9.
TB0198             88  BR17033-AGREE-IND-VALID VALUE 0, 2.
TB0198         05  BR17033-NARRATIVE           PIC X(40).
TB0198         05  BR17033-GL-SEGMENT  OCCURS 5.
TB0198             07 BR17033-GL-BUCKET-CDE    PIC XX.
TB0198             07 BR17033-GL-BUCKET-DUE    PIC S9(14)V999 COMP.
TB0198         05  BR17033-INT-BUCKET          PIC S9(14)V999 COMP.
SC6148         05  BR17033-PROMO-CODE          PIC XX.
SC6148         05  BR17033-INT-AMT             PIC S9(14)v999
SC6148                                SIGN IS  TRAILING SEPARATE.
SC6148         05  BR17033-ARR-AMT             PIC S9(14)v999
SC6148                                SIGN IS  TRAILING SEPARATE.
SC6148         05  FILLER                      PIC X(829).
TB0198*SC6148  05  FILLER                      PIC X(867).
TB0223     03  BR17467-INP-DETS REDEFINES WA-INPUT-MSG.
TB0223         05  BR17467-INP-ACCT-NO         PIC 9(16).
TB0223         05  BR17467-INP-DEF-INT-AMT     PIC S9(14)V999
TB0223                             SIGN IS  TRAILING SEPARATE.
TB0223         05  BR17467-INP-MORTGAGE-NO     PIC 9.
TB0223         05  BR17467-INP-SUB-LEDGER-CD   PIC 9(2).
TB0223         05  FILLER                      PIC X(6).
TB0223         05  BR17467-INP-DEF-WAIVE-INT   PIC S9(14)V999
TB0223                             SIGN IS  TRAILING SEPARATE.
TB0223         05  BR17467-INP-DEF-SYSTEM      PIC X(3).
TB0223         05  BR17467-INP-TRF-ACCOUNT     PIC 9(16).
TB0223         05  FILLER                      PIC X(902).
TB0211     03  WA-17003-TRAN REDEFINES WA-INPUT-MSG.
TB0211         05  WA-17003-CORR-TRAN-CD       PIC 9(6).
TB0211         05  FILLER                      PIC X(976).
031920*AXS
031930     03  WA-STAT-DET-INPUT REDEFINES WA-INPUT-MSG.
031940         05  WA-STAT-MEMB-NO             PIC 9(16).
031950         05  WA-FIN-REASON-CODE          PIC 9.
031960         05  WA-SEX-CODE                 PIC 99.
031970         05  WA-MARITAL-STATUS           PIC 9.
031980         05  WA-OCCUPATION-CODE          PIC 9999.
031990         05  WA-INCOME-DETERMIN          PIC 9.
032000         05  WA-AGENT-CODE               PIC 9999.
032010         05  WA-PERCENTAGE-DOWN          PIC 99.
032020         05  WA-SOURCE-OF-FUNDS          PIC 9999.
032030         05  WA-VAL-COMPANY-CODE         PIC 99.
032040         05  WA-SEC-DOCUM-LOCATION       PIC 99.
032050         05  WA-AREA-CODE                PIC 99.
032060         05  WA-RATIO-TO-VAL             PIC 99.
032070         05  FILLER                      PIC X(939).
032080     03  WA-STAT-INPUT REDEFINES WA-INPUT-MSG.
032090         05  WA-STAT-ACT-NO              PIC 9(16).
032100         05  WA-STAT-NAME-1              PIC X(40).
032110         05  WA-STAT-NAME-2              PIC X(40).
032120         05  WA-STAT-FIN-REASON-CODE     PIC 9.
032130         05  WA-STAT-SEX-CODE            PIC 99.
032140         05  WA-STAT-MARITAL-STATUS      PIC 9.
032150         05  WA-STAT-OCCUPATION-CD       PIC 9999.
032160         05  WA-STAT-INCOME-DETERMIN     PIC 9.
032170         05  WA-STAT-AGENT-CODE          PIC 9999.
032180         05  WA-STAT-PCENT-DOWN          PIC 99.
032190         05  WA-STAT-SOURCE-FUNDS        PIC 9999.
032200         05  WA-STAT-VAL-COY-CODE        PIC 99.
032210         05  WA-STAT-DOCUM-LOCAT         PIC 99.
032220         05  WA-STAT-AREA-CODE           PIC 99.
032230         05  WA-STAT-RATIO-TO-VAL        PIC 99.
032240         05  FILLER                      PIC X(859).
032250     03  WA-SOC-TOTALS-AREA REDEFINES WA-INPUT-MSG.
032260         05  WA-SOC-INPUT-KEY            PIC 9(16).
032270         05  FILLER                      PIC X(18).
032280         05  WA-SOC-TOT-AMT              PIC S9(14)V999
032290                                         TRAILING SEPARATE.
032300         05  FILLER                      PIC X(50).
032310         05  WA-SOC-TOT-FUNC             PIC X(3).
032320         05  FILLER                      PIC X(18).
032330         05  WA-SOC-TOT-BITS             PIC X(32).
032340         05  FILLER                      PIC X(827).
032350     03  WA-STOP-TRAN REDEFINES WA-INPUT-MSG.
032360         05  WA-STOP-ACCT-NO            PIC 9(16).
032370         05  WA-STOP-NO                 PIC 99.
032380         05  WA-STOP-REASON-IN          PIC X(18).
032390         05  FILLER                     PIC X(946).
032400     03  WA-HOLD-TRAN REDEFINES WA-INPUT-MSG.
S10614*        05  WA-HOLD-ACCT-NO            PIC 9(16).
S10614*        05  WA-HOLD-AMOUNT             PIC S9(14)V999
S10614*                                       TRAILING SEPARATE.
S10614*        05  WA-HOLD-REASON-IN          PIC X(18).
S10614*        05  FILLER                     PIC X(930).
S10614         05  WA-BR0003-HOLD-ACCT-NO     PIC X(16).
S10614         05  WA-BR0003-HOLD-TRCR-NO     PIC 9(6).      
S10614         05  WA-BR0003-HOLD-AMOUNT      PIC S9(14)V999 
S10614                       SIGN IS TRAILING SEPARATE.                 
S10614         05  WA-BR0003-HOLD-MSG         PIC X(2).      
S10614         05  WA-BR0003-HOLD-REF-IND     PIC X.         
S10614         05  WA-BR0003-HOLD-REMARK      PIC X(40).     
S10614         05  WA-BR0003-INPUT-PROMO-21220.                  
S10614             07  WA-BR0003-PROMO-CODE   PIC XX.        
S10614         05  WA-BR0003-HOLD-ORIG-DATE   PIC 9(8).    
S10614         05  WA-BR0003-HOLD-ORIG-TIME   PIC 9(6).
S10614         05  WA-BR0003-HOLD-DEBIT-CARD-NO   PIC 9(16).
S10614         05  WA-BR0003-HOLD-TRAN-MESS-CODE  PIC X(12).
S10614         05  WA-BR0003-HOLD-ADJ-AMT     PIC S9(14)V999
S10614                       SIGN IS TRAILING SEPARATE.
S10614         05  WA-BR0003-MERCHANT-NO      PIC X(15).
S10614         05  WA-BR0003-POS-TERMINAL-ID  PIC X(8).
S10614         05  WA-BR0003-CNTY-CODE        PIC X(2).
S10614         05  WA-BR0003-MCC-CODE         PIC 9(4).
S10614         05  WA-BR0003-POS-ENTRY-MODE   PIC X.
S10614         05  WA-BR0003-ID-NO            PIC X(14).
S10614         05  WA-BR0003-ID-TYPE          PIC X(2).
S10614         05  WA-BR0003-ACQ-BIN          PIC 9(6).
S10614         05  FILLER                     PIC X(785).
032460     03  WA-SEC-ADD REDEFINES WA-INPUT-MSG.
032470         05  WA-SEC-ADD-ACCT-NO         PIC 9(16).
032480*         05  WA-SEC-LANG-CODE           PIC 99.
032490         05  WA-SEC-TITLE-CODE          PIC 99.
032500         05  WA-SEC-NAME-1              PIC X(40).
032510         05  WA-SEC-NAME-2              PIC X(40).
032520         05  WA-SEC-NAME                PIC X(60).
032530         05  WA-SEC-ADD-1               PIC X(40).
032540         05  WA-SEC-ADD-2               PIC X(40).
032550         05  WA-SEC-ADD-3               PIC X(40).
032560         05  WA-SEC-ADD-4               PIC X(40).
032570         05  WA-SEC-ADD-POST-CODE       PIC X(8).
032580         05  WA-SEC-PHONE-NO-RES        PIC X(12).
032590         05  WA-SEC-PHONE-NO-BUS        PIC X(12).
032600         05  WA-SEC-FAX-NO              PIC X(12).
032610         05  WA-SEC-TELEX-NO            PIC X(12).
032620         05  WA-SEC-EFFEC-DATE          PIC 9(8).
032630         05  WA-SEC-EXPIR-DATE          PIC 9(8).
032640         05  FILLER                     PIC X(592).
032650     03  WA-FUNDS-DET REDEFINES WA-INPUT-MSG.
032660         05  WA-START-TRAN              PIC 999.
032670         05  FILLER                     PIC X(979).
032680     03  WA-INT-ADJ-AREA REDEFINES WA-INPUT-MSG.
032690         05  WA-10732-ACCOUNT            PIC 9(16).
032700         05  WA-10732-INT-ADJ            PIC S9(7)V9(5)
032710                                       TRAILING SEPARATE.
SC6939         05  WA-REASON-CODE              PIC 9(4).
SC6939         05  WA-AUTH-ID-NO               PIC X(16).
SC6939         05  WA-AUHT-ID-TYPE             PIC 9(2).
S15788         05  WA-10732-PCC-CODE           PIC X(6).
S15788         05  FILLER                      PIC X(925).
S15788*SC6939         05  FILLER                      PIC X(931).
032720*SC6939  05  FILLER                      PIC X(953).
S17306       03  WA-INPUT-10241-MSG REDEFINES WA-INPUT-MSG.
S17306         05 FILLER                       PIC X(127).
S17306         05 INPUT-10241-REASON           PIC 9(4).
S17306         05 FILLER                       PIC X(851).
032730     03  WA-TOM-ADJ-AREA REDEFINES WA-INPUT-MSG.                         
032740         05  WA-10733-ACCOUNT            PIC 9(16).                      
032750         05  WA-10733-TOM-ADJ            PIC S9(14)V9(3)                 
032760                                         TRAILING SEPARATE.              
032770         05  FILLER                      PIC X(948).                     
032780     03  WA-GENERIC-NARRATION-AREA REDEFINES WA-INPUT-MSG.
032790         05  FILLER                      PIC X(605).
032800         05  WA-IN-NARR-TEXT             PIC X(50).
032810         05  WA-IN-SOURCE-APPLN          PIC XXX.
032820         05  FILLER                      PIC X(324).
S12770     03  WA-ADV-TO-GL-AREA         REDEFINES WA-INPUT-MSG.
S12770         05  FILLER                      PIC X(808).
S12770         05  VIR-AC-FOR-REORG-PROD       PIC 9(16).
S12770         05  FILLER                      PIC X(158).
S12770
032840     03  WA-TXN775-IN-DATA REDEFINES WA-INPUT-MSG.
032850         05  TXN775-ACC-NO               PIC 9(16).
032860         05  FILLER                      PIC X(65).
032870         05  TXN775-IN-GROUP             PIC X(480).
032880         05  FILLER                      PIC X(421).
SC6401     03  WA-11041-MESSAGE  REDEFINES WA-INPUT-MSG.          
SC6401         05  W41-I-ACCT-NO          PIC 9(16).              
SC6401         05  W41-I-AMOUNT           PIC S9(14)V999          
SC6401                                    TRAILING SEPARATE.      
SC6401         05  FILLER                 PIC X(03).              
SC6401         05  W41-I-PROMO-CODE       PIC XX.                 
SC6401         05  W41-I-TRN-DATE         PIC 9(8).               
SC6401         05  FILLER                 PIC X(17).              
SC6401         05  W41-I-TRF-ACCT-NO      PIC 9(16).              
SC6401         05  FILLER                 PIC X(153).             
SC6401         05  W41-I-TRACER-NO        PIC 9(6).               
SC6401         05  FILLER                 PIC X(58).              
SC6401         05  W41-I-TAX-CODE         PIC X.                  
SC6401         05  W41-I-SYSTEM           PIC XXX.                
SC6401         05  FILLER                 PIC X(681).             
SC7301     COPY UT28MSG IN LIBRYCHG
SC7301       REPLACING ==(W54-I)==    BY ==W41-IN==
SC7301                 ==(WA-11041)== BY ==W41-IN==
SC7301                 ==(W69-I)==    BY ==W69-IN==
SC7301                 ==(WA-INPUT)== BY ==WA-11041==.
032910     03  WA-IN-17046 REDEFINES WA-INPUT-MSG.
032920         05  FILLER                      PIC X(16).
032930         05  WA-IN-17046-NAME            PIC X(60).
032940         05  WA-IN-17046-OLD-BRANCH      PIC 9999.
032950         05  WA-IN-17046-CURRENCY        PIC XXX.
032960         05  WA-IN-17046-OLD-ACCT-TYPE   PIC 9999.
032970         05  WA-IN-17046-DESC            PIC X(30).
032980         05  WA-IN-17046-OLD-ACCT-CAT    PIC 9999.
032990         05  WA-IN-17046-NEW-BRANCH      PIC 9999.
033000         05  WA-IN-17046-NEW-ACCT-TYPE   PIC 9999.
033010         05  WA-IN-17046-NEW-ACCT-CAT    PIC 9999.
033020         05  FILLER                      PIC X(849).
033030     03  WA-IN-10500 REDEFINES WA-INPUT-MSG.
033040         05  WA-IN-10500-ACCT-NO         PIC 9(16).
033050         05  WA-IN-10500-OPTION          PIC X.
033060             88  WA-IN-PRINT-COVER-ONLY  VALUE "Y".
033070         05  FILLER                      PIC X(965).
033080     03  WA-IN-17050 REDEFINES WA-INPUT-MSG.
033090         05  FILLER                      PIC X(308).
033100         05  WA-IN-17050-OLD-INT-CAT     PIC 9(4).
033110         05  FILLER                      PIC X(670).
033120     03  TRF-AREA  REDEFINES  WA-INPUT-MSG.
033130         05  W800-FROM-ACCT              PIC 9(16).
033140         05  W800-BAL                    PIC S9(14)V999
033150                                         TRAILING SEPARATE.
033160         05  W800-TRF-AMOUNT             PIC S9(14)V999
033170                                         TRAILING SEPARATE.
033180         05  W800-TRF-AMOUNT-R REDEFINES W800-TRF-AMOUNT
033190                                         PIC X(18).
033200         05  FILLER                      PIC XX.
033210         05  W800-TRF-DATE               PIC 9(8).
033220         05  W800-PROMO-NO               PIC XX.
033230         05  W800-TO-ACCT                PIC 9(16).
SC4522         05  FILLER REDEFINES W800-TO-ACCT.
SC4522             07 JS-ENT-CODE              PIC 9(5).
SC4522                 88 ENT-CODE             VALUE 69999.
SC4522             07 JS-COMPANY-CODE          PIC 9(5).
SC4522             07 JS-PAY-TYPE              PIC 9(3).
SC4522             07 FILLER                   PIC X(3).
033240         05  FILLER                      PIC XX.
033250*
033260         05  W800-CHQ-DAYS               PIC XX.
033270         05  W800-DEF-INT-DAYS           PIC 99.
033280         05  W800-DEB-DEF-INT-DAYS       PIC 99.
033290*
033300         05  FILLER                      PIC X(146).
033310         05  W800-CORR-JRNL-NO           PIC 9(6).
TB0157*SC4624  05  FILLER                      PIC X(110).
SC4624         05  FILLER                      PIC X(88).
SC4624         05  W800-TO-IN23-SYS            PIC X(3).
SC4624         05  W800-TO-IN23-ACCT           PIC X(16).
SC4624         05  W800-TO-IN24-SYS            PIC X(3).
TB0157         05  W800-TO-IN24-ACCT           PIC X(16).
TB0157         05  FILLER                      PIC X(616).
033320*TB0157  05  FILLER                      PIC X(742).
TB0157         03  TRF-AREA1  REDEFINES  WA-INPUT-MSG.
TB0157         05  FILLER                      PIC X(150).
TB0157         05  W800-ACCT-CURR-CD           PIC XXX.
TB0157         05  W800-CURR-AMT               PIC S9(14)V999
TB0157                                         TRAILING SEPARATE.
TB0157         05  W800-CURR-AMT-CURR-CD       PIC XXX.
TB0157         05  W800-BASE-CURR-AMT          PIC S9(14)V999
TB0157                                         TRAILING SEPARATE.
TB0157         05  W800-COMMISSION             PIC S9(14)V999
TB0157                                         TRAILING SEPARATE.
TB0157         05  W800-CHANGE                 PIC S9(14)V999
TB0157                                         TRAILING SEPARATE.
TB0157         05  W800-RATE-TYPE              PIC 99.
TB0157         05  W800-CURR-VERSION           PIC X(4).
TB0157         05  FILLER                      PIC X(748).
033330*
033340****************************************************************
033350*   THE FOLLOWING STUFF IS USED TO CATER FOR EFT TRANSACTION   *
033360*   REFRESH FOR A LOAN ACCOUNT, RETROFITTED FROM ING/ICU       *
033370*** 760167 BEGIN ***********************************************
033380*
033390     03  FILLER REDEFINES WA-INPUT-MSG.
033400         05  WA-INPUT-KEY-O              PIC X(16).
033410         05  WA-INPUT-KEY-R1
033420             REDEFINES  WA-INPUT-KEY-O   PIC 9(16).
033430         05  REDEFINES  WA-INPUT-KEY-O.
033440           07  FILLER                    PIC XXX.
033450           07  WA-INPUT-KEY-BRANCH       PIC 9999.
033460           07  FILLER                    PIC X(9).
033470         05  WA-INPUT-BAL                PIC S9(14)V999
033480                                         SIGN TRAILING SEPARATE.
033490         05  WA-INPUT-AMT-1              PIC S9(14)V999
033500                                         SIGN TRAILING SEPARATE.
033510         05  FILLER                      PIC X(219).                     
033520         05  WA-ATM-FIELDS.
033530           07  WA-ATM-FIELDS-A           PIC X(1).
033540*&&&*
033550*&&&* THE FIELDS BELOW SEEM TO BE REDUNDANT.
033560*&&&* ONLY FIELD WA-ATM-SEQ-NO IS BEING USED AS A TELEPAC
033570*&&&*  UNIQUE JOURNAL NUMBER (POPULATED IN LINKIN).
033580*&&&*  PROBLEM HOWEVER ARISES WITH TRANSFERS; BECAUSE THE ORIGINAL
033590*&&&*  OFFSETS BEFORE ED0000 HAS NOT BEEN CATERED FOR.
033600*&&&* THE TELEPAC JOURNAL/SEQUENCE NUMBER SHOULD REALLY BE IN STRT     
033610*&&&*  AS A TEMPORARY & URGENT SOLUTION, I HAVE CATERED FOR THE OF      
033620*&&&* BUT TO DO THIS I HAVE TO MOVE WA-ATM-ATM-SEQ-NO OUT OF THE A   
033630*&&&*  POPULATED BY LINKIN.
033640*&&&*
033650           07  WA-ATM-FIELDS-B.
033660             09  WA-ATM-CARD-NO.
033670               10  WA-VISA-CARD-NO       PIC 9(16).
033680               10  FILLER                PIC XXXX.
033690***                                                                     
033700*** TO CORRECT THE OFFSET PROBLEM FOR TRANSFERS, THE FOLLOWING          
033710*** FIELDS WERE TRANSFERRED TO STRTREST                                 
033720***                                                                     
033730             09  FILLER                  PIC X(11).                     
033740*            09  WA-ATM-INT-TRACE-NO     PIC 9(6) COMP.                 
033750*            09  WA-ATM-SEQ-NO           PIC 9(6) COMP.                 
033760*            09  WA-ATM-TXN-TYPE         PIC XX.                        
033770*            09  WA-ATM-UPDT-FLAG-1      PIC X.                         
033780*&&&*
033790         05  WA-ATM-ATM-SEQ-NO           PIC 9(6) COMP.
033800         05  WA-ATM-TXN-TIME             PIC 9(8) COMP.
033810         05  FILLER                      PIC X(02).
033820         05  WA-INPUT-CLEAR-CODE         PIC XX.
033830         05  WA-ATM-TXN-DATE             PIC S9(9) BINARY.
033840         05  FILLER                      PIC X(651).
033850         05  WA-INPUT-MSG-TYPE-X.
033860             10 WA-INPUT-MSG-TYPE        PIC XX.
033870         05  FILLER                      PIC X(10).
033880*
033890     03  IN0002-INPUT-MESSAGE  REDEFINES WA-INPUT-MSG.
033900         05  IN0002-INPUT-KEY.
033910             07  IN0002-INPUT-ACCT-NO    PIC 9(16).
033920         05  IN0002-MSG.
033930             07  IN0002-REASON-NO        PIC 99.
033940             07  IN0002-REASON           PIC X(18).
033950             07  IN0002-JRNL-NO          PIC 9(6).
033960             07  IN0002-CARD-NO          PIC 9(16).
033970         05  IN0002-MSG-R  REDEFINES IN0002-MSG.
033980             07  IN0002-STOP-NO          PIC 99.
033990             07  FILLER                  PIC X(40).
034000         05  IN0002-INPUT-PROMO-12120.                                   
034010             07  IN0002-PROMO-CODE       PIC X(2).                       
034020         05  FILLER                      PIC X(922).                     
034030*        05  FILLER                      PIC X(924).                     
034040     03  TPATM-INPUT-MESSAGE-1  REDEFINES WA-INPUT-MSG.
034050         05  TPATM-INPUT-KEY-1.
034060             07  TPATM-INPUT-ACCT-NO-1  PIC 9(16).
034070         05  TPATM-BALANCE              PIC S9(14)V999
034080             SIGN IS TRAILING SEPARATE.
034090         05  TPATM-AMOUNT               PIC S9(14)V999
034100             SIGN IS TRAILING SEPARATE.
034110         05  TPATM-CHQ-NO               PIC 9(8).
034120         05  TPATM-TXN-DATE             PIC 9(8).
034130         05  TPATM-BATCH-NO             PIC XX.
034140         05  TPATM-NAMES.
034150             07  TPATM-NAME-1           PIC X(30).
034160             07  TPATM-NAME-1-R  REDEFINES  TPATM-NAME-1.
034170                 09  TPATM-1ST-BYTE     PIC X.
034180                 09  TPATM-NAME-NO      PIC XX.
034190                 09  TPATM-NAME-NO-R  REDEFINES TPATM-NAME-NO.
034200                     11  TPATM-NAME-NO-1  PIC X.
034210                     11  TPATM-NAME-NO-2  PIC X.
034220                 09  FILLER              PIC X(27).
034230             07  TPATM-NAME-2           PIC X(30).
034240         05  TPATM-TERM-AREA.
034250             10 TPATM-TERM-PENALTY-DAYS    PIC 9(4).
034260             10 TPATM-DAYS-R REDEFINES TPATM-TERM-PENALTY-DAYS
034270                                           PIC X(4).
034280             10 TPATM-TERM-PENALTY-RATE    PIC 99V9999.
034290             10 TPATM-RATE-R REDEFINES TPATM-TERM-PENALTY-RATE
034300                                           PIC X(6).
034310             10 TPATM-TERM-PENALTY-EXEMPT  PIC X.
034320             10 FILLER                      PIC X(841).
034330*
034340     03  TPATM-VISA-AREA REDEFINES WA-INPUT-MSG.
034350             07  FILLER                  PIC X(510).
034360             07  TPATM-PURCH-DATE       PIC 9(8).
034370             07  TPATM-EXPIRY-DATE REDEFINES TPATM-PURCH-DATE
034380                                         PIC 9(8).
034390             07  TPATM-BIN-NO           PIC 9(6).
034400             07  TPATM-RETRIEVAL-REF    PIC X(23).
034410             07  TPATM-MERCH-NAME       PIC X(25).
034420             07  TPATM-MERCH-CITY       PIC X(13).
034430             07  TPATM-MERCH-CTRY-CODE  PIC XX.
034440             07  TPATM-FOREIGN-CURR-AMT PIC S9(14)V999
034450                 SIGN IS TRAILING SEPARATE.
034460             07  TPATM-FOR-0X REDEFINES TPATM-FOREIGN-CURR-AMT.
034470                 09  FILLER                  PIC X(14).
034480                 09  TPATM-FOR-0-DECS       PIC 999.
034490                 09  FILLER                  PIC X.
034500             07  TPATM-FOR-1X REDEFINES TPATM-FOREIGN-CURR-AMT.
034510                 09  FILLER                  PIC X(15).
034520                 09  TPATM-FOR-1-DECS       PIC 99.
034530                 09  FILLER                  PIC X.
034540             07  TPATM-FOR-2X REDEFINES TPATM-FOREIGN-CURR-AMT.
034550                 09  FILLER                  PIC X(16).
034560                 09  TPATM-FOR-2-DECS       PIC 9.
034570                 09  FILLER                  PIC X.
034580* ATM DETAILS
034590             07  FILLER                      PIC X(55).
034600             07  TPATM-CARD-NO              PIC 9(16).
034610             07  TPATM-TPAC-POST-TIME       PIC 9(8).
034620             07  TPATM-TPAC-R-POST-TIME REDEFINES
034630                      TPATM-TPAC-POST-TIME  PIC X(8).
034640             07  FILLER                      PIC X(298).
034650*
034660     03  TPVISA-INPUT-MESSAGE  REDEFINES WA-INPUT-MSG.
034670         05  TPVISA-INPUT-KEY.
034680             07  TPVISA-INPUT-ACCT-NO    PIC 9(16).
034690         05  TPVISA-BALANCE              PIC S9(14)V999
034700             SIGN IS TRAILING SEPARATE.
034710         05  TPVISA-AMOUNT               PIC S9(14)V999
034720             SIGN IS TRAILING SEPARATE.
034730         05  TPVISA-CLEAR-CODE           PIC XX.
034740         05  TPVISA-TXN-DATE             PIC 9(8).
034750         05  TPVISA-BATCH-NO             PIC XX.
034760         05  TPVISA-DEFER-DAYS           PIC 99.
034770         05  TPVISA-DESC-AREA            PIC X(74).
034780         05  FILLER  REDEFINES  TPVISA-DESC-AREA.
034790             07  TPVISA-BANK-NUMBER      PIC X(4).
034800             07  TPVISA-REGION-ID        PIC X(4).
034810             07  TPVISA-ITEMS            PIC 9(3).
034820             07  FILLER                  PIC X(63).
034830         05  TPVISA-TRF-AREA.
034840             07 TPVISA-TRF-VOUCHER-NO    PIC 9(8).
034850             07 FILLER                   PIC X.
034860         05  TPVISA-DR-CR-AREA REDEFINES TPVISA-TRF-AREA.
034870             07 FILLER                   PIC X.
034880             07 TPVISA-DR-CR-VOUCHER-NO  PIC 9(8).
034890         05  FILLER                      PIC X(833).
034900*
034910***  DEFINE MULTI-CURRENCY FIELDS.
034920     03  TPVISA-INPUT-MESSAGE1 REDEFINES WA-INPUT-MSG.
034930         05  FILLER                      PIC X(150).
034940         05  TPVISA-ACCT-CURR-CD         PIC XXX.
034950         05  TPVISA-CURR-AMT             PIC S9(14)V999
034960                                         TRAILING SEPARATE.
034970         05  TPVISA-CURR-AMT-CURR-CD     PIC XXX.
034980         05  TPVISA-BASE-CURR-AMT        PIC S9(14)V999
034990                                         TRAILING SEPARATE.
035000         05  TPVISA-COMMISSION           PIC S9(14)V999
035010                                         TRAILING SEPARATE.
035020         05  TPVISA-CHANGE               PIC S9(14)V999
035030                                         TRAILING SEPARATE.
035040         05  TPVISA-RATE-TYPE            PIC 99.
035050         05  TPVISA-CURR-VERSION         PIC X(4).
035060         05  TPVISA-CORR-JRNL-NO         PIC 9(6).
035070         05  WA-INPUT-LIMIT-NO           PIC 9(17).
035080         05  FILLER                      PIC X(725).
035090*
035100*** 74I012 END ***
035110* START
035120     03  FILLER REDEFINES WA-INPUT-MSG.
035130****   TRANS/SCREEN: 10422 - LOAN ACCOUNTS
035140         05  IN10422-I-KEY.
035150             07 IN10422-I-ACCT-NO            PIC 9(16).
035160             07 IN10422-I-FROM-DATE              PIC 9(8).
035170             07 IN10422-I-TO-DATE                PIC 9(8).
035180             07  FILLER                          PIC X(950).
035190* END
035200*
035210     03  IN0020-INPUT-MESSAGE  REDEFINES WA-INPUT-MSG.                   
035220         05  IN0020-INPUT-KEY.
035230             07  IN0020-INPUT-ACCT-NO    PIC 9(16).
035240         05  IN0020-BALANCE              PIC S9(14)V999
035250             SIGN IS TRAILING SEPARATE.
035260         05  IN0020-AMOUNT               PIC S9(14)V999
035270             SIGN IS TRAILING SEPARATE.
035280         05  IN0020-CHQ-NO               PIC 9(8).
035290         05  IN0020-TXN-DATE             PIC 9(8).
035300         05  IN0020-BATCH-NO             PIC XX.
035310         05  IN0020-NAMES.
035320             07  IN0020-NAME-1           PIC X(30).
035330             07  IN0020-NAME-1-R  REDEFINES  IN0020-NAME-1.
035340                 09  IN0020-1ST-BYTE     PIC X.
035350                 09  IN0020-NAME-NO      PIC XX.
035360                 09  IN0020-NAME-NO-R  REDEFINES IN0020-NAME-NO.
035370                     11  IN0020-NAME-NO-1  PIC X.
035380                     11  IN0020-NAME-NO-2  PIC X.
035390                 09  FILLER              PIC X(27).
035400             07  IN0020-NAME-2           PIC X(30).
035410         05  IN0020-TERM-AREA.
035420          10 IN0020-TERM-PENALTY-DAYS    PIC 9(4).
035430          10 IN0020-DAYS-R REDEFINES IN0020-TERM-PENALTY-DAYS
035440                                         PIC X(4).
035450          10 IN0020-TERM-PENALTY-RATE    PIC 99V9999.
035460          10 IN0020-RATE-R REDEFINES IN0020-TERM-PENALTY-RATE
035470                                         PIC X(6).
035480          10 IN0020-TERM-PENALTY-EXEMPT  PIC X.
035490          10 FILLER                      PIC X(841).
035500     03  UTCORR-INPUT-MESSAGE  REDEFINES WA-INPUT-MSG.                   
035510         05  UTCORR-INPUT-ACCT-NO        PIC 9(16).
035520         05  UTCORR-INPUT-FUNC           PIC X.
035530             88 UTCORR-INPUT-VALID-FUNC  VALUES "A" "C" "E" "X".
035540             88 UTCORR-INPUT-AMEND-FUNC  VALUE  "A".
035550             88 UTCORR-INPUT-CREATE-FUNC VALUE  "C".
035560             88 UTCORR-INPUT-ENQ-FUNC    VALUE  "E".
035570             88 UTCORR-INPUT-EXIT-FUNC   VALUE  "X".
035580         05  FILLER                      PIC X(965).
TB0215     03  INPUT-10724-MSG REDEFINES WA-INPUT-MSG.
TB0215         05  INPUT-10724-ACCT-NO         PIC 9(16).
S15877*TB0215         05  INPUT-10724-CUST-NO         PIC 9(16).
S15877         05  INPUT-10724-CUST-NO         PIC X(16).
S15877         05  INPUT-10724-ID-TYPE         PIC 9(2).
TB0215         05  INPUT-10724-TYPE            PIC 9(1).
TB0215         05  INPUT-10724-TAX-YEAR        PIC 9(4).
S15877         05  FILLER                      PIC X(943).
S15877*TB0215         05  FILLER                      PIC X(945).
TB0215     03  INPUT-10726-MSG REDEFINES WA-INPUT-MSG.
TB0215         05  INPUT-10726-ACCT-NO         PIC X(16).
TB0215         05  INPUT-10726-NAME            PIC X(60).
TB0215         05  INPUT-10726-REP-MONTH.
TB0215             07 INPUT-10726-REP-MM       PIC X(2).
TB0215             07 INPUT-10726-REP-YYYY     PIC X(4).
TB0215         05  INPUT-10726-REP-DATE        PIC X(8).
TB0215         05  INPUT-10726-REPRINT-FLAG    PIC X(1).
TB0215         05  INPUT-10726-ACCT-IND        PIC X(1).
TB0215         05  INPUT-10726-TRAN-IND        PIC 9(1).
TB0215         05  INPUT-10726-CUSM-NO         PIC 9(16).
TB0215         05  INPUT-10726-TYPE            PIC X(2).
S18252         05  INPUT-10726-RANGE-MONTH     PIC 9(12).
S18252         05  INPUT-10726-NPL-FLAG        PIC X(1).
S18252         05  INPUT-10726-ADDR-SEL        PIC X(1).
S18252         05  FILLER                      PIC X(857).
S18252*TB0215  05  FILLER                      PIC X(871).
TB0215*
SC2620     03  BR0001-SH-INPUT REDEFINES WA-INPUT-MSG.
SC2620         05  BR0001-SH-INPUT-KEY         PIC 9(16).
SC2620         05  BR0001-SH-ENQ-TYPE          PIC X.
SC2620         05  FILLER                      PIC X(965).
ST0058     03  BR0000-ATM-INPUT REDEFINES WA-INPUT-MSG.
ST0058         05  WA-ATM-ACCT-FILLER          PIC 9(16).
ST0058         05  FILLER                      PIC X(21).
ST0058         05  WA-ATM-PROMO-NO             PIC XX.
S19100             88 WSP-STRF-PROMO    VALUE "FP" "FQ".
ST0058         05  FILLER                      PIC X(943).
ST0071     03  WA-BRMG-FEE-TXN  REDEFINES WA-INPUT-MSG.
ST0071         05  FILLER                      PIC X(804).
ST0071         05  WS-W800-SUSP-FEE-ACCT       PIC 9(16).
ST0071         05  WS-W800-TXN-FEE             PIC 9(5).
ST0071         05  FILLER                      PIC X(157).
SC9559     03  FILLER REDEFINES WA-INPUT-MSG.
SC9559         05  FILLER                      PIC X(508).
SC9559         05  WS-API-INDICATOR            PIC X(4).
SC9559             88 API-PRSB-FILE            VALUE "PRSB".
S16976             88 API-NRSB-FILE            VALUE "NRSB".
SC9559         05  FILLER                      PIC X(470).
SC7443     03  WA-ATM-CARD-CLOSE-AREA REDEFINES WA-INPUT-MSG.
SC7443         05  ATM-I-CARD-ACCT-NO          PIC X(16).    
SC7443         05  ATM-I-CARD-NO               PIC 9(10).    
SC7443         05  ATM-I-EMB-CARD              PIC X.        
SC7443         05  ATM-I-FUNC-CODE             PIC 9.        
SC7443         05  ATM-I-ID-TYPE               PIC XX.       
SC7443         05  ATM-I-ID-NO                 PIC X(14).    
SC7443         05  ATM-I-HOME-BRANCH           PIC 9(4).     
SC7443         05  FILLER                      PIC X(934).   
S11833     03  WA-17200 REDEFINES WA-INPUT-MSG.
S11833         05 FILLER                       PIC X(16).
S11833         05 WA-17200-FUNC                PIC X(02).
S11833         05 FILLER                       PIC X(26).
S11833         05 WA-17200-YOUBE-STOP          PIC X(01).
S16013         05 FILLER                       PIC X(334).
S16013         05 WA-IN-17200-2-FLAG           PIC X(01).
S16013         05 FILLER                       PIC X(602).
S16013*S11833  05 FILLER                       PIC X(937).
S11877     03  WA-10430-MSG REDEFINES WA-INPUT-MSG.
S11877         05 WA-10430-ACCT-NO             PIC 9(16).
S11877         05 WA-10430-TYPE                PIC X(01).
S11877         05 WA-10430-SEGMENT             PIC X(01).
S11877         05 WA-10430-DATE                PIC X(08).
S11877         05 WA-10430-PROJ-DATE           PIC X(08).
S11877         05 WA-10430-AMOUNT              PIC 9(14)V999.
S11877         05 WA-10430-PROMO-CODE          PIC X(02).
S11877         05 FILLER                       PIC X(929).
S11877*
S12056     03  WA-20045-VOUCHER REDEFINES WA-INPUT-MSG.
S12056         05  WA-20045-FROM-GL-ACCT       PIC 9(16).
S12056         05  WA-20045-TRAN-AMT           PIC S9(14)V999
S12056                             SIGN IS TRAILING SEPARATE.
S12056         05  WA-20045-DESC               PIC X(12).
S12056         05  FILLER                      PIC X(15).
S12056         05  WA-20045-PROMO-NO           PIC X(02).
S12056         05  FILLER                      PIC X(01).
S12056         05  WA-20045-TO-GL-ACCT         PIC 9(16).
S12056         05  WA-20045-PURPOSE-TRF1       PIC X(30).
S12056         05  WA-20045-PURPOSE-TRF2       PIC X(30).
S12056         05  FILLER                      PIC X(10).
S12056         05  WA-20045-ACC-CURR-CODE      PIC X(03).
S12056         05  WA-20045-ETXN-AMT           PIC S9(14)V999
S12056                            SIGN IS TRAILING SEPARATE.
S12056         05 FILLER                       PIC X(811).
S12215     03  WA-17003-MSG REDEFINES WA-INPUT-MSG.
S12215         05  FILLER                      PIC X(604).
S12215         05  BR0001-BAD-DEBT-AMOUNT      PIC S9(14)V999
S12215                                         TRAILING SEPARATE.
S12215         05  FILLER                      PIC X(360).
S15963     03  WA-2057-MSG  REDEFINES WA-INPUT-MSG.
S15963         05  IN0095-IN-2057-DEP-NO       PIC 9(16).
S15963         05  IN0095-IN-2057-ID-NO        PIC X(16).
S15963         05  IN0095-IN-2057-CUST-NAME    PIC X(40).
S15963         05  IN0095-IN-2057-ACTION-CODE  PIC X.
S15963         05  FILLER                      PIC X(909).
S16588     03  WA-17085-MSG  REDEFINES WA-INPUT-MSG.
S16588         05  WA-IN-17085-ACCT-NO         PIC 9(16).
S16588         05  WA-IN-17085-ACCT-NAME       PIC X(60).
S16588         05  WA-IN-17085-PEN-METH        PIC X.
S16588             88  WA-IN-17085-VLD-PEN     VALUE "0" THRU "7".
S16588         05  WA-IN-17085-PEN-TERM1       PIC X(08).
S16588         05  WA-IN-17085-PEN-WEIGHT1     PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-IN-17085-PEN-TERM2       PIC 9(08).
S16588         05  WA-IN-17085-PEN-WEIGHT2     PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-IN-17085-RESET-PRIN      PIC X.
S16588             88  WA-IN-17085-VLD-RESET   VALUE "Y" "N".
S16588         05  WA-IN-17085-START-DATE      PIC X(08).
S16588         05  WA-IN-17085-CR-FIX-AMT      PIC S9(14)V999
S16588                                             TRAILING SEPARATE.
S16588         05  WA-IN-17085-CR-PERCENT      PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-IN-17085-ACCU-PRIN       PIC S9(14)V999
S16588                                             TRAILING SEPARATE.
S16588         05  WA-IN-17085-THRESH-FLAG     PIC X.
S16588         05  WA-IN-17085-CLOSE-METH      PIC X.
S19314*S16588      88  WA-IN-17085-VLD-CLOSE   VALUE "0" THRU "5".
S19314             88  WA-IN-17085-VLD-CLOSE   VALUE "0" THRU "6".
S16588         05  WA-IN-17085-CLOSE-TERM1     PIC X(08).
S16588         05  WA-IN-17085-CLOSE-FCTR1     PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-IN-17085-CLOSE-TERM2     PIC 9(08).
S16588         05  WA-IN-17085-CLOSE-FCTR2     PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-IN-17085-CLOSE-OPTION    PIC X.
S16588             88  WA-IN-17085-VLD-OPT     VALUE "A" "E".
S16588         05  WA-IN-17085-AUTOLINK        PIC X.
S17067         05  WA-IN-17085-CLOSE-TERM3     PIC 9(08).
S17067         05  WA-IN-17085-CLOSE-FCTR3     PIC S999V9(4)
S17067                                             TRAILING SEPARATE.
S19421         05  WA-IN-17085-ADV-VAL         PIC S9(14)V999
S19421                                             TRAILING SEPARATE.
S19421         05  WA-IN-17085-LOAN-BAL        PIC S9(14)V999
S19421                                             TRAILING SEPARATE.
S19421         05  WA-IN-17085-FIRST-ADV-DATE  PIC X(8).
S19421         05  WA-IN-17085-MATURITY-DATE   PIC X(8).
S19421         05  WA-IN-17085-CLOSE-ADV-DATE  PIC X(8).
S19421         05  WA-IN-17085-CLOSE-PRIN      PIC S9(14)V999
S19421                                             TRAILING SEPARATE.
S19421         05  FILLER                          PIC X(690).
S19421*S17067         05  FILLER                          PIC X(768).
S17067**S16588 05  FILLER                          PIC X(784).
S16871
S16871     03  WA-IN-87000-MSG  REDEFINES WA-INPUT-MSG.
S16871         05  WA-IN-87000-TRNCODE         PIC X(05).
S16871         05  WA-IN-87000-ACTNO           PIC X(16).
S16871         05  WA-IN-87000-ODNO            PIC X(16).
S16871         05  WA-IN-87000-SEQNO           PIC X(10).
S16871         05  WA-IN-87000-SYSTEM          PIC X(10).
S16871         05  WA-IN-87000-IUSER           PIC X(10).
S16871         05  WA-IN-87000-ACTION          PIC X(10).
S16871         05  WA-IN-87000-CCY             PIC X(03).
S16871         05  WA-IN-87000-AMOUNT          PIC 999999999999999.
S17726         05  WA-IN-87000-ACTNO-REL       PIC X(16).
S17726         05  WA-IN-87000-ODNO-REL        PIC X(16).
S17726         05  WA-IN-87000-SEQNO-REL       PIC X(10).
S17726         05  WA-IN-87000-SYSTEM-REL      PIC X(10).
S17726         05  WA-IN-87000-IUSER-REL       PIC X(10).
S17726         05  WA-IN-87000-ACTION-REL      PIC X(10).
S17726         05  WA-IN-87000-CCY-REL         PIC X(03).
S17726         05  WA-IN-87000-AMOUNT-REL      PIC 999999999999999.
S17726         05  FILLER                      PIC X(797).
S17726*S16871  05  FILLER                      PIC X(887).
035600*
035610     02  WA-OUTPUT-MESSAGE.
035620     03  WA-OUTPUT-ERR-MSG-NO            PIC 9999.
035630     03  WA-OUTPUT-MSG-LENGTH            PIC 9999.
035640     03  WA-OUTPUT-MSG                   PIC X(983).
SC4453     03  WS-VIRTUAL-MSG REDEFINES WA-OUTPUT-MSG.
SC4453         05  WS-ENTERPRISE-CODE        PIC 9(5).
SC4453         05  WS-TXN-DATE               PIC 9(8).
SC4453         05  WS-TXN-TIME               PIC 9(8).
SC4453         05  WS-NOMINATED-ACCT-NO      PIC 9(16).
SC4453         05  WS-CUST-ID-NO             PIC X(12).
SC4453         05  WS-DEPOSIT-AMOUNT         PIC S9(14)V999
SC4453                            SIGN IS TRAILING SEPARATE.
SC4453         05  WS-CHANNEL                PIC X(4).
SC4453         05  WS-TRANSFER-BANK          PIC 9(3).
SC4453         05  WS-TRANSFER-BRANCH        PIC 9(4).
SC4453         05  WS-TXN-BRANCH             PIC 9(4).
SC4453         05  WS-REMITTER-NAME          PIC X(20).
SC4453         05  WS-TELL-NO                PIC 9(6).
SC4453         05  WS-TERM-NO                PIC 9(3).
SC4453         05  WS-JRNL-NO                PIC 9(6).
SC4453         05  WS-PYMT-CODE              PIC X.
SC4453         05  WS-REF-NO                 PIC X(14).
SC4453         05  WS-SYS-DATE               PIC 9(8).
SC4453         05  WS-FEE-CHARGE             PIC 9(3).
SC4453         05  WS-TERM-ID                PIC X(8).
SC4453         05  WS-VT-ACCT                PIC 9(16).
SC4453         05  WS-STAN-NO                PIC 9(10).
SC4453         05  FILLER                    PIC X(806).
TB0169*
TB0169     03  WA-OUT-12006 REDEFINES WA-OUTPUT-MSG.
TB0169         05  WA-12006-ACCT-NO            PIC 9(17).
TB0169         05  WA-12006-CUST-NO            PIC 9(17).
TB0169         05  WA-12006-ID-NO              PIC X(16).
TB0169         05  WA-12006-NAME               PIC X(60).
TB0169         05  WA-12006-DUES-START-DATE    PIC 9(8).
TB0169         05  WA-12006-CREDIT-INV         PIC X(10).
TB0169         05  WA-12006-APPROVAL-OFFICER   PIC X(10).
TB0169         05  WA-12006-EXEC-SUP           PIC X(11).
TB0169         05  WA-12006-ACCT-OFFICER       PIC X(10).
TB0169         05  WA-12006-OTHR-ACCT-OFFICER  PIC X(10).
TB0169         05  WA-12006-CSLD-STMT-PROS     PIC X.
TB0169         05  WA-12006-SOURCE-CDE-N       PIC 99.
TB0169         05  FILLER                      PIC X(3).
TB0169         05  WA-12006-GTEE-NO-1          PIC 9(16).
TB0169         05  WA-12006-GTEE-NO-2          PIC 9(16).
TB0169         05  WA-12006-GTEE-NO-3          PIC 9(16).
TB0169         05  WA-12006-PAYEE-ID-1         PIC X(11).
TB0169         05  WA-12006-PAYEE-ID-2         PIC X(11).
TB0169         05  WA-12006-PAYEE-ID-3         PIC X(11).
TB0169         05  WA-12006-COMM-RATE-1        PIC S9(3)V9(4)
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12006-COMM-RATE-2        PIC S9(3)V9(4)
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12006-COMM-RATE-3        PIC S9(3)V9(4)
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12006-PREV-ACCT-NO-1     PIC 9(17).
TB0169         05  WA-12006-PREV-ACCT-NO-2     PIC 9(17).
TB0169         05  WA-12006-INS-CDE            PIC X.
TB0169         05  WA-12006-CREDIT-INS         PIC 9(2).
TB0169         05  WA-12006-CREDIT-COND        PIC X(40).
TB0169         05  WA-12006-DET-FEE            PIC S9(14)V999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12006-RECEIV-FEE         PIC S9(14)V999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12006-921-FLAG           PIC X.
TB0169         05  WA-12006-OD-ACCT-NO         PIC 9(16).
TB0169         05  WA-12006-LIQ-ASSET-PLEDG    PIC X(1).
TB0169         05  WA-12006-BUS-COMM           PIC 9(5).
TB0169         05  WA-12006-BANK-RATE          PIC S9(3)V9(4)
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12006-PAYMT-EXP          PIC X(1).
TB0169         05  WA-12006-CARLN-SUB-PROJ     PIC X(1).
TB0169         05  WA-12006-MARK-OFNEW-ADDLN   PIC X(1).
TB0169         05  WA-12006-ADDTL-APPR-AMT     PIC S9(14)V999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12006-ACCT-OFF-FL        PIC X(1).
TB0169         05  WA-12006-OTHR-ACCT-OFF-FL   PIC X(1).
TB0169         05  WA-12006-FACILITY-NO.
TB0169             07 WA-12006-FAC-NO-16       PIC 9(16).
TB0169             07 WA-12006-FAC-CHK-DGT     PIC 9.
TB0169         05  WA-12006-CHG-FAC-IND        PIC X.
TB0169***- 033003
TB0169         05  WA-12006-REFERRAL-FEE-TYP   PIC 9(3).
SC1551         05  FILLER                      PIC 9(3).
SC1551         05  WA-12006-ACCT-TYPE          PIC X(4).
SC1551         05  WA-12006-INT-CAT            PIC X(4).
S15238         05  WA-12006-INSU-RATE          PIC S9(3)V9(4)
S15238                                         TRAILING SEPARATE.
S15813         05  WA-12006-SOURCE-ADV-DATE    PIC 9(08).
S16668         05  WA-12006-GOV-SER-NO         PIC X(14).
S16668         05  FILLER                      PIC X(474).
S16668*S15813         05  FILLER                      PIC X(488).
S15813*S15238         05  FILLER                      PIC X(496).
S15238*SC1551  05  FILLER                      PIC X(504).
TB0169*SC1551  05  FILLER                      PIC X(515).
TB0169***      05  FILLER                      PIC X(518).
TB0169***- 033003 end
TB0169     03  WA-OUT-12007 REDEFINES WA-OUTPUT-MSG.
TB0169         05  WA-12007-ACCT-NO            PIC 9(17).
TB0169         05  WA-12007-CUST-NO            PIC 9(17).
TB0169         05  WA-12007-ID-NO              PIC X(16).
TB0169         05  WA-12007-NAME               PIC X(60).
TB0169         05  WA-12007-APPR-AMT           PIC S9(14)V999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12007-FSTDD-DATE         PIC 9(8).
TB0169         05  WA-12007-COST-EXP-DATE      PIC 9(8).
TB0169         05  WA-12007-RATE-EXP-DATE      PIC 9(8).
TB0169         05  WA-12007-DUESRCLC-IND       PIC X.
TB0169         05  WA-12007-EFR-CHG-IND-N      PIC X.
TB0169         05  WA-12007-CTA-REFER          PIC 9(16).
TB0169         05  WA-12007-INT-CAPN-FREQ      PIC X(3).
TB0169         05  WA-12007-IREPAY-NOT         PIC X(1).
TB0169         05  FILLER                      PIC X(1).
TB0169         05  WA-12007-IREPAY-NOT-DAYS    PIC 9(2).
TB0169         05  WA-12007-FACILITY-NO.
TB0169             07 WA-12007-FAC-NO-16       PIC 9(16).
TB0169             07 WA-12007-FAC-CHK-DGT     PIC 9.
TB0169         05  WA-12007-CHG-FAC-IND        PIC X.
S10968         05  WA-12007-SOURCE-CDE         PIC 99.
S12474         05  WA-12007-ACCT-OFFICER       PIC X(10).
S16000         05  WA-12007-BANK-RATE         PIC S9(3)V9(4)
S16000                                         TRAILING SEPARATE.
S16000         05  WA-12007-SUB-PROJ          PIC X(01).
S16000         05  FILLER                      PIC X(767).
S16000*S12474         05  FILLER                      PIC X(776).
S12474*S10968  05  FILLER                      PIC X(786).
S10968*TB0169  05  FILLER                      PIC X(788).
TB0169     03  WA-OUT-12008 REDEFINES WA-OUTPUT-MSG.
TB0169         05  WA-12008-ACCT-NO            PIC 9(17).
TB0169         05  WA-12008-CUST-NO            PIC 9(17).
TB0169         05  WA-12008-ID-NO              PIC X(16).
TB0169         05  WA-12008-NAME               PIC X(60).
TB0169         05  WA-12008-DUES-START-DATE    PIC 9(8).
TB0169         05  WA-12008-CREDIT-INV         PIC X(10).
TB0169         05  WA-12008-APPROVAL-OFFICER   PIC X(10).
TB0169         05  WA-12008-EXEC-SUP           PIC X(11).
TB0169         05  WA-12008-ACCT-OFFICER       PIC X(10).
TB0169         05  WA-12008-OTHR-ACCT-OFFICER  PIC X(10).
TB0169         05  WA-12008-CSLD-STMT-PROS     PIC X.
TB0169         05  WA-12008-SOURCE-CDE-N       PIC 99.
TB0169         05  WA-12008-ACCT-LIM           PIC S9(14)V999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12008-HIGH-INT-RATE      PIC S9(3)V9999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12008-CNTRCT-LIM-AMT     PIC S9(14)V999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12008-CNTRCT-RATE        PIC S9(3)V9999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12008-SCORING-LIM        PIC S9(14)V999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12008-SUGGEST-RATE       PIC S9(3)V9999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12008-PREF-INT-RATE      PIC S9(3)V9999
TB0169                                         TRAILING SEPARATE.
TB0169         05  WA-12008-PREF-INT-PERIOD    PIC 9(4).
TB0169         05  WA-12008-ACCT-OFF-FL        PIC X(1).
TB0169         05  WA-12008-OTHR-ACCT-OFF-FL   PIC X(1).
TB0169         05  WA-12008-CARD-USED-DT       PIC 9(8).
TB0169         05  WA-12008-START-METHOD       PIC X(2).
TB0169         05  WA-12008-REFERRAL-FEE-TYP   PIC 9(3).
TB0169         05  WA-12008-PROMO-CODE         PIC X(2).
TB0235         05  FILLER                      PIC X.
TB0235         05  WA-12008-SVD-FXD-RATE       PIC S9(3)V9999
TB0235                                         TRAILING SEPARATE.
SC1551         05  WA-12008-ACCT-TYPE          PIC X(4).
SC1551         05  WA-12008-INT-CAT            PIC X(4).
S10329         05  WA-12008-DIS-PROMO-CODE     PIC X(2).
S10329         05  WA-12008-DIS-EXP-DATE       PIC 9(8).
S11173         05  WA-12008-LIQ-ASSET-PLEDGE   PIC X(1).
S11173         05  WA-12008-CAR-REGIS-RET      PIC X(1).
S11173         05  WA-12008-PRODUCT-CODE       PIC X(8).
S12513         05  WA-12008-SUP-TELLER         PIC X(9).
S12513         05  FILLER                      PIC X(658).
S12513*S11173         05  FILLER                      PIC X(667).
S11173*S10329  05  FILLER                      PIC X(677).
SC1551*S10329  05  FILLER                      PIC X(687).
TB0235*SC1551  05  FILLER                      PIC X(695).
TB0169*        05  FILLER                      PIC X(704).
TB0169***      05  FILLER                      PIC X(719).
TB0169***- 033003 end
TB0169*
TB0069     03  WA-OUTPUT-NEGO-RATES REDEFINES WA-OUTPUT-MSG.
TB0069         05  WA-17026-ACCT-NO            PIC 9(17).
TB0069         05  WA-17026-ACTION             PIC X.
TB0069         05  WA-17026-REFER              PIC 9(9).
TB0069         05  WA-17026-NAME               PIC X(60).
TB0069         05  WA-17026-OCC  OCCURS 15.
TB0069           07 WA-17026-START-DT          PIC 9(8).
TB0069           07 WA-17026-RATE              PIC S999V9(4)
TB0069                                         TRAILING SEPARATE.
69IR32           07 WA-17026-FLOAT             PIC S99V9(5)
69IR32                                SIGN IS  TRAILING SEPARATE.
TB0069           07 WA-17026-RATE-FLAG         PIC X.
TB0069           07 WA-17026-POST-FLAG         PIC X.
TB0069           07 WA-17026-CREAT-DT          PIC 9(8).
TB0069           07 WA-17026-END-DATE          PIC 9(8).
TB0069         05  FILLER                      PIC X(266).
S16588     03  WA-OUTPUT-17085 REDEFINES WA-OUTPUT-MSG.
S16588         05  WA-OUT-17085-ACCT-NO        PIC 9(17).
S16588         05  WA-OUT-17085-ACCT-NAME      PIC X(60).
S16588         05  WA-OUT-17085-PEN-METH       PIC X.
S16588         05  WA-OUT-17085-PEN-TERM1      PIC X(08).
S16588         05  WA-OUT-17085-PEN-WEIGHT1    PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-OUT-17085-PEN-TERM2      PIC X(08).
S16588         05  WA-OUT-17085-PEN-WEIGHT2    PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-OUT-17085-RESET-PRIN     PIC X.
S16588         05  WA-OUT-17085-START-DATE     PIC X(08).
S16588         05  WA-OUT-17085-CR-FIX-AMT     PIC S9(14)V999
S16588                                             TRAILING SEPARATE.
S16588         05  WA-OUT-17085-CR-PERCENT     PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-OUT-17085-ACCU-PRIN      PIC S9(14)V999
S16588                                             TRAILING SEPARATE.
S16588         05  WA-OUT-17085-THRESH-FLAG    PIC X.
S16588         05  WA-OUT-17085-CLOSE-METH     PIC X.
S16588         05  WA-OUT-17085-CLOSE-TERM1    PIC X(08).
S16588         05  WA-OUT-17085-CLOSE-FCTR1    PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-OUT-17085-CLOSE-TERM2    PIC X(08).
S16588         05  WA-OUT-17085-CLOSE-FCTR2    PIC S999V9(4)
S16588                                             TRAILING SEPARATE.
S16588         05  WA-OUT-17085-CLOSE-OPTION   PIC X.
S16588             88  WA-OUT-17085-VLD-OPT    VALUE "A" "E".
S16588         05  WA-OUT-17085-AUTOLINK       PIC X.
S17067         05  WA-OUT-17085-CLOSE-TERM3    PIC X(08).
S17067         05  WA-OUT-17085-CLOSE-FCTR3    PIC S999V9(4)
S17067                                             TRAILING SEPARATE.
S19421         05  WA-OUT-17085-ADV-VAL        PIC S9(14)V999
S19421                                             TRAILING SEPARATE.
S19421         05  WA-OUT-17085-LOAN-BAL       PIC S9(14)V999
S19421                                             TRAILING SEPARATE.
S19421         05  WA-OUT-17085-FIRST-ADV-DATE PIC X(8).
S19421         05  WA-OUT-17085-MATURITY-DATE  PIC X(8).
S19421         05  WA-OUT-17085-CLOSE-ADV-DATE PIC X(8).
S19421         05  WA-OUT-17085-CLOSE-PRIN     PIC S9(14)V999
S19421                                             TRAILING SEPARATE.
S19421         05  FILLER                          PIC X(690).
S19421*S17067         05  FILLER                      PIC X(768).
S17067**S16588 05  FILLER                      PIC X(784).
TB0096     03  WA-OUT-10231 REDEFINES WA-OUTPUT-MSG.
TB0096         05  WA-OUT-10231-ACCT-NO        PIC 9(17).
TB0096         05  WA-OUT-BCKT-CD              PIC XX.
TB0096         05  WA-OUT-BCKT-DESC            PIC X(30).
TB0096         05  WA-OUT-BCKT-DET OCCURS 10.
TB0096             07 WA-OUT-TERM-NO           PIC 9(04).
TB0096             07 WA-OUT-BASE-DATE         PIC 9(08).
TB0096             07 WA-OUT-BASE-AMT          PIC S9(14)V999
TB0096                       TRAILING SEPARATE.
TB0096             07 WA-OUT-INT-RATE          PIC S9(3)V9(4)
TB0096                       TRAILING SEPARATE.
TB0096             07 WA-OUT-IND               PIC X.
TB0096             07 WA-OUT-ADW-AMT           PIC S9(6)V99
TB0096                       TRAILING SEPARATE.
TB0096             07 WA-OUT-REASON-CD         PIC 9(04).
TB0096             07 WA-OUT-SEQ-NO            PIC X(04).
TB0096         05  WA-OUT-ACTION               PIC X.
TB0096         05  WA-OUT-10231-PROMO          PIC XX.
TB0096         05  FILLER                      PIC X(371).
035650     03  WA-OUTPUT-STOP-MSG-R REDEFINES WA-OUTPUT-MSG.
035660         05  WA-OUTPUT-STOP-MSG          PIC XXXX.
035670         05  FILLER                      PIC X.
035680         05  WA-STOP-INDICATOR           PIC 99.
035690         05  FILLER                      PIC XX.
035700         05  WA-STOP-BRANCH              PIC 9999.
035710         05  FILLER                      PIC XX.
035720         05  WA-STOP-TELLER              PIC 9(5).
035730         05  FILLER                      PIC XX.
035740         05  WA-STOP-REASON              PIC X(18).
035750         05  FILLER                      PIC X(943).
035760     03  WA-OUTPUT-NARRATIVE REDEFINES WA-OUTPUT-MSG.
035770         05  WA-OUTPUT-LIMIT-MSG         PIC X(40).
035780         05  FILLER                      PIC X(943).
035790     03  WA-OUTPUT-HOLD-MSG-R REDEFINES WA-OUTPUT-MSG.
035800         05  WA-OUTPUT-HOLD-MSG          PIC XXXX.
035810         05  FILLER                      PIC X.
035820         05  WA-HOLD-VALUE               PIC X(19).
035830         05  FILLER                      PIC X.
035840         05  WA-HOLD-BRANCH              PIC 9999.
035850         05  FILLER                      PIC X.
035860         05  WA-HOLD-TELLER              PIC 9(5).
035870         05  FILLER                      PIC X.
035880         05  WA-HOLD-REASON              PIC X(18).
035890         05  FILLER                      PIC X(929).
035900     03  WA-OUTPUT-FREE-MSG-R REDEFINES WA-OUTPUT-MSG.
035910         05  WA-OUTPUT-FREE-MSG          PIC X(7).
035920         05  FILLER                      PIC XX.
035930         05  WA-OUTPUT-FREE-MSG-NO       PIC 99.
035940         05  WA-OUTPUT-FREE-MSG-SLASH    PIC X.                         
035950         05  WA-OUTPUT-FREE-MSG-JRNL     PIC 9(6).                      
035960         05  FILLER                      PIC X.
035970         05  WA-OUTPUT-FREE-MSG-TEXT     PIC X(30).                     
035980         05  FILLER                      PIC X(934).                    
TB0015     03  WA-OUTPUT-WARNING-MSG-R REDEFINES WA-OUTPUT-MSG.
TB0015         05  WA-OUTPUT-WARNING-MSG       PIC X(7).
TB0015*SC2419  05  WA-OUTPUT-WARNING-MSG-TEXT  PIC X(40).
SC2419         05  WA-OUTPUT-WARNING-MSG-TEXT  PIC X(100).
SC2419         05  FILLER                      PIC X(876).
TB0015*SC2419  05  FILLER                      PIC X(936).
035990     03  WA-ADV-OUTPUT-MSG REDEFINES WA-OUTPUT-MSG.
036000         05  WA-ADV-OUTPUT-MSG-KEY       PIC 9(16).
036010         05  WA-ADV-OP-MSG.
036020             07  WA-ADV-OUTPUT-NAME1     PIC X(30).
036030             07  WA-ADV-OUTPUT-NAME2     PIC X(30).
036040             07  WA-ADV-OUTPUT-NAME2-R REDEFINES
036050                 WA-ADV-OUTPUT-NAME2.
036060                 09  WA-ADV-OUTPUT-BALANCE PIC S9(14)V999 COMP.
036070***              09  FILLER                PIC X(21).
036080                 09  FILLER                PIC X(22).
036090*NR0001      07  WA-ADV-OUTPUT-TRAN      PIC X(65).
NR2001*NR0001             07  WA-ADV-OUTPUT-TRAN      PIC X(102).
NR2001             07  WA-ADV-OUTPUT-TRAN.
NR2001                 COPY BOCTSIZ9 IN LIBRYBOR
NR2001                      REPLACING ==(BOCT)== BY ==BOCT==.
036100         05  FILLER                      PIC X(18).
036110         05  WA-ADV-OUTPUT-CURR          PIC X(3).
036120         05  WA-ADV-OUTPUT-SW-REF-NO     PIC X(16).
NR2001*NR0001         05  FILLER                      PIC X(768).
NR2001         05  FILLER                      PIC X(686).
036130*NR0001  05  FILLER                      PIC X(805).
036140     03  WA-OFFLINE-MSG REDEFINES WA-OUTPUT-MSG.
036150         05  FILLER                      PIC X.
036160         05  WA-OUTPUT-JRNL-NO           PIC 9(6).
036170         05  FILLER                      PIC X(976).
036180     03  WA-REFRESH-MSG REDEFINES WA-OUTPUT-MSG.
036190         05  FILLER                      PIC X(7).
036200         05  WA-REFRESH-MSG-AREA         PIC X(976).
036210     03  WA-APP-OUTPUT-MSG   REDEFINES WA-OUTPUT-MSG.
036220         05  FILLER                      PIC X(20).
036230         05  WA-APP-OUT-MESS-1.
036240             07  WA-APP-OP-AMT           PIC X(19).
036250             07  WA-APP-DSPLY-WORD       PIC X(18).
036260         05  WA-APP-OUT-MESS-2.
036270             07  WA-APP-OP-WORD          PIC X(10).
036280             07  FILLER                  PIC X(20).
036290*NR0001  05  WA-APP-OUT-TRAN             PIC X(65).
NR2001*NR0001         05  WA-APP-OUT-TRAN             PIC X(102).
NR2001*NR0001         05  FILLER                      PIC X(794).
NR2001         05  WA-APP-OUT-TRAN.
NR2001             COPY BOCTSIZ7 IN LIBRYBOR
NR2001                  REPLACING ==(BOCT)== BY ==BOCT==.
NR2001         05  FILLER                      PIC X(712).
036300*NR0001  05  FILLER                      PIC X(831).
036310     03  WA-DB-ERR-OUTPUT REDEFINES WA-OUTPUT-MSG.
036320         05  WA-DBERR-DATA-SET           PIC X(4).
036330         05  WA-DB-ERROR                 PIC X(4).
036340         05  FILLER                      PIC X(975).
036350     03  WA-POST-ERR-OUTPUT REDEFINES WA-OUTPUT-MSG.
036360         05  WA-OUTPUT-REASON            PIC X(18).
036370         05  FILLER                      PIC X(965).
036380     03  WA-PASSBOOK-UPDT REDEFINES WA-OUTPUT-MSG.
036390         05  WA-OUTPUT-ACCT-NO.
036400             07  WA-OUTPUT-SOC       PIC 9(3).
036410             07  WA-OUTPUT-ACCT      PIC 9(16).
036420         05  WA-OUTPUT-ACCT-TYPE     PIC 9(4).
036430         05  WA-OUTPUT-BRANCH        PIC 9(4).
036440         05  WA-OUTPUT-POST-CODE     PIC X(8).
036450         05  WA-OUTPUT-NAME-1        PIC X(40).
036460         05  WA-OUTPUT-NAME-2        PIC X(40).
036470         05  WA-OUTPUT-ADD-1         PIC X(40).
036480         05  WA-OUTPUT-ADD-2         PIC X(40).
036490         05  WA-OUTPUT-ADD-3         PIC X(40).
036500         05  WA-OUTPUT-ALPHA         PIC X(40).
036510         05  FILLER                  PIC X(708).
036520     03  WA-OUTPUT-MSG-RR  REDEFINES WA-OUTPUT-MSG.
036530         05  WA-OUTPUT-PB-ACCT-NO    PIC 9(16).
036540         05  WA-OUTPUT-PB-MSG.
036550             07  FILLER              PIC X(4).
036560             07  WA-OUTPUT-PB-TRN-DT PIC S9(9) BINARY.
036570***          07  WA-OUTPUT-PB-BRN-TERM PIC XX.
036580***          07  WA-OUTPUT-PB-TELLER PIC XX.
036590             07  WA-OUTPUT-PB-TELR-BRCH
036600                                     PIC S9(9) BINARY.
036610             07  WA-OUTPUT-TRN-CODE  PIC S9(7) COMP.
036620             07  FILLER              PIC X(4).
036630             07  WA-OUTPUT-JRNL-NO-2 PIC S9(7) COMP.
036640             07  WA-OUTPUT-UNITS     PIC S9(9) COMP.
036650             07  WA-OUTPUT-AMOUNT    PIC S9(14)V999 COMP.
036660             07  WA-OUTPUT-BALANCE   PIC S9(14)V999 COMP.
036670             07  FILLER              PIC X(18).
036680***      05  FILLER                  PIC X(902).
036690         05  FILLER                  PIC X(905).
036700     03  WA-TANDEM-MSG  REDEFINES WA-OUTPUT-MSG.
036710         05  FILLER                      PIC X(907).
036720         05  WA-OUT-DATA-T.
036730             07  WA-OUT-BAL-T            PIC S9(14)V999
036740                   TRAILING SEPARATE.
036750             07  WA-OUT-NPB-NO-T         PIC 9(4).
036760             07  WA-OUT-NPB-VAL-T        PIC S9(14)V999
036770                   TRAILING SEPARATE.
036780             07  WA-TBR7-OT-INT-PB-T     PIC S9(14)V999
036790                   TRAILING SEPARATE.
036800             07  WA-OUT-CHARGES-T        PIC S9(14)V999
036810                   TRAILING SEPARATE.
036820     03  WA-OUTPUT-SOC REDEFINES WA-OUTPUT-MSG.
036830         05  WA-OUTPUT-SOC-NAME          PIC X(25).
036840         05  FILLER                      PIC X(958).
036850     03  WA-NAME-SEARCH REDEFINES WA-OUTPUT-MSG.
036860         05  FILLER                      PIC X(938).
036870         05  WA-OLD-CUSV-SORT-KEY        PIC X(15).
036880         05  WA-OLD-CUSV-PCODE           PIC X(8).
036890         05  FILLER                      PIC X(022).
036900     03  WA-PROP-DET-OUTPUT REDEFINES WA-OUTPUT-MSG.
036910         05  WA-PROP-MEMB-NO-OUT         PIC 9(17).
036920         05  WA-PROP-COST-OUT            PIC S9(14)V999 TRAILING
036930                                         SEPARATE.
036940         05  WA-PROP-VAL-OUT             PIC S9(14)V999
036950                                         TRAILING SEPARATE.
036960         05  WA-LATEST-VAL-OUT           PIC S9(14)V999
036970                                         TRAILING SEPARATE.
036980         05  WA-VALUE-DATE-OUT           PIC 9(8).
036990         05  WA-LAST-VALUE-OUT           PIC 9(8).
037000         05  WA-PURCHASE-DATE-OUT        PIC 9(8).
037010         05  WA-PROP-AGE-OUT             PIC 99.
037020         05  WA-CONSTR-CODE-OUT          PIC 9.
037030         05  WA-COUNCIL-CODE-OUT         PIC 9.
037040         05  WA-ORIG-LVR-OUT             PIC 999V99.
037050         05  WA-LATEST-LVR-OUT           PIC 999V99.
037060         05  FILLER                      PIC X(874).
037070     03  WA-INCOME-DET-OUTPUT REDEFINES WA-OUTPUT-MSG.
037080         05  WA-INCOME-MEMB-NO-OUT       PIC 9(17).
037090         05  WA-INCOME-1-OUT             PIC S9(14)V999
037100                                         TRAILING SEPARATE.
037110         05  WA-INCOME-2-OUT             PIC S9(14)V999
037120                                         TRAILING SEPARATE.
037130         05  WA-BIRTH-DATE-1-OUT         PIC 9(8).
037140         05  WA-BIRTH-DATE-2-OUT         PIC 9(8).
037150         05  FILLER                      PIC X(914).
037160     03  WA-INSURANCE-DET-OUTPUT REDEFINES WA-OUTPUT-MSG.
037170         05  WA-INSU-MEMB-NO-OUT         PIC 9(17).
037180         05  WA-INSU-COVER-OUT           PIC S9(14)V999
037190                                         TRAILING SEPARATE.
037200         05  WA-INSU-DUE-OUT             PIC S9(14)V999
037210                                         TRAILING SEPARATE.
037220         05  WA-INSU-CO-OUT              PIC XX.
037230         05  WA-POLICY-TYPE-OUT          PIC XX.
037240         05  WA-INSU-DUE-DATE-OUT        PIC 9(8).
037250         05  WA-POLICY-NO-OUT            PIC X(10).
037260         05  WA-MPI-MORT-INSU-CDE-OUT    PIC X.
037270         05  FILLER                      PIC X(907).
037280     03  WA-TXN775-OUT-DATA REDEFINES WA-OUTPUT-MSG.
037290         05  TXN775-CUS-ACC-NO          PIC 9(17).
037300         05  FILLER                     PIC X(65).
037310         05  TXN775-OUT-GROUP.
037320           07  TXN775-GROUP-VALS OCCURS 10.
037330             09  TXN775-CTR             PIC S9(5)
037340                                        TRAILING SEPARATE.
037350             09  TXN775-CTR-ADJM        PIC S9(5)
037360                                        TRAILING SEPARATE.
037370             09  TXN775-AMT             PIC S9(14)V999
037380                                        TRAILING SEPARATE.
037390             09  TXN775-AMT-ADJM        PIC S9(14)V999
037400                                        TRAILING SEPARATE.
037410         05  FILLER                     PIC X(421).
037420     03  WA-TXN775-OUT-2    REDEFINES WA-OUTPUT-MSG.
037430         05  TXN775-2-FILLER-1           PIC X.
037440         05  TXN775-2-JRNL-NO            PIC 9(6).
037450         05  FILLER                      PIC X(976).
037460     03  WA-TXN775-OUT-3    REDEFINES WA-OUTPUT-MSG.
037470         05  FILLER                      PIC 9(16).
037480         05  WA-TXN775-3-MSG.
037490             07  WA-TXN775-3-NAME-1      PIC X(30).
037500             07  WA-TXN775-3-WORD        PIC X(10).
037510             07  FILLER                  PIC X(927).
037520     03  WA-17050-OUT    REDEFINES WA-OUTPUT-MSG.
037530         05  FILLER                      PIC X(310).
037540         05  WA-OUT-17050-NEW-INT-CAT    PIC 9(4).
037550         05  FILLER                      PIC X(669).
037560*** 760167 BEGIN ***
037570     03  ATM-FILLER REDEFINES WA-OUTPUT-MSG.
037580         05  WS-ATM-OUT-FLAG             PIC XX.
037590         05  WS-ATM-OUT-ERROR-CODE       PIC 9999.
037600         05  WS-ATM-OUT-NO-OF-ACCTS      PIC 99.
037610         05  WS-ATM-OUT-INST-NO          PIC 999.
037620         05  WS-ATM-OUT-ACCT-NO          PIC 9(17).
037630         05  WS-ATM-OUT-DEP-LON          PIC X.
037640         05  WS-ATM-OUT-DATE             PIC X(8).
037650         05  WS-ATM-OUT-TIME             PIC X(8).
037660         05  WS-ATM-OUT-REFR-NO-TXNS     PIC X(938).
037670     03  WA-OUTPUT-MSG-R  REDEFINES WA-OUTPUT-MSG.
037680         05  WA-OUTPUT-DATA-SET          PIC X(4).
037690         05  WA-OUTPUT-STATUS            PIC X(4).
037700         05  FILLER                      PIC X(975).
037710*** 760167 END ***
037720     03  UTCORR-OUTPUT-MESSAGE REDEFINES WA-OUTPUT-MSG.
037730         05  UTCORR-OUT-ACCT-NO          PIC 9(17).
037740         05  UTCORR-OUT-FUNC             PIC X.
037750             88 UTCORR-OUT-VALID-FUNC    VALUES "A" "C" "E" "X".
037760             88 UTCORR-OUT-AMEND-FUNC    VALUE  "A".
037770             88 UTCORR-OUT-CREATE-FUNC   VALUE  "C".
037780             88 UTCORR-OUT-ENQ-FUNC      VALUE  "E".
037790             88 UTCORR-OUT-EXIT-FUNC     VALUE  "X".
037800         05  FILLER                      PIC X(965).
TB0215     03  OUTPUT-10725-MSG REDEFINES WA-OUTPUT-MSG.
TB0215         05  OUTPUT-10725-ACCT-NO         PIC 9(17).
TB0215         05  OUTPUT-10725-NAME            PIC X(60).
TB0215         05  OUTPUT-10725-TERM-FROM       PIC 9(4).
TB0215         05  OUTPUT-10725-TERM-TO         PIC 9(4).
TB0215         05  OUTPUT-10725-PRINT           PIC X(1).
TB0215         05  OUTPUT-10725-ERROR           PIC 9(1).
TB0215         05  OUTPUT-10725-JOURNAL         PIC 9(1).
S18252         05  OUTPUT-10725-TRAN-IND        PIC 9(1).
S18252         05  OUTPUT-10725-ADDR-SEL        PIC X(1).
S18252         05  FILLER                       PIC X(893).
S18252*TB0215  05  FILLER                       PIC X(895).
TB0215     03  OUTPUT-10726-MSG REDEFINES WA-OUTPUT-MSG.
TB0215         05  OUTPUT-10726-FILLER              PIC X(1).
TB0215         05  OUTPUT-10726-REC.
TB0215             07  FILLER                       PIC X(1).
TB0215             07  OUTPUT-10726-ACCT-NO         PIC X(15).
TB0215             07  OUTPUT-10726-NAME            PIC X(60).
TB0215             07  OUTPUT-10726-REP-MONTH       PIC 9(6).
TB0215             07  OUTPUT-10726-REP-DATE        PIC 9(8).
TB0215             07  OUTPUT-10726-REPRINT-FLAG    PIC X(1).
TB0215             07  OUTPUT-10726-ACCT-IND        PIC X(1).
TB0215             07  OUTPUT-10726-TRAN-IND        PIC 9(1).
TB0215             07  OUTPUT-10726-CUSM-NO         PIC 9(16).
TB0215             07  OUTPUT-10726-TYPE            PIC X(2).
TB0215             07  FILLER                      PIC X(871).
           03  OUTPUT-17047-JRNL REDEFINES WA-OUTPUT-MSG.
                 05 FILLER                    PIC X(172).
                 05 O17047-JRNL-STAT          PIC X.
                 05 FILLER                    PIC X(810).
TBN226     03  WA-OUTPUT-MSG-85007 REDEFINES WA-OUTPUT-MSG.
TBN226         05 BR0000-85007-FUNCTION        PIC X.
TBN226         05 BR0000-85007-CUST-ID-TYPE    PIC X(2).
TBN226         05 BR0000-85007-CUST-ID-NO      PIC X(14).
TBN226         05 BR0000-85007-CHANNEL         PIC X(3).
TBN226         05 BR0000-85007-ACC-FLAG        PIC X.
TBN226         05 BR0000-85007-FUNC-RANGE      PIC 9.
SC5868         05 BR0000-85007-CUST-ACCT-NO    PIC X(16).                SC4446
SC4446*        05 BR0000-85007-ACCT-TYPE       PIC 9(4).                 SC4446
SC4446*        05 BR0000-85007-INT-CAT         PIC 9(4).                 SC4446
SC4446*        05 BR0000-85007-SYSTEM          PIC X(3).                 SC4446
SC4446*        05 FILLER                       PIC X(934).               SC4446
SC5868         05 FILLER                       PIC X(945).               SC4446
SC4506* FOR 13031 13131 11044 11144 11048 11148
SC4506     03  BR0023-OUT-MESSAGE REDEFINES WA-OUTPUT-MSG.
SC4506         05  BR0023-OUT-KEY.
SC4506             07  BR0023-OUT-ACCT-NO       PIC 9(17).
SC4506         05  BR0023-OUT-AMOUNT            PIC S9(14)V999
SC4506             SIGN IS TRAILING SEPARATE.
SC4506         05  BR0023-OUT-MORTGAGE-NO       PIC 9.
SC4506         05  BR0023-OUT-SUB-LDGE-CODE     PIC 99.
SC4506         05  BR0023-OUT-PROMO-NO          PIC XX.
SC4506         05  BR0023-OUT-TXN-DATE          PIC 9(8).
SC4506         05  BR0023-OUT-CLEAR-CODE        PIC XX.
SC4506         05  BR0023-OUT-BANK-NUMBER       PIC X(4).
SC4506         05  BR0023-OUT-REGION-ID         PIC X(4).
SC4506         05  BR0023-OUT-ITEMS             PIC 999.
SC4506         05  BR0023-OUT-DEFER-DAYS        PIC 99.
SC4506         05  BR0023-OUT-REPAY-PRN-RECALC  PIC X.
SC4506         05  FILLER                       PIC X(3).
SC4506         05  BR0023-OUT-DEP-ACC-NO        PIC 9(16).
S15788         05  BR0023-OUT-PCC-CODE          PIC X(06).
S15788         05  FILLER                       PIC X(146).
S15788*SC4506         05  FILLER                       PIC X(152).
SC4506         05  BR0023-OUT-TRACER-NO         PIC 9(6).
SC4506         05  FILLER                       PIC X(2).
SC4506         05  BR0023-OUT-PRIN-PEN-IND      PIC X.
SC4506         05  BR0023-OUT-PENALTY-AMT       PIC S9(14)V999
SC4506             SIGN IS TRAILING SEPARATE.
SC4506         05  BR0023-OUT-WAIVE-AMT         PIC S9(14)V999
SC4506             SIGN IS TRAILING SEPARATE.
SC4506         05  BR0023-OUT-DUE-AMT           PIC S9(14)V999
SC4506             TRAILING SEPARATE.
SC4506         05  BR0023-OUT-REASON-CODE       PIC 9(4).
S15241         05  FILLER                       PIC X(12).
S15241         05  BR0023-OUT-AUTH-ID           PIC X(16).
S15241         05  FILLER                       PIC X(653).
S15241*SC4506         05  FILLER                       PIC X(681).
S11911     03  BR0024-TMP-MSG-55 REDEFINES WA-OUTPUT-MSG.
S11911         05  BR0024-TMP-PREF-1-55         PIC X(1).
S11911         05  BR0024-TMP-ACCT-1-55         PIC X(16).
S11911         05  BR0024-TMP-ORI-1-55          PIC X(48).
S11911         05  BR0024-TMP-PREF-2-55         PIC X(1).
S11911         05  BR0024-TMP-ACCT-2-55         PIC X(16).
S11911         05  BR0024-TMP-ORI-2-55          PIC X(685).
S11911         05  BR0024-TMP-ACCT-NO-55        PIC 9(16).
S11911         05  BR0024-TMP-FEE-AMOUNT-55     PIC S9(14)V999
S11911             SIGN IS TRAILING SEPARATE.
S11911         05  BR0024-TMP-FROM-ACCT-NO-55   PIC 9(16).
S11911         05  BR0024-TMP-SUBS-YN-55        PIC X(1).
S11911         05  FILLER                       PIC X(165).
S11911     03  BR0024-TMP-MSG-57 REDEFINES WA-OUTPUT-MSG.
S11911         05  BR0024-TMP-ORI-57            PIC X(657).
S11911         05  BR0024-TMP-ACCT-NO-57        PIC 9(16).
S11911         05  BR0024-TMP-FEE-AMOUNT-57     PIC S9(14)V999
S11911             SIGN IS TRAILING SEPARATE.
S11911         05  BR0024-TMP-FROM-ACCT-NO-57   PIC 9(16).
S11911         05  BR0024-TMP-SUBS-YN-57        PIC X(1).
S11911         05  FILLER                       PIC X(275).
SC5573     03  BR0001-OUTPUT-MSG-R1 REDEFINES WA-OUTPUT-MSG.
SC5573         05  BR0001-OUTPUT-SOC-NO        PIC 999.
SC5573         05  FILLER                      PIC X.
SC5573         05  BR0001-OUTPUT-ACCT-NO       PIC X(18).
SC5573         05  FILLER                      PIC X.
SC5573         05  BR0001-OUTPUT-BRANCH        PIC 9(4).
SC5573         05  FILLER                      PIC X.
SC5573         05  BR0001-OUTPUT-TERM-NO       PIC 999.
SC5573         05  FILLER                      PIC X.
SC5573         05  BR0001-OUTPUT-TELL-NO       PIC 9(5).
SC5573         05  FILLER                      PIC X(946).
S11877     03  WA-OUTPUT-10433-MSG REDEFINES WA-OUTPUT-MSG.
S11877         05 FILLER                      PIC 9.
S11877         05 OUTPUT-10433-MSG.
S11877            07 OUTPUT-10433-ACCT-NO         PIC 9(16).
S11877            07 OUTPUT-10433-ACCT-NAME       PIC X(40).
S11877            07 OUTPUT-10433-STATUS          PIC X(23).
S11877            07 OUTPUT-10433-BAD-DEBT        PIC X(25).
S11877            07 OUTPUT-10433-MAT-DATE.
S11877               10 OUTPUT-10433-MAT-DD       PIC XX.
S11877               10 OUTPUT-10433-MAT-MM       PIC XX.
S11877               10 OUTPUT-10433-MAT-CCYY     PIC X(4).
S11877            07 OUTPUT-10433-REP-METHOD      PIC X(43).
S11877            07 OUTPUT-10433-INT-RATE        PIC 9(3)V9999.
S11877            07 OUTPUT-10433-PEN-METHOD      PIC X(1).
S11877            07 OUTPUT-10433-FACTOR          PIC S9(3)V9(4)
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-PAY-DATE        PIC X(8).
S11877            07 OUTPUT-10433-OUT-BAL         PIC 9(14)V999.
S11877            07 OUTPUT-10433-TEMP-COLL       PIC 9(14)V999.
S11877            07 OUTPUT-10433-FEE-LAW         PIC 9(10)V999.
S11877            07 OUTPUT-10433-FEE-LAW2        PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-FEE-LAW3        PIC 9(10)V999.
S11877            07 OUTPUT-10433-FEE-SERVICES    PIC 9(10)V999.
S11877            07 OUTPUT-10433-FEE-SERVICES2   PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-FEE-SERVICES3   PIC 9(10)V999.
S11877            07 OUTPUT-10433-TEMP-PAY        PIC 9(10)V999.
S11877            07 OUTPUT-10433-TEMP-PAY2       PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-TEMP-PAY3       PIC 9(10)V999.
S11877            07 OUTPUT-10433-REV-RECIEVABLE  PIC 9(10)V999.
S11877            07 OUTPUT-10433-REV-RECIEVABLE2 PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-REV-RECIEVABLE3 PIC 9(10)V999.
S11877            07 OUTPUT-10433-COLL-INT        PIC 9(10)V999.
S11877            07 OUTPUT-10433-COLL-INT2       PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-COLL-INT3       PIC 9(10)V999.
S11877            07 OUTPUT-10433-HI-RATE-INT     PIC 9(10)V999.
S11877            07 OUTPUT-10433-HI-RATE-INT2    PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-HI-RATE-INT3    PIC 9(10)V999.
S11877            07 OUTPUT-10433-FEE-COURT       PIC 9(10)V999.
S11877            07 OUTPUT-10433-FEE-COURT2      PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-FEE-COURT3      PIC 9(10)V999.
S11877            07 OUTPUT-10433-FEE-INT         PIC 9(10)V999.
S11877            07 OUTPUT-10433-FEE-INT2        PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-FEE-INT3        PIC 9(10)V999.
S11877            07 OUTPUT-10433-PEN-ARREARS     PIC 9(10)V999.
S11877            07 OUTPUT-10433-PEN-ARREARS2    PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-PEN-ARREARS3    PIC 9(10)V999.
S11877            07 OUTPUT-10433-PEN-MATURITY    PIC 9(10)V999.
S11877            07 OUTPUT-10433-PEN-MATURITY2   PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-PEN-MATURITY3   PIC 9(10)V999.
S11877            07 OUTPUT-10433-PEN-DISCHARGE   PIC 9(10)V999.
S11877            07 OUTPUT-10433-PEN-DISCHARGE2  PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-PEN-DISCHARGE3  PIC 9(10)V999.
S11877            07 OUTPUT-10433-DEFF-INT        PIC 9(10)V999.
S11877            07 OUTPUT-10433-DEFF-INT2       PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-DEFF-INT3       PIC 9(10)V999.
S11877            07 OUTPUT-10433-INTEREST        PIC 9(10)V999.
S11877            07 OUTPUT-10433-INTEREST2       PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-INTEREST3       PIC 9(10)V999.
S11877            07 OUTPUT-10433-PRINCIPAL       PIC 9(10)V999.
S11877            07 OUTPUT-10433-PRINCIPAL2      PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-PRINCIPAL3      PIC 9(10)V999.
S11877            07 OUTPUT-10433-TOT-SET     PIC 9(10)V999.
S11877            07 OUTPUT-10433-TOT-SET2    PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-TOT-SET3    PIC 9(10)V999.
S11877            07 OUTPUT-10433-TOT-NOT     PIC 9(10)V999.
S11877            07 OUTPUT-10433-TOT-NOT2    PIC S9(10)V999
S11877               TRAILING SEPARATE.
S11877            07 OUTPUT-10433-TOT-NOT3    PIC 9(10)V999.
S11877            07 OUTPUT-10433-ORIG-DATE       PIC X(8).
S11877            07 OUTPUT-10433-RECALCULATE     PIC X(1).
S11877            07 OUTPUT-10433-PREV-DUE-DT     PIC X(8).
S11877            07 OUTPUT-10433-PRE-RECE        PIC 9(14)V999.
S11877            07 FILLLER                     PIC X(95).
S11877*
037830     02  BORM-RECORD-AREA.
037840     COPY BORMMAST IN LIBRYBOR.
037850     02  GLDM-RECORD-AREA REDEFINES BORM-RECORD-AREA.
037860     COPY GLDMMAST IN LIBRYGEN.
037870/
037880     COPY STRTREST IN LIBRYMIS.
APLEXD*-----------------------------------------------------------------
APLEXD
APLEXD 01      WA-PBOOK-CNTL-AREA REDEFINES STARTAREA.
B19902*APLEXD     03  FILLER                          PIC X(150).
B19902     03  FILLER                          PIC X(200).
APLEXD     03  FILLER                          PIC X(982).
APLEXD     03  WA-PBOOK-OUTPUT-DATA            PIC X(991).
APLEXD     03  FILLER                          PIC X(1913).
APLEXD 01      WA-INPUT-AREA REDEFINES STARTAREA.
B19902*APLEXD   03    WA-STARTAREA                    PIC X(1136).
B19902   03    WA-STARTAREA                    PIC X(1186).
APLEXD   03    WA-ERROR-AREA                   PIC X(60).
APLEXD   03    WA-MASTER-AREA                  PIC X(983).
APLEXD   03    FILLER                          PIC X(1857).
APLEXD
APLEXD*-----------------------------------------------------------------
038030/
038040*
038050 01  W300-ERROR-AREA                     PIC X(60).
038060*
038070*01      CHECK-RESPONSE-AREA.
038080*        COPY CHECKRES IN LIBRYMIS.
038090*
038100*        COPY PBOOKCA IN LIBRYMIS
038110*             REPLACING ==(PBOOKCA)== BY ==PBOOKCA==.
038120*01  WS-OL-APPL-FLAG       PIC  X.                                       
038130*    88  WS-OL-FLAG-ON     VALUE  "1".                                   
038140*    88  WS-OL-FLAG-OFF    VALUE  "0".                                   
038150/
038160 PROCEDURE DIVISION USING  UT0008CA-CALL-AREA                            
038170                           STARTAREA                                     
038180                           W300-ERROR-AREA.                              
038190*                          WS-OL-APPL-FLAG.                              
038200 A000-MAIN-LOGIC.
SC6275     INITIALIZE WA-VOUCHER-EXTENDED-INFO. 
SC4781     MOVE 0 TO WA-FEE-AMT.
SC5203     MOVE 0 TO WS-SUB.
SC5203     MOVE 0 TO WA-RESERVED-AMT.
S16871     MOVE 0 TO WA-LIMIT-AMT.
S17848     MOVE 0 TO WA-FEE-TYPE.
S18829     MOVE 0 TO WA-ADD-AGREE-INT-BUCKET.
SC4465     MOVE STRT-AREA-PROCESS-BITS TO FIELD-B.
SC4465     CALL "UT0022" USING PUAREA.
S11382*    FOR IB INTERBANK TRANSFER WITH PROMO CODE F2
S11382*    USING FN AS PROMO CODE
S17331*S11382 IF (STRT-AREA-TRN-NO = 14050 OR 14150
S17331*S11382     OR 19050 OR 19150)
S17331*S11382 AND WA-ATM-PROMO-NO = "F2"
S12725*S11382 AND STRT-WEBLOGIC-IB-TXN
S17331*S12725 IF  STRT-WEBLOGIC-IB-TXN
S17331*S11382     MOVE "FN" TO WA-ATM-PROMO-NO
S17331*S11382                  W800-PROMO-NO
S17331*S12725 ELSE
S17331*S12725   IF STRT-FEP-ATM-TXN
S17331*S12725      PERFORM Q330-EATM-CHECK-RTN THRU Q330-EXIT
S17331*S12725      IF WS-TELM-STATUS-1  = "****"
S17331*S12725         IF TELM-TERM-TYPE-EATM
S17331*S12725            MOVE "FN" TO WA-ATM-PROMO-NO
S17331*S12725                         W800-PROMO-NO
S17331*S12725         END-IF
S17331*S12725      END-IF
S17331*S12725   END-IF
S17331*S12725 END-IF
S17331*S11382 END-IF.
SC4465     MOVE FIELD-A TO WA-EDIT-MASK.
SC4465     IF WA-INPUT-PARAM-TABLE(29) = 1
SC4465*       MOVE  W800-TRF-AMOUNT TO WS-RF-AMOUNT              SC4276
SC4276        MOVE  W800-BAL        TO WS-RF-AMOUNT
ST0159        MOVE  W800-FROM-ACCT  TO WS-ORIG-ACCT-NUM
SC4465     ELSE
ST0159        MOVE  WA-ADV-ACCT-NO  TO WS-ORIG-ACCT-NUM
SC4465        MOVE  WA-ADV-AMOUNT   TO WS-RF-AMOUNT
SC4465     END-IF.
038210*    IF  WS-OL-FLAG-ON                                                   
038220*        MOVE   "1"     TO    WA-START-FLAG.                             
MVS101     MOVE ZEROES TO PBOOKCA-RCPT-CNT.
MVS101     MOVE ZEROES TO PBOOKCA-LINE-CNT.
MVS101     MOVE ZEROES TO PBOOKCA-CHQ-CNT.
ST0038     MOVE STRT-AREA-TRN-NO TO WS-VCHR-ORG-TRANCODE 
ST0054                              WS-REQD-VCHR-TC.
S15672     MOVE "N"              TO WA-LOAN-ACCT.
S15228     MOVE "N"              TO WA-ATM-ALLOW.
SC6828     MOVE 'N'              TO WA-INS-FLAG.
S12056     MOVE 'N'              TO WA-INS-FLAG-2.
S12524     MOVE "N"              TO BR0038CA-AMC-FLAG.
S12524     MOVE SPACES           TO BR0038CA-AMC-PROMO-NO.
S15955*S15846     MOVE SPACES           TO BR0032CA-PROMO-CODE.
S15955     MOVE SPACES           TO BR0032CA-PROMO-CODE-AREA.
S15020     MOVE SPACE            TO UT0073CA-GL-LINK-FLAG.
S15020     MOVE SPACE            TO UT0073CA-GL-LINK-GLIF-I.
S15020     MOVE SPACE            TO UT0073CA-GL-LINK-GLIF-P.
S12524     MOVE SPACES           TO WS-PROMO-NO.
S16269     MOVE 0                TO WA-CALC-DUE-AMT.
S16997     MOVE 0                TO WA-NON-TAX-AMT.
S15813     MOVE 0                TO WA-SOURCE-ADV-DATE.
S15813     MOVE 0                TO WA-TEMP-MATURITY-DT.
S15813     MOVE 0                TO WA-PRODUCT-GROUP.
S15813     MOVE 0                TO WA-SOURCE-REPAY-DAY.
S15813     MOVE 0                TO WA-FLOAT-RATE.
S15813     MOVE 0                TO WA-BANK-RATE.
S15813     MOVE 0                TO WA-CUST-RATE.
S16866     MOVE 0                TO WA-OD-ACCT-NO.
S17306     MOVE 0                TO WA-10732-RSN-CD.
S20699     MOVE 0                TO WS-VCHR-TRANS.
S20699     MOVE 0                TO WS-TRIGER-VCTR.
SC8891     MOVE "N"              TO WA-FIRST-ADV-FLAG.
SC6542     MOVE WA-INPUT-MSG     TO WS-STRT-ORG-INPUT-MSG.
ST0137     MOVE WA-INPUT-MSG(1:75)  TO WA-DISP-ORIG-INP-MSG.
TB0273     MOVE STRT-AREA-TRN-NO TO WA-DUMMY-TRN-NO.
S17474     MOVE STRT-AREA-TRN-NO TO WA-MESSAGE-TRN-NO.
SC4490     IF NOT STRT-BANCSLINK
SC4490     AND WA-LEDGE-SUB-TXN
SC4490         MOVE 1  TO WA-REPAY-MORTGAGE
SC4490         MOVE 01 TO WA-REPAY-SUB-LEDG-CODE
SC4490     END-IF.
TB0155/
TB0155     MOVE STRT-AREA-TRN-NO        TO WS-TRAN-TEMP.
TB0155     MOVE ZEROES                  TO WS-CIEA-EOF
TB0155                                     WS-BOIS-EOF.
TB0155/
SC4085     MOVE 0 TO WS-UT0500RA-CUSM-STATUS-SAVE.
S11927     MOVE 0 TO WA-SAVE-CUST-STATUS.
S16182*S12520     INITIALIZE   UTCICE-CALL-AREA.
038280     IF  WA-START-FLAG = 0
038300         MOVE SPACES TO DBIO-CALL-PARAM                                  
038310                        DBIO-CALL-SYS-AREA                               
038320                        DBIO-CALL-KEY-AREA                               
038330                        DBIO-CALL-STATUS                                 
038340                        DBIO-CALL-RECORD-AREA                            
038350                        DBIO-CALL-TXN-TYPE-AREA                          
038360         MOVE ZEROES TO DBIO-CALL-REFER-AREA                             
038370         CALL "DBIO" USING                                               
038380                     DBIO-CALL-PARAM                                     
038390                     DBIO-CALL-SYS-AREA                                  
038400                     DBIO-CALL-KEY-AREA                                  
038410                     DBIO-CALL-STATUS                                    
038420                     DBIO-CALL-RECORD-AREA                               
038430                     DBIO-CALL-REFER-AREA                                
038440                     DBIO-CALL-TXN-TYPE-AREA                             
038450                                                                         
038460         MOVE SPACES TO DBIO-CALL-RECORD-AREA                            
038470         MOVE ZEROES TO DBIO-CALL-REFER-AREA                             
038480         MOVE SPACES TO DBIO-CALL-TXN-TYPE-AREA                          
038490         MOVE 96 TO DBIO-CALL-FUNC                                       
038500                                                                         
038510         CALL "DBIO" USING                                               
038520                     DBIO-CALL-PARAM                                     
038530                     DBIO-CALL-SYS-AREA                                  
038540                     DBIO-CALL-KEY-AREA                                  
038550                     DBIO-CALL-STATUS                                    
038560                     DBIO-CALL-RECORD-AREA                               
038570                     DBIO-CALL-REFER-AREA                                
038580                     DBIO-CALL-TXN-TYPE-AREA                             
038590                                                                         
038600         SET UT8500CA-NORMAL-DISPLAY    TO TRUE                          
038610         SET UT8500CA-RESPONSE-NOT-REQD TO TRUE                          
038620         MOVE SPACES TO UT8500CA-INPUT-MSG                               
038630         IF DBIO-CALL-STATUS NOT = "****"                                
038640            STRING "BR0000:(A000) UNABLE TO SIGN "                       
038650                   "ON TO DATABASE, DBIO-CALL-STATUS = "                 
038660                   DBIO-CALL-STATUS                                      
038670                   DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG             
038680         ELSE                                                            
038690            STRING "BR0000:(A000) SUCCESSFUL DATABASE SIGN-ON"           
038700                   DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG             
038710         END-IF                                                          
038720         CALL "UT8500"  USING                                            
038730                        UT8500CA-AREA                                    
038740                                                                         
038750*        CALL "FT0000" USING                                             
038760*                      STARTAREA                                         
038780         MOVE SPACES TO CP0010CA-TRN-NO
038790*        NCR-LOCK WA-START-OF-DAY-FLAG FOR UPDATE
038800         IF  WA-START-OF-DAY-FLAG NOT = 0
038810             IF  WA-RSRT-THREAD-NO = 1
038820                 MOVE 1 TO WA-START-FLAG
038830*                NCR-UNLOCK WA-START-OF-DAY-FLAG
038840                 GO TO A099-EXIT
038850             ELSE
038860                 ADD 1 TO WA-START-OF-DAY-FLAG
038870                 MOVE 1          TO WA-START-FLAG
038880                 MOVE WA-START-OF-DAY-FLAG TO WA-RSRT-THREAD-NO
038890                 CALL "BR0001" USING
038910                                     STARTAREA
038920                                     BORR-PARAMS
038930                                     UT0290CA-CALL-AREA
038940                                     BR0001-CALL-AREA
038950                                     MULTI-OVERRIDE-AREA
TB0027                                     BOIS-RECORD
TB0169*
TB0169                 CALL "UT0001"  USING
TB0169                                     STARTAREA
TB0169                                     BORR-PARAMS
TB0169                                     UT0290CA-CALL-AREA
TB0169                                     BR0001-CALL-AREA
TB0169                                     MULTI-OVERRIDE-AREA
TB0169                                     BOIS-RECORD
TB0169*
038960                 CALL "BR0005" USING
038980                                     STARTAREA
S12068                                     MULTI-OVERRIDE-AREA 
039000                 CALL "BR0055" USING
039020                                     STARTAREA
ST0115                 CALL "BR0056" USING
ST0115                                       STARTAREA
ST0115                                       DATE1
ST0115                                       BOIS-RECORD
039030                 CALL "BR0011" USING
039050                                     STARTAREA
039060                                     BORR-PARAMS
039070                                     DATE1
TB0069                                     BOIS-RECORD
039080                 CALL "BR0040" USING
039100                                     STARTAREA
039110                 CALL "BR0025" USING
039130                                     STARTAREA
039140                                     BORR-PARAMS
NR2001*039150                                     BORV-RECORD-AREA
NR2001                                     BOCT-RECORD-AREA
039160                                     SOC-PARAMS
039170                                     UT0290CA-CALL-AREA
039180                                     BR0025-CALL-AREA
039190                                     W100-DATE-FILE
039200                                     WA-PASSALONG
039210                                     MULTI-OVERRIDE-AREA
MVS101                                     PBOOKCA-LINE-AREA 
TB0084                                     BOIS-RECORD
039230                 CALL "BR0027" USING
039250                                     STARTAREA
039260                                     WA-BLDV-AREA-WW
039270                                     BORR-PARAMS
039280                                     SOC-PARAMS
039290                 CALL "GL0023" USING
039310                                     STARTAREA
039320                                     GL-PASSALONG
039330                                     MULTI-OVERRIDE-AREA
039340                                     W300-ERROR-AREA
039350                                     CHECK-RESPONSE-AREA
TB0137                                     UTVTACCA-CALL-PARAM
039360                 CALL "GL0024" USING
039380                                     STARTAREA
039390                                     GL-PASSALONG
039400                                     MULTI-OVERRIDE-AREA
039410                                     W300-ERROR-AREA
039420                                     CHECK-RESPONSE-AREA
039430                 CALL "CI0051" USING
039450                                     STARTAREA
039460                                     WA-CUSV-AREA-A3
039470                                     WA-CUSV-AREA-AA
039480                                     WA-CUSV-AREA-CC
039490                                     WA-CUSV-AREA-DD
039500                                     WA-CUSV-AREA-D1
039510                                     WA-CUSV-AREA-EE
039520                                     WA-CUSV-AREA-ZZ
039530                                     WA-JNRST-SAVE-DATA
039540***** GANESH - ADDING INITIALISATION OF UT0800 *******
039550                 CALL "UT0800" USING
039560                                     STARTAREA
039570                                     W300-ERROR-AREA
039580                                     WA-JRNL-CALL-AREA
039590                                     WA-PASSALONG
039600                                     MULTI-OVERRIDE-AREA
039610                                     CHECK-RESPONSE-AREA
039620                                     WA-OTHER-SAVE-AREAS
039630                                     PBOOKCA-LINE-AREA
SC9608                                     UTVTACCA-CALL-PARAM
TB0190                 CALL "UT0820" USING
TB0190                                     STARTAREA
SC1574                                     W300-ERROR-AREA
TB0190                                     GL-PASSALONG
SC1574                                     WA-OTHER-SAVE-AREAS
TB0190                                     MULTI-OVERRIDE-AREA
TB0190                                     CHECK-RESPONSE-AREA
SC7181                                     UTVTACCA-CALL-PARAM
S12770                 CALL "UT0810" USING
S12770                                     STARTAREA
S12770                                     W300-ERROR-AREA
S12770                                     CHECK-RESPONSE-AREA
S12770                                     MULTI-OVERRIDE-AREA
S12770                                     WA-OTHER-SAVE-AREAS
S12770                                     PBOOKCA-LINE-AREA
S12770
S12770                 MOVE UT8500CA-FUNC-NORMAL-DISPLAY
S12770                   TO UT8500CA-CALL-CODE
S12770                 MOVE SPACES TO UT8500CA-INPUT-MSG
S12770                 STRING "BR0000:(A000) UT0810 INITIAL"
S12770                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S12770                 CALL "UT8500" USING UT8500CA-AREA
      *--------- SC0273 -----------*
                       INITIALIZE UTHISTCA-CALL-AREA
                       MOVE 01 TO UTHISTCA-CALL-CODE
                       CALL "UTHIST" USING UTHISTCA-CALL-PARAM
      *----------------------------*
039640                 CALL "CO2000" USING
039660                                     STARTAREA
039670                 CALL "UTCLRD" USING
039680                                     UTCLRDCA-CALL-AREA
039700                 MOVE 1 TO UT0120CA-CALL-CODE
039710                 CALL "UT0120" USING
039720                               UT0120CA-CALL-AREA
039740*                NCR-LOCK W100-DATE-FILE FOR RETRIEVAL
039750                 PERFORM A600-INIT-CHARGE-SYSTEM THRU A699-EXIT
039760                 PERFORM A400-STRTR-PARA THRU A499-EXIT
039770*                NCR-UNLOCK WA-START-OF-DAY-FLAG
039780*
039790********************************************                             
039800**  INITIALIZATION OF BRINTER SUBMODULES  **                             
039810********************************************                             
039820*                                                                        
039830                 CALL "UT0014"                                           
039840                 MOVE BR0000-REPLICA-NO                                  
039850                      TO WA-UT0017-REPLICA                               
039860                 CALL "UT0017" USING                                     
039870                               UT0017-CALL-AREA                          
039880                               WA-UT0017-KEY                             
039890                 MOVE 01 TO UT2000CA-CALL-CODE                           
039900                 CALL "UT2000" USING                                     
039910                               UT2000CA-CALL-AREA                        
039920                                                                         
039930                 MOVE 01 TO UT0298CA-CALL-CODE                           
039940                 MOVE STRT-AREA-SOC-NO TO                                
039950                      UT0298CA-CALL-SOC-NO                               
039960                 CALL "UT0298" USING                                     
039970                               UT0298CA-CALL-AREA                        
039980                                                                         
039990                 MOVE 01 TO UT0200-CALL-CODE                             
040000                 CALL "UT0200" USING                                     
040010                               UT0200-CALL-AREA                          
040020                                                                         
040030                 MOVE 0 TO UT9000-CALL-CODE                              
040040                 CALL "UT9000" USING                                     
040050                               UT9000-CALL-AREA                          
040060                                                                         
B17951*                MOVE 01 TO UT2010-CODE                                  
B17951*                CALL "UT2010" USING                                     
B17951*                              UT2010-LINKAGE                            
040100                                                                         
040110                 MOVE 1 TO SY0010CA-FUNC                                 
040120                 CALL "SY0010" USING                                     
040130                               SY0010CA-COMMON-AREA                      
040140                               WA-JRNL-CALL-AREA                         
040150                 IF SY0010CA-STATUS NOT = ZERO                           
040160                    SET UT8500CA-NORMAL-DISPLAY TO TRUE                  
040170                    MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG              
040180                    MOVE SPACES TO UT8500CA-INPUT-MSG                    
040190                    STRING "BR0000:(A000) SY0010 INIT FAILED"            
040200                           "STOPPING ONLINE."                            
040210                           DELIMITED BY SIZE INTO                        
040220                           UT8500CA-INPUT-MSG                            
040230                    CALL "UT8500" USING                                  
040240                                  UT8500CA-AREA                          
040250                    CALL "ABORT"                                         
040260                 END-IF                                                  
040270*                                                                        
040280*******************************                                          
040290**   END OF INITIALIZATION   **                                          
040300*******************************                                          
040310*                                                                        
040320                 SET UT8500CA-NORMAL-DISPLAY    TO TRUE                  
040330                 SET UT8500CA-RESPONSE-NOT-REQD TO TRUE                  
040340                 MOVE SPACES TO UT8500CA-INPUT-MSG                       
040350                 STRING W-PROGRAM-NAME ":(A000) REP- "                   
040360                                       BR0000-REPLICA-NO                 
040370                                       " INITIALISED"                    
040380                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG               
040390                 CALL  "UT8500" USING                                    
040400                                UT8500CA-AREA                            
040410*
040420                 GO TO A099-EXIT
040430         ELSE ADD 1 TO WA-START-OF-DAY-FLAG
040440             MOVE 1 TO WA-START-FLAG                                     
040450*************OPEN I-O LNFUND
040460             MOVE WA-START-OF-DAY-FLAG TO WA-RSRT-THREAD-NO
040470             PERFORM A100-LOAD-ALL-FILES
040480                THRU A199-EXIT
040490             PERFORM VARYING WA-COUNT FROM 1 BY 1
040500             UNTIL WA-COUNT > 60
040510                   MOVE  0      TO WA-CORR-IND(WA-COUNT)
040520                   MOVE  0      TO WA-GENR-TX-TYPE(WA-COUNT)
040530                   MOVE  0      TO WA-SRC-ACCT(WA-COUNT)
040540                   MOVE  0      TO WA-TRF-AMT(WA-COUNT)
040550                   MOVE  0      TO WA-FEE-BEAR-ACCT(WA-COUNT)
040560                   MOVE  SPACES TO WA-SRC-ACCT-CCY(WA-COUNT)
040570                   MOVE  SPACES TO WA-FEE-BEAR-ACCT-CCY(WA-COUNT)
040580                   MOVE  SPACES TO WA-FEE-SHRT-DESC(WA-COUNT)
040590             END-PERFORM
040600             MOVE 0 TO WA-FEE-TRF-TXN
040610             MOVE 0 TO WA-SKIP-FEE-CALC
040620             MOVE 0 TO WA-GENR-TX-CNT
040630             CALL "BR0001" USING
040650                                 STARTAREA
040660                                 BORR-PARAMS
040670                                 UT0290CA-CALL-AREA
040680                                 BR0001-CALL-AREA
040690                                 MULTI-OVERRIDE-AREA
TB0027                                 BOIS-RECORD
040700*
040710             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
040720                  TO UT8500CA-CALL-CODE
040730             MOVE SPACES TO UT8500CA-INPUT-MSG
040740             STRING "BR0000:(A000) BR0001 INITIALISATION COMPLETE"
040750                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
040760             CALL "UT8500" USING UT8500CA-AREA
040770*
TB0169             CALL "UT0001"  USING
TB0169                                 STARTAREA
TB0169                                 BORR-PARAMS
TB0169                                 UT0290CA-CALL-AREA
TB0169                                 BR0001-CALL-AREA
TB0169                                 MULTI-OVERRIDE-AREA
TB0169                                 BOIS-RECORD
TB0169*
TB0169             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0169                  TO UT8500CA-CALL-CODE
TB0169             MOVE SPACES TO UT8500CA-INPUT-MSG
TB0169             STRING "BR0000:(A000) UT0001 INITIALISATION COMPLETE"
TB0169                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0169             CALL "UT8500" USING UT8500CA-AREA
TB0169*
040780             CALL "BR0005" USING
040800                                 STARTAREA
S12068                                 MULTI-OVERRIDE-AREA 
040810*
040820             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
040830                  TO UT8500CA-CALL-CODE
040840             MOVE SPACES TO UT8500CA-INPUT-MSG
040850             STRING "BR0000:(A000) BR0005 INITIALISATION COMPLETE"
040860                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
040870             CALL "UT8500" USING UT8500CA-AREA
040880*
040890             CALL "BR0055" USING
040910                                 STARTAREA
040920*
040930             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
040940                  TO UT8500CA-CALL-CODE
040950             MOVE SPACES TO UT8500CA-INPUT-MSG
040960             STRING "BR0000:(A000) BR0055 INITIALISATION COMPLETE"
040970                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
040980             CALL "UT8500" USING UT8500CA-AREA
ST0115                 CALL "BR0056" USING
ST0115                                       STARTAREA
ST0115                                       DATE1
ST0115                                       BOIS-RECORD
ST0115             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
ST0115                  TO UT8500CA-CALL-CODE
ST0115             MOVE SPACES TO UT8500CA-INPUT-MSG
ST0115             STRING "BR0000:(A000) BR0056 INITIALISATION COMPLETE"
ST0115                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
ST0115             CALL "UT8500" USING UT8500CA-AREA
040990*
041000             CALL "BR0011" USING
041020                                 STARTAREA
041030                                 BORR-PARAMS
041040                                 DATE1
TB0069                                 BOIS-RECORD
041050*
041060             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
041070                  TO UT8500CA-CALL-CODE
041080             MOVE SPACES TO UT8500CA-INPUT-MSG
041090             STRING "BR0000:(A000) BR0011 INITIALISATION COMPLETE"
041100                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
041110             CALL "UT8500" USING UT8500CA-AREA
041120*
041130             CALL "BR0040" USING
041150                                 STARTAREA
041160*
041170             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
041180                  TO UT8500CA-CALL-CODE
041190             MOVE SPACES TO UT8500CA-INPUT-MSG
041200             STRING "BR0000:(A000) BR0040 INITIALISATION COMPLETE"
041210                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
041220             CALL "UT8500" USING UT8500CA-AREA
041230*
041240             CALL "BR0025" USING
041260                                 STARTAREA
041270                                 BORR-PARAMS
NR2001*041280                                 BORV-RECORD-AREA
NR2001                                 BOCT-RECORD-AREA
041290                                 SOC-PARAMS
041300                                 UT0290CA-CALL-AREA
041310                                 BR0025-CALL-AREA
041320                                 W100-DATE-FILE
041330                                 WA-PASSALONG
041340                                 MULTI-OVERRIDE-AREA
MVS101                                 PBOOKCA-LINE-AREA
TB0084                                 BOIS-RECORD
041360*
041370             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
041380                  TO UT8500CA-CALL-CODE
041390             MOVE SPACES TO UT8500CA-INPUT-MSG
041400             STRING "BR0000:(A000) BR0025 INITIALISATION COMPLETE"
041410                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
041420             CALL "UT8500" USING UT8500CA-AREA
041430*
041440             CALL "BR0027" USING
041460                                 STARTAREA
041470                                 WA-BLDV-AREA-WW
041480                                 BORR-PARAMS
041490                                 SOC-PARAMS
041500*
041510             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
041520                  TO UT8500CA-CALL-CODE
041530             MOVE SPACES TO UT8500CA-INPUT-MSG
041540             STRING "BR0000:(A000) BR0027 INITIALISATION COMPLETE"
041550                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
041560             CALL "UT8500" USING UT8500CA-AREA
041570*
041580             CALL "GL0023" USING
041600                                 STARTAREA
041610                                 GL-PASSALONG
041620                                 MULTI-OVERRIDE-AREA
041630                                 W300-ERROR-AREA
041640                                 CHECK-RESPONSE-AREA
TB0137                                 UTVTACCA-CALL-PARAM
041650*
041660             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
041670                  TO UT8500CA-CALL-CODE
041680             MOVE SPACES TO UT8500CA-INPUT-MSG
041690             STRING "BR0000:(A000) GL0023 INITIALISATION COMPLETE"
041700                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
041710             CALL "UT8500" USING UT8500CA-AREA
041720*
041730             CALL "GL0024" USING
041750                                 STARTAREA
041760                                 GL-PASSALONG
041770                                 MULTI-OVERRIDE-AREA
041780                                 W300-ERROR-AREA
041790                                 CHECK-RESPONSE-AREA
041800*
041810             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
041820                  TO UT8500CA-CALL-CODE
041830             MOVE SPACES TO UT8500CA-INPUT-MSG
041840             STRING "BR0000:(A000) GL0024 INITIALISATION COMPLETE"
041850                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
041860             CALL "UT8500" USING UT8500CA-AREA
041870*
041880             CALL "CI0051" USING
041900                                 STARTAREA
041910                                 WA-CUSV-AREA-A3
041920                                 WA-CUSV-AREA-AA
041930                                 WA-CUSV-AREA-CC
041940                                 WA-CUSV-AREA-DD
041950                                 WA-CUSV-AREA-D1
041960                                 WA-CUSV-AREA-EE
041970                                 WA-CUSV-AREA-ZZ
041980                                 WA-JNRST-SAVE-DATA
041990*
042000             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
042010                  TO UT8500CA-CALL-CODE
042020             MOVE SPACES TO UT8500CA-INPUT-MSG
042030             STRING "BR0000:(A000) CI0051 INITIALISATION COMPLETE"
042040                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
042050             CALL "UT8500" USING UT8500CA-AREA
042060*
042080***** GANESH - ADDING INITIALISATION OF UT0800 *******
042090                 CALL "UT0800" USING
042100                                     STARTAREA
042110                                     W300-ERROR-AREA
042120                                     WA-JRNL-CALL-AREA
042130                                     WA-PASSALONG
042140                                     MULTI-OVERRIDE-AREA
042150                                     CHECK-RESPONSE-AREA
042160                                     WA-OTHER-SAVE-AREAS
042170                                     PBOOKCA-LINE-AREA
SC9608                                     UTVTACCA-CALL-PARAM
TB0190                 CALL "UT0820" USING
TB0190                                     STARTAREA
SC1574                                     W300-ERROR-AREA
TB0190                                     GL-PASSALONG
SC1574                                     WA-OTHER-SAVE-AREAS
TB0190                                     MULTI-OVERRIDE-AREA
TB0190                                     CHECK-RESPONSE-AREA
SC7181                                     UTVTACCA-CALL-PARAM
042180*
042190             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
042200                  TO UT8500CA-CALL-CODE
042210             MOVE SPACES TO UT8500CA-INPUT-MSG
042220             STRING "BR0000:(A000) UT0800 INITIALISATION COMPLETE"
042230                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
042240             CALL "UT8500" USING UT8500CA-AREA
S12770             CALL "UT0810" USING
S12770                                STARTAREA
S12770                                W300-ERROR-AREA
S12770                                CHECK-RESPONSE-AREA
S12770                                MULTI-OVERRIDE-AREA
S12770                                WA-OTHER-SAVE-AREAS
S12770                                PBOOKCA-LINE-AREA
S12770
S12770             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
S12770                  TO UT8500CA-CALL-CODE
S12770             MOVE SPACES TO UT8500CA-INPUT-MSG
S12770             STRING "BR0000:(A000) UT0810 INITIAL"
S12770             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S12770             CALL "UT8500" USING UT8500CA-AREA
      *------- SC0273 -----------*
                   INITIALIZE UTHISTCA-CALL-AREA
                   MOVE 01 TO UTHISTCA-CALL-CODE
                   CALL "UTHIST" USING UTHISTCA-CALL-PARAM
                   MOVE UT8500CA-FUNC-NORMAL-DISPLAY
                        TO UT8500CA-CALL-CODE
                   MOVE SPACES TO UT8500CA-INPUT-MSG
                   STRING "BR0000:(A000) UTHIST INITIALISATION COMPLETE"
                          DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
                   CALL "UT8500" USING UT8500CA-AREA
      *--------------------------*
042250*
042260             CALL "CO2000" USING
042280                                 STARTAREA
042290             CALL "UTCLRD" USING
042300                                 UTCLRDCA-CALL-AREA
042320             MOVE 1 TO UT0120CA-CALL-CODE
042330             CALL "UT0120" USING
042340                           UT0120CA-CALL-AREA
042360*
042370             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
042380                  TO UT8500CA-CALL-CODE
042390             MOVE SPACES TO UT8500CA-INPUT-MSG
042400             STRING "BR0000:(A000) CO2000 INITIALISATION COMPLETE"
042410                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
042420             CALL "UT8500" USING UT8500CA-AREA
042440*
042450*            NCR-LOCK W100-DATE-FILE FOR RETRIEVAL
042460             PERFORM A600-INIT-CHARGE-SYSTEM THRU A699-EXIT
042470*
042480             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
042490                  TO UT8500CA-CALL-CODE
042500             MOVE SPACES TO UT8500CA-INPUT-MSG
042510             STRING "BR0000:(A000) CHARGES INITIALISATION"
042520                    "  COMPLETE"
042530                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
042540             CALL "UT8500" USING UT8500CA-AREA
042550*
042560         PERFORM A700-LOAD-TEXT-DATA THRU A799-EXIT
042570*
042580             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
042590                  TO UT8500CA-CALL-CODE
042600             MOVE SPACES TO UT8500CA-INPUT-MSG
042610             STRING "BR0000:(A000) A700 INITIALISATION COMPLETE"
042620                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
042630             CALL "UT8500" USING UT8500CA-AREA
042640*
042650         SET TXT-1, TXT-2 TO 1
042660         MOVE ZERO TO UT0220CA-CALL-SOC-NO
042670             PERFORM A400-STRTR-PARA THRU A499-EXIT
042680*
042690             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
042700                  TO UT8500CA-CALL-CODE
042710             MOVE SPACES TO UT8500CA-INPUT-MSG
042720             STRING "BR0000:(A000) A400 INITIALISATION COMPLETE"
042730                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
042740             CALL "UT8500" USING UT8500CA-AREA
042750*
042760*            NCR-UNLOCK WA-START-OF-DAY-FLAG
042770*
042780********************************************                             
042790**  INITIALIZATION OF BRINTER SUBMODULES  **                             
042800********************************************                             
042810*                                                                        
DEBUG *                CALL "UT0014"                                           
DEBUG                  CALL "UT0014" USING STARTAREA                           
042840                                                                         
042850                 MOVE BR0000-REPLICA-NO                                  
042860                      TO WA-UT0017-REPLICA                               
042870                 CALL "UT0017" USING                                     
042880                               UT0017-CALL-AREA                          
042890                               WA-UT0017-KEY                             
042900                                                                         
042910                 MOVE 01 TO UT2000CA-CALL-CODE                           
042920                 CALL "UT2000" USING                                     
042930                               UT2000CA-CALL-AREA                        
042940                                                                         
042950                 MOVE 01 TO UT0298CA-CALL-CODE                           
042960                 MOVE STRT-AREA-SOC-NO TO                                
042970                      UT0298CA-CALL-SOC-NO                               
042980                 CALL "UT0298" USING                                     
042990                               UT0298CA-CALL-AREA                        
043000                                                                         
043010                 MOVE 01 TO UT0200-CALL-CODE                             
043020                 CALL "UT0200" USING                                     
043030                               UT0200-CALL-AREA                          
043040                                                                         
043050                 MOVE 0 TO UT9000-CALL-CODE                              
043060                 CALL "UT9000" USING                                     
043070                               UT9000-CALL-AREA                          
043080                                                                         
B17951*                MOVE 01 TO UT2010-CODE                                  
B17951*                CALL "UT2010" USING                                     
B17951*                              UT2010-LINKAGE                            
043120                                                                         
043130                 MOVE 1 TO SY0010CA-FUNC                                 
043140                 CALL "SY0010" USING                                     
043150                               SY0010CA-COMMON-AREA                      
043160                               WA-JRNL-CALL-AREA                         
043170                 IF SY0010CA-STATUS NOT = ZERO                           
043180                    SET UT8500CA-NORMAL-DISPLAY TO TRUE                  
043190                    MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG              
043200                    MOVE SPACES TO UT8500CA-INPUT-MSG                    
043210                    STRING "BR0000:(A000) SY0010 INIT FAILED"            
043220                           "STOPPING ONLINE."                            
043230                           DELIMITED BY SIZE INTO                        
043240                           UT8500CA-INPUT-MSG                            
043250                    CALL "UT8500" USING                                  
043260                                  UT8500CA-AREA                          
043270                    CALL "ABORT"                                         
043280                 END-IF                                                  
043290*                                                                        
043300*****************************                                            
043310**  END OF INITIALIZATION  **                                            
043320*****************************                                            
043330*                                                                        
043340               SET UT8500CA-NORMAL-DISPLAY    TO TRUE                    
043350               SET UT8500CA-RESPONSE-NOT-REQD TO TRUE                    
043360               MOVE SPACES TO UT8500CA-INPUT-MSG                         
043370               STRING W-PROGRAM-NAME ":(A000) REP- "                     
043380                                     BR0000-REPLICA-NO                   
043390                                     " INITIALISED"                      
043400               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG                 
043410               CALL  "UT8500" USING                                      
043420                              UT8500CA-AREA                              
043430*
043440               GO TO A099-EXIT.
S11757*// INITIAL UT0082CA
S11757     INITIALIZE  UT0082-CALL-AREA.
S11757     MOVE  "01"  TO  UT0082-CALL-CODE.
S11757     CALL  "UT0082"  USING  UT0082-CALL-AREA
S11757                            STARTAREA.
043460***                                                                     
043470*** CHECK IF ALREADY INITIALIZED IN OTHER MODULES                       
043480***                                                                     
043490     IF STRT-AREA-TRN-INIT                                              
043500        SET UT8500CA-NORMAL-DISPLAY    TO TRUE                          
043510        SET UT8500CA-RESPONSE-NOT-REQD TO TRUE                          
043520        MOVE SPACES TO UT8500CA-INPUT-MSG                               
043530        STRING W-PROGRAM-NAME ":(A000) REP- "                           
043540               BR0000-REPLICA-NO " ALREADY INITIALISED"                 
043550               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG                
043560               CALL  "UT8500" USING                                     
043570                              UT8500CA-AREA                             
043580        GO TO A099-EXIT                                                 
043590     END-IF.                                                            
043610     MOVE 0 TO WA-TX-IND-FLAG
043620               BORP-SOC-NO
043630               BORP-ACCT-TYPE
SC2302               WA-GLDM-BRANCH
S11177               WA-BOIS-DEF-INT-END-DTE
043640               BORP-INT-CAT.
SC2302     MOVE SPACE            TO WA-POST-TO-GL-FLAG.
S10971     MOVE ZEROES           TO WA-SAVE-TRAN-CODE. 
SC5651     MOVE "0"              TO WA-CAST-GL-FLAG.
043650     MOVE WA-ACCEPT-DATE-U TO WA-TRN-DATE-98.
043660     PERFORM B000-CNTL-PARA THRU B099-EXIT-PARA.
043670*
043680*
043690     MOVE 0                    TO WA-CAST-LOCK-FLAG.
043700     MOVE "N"                  TO WA-GL-TRANSACTION-FLAG.
043710*    IF CASHIER-CURRENCY = SPACES      OR
043720*                          SOC-NATIVE-CURRENCY
043730*        MOVE 02               TO CASHIER-TOTAL-FUNCTION
043740*    ELSE
043750*        MOVE 12               TO CASHIER-TOTAL-FUNCTION.
043760*
043770     IF  WA-CAST-LOCK-FLAG = 1
043780         MOVE 0                  TO WA-CAST-LOCK-FLAG
043790         MOVE SOC-NATIVE-CURRENCY TO CASHIER-BASE-CURRENCY
043800         MOVE "LON"               TO CASHIER-SYSTEM
043810         MOVE ZEROES              TO CASHIER-AMOUNT
043820                                     CASHIER-CLOSE-INT-AVAIL
043830         MOVE 02                  TO CASHIER-TOTAL-FUNCTION
043840         CALL "UT0019" USING
043860                             STARTAREA
043870                             SOC-PARAMS
043880                             CASHIER-TOTALS
043890*                            CASHIER-CURRENCY
043900                             CASHIER-CALL-AREA
043910         IF  CASHIER-TOTAL-STATUS NOT = 0
TB0144             AND CASHIER-TOTAL-STATUS NOT = 889
043920             MOVE 1                    TO WA-MSG-ERR-FLAG
043930             MOVE 180                  TO WA-OUTPUT-ERR-MSG-NO
043940             MOVE UT8500CA-FUNC-NORMAL-DISPLAY                          
TB0144                                       TO UT8500CA-CALL-CODE
043950             MOVE SPACES TO UT8500CA-INPUT-MSG
043960             STRING "BR0000:(A000) CAST RECORD NOT WRITTEN BACK"
043970                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
043980             CALL "UT8500" USING UT8500CA-AREA.
043990 A099-EXIT.
SC5573************************************************************************
SC5573* AT THIS POINT IF THERE WAS AN ERROR, FT0000 SHOULD HAVE BEEN CALLED
SC5573* AND DB SHOULD BE ROLLED BACK AND NO MORE PROCESS NOR NEW MESSAGES
SC5573* SHOULD BE SENT. HOWEVER THERE SEEMS TO BE LOGIC THAT DID NOT CALL
SC5573* E000- WHEN ERROR OCCURED AND LEAVE TO THIS POINT TO DO EXTRA PROCESS
SC5573* THEREFORE THE FOLLOW LOGIC IS PUT IN SO THAT ERROR NEED EXTRA PROCESS
SC5573* WILL BE GROUPED TOGETHER AND OTHER LOGIC THAT SHOULD BE PERFORM WHEN
SC5573* NO ERROR ENCOUNTERED CAN GO ANOTHER WAY
SC5573************************************************************************
SC5573*
S20175* THIS IS TO UPDATE ALL BRANCH MIMA RETRY COUNTER WHEN ERROR
SC5573*
SC3838     IF WA-MSG-ERR-FLAG = 1
SC3838        IF WA-OUTPUT-ERR-MSG-NO = 3592 OR
SC3838           WA-OUTPUT-ERR-MSG-NO = 3593
S17003           OR WA-OUTPUT-ERR-MSG-NO = 5340
SC9599           CALL "UT0850" USING STARTAREA
SC9599                               INVE-RECORD-AREA
SC9599        END-IF
SC9599     END-IF.
SC3838*SC9599    CALL "FT0000" USING STARTAREA
SC3838*SC9599    MOVE "REWRITE"        TO DBIOMOD-FUNCTION
SC3838*SC9599    PERFORM M003-ACCESS-INVE THRU M003-EXIT
SC3838*SC9599    IF DBIOMOD-STAT = "****"
SC3838*SC9599       MOVE 0          TO WA-MSG-ERR-FLAG
SC3838*SC9599       MOVE 0          TO WA-OUTPUT-ERR-MSG-NO
SC3838*SC9599       MOVE UT8500CA-FUNC-NORMAL-DISPLAY
SC3838*SC9599                       TO UT8500CA-CALL-CODE
SC3838*SC9599       MOVE SPACES TO UT8500CA-INPUT-MSG
SC3838*SC9599       CALL "UT8500" USING
SC3838*SC9599                      UT8500CA-AREA
SC5573*SC9599       GO TO A099-JUST-EXIT
SC3838*SC9599     END-IF.
SC3838
SC5573*
SC5573* PASSING THIS POINT NO ADDITION LOGIC WILL BE PERFORMED WHEN THERE IS ERRO
SC5573     IF WA-MSG-ERR-FLAG = 1
SC5573        GO TO A099-JUST-EXIT.
SC5573*
TB0266*ST0038     PERFORM E020-VOUCHER-PRINT THRU E029-EXIT.
SC4506     IF STRT-AREA-TRN-NO = 13031 OR 13131 OR
SC4506                           11044 OR 11144 OR
SC4506                           11048 OR 11148 
SC4506        IF BR0023-OUT-DUE-AMT     NOT > ZEROS
SC4506           MOVE WA-OUTPUT-MESSAGE TO WS-SAVE-OUTPUT-MESSAGE
S20759           IF   STRT-DSS-BUNCH-TXN
S20759                INITIALIZE              WA-OUTPUT-MESSAGE
S20759           END-IF
SC4506           COMPUTE BR0023-OUT-DUE-AMT = WA-REPAY-AMOUNT      +
SC4506                   BR0023-PENALTY-AMT + BR0023-WAIVE-AMT     
SC4506           MOVE WA-REPAY-INPUT-ACCT-NO  TO BR0023-OUT-ACCT-NO       
SC4506           MOVE WA-REPAY-AMOUNT           TO BR0023-OUT-AMOUNT            
SC4506           MOVE WA-REPAY-MORTGAGE      TO BR0023-OUT-MORTGAGE-NO       
SC4506           MOVE WA-REPAY-SUB-LEDG-CODE    
SC4506             TO BR0023-OUT-SUB-LDGE-CODE
SC4506           MOVE WA-REPAY-PROMO         TO BR0023-OUT-PROMO-NO
SC4506           MOVE WA-REPAY-TXN-DATE         TO BR0023-OUT-TXN-DATE          
SC4506           MOVE WA-REPAY-PRIN-RECALC 
SC4506             TO BR0023-OUT-REPAY-PRN-RECALC
SC4506           MOVE WA-REPAY-TRACER-NO        TO BR0023-OUT-TRACER-NO 
SC4506           MOVE BR0023-PRIN-PEN-IND     TO BR0023-OUT-PRIN-PEN-IND      
SC4506           MOVE BR0023-PENALTY-AMT      TO BR0023-OUT-PENALTY-AMT       
SC4506           MOVE BR0023-WAIVE-AMT        TO BR0023-OUT-WAIVE-AMT
S15788           MOVE BR0023-PCC-CODE         TO BR0023-OUT-PCC-CODE
SC4506           MOVE BR0023-REASON-CODE      TO BR0023-OUT-REASON-CODE
SC4506           MOVE BR0023-DEP-ACC-NO       TO BR0023-OUT-DEP-ACC-NO
S15241           MOVE BR0023-AUTH-ID          TO BR0023-OUT-AUTH-ID
S15241           MOVE 428  TO WA-OUTPUT-MSG-LENGTH
S15241*SC4506           MOVE 400 TO WA-OUTPUT-MSG-LENGTH
SC4506           MOVE 998 TO WA-OUTPUT-ERR-MSG-NO
SC8908           MOVE 0   TO STRT-AREA-IEXEC-CNTL
SC4506           CALL "FT0000" USING
SC4506                         STARTAREA      
SC4506           MOVE WS-SAVE-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE          
SC4506        END-IF
SC4506     END-IF.
S16871*S11911     IF STRT-BANCSLINK AND
S16871     IF (STRT-BANCSLINK OR STRT-DSS-BUNCH-TXN ) AND
S11911        STRT-AREA-TRN-NO = 11055
S11911        MOVE WA-OUTPUT-MESSAGE     TO WS-SAVE-OUTPUT-MESSAGE
S11911        INITIALIZE   BR0024-TMP-MSG-55
S11911        MOVE "0"                       TO BR0024-TMP-PREF-1-55
S11911        MOVE WA-SAVE-ACCT-1            TO BR0024-TMP-ACCT-1-55
S11911        MOVE WA-SAVE-OTH-1             TO BR0024-TMP-ORI-1-55
S11911        MOVE "0"                       TO BR0024-TMP-PREF-2-55
S11911        MOVE WA-SAVE-ACCT-2            TO BR0024-TMP-ACCT-2-55
S11911        MOVE WA-SAVE-OTH-2             TO BR0024-TMP-ORI-2-55
S11911        MOVE BORM-MEMB-CUST-AC     TO BR0024-TMP-ACCT-NO-55
S11911        MOVE BOIS-RECEIV-FEE       TO BR0024-TMP-FEE-AMOUNT-55
S11911        MOVE WA-SAVE-ACCT-2        TO BR0024-TMP-FROM-ACCT-NO-55
S11911        MOVE BOIS-CARLN-SUB-PROJ   TO BR0024-TMP-SUBS-YN-55
S11911        MOVE 818 TO WA-OUTPUT-MSG-LENGTH
S11911        MOVE 998 TO WA-OUTPUT-ERR-MSG-NO
S11911        MOVE 0   TO STRT-AREA-IEXEC-CNTL
S11911        CALL "FT0000" USING
S11911                      STARTAREA
S11911        MOVE WS-SAVE-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE
S11911     END-IF.
S16871*S11911     IF STRT-BANCSLINK AND
S16871     IF (STRT-BANCSLINK OR STRT-DSS-BUNCH-TXN ) AND
S11911        STRT-AREA-TRN-NO = 11057
S11911        MOVE WA-OUTPUT-MESSAGE     TO WS-SAVE-OUTPUT-MESSAGE
S11911        INITIALIZE   BR0024-TMP-MSG-57
S11911        MOVE WA-SAVE-ADV-INPUT-MSG(1:657) TO BR0024-TMP-ORI-57
S11911        MOVE BORM-MEMB-CUST-AC     TO BR0024-TMP-ACCT-NO-57
S11911        MOVE BOIS-RECEIV-FEE       TO BR0024-TMP-FEE-AMOUNT-57
S11911        MOVE WA-SAVE-ACCT-2        TO BR0024-TMP-FROM-ACCT-NO-57
S11911        MOVE BOIS-CARLN-SUB-PROJ   TO BR0024-TMP-SUBS-YN-57
S12049        MOVE 03  TO WA-INPUT-MSG-CODE
S11911        MOVE 708 TO WA-OUTPUT-MSG-LENGTH
S11911        MOVE 998 TO WA-OUTPUT-ERR-MSG-NO
S11911        MOVE 0   TO STRT-AREA-IEXEC-CNTL
S11911        CALL "FT0000" USING
S11911                      STARTAREA
S11911        MOVE WS-SAVE-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE
S11911     END-IF.
MVS101*    EXIT.
MVS101*A100-EXIT-PARA.
TB0015
S11927     MOVE WA-SAVE-CUST-STATUS TO WS-UT0500RA-CUSM-STATUS-SAVE.
S16182*S12520      IF  STRT-BANCSLINK
S16182*S12520        MOVE STRT-AREA-SOC-NO OF STARTAREA TO UTCICECA-INST-NO
S16182*S12520        SET  UTCICECA-INQ           TO TRUE
S16182*S12520        CALL "UTCICE"            USING STARTAREA
S16182*S12520                                       UTCICE-CALL-AREA
S16182*S12520        IF  UTCICECA-ERR-MSG-NO > 0
S16182*S12520            SET  UT8500CA-NORMAL-DISPLAY TO TRUE
S16182*S12520            MOVE SPACES                  TO UT8500CA-INPUT-MSG
S16182*S12520            STRING "BR0000: UTCICE CALL ERROR"
S16182*S12520            DELIMITED BY SIZE INTO  UT8500CA-INPUT-MSG
S16182*S12520            CALL  "UT8500"  USING  UT8500CA-AREA
S16182*S12520        END-IF
S16182*S12520     END-IF.
SC9527     IF STRT-BANCSLINK
S16182     AND (CUST-WHEREABOUTS-UNKNOWN OR CUST-IS-DECEASED)
S12520*SC9527     AND (CUST-WHEREABOUTS-UNKNOWN OR CUST-IS-DECEASED)
S16182*S12520     AND (CUST-WHEREABOUTS-UNKNOWN OR CUST-IS-DECEASED OR
S16182*S12520          UTCICECA-RETN-CODE > 0)
SC2417         MOVE 2                     TO UT9000-CALL-CODE
SC2417         MOVE " "                   TO UT9000-CALL-STATUS
SC2417         MOVE STRT-AREA-SOC-NO OF STARTAREA
SC2417                                    TO UT9000-INST-NO
SC2417         MOVE W-PROGRAM-NAME        TO UT9000-CALLING-ID
SC2417         MOVE STRT-AREA-TELLER-LANG OF STARTAREA
SC2417                                    TO UT9000-LANGUAGE-CODE
SC2417         MOVE 1                     TO UT9000-SEQUENCE-NO
S16182*S12520         IF CUST-IS-DECEASED
S16182*S12520            MOVE 17              TO UT9000-REPORT-NO
S16182*S12520         ELSE
S16182*S12520            IF UTCICECA-RETN-CODE > 0
S16182*S12520               MOVE "CI0000"           TO UT9000-CALLING-ID
S16182*S12520               MOVE 18                 TO UT9000-REPORT-NO
S16182*S12520               MOVE UTCICECA-RETN-CODE TO UT9000-SEQUENCE-NO
S16182*S12520            ELSE
S12520*SC2417         IF CUST-WHEREABOUTS-UNKNOWN
S16182         IF CUST-WHEREABOUTS-UNKNOWN
SC2417            MOVE 16                 TO UT9000-REPORT-NO
S16182         ELSE
S16182            MOVE 17                 TO UT9000-REPORT-NO
S16182*S12520            END-IF
S12520*SC2417         ELSE
S12520*SC2417            MOVE 17                 TO UT9000-REPORT-NO
SC2417         END-IF
SC2417         PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT
SC2417         IF UT9000-CALL-STATUS = "0"
SC2417            MOVE WA-OUTPUT-MESSAGE     TO WS-SAVE-OUTPUT-MESSAGE
SC2417            INITIALIZE                    WA-OUTPUT-MESSAGE
SC2417            MOVE SPACES                TO WA-OUTPUT-MSG
SC2417            MOVE 998                   TO WA-OUTPUT-ERR-MSG-NO
SC2417            MOVE 50                    TO WA-OUTPUT-MSG-LENGTH
SC2417            MOVE UT9000CA-SOURCE-DATA  TO 
SC2417                                       WA-OUTPUT-WARNING-MSG-TEXT
SC2417            MOVE 08                    TO WA-INPUT-MSG-TYPE    
SC2417            CALL "FT0000" USING
SC2417                               STARTAREA
SC2417            MOVE WS-SAVE-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE   
SC2417         END-IF
TB0015*SC2417 DISPLAY "++CUST-STATUS IS 001++"
TB0015*SC2417 MOVE WA-OUTPUT-MESSAGE TO WS-SAVE-OUTPUT-MESSAGE
TB0015*SC2417 MOVE SPACES       TO WA-OUTPUT-MESSAGE
TB0015*SC2417 MOVE 998          TO WA-OUTPUT-ERR-MSG-NO
TB0015*SC2417 MOVE 47           TO WA-OUTPUT-MSG-LENGTH
TB0015*SC2417 MOVE "WHEREABOUTS UNKNOWN"
TB0015*SC2417                   TO WA-OUTPUT-WARNING-MSG-TEXT
TB0107*SC2417 MOVE 08           TO WA-INPUT-MSG-TYPE
TB0015*SC2417 CALL "FT0000"  USING
TB0015*SC2417                    STARTAREA
TB0015*SC2417 MOVE 0            TO WS-UT0500RA-CUSM-STATUS-SAVE
TB0015*SC2417 MOVE SPACES       TO WA-OUTPUT-MESSAGE
TB0015*SC2417 MOVE WS-SAVE-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE
TB0015     END-IF.
TB0015
S15879* // ADD HINT MESSAGE FOR FINANCE TXN
S15879     IF  STRT-BANCSLINK
S15879     AND WA-MSG-ERR-FLAG          =  0
S15879       MOVE  STRT-AREA-TRN-NO    TO  WA-CURR-TRCODE
S15879       IF  (WA-CASH-DEBIT-ADD    OR  WA-CASH-CREDIT-ADD)
S15879*      AND WA-INPUT-AMT          >=  500000
S16461       AND WA-INPUT-AMT          >=  SOC-DCSH-LIMT-CR
S15879         MOVE  2                 TO  UT9000-CALL-CODE
S15879         MOVE  SPACES            TO  UT9000-CALL-STATUS
S15879         MOVE  STRT-AREA-SOC-NO  TO  UT9000-INST-NO
S15879         MOVE  "IN0000"          TO  UT9000-CALLING-ID
S15879         MOVE  SOC-LANGUAGE-CODE TO  UT9000-LANGUAGE-CODE
S15879         MOVE  15                TO  UT9000-REPORT-NO
S15879         IF WA-INPUT-PARAM-TABLE(4) = 1
S15879           MOVE  3               TO  UT9000-SEQUENCE-NO
S15879         END-IF
S15879         IF WA-INPUT-PARAM-TABLE(5) = 1
S15879           MOVE  4               TO  UT9000-SEQUENCE-NO
S15879         END-IF
S19775         PERFORM  U9300-POPUP-ACNO-AMT THRU  U9399-EXIT
S15879         PERFORM  U9100-RETRIEVE-TEXT  THRU  U9199-EXIT
S15879         IF  UT9000-CALL-STATUS   =  "0"
S15879           MOVE  "02"            TO  UT0082-CALL-CODE
S15879           MOVE  "Y"             TO  UT0082-NEW-LINE-FLAG
S15879           MOVE  UT9000-SOURCE-LENGTH  TO  UT0082-MSG-LENGTH
S15879           MOVE  UT9000CA-SOURCE-DATA  TO  UT0082-MSG-TEXT
S15879           CALL  "UT0082"     USING  UT0082-CALL-AREA
S15879                                     STARTAREA
S15879         END-IF
S15879       END-IF
S15879       IF  WA-TFR-FROM-DEP-ACCT
S15879       AND WA-INPUT-AMT          >=  1000000
S15879       AND (STRT-AREA-USER-TYPE   =  '01' OR '02' OR '03'
S15879                                 OR  '04' OR '05')
S15879         MOVE  2                 TO  UT9000-CALL-CODE
S15879         MOVE  SPACES            TO  UT9000-CALL-STATUS
S15879         MOVE  STRT-AREA-SOC-NO  TO  UT9000-INST-NO
S15879         MOVE  "IN0000"          TO  UT9000-CALLING-ID
S15879         MOVE  SOC-LANGUAGE-CODE TO  UT9000-LANGUAGE-CODE
S15879         MOVE  15                TO  UT9000-REPORT-NO
S15879         MOVE  2                 TO  UT9000-SEQUENCE-NO
S15879         PERFORM  U9100-RETRIEVE-TEXT  THRU  U9199-EXIT
S15879         IF UT9000-CALL-STATUS    =  "0"
S15879           MOVE  "02"            TO  UT0082-CALL-CODE
S15879           MOVE  "Y"             TO  UT0082-NEW-LINE-FLAG
S15879           MOVE  UT9000-SOURCE-LENGTH  TO  UT0082-MSG-LENGTH
S15879           MOVE  UT9000CA-SOURCE-DATA  TO  UT0082-MSG-TEXT
S15879           CALL  "UT0082"     USING  UT0082-CALL-AREA
S15879                                     STARTAREA
S15879         END-IF
S15879       END-IF
S15879     END-IF.
TB0027     MOVE STRT-AREA-TRN-NO     TO WA-CURR-TRCODE.
TB0027     IF (WA-CASH-DEBIT-ADD
TB0027         OR WA-CASH-DEBIT-LESS)
SC1514*    AND BOIS-ACCUM-TOD-CASH-DR > SOC-LCSH-LIMT-DR
SC1514     AND BOIS-ACCUM-TOD-CASH-DR NOT < SOC-LCSH-LIMT-DR
SC3170     AND WA-MSG-ERR-FLAG       =  0
TB0027        MOVE WA-OUTPUT-MESSAGE TO WS-SAVE-OUTPUT-MESSAGE
TB0027        MOVE SPACES            TO WA-OUTPUT-MESSAGE
TB0027        MOVE 3575              TO UT9000-REPORT-NO
TB0027        PERFORM N1600-SEND-WARNING-MSG THRU N1699-EXIT
TB0027        MOVE SPACES            TO WA-OUTPUT-MESSAGE
TB0027        MOVE WS-SAVE-OUTPUT-MESSAGE  TO WA-OUTPUT-MESSAGE
TB0027     ELSE
TB0027        IF (WA-CASH-CREDIT-ADD
TB0027            OR WA-CASH-CREDIT-LESS)
SC1514*       AND BOIS-ACCUM-TOD-CASH-CR > SOC-LCSH-LIMT-CR
SC1514        AND BOIS-ACCUM-TOD-CASH-CR NOT < SOC-LCSH-LIMT-CR
TB0027            MOVE WA-OUTPUT-MESSAGE TO WS-SAVE-OUTPUT-MESSAGE
TB0027            MOVE SPACES            TO WA-OUTPUT-MESSAGE
TB0027            MOVE 3600              TO UT9000-REPORT-NO
TB0027            PERFORM N1600-SEND-WARNING-MSG THRU N1699-EXIT
TB0027            MOVE SPACES            TO WA-OUTPUT-MESSAGE
TB0027            MOVE WS-SAVE-OUTPUT-MESSAGE  TO WA-OUTPUT-MESSAGE
TB0027        END-IF
TB0027     END-IF.
S16963     IF (STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048)
S16963     AND BORM-BAD-DEBT-IND(2:1) = 0
S16963     AND STRT-BANCSLINK
S16963     AND WA-ACT-TYPE-70-77
S16963     AND BORP-LOAN-CLASS <> "2"
S16963     AND BORM-REPAY-METHOD = " "
S16963     AND WA-REPAY-AMOUNT > WA-BORM-DUE-AMT * 3
S16963     AND WA-REPAY-AMOUNT >= 50000
S16977     AND NOT WA-ACT-TYPE-709
S16963         MOVE 2                  TO UT9000-CALL-CODE
S16963         MOVE " "                TO UT9000-CALL-STATUS
S16963         MOVE STRT-AREA-SOC-NO OF STARTAREA
S16963                                 TO UT9000-INST-NO
S16963         MOVE W-PROGRAM-NAME     TO UT9000-CALLING-ID
S16963         MOVE STRT-AREA-TELLER-LANG OF STARTAREA
S16963                                 TO UT9000-LANGUAGE-CODE
S16963         MOVE 1                  TO UT9000-SEQUENCE-NO
S16963         IF BORM-VALUER-CODE NOT = ZEROS
S16963            MOVE BORM-VALUER-CODE TO WA-SAVE-BRCH-NO
S16963         ELSE
S16963            MOVE BORM-BR-NO      TO WA-SAVE-BRCH-NO
S16963         END-IF
S16963         EVALUATE WA-SAVE-BRCH-NO
S16963         WHEN 0006
S16963            MOVE 1               TO UT9000-REPORT-NO
S16963         WHEN 0011
S16963         WHEN 0023
S16963            MOVE 2               TO UT9000-REPORT-NO
S16963         WHEN 0015
S16963            MOVE 3               TO UT9000-REPORT-NO
S16963         WHEN 0027
S16963            MOVE 4               TO UT9000-REPORT-NO
S16963         WHEN 0028
S16963            MOVE 5               TO UT9000-REPORT-NO
S16963         WHEN 0063
S16963            MOVE 6               TO UT9000-REPORT-NO
S16963         END-EVALUATE
S16963         PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT
S16963         IF UT9000-CALL-STATUS    =  "0"
S16963            MOVE  "02"           TO  UT0082-CALL-CODE
S16963            MOVE  "Y"            TO  UT0082-NEW-LINE-FLAG
S16963            MOVE  UT9000-SOURCE-LENGTH  TO  UT0082-MSG-LENGTH
S16963            MOVE  UT9000CA-SOURCE-DATA  TO  UT0082-MSG-TEXT
S16963            CALL  "UT0082"     USING  UT0082-CALL-AREA
S16963                                      STARTAREA
S16963         END-IF
S16963     END-IF.
SC5573* MOVE THIS MASTER UPDATE LOGIC UP RIGHT AFTER A099-EXIT
SC5573*    IF WA-MSG-ERR-FLAG = 1
SC5573*       IF WA-OUTPUT-ERR-MSG-NO = 3592 OR
SC5573*          WA-OUTPUT-ERR-MSG-NO = 3593
SC5573*          CALL "FT0000" USING STARTAREA
SC5573*          MOVE "REWRITE"        TO DBIOMOD-FUNCTION
SC5573*          PERFORM M003-ACCESS-INVE THRU M003-EXIT
SC5573*          IF DBIOMOD-STAT = "****"
SC5573*             MOVE 0          TO WA-MSG-ERR-FLAG
SC5573*             MOVE 0          TO WA-OUTPUT-ERR-MSG-NO
SC5573*             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
SC5573*                             TO UT8500CA-CALL-CODE
SC5573*             MOVE SPACES TO UT8500CA-INPUT-MSG
SC5573*             CALL "UT8500" USING
SC5573*                            UT8500CA-AREA
SC5573*           END-IF.
SC5573*
APLEXD*-----------------------------------------------------------------
APLEXD
APLEXD     IF STRT-AREA-OK-MSG-CNTL-FLAG = "0" OR "8" OR "9"
APLEXD        MOVE WA-PBOOK-OUTPUT-DATA TO WA-OUTPUT-SAVE-AREA
APLEXD        PERFORM Z200-PB-LINE-CHK THRU Z299-EXIT
APLEXD        MOVE WA-OUTPUT-SAVE-AREA TO WA-PBOOK-OUTPUT-DATA
MVS101*ST0038        IF WA-OUTPUT-ERR-MSG-NO = 900
MVS101*ST0038           MOVE SPACE TO STRT-AREA-OK-MSG-CNTL-FLAG
MVS101*ST0038        END-IF
SC2882*ST0038        IF STRT-AREA-IEXEC-CNTL = 0
MVS101*ST0038         IF STRT-AREA-OK-SENT
MVS101*ST0038           MOVE 0 TO WA-OUTPUT-ERR-MSG-NO
MVS101*ST0038         END-IF
MVS101*ST0038         IF STRT-AREA-998-SENT
MVS101*ST0038           MOVE 998 TO WA-OUTPUT-ERR-MSG-NO
MVS101*ST0038         END-IF
MVS101*ST0038         IF STRT-AREA-999-SENT
MVS101*ST0038           MOVE 999 TO WA-OUTPUT-ERR-MSG-NO
MVS101*ST0038         END-IF
SC2882*ST0038        END-IF
MVS101*ST0038        MOVE SPACE TO STRT-AREA-OK-MSG-CNTL-FLAG
SC5662        IF WA-OUTPUT-ERR-MSG-NO = 0
SC5662        AND ((STRT-AREA-TRN-NO = 12006 OR 12008 OR 10915)
S16588*SC5662             OR ( STRT-AREA-TRN-NO     = 17026
S16588             OR (((STRT-AREA-TRN-NO     = 17085
S16588                  AND WA-IN-17085-AUTOLINK  = 'Y')
S16588             OR ( STRT-AREA-TRN-NO     = 17026
S16588                  AND WA-17026-ACTION  = SPACES))
SC5662                  AND BORM-STAT        = 01
S16588*SC7814                  AND WA-17026-ACTION  = SPACES
SC5662                  AND (BORP-LOAN-CLASS = 1 OR 2 OR 3))
SC5662             OR (STRT-AREA-TRN-NO = 12009
SC5662                 AND BORM-STAT    = 01))
SC5858***
SC5868***        85007 is inadvertently called several times during account
SC5868***        creation. To reassure that this is only called once
SC5868***        a validation is added where the trancode is the same
SC5868***        value as when we entered this mainline program.
SC5868***
SC5868           IF WA-ORIG-EFT-TRN-NO = STRT-AREA-TRN-NO
S10108           AND NOT BORP-YOUBE
S10975           AND NOT STRT-MORTGAGE-TXN
S16564           AND NOT BORP-COMML-LN
TB0226              PERFORM Z999-CLCM-85007-SCHED THRU Z999-CLCM-EXIT
SC5868           END-IF
TB0226        END-IF
APLEXD     END-IF.
APLEXD*-----------------------------------------------------------------
S11757*// SEND MSG TYPE 53
S11757     IF  STRT-BANCSLINK  AND
S11757         (WA-MSG-ERR-FLAG  =  0)
S11757       MOVE  "09"  TO  UT0082-CALL-CODE
S11757       CALL  "UT0082"  USING  UT0082-CALL-AREA
S11757                              STARTAREA
S11757     END-IF.
S17726
S17726     MOVE 4                       TO UT9002CA-CALL-CODE.
S17726     CALL "UT9002"             USING UT9002CA-CALL-AREA.
S19269*S16871     IF (NOT BORP-FOREIGN-LABORER
S19269*S16871     AND BORP-CORPORATION)
S19269     IF ((NOT BORP-FOREIGN-LABORER
S19269     AND BORP-CORPORATION)
S20771*S19269     OR  BORP-PB)
S20771     OR  BORP-PB OR BORP-FBOND)
S16871     AND NOT STRT-DSS-BUNCH-TXN
S16871     AND WA-INPUT-PARAM-TABLE(23) = 0
S17726*S16871     AND WA-LIMIT-AMT > 0
S17726     AND (WA-LIMIT-AMT > 0
S17726      OR  UT9002CA-AMOUNT > 0 OR UT9002CA-AMOUNT-REL > 0)
S16871         PERFORM S200-WBS-RTN  THRU S200-EXIT
S16871     END-IF.
SC7443     PERFORM S100-CALL-ATM THRU S100-CALL-ATM-EXIT.
ST0038     MOVE STRT-AREA-TRN-NO     TO WS-STRT-ORG-TRANCODE.
S10606     IF   NOT ( STRT-AREA-TRN-NO     =  10706 )
S10606          MOVE WS-VCHR-ORG-TRANCODE TO STRT-AREA-TRN-NO
S10606     END-IF.
S10606*ST0038     MOVE WS-VCHR-ORG-TRANCODE TO STRT-AREA-TRN-NO.
ST0038     PERFORM E020-VOUCHER-PRINT THRU E029-EXIT.
SC5573* THE OKAY MESSAGE FOR ACCOUNT CREATE NOW SEND FROM HERE
SC5573     IF STRT-AREA-TRN-NO = 12000
SC5573        MOVE 0       TO WA-OUTPUT-ERR-MSG-NO
SC5573        MOVE SPACES  TO WA-OUTPUT-MSG
SC5573        MOVE WA-INPUT-KEY TO UT0151CA-ACCT-IN
SC5573        MOVE SOC-ACCT-NO-FORMAT TO UT0151CA-FORMAT
SC5573        MOVE 4 TO  UT0151CA-CALL-FUNC
SC5573        MOVE SOC-CHK-DGT TO UT0151CA-CHK-DGT-TYPE
SC5573        CALL "UT0151" USING UT0151CA-CALL-AREA
SC5573        IF UT0151CA-STATUS NOT = ZERO
SC5573           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
SC5573           MOVE SPACES TO UT8500CA-INPUT-MSG
SC5573           STRING "BR0000:(A000) CHECK DIGIT CALC ERROR "
SC5573                  DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC5573           CALL   "UT8500" USING UT8500CA-AREA
SC5573        END-IF
SC5573        MOVE UT0151CA-FORMAT-NO-18 TO BR0001-OUTPUT-ACCT-NO
SC5573        MOVE STRT-AREA-SOC-NO     TO BR0001-OUTPUT-SOC-NO
SC5573        MOVE STRT-AREA-BRANCH     TO BR0001-OUTPUT-BRANCH
SC5573        MOVE STRT-AREA-TERM-NO    TO BR0001-OUTPUT-TERM-NO
SC5573        MOVE STRT-AREA-TELL-NO    TO BR0001-OUTPUT-TELL-NO
SC5573        MOVE 37  TO WA-OUTPUT-MSG-LENGTH
SC5573        IF SOC-LOANS-TRACKING-OPTION = "Y" AND
SC5573           WA-INPUT-PARAM-TABLE(22) = 1
SC5573           CALL "BR0013" USING STARTAREA
SC5573        ELSE
SC5573           IF STRT-AREA-BATCH-TANDEM = "T"
SC5573              GO TO A099-JUST-EXIT
SC5573           ELSE
SC5573              CALL "FT0000" USING STARTAREA
SC5573           END-IF
SC5573        END-IF
SC5573     END-IF.
SC6965     IF BR0000-SYSTEM-IN-NIGHT
SC6965          IF STRT-AREA-VIRTUAL-ACCT-FLAG = "Y"
SC6965             IF WA-INPUT-PARAM-TABLE(29 ) = 1
SC6965                MOVE WA-VIRTUAL-TO-ACCT TO W800-TO-ACCT
SC6965             ELSE
SC6965                MOVE WA-VIRTUAL-FROM-ACCT TO WA-INPUT-KEY
SC6965             END-IF
SC6965          END-IF
SC8350          IF FEDI-BP-TXN
SC8350             MOVE WA-SAVE-FEDI-FROM-AC TO W800-FROM-ACCT
SC8350             MOVE WA-SAVE-FEDI-TO-AC   TO W800-TO-ACCT
SC8350          END-IF
SC6965     END-IF.
S19100     IF  WA-ATM-STRF-TXN
S19100     AND (WA-ATM-PROMO-NO NOT = WA-STRF-PROMO-NO)
S19100         MOVE WA-STRF-PROMO-NO         TO WA-ATM-PROMO-NO
S19100     END-IF.
SC7868     IF STRT-AREA-DUMB-TERM OR STRT-BANCSLINK
S16871     OR STRT-DSS-BUNCH-TXN
SC7868        IF WA-OUTPUT-ERR-MSG-NO = 998
SC7868           AND STRT-AREA-IEXEC-CNTL = 0
SC7868           MOVE 2             TO STRT-AREA-IEXEC-CNTL
SC7868        END-IF
SC7868     END-IF.
S19468* // ADD HINT MESSAGE FOR ACH CHECK
S19468     IF  WA-MSG-ERR-FLAG = 0
S19468         AND  STRT-BANCSLINK
S19468         AND  WA-ACT-TYPE-71-73
S19468         AND  WA-ACH-POPUP-CHK
S19468         PERFORM X950-ACH-CHECK-RTN THRU X950-EXIT
S19468     END-IF.
SC7495     IF  (WA-OUTPUT-ERR-MSG-NO = 0 OR 998 OR 999)
S16871*SC7495     AND STRT-BANCSLINK
S16871     AND (STRT-BANCSLINK OR STRT-DSS-BUNCH-TXN)
ST0055         CALL "FT0000" USING STARTAREA
ST0055     END-IF.
S20611     IF  (WA-OUTPUT-ERR-MSG-NO = 0 OR 998 OR 999)
S20611     AND (STRT-AREA-TRN-NO = 17200 OR 17205)
S20611     AND (STRT-DIB-TXN OR STRT-WEBLOGIC-IB-TXN)
S20611          CALL "FT0000" USING STARTAREA
S20611     END-IF.
SC8404     MOVE SPACES              TO ST-SYSTEM. 
SC9610     MOVE 0                   TO ST-LOAN-BACKDATED-CORR.
SC5868***
SC5868***  The following commands must be done in general to guarantee
SC5868***  the original transactions ares posted to IMG0 for reposting.
SC5868***
ST0038*    MOVE WS-STRT-ORG-TRANCODE TO STRT-AREA-TRN-NO.
SC5266*    IF STRT-AREA-EFT-TXN
SC5266*    AND (WA-ORIG-EFT-TRN-NO NOT = STRT-AREA-TRN-NO)
SC5266*        MOVE WA-ORIG-EFT-TRN-NO TO STRT-AREA-TRN-NO
SC5266*    END-IF
SC5573*
SC5573* ABSOLUTELY NO MORE PROCESS SHOULD BE ADD AFTER HERE
SC5573 A099-JUST-EXIT.
ST0137***  CHECK HERE AGAIN TO BLOCK THE CASE AFER E000- PARA
ST0137     IF   WA-MSG-ERR-FLAG      = 1
ST0137     AND (WA-OUTPUT-ERR-MSG-NO = 0
ST0137      OR  WA-OUTPUT-ERR-MSG-NO < 100
ST0137      OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
ST0137**        COMMENT OUT THE ERR NO AND JUST DISPLAY 
ST0137**        MOVE 1062 TO WA-OUTPUT-ERR-MSG-NO
ST0137          MOVE UT8500CA-FUNC-NORMAL-DISPLAY
ST0137                            TO UT8500CA-CALL-CODE
ST0137          MOVE SPACES TO UT8500CA-INPUT-MSG
ST0137          STRING "BR0000(A099) ERR 0 "
ST0137            ",TRN-" STRT-AREA-TRN-NO
ST0137            ",TEL-" STRT-AREA-TELL-NO
ST0137            ",INP-" WA-DISP-ORIG-INP-MSG
ST0137            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
ST0137            CALL "UT8500" USING
ST0137                                UT8500CA-AREA
ST0137     END-IF.
044250     EXIT PROGRAM.
044260/
044270 A100-LOAD-ALL-FILES.
044280     MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
044290     MOVE SPACES TO UT8500CA-INPUT-MSG
044300     STRING "BR0000:(A100) LOADING FILES"
044310         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
044320     CALL "UT8500" USING
044340                         UT8500CA-AREA.
B17951*    OPEN INPUT FS0401.
044360     MOVE SPACES                 TO WA-ONLINE-EOF.
B17951     INITIALIZE   DATE-KEY   OF  ONPARAM-REC.
044370     SET DATE-1 TO 1.
044380*    NCR-LOCK W100-DATE-FILE FOR UPDATE.
044390     PERFORM A500-INIT-DATE-TAB THRU A599-EXIT
044400*     UNTIL DATE-1 > 50.
044410* SIZE OF W100-DATE-TAB HAS BEEN INCREASED FROM 50 TO 120
044420* (SIE YOU)
044430     UNTIL DATE-1 > 120.
044440     SET DATE-1 TO 1.
044450     PERFORM A300-LOAD-ONLINE-DATE
044460        THRU A399-EXIT UNTIL WA-ONLINE-EOF = "Y".
B17951*    CLOSE  FS0401.                                                      
044490*    NCR-UNLOCK W100-DATE-FILE.
044500*
044510     MOVE 03   TO UT0220CA-CALL-CODE.
044520     MOVE ZERO TO UT0220CA-CALL-STATUS,
044530                  UT0220CA-CALL-SOC-NO.
044540     MOVE 1    TO UT0220CA-CALL-GRP-NO.
044550*
044560*    MOVE  ZEROS  TO   UT0330CA-CALL-SECT.
044570*    MOVE  01     TO   UT0330CA-CALL-CODE.
044580*    CALL  "UT0330" USING
044590*
044600*                         UT0330CA-CALL-PARAM.
044610*    IF    UT0330CA-CALL-STATUS  NOT = ZERO
044620*    IF    DBIOMOD-STAT NOT = "****"
044630*       MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
044640*       MOVE SPACES TO UT8500CA-INPUT-MSG
044650*       STRING "BR0000 (A100-) BAD STATUS RETURNED FROM UT0330"
044660*           DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
044670*       CALL "UT8500" USING
044680*
044690*                           UT8500CA-AREA
044700*       GO          TO  A199-EXIT.
044710     MOVE 1 TO UT0069CA-CALL-CODE.
044720     CALL "UT0069" USING
044740                            UT0069-LINKAGE.
044750*
044760*INIT. UT0350 (INSTITUTION MARKETING TABLE)
044770*
044780     MOVE 1 TO UT0350-CALL-CODE.
044790     CALL "UT0350" USING
044810                            UT0350-CALL-AREA.
044820*
044830 A110-LOAD-UT0220-ALL.
044840*
044850     CALL  "UT0220" USING
044870                          WA-UT0220-CALL-AREA.
044880*
044890     IF UT0220CA-CALL-STATUS  =  1
044900        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
044910        MOVE SPACES TO UT8500CA-INPUT-MSG
044920        STRING "BR0000 (A110-) BAD STATUS RETURNED FROM UT0220"
044930            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
044940        CALL "UT8500" USING
044960                            UT8500CA-AREA
044970        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
044980        MOVE SPACES TO UT8500CA-INPUT-MSG
044990        STRING "STATUS = " UT0220CA-CALL-STATUS
045000            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
045010        CALL "UT8500" USING
045030                            UT8500CA-AREA
045040        GO TO A199-EXIT.
045050*
045060     IF UT0220CA-CALL-STATUS  =  2
045070        GO TO A199-EXIT.
045080*
045090     IF SOC-LOANS-TRACKING-OPTION = "Y"
045100        NEXT SENTENCE
045110      ELSE
045120        MOVE SOC-NO-1 TO UT0220CA-CALL-SOC-NO
045130        GO TO A110-LOAD-UT0220-ALL.
045140*
045150******************************************************************
045160*
045170*    CODE TO LOAD TRACKING ACTION TABLE
045180*
045190*    INCLUDE IN PROCEDURE A100-LOAD-ALL-TABLES
045200*
045210     MOVE 0 TO BR0022CA-ACTION.
045220     MOVE 999999                     TO BR0022CA-JRNL-NO.
045230     CALL "BR0022" USING
045250                         BR0022CA-AREA.
045260*
045270     MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
045280     MOVE SPACES TO UT8500CA-INPUT-MSG
045290     STRING "BR0000:(A100) LOANS TRACKING ACTION TABLE LOADED"
045300         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
045310     CALL "UT8500" USING
045330                         UT8500CA-AREA.
045340     MOVE 1 TO UT0069CA-CALL-CODE.
045350     CALL "UT0069" USING
045370                         UT0069-LINKAGE.
045380*
045390* INIT. UT0350 (INSTITUTION MARKETING TABLE)
045400*
045410     MOVE 01 TO UT0350-CALL-CODE.
045420     CALL "UT0350" USING
045440                         UT0350-CALL-AREA.
045450*
045460 A199-EXIT.
045470     EXIT.
045480
045490******************************************************************
045500*** L O A D I N G  O F  O N L I N E  D A T E  F I L E ****
045510******************************************************************
045520 A300-LOAD-ONLINE-DATE.
B17951*    READ FS0401 AT END
B17951*         MOVE "Y"               TO WA-ONLINE-EOF
B17951*         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
B17951*         MOVE SPACES TO UT8500CA-INPUT-MSG
B17951*         STRING "BR0000:(A300) DATE FILE LOADED"
B17951*             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
B17951*         CALL "UT8500" USING
B17951*
B17951*                             UT8500CA-AREA
B17951*         GO TO A399-EXIT.
B17951     MOVE "READNEXT"           TO DBIOMOD-FUNCTION.
B17951     PERFORM H600-ACCESS-DTEP THRU H600-EXIT.
B17951     IF DBIOMOD-STAT NOT = "****"
B17951       IF DBIOMOD-STAT NOT = "MRNF"
B17951          MOVE UT8500CA-FUNC-NORMAL-DISPLAY
B17951                        TO UT8500CA-CALL-CODE
B17951          MOVE SPACES TO UT8500CA-INPUT-MSG
B17951          STRING "BR0000:(A300) DATE FILE LOADED STAT: "
B17951                 DBIOMOD-STAT ":KEY:" DATE-KEY
B17951                              OF ONPARAM-REC
B17951                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
B17951          CALL "UT8500" USING
B17951                              UT8500CA-AREA
B17951       ELSE
B17951          MOVE UT8500CA-FUNC-NORMAL-DISPLAY
B17951                        TO UT8500CA-CALL-CODE
B17951          MOVE SPACES TO UT8500CA-INPUT-MSG
B17951          STRING "BR0000:(A300) DATE FILE LOADED "
B17951                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
B17951          CALL "UT8500" USING
B17951                              UT8500CA-AREA
B17951       END-IF
B17951       MOVE  "Y"                TO WA-ONLINE-EOF
B17951       GO TO A399-EXIT
B17951     END-IF.
045630     IF DATE-STAT = 9
045640        GO TO A399-EXIT.
B17951*    MOVE DATE-MMYYYY            TO W100-DATE-MMYYYY(DATE-1).
B17951     MOVE DATE-YYYY              TO W100-DATE-YYYY(DATE-1).
B17951     MOVE DATE-MM                TO W100-DATE-MM(DATE-1).
045660     MOVE DATE-BORR-TAX-SOY      TO W100-BORR-TAX-SOY(DATE-1).
045670     MOVE DATE-BORR-TAX-EOY      TO W100-BORR-TAX-EOY(DATE-1).
045680     MOVE DATE-SOP               TO W100-DATE-SOP(DATE-1).
045690     MOVE DATE-EOY               TO W100-DATE-EOY(DATE-1).
045700     MOVE DATE-BOM               TO W100-DATE-BOM(DATE-1).
045710     MOVE DATE-EOM               TO W100-DATE-EOM(DATE-1).
045720*    MOVE BORM-APPRV-DATE TO W100-BOR-SOP-RUN(DATE-1).
045730     MOVE DATE-NO-DAYS-YEAR      TO WA-WORK-FIELD.
045740     MOVE WA-WORK-FIELD          TO W100-NO-DAYS-YR(DATE-1).
045750     MOVE DATE-NO-DYS-MTH        TO W100-NO-DAYS-MTH(DATE-1).
045760*    IF DATE-1 > 50
045770* INCREASE SIZE OF W100-DATE-FILE FROM 50  TO 120 TIMES
045780* (SIE YOU)
045790     SET DATE-1 UP BY 1.
045800     IF  DATE-1 > 120
045810         MOVE "Y"                TO WA-ONLINE-EOF
045820         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
045830         MOVE SPACES TO UT8500CA-INPUT-MSG
045840         STRING "BR0000:(A300) BRING DOWN THE ONLINE-DATE FILE "
045850               "TABLE IS FULL"
045860             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
045870         CALL "UT8500" USING
045890                             UT8500CA-AREA.
045900 A399-EXIT.
045910     EXIT.
045920/
045930******************************************************************
045940*** S T A R T   O F   D A Y   P R O C E S S I N G ***
045950******************************************************************
045960 A400-STRTR-PARA.
045970     MOVE 0 TO WA-MSG-ERR-FLAG.
045980     MOVE LOW-VALUES TO SUSP-KEY.
045990     MOVE 0 TO UT1996CA-CALL-CODE.
046000     CALL "UT1996" USING UT1996CA-CALL-AREA.
046010     IF  UT1996CA-RETURN-CODE NOT = 0
046020         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
046030         MOVE SPACES TO UT8500CA-INPUT-MSG
046040         STRING "BR0000:(A400) BAD RETURN FROM UT1996, STATUS = "
046050                UT1996CA-RETURN-CODE
046060                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
046070         MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
046080         CALL "UT8500" USING
046090                             UT8500CA-AREA.
046100     MOVE UT1996CA-TIME TO WA-ACCEPT-TIME.
046110     MOVE WA-ACCEPT-HH TO WA-ACCEPT-HH-R.
046120     MOVE WA-ACCEPT-MI TO WA-ACCEPT-MI-R.
046130     MOVE 1 TO UT1999CA-CALL-CODE.
046140     CALL "UT1999" USING
046160                         UT1999CA-CALL-AREA.
046170     MOVE UT1999CA-DD TO WA-ACCEPT-DD-R
046180                         WA-ACCEPT-DD.
046190     MOVE UT1999CA-MM TO WA-ACCEPT-MM-R
046200                         WA-ACCEPT-MM.
046210     MOVE UT1999CA-CC TO WA-ACCEPT-CC-R
046220                         WA-ACCEPT-CC.
046230     MOVE UT1999CA-YY TO WA-ACCEPT-YY-R
046240                         WA-ACCEPT-YY.
046250     MOVE WA-ACCEPT-DATE-R TO UT0030-DATE-DDMMCCYY.
046260     PERFORM X610-UT0030-PARA THRU X619-EXIT.
046270     MOVE UT0030-BINARY-DATE TO WA-DMY-1.
046280     MOVE WA-DMY-1 TO WA-DMY.
046290     MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
046300     MOVE SPACES TO UT8500CA-INPUT-MSG
046310     STRING "BR0000:(A400) LOANS INITIALISED, REP.NO. -"
CHRIS          BR0000-REPLICA-NO                                               
046330         WA-RSRT-THREAD-NO
046340     " ON- " WA-ACCEPT-DATE-R " AT- " WA-ACCEPT-TIME-R
046350         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
046360     CALL "UT8500" USING
046380                         UT8500CA-AREA.
046390     MOVE UT1999CA-MM TO WA-DATE-FILE-MM.
046400     MOVE UT1999CA-CC TO WA-DATE-FILE-CC.
046410     MOVE UT1999CA-YY TO WA-DATE-FILE-YY.
046420     PERFORM W200-FIND-DATE-FILE THRU W299-EXIT.
046430     IF WA-MSG-ERR-FLAG = 1
046440         GO TO A499-EXIT.
046450*    MOVE W100-BOR-SOP-RUN(DATE-1) TO UT0020-BINARY-DATE.
046460*    MOVE 1                        TO UT0020-FUNCTION.
046470*    PERFORM X600-UT0020-PARA THRU X609-EXIT.
046480*    MOVE UT0020-DATE-DDMMCCYY TO WA-BOR-BFY.
046490*                                                                       
046500     MOVE 0 TO UT0310CA-CALL-STATUS.                                    
046510     MOVE 01 TO UT0310CA-CALL-FUNC.                                     
046520*                                                                       
046530     CALL "UT0310" USING UT0310CA-REC.                                  
046540*                                                                       
046550     IF UT0310CA-CALL-STATUS NOT = 0                                    
046560        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE         
046570        MOVE SPACES TO UT8500CA-INPUT-MSG                               
046580        STRING "BR0000:(A400) UT0310 INIT - BAD STATUS "                
046590               UT0310CA-CALL-STATUS                                     
046600        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG                       
046610        CALL "UT8500" USING UT8500CA-AREA.                              
046620*                                                                       
046630 A499-EXIT.
046640     EXIT.
046650/
046660 A500-INIT-DATE-TAB.
046670     MOVE 0 TO W100-DATE-MMYYYY(DATE-1).
046680     SET DATE-1 UP BY 1.
046690 A599-EXIT.
046700     EXIT.
046710/
046720 A600-INIT-CHARGE-SYSTEM.
046730*
046740     MOVE 01          TO CS0000CA-CALL-CODE.
046750     MOVE "B"         TO CS0000CA-SYS.
046760     CALL "CS0000" USING
046780                         STARTAREA
046790                         BORR-PARAMS
046800                         WA-CS0000CA-CALL-AREA
046810                         WA-CS0000RA-RETURN-AREA
046820                         WA-TXN-AMT
046830                         WA-PASSALONG.
046840 A601.
046850     IF CS0000RA-STATUS = 01 OR 11
046860        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
046870        MOVE SPACES TO UT8500CA-INPUT-MSG
046880        STRING "BR0000:(A600) INVALID STATUS RETURN FROM CS0000 "
046890           DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
046900        CALL "UT8500" USING
046920                            UT8500CA-AREA
046930        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
046940        MOVE SPACES TO UT8500CA-INPUT-MSG
046950        STRING "BR0000:(A600) STATUS = " CS0000RA-STATUS
046960            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
046970        CALL "UT8500" USING
046990                            UT8500CA-AREA
047000        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
047010        MOVE SPACES TO UT8500CA-INPUT-MSG
047020        STRING "BR0000:(A600) ERRORS IN CS0000 INIT"
047030            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
047040        MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
047050        MOVE 30  TO UT8500CA-RESPONSE-LENGTH
047060        CALL "UT8500" USING
047080                            UT8500CA-AREA.
047090*
047100 A699-EXIT.
047110     EXIT.
047130 A700-LOAD-TEXT-DATA.
047140*
047150*  INITIALIZE UT9000 - LOAD LNGM TABLE IN UT9000 WORK AREA
047160     MOVE 0 TO UT9000-CALL-CODE.
047170     PERFORM U9100-RETRIEVE-TEXT.
047180*
047190     INITIALIZE     TXTM-DATA.
047200     SET TXT-1 TO 1.
047210     SET TXT-1 DOWN BY 1.
047220     MOVE 75     TO DBIO-CALL-FUNC.
047230     MOVE "LNGM" TO DBIO-CALL-N-SYS.
047240     MOVE "BEGN" TO DBIO-CALL-SAVE-REFER.
047250     MOVE SPACES TO DBIO-CALL-STATUS.
047260     PERFORM A800-LOAD-BY-LNGM THRU A899-EXIT
047270         UNTIL
047280             DBIO-CALL-SAVE-REFER = "END.".
047290     SET TXT-1, TXT-2 TO 1.
047300*
047310 A799-EXIT.
047320     EXIT.
047330*
047340 A800-LOAD-BY-LNGM.
047350     CALL "DBIO" USING
047370                         DBIO-CALL-PARAM
047380                         DBIO-CALL-SYS-AREA
047390                         DBIO-CALL-KEY-AREA
047400                         DBIO-CALL-STATUS
047410                         LNGM-AREA.
047420     IF  DBIO-CALL-STATUS NOT = "****"
047430         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
047440         MOVE SPACES TO UT8500CA-INPUT-MSG
047450         STRING "BR0000(A800): ERROR READING LNGM TABLE"
047460                 "/CALL-STATUS=" DBIO-CALL-STATUS
047470             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
047480         CALL "UT8500" USING
047500                             UT8500CA-AREA
047510         MOVE "END." TO DBIO-CALL-SAVE-REFER.
047520     IF  DBIO-CALL-SAVE-REFER NOT = "END."
047530     AND LNGM-STAT NOT = 9
047540         MOVE LNGM-INST-NO       TO UT9000-INST-NO
047550*        MOVE "BR0000"           TO UT9000-CALLING-ID
047560         MOVE LNGM-LANGUAGE-CODE TO UT9000-LANGUAGE-CODE
047570*        MOVE 1                  TO UT9000-REPORT-NO
047580*        MOVE 0                  TO UT9000-SEQUENCE-NO
047590         MOVE " "                TO UT9000-CALL-STATUS
047600         PERFORM U9000-RETRIEVE-TXTM-RECORDS THRU U9009-EXIT
047610                 VARYING TXT-3 FROM 1 BY 1
047620                 UNTIL   UT9000-CALL-STATUS = "E".
047630 A899-EXIT.
047640     EXIT.
047650*
047660*
047670******************************************************************
047680*** R E C E V I N G   I N P U T   M E S S A G E S   H E R E ***
047690******************************************************************
047700 B000-CNTL-PARA.
APLEXD     SET WS-NO-REFRESH TO TRUE.
047740     MOVE WA-INPUT-MSG           TO WA-INPUT-MESSAGE-AREA.
047750     MOVE ZERO                   TO WA-WORK-AREA-BACKDATED.
047760     INITIALIZE BR0023CA-AREA
047770                BR0024CA-AREA.
047780     MOVE 0                      TO WA-BIT-1-FLAG
047790                                    WA-NO-INT-DAYS-YR
047800                                    WA-ACCT-BAL-BEF-TXN
047810                                    WA-ACT-BAL-BEF-TXN
047820                                    UT0460CA-ERROR-STATUS
047830                                    WA-MSG-ERR-FLAG
047840                                    WA-DEFER-DAYS
047850                                    ST-CHQ-CLEAR-DAYS
047860                                    WA-SAVE-ARREARS
047870                                    WA-SAVE-ARR-INT-INCR
SC5647                                    WA-TOT-TXN-AMT
047880***                                 WA-UT0460-MSG-NO-N
047890                                    WA-OUTPUT-ERR-MSG-NO
047900                                    WA-POST-2ND-PASS-IND
047910                                    WA-DUP-COUNT
047920                                    WA-SAVE-COMM-FLAG
047930                                    WA-SAVE-CHANGE-FLAG
047940                                    WS-UT0500-SAVE-INST-NO
047950                                    WS-UT0500-SAVE-CUSM-NO
047960                                    WA-CHK-CURR-AMT                     
047970                                    WA-CHK-BASE-AMT
SC9610                                    ST-LOAN-BACKDATED-CORR                     
047980                                    CH0000RA-UPD-CHQ-DUP-NO.
047990     MOVE 0                      TO WA-ORIG-TXN-EVT
048000                                    WA-ORIG-JRNL-NO
048010                                    WA-ORIG-POST-DATE
S15727                                    WS-BANK-RATE
S15727                                    WS-CIEA-TYPE
SC9050                                    WA-VIRTUAL-FROM-ACCT
048020                                    WA-ORIG-POST-TIME.
048030     MOVE ZEROES                  TO WA-BANK-NUMBER.
048040     MOVE ZEROES                  TO WA-REGION-ID.
048050     MOVE SPACE                  TO WA-ORIG-POST-SEQ
048060                                    WA-CHK-ACCT-CD                      
048070                                    WA-CHK-CURR-CD                      
SC6401                                    WA-SAVE-W41-I-SYSTEM             
048080                                    WA-MULT-TXN-SEQ
SC8404                                    ST-SYSTEM
SC8878                                    WA-98904-FLAG
S12384                                    WA-REPAY-PRN-RECALC
SC7548                                    WA-RESTORE-REPAY-IND  
S19100                                    WA-STRF-PROMO-NO
048090                                    PBOOKCA-PRINT-TYPE.
S18577     MOVE SPACE                  TO WA-YB-FLAG.
S18566*S18533     MOVE ZEROS                  TO WS-TEMP-VIRTUAL-TYPE.
SC8921     MOVE SPACES                 TO WA-STORE-TFR-SYST.
SC8404     MOVE "LON"                  TO ST-SYSTEM.
048100     MOVE LOW-VALUES             TO SUSP-KEY.
048110     MOVE "0"                    TO STRT-AREA-XCURR-IND.
048120*
048130     MOVE "1"                    TO GL-DONT-WRITE-GLDM-IND.
048140     MOVE "NONE"                 TO WA-UT0460-MSG-NO-A.
048150     MOVE STRT-AREA-TRN-NO       TO WA-DUMMY-TRN-NO
SC5266                                    WA-ORIG-EFT-TRN-NO
SC9828                                    WA-PASS-TRN-NO
048160                                    WA-REPAY-TRCODE
048170                                    WA-DUMMY-GL-TRN-NO.
048180     MOVE 0                      TO WA-STORE-ACT-CORR-AMT.
048190     MOVE SPACE                  TO WA-LOAN-REFRESH-FLAG.
048200     MOVE SPACE                  TO WA-CALL-UT0060-FLAG
048210                                    WA-INPUT-PROMO
048220                                    CHECK-RESPONSE-SUSP-FLAG.
048230     MOVE "N"                    TO WA-ACCESS-EPIP
048240                                    WA-GATEWAY-TRANCODE.
SC3158     MOVE 0                      TO WA-PREV-BOIS-GRACE-PERIOD.
SC8046     MOVE 0                      TO WA-SV-REM-REPAYS.
SC9037     MOVE 0                      TO WA-INT-DUE-14.
SC9927     MOVE 0                      TO WA-DMY-1.
SC2420     INITIALIZE                     WA-UT28-PARAM.
SC8088     MOVE "N"                    TO WS-TRANSFER-IND.
S11877     MOVE "N"                    TO SW-T4-FLAG.
S12417     MOVE "N"                    TO BR0001CA-BILLING-GLIF.
S15871     MOVE "N"                    TO BR0001CA-ADJUST-GLIF.
S15492     MOVE 0                      TO BR0001CA-INTEREST-DUE.
S15492     MOVE 0                      TO BR0001CA-PRINCIPAL-DUE.
S15492     MOVE "N"                    TO BR0001CA-OVER-DUE-FLAG.
SC8088     MOVE SPACE                  TO WS-BORM-GL-CLASS-CODE.
S12770     MOVE ZEROS                  TO WA-VIR-AC-FOR-REORG-AC.
048250     MOVE STRT-AREA-TRN-NO       TO WA-UT0060-SAVE-TRAN-NO.
048260     IF WA-INPUT-ACCT-NO IS NUMERIC
048270         MOVE WA-INPUT-ACCT-NO       TO WA-UT0060-SAVE-ACC-NO
048280     ELSE
048290         MOVE ZEROES TO WA-UT0060-SAVE-ACC-NO.
048300     MOVE STRT-AREA-OTHER-OVERRIDE TO
048310                                    WA-SUPERVISOR-OVERRIDE-IN-USE.
048320     IF WA-GENR-TX-CNT > 0
048330        PERFORM VARYING WA-COUNT FROM 1 BY 1
048340        UNTIL WA-COUNT > WA-GENR-TX-CNT
048350           MOVE  0      TO WA-CORR-IND(WA-COUNT)
048360           MOVE  0      TO WA-GENR-TX-TYPE(WA-COUNT)
048370           MOVE  0      TO WA-SRC-ACCT(WA-COUNT)
048380           MOVE  0      TO WA-TRF-AMT(WA-COUNT)
048390           MOVE  0      TO WA-FEE-BEAR-ACCT(WA-COUNT)
048400           MOVE  SPACES TO WA-SRC-ACCT-CCY(WA-COUNT)
048410           MOVE  SPACES TO WA-FEE-BEAR-ACCT-CCY(WA-COUNT)
048420           MOVE  SPACES TO WA-FEE-SHRT-DESC(WA-COUNT)
048430        END-PERFORM.
048440     MOVE 0             TO WA-FEE-TRF-TXN.
048450     MOVE 0             TO WA-SKIP-FEE-CALC.
048460     MOVE 0             TO WA-GENR-TX-CNT.
048470**   MOVE "N"           TO EI0090-REFRESH-FLAG.
TB0226     MOVE "N"           TO MI0090-REFRESH-FLAG.
048480     MOVE "N"           TO WS-RESPONSE-SENT-FLAG.
TB0226* REPLACED
048490*    MOVE 0 TO EI0085CA-CALL-CODE
048500*              EI0085CA-FUNC
048510*              EI0085CA-REFRESH-IND
048520*              EI0085CA-BYPASS-ATM-CHK.
TB0226     MOVE 0 TO MI0095CA-CALL-CODE
TB0226               MI0095CA-FUNC
TB0226               MI0095CA-REFRESH-IND
TB0226               MI0095CA-BYPASS-ATM-CHK.
048530     IF WA-UT0220-SAVE-SOC-NO NOT = STRT-AREA-SOC-NO
048540        MOVE 02                      TO UT0220CA-CALL-CODE
048550        MOVE STRT-AREA-SOC-NO        TO UT0220CA-CALL-SOC-NO
048560        MOVE 1                       TO UT0220CA-CALL-GRP-NO
048570        CALL "UT0220" USING
048590                            WA-UT0220-CALL-AREA
048600        IF UT0220CA-CALL-STATUS NOT = 0
048610           MOVE 1                    TO WA-MSG-ERR-FLAG
048620           MOVE 273                  TO WA-OUTPUT-ERR-MSG-NO
048630           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
048640           GO TO B099-EXIT
048650        ELSE
048660           MOVE STRT-AREA-SOC-NO     TO WA-UT0220-SAVE-SOC-NO
048670           MOVE 1                    TO WA-UT0220-SAVE-GRP-NO.
048680     IF NOT SOC-NO-LON-REFRESH
048690*       PERFORM M1300-CALL-EI0085 THRU M1399-EXIT.
TB0226        PERFORM M1300-CALL-MI0095 THRU M1399-EXIT.
048700*
048710*** SYSTEM  SHUT  DOWN ***
048720*
048730     IF  STRT-AREA-TRN-NO = 111111
048740         PERFORM E100-FMT-SEND-PARA
048750            THRU E199-EXIT
048760         GO TO B099-EXIT.
048770*
048780*
048790     MOVE STRT-AREA-PROCESS-BITS TO FIELD-B.
048800     CALL "UT0022" USING PUAREA.
048810     MOVE FIELD-A TO WA-EDIT-MASK.
048820     MOVE 0                      TO ST-STATUS-LEVEL-1
048830                                    ST-STATUS-LEVEL-2
048840                                    ST-STATUS-LEVEL-3
048850                                    ST-STATUS-LEVEL-4
048860                                    WA-LIM-TOL-FLAG.
048870     MOVE SPACES                 TO WA-OVER-RIDE.
048880     MOVE W300-ERROR-AREA TO UT0060-TERMINAL-AREA.
048890     IF  WA-INPUT-PARAM-TABLE(1) = 1
048900         MOVE 1 TO WA-BIT-1-FLAG
048910         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
048920         GO TO B099-EXIT.
S19100
S19100     IF WA-ATM-STRF-TXN
S19100        MOVE WA-ATM-PROMO-NO     TO WA-STRF-PROMO-NO
S19100     END-IF.
S19100
S19100     IF  WA-ATM-STRF-TXN AND WSP-STRF-PROMO
S19100     AND WA-INPUT-AMT <= 500
S19100        PERFORM C120-CHECK-STRF-DATA THRU C129-EXIT
S19100        IF WA-MSG-ERR-FLAG = 1
S19100           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S19100           GO TO B099-EXIT
S19100        END-IF
S19100        IF WA-STRF-FEE-FLG = "1"
S19100           IF WA-ATM-PROMO-NO = "FP"
S19100              MOVE "FS"       TO WA-ATM-PROMO-NO
S19100           ELSE
S19100              MOVE SPACES     TO WA-ATM-PROMO-NO
S19100           END-IF
S19100        END-IF
S19100     END-IF.
S19100
S15361* authorize SVIP
S15361     MOVE 0           TO  UT0450-OVRD-FLAG.
S15361     IF STRT-BANCSLINK  AND
S15361        STRT-AREA-TRN-NO = (10400 OR 10430 OR 10440 OR 10450 OR
S15361        10460 OR 10461 OR 10705 OR 10707 OR 10722 OR 10723 OR
S15361        10724 OR 10729 OR 12695 OR 17050 OR 17079 OR 17086 OR
S19524        17211 OR
S19705        17215 OR
S20318        17216 OR
S15361        17201)
S15361        PERFORM H500-SVIP-RTN THRU H500-EXIT
S15361        IF WA-MSG-ERR-FLAG = 1
S15361           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S15361           GO TO B099-EXIT
S15361        END-IF
S15361     END-IF.
S10527***
S10527*** check eftm for possible duplicate transaction. reject txn if found
S10527***
S10527     IF  (STRT-INT-VALID-FLAG4            AND
S10527          (WA-INPUT-PARAM-TABLE(23) = 0   OR
S10527           WA-INPUT-PARAM-TABLE(30) = 1))
S10527       IF STRT-AREA-TRN-NO NOT = 12120 AND 12130 AND
S10527                                 12121 AND 12131
S10527          AND NOT STRT-BATCH-TRICKLE-TXN
S10527          AND NOT STRT-REPOST-TXN
S10527              MOVE STRT-AREA-SOC-NO        TO EFTMCA-INST-NO
S10527              MOVE ST-SEQUENCE-NO          TO EFTMCA-SEQUENCE-NO
S10527              MOVE STRT-AREA-BATCH-TANDEM  TO EFTMCA-CHANNEL-TYPE
S10527              SET  UTEFTMCA-ENQUIRE        TO TRUE
S10527
S10527              CALL "UTEFTM"  USING
S10527                             UTEFTM-CALL-AREA
S10527                             WA-PASSALONG
S10527               END-CALL
S10527*** error flag = 0, meaning successful read, reject txn
S10527               IF WA-MSG-ERR-FLAG = 0
S10527                  MOVE 1    TO      WA-MSG-ERR-FLAG
S10527                  MOVE 459  TO      WA-OUTPUT-ERR-MSG-NO
S10527                  STRING  "BR0000:(B000) DUPLICATE TRANSACTION: "
S10527                           "ATM SEQ NO ="
S10527                           ST-SEQUENCE-NO
S10527                           " JOURNAL NUMBER "
S10527                           DELIMITED BY SIZE
S10527                           STRT-AREA-JRNL-NO
S10527                           " BATCH TANDEM ="
S10527                           STRT-AREA-BATCH-TANDEM
S10527                  DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S10527                  CALL "UT8500" USING
S10527                                UT8500CA-AREA
S10527                  PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S10527                  GO TO B099-EXIT
S10527               ELSE
S10527                  MOVE 0 TO WA-MSG-ERR-FLAG
S10527                            WA-OUTPUT-ERR-MSG-NO
S10527                            WA-ERR-MSG-NO
S10527              END-IF
S10527       END-IF
S10527     END-IF.
S10527*
S11911     IF STRT-BANCSLINK AND
S11911        STRT-AREA-TRN-NO = 11055 OR 11057
S11911        INITIALIZE             WA-SAVE-ADV-INPUT-MSG
S11911        MOVE WA-INPUT-MSG  TO  WA-SAVE-ADV-INPUT-MSG
S11911     END-IF.
SC1171     IF STRT-AREA-BATCH-TANDEM = "B" AND
SC1171*SC9330 STRT-AREA-TRN-NO = 16044
S17064*SC9330(STRT-AREA-TRN-NO = 16044 OR 16045 OR 13045)
S17263*S17064       (STRT-AREA-TRN-NO = 11044 OR 16044 OR 16045 OR 13045)
S17263       (STRT-AREA-TRN-NO = 11044 OR 16044 OR 16045 OR 13045
S17263                        OR 15045)
SC1171        PERFORM B620-FETCH-MASTER THRU B629-EXIT
SC1171        IF WA-MSG-ERR-FLAG = 1
SC1171*SC8877    MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
SC1171           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC1171           GO TO B099-EXIT
SC1171        END-IF
S20630*
S20630        MOVE BOIS-PROJ-CODE    TO  WS-PROJ-CODE
S20630        IF  WS-SOLDIER-LOAN
S20630            MOVE 1             TO WA-MSG-ERR-FLAG
S20630            MOVE 4995          TO WA-OUTPUT-ERR-MSG-NO
S20630            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S20630            GO TO B099-EXIT
S20630        END-IF
S20630*
S20751*S20486 INITIALIZE UTMLWM-CALL-PARAM
S20751*S20486 MOVE "LON"             TO UTMLWM-FUN
S20751*S20486 MOVE BORM-SOC-NO       TO UTMLWM-SOC-NO
S20751*S20486 MOVE BORM-MEMB-CUST-AC TO UTMLWM-MEMB-CUST-AC
S20751*S20486 CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20751*S20486 IF UTMLWM-CALL-STATUS = "00"
S20751*S20486    IF UTMLWM-MLWFLAG = "Y"
S20751*S20486       MOVE 1249        TO WA-OUTPUT-ERR-MSG-NO
S20751*S20486       MOVE 1           TO WA-MSG-ERR-FLAG
S20751*S20486       PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S20751*S20486       GO               TO B099-EXIT
S20751*S20486    END-IF
S20751*S20486 END-IF
SC1171        MOVE BORM-SOC-NO     TO UT2000CA-CALL-SOC-NO
SC1171        MOVE BORM-ACT-TYPE   TO UT2000CA-CALL-ACCT-TYPE
SC1171        MOVE BORM-CAT        TO UT2000CA-CALL-INT-CAT
SC1171        MOVE 02              TO UT2000CA-CALL-CODE
SC1171        PERFORM D100-CALL-UT2000 THRU D199-EXIT
SC1171        IF WA-MSG-ERR-FLAG = 1
SC1171           MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
SC1171           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC1171           GO TO B099-EXIT
SC1171        END-IF
S17263*SC9330        IF STRT-AREA-TRN-NO = 13045
S17263        IF STRT-AREA-TRN-NO = 13045 OR 15045
SC9330           IF BORP-COMML
S15642           AND BORP-AUTO-CLSR-IND <> 'Y'
SC9330              MOVE 1    TO WA-MSG-ERR-FLAG
SC9330*SC9881       MOVE 4377 TO WA-OUTPUT-ERR-MSG-NO
SC9881              MOVE 4702 TO WA-OUTPUT-ERR-MSG-NO
SC9330              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC9330              GO TO B099-EXIT
SC9330           END-IF
S10042           GO TO B000-CONT
SC9330        ELSE
SC9330           IF STRT-AREA-TRN-NO = 16045
SC9330              AND BORM-STAT = 50 AND BORM-REM-REPAYS = 0
SC9330*S10575       AND BOIS-ARREARS-CTR > 1
S10575              AND BOIS-ARREARS-CTR <> 1
SC9330              MOVE 4773 TO WA-OUTPUT-ERR-MSG-NO
SC9330              MOVE 1 TO WA-MSG-ERR-FLAG
SC9330              GO TO B099-EXIT
SC9330           ELSE
S10042              IF STRT-AREA-TRN-NO = 16045
SC9330              GO TO B000-CONT
S10042              END-IF
SC9330           END-IF
SC9330        END-IF
SC1171        IF BORP-LOAN-CLASS = 2
S16757        AND BORM-REPAY-METHOD = " "
SC1171           MOVE WA-OS-REPAY-DEP-ACCT-NO TO INVM-MEMB-CUST-AC
SC1171           PERFORM B1000-READ-INVM THRU B1999-EXIT
SC1171           IF DBIO-CALL-STATUS = "****"
SC8692              IF INVM-OMNIBUS-FLAG <> "M" AND
SC8692                 BOIS-OD-ACCT-NUMBER = 0
SC8692                 MOVE 1   TO WA-MSG-ERR-FLAG
SC8692                 MOVE 575 TO WA-OUTPUT-ERR-MSG-NO
SC8692                 PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC8692                 GO TO B099-EXIT
SC8692              END-IF
SC1171              COMPUTE WA-REM-BAL = INVM-CURR-BAL -
SC1171                                   INVM-RESERVED-AMOUNT
SC1171              IF (WA-REM-BAL > 0) AND (BORM-LOAN-BAL > 0)
SC1171                  IF BORM-LOAN-BAL > WA-REM-BAL
SC1171                     MOVE WA-REM-BAL TO WA-OS-REPAY-AMOUNT
SC1171                  ELSE
SC1171                     MOVE BORM-LOAN-BAL TO WA-OS-REPAY-AMOUNT
SC1171                  END-IF
SC1171                  MOVE "Y" TO WA-OS-REPAY-FLAG
SC2857                  MOVE 0   TO WA-REPAY-PRIN-RECALC
SC9324              ELSE
SC9324                  MOVE 1    TO WA-MSG-ERR-FLAG
SC9324                  MOVE 4110 TO WA-OUTPUT-ERR-MSG-NO
SC9324                  PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC9324                  GO TO B099-EXIT
SC1171              END-IF
SC1171           ELSE
SC1171              MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
SC1171              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC1171              GO TO B099-EXIT
SC1171           END-IF
SC1171        END-IF
S16757        IF BORM-REPAY-METHOD = "1" OR "2"
S16757           IF BOIS-ARREARS-CTR = 0
S17280*S16757              IF BORP-LOAN-CLASS = 2
S16757                 MOVE WA-OS-REPAY-DEP-ACCT-NO
S16757                   TO INVM-MEMB-CUST-AC
S16757                 PERFORM B1000-READ-INVM THRU B1999-EXIT
S16757                 IF DBIO-CALL-STATUS = "****"
S17280*S16757                    IF INVM-OMNIBUS-FLAG <> "M" AND
S17280*S16757                       BOIS-OD-ACCT-NUMBER = 0
S17280*S16757                       MOVE 1   TO WA-MSG-ERR-FLAG
S17280*S16757                       MOVE 575 TO WA-OUTPUT-ERR-MSG-NO
S17280*S16757                       PERFORM E000-COMPLETION-PARA
S17280*S16757                          THRU E099-EXIT
S17280*S16757                       GO TO B099-EXIT
S17280*S16757                    END-IF
S16757                    IF WA-OS-REPAY-AMOUNT > INVM-CURR-BAL
S16757                       MOVE 1   TO WA-MSG-ERR-FLAG
S16757                       MOVE 117 TO WA-OUTPUT-ERR-MSG-NO
S16757                       PERFORM E000-COMPLETION-PARA
S16757                          THRU E099-EXIT
S16757                       GO TO B099-EXIT
S16757                    END-IF
S16757                 END-IF
S17280*S16757              END-IF
S16757              MOVE "Y" TO WA-OS-REPAY-FLAG
S16757              MOVE 0   TO WA-REPAY-PRIN-RECALC
S16757           ELSE
S16757              MOVE 1    TO WA-MSG-ERR-FLAG
S16757              MOVE 1502 TO WA-OUTPUT-ERR-MSG-NO
S16757              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S16757              GO TO B099-EXIT
S16757           END-IF
S16757        END-IF
S17250        IF STRT-AREA-TRN-NO = 11044
S17250        AND BOIS-MISC-INC-DUE = 0
S17250            MOVE 1   TO WA-MSG-ERR-FLAG
S17250            MOVE 417 TO WA-OUTPUT-ERR-MSG-NO
S17250            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S17250            GO TO B099-EXIT
S17250        END-IF
S17064        IF STRT-AREA-TRN-NO = 11044
S17064        AND BOIS-MISC-INC-DUE > 0
S17064           MOVE WA-OS-REPAY-DEP-ACCT-NO TO INVM-MEMB-CUST-AC
S17064           PERFORM B1000-READ-INVM THRU B1999-EXIT
S17064           IF DBIO-CALL-STATUS = "****"
S17064              COMPUTE WA-REM-BAL = INVM-CURR-BAL -
S17454                                   INVM-HOLD-VAL -
S17454                                   INVM-UNCL-CHQ-VAL
S17454*S17064                            INVM-RESERVED-AMOUNT
S17064              IF BOIS-MISC-INC-DUE > BORM-LOAN-BAL
S17064                  MOVE 1    TO WA-MSG-ERR-FLAG
S17064                  MOVE 4997 TO WA-OUTPUT-ERR-MSG-NO
S17064                  PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S17064                  GO TO B099-EXIT
S17064              END-IF
S17064              IF  WA-REM-BAL > 0
S17064                  IF BOIS-MISC-INC-DUE > WA-REM-BAL
S17064                     MOVE WA-REM-BAL TO WA-OS-REPAY-AMOUNT
S17064                  ELSE
S17064                     MOVE BOIS-MISC-INC-DUE TO WA-OS-REPAY-AMOUNT
S17064                  END-IF
S17064                  MOVE "Y" TO WA-OS-REPAY-FLAG
S17064                  MOVE 0   TO WA-REPAY-PRIN-RECALC
S17064              ELSE
S17064                  MOVE 1   TO WA-MSG-ERR-FLAG
S17064                  MOVE 266 TO WA-OUTPUT-ERR-MSG-NO
S17064                  PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S17064                  GO TO B099-EXIT
S17064              END-IF
S17064           ELSE
S17064              MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
S17064              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S17064              GO TO B099-EXIT
S17064           END-IF
S17064        END-IF
SC1171     END-IF.
S20486     IF STRT-AREA-TRN-NO = (13042 OR 63042)
S20486     AND (STRT-AREA-BATCH-TANDEM = "B" )
S20486         PERFORM B620-FETCH-MASTER THRU B629-EXIT
S20486         IF WA-MSG-ERR-FLAG = 1
S20486            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S20486            GO TO B099-EXIT
S20486         END-IF
S20486         IF  VALID-HOUSE-LOAN-M
S20486         AND BOIS-LEGAL-FEE2-DUE > 0
S20486         AND BOIS-LAST-PPAY-DATE > 0
S20486         AND BOIS-SORD-AUTO-DBT-ACCT-NO > 0
S20486             INITIALIZE UTMLWM-CALL-PARAM
S20486             MOVE "LON"             TO UTMLWM-FUN
S20486             MOVE BORM-SOC-NO       TO UTMLWM-SOC-NO
S20486             MOVE BORM-MEMB-CUST-AC TO UTMLWM-MEMB-CUST-AC
S20486             CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20486             IF UTMLWM-CALL-STATUS = "00"
S20486                IF UTMLWM-MLWFLAG = "Y"
S20486                   MOVE 1249        TO WA-OUTPUT-ERR-MSG-NO
S20486                   MOVE 1           TO WA-MSG-ERR-FLAG
S20486                   PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S20486                   GO               TO B099-EXIT
S20486                END-IF
S20486             END-IF
S20486         END-IF
S20486     END-IF.
SC9330 B000-CONT.
SC4522**************************************************************
SC4522*-- VALIDATE FEDI TRANSACTIONS INCLUDE CIF FIELD AND BP ACCOUNT
SC4522**************************************************************
S11214     INITIALIZE WA-VIRTUAL-TO-ACCT.
SC4522     MOVE 0   TO WA-FEDI-BP-POST-FLAG.
SC4522     MOVE "N" TO WA-FEDI-BP-FLAG.
SC4522     MOVE "N" TO WA-FEDI-FEE-FLAG.
SC4522     IF WA-FEDI-TRANSFER-TXN
SC4522         PERFORM J230-VALIDATE-FEDI-CIF THRU J239-EXIT
SC4522         IF WA-MSG-ERR-FLAG = 1
SC4522            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC4522            GO TO B099-EXIT
SC4522         END-IF
SC4522         IF WA-FEDI-BP-TXN AND ENT-CODE 
SC4522             MOVE "Y" TO WA-FEDI-BP-FLAG
SC8350             MOVE W800-FROM-ACCT TO WA-SAVE-FEDI-FROM-AC
SC8350             MOVE W800-TO-ACCT   TO WA-SAVE-FEDI-TO-AC
SC4522             MOVE JS-COMPANY-CODE TO UTSHRECA-STOCK-HSE-NO
SC4522                                     WA-FEDI-COM-CODE
SC4522             MOVE JS-PAY-TYPE     TO WA-FEDI-PAY-TYPE     
SC4522                                     UTSHRECA-TRANSFER-TYPE
SC4522             PERFORM J220-VAL-FEDI-BP-ACCT THRU J229-EXIT
SC4522             IF WA-MSG-ERR-FLAG = 1
SC4522                PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC4522                GO TO B099-EXIT
SC4522             END-IF
SC4522             IF UTSHRECA-COM-AC-SYS = "BRA" OR "GEN"
SC4522                MOVE 1            TO WA-FEDI-BP-POST-FLAG 
SC4522                MOVE "Y"          TO BP-GL-TXN-FLAG       
SC4522                MOVE "GEN"        TO BP-GL-SYSTEM         
SC4522                MOVE W800-TO-ACCT TO BP-GL-ORIG-ACCT  
SC4522             END-IF
S11214             MOVE W800-TO-ACCT         TO WA-VIRTUAL-TO-ACCT
SC4522             MOVE UTSHRECA-COM-ACCT-NO TO W800-TO-ACCT
SC4522                                          WA-FEDI-ACCT
SC5265* USE NEW VALUE "B" FOR TRANSFER TO BILL PAYMENT ACCOUNT FROM IB/IVR
SC5265* WHICH WILL BE PASSED TO UT0011, AND BP ACCOUNT NOT REQUIRED TO CHECK
SC5265* NOMINATED ACCOUNT IN CLNA
SC5265             IF WA-INPUT-PARAM-TABLE (5) = 1
SC5265                MOVE "B" TO STRT-AREA-VIRTUAL-ACCT-FLAG
SC5265             END-IF
SC4522         END-IF
SC4522         PERFORM J240-SET-FEDI-FEE-FLAG THRU J249-EXIT
SC4522         IF WA-MSG-ERR-FLAG = 1
SC4522            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC4522            GO TO B099-EXIT
SC4522         END-IF
SC4522    END-IF.
SC5206**************************************************************
SC5206**-- VIRTUAL ACCOUNT CHECKING
SC5206**************************************************************
SC5206     INITIALIZE UTVTACCA-AREA
S11214*SC5206         WA-VIRTUAL-TO-ACCT
SC5206                WA-VIRTUAL-TRANS-DESC.
S11483     MOVE ZEROS TO    SAVE-W800-TO-ACNO.
SC5206     IF STRT-AREA-VIRTUAL-ACCT-FLAG = "Y"
SC5206        MOVE 1            TO UTVTACCA-CALL-CODE
SC5206        MOVE WA-INPUT-AMT TO UTVTACCA-DEPOSIT-AMT
SC5206        MOVE W800-TO-ACCT TO UTVTACCA-VIRTUAL-ACCT-NO
SC5206        CALL "UTVTAC"  USING STARTAREA
SC5206                             UTVTACCA-CALL-PARAM
SC5206        IF UTVTACCA-RET-STATUS  = 0
SC6854****************************************************************
SC7181*** IF UTVTACCA-ATM-POSTING OR UTVTACCA-POST-METHOD = C
SC7181*** Change Trancode to 24046, Not Locking GLDM but write JRNL&VTPV
SC6854*** PLEASE REFER TO THE PARAM SETTING OF 24030,24046,24046
SC6854****************************************************************
SC6854***        IF UTVTACCA-ACCT-SYSTEM = 'CGL'
SC6854*          MOVE UTVTACCA-VIRTUAL-ACCT-NO TO WA-VIRT-ATM-ACCT
SC6854*          IF (WA-VIRT-ATM-ENT-CODE >= 901 AND
SC6854*             WA-VIRT-ATM-ENT-CODE <= 905) AND
SC6854*             STRT-FEP-ATM-TXN
SC7181           IF UTVTACCA-ATM-POSTING
SC7181              AND WA-INPUT-PARAM-TABLE(23) = 0
SC7181              AND WA-INPUT-PARAM-TABLE(26) = 0
SC7181              IF NOT STRT-BANCSLINK
SC6854                 MOVE UTVTACCA-NOMINATED-ACCT-NO
SC6854                      TO WA-VIRTUAL-FROM-ACCT
SC6854* used WA-VIRTUAL-FROM-ACCT instead of the TO-ACCT
SC6854                 MOVE "CGL" TO WA-STORE-TFR-SYST
SC8535* Not in use, UT0820 moves UTVTACCA-TXN-BRANCH to JNRST-HOME-BRNCH
SC7181*SC8535          IF WA-INPUT-PARAM-TABLE(29) = 1
SC7181*SC8535             MOVE UTVTACCA-TRANSFER-BRANCH TO
SC7181*SC8535               WA-VIRTUAL-TO-BRANCH
SC7181*SC8535          END-IF
SC7181              ELSE
SC7181                MOVE 1    TO WA-MSG-ERR-FLAG
SC7181                MOVE 4774 TO WA-OUTPUT-ERR-MSG-NO
SC7181                GO TO B099-EXIT
SC6854           ELSE
SC8085             IF UTVTACCA-POST-METHOD = "B"
SC8085              MOVE UTVTACCA-NOMINATED-ACCT-NO
SC8085                      TO WA-VIRTUAL-FROM-ACCT
SC8085             ELSE
SC6854              MOVE 0 TO WA-VIRTUAL-FROM-ACCT
SC8085             END-IF
SC6854           END-IF
SC5206           MOVE UTVTACCA-TRANS-DESC  TO WA-VIRTUAL-TRANS-DESC
SC5206           IF UTVTACCA-ACCESS-WITH
SC5206              MOVE 1               TO WA-MSG-ERR-FLAG
SC5206              MOVE 4981            TO WA-OUTPUT-ERR-MSG-NO
SC5206              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC5206              GO TO B099-EXIT
SC5206           END-IF
S11483           MOVE W800-TO-ACCT               TO SAVE-W800-TO-ACNO
SC5206           MOVE W800-TO-ACCT               TO WA-VIRTUAL-TO-ACCT
SC5206           MOVE UTVTACCA-NOMINATED-ACCT-NO TO W800-TO-ACCT
SC5340           IF STRT-BANCSLINK
SC5340               MOVE SOC-BANK-NO    TO UTVTACCA-TRANSFER-BANK
SC5340               MOVE W800-FROM-ACCT TO UTVTACCA-TRANS-OUT-ACCT
SC5340           END-IF
SC5130           MOVE UTVTACCA-CALL-PARAM        TO WA-SAVE-UTVTAC-AREA
SC5206        ELSE
SC5206           MOVE 1                     TO WA-MSG-ERR-FLAG
SC5206           MOVE UTVTACCA-ERROR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
SC5206           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC5206           GO TO B099-EXIT
SC5206        END-IF
SC5206     END-IF.
SC5206*----------------------------------
SC5206* END OF VIRTUAL ACCOUNT VALIDATION
SC5206*----------------------------------
048930*
TB0277* FOR ATM PROCESSING
TB0277        IF WA-INPUT-PARAM-TABLE (30) = 1
TB0280           OR STRT-AREA-TRN-NO = 11030 OR 11130 OR 11050 OR 11150
ST0058           IF ((WA-INPUT-PARAM-TABLE (29) = 1
SC4584           OR WA-INPUT-PARAM-TABLE (20) = 1)
ST0058              AND (SOC-SETTLE-BRANCH = 651
ST0058              AND WA-ATM-PROMO-NO = 'F4'))
SC8776          OR ((UTVTACCA-ATM-POSTING OR VTAM-BATCH-POSTING)
SC8776               AND WA-INPUT-PARAM-TABLE (29)  = 1)
ST0058              INITIALIZE WA-UT1000CA-REC
ST0058              SET UT1000-RET-BRCHS TO TRUE
ST0058              MOVE  STRT-AREA-SOC-NO  TO  UT1000CA-CALL-SOC-NO
ST0058              MOVE  W800-FROM-ACCT    TO  UT1000CA-CALL-FR-ACCT
ST0058              MOVE  W800-TO-ACCT      TO  UT1000CA-CALL-TO-ACCT
ST0058              CALL "UT1000" USING
ST0058                                  WA-UT1000CA-REC
ST0058              IF UT1000CA-CALL-OK
SC8776                 IF UTVTACCA-ATM-POSTING
SC8776                    OR UTVTACCA-POST-METHOD = 'B'
SC8776                    MOVE UT1000CA-CALL-FR-BRANCH-NO
SC8776                         TO WA-VIRTUAL-TO-BRANCH
SC8776                 END-IF
ST0058                 IF UT1000CA-CALL-FR-BRANCH-NO =
ST0058                    UT1000CA-CALL-TO-BRANCH-NO
SC4584                 OR STRT-AREA-TRN-NO = 14050 OR 14150
CS7091                                    OR 19050 OR 19150
SC8782                   IF STRT-AREA-VIRTUAL-ACCT-FLAG NOT = "Y"
ST0058                      MOVE 'F3'
ST0058                           TO WA-ATM-PROMO-NO
ST0058                              W800-PROMO-NO
ST0058                      END-IF
SC8782                   END-IF
ST0058              ELSE
ST0058                 MOVE UT1000CA-CALL-ERR-NO TO
ST0058                      WA-OUTPUT-ERR-MSG-NO
ST0058                 MOVE "UT1000" TO WA-OUTPUT-DATA-SET
ST0058                 MOVE "ERR"    TO WA-OUTPUT-STATUS
ST0058                 MOVE 1        TO WA-MSG-ERR-FLAG
ST0058*                CALL "FT0000" USING
ST0058*                                    STARTAREA
ST0058                 GO TO B099-EXIT
ST0058              END-IF
ST0058           END-IF
TB0277        END-IF.
SC7630* MOVE THE PARAGRAPH TO CALL "UT9008" SEPARATELY, SO THE CONDITION
SC7630* TO CALL "UT9008" IS MATCH TO IN0000 AND SY0010 FOR THE SAME CONDITION
SC7630     IF STRT-FEP-ATM-TXN OR STRT-FEDI-TNX
S18391     OR STRT-DIB-TXN
SC9232     OR STRT-BIZTALK-IVR-TXN OR STRT-WEBLOGIC-IB-TXN
SC7630*S10913 MOVE STRT-AREA-SOC-NO TO L-UT9008-SOC-NO
SC7630*S10913 MOVE SOC-BANK-NO      TO L-UT9008-SOC-BANK-NO
SC7630*S10913 MOVE STRT-AREA-BATCH-TANDEM TO L-UT9008-CHANNEL-TYPE
SC7630*S10913       MOVE WA-INPUT-MSG     TO L-UT9008-INPUT-MSG
SC7630*S10913       INITIALIZE L-UT9008-JNRST-SETLMNT-DT
SC7630        MOVE 1 TO UT9008CA-CALL-CODE
S10913        MOVE STRT-AREA-SOC-NO       TO STLMCA-SOC-NO
S10913        MOVE STRT-AREA-TRN-NO       TO STLMCA-TRN-NO
S10913        MOVE SOC-BANK-NO            TO STLMCA-SOC-BANK-NO
S10913        MOVE STRT-AREA-BATCH-TANDEM TO STLMCA-CHANNEL-TYPE
S10913        MOVE WA-INPUT-MSG           TO STLMCA-INPUT-MSG
S10913        INITIALIZE                     STLMCA-JNRST-SETLMNT-DT
SC7630*S10913 CALL  "UT9008" USING WL-CALL-AREA
S10913        CALL  "UT9008" USING STLMCA-CALL-AREA
SC7630        IF NOT      UT9008CA-STATUS-OK
SC7630            SET     UT8500CA-RESPONSE-NOT-REQD TO TRUE
SC7630            SET     UT8500CA-NORMAL-DISPLAY    TO TRUE
SC7630            MOVE    SPACES TO UT8500CA-INPUT-MSG
SC7630            STRING "BR0000:(B000) UT9008 FAILURE, STAT- "
SC7630               UT9008CA-STATUS
SC7630            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC7630            CALL   "UT8500" USING
SC7630               UT8500CA-AREA
S10774         ELSE
S10774           IF STRT-FEDI-TNX
S10774             MOVE 0                    TO WA-EFTM-SETLMNT-DT
S10774             MOVE 0                    TO WA-TRAN-TYPE
S10774           ELSE
S10774*S10913      MOVE L-UT9008-JNRST-SETLMNT-DT TO UT0020-BINARY-DATE
S10913             MOVE STLMCA-JNRST-SETLMNT-DT TO UT0020-BINARY-DATE
S10774             MOVE 2                    TO UT0020-FUNCTION
S10774             CALL "UT0020" USING  UT0020-FUNCTION
S10774                                  UT0020-DATE-AREA
S10774                                  UT0020-BINARY-DATE
S10774             MOVE UT0020-DATE-YYYYMMDD TO WA-EFTM-SETLMNT-DT
S10774*S10913      MOVE L-UT9008-TRAN-TYPE   TO WA-TRAN-TYPE
S10913             MOVE STLMCA-TRAN-TYPE     TO WA-TRAN-TYPE
SC7630        END-IF
SC7630     END-IF.
S16235*S10982     IF      SOC-SRN-IND = "Y" AND WA-TRAN-SRNM-RECON
S16235     IF      SOC-SRN-IND = "Y"
S16235     AND    (WA-TRAN-SRNM-RECON OR WA-DISCH-SRNM-RECON)
S10982             INITIALIZE  UTSRNMCA-CALL-AREA
S10982             MOVE 02                   TO UTSRNMCA-CALL-CODE
S16235             IF  WA-TRAN-SRNM-RECON
S10982                 MOVE WA-11049-SRN-NO  TO UTSRNMCA-SPCL-REF-NO
S16235             ELSE
S16235                 MOVE WA-13047-SRN-NO  TO UTSRNMCA-SPCL-REF-NO
S16235             END-IF
S10982             CALL "UTSRNM"     USING
S10982                                          STARTAREA
S10982                                          UTSRNMCA-CALL-AREA
S10982             IF   UTSRNMCA-CALL-STATUS = 0
S10982                  MOVE UTSRNMCA-ACCTNO TO WA-DEP-ACCT-NO
S10982             ELSE
S10982                  MOVE UTSRNMCA-CALL-MSG-NO
S10982                                       TO WA-OUTPUT-ERR-MSG-NO
S10982                  MOVE 1               TO WA-MSG-ERR-FLAG
S10982                  GO                   TO B099-EXIT
S10982             END-IF
S10982     END-IF.
SC9610**SET UP ST-LOAN-BACKDATED-CORR FLAG
SC9610     IF WA-INPUT-PARAM-TABLE(7) = 1
SC9610        AND WA-INPUT-PARAM-TABLE(8) = 1
SC9610        AND WA-INPUT-PARAM-TABLE(29) = 0
SC9610*S10542 AND WA-INPUT-PARAM-TABLE(25) = 0
S10542        AND (WA-INPUT-PARAM-TABLE(25) = 0                
S10542         OR (WA-INPUT-PARAM-TABLE(25) = 1                
S10542        AND  NOT BORP-YOUBE AND STRT-AREA-TRN-NO = 15109))
S11617*S10971        AND STRT-AREA-TRN-NO NOT = 16120
S11617        AND (STRT-AREA-TRN-NO NOT = 16120
S17282         OR STRT-AREA-TRN-NO = 16102
S11617         OR STRT-AREA-TRN-NO = 16129)
S11455        AND WA-ADV-AMORT-FLAG NOT = "A"
S11455        AND WA-ADV-AMORT-FLAG NOT = "F"
S11455        AND WA-ADV-AMORT-FLAG NOT = "R"
S11455        AND WA-ADV-AMORT-FLAG NOT = "S"
SC9610        AND STRT-BANCSLINK
SC9610        MOVE 1 TO ST-LOAN-BACKDATED-CORR
SC9610     END-IF.
TB0120******************************************************************
TB0120*     VALIDATION FOR INTER BRANCH PROCESSING
TB0120******************************************************************
TB0120
TB0120     IF  SOC-SITE-TIB
TB0120     AND STRT-AREA-BATCH-TANDEM = 0
TB0120     AND WA-INPUT-PARAM-TABLE(2) = 1
TB0120     AND WA-INPUT-PARAM-TABLE(24) NOT = 1
TB0120         PERFORM B620-FETCH-MASTER THRU B629-EXIT
TB0120         IF WA-MSG-ERR-FLAG = 1
TB0120            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0120            GO TO B099-EXIT
TB0120         END-IF
S12060**    VALIDATION FOR UTBRHMRA-BSB
S12060*S12212  PERFORM W400-BRHM-BSB  THRU W499-EXIT
S12060*S12212  IF WA-MSG-ERR-FLAG = 1
S12060*S12212     PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S12060*S12212     GO TO B099-EXIT
S12060*S12212  END-IF
S15967*
S19269*S15967  IF  BORM-ACT-TYPE (1:1) = '6'
S19269         IF (BORM-ACT-TYPE (1:1) = '6'
S20771*S19269         OR  BORM-ACT-TYPE (1:2) = '78')
S20771         OR  BORP-FBOND
S20771         OR  BORM-ACT-TYPE (1:2) = '78')
S16564         AND NOT BORP-COMML-LN
S15967             AND BORM-VALUER-CODE NOT = ZEROS
S15967             IF  STRT-AREA-BRANCH = BORM-VALUER-CODE
S15967                 GO  TO B001-CONT
S15967             ELSE
S15967                 IF (WA-INPUT-PARAM-TABLE(4) = 1
S15967                      OR WA-INPUT-PARAM-TABLE(5) = 1
S15967                      OR WA-INPUT-PARAM-TABLE(26) = 0)
S15967                    MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
S15967                    MOVE 1   TO WA-MSG-ERR-FLAG
S15967                    PERFORM E000-COMPLETION-PARA
S15967                            THRU E099-EXIT
S15967                    GO TO B099-EXIT
S15967                 END-IF
S15967            END-IF
S15967         END-IF
S15967*
S20744         MOVE ZEROES             TO WA-TMP-BRANCH
S20744         MOVE STRT-AREA-BRANCH   TO WA-TMP-BRANCH
S16682         IF  BORM-ACT-TYPE (1:1) = '8'
S16682         AND STRT-AREA-BRANCH NOT = BORM-BR-NO
S16682         AND BORM-VALUER-CODE NOT = ZEROS
S17697*S16682  AND STRT-AREA-BRANCH = BORM-VALUER-CODE
S17697         AND (STRT-AREA-BRANCH = BORM-VALUER-CODE
S20744*S17697           OR STRT-AREA-BRANCH = 622)
S20744             OR WA-SME-BRANCH )
S16682             GO TO B001-CONT
S16682         END-IF
S16682
S20054         IF  BORM-ACT-TYPE (1:1) = '8'
S20054         AND STRT-AREA-BRANCH NOT = BORM-BR-NO
S20054         AND STRT-AREA-BRANCH = 628
S20054         AND WA-SME-ALLOWED-TXN
S20054             GO TO B001-CONT
S20054         END-IF
S20054
TB0120         IF  STRT-AREA-BRANCH NOT = BORM-BR-NO
S12060*S12212  AND NOT WA-BRHM-OPEN-OK
SC4241         AND NOT STRT-BATCH-TXN
SC4241         AND NOT STRT-TRICKLE-TXN
TB0120             PERFORM X720-CALL-UT0251 THRU X729-EXIT
TB0120             IF  UT0251CA-CALL-STATUS = "****"
TB0120                 EVALUATE UT0251RA-IB-ALLOWED-FLG
TB0120                 WHEN "N"
TB0120                    MOVE 1   TO WA-MSG-ERR-FLAG
TB0120                    MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
TB0120                    PERFORM E000-COMPLETION-PARA
TB0120                             THRU E099-EXIT
TB0120                 WHEN "Y"
TB0120                    IF BORP-IB-ALLOWED
TB0120                       NEXT SENTENCE
TB0120                    ELSE
TB0120                       IF WA-INPUT-PARAM-TABLE(25) = 1
TB0120                          IF BORP-DSCHG-IB-NOT-ALLOWED
TB0120                             MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
TB0120                             MOVE 1   TO WA-MSG-ERR-FLAG
TB0120                             PERFORM E000-COMPLETION-PARA
TB0120                                      THRU E099-EXIT
TB0120                             GO TO B099-EXIT
TB0120                          ELSE
TB0120                             IF WA-INPUT-PARAM-TABLE(26) = 1
TB0120                                NEXT SENTENCE
TB0120                             ELSE
TB0120                                MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
TB0120                                MOVE 1   TO WA-MSG-ERR-FLAG
TB0120                                PERFORM E000-COMPLETION-PARA
TB0120                                         THRU E099-EXIT
TB0120                                GO TO B099-EXIT
TB0120                             END-IF
TB0120                          END-IF
TB0120                       ELSE
SC0556                        IF WA-INPUT-PARAM-TABLE(26) = 1
SC0556                             NEXT SENTENCE
SC0556                        ELSE
TB0120                          MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
TB0120                          MOVE 1   TO WA-MSG-ERR-FLAG
TB0120                          GO TO B099-EXIT
SC0556                        END-IF
TB0120                       END-IF
TB0120                    END-IF
TB0120                 END-EVALUATE.
TB0120*
S15967*
S15967 B001-CONT.
S15967*
SC0367     MOVE STRT-AREA-TRN-NO TO WA-CURR-TRCODE.
SC0367     IF WA-TFR-FROM-DEP-ACCT
S20175**** No more validation for all branch MIMA if not deposit
SC4726**** deposit transfer and there is not account no. entered.   
SC4726        IF STRT-AREA-TRN-NO = 17467                           
SC4726         AND (BR17467-INP-DEF-SYSTEM NOT = "INV"              
SC4726         OR BR17467-INP-TRF-ACCOUNT = 0)                      
SC4726           NEXT SENTENCE                                      
SC4726        ELSE                                                  
SC0289        IF STRT-BATCH-TRICKLE-TXN
SC5938           OR STRT-ASYNC-TPS
SC7230           OR STRT-REPOST-TXN 
S15644           OR WA-11049-SRN-NO > 0
SC0289           NEXT SENTENCE
SC0289        ELSE
SC0367        PERFORM X000-VAL-ALL-BR-PSWD THRU X099-EXIT
SC0367        IF WA-MSG-ERR-FLAG = 1
SC0367           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC0367           GO TO B099-EXIT.
TB0155*
TB0249*-- SUPERVISORY OVERRIDE --*
SC2591*    IF (WA-MSG-ERR-FLAG > 0) OR (WA-OUTPUT-ERR-MSG-NO > 0)
SC2591     IF  (WA-MSG-ERR-FLAG > 0)
SC2591     AND (WA-OUTPUT-ERR-MSG-NO >= 100 AND
SC2591          WA-OUTPUT-ERR-MSG-NO <= 899) OR
SC2591         (WA-OUTPUT-ERR-MSG-NO >= 1000)
TB0249        GO TO B001-SUP.
SC5708     IF (STRT-AREA-TRN-NO = 17050 OR 17000 OR 17036) AND
SC5708        (BORM-STAT = 40)
SC5708        GO TO B001-SUP.
SC7567*    IF STRT-AREA-TRN-NO = (17038 OR 17026 OR 63058 OR 17000)
SC7567     IF STRT-AREA-TRN-NO = (17038 OR 63058 OR 17000)
SC1267                   OR 12008
SC1476                   OR 17036
S12474                   OR 12007 OR 17037
SC1701                   OR 10241 OR 10242 OR 10243 OR 10244
S11789                   OR 10245
S16588                   OR 17085
S15599*S15320                   OR 10872
SC7567                   OR (STRT-AREA-TRN-NO = 17026 AND
SC7567                       BORM-STAT NOT = 01 AND BORM-ADV-VAL > 0)
S12000                   OR (STRT-AREA-TRN-NO = 13031
S12000                   AND BOIS-MISC-INC-DUE > 0)
TB0249        MOVE "Y" TO UTOVRDCA-CALL-TELR-FLAG
TB0249        PERFORM H400-SUPER-OVERRIDE THRU H400-EXIT
TB0249        IF WA-MSG-ERR-FLAG = 1
ST0083*          MOVE 0  TO WA-MSG-ERR-FLAG
ST0083*          MOVE UTOVRDCA-CALL-ERROR-CODE TO
ST0083*               UT0060CA-CALL-ERROR-CODE
ST0083*          MOVE UTOVRDCA-CALL-PROMONO    TO WA-OVER-RIDE
ST0083*          PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
ST0083*          IF WA-MSG-ERR-FLAG = 0
ST0083*             MOVE UTOVRDCA-CALL-ERROR-CODE TO WA-ERR-MSG-NO
ST0083*          ELSE
S17808              IF STRT-AREA-TRN-NO = 17000
S17808                 AND WA-TR-NA-GRACE-PERIOD <> BOIS-GRACE-PERIOD
S17808                 AND BOIS-ARREARS-CTR > 0
S17808                 PERFORM X940-GRACE-RTN   THRU X940-EXIT
S17808              END-IF
TB0249              MOVE UTOVRDCA-CALL-ERROR-CODE TO
TB0249                   WA-OUTPUT-ERR-MSG-NO
TB0249              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0249              GO TO B099-EXIT
ST0083*          END-IF
TB0249        END-IF
TB0249        MOVE "N" TO UTOVRDCA-CALL-TELR-FLAG
TB0249     END-IF.
TB0249 B001-SUP.
TB0155*** FSLON0041 : ACCOUNT TRANSFER PROCESS
TB0155*** YAKEE
TB0155*
TB0155/
S11144     IF  (STRT-AREA-TRN-NO EQUAL 17046)
S17168*S11144     AND (STRT-FEP-ATM-TXN OR STRT-MORTGAGE-TXN)
S17168     AND (STRT-FEP-ATM-TXN OR STRT-MORTGAGE-TXN
S17168       OR STRT-DSS-BUNCH-TXN)
S11144          PERFORM B620-FETCH-MASTER THRU B629-EXIT
S11144          IF  WA-MSG-ERR-FLAG = 1
S11144              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11144              GO TO B099-EXIT
S11144          END-IF
S11144          MOVE BORM-SOC-NO     TO UT2000CA-CALL-SOC-NO
S11144          MOVE BORM-ACT-TYPE   TO UT2000CA-CALL-ACCT-TYPE
S11144          MOVE BORM-CAT        TO UT2000CA-CALL-INT-CAT
S11144          MOVE 02              TO UT2000CA-CALL-CODE
S11144          PERFORM D100-CALL-UT2000 THRU D199-EXIT
S11144          IF  WA-MSG-ERR-FLAG = 1
S11144              MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
S11144              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11144              GO TO B099-EXIT
S11144          END-IF
S11144          IF  BORM-ACT-TYPE <> '7501'
S17168          AND NOT BORP-CORPORATION
S19269          AND NOT BORP-PB
S20771          AND NOT BORP-FBOND
S11144              MOVE 865           TO WA-OUTPUT-ERR-MSG-NO
S11144              MOVE 1             TO WA-MSG-ERR-FLAG
S11144              PERFORM E000-COMPLETION-PARA THRU
S11144                      E099-EXIT
S11144              GO TO B099-EXIT
S11144          END-IF
S11144          IF  BORM-STAT EQUAL 10 OR
S11144              BORM-STAT EQUAL 20 OR
S11144              BORM-STAT EQUAL 40
S11144              MOVE 1513          TO WA-OUTPUT-ERR-MSG-NO
S11144              MOVE 1             TO WA-MSG-ERR-FLAG
S11144              PERFORM E000-COMPLETION-PARA THRU
S11144                      E099-EXIT
S11144              GO TO B099-EXIT
S11144          END-IF
S11144          IF (BORM-BAD-DEBT-IND NOT EQUAL ZEROES AND
S11144              BORM-BAD-DEBT-IND NOT EQUAL 50)
S16317*S11144              MOVE 1514          TO WA-OUTPUT-ERR-MSG-NO
S16317              MOVE 3293          TO WA-OUTPUT-ERR-MSG-NO
S11144              MOVE 1             TO WA-MSG-ERR-FLAG
S11144              PERFORM E000-COMPLETION-PARA THRU
S11144                      E099-EXIT
S11144              GO TO B099-EXIT
S11144          END-IF
S11144     END-IF.
S11144*
TB0155     IF   STRT-AREA-TRN-NO EQUAL 17046
S17168*S11144     AND  NOT (STRT-FEP-ATM-TXN OR STRT-MORTGAGE-TXN)
S17168     AND  NOT (STRT-FEP-ATM-TXN OR STRT-MORTGAGE-TXN
S17168            OR STRT-DSS-BUNCH-TXN)
S10614*S11144     AND  NOT (STRT-FEP-ATM-TXN)
TB0155          IF  BORM-STAT EQUAL 10 OR
TB0155              BORM-STAT EQUAL 20 OR
TB0155              BORM-STAT EQUAL 40
TB0155              MOVE 1513          TO WA-OUTPUT-ERR-MSG-NO
TB0155              MOVE 1             TO WA-MSG-ERR-FLAG
TB0155              PERFORM E000-COMPLETION-PARA THRU
TB0155                      E099-EXIT
TB0155              GO TO B099-EXIT
TB0155          END-IF
TB0155*
SC2676*         IF  ((BORP-LOAN-CLASS NOT EQUAL '0') AND
SC2676          IF  ((BORP-LOAN-CLASS NOT EQUAL '0' AND '4') AND
TB0155              (BORM-BAD-DEBT-IND NOT EQUAL ZEROES AND
TB0155              BORM-BAD-DEBT-IND NOT EQUAL 50))
S16317*TB0155              MOVE 1514          TO WA-OUTPUT-ERR-MSG-NO
S16317              MOVE 3293          TO WA-OUTPUT-ERR-MSG-NO
TB0155              MOVE 1             TO WA-MSG-ERR-FLAG
TB0155              PERFORM E000-COMPLETION-PARA THRU
TB0155                      E099-EXIT
TB0155              GO TO B099-EXIT
TB0155          END-IF
TB0155*
SC2676*         IF  ((BORP-LOAN-CLASS EQUAL '0') AND
S16871*SC2676          IF  ((BORP-LOAN-CLASS EQUAL '0' OR '4') AND
S16871*TB0155              (BORM-BAD-DEBT-IND NOT EQUAL ZEROES AND
S16871*TB0155              BORM-BAD-DEBT-IND NOT EQUAL 50 AND
S16871*TB0155              BORM-BAD-DEBT-IND NOT EQUAL 01 AND
S16871*TB0155              BORM-BAD-DEBT-IND NOT EQUAL 51))
S16871          IF  BORP-COMML
S16871          AND BORM-BAD-DEBT-IND(2:1) > 1
TB0155              MOVE 1515          TO WA-OUTPUT-ERR-MSG-NO
TB0155              MOVE 1             TO WA-MSG-ERR-FLAG
TB0155              PERFORM E000-COMPLETION-PARA THRU
TB0155                      E099-EXIT
TB0155              GO TO B099-EXIT
TB0155          END-IF
S11215*S10842          IF ((NOT BORP-YOUBE )
S11215*S10842          AND BORP-FINE-METH   = 99
S11215*S10842          AND BORP-FINE-CONDT  = 99 )
S11215*S10842              MOVE 4658          TO WA-OUTPUT-ERR-MSG-NO
S11215*S10842              MOVE 1             TO WA-MSG-ERR-FLAG
S11215*S10842              PERFORM E000-COMPLETION-PARA THRU
S11215*S10842                      E099-EXIT
S11215*S10842              GO TO B099-EXIT
S11215*S10842          END-IF
TB0155*
TB0155          IF  UTBRHMRA-STAT NOT EQUAL ZEROES
TB0155              MOVE 0526          TO WA-OUTPUT-ERR-MSG-NO
TB0155              MOVE 1             TO WA-MSG-ERR-FLAG
TB0155              PERFORM E000-COMPLETION-PARA THRU
TB0155                      E099-EXIT
TB0155              GO TO B099-EXIT
TB0155          END-IF
TB0155     END-IF.
TB0155*
TB0155/
TB0158*
TB0158*** FSLON0003 : INTEREST / PENALTY WAIVE
TB0158*** YAKEE   
TB0158*
TB0158/
TB0158     IF   (STRT-AREA-TRN-NO EQUAL 10430 OR 10431 OR 10432
TB0158          OR 10433 OR 10434 OR 10240 OR 10241 OR 10242 OR
TB0158          10243 OR 10244
S11789          OR 10245)
S11877     OR   (WA-REPAY-PROMO             = "T4"
S11877     AND   WA-INPUT-PARAM-TABLE(4)    = "1" 
S11877     AND   WA-INPUT-PARAM-TABLE(7)    = 0   )
S12794          MOVE BORM-LOAN-BAL TO WA-PRINCIPAL-AMT1
TB0158          IF  WA-INPUT-PARAM-TABLE(2) = 1
TB0158              PERFORM B620-FETCH-MASTER THRU B629-EXIT
TB0158              IF  WA-MSG-ERR-FLAG = 1
TB0158                  PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0158                  GO TO B099-EXIT
TB0158              END-IF
TB0158          END-IF
S17197          IF  STRT-AREA-TRN-NO = 10430
S17197              PERFORM X920-ALBPS-RTN   THRU X920-EXIT
S17197              IF  WA-MSG-ERR-FLAG = 1
S17197                  PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S17197                  GO TO B099-EXIT
S17197              END-IF
S17197          END-IF
SC7758          MOVE STRT-AREA-TRN-NO TO WA-SAVE-TRN-NO
S11877          IF (WA-REPAY-PROMO          = "T4"
S11877          AND WA-INPUT-PARAM-TABLE(4) = "1" 
S11877          AND WA-INPUT-PARAM-TABLE(7) = 0   )
S11877              MOVE STRT-AREA-TRN-NO TO WA-SAVE-T4-TRN-CODE
S11877              MOVE WA-INPUT-MSG     TO WA-SAVE-T4-INPUT-MSG
S11877              MOVE WA-REPAY-PROMO   TO WA-10430-PROMO-CODE
S11877              MOVE WA-T4-TRN-CODE   TO STRT-AREA-TRN-NO
S11877              MOVE WA-T4-TYPE       TO WA-10430-TYPE
S11877              MOVE WA-T4-SEGMENT    TO WA-10430-SEGMENT
S11877              MOVE ZEROS            TO WA-10430-DATE
S11877              MOVE ZEROS            TO WA-10430-PROJ-DATE
S11877              MOVE ZEROS            TO WA-10430-AMOUNT
S11877              MOVE "Y"              TO SW-T4-FLAG
S11877          END-IF
S15466          IF  NOT BORP-YOUBE
S15466          AND BR0000-SYSTEM-IN-NIGHT
S15466              INITIALIZE UT0086CA-AREA
S15466              MOVE 01 TO UT0086CA-CALL-CODE
S15466              CALL "UT0086" USING UT0086CA-CALL-AREA
S15466                                  STARTAREA
S15466                                  BORM-RECORD-AREA
S15466                                  BOIS-RECORD
S15466                                  BORR-PARAMS
S15466          END-IF
S20487          MOVE BORM-TWO-HOUSE-IND TO WK-TW0-HOUSE-IND
S20699          MOVE BORM-ONE-HOUSE-IND TO WK-ONE-HOUSE-IND
S20487          IF   STRT-BANCSLINK
S20487           AND STRT-AREA-TRN-NO = 10430
S20699*S20487    AND WK-TWO-HOUSE-IND-OK
S20699           AND (WK-TWO-HOUSE-IND-OK OR WK-ONE-HOUSE-IND-OK)
S20487           AND WA-10430-TYPE = "C"
S20487           AND WA-10430-SEGMENT = "C"
S20487               PERFORM X953-ACH-POPUP-MSG THRU X953-EXIT
S20487          END-IF
TB0158          CALL "BR0029" USING
TB0158                         STARTAREA
TB0158                         UT0500-CALL-PARAM
TB0158                         BOIS-RECORD
TB0158                         BORR-PARAMS
TB0158                         SOC-PARAMS
TB0158                         WS-10240-JRNL-SRC
SC7758          MOVE WA-SAVE-TRN-NO TO STRT-AREA-TRN-NO
TB0158          MOVE ZEROES               TO WS-10240-INDX
S17306          IF   STRT-AREA-TRN-NO     =  10241
S17306          AND  STRT-TRICKLE-TXN
S17306            MOVE INPUT-10241-REASON TO WA-10732-RSN-CD
S17306            IF WA-BONUS-EXCHANGE
S17306               MOVE  20             TO UT9000-REPORT-NO
S17306               PERFORM X930-ADD-EXTRA-LOG THRU X930-EXIT
S17306            END-IF
S17306          END-IF
TB0158          IF 10240-JRNL-IND NOT EQUAL ZEROES
TB0158             PERFORM VARYING WS-10240-INDX FROM 1 BY 1
TB0158                     UNTIL WS-10240-INDX > 30
TB0158                IF 10240-JRNL-TRAN-CODE(WS-10240-INDX)
TB0158                  NOT EQUAL 999999 AND
TB0158                   10240-JRNL-TRAN-CODE(WS-10240-INDX)
TB0158                  NOT EQUAL ZEROES
TB0158                  INITIALIZE JNRST-DB-DATA
TB0158                  MOVE 10240-JRNL-TRAN-CODE(WS-10240-INDX)
TB0158                       TO JNRST-TRAN-CODE
SC4333                          LINK-IN-TXCODE
TB0158                  MOVE 10240-JRNL-ACTUAL-AMT(WS-10240-INDX)
TB0158                       TO JNRST-AMOUNT
TB0158                  MOVE 10240-JRNL-BALANCE-AMT(WS-10240-INDX)
TB0158*                      TO JNRST-AMOUNT
SC3625                       TO JNRST-BALANCE 
NR2001*TB0158                  MOVE 10240-JRNL-BORV-CODE(WS-10240-INDX)
NR2001                  MOVE 10240-JRNL-BOCT-CODE(WS-10240-INDX)
TB0158                       TO JNRST-TRN-TYP
S12524                  MOVE 10240-JRNL-PROMO-NO (WS-10240-INDX)
S12524                       TO JNRST-BATCH-NO
TB0158                  PERFORM Z10240-JRNL-RTN THRU
TB0158                          Z10240-JRNL-EXIT
TB0158                ELSE
TB0158                   MOVE 31                 TO WS-10240-INDX
TB0158                END-IF
TB0158             END-PERFORM
TB0158          END-IF
S11877          IF (SW-T4-FLAG            =  "Y")
S11877              MOVE WA-SAVE-T4-TRN-CODE TO STRT-AREA-TRN-NO
S11877              MOVE WA-SAVE-T4-INPUT-MSG TO WA-INPUT-MSG
S11877              IF ( WA-REPAY-AMOUNT  =  WA-MULTI-CURR-AMT )
S11877                   MOVE OUTPUT-10433-TOT-SET3 
S11877                                    TO WA-MULTI-CURR-AMT
S11877              END-IF
S11877              IF ( WA-REPAY-AMOUNT  =  WA-MULTI-BASE-CURR-AMT )
S11877                   MOVE OUTPUT-10433-TOT-SET3 
S11877                                    TO WA-MULTI-BASE-CURR-AMT
S11877              END-IF
S11877              MOVE OUTPUT-10433-TOT-SET3 TO WA-REPAY-AMOUNT
S11877          ELSE
TB0158              GO TO B099-EXIT
S11877          END-IF
TB0158     END-IF.
TB0158*
TB0158/
048940     IF   WA-INPUT-PARAM-TABLE(4)  = 1 OR
048950          WA-INPUT-PARAM-TABLE(5)  = 1 OR
048960          (WA-INPUT-PARAM-TABLE(17) = 1 AND
048970          (STRT-AREA-TRN-NO NOT = 12690 AND 12691)) OR
048980          STRT-AREA-TRN-NO = 12477     OR
048990          STRT-AREA-TRN-NO = 12577
049000         MOVE WA-ADV-PROMO          TO WA-INPUT-PROMO
049010                                       WA-OVER-RIDE.
049020     IF  ( STRT-AREA-TRN-NO >= 13000 AND <= 13020 )
049030           OR STRT-AREA-TRN-NO = 13045
S17263           OR STRT-AREA-TRN-NO = 15045
049040         MOVE WA-DISCH-I-PROMO-CODE TO WA-INPUT-PROMO
049050                                       WA-OVER-RIDE.
049060*
049070     IF  (WA-INPUT-PARAM-TABLE(4) = 1  OR
049080          WA-INPUT-PARAM-TABLE(5) = 1)
049090         IF   WA-SUPERVISOR-OVERRIDE-IN-USE = "2" OR "3" OR "7"
049100              MOVE "69"              TO WA-OVER-RIDE.
049110*    IF WA-UT0220-SAVE-SOC-NO NOT = STRT-AREA-SOC-NO
049120*       MOVE 02                      TO UT0220CA-CALL-CODE
049130*       MOVE STRT-AREA-SOC-NO        TO UT0220CA-CALL-SOC-NO
049140*       MOVE 1                       TO UT0220CA-CALL-GRP-NO
049150*       CALL "UT0220" USING
049170*                           WA-UT0220-CALL-AREA
049180*       IF UT0220CA-CALL-STATUS NOT = 0
049190*          MOVE 1                    TO WA-MSG-ERR-FLAG
049200*          MOVE 273                  TO WA-OUTPUT-ERR-MSG-NO
049210*          PERFORM E000-COMPLETION-PARA THRU E099-EXIT
049220*          GO TO B099-EXIT
049230*       ELSE
049240*          MOVE STRT-AREA-SOC-NO     TO WA-UT0220-SAVE-SOC-NO
049250*          MOVE 1                    TO WA-UT0220-SAVE-GRP-NO.
049260     IF SOC-LOANS-TRACKING-OPTION = "Y" AND
049270        WA-INPUT-PARAM-TABLE(22) = 1
049280        MOVE SPACE TO STRT-AREA-OK-MSG-CNTL-FLAG.
049290     IF STRT-TRICKLE-TXN
049300         IF STRT-AREA-TRN-NO = 16039 OR 16059
049310             MOVE "Y" TO WA-GATEWAY-TRANCODE.
049330     MOVE SPACES                     TO WA-ACCT-CURR-CD
049340                                        WS-SAVE-TXN-CURRENCY
049350                                        WS-SAVE-DISC-CURRENCY.
049360     MOVE ZEROES                     TO WA-SAVE-TXN-AMT
049370                                        WS-AMT.
049380* Keymatrix 30 day loans - initialise multi currency fields             
049390     IF   STRT-AREA-TRN-NO = 12422 OR 11064
049400          MOVE SPACES             TO WA-MULTI-ACCT-CURR-CD
049410                                     WA-MULTI-CURR-AMT-CURR-CD
049420                                     WA-MULTI-CURR-VERSION
049430          MOVE ZEROES             TO WA-MULTI-CURR-AMT
049440                                     WA-MULTI-BASE-CURR-AMT
049450                                     WA-MULTI-COMMISSION
049460                                     WA-MULTI-CHANGE
049470                                     WA-MULTI-RATE-TYPE.                 
049480* End Keymatrix 30 day loan code                                         
049490*
049500     IF   WA-INPUT-PARAM-TABLE(4) = 1        OR
049510          WA-INPUT-PARAM-TABLE(5) = 1
NLB205*         MOVE WA-MULTI-CURR-AMT-CURR-CD TO WA-CHK-CURR-CD              
NLB205*         MOVE WA-MULTI-BASE-CURR-AMT TO WA-CHK-BASE-AMT                
049540          MOVE  WA-MULTI-ACCT-CURR-CD   TO   WA-ACCT-CURR-CD
NLB205*                                            WA-CHK-ACCT-CD             
049560          MOVE  WA-MULTI-CURR-AMT       TO   WA-SAVE-TXN-AMT
NLB205*                                            WA-CHK-CURR-AMT            
049580          MOVE  WA-MULTI-CHANGE         TO WA-SAVE-CHANGE-AMT
049590        IF WA-MULTI-CURR-AMT-CURR-CD NOT = SPACES
049600          MOVE WA-MULTI-CURR-AMT-CURR-CD TO WS-SAVE-TXN-CURRENCY
049610        ELSE
049620          MOVE SOC-NATIVE-CURRENCY     TO WS-SAVE-TXN-CURRENCY
049630                                       WA-MULTI-CURR-AMT-CURR-CD.
049640     IF   WA-INPUT-PARAM-TABLE(4) = 1        OR
049650          WA-INPUT-PARAM-TABLE(5) = 1
049660          IF  WA-MULTI-ACCT-CURR-CD  =  SPACES
049670*           MOVE  SOC-NATIVE-CURRENCY TO  WA-MULTI-ACCT-CURR-CD         
049680            MOVE BORM-CURRENCY-IND    TO  WA-MULTI-ACCT-CURR-CD         
049690                                               WA-ACCT-CURR-CD.
049700     IF   WA-INPUT-PARAM-TABLE(4) = 1        OR
049710          WA-INPUT-PARAM-TABLE(5) = 1
049720          IF  WA-MULTI-CURR-AMT  =  ZEROS
049730            IF  WA-MULTI-ACCT-CURR-CD = WA-MULTI-CURR-AMT-CURR-CD
049740                MOVE  WA-INPUT-AMT       TO WA-MULTI-CURR-AMT
049750                                            WA-SAVE-TXN-AMT.
049760     MOVE SOC-NATIVE-CURRENCY TO  WS-SAVE-DISC-CURRENCY.
049770     IF WA-INPUT-PARAM-TABLE(17) = 1  OR
049780        WA-INPUT-PARAM-TABLE(25) = 1
049790        IF STRT-AREA-TRN-NO NOT = 13000
049800            MOVE WA-INPUT-AMT            TO WA-SAVE-TXN-AMT.
KEY008*
049820***  FOR KEYMATRIX 30 DAY LOAN NEEDS MASTER READ FOR TXN 12690          
049830*
049840     IF  STRT-AREA-TRN-NO = 12690 OR 12691
049850         PERFORM B620-FETCH-MASTER THRU B629-EXIT
049860         IF WA-MSG-ERR-FLAG = 1
049870            PERFORM E000-COMPLETION-PARA  THRU E099-EXIT
049880            GO TO B099-EXIT
049890         END-IF
049900         IF  WA-INPUT-PARAM-TABLE (11) NOT = 1
049910             PERFORM B700-ACCT-TYPE-CHECK-PARA THRU B799-EXIT
049920             IF WA-MSG-ERR-FLAG = 1
049930                PERFORM E000-COMPLETION-PARA  THRU E099-EXIT
049940                GO TO B099-EXIT
049950             END-IF
049960         END-IF.
KEY008*                                                                        
TB0152***
TB0152***  CUSTOMER INCOME/EXPENSE MAINTENANCE
TB0152***    FOR BROKERAGE AND REFERRAL FEES
TB0152***        AND ADVANCE FEE DETAILS
TB0172***
TB0190     IF WA-CUST-INC-EXP-MAINT
TB0172        CALL "UT0029" USING  STARTAREA
                                   SOC-PARAMS
TB0190                             WA-PASSALONG
TB0190                             MULTI-OVERRIDE-AREA
TB0172
TB0172        PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0172        GO TO B099-EXIT
TB0172     END-IF.
049980     IF  STRT-AREA-TRN-NO = 12580 OR 12585 OR 12590 OR 12591 OR
049990                            12690 OR 12691 OR 
TB0084                            12697 OR 12698 OR 12699
050000         CALL "BR0009" USING
050020                             STARTAREA
050030                             SOC-PARAMS
TB0084                             BOIS-RECORD
S17579                             BR0009-LINKAGE
050040         IF  WA-DUMMY-TRN-NO = 12691
050050            PERFORM E000-COMPLETION-PARA  THRU E099-EXIT
050060         END-IF
050070         GO TO B099-EXIT.
050080     IF STRT-AREA-TRN-NO = 12692                                        
050090        CALL "BR0080" USING STARTAREA                                   
050100                            SOC-PARAMS                                  
050110        GO TO B099-EXIT                                                 
050120     END-IF.                                                            
050130     IF  STRT-AREA-TRN-NO = 12594 OR 12595 OR 12596 OR 12597 OR         
050140                            12600                                       
050150         CALL "BR0030" USING STARTAREA                                  
050160                             SOC-PARAMS                                  
050170         GO TO B099-EXIT                                                
050180     END-IF.                                                            
050200     if strt-area-trn-no = 19100                                        
050210        call "cs0011" using startarea                                   
050220        go to b099-exit                                                 
050230     end-if                                                             
      * 17048 IS NOW JUST A RETURN/ENQUIRY SCREEN; NO FURTHER PROCESSING.
      * JUST IN CASE, PROCESSING IN BR0001 IS STILL INTACT.
TB0168     IF STRT-AREA-TRN-NO = 17048
              MOVE 0 TO WA-OUTPUT-ERR-MSG-NO
              PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
TB0168        GO TO B099-EXIT
TB0168     END-IF
050250     IF  STRT-AREA-TRN-NO = 19000
050260         INITIALIZE UTCORRCA-CALL-AREA
050270         IF UTCORR-INPUT-VALID-FUNC AND
050280            NOT UTCORR-INPUT-EXIT-FUNC
050290            CALL "UTCORR" USING STARTAREA
050300                                SOC-PARAMS
050310                                UTCORRCA-CALL-AREA
050320                                COFL-RECORD
050330            IF  UTCORRCA-CALL-STATUS NOT = 0
050340                 MOVE 1 TO WA-MSG-ERR-FLAG
050350                 GO TO A099-EXIT
050360            END-IF
050370            IF UTCORR-INPUT-CREATE-FUNC
050380               INITIALIZE WA-OUTPUT-MSG
050390               MOVE UTCORRCA-CALL-ACCT-NO TO
050400                    UTCORR-OUT-ACCT-NO
050410               MOVE UTCORR-INPUT-FUNC    TO
050420                    UTCORR-OUT-FUNC
050430            ELSE
050440               MOVE UTCORR-OUTPUT-MESSAGE
050450                 TO UTCORR-INPUT-MESSAGE
050460            END-IF
050470            MOVE 6     TO STRT-AREA-IEXEC-CNTL
050480            MOVE 19001 TO STRT-AREA-TRN-NO
050490*           MOVE 391 TO WA-OUTPUT-MSG-LENGTH
050500            MOVE 434 TO WA-OUTPUT-MSG-LENGTH
050510            MOVE 998 TO WA-OUTPUT-ERR-MSG-NO
050520         ELSE
050530            MOVE 1    TO WA-MSG-ERR-FLAG
050540            MOVE 2578 TO WA-OUTPUT-ERR-MSG-NO
050550         END-IF
050560         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
050570         GO TO A099-EXIT
050580     END-IF.
050590*
050600     IF  STRT-AREA-TRN-NO = 19001 AND
050610         (UTCORR-INPUT-CREATE-FUNC OR
050620          UTCORR-INPUT-AMEND-FUNC)
050630         CALL "UTCORR" USING STARTAREA
050640                             SOC-PARAMS
050650                             UTCORRCA-CALL-AREA
050660                             COFL-RECORD
050670         IF  UTCORRCA-CALL-STATUS NOT = 0
050680             MOVE 1 TO WA-MSG-ERR-FLAG
050690             GO TO A099-EXIT
050700         END-IF
050710         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
050720         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
050730         GO TO A099-EXIT
050740     END-IF.
050750*
050760     IF  STRT-AREA-TRN-NO = 19001 AND
050770         UTCORR-INPUT-EXIT-FUNC
050780         MOVE 6     TO STRT-AREA-IEXEC-CNTL
050790         MOVE 19000 TO STRT-AREA-TRN-NO
050800         MOVE 18 TO WA-OUTPUT-MSG-LENGTH
050810         MOVE 998 TO WA-OUTPUT-ERR-MSG-NO
050820         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
050830         GO TO A099-EXIT
050840     END-IF.
050850*
050860     IF  STRT-AREA-TRN-NO = 19001 AND
050870         UTCORR-INPUT-ENQ-FUNC
050880         MOVE 1    TO WA-MSG-ERR-FLAG
050890         MOVE 2578 TO WA-OUTPUT-ERR-MSG-NO
050900         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
050910         GO TO A099-EXIT
050920     END-IF.
050940******************************************************************
050950*        FETCH MASTER
050960******************************************************************
050970     IF  WA-INPUT-PARAM-TABLE(2) = 1
050980         PERFORM B620-FETCH-MASTER THRU B629-EXIT
050990         IF  WA-MSG-ERR-FLAG = 1
051000             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
051010             GO TO B099-EXIT
051020         ELSE
051030           IF  STRT-AREA-TRN-NO = 12000                                 
051040               MOVE 0 TO WA-ACCT-BAL-BEF-TXN                            
051050                         WA-ACT-BAL-BEF-TXN                             
051060                         WA-UNCL-BAL-BEF-TXN                            
051070                         WA-WORK-BAL-BEFORE                             
051080           ELSE                                                         
051090               MOVE BORM-LOAN-BAL TO WA-ACCT-BAL-BEF-TXN                
051100                                     WA-ACT-BAL-BEF-TXN                 
051110               MOVE BORM-UNC-VAL  TO WA-UNCL-BAL-BEF-TXN
051120*** 760167 CALCULATE BALANCE BEFORE PROCESSING THE TXN ***
051130               COMPUTE WA-WORK-BAL-BEFORE = BORM-APP-AMT -
051140                                            BORM-LOAN-BAL +
051150                                            BORM-UNC-VAL
051160               PERFORM BC620-READ-BLDVFC THRU BC629-EXIT                 
051170           END-IF                                                        
051180     ELSE
051190         GO TO B003-TRACKING.
051200                                                                         
SC7483* DISABLE PDC REPAYMAENT FOR NPL,WRITE-OFF,AND REAPAY-SCH=N,J,K
SC7483    IF WA-INPUT-PARAM-TABLE (10) = 1
SC8620       MOVE BORM-ACT-TYPE      TO WA-ACT-TYPE-AA
SC7483       MOVE BORM-BAD-DEBT-IND  TO WA-BAD-DEBT-IND
SC7483*    IF  WA-BAD-DEBT-IND-2 > 1
SC7483*        OR  BOIS-AGREE-IND = "2"
SC7483*        OR  BORM-REPAY-SCHED = "N" OR "J" OR "K"
S15321*SC8620     IF  WA-BAD-DEBT-IND-2 > 2
S15321*SC8620                MOVE 1    TO WA-MSG-ERR-FLAG
S15321*SC8620                MOVE 2812 TO WA-OUTPUT-ERR-MSG-NO
S15321*SC8620                GO TO B099-EXIT
S15321*SC8620     END-IF
S15321*SC8620     IF  WA-BAD-DEBT-IND-2 > 1
S15321*SC8620                MOVE 1    TO WA-MSG-ERR-FLAG
S15321*SC8620                MOVE 4144 TO WA-OUTPUT-ERR-MSG-NO
S15321*SC8620                GO TO B099-EXIT
S15321*SC8620     END-IF
S15321       IF  WA-BAD-DEBT-IND-2 > 1
S15321          AND WA-INPUT-PARAM-TABLE (8) = 1
S15321          AND WA-INPUT-PARAM-TABLE (7) <> 1
S15321             MOVE 1    TO WA-MSG-ERR-FLAG
S15321             MOVE 4654 TO WA-OUTPUT-ERR-MSG-NO
S15321             GO TO B099-EXIT
S15321       END-IF
S15321       IF  WA-BAD-DEBT-IND-2 > 1
S15321         AND (( WA-ACT-GROUP = "6" OR "8")
S15321           OR BORM-BAD-DEBT-IND = '59')
S15321             MOVE 1    TO WA-MSG-ERR-FLAG
S15321             MOVE 4144 TO WA-OUTPUT-ERR-MSG-NO
S15321             GO TO B099-EXIT
S15321       END-IF
SC8620     IF  NOT ( BORM-REPAY-SCHED =  "B" OR "F" OR "G" )
SC8620                MOVE 1    TO WA-MSG-ERR-FLAG
SC8620                MOVE 4796 TO WA-OUTPUT-ERR-MSG-NO
SC8620                GO TO B099-EXIT
SC8620     END-IF
SC8620     IF      ( WA-ACT-GROUP = "6" OR "8" )
SC9142*SC8620        AND ( BOIS-ARREARS-CTR  = 0 )
SC9142*SC8620        AND ( BORM-REM-REPAYS  <= 1 )
SC9142*SC9927        AND ( BOIS-ARREARS-CTR + BORM-REM-REPAYS = 1 )
SC9927         AND ( ( BOIS-ARREARS-CTR + BORM-REM-REPAYS = 1 )   OR
SC9927               ( BORM-STAT  = 50  )                         OR
SC9927               ( BOIS-MATURITY-DATE < WA-DMY-1) )
SC7483                MOVE 1    TO WA-MSG-ERR-FLAG
SC7483                MOVE 4794 TO WA-OUTPUT-ERR-MSG-NO
SC7483                GO TO B099-EXIT
SC7483     END-IF
SC7483    END-IF.                                                    
S17197
S17197     IF STRT-AREA-TRN-NO = 10400 OR 10440 OR 17079
S17197                        OR 10722 OR 10723
S17197        PERFORM X920-ALBPS-RTN   THRU X920-EXIT
S17197        IF WA-MSG-ERR-FLAG = 1
S17197           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S17197           GO TO B099-EXIT
S17197        END-IF
S17197     END-IF.
051210*    IF  STRT-AREA-TRN-NO = 12598 OR 12599                               
TB0084     IF  STRT-AREA-TRN-NO = 12598 OR 12599 OR 12695 OR 12696
051220         CALL "BR0009" USING STARTAREA                                   
051230                             SOC-PARAMS                                  
TB0084                             BOIS-RECORD
S17579                             BR0009-LINKAGE
051240         GO TO B099-EXIT.                                                
051250                                                                         
051270     PERFORM B001-B4B5 THRU B001-EXIT.
051280*NBG003
051290*TO BE REMOVED LATER, WHEN BACKDATING IS PERMITTED.
051300*
051310*    IF  WA-INPUT-PARAM-TABLE(8) = 1
051320*    AND BORP-PRIORITY-CODE-ON
051330*          MOVE 1                    TO WA-MSG-ERR-FLAG
051340*          MOVE 2300                 TO WA-OUTPUT-ERR-MSG-NO
051350*          PERFORM E000-COMPLETION-PARA THRU E099-EXIT
051360*          GO TO B099-EXIT.
051370*
051390     IF (WA-INPUT-PARAM-TABLE(11) NOT = 1) OR
051400        (WA-INPUT-PARAM-TABLE(8)      = 1) OR
051410        (WA-INPUT-PARAM-TABLE(25)     = 1) OR
051420        (WA-INPUT-PARAM-TABLE(26)     = 1)
051430         PERFORM B700-ACCT-TYPE-CHECK-PARA THRU B799-EXIT
051440         IF  WA-MSG-ERR-FLAG = 1
051450             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
051460             GO TO B099-EXIT.
051470*
051480     IF  SOC-ACCESS-SECURITY-IND = "N"
051490         GO TO B002-NO-SEC.
051500     IF  WA-INPUT-PARAM-TABLE(2) NOT = 1
051510         GO TO B002-NO-SEC.
051520     IF  WA-INPUT-PARAM-TABLE(24) = 1
051530         GO TO B002-NO-SEC.
051540     IF  STRT-AREA-EFT-TXN
051550     OR  STRT-BATCH-TRICKLE-TXN
051560     OR  STRT-REPOST-TXN                                                  
051570         GO TO B002-NO-SEC.
051580     PERFORM Y200-BORM-SECURITY THRU Y299-EXIT.
051590     IF  WA-MSG-ERR-FLAG = 1
051600         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
051610         GO TO B099-EXIT.
051620*
051640 B001-B4B5.
051660          IF WA-INPUT-PARAM-TABLE(4) = 1 OR
051670             WA-INPUT-PARAM-TABLE(5) = 1
051690** A TXN IS CROSS CURRENCY IF THE TRANSACTING AND ACCT BR IS NOT
051700** THE SAME, OR IF THE CURRENCIES ARE THE SAME (BUT NOT THE LOCAL
051710** CURRENCY), AND COMMISSION OR CHANGE HAS BEEN GENERATED IN THE L    
051720** CURRENCY.
051730           IF  (WA-MULTI-CURR-AMT-CURR-CD NOT
051740               = WA-MULTI-ACCT-CURR-CD )
051750              MOVE "1"       TO STRT-AREA-XCURR-IND
051760           ELSE IF (WA-MULTI-ACCT-CURR-CD NOT
051770                   = SOC-NATIVE-CURRENCY)
051780              IF ((WA-MULTI-COMMISSION NOT = 0) AND
051790                  (SOC-MCURR-COMMISSION-IND = "B"))
051800                 OR ((WA-MULTI-CHANGE NOT = 0) AND
051810                  (SOC-MCURR-CHANGE-IND = "B"))
051820                 MOVE "1"    TO STRT-AREA-XCURR-IND
051830              ELSE
051840                 MOVE "0"    TO STRT-AREA-XCURR-IND
051850           ELSE
051860              MOVE "0"       TO STRT-AREA-XCURR-IND.
051880 B001-EXIT.
051890    EXIT.
051940 B002-NO-SEC.
051950*** 760167 BEGIN ***********************************************
051960*    FOR EFT TRANSACTIONS, DO 'MATCH' PROCESSING, TO CHECK     *
051970*    FOR DUPLICATE REQUESTS OR TO MATCH REVERSALS.             *
051980*    RETROFITTED FROM ING HEL007A                              *
051990****************************************************************
052000*    IF  STRT-AREA-EFT-TXN                                        TB0267
TB0267     IF  (STRT-INT-VALID-FLAG4            AND
TB0267          (WA-INPUT-PARAM-TABLE(23) = 0   OR
TB0267           WA-INPUT-PARAM-TABLE(30) = 1))
052010***                                                                     
052020*** THE FOLLOWING LOGIC IS NO LONGER NEEDED AS THE ATM FIELDS           
052030*** WERE MOVED INTO STRTREST COPYBOOK.                                  
052040*        IF  WA-INPUT-PARAM-TABLE(29) = 1                               
052050*&&&*                                                                   
052060*&&&*    FOR TRANSFERS WE ACCOMODATE THE DUAL ACCOUNTS                  
052070*&&&*                                                                   
052080*            MOVE WA-ATM-FIELDS TO SAVE-WA-ATM-FIELD                    
052090*            MOVE SAVE-WA-ATM-FIELD TO WA-ATM-FIELDS-B                  
052100*            MOVE " " TO WA-ATM-FIELDS-A                                
052110*        END-IF                                                         
052120* NO MATCHING IN EFTM FILE IF TRAN IS 12120,12130,12121 OR 12131
052130             IF STRT-AREA-TRN-NO NOT = 12120 AND 12130 AND
052140                                       12121 AND 12131
SC6472                 AND NOT STRT-BATCH-TRICKLE-TXN
SC6965                 AND NOT STRT-REPOST-TXN
052150                 PERFORM P400-MATCH-CHECK THRU P499-EXIT
052160             END-IF
052170* IF FATAL ERROR
052180             IF  WA-MSG-ERR-FLAG = 1
052190                 PERFORM E000-COMPLETION-PARA THRU E099-EXIT
052200                 GO TO B099-EXIT
052210*            ELSE
052220* IF DUPLICATE TRANSACTION (REQUEST) OR UNMATCHED
052230* (REVERSAL),  SEND REFRESH WITH ERROR CODE,
052240* THEN DROP TRANSACTION
052250*            IF  WA-OUTPUT-ERR-MSG-NO = 459 OR 132
052260*                GO TO B099-EXIT
052270             END-IF
052280     END-IF.
052290******************************************************************
052300* CALLS TO BRHM ADDED HERE. WHEN GEO-STATE READING FROM MEMORY
052310* TABLE IS DEVELOPED, BOTH HERE AND IN0000 EQUIVALENT CODES MUST
052320* BE REPLACED.
052330******************************************************************
052340******READ TRANSACTING BRANCH'S GEO-AREA ******
052350     MOVE BORM-BR-NO TO WA-STORE-HME-BRH.
052360     PERFORM W300-READ-BRHM THRU W399-EXIT.
052370     IF  WA-MSG-ERR-FLAG = 1
052380         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
052390         GO TO B099-EXIT.
052400     MOVE UTBRHMRA-GEO-AREA TO CS0000CA-TR-GEO-AREA
052410                           WA-CHG-TR-STATE.
052430***** READ ACCOUNT HOME BRANCH'S GEO-AREA  *****
052440     MOVE "Y" TO WA-HOME-BR.
052450     PERFORM W300-READ-BRHM THRU W399-EXIT.
052460     IF  WA-MSG-ERR-FLAG = 1
052470         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
052480         GO TO B099-EXIT.
052490     MOVE UTBRHMRA-GEO-AREA TO CS0000CA-HM-GEO-AREA
052500                           WA-CHG-HM-STATE.
052510     MOVE "N" TO WA-HOME-BR.
052530 B003-TRACKING.
052540******************************************************************
052550*
052560*    CALL THE VALIDATION MODULE FOR TRACKING TRANSACTIONS
052570*
052580*    INCLUDE IN B000-CNTL-PARA IMMEDIATELY AFTER BORM MASTER
052590*    RETRIEVAL IF BIT 2 IS SET TO 1
052600*
052610     IF SOC-LOANS-TRACKING-OPTION = "Y"  AND
052620         WA-INPUT-PARAM-TABLE(22) = 1
052630         IF STRT-AREA-TRN-NO = 10901
052640            MOVE WA-INPUT-ACCT-NO TO WA-SAVE-INPUT-ACCT-NO
052650            MOVE WA-LON-ACCT-NO   TO WA-INPUT-ACCT-NO
052660         END-IF
052670       IF   NOT  STRT-REPOST-TXN                                          
052680         CALL "BR0012" USING
052700                             STARTAREA WA-EDIT-MASK
052710         IF STRT-AREA-TRN-NO = 10901
052720            MOVE WA-SAVE-INPUT-ACCT-NO TO WA-INPUT-ACCT-NO
052730         END-IF
052740         IF (WA-OUTPUT-ERR-MSG-NO < 900 AND > 99) OR
052750            (WA-OUTPUT-ERR-MSG-NO > 999)
052760             MOVE 1   TO WA-MSG-ERR-FLAG
052770             GO TO B099-EXIT
052780         END-IF
052790       END-IF                                                             
052800     ELSE
052810     IF (STRT-AREA-TRN-NO NOT < TRAK-CONTROL-LOW) AND
052820        (STRT-AREA-TRN-NO NOT > TRAK-CONTROL-HIGH)
052830           MOVE 1                    TO WA-MSG-ERR-FLAG
052840           MOVE 778                  TO WA-OUTPUT-ERR-MSG-NO
052850           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
052860           GO TO B099-EXIT.
052870******************************************************************
052880******************************************************************
052890*** BIT 23 = 0 MEANS FINANCIAL TRAN
052900*** BIT 5  = 1 MEANS WITHDRAWAL/ADVANCE TRAN
052910*** WE WILL LET TRANS WITH BIT 5 SET GO THRU IF BORM-STAT > 3
052920*** ALSO LET DOWN PAYMENT TRAN GO THRU WHEN BORM-STAT < 4 AND
052930*** PRODUCT IS MURABAHA LOAN.
052950***  IF STRT-AREA-TRN-NO = 12410 OR 12440 OR 12441 OR 10210              
052960     IF STRT-AREA-TRN-NO = 12410 OR 12440 OR 12441 OR 10210 OR           
052970                           11091 OR 11191 OR 16091 OR 16191              
TB0088                           OR 17456 OR 17101
TB0190                           OR WA-CUST-INC-EXP-FEES
052980        NEXT SENTENCE
052990     ELSE
053000       IF  WA-INPUT-PARAM-TABLE(23) = 0
053010* ADDED BY A. SERHAN FROM 4 TO 7.
053020         IF BORM-STAT < 7  AND (BORP-PRINC-REDUCT-IND = 0)
053030           IF WA-INPUT-PARAM-TABLE(5) NOT = 1 AND
053040              NOT WA-DEBIT-REPAY-TRCODE
053050             IF WA-INPUT-PARAM-TABLE(17) NOT = 1
053060               MOVE 139  TO UT0060CA-CALL-ERROR-CODE
053070               PERFORM Y000-OVERRIDABLE-ERROR-CHECK
053080                                       THRU Y090-EXIT
053090               IF WA-MSG-ERR-FLAG = 0
053100                  MOVE 139 TO WA-ERR-MSG-NO
053110               ELSE
053120                  MOVE 139 TO WA-OUTPUT-ERR-MSG-NO
053130                  MOVE 1    TO WA-MSG-ERR-FLAG
053140                  PERFORM E000-COMPLETION-PARA THRU E099-EXIT
053150                  GO TO B099-EXIT.
S11575     IF BORP-YOUBE AND BORM-STAT < 7 AND
S11575        WA-INPUT-PARAM-TABLE(4) = 1
S11575        MOVE 139 TO WA-OUTPUT-ERR-MSG-NO
S11575        MOVE 1 TO WA-MSG-ERR-FLAG
S11575        GO TO B099-EXIT.
053160     IF WA-INPUT-PARAM-TABLE (5) = 1
053170        IF WA-DUMMY-LST-TWO = 70 OR 80
053180           IF WA-INPUT-PARAM-TABLE (25) = 0
053190              MOVE WA-ADV-AMOUNT TO WA-SAVE-ACCT-AMT.
053200*
053210     IF  WA-INPUT-PARAM-TABLE(2) = 1
053220      AND  WA-INPUT-PARAM-TABLE(24) NOT = 1
053230       IF BORM-LOANSAVER-IND = 1
053240         PERFORM B640-LOANSAVER-PARA THRU B649-EXIT
053250         IF WA-MSG-ERR-FLAG = 1
053260             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
053270             GO TO B099-EXIT.
053280     IF  WA-INPUT-PARAM-TABLE(3) = 1
053290         AND  (WA-INPUT-PARAM-TABLE(17) NOT = 1)
053300         AND (WA-INPUT-PARAM-TABLE(18) NOT = 1)
S16866         MOVE BORM-MEMB-CUST-AC    TO   WA-OD-ACCT-NO
053310         PERFORM B600-APPROVED-CHECK-PARA THRU B619-EXIT
053320         IF  WA-MSG-ERR-FLAG = 1
053330             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
053340             GO TO B099-EXIT.
053350     IF  STRT-AREA-TRN-NO = 19500 OR 19510 OR 19520 OR 19530
053360                               OR 10300 OR 19540
053370                          OR 10476
053380         PERFORM T000-PROCESS-LOAN THRU T099-EXIT
053390         IF  WA-MSG-ERR-FLAG = 1
053400             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
053410         END-IF
053420         GO TO B099-EXIT
053430     END-IF.
ST0049* *****************************************************
ST0049* CHECK YOUBE BACKDATE CORR. IS OVER LIMITED ?
ST0049* *****************************************************
ST0049     IF BORP-YOUBE
ST0049        AND WA-INPUT-PARAM-TABLE (8)  = 1
ST0049* GET BIN DATE OF TXN-DATE
ST0049        MOVE WA-REPAY-TXN-DATE   TO   UT0030-DATE-DDMMCCYY
ST0049        PERFORM X610-UT0030-PARA THRU X619-EXIT
ST0049* MOVE UT0030-BINARY-DATE
ST0049        COMPUTE  WA-YOUBE-BKDT-CORR-DAYS = WA-DMY 
ST0049                                 -    UT0030-BINARY-DATE
ST0049        IF  WA-YOUBE-BKDT-CORR-DAYS > BORP-MAX-BKDT-DAYS-ALLOWED
SC9192            AND NOT STRT-REPOST-TXN
ST0049                 MOVE 4171       TO   WA-OUTPUT-ERR-MSG-NO
ST0049                 MOVE 1          TO   WA-MSG-ERR-FLAG
ST0049                 GO              TO   B099-EXIT         
ST0049        END-IF
SC9485*       IF  UT0030-BINARY-DATE < BORM-LST-FIN-DATE        
SC9485*       AND WA-INPUT-PARAM-TABLE (7) NOT = 1              
SC9485*                MOVE 4141       TO   WA-OUTPUT-ERR-MSG-NO
SC9485*                MOVE 1          TO   WA-MSG-ERR-FLAG     
SC9485*                GO              TO   B099-EXIT           
SC9485*       END-IF                                            
SC9302        IF (UT0030-BINARY-DATE <= BOIS-INT-ADJ-DATE) OR
SC9302           (UT0030-BINARY-DATE <= BOIS-PRIN-ADJ-DATE)
SC9302                 MOVE 4759       TO   WA-OUTPUT-ERR-MSG-NO
SC9302                 MOVE 1          TO   WA-MSG-ERR-FLAG
SC9302                 GO              TO   B099-EXIT
SC9302        END-IF
S11649        IF  BOIS-BKDT-LIMIT-FROM-DT > 0                     
S11649        AND BOIS-BKDT-LIMIT-TO-DT > 0                       
S11649            IF  UT0030-BINARY-DATE > BOIS-BKDT-LIMIT-FROM-DT
S11649            AND UT0030-BINARY-DATE < BOIS-BKDT-LIMIT-TO-DT  
S11649                MOVE 5017        TO   WA-OUTPUT-ERR-MSG-NO  
S11649                MOVE 1           TO   WA-MSG-ERR-FLAG       
S11649                GO               TO   B099-EXIT             
S11649            END-IF                                          
S11649            IF  UT0030-BINARY-DATE = BOIS-BKDT-LIMIT-TO-DT  
S11649            AND BOIS-BKDT-LIMIT-TO-DT < BORM-LST-FIN-DATE   
S11649                MOVE 5017        TO   WA-OUTPUT-ERR-MSG-NO  
S11649                MOVE 1           TO   WA-MSG-ERR-FLAG       
S11649                GO               TO   B099-EXIT             
S11649            END-IF                                          
S11649        END-IF                                              
ST0049     END-IF.
S11617     IF NOT BORP-YOUBE
S11617        AND WA-INPUT-PARAM-TABLE (8)  = 1
S11617        AND WA-INPUT-PARAM-TABLE (7)  = 1
S11759        IF WA-INPUT-PARAM-TABLE (25)  = 1
S11759           MOVE WA-DISCH-I-TRAN-DATE TO UT0030-DATE-DDMMCCYY
S11759        ELSE
S11617        MOVE WA-REPAY-TXN-DATE   TO   UT0030-DATE-DDMMCCYY
S11759        END-IF
S11617        PERFORM X610-UT0030-PARA THRU X619-EXIT
S11617        INITIALIZE WA-CON-BKDT-CORR-DAYS
S11617        COMPUTE  WA-CON-BKDT-CORR-DAYS = WA-DMY
S11617                                 -    UT0030-BINARY-DATE
S11617        IF  WA-CON-BKDT-CORR-DAYS > BORP-MAX-BKDT-DAYS-ALLOWED
S11617            AND NOT STRT-REPOST-TXN
S11617            AND BORP-MAX-BKDT-DAYS-ALLOWED > 0
S11617            AND BORP-MAX-BKDT-DAYS-ALLOWED IS NUMERIC
S11759            AND UT0030-BINARY-DATE > 0
S11617                 MOVE 4171       TO   WA-OUTPUT-ERR-MSG-NO
S11617                 MOVE 1          TO   WA-MSG-ERR-FLAG
S11617                 GO              TO   B099-EXIT
S11617        END-IF
S11617     END-IF.
053440*    IF  WA-INPUT-PARAM-TABLE(29) = 1
053450*        GO TO B099-EXIT.
053460     IF  WA-INPUT-PARAM-TABLE(15) = 1
053470     AND (NOT STRT-BATCH-TRICKLE-TXN)
053480         PERFORM C000-PRE-IMAGE-LOG
053490         THRU C099-EXIT
053500         IF  WA-MSG-ERR-FLAG = 1
053510             PERFORM E000-COMPLETION-PARA
053520             THRU E099-EXIT
053530             GO TO B099-EXIT.
TB0152***
TB0152***  CUSTOMER INCOME/EXPENSE FEES COLLECTION
TB0152***
TB0152     IF WA-CUST-INC-EXP-FEES
TB0285     OR WA-RECOLL-COMM
S12794        MOVE BORM-LOAN-BAL TO WA-PRINCIPAL-AMT1
TB0152
ST0038*Return Original Transaction use for Voucher Printing
ST0038*Reverse calculation from ED0000
ST0029        IF WA-OLR-TRAN
ST0038           COMPUTE WS-VCHR-ORG-TRANCODE = WA-REPAY-TRCODE
ST0038                                        + 50000
ST0029        END-IF
TB0152        CALL "UT0028" USING  STARTAREA
TB0152                             SOC-PARAMS
TB0152                             WA-UT28-PARAM
TB0152                             W300-ERROR-AREA
TB0152                             WA-JRNL-CALL-AREA
TB0152                             GL-PASSALONG
TB0152                             WA-PASSALONG
TB0152                             MULTI-OVERRIDE-AREA
TB0152                             CHECK-RESPONSE-AREA
TB0152                             WA-OTHER-SAVE-AREAS
TB0152                             PBOOKCA-LINE-AREA
TB0152                             BOIS-RECORD
TB0152                             BORR-PARAMS
SC3840                             DUMMY-CTAP-RECORD
TB0266                             WA-VOUCHER-EXTENDED-INFO
SC1574
NR2001*SC1574        MOVE 01 TO BORV-01-CODE
NR2001        MOVE 01 TO BOCT-TRAN-TYPE
SC1574        INITIALIZE  WA-COMMISSION-PASSALONG
SC5854        IF WA-MSG-ERR-FLAG = 0
SC5854           PERFORM C000-PRE-IMAGE-LOG   THRU C099-EXIT
SC5854        END-IF
TB0152
TB0152        PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0152        GO TO B099-EXIT
TB0152     END-IF.
TB0152*
053540     IF  WA-INPUT-PARAM-TABLE(17) = 1
053550         OR STRT-AREA-TRN-NO = 12440 OR 12441 OR  12420
053560         PERFORM N000-PROCESS-LOAN-APPROVALS THRU N099-EXIT
053570         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
053580         GO TO B099-EXIT.
053590     IF  WA-INPUT-PARAM-TABLE(21) = 1
053600         AND BORM-NO-NPB > 0
053610         AND (WA-INPUT-PARAM-TABLE(8) NOT = 1)
053620         AND (NOT STRT-AREA-ADVICE)
053630         MOVE "01" TO ST-NPB-CALL-CODE
053640         CALL "BR0002" USING
053660                             STARTAREA
053670                             PBOOKCA-LINE-AREA
053680         IF  ST-STATUS-LEVEL-1 NOT = 00
053690             MOVE 1 TO WA-MSG-ERR-FLAG
053700             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
053710             GO TO B099-EXIT.
053720     IF  STRT-AREA-TRN-NO = 10600
053730         MOVE SPACES TO WA-OUTPUT-MESSAGE
053740         MOVE 0 TO WA-OUTPUT-ERR-MSG-NO
053750         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
053760         GO TO B099-EXIT.
053770*                                                                        
053780*** FORCED INTEREST CAPITALIZATIONS                                      
053790                                                                         
053800                                                                         
053810     IF  STRT-AREA-TRN-NO = 11091 OR 11191 OR                            
053820                            16091 OR 16191                               
053830         CALL "BR0071" USING STARTAREA                                   
053840                             BORR-PARAMS                                 
053850                             SOC-PARAMS                                  
NR2001*053860                             BORV-RECORD-AREA                            
NR2001                             BOCT-RECORD-AREA
053870                                                                         
053880***      IF BORV-RECORD-AREA NOT = LOW-VALUES                            
053890         PERFORM E000-COMPLETION-PARA THRU E099-EXIT                     
053900***      END-IF                                                          
053910         GO TO B099-EXIT                                                 
053920     END-IF.                                                             
053930*                                                                        
053940     IF  (STRT-AREA-TRN-NO = 15073 OR 16051 OR 16052)
053950         IF SOC-LIMIT-PROCESS-IND NOT = "1"
053960            MOVE 1                    TO WA-MSG-ERR-FLAG
053970            MOVE 100                  TO WA-OUTPUT-ERR-MSG-NO
053980            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
053990            GO TO B099-EXIT
054000         END-IF
054010         MOVE WA-INPUT-MESSAGE-AREA TO WA-INPUT-MSG
054020         CALL "BR0054" USING
054040                             STARTAREA
054050                             SOC-PARAMS
NR2001*054060                             BORV-RECORD-AREA
NR2001                             BOCT-RECORD-AREA
054070                             WA-PASSALONG
054080                             MULTI-OVERRIDE-AREA
TB0084                             BOIS-RECORD
054090         MOVE STRT-AREA-LEDG-CODE TO WA-STORE-LEDG-CODE
054100         MOVE BORM-LST-FIN-DATE   TO WA-STORE-LST-FIN-DT
054110         MOVE BORM-NO-PER-TRN     TO WA-STORE-TOT-TRNS
054120         MOVE WA-INPUT-AMT        TO WA-DUMMY-AMT
054130         INITIALIZE  WA-COMMISSION-PASSALONG
054140         MOVE 0                   TO WA-ADV-SUB-LEDG-CODE
054150         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
054160         GO TO B099-EXIT.
SC3189*
SC3189*     MOVE BORM-REM-REPAYS TO WA-TMP-REM-REPAYS.
SC3189*     MOVE BOIS-LAST-ADV-PYMT-DATE TO WA-BOIS-LST-ADV-DTE.
SC3189*     MOVE BOIS-LAST-TERM-PAID TO WA-TMP-LST-TERM-PAID.
SC3189*     IF STRT-AREA-TRN-NO = 13031
SC3189*        PERFORM S550-CHK-ACCT-STATUS THRU S550-EXIT
SC3189*     END-IF.
SC3189*
S11604** CURRENCY PAIR CANN'T REPAYMENT FOR TIF WHEN THE SAME CUSTOMER
S11604     IF   BOIS-TIB-ACCT-IND = "2"
S11604       IF STRT-AREA-TRN-NO = 11044 OR 11045 OR 16044 OR 16045
S11604          MOVE BR0023-DEP-ACC-NO   TO WA-DEP-ACC-NO
S11604          PERFORM S580-TIF-TFR-FROM-DEP THRU S580-EXIT
S11604       END-IF
S11604       IF STRT-AREA-TRN-NO = 13045 OR 15045
S11604          MOVE WA-DEP-TRF-ACCT-NO  TO WA-DEP-ACC-NO
S11604          PERFORM S580-TIF-TFR-FROM-DEP THRU S580-EXIT
S11604       END-IF
S11604       IF WA-MSG-ERR-FLAG  = 1
S11604          PERFORM E000-COMPLETION-PARA  THRU E099-EXIT
S11604          GO TO B099-EXIT
S11604       END-IF
S11604     END-IF.
S20520*S20486 IF WA-MLWM-TXN AND STRT-BANCSLINK
S20520     IF (WA-MLWM-TXN AND STRT-BANCSLINK)
S20520     AND (WA-MSG-ERR-FLAG = 0)
S20486        IF STRT-AREA-TRN-NO = 11044 OR 11045 OR 16044 OR 16045
S20486           MOVE BR0023-DEP-ACC-NO   TO WA-DEP-ACC-NO
S20486        END-IF
S20486        IF STRT-AREA-TRN-NO = 13045 OR 15045
S20486           MOVE WA-DEP-TRF-ACCT-NO  TO WA-DEP-ACC-NO
S20486        END-IF
S20486        IF WA-TFR-FROM-DEP-ACCT
S20486           INITIALIZE UTMLWM-CALL-PARAM
S20486           MOVE "DEP"       TO UTMLWM-FUN
S20486           MOVE STRT-AREA-SOC-NO  TO UTMLWM-SOC-NO
S20486           MOVE WA-DEP-ACC-NO     TO UTMLWM-MEMB-CUST-AC
S20486           CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20486           IF UTMLWM-CALL-STATUS = "00"
S20486              IF UTMLWM-MLWFLAG = "Y"
S20486                 MOVE 1248 TO UT0060CA-CALL-ERROR-CODE
S20486                 PERFORM Y000-OVERRIDABLE-ERROR-CHECK
S20486                 THRU Y090-EXIT
S20486                 IF   WA-MSG-ERR-FLAG = 0
S20486                      MOVE 1248 TO WA-ERR-MSG-NO
S20486                 ELSE
S20486                      MOVE 1248 TO WA-OUTPUT-ERR-MSG-NO
S20486                      MOVE 1    TO WA-MSG-ERR-FLAG
S20486                 END-IF
S20486              END-IF
S20486           END-IF
S20486        END-IF
S20486        IF WA-MSG-ERR-FLAG  = 1
S20486           PERFORM E000-COMPLETION-PARA  THRU E099-EXIT
S20486           GO TO B099-EXIT
S20486        END-IF
S20486     END-IF.
SC2159     IF   STRT-AREA-TRN-NO = 13131 OR 11144 OR 11148
SC2159                                   OR 16144 OR 16148
S11617                                   OR 16129
S17282                                   OR 16102
SC2159          PERFORM S560-REPAY-PRIN-RECALC  THRU S560-EXIT
SC2159          IF WA-MSG-ERR-FLAG = 1
SC2159             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC2159             GO TO B099-EXIT.
S10743     IF  BORP-YOUBE                                         
S10743     AND (STRT-AREA-TRN-NO = 11048 OR 16048 OR 11044        
S10743     OR  16044 OR 13031)                                    
S10743         MOVE 1502                   TO WA-OUTPUT-ERR-MSG-NO
S10743         MOVE 1                      TO WA-MSG-ERR-FLAG     
S10743         PERFORM E000-COMPLETION-PARA THRU E099-EXIT        
S10743         GO TO B099-EXIT                                    
S10743     END-IF.                                                
SC4775*    IF  (WA-INPUT-PARAM-TABLE(4)  = 1
SC4775*                              WA-DEBIT-REPAY-TRCODE)
SC4775     IF WA-INPUT-PARAM-TABLE(4)  = 1
054190     AND WA-INPUT-PARAM-TABLE(25) = 0
TB0223      AND STRT-AREA-TRN-NO NOT EQUAL 17467
054200         PERFORM L000-VALIDATE-REPAYMENTS THRU L099-EXIT
S18788         IF WA-MSG-ERR-FLAG = 1
S18788         AND (WA-OUTPUT-ERR-MSG-NO = 0
S18788          OR  WA-OUTPUT-ERR-MSG-NO < 100
S18788          OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
S18788            DISPLAY "!!BR0000, AFT L000, ERR-"
S18788                    WA-OUTPUT-ERR-MSG-NO
S18788         END-IF
054210         IF  WA-MSG-ERR-FLAG = 1 OR WA-AUTO-DISCH-FLAG = "Y"
054220             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
054230             GO TO B099-EXIT
054240         ELSE
054250             PERFORM N1500-CALC-INT-DUE-DT THRU N1599-EXIT
054260             PERFORM L800-VALIDATE-BANK-REGION THRU L899-EXIT
054270             IF WA-MSG-ERR-FLAG = 1
054280                 PERFORM E000-COMPLETION-PARA THRU E099-EXIT
054290                 GO TO B099-EXIT
054300             ELSE
SC5647                 IF STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048
SC5647                    OR 16044 OR  16048 OR 16144 OR 16148
SC5647                    OR 13131 OR 11144 OR 11148
S11617                    OR 16129
S17282                    OR 16102
S12055                    IF  BOIS-TIB-ACCT-IND = "2"
S12055                    AND BOIS-CREDIT-TYPE = "R"
S12055                    AND BOIS-ARREARS-CTR = 0
S12055                    AND BOIS-PREV-DUE-DATE > 0
S12055                    AND WA-INPUT-PARAM-TABLE(7) = 0
S12055                    AND ((WA-INPUT-PARAM-TABLE(8) = 1 AND
S12055                          BOIS-PREV-DUE-DATE > WA-STORE-TXN-DT)
S12055                      OR (WA-INPUT-PARAM-TABLE(8) = 0 AND
S12055                          BOIS-PREV-DUE-DATE > STRT-AREA-POST-DT))
S12055                        MOVE 1      TO WA-MSG-ERR-FLAG
S12055                        MOVE 1502   TO WA-OUTPUT-ERR-MSG-NO
S12055                        GO TO B099-EXIT
S12055                    END-IF
SC5647                    COMPUTE WA-TOT-TXN-AMT = WA-REPAY-AMOUNT +
SC5647                       BR0023-PENALTY-AMT + BR0023-WAIVE-AMT
SC5647                 END-IF
ST0055                 IF STRT-AREA-TRN-NO = 11010 OR 11045 OR
SC5681                   11046 OR 16010 OR 16045 OR 16046 OR 13031 OR
S10982                   11049 OR 16049
                         MOVE BORM-LOAN-BAL to WA-PRINCIPAL-AMT1
                       ELSE
                        MOVE BR0023-DUE-AMT TO WA-BR0023-DUE-AMT
                        MOVE BR0023-PENALTY-AMT TO
                        BR0023CA-PEN-PRIN-AMT
SC6275                  MOVE BORM-LOAN-BAL TO WA-PRINCIPAL-AMT1  
ST0055                 END-IF
SC7752                 MOVE 0 TO WA-OLD-BOIS-AGREE-INT
S15871*SC7752                 IF BOIS-AGREE-IND = 2
S15871                 IF ( BOIS-AGREE-FUNC-USE )
SC7752                    MOVE BOIS-AGREE-INT-BUCKET
SC7752                                  TO WA-OLD-BOIS-AGREE-INT
SC7752                 END-IF
S11624                 MOVE ZEROES      TO WA-OLD-BOIS-DEF-BUCKET-AMT
S11624                 IF (BOIS-DEF-BUCKET-AMT > 0)
S11624                    MOVE BOIS-DEF-BUCKET-AMT
S11624                                  TO WA-OLD-BOIS-DEF-BUCKET-AMT
S11624                 END-IF
S16579                 MOVE BOIS-ARREARS-CTR
S16579                                  TO WA-ORIGINAL-ARREARS-CTR
SC8921                 IF STRT-AREA-TRN-NO = 14030 OR 14130
SC8921                                    OR 19030 OR 19130
SC8921                    MOVE BORM-BR-NO TO UTVTACCA-TRANSFER-BRANCH
SC8921                 END-IF
SC9454                 IF  (BORM-BAD-DEBT-IND(2:1) > 1)
S10982                 AND (STRT-AREA-TRN-NO = 16045 OR 16046 OR 16049
S11368                                               OR 16010)
S10529                 AND NOT BORP-YOUBE
S16542                  IF STRT-AREA-TRN-NO = 16045
S16542                  AND STRT-BATCH-TXN
S16901**S16542          AND BORM-SPL-LOAN-CDE = '3'
S16901                  AND (BORM-SPL-LOAN-CDE = '3' OR
S16901                      BORP-TIB-CONFER OR BORP-CARD-CONFER)
S16542                      CONTINUE
S16542                  ELSE
SC9454                    MOVE 127  TO WA-OUTPUT-ERR-MSG-NO
SC9454                    MOVE 1    TO WA-MSG-ERR-FLAG
SC9454                    PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC9454                    GO TO B099-EXIT
S16542                  END-IF
SC9454                 END-IF
S20486                 IF  WA-MLWM-TXN
S20486                 AND (STRT-DIB-TXN OR STRT-WEBLOGIC-GRP)
S20486                     INITIALIZE UTMLWM-CALL-PARAM
S20486                     MOVE "LON"       TO UTMLWM-FUN
S20486                     MOVE BORM-SOC-NO       TO UTMLWM-SOC-NO
S20486                     MOVE BORM-MEMB-CUST-AC TO UTMLWM-MEMB-CUST-AC
S20486                     CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20486                     IF UTMLWM-CALL-STATUS = "00"
S20486                        IF UTMLWM-MLWFLAG = "Y"
S20486                           MOVE 1249       TO WA-OUTPUT-ERR-MSG-NO
S20486                           MOVE 1          TO WA-MSG-ERR-FLAG
S20486                           PERFORM E000-COMPLETION-PARA
S20486                           THRU    E099-EXIT
S20486                           GO TO B099-EXIT
S20486                        END-IF
S20486                     END-IF
S20486                 END-IF
S11368                 IF  (WA-ACT-TYPE-790)
S11368                 AND (BORM-BAD-DEBT-IND(2:1) > 1 
S11368                 AND  BORM-BAD-DEBT-IND NOT = 50)
S11368                 AND (WA-INPUT-PARAM-TABLE(8) = 1)
S11368                 AND (WA-INPUT-PARAM-TABLE(7) = 1)
S11368                    MOVE 127  TO WA-OUTPUT-ERR-MSG-NO
S11368                    MOVE 1    TO WA-MSG-ERR-FLAG
S11368                    PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11368                    GO TO B099-EXIT
S11368                 END-IF 
SC9610* BACKDATE CORRECTION PERFORMS THIS FOR CASHIER TOTALS OF THE ORIG TXN
SC9610                 IF ST-LOAN-BACKDATED-CORR-YES
SC9610                    IF WA-INPUT-PARAM-TABLE(14) = 1
SC9610                       PERFORM E300-TELLER-TOT-PARA
SC9610                               THRU E399-EXIT
SC9610                       IF  WA-MSG-ERR-FLAG = 1
SC9610                           GO TO B099-EXIT
SC9610                       END-IF
SC9610                    END-IF
SC9610                 END-IF
S11542                 IF  BORP-YOUBE                              
S11542                 AND BR0000-SYSTEM-IN-NIGHT                  
S11542                 AND WA-INPUT-PARAM-TABLE(8) = 0             
S11542                 AND WA-INPUT-PARAM-TABLE(7) = 0             
S11542                 AND BOIS-LST-FIN-POST-DT < STRT-AREA-POST-DT
S11542                     PERFORM Q300-CALC-INT-DIFF              
S11542                        THRU Q300-EXIT                       
S11542                 END-IF                                      
S12384                 MOVE SPACE TO UT0094CA-PRE-RECEIVE-FLAG
S12384                               UT0094CA-NO-RECALC-FLAG
S12384                 IF  BORP-RECEIVABLE-YES
S12384                     MOVE WA-REPAY-PRN-RECALC
S12384                       TO UT0094CA-PRE-RECEIVE-FLAG
S15509                     MOVE WA-NEW-DUE-AMT TO UT0094CA-DUE-AMT
S12384                 END-IF
S17003                 MOVE BORM-DUE-AMT   TO   SV-BORM-DUE-AMT
S18788                 IF WA-MSG-ERR-FLAG = 1
S18788                 AND (WA-OUTPUT-ERR-MSG-NO = 0
S18788                  OR  WA-OUTPUT-ERR-MSG-NO < 100
S18788                  OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
S18788                    DISPLAY "!!BR0000, BEF BR23, ERR-"
S18788                             WA-OUTPUT-ERR-MSG-NO
S18788                 END-IF
054310                 CALL "BR0023" USING
054330                                 STARTAREA
054340                                 SOC-PARAMS
054350                                 BORR-PARAMS
NR2001*054360                                 BORV-RECORD-AREA
NR2001                                 BOCT-RECORD-AREA
054370                                 WA-INT-ST-DATE
054380                                 WA-PASSALONG
054390                                 UT0270CA-AREA
054400                                 W300-ERROR-AREA
054410                                 CHECK-RESPONSE-AREA
054420                                 MULTI-OVERRIDE-AREA
054430                                 PBOOKCA-LINE-AREA
054440                                 BR0023CA-AREA
SC8085                                 UTVTACCA-CALL-PARAM
TB0027                                 BOIS-RECORD
TB0084                                 UT0094CA-CALL-PARAM
TB0161                                 UT0073CA-CALL-AREA
054450*  760167
S18788                  IF WA-MSG-ERR-FLAG = 1
S18788                  AND (WA-OUTPUT-ERR-MSG-NO = 0
S18788                   OR  WA-OUTPUT-ERR-MSG-NO < 100
S18788                   OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
S18788                     DISPLAY "!!BR0000, AFT BR23, ERR-"
S18788                             WA-OUTPUT-ERR-MSG-NO
S18788                  END-IF
S12384                  IF  BORP-RECEIVABLE-YES
S12384                      MOVE UT0094CA-NO-RECALC-FLAG
S12384                        TO WA-REPAY-PRN-RECALC
S12384                  END-IF
S10578                  IF  BORP-YOUBE                            
S10578                  AND BORM-LOAN-BAL NOT > 0                 
S10578                      MOVE 0         TO BORM-INT-INCR       
S10578                                        BORM-INT-ACCR       
S10578                                        BOIS-INTEREST-DUE   
S10578                                        BOIS-YET-COLLECT-INT
S10578                                        BORM-INT-ADJUSTMENT 
S10578                  END-IF                                    
S10656                  IF BORP-YOUBE                    
S10656                     MOVE BOIS-NEXT-DUE-DATE TO    
S10656                          BOIS-LAST-UNPAID-DUE-DATE
S10656                  END-IF                           
ST0055                  IF STRT-AREA-TRN-NO = 11010 OR 16010
                           OR 11045 OR 11046 OR 16010 OR 16045
SC5681                     OR 16046 OR 13031
SC6541                     OR 16145 OR 16146
SC6542                     OR 16144 OR 16148
S10982                     OR 11049 OR 11149
S10982                     OR 16049 OR 16149
S10542                     OR 16130 OR 16111
S11617                     OR 16129
S17282                     OR 16102
S12394                     OR 16101
S16201                     OR 11030 OR 16030
SC6895                     IF BORM-BAD-DEBT-IND = 02 OR 03 OR 04
SC6895                                         OR 52 OR 53 OR 54
SC6895                                         OR 59
SC8298*SC9292                 OR (BORM-STAT = 50
SC8298*SC9292                 AND UT0094CA-MATURED-SWITCH = 1)
SC6895                        PERFORM D700-NPL-VOUCHER-PRT THRU
SC6895                                            D709-EXIT
SC6895
SC6895                     ELSE
SC7033                      IF BORP-YOUBE
NR2001*SC7033                       PERFORM D450-POPUPATE-BORV THRU D459-EXIT
NR2001                       PERFORM D450-POPUPATE-BOCT THRU D459-EXIT
SC7033                      ELSE
SC6895                       PERFORM D300-POPULATE-BUCKETS THRU 
SC6895                               D309-EXIT
SC6895                       PERFORM D400-POPULATE-FORM77 THRU 
SC6895                               D409-EXIT
SC7033                      END-IF
SC6895                     END-IF
                        ELSE
                         PERFORM D500-POPULATE-PRINCIPAL THRU D509-EXIT
ST0055                  END-IF
SC6581                  IF STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048
SC6581                     OR 16044 OR 16048 OR 16144 OR 16148
SC6581                     OR 13131 OR 11144 OR 11148
S11617                     OR 16129
S17282                     OR 16102
SC6581                     MOVE WA-TOT-TXN-AMT TO VCHR077-TXN-AMT
SC6581                     COMPUTE VCHR077-PENALTY =
SC6581                             BR0023-PENALTY-AMT + BR0023-WAIVE-AMT
S16458                     MOVE WA-REPAY-PRIN-RECALC TO
S16458                                        VCHR077-REPAY-PRN-RECALC
SC6581                  END-IF
S20520*S20486           IF WA-MLWM-TXN AND STRT-BANCSLINK
S20520                  IF (WA-MLWM-TXN AND STRT-BANCSLINK)
S20520                  AND (WA-MSG-ERR-FLAG = 0)
S20486                     INITIALIZE UTMLWM-CALL-PARAM
S20486                     MOVE "LON"       TO UTMLWM-FUN
S20486                     MOVE BORM-SOC-NO       TO UTMLWM-SOC-NO
S20486                     MOVE BORM-MEMB-CUST-AC TO UTMLWM-MEMB-CUST-AC
S20486                     CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20486                     IF UTMLWM-CALL-STATUS = "00"
S20486                        IF UTMLWM-MLWFLAG = "Y"
S20486                           MOVE 1248 TO UT0060CA-CALL-ERROR-CODE
S20486                           PERFORM Y000-OVERRIDABLE-ERROR-CHECK
S20486                           THRU Y090-EXIT
S20486                           IF   WA-MSG-ERR-FLAG = 0
S20486                                MOVE 1248 TO WA-ERR-MSG-NO
S20486                           ELSE
S20486                                MOVE 1248 TO WA-OUTPUT-ERR-MSG-NO
S20486                                MOVE 1    TO WA-MSG-ERR-FLAG
S20486                           END-IF
S20486                        END-IF
S20486                     END-IF
S20486                  END-IF
054460                 IF  WA-MSG-ERR-FLAG = 1
054470                     PERFORM E000-COMPLETION-PARA THRU E099-EXIT
054480                     GO TO B099-EXIT
054490                 END-IF
054500*  ALL CHEQUE DEPOSITS ARE POSTED TO SUSPENSE ACCOUNT ASSOCIATED W   
054510*  LITERAL "OUTWARD CLR"
054530                 IF WA-INPUT-PARAM-TABLE (10) = 1
S10542                  AND NOT ST-LOAN-BACKDATED-CORR-YES
054540                       AND WA-MSG-ERR-FLAG = 0
054550                        PERFORM Q200-POST-SUSP-ACC
054560                                THRU Q299-EXIT-PARA
054570                    IF WA-MSG-ERR-FLAG = 1
054580                       PERFORM E000-COMPLETION-PARA THRU E099-EXIT
054590                       GO TO B099-EXIT
054600                    END-IF
054610                 END-IF
054620*
SC4522                 IF WA-MSG-ERR-FLAG = 0
SC4522                    IF FEDI-BP-TXN
SC4522                       PERFORM FEDI-WRITE-VTPV THRU FEDI-VTPV-EXIT
SC4522                    END-IF
SC4522                    IF WA-MSG-ERR-FLAG = 0
SC4522                       PERFORM FEDI-TXN-PROCESS THRU
SC4522                            FEDI-TXN-EXIT
SC4522                    END-IF
SC4522                 END-IF
SC4522
054630                 IF WA-MSG-ERR-FLAG = 1
054640                     PERFORM E000-COMPLETION-PARA THRU E099-EXIT
054650                     GO TO B099-EXIT
054660                 END-IF
054670*
054680                 PERFORM B3000-CHECK-LIMITS THRU B3099-EXIT
SC3314                 IF STRT-AREA-TRN-NO = 11048 OR 11148
SC2371                                  OR 16048 OR 16148
SC3314                    PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC3314                    GO TO B099-EXIT
SC3314                 END-IF
      * TEST FOR VIRTUAL ACCOUNT
S18566*TB0274          MOVE BORM-ACT-TYPE  TO WS-TEMP-VIRTUAL-TYPE
S18566*TB0274          IF WA-VIRTUAL-ACT-TYPE
S18566*TB0274             PERFORM M1350-MOVE-CREATE-LRTP THRU M1359-EXIT
S18566*TB0274          END-IF
054690*
TB0099                 IF (STRT-AREA-TRN-NO = 11048 OR 16048 OR
SC0796*                                      11148 OR 16148
SC0796                                       11148 OR 16148 OR
SC0796                                       11046 OR 11146
SC1668                                    OR 16046 OR 16146
S10982                                    OR 11049 OR 11149
S10982                                    OR 16049 OR 16149)
S10542                   AND NOT ST-LOAN-BACKDATED-CORR-YES
TB0099                    MOVE STRT-AREA-TRN-NO TO WA-STRT-TRN-NO-TMP
SC1352                    MOVE BORM-RECORD-AREA TO
SC1352                                     WA-SAVE-BORM-RECORD-AREA-GL
SC0796*                   IF STRT-AREA-TRN-NO = 11048 OR 16048
SC0796*                      MOVE 20021 TO WA-DUMMY-GL-TRN-NO
SC0796*                   ELSE
SC0796*                      IF STRT-AREA-TRN-NO = 11148 OR 16148
SC0796*                         MOVE 20121 TO WA-DUMMY-GL-TRN-NO
SC0796*                      END-IF
SC0796*                   END-IF
SC0796                    IF STRT-AREA-TRN-NO = 11048 OR 16048
S10982                                          OR 11046 OR 11049
S10982                                          OR 16046 OR 16049
SC2759                       IF STRT-AREA-TRN-NO = 16046        
SC2759*                         MOVE 26055 TO WA-DUMMY-GL-TRN-NO
SC3842                          MOVE 25055 TO WA-DUMMY-GL-TRN-NO
SC2759                       ELSE                               
S10982                            IF  STRT-AREA-TRN-NO = 11049 OR 16049
S10982                                MOVE  21053 TO WA-DUMMY-GL-TRN-NO
S10982                            ELSE
SC0796*                               MOVE 20050 TO WA-DUMMY-GL-TRN-NO
SC3833                                MOVE 20055 TO WA-DUMMY-GL-TRN-NO
S10982                            END-IF
SC2759                       END-IF
SC0796                    ELSE
SC0796                       IF STRT-AREA-TRN-NO = 11148 OR 16148
S10982                                          OR 11146 OR 11149
S10982                                          OR 16146 OR 16149
SC2759                          IF STRT-AREA-TRN-NO = 16146        
SC2759*                            MOVE 26155 TO WA-DUMMY-GL-TRN-NO
SC3842                             MOVE 25155 TO WA-DUMMY-GL-TRN-NO
SC2759                          ELSE                               
S10982                             IF  STRT-AREA-TRN-NO = 11149 OR 16149
S10982                                 MOVE  21153 TO WA-DUMMY-GL-TRN-NO
S10982                             ELSE
SC0796*                                MOVE 20150 TO WA-DUMMY-GL-TRN-NO
SC3833                                 MOVE 20155 TO WA-DUMMY-GL-TRN-NO
S10982                             END-IF
SC2759                          END-IF
SC0796                       END-IF
SC0796                    END-IF
TB0099                    MOVE WA-DEP-ACCT-NO  TO GLDM-LEDGER-NO
TB0099                    MOVE WA-REPAY-AMOUNT TO WA-SAVE-TXN-AMT
TB0099                    MOVE 0 TO WA-ADV-CHQ-NO
TB0099                    MOVE 0 TO WA-GL-CHQ-NO
TB0099                    MOVE WA-REPAY-PROMO TO WA-INPUT-PROMO
TB0099                    MOVE SOC-NATIVE-CURRENCY TO GLDM-CURRENCY
SC0796*                   PERFORM M200-POST-TO-GL-ACCT THRU M200-EXIT
SC0796                    PERFORM Q200-POST-SUSP-ACC THRU Q299-EXIT-PARA
SC1352                    MOVE WA-SAVE-BORM-RECORD-AREA-GL TO
SC1352                                     BORM-RECORD-AREA
SC0796                    IF WA-MSG-ERR-FLAG = 1
SC0796                       PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC0796                       GO TO B099-EXIT
SC0796                    END-IF
TB0099                    MOVE WA-REPAY-INPUT-ACCT-NO TO
TB0099                             BORM-MEMB-CUST-AC
TB0099                    MOVE WA-TMP-SAVE-TRN-NO TO JNRST-TRAN-CODE
TB0099                    MOVE WA-STRT-TRN-NO-TMP TO LINK-IN-TXCODE
TB0099                    PERFORM X700-CALL-UT0250   THRU X799-EXIT
TB0099                    MOVE LINK-EDIT-TABLE TO STRT-AREA-EDIT-MASK
S10445**COMMENT THE LINES BELOW NARRATIVE TXN IS WRITTEN IN GL0024
TB0099*S10445             IF (LINK-NARR-TXN-TYPE = 36)
TB0099*S10445                 IF WA-DEP-TRF-ACCT-NO IS NUMERIC AND
TB0099*S10445                    WA-DEP-TRF-ACCT-NO NOT = ZERO
TB0099*S10445                    INITIALIZE    GLDV-DATA-REC-36
TB0099*S10445                    MOVE 36   TO GLDV-36-CODE
TB0099*S10445                    MOVE 04   TO GLDV-36-STATUS
TB0099*S10445                    MOVE UPTELLCA-TELLER-BRANCH TO
TB0099*S10445                           GLDV-36-TELL-AND-BR
TB0099*S10445                    MOVE STRT-AREA-TERM-NO TO
TB0099*S10445                              GLDV-36-BRTERM
TB0099*S10445                    IF WA-INPUT-PARAM-TABLE(8) = 1
TB0099**S10445                      MOVE WA-TMP-TXN-DTE TO
SC9582*S10445                       MOVE WA-REPAY-TXN-DATE   
SC9582*S10445                         TO   UT0030-DATE-DDMMCCYY
SC9582*S10445                       PERFORM X610-UT0030-PARA 
SC9582*S10445                              THRU X619-EXIT
SC9582*S10445                       MOVE UT0030-BINARY-DATE TO
TB0099*S10445                               GLDV-36-POST-DATE
TB0099*S10445                    ELSE
TB0099*S10445                       MOVE STRT-AREA-POST-DT TO
TB0099*S10445                               GLDV-36-POST-DATE
TB0099*S10445                    END-IF
TB0099*S10445                    MOVE STRT-AREA-JRNL-NO TO
TB0099*S10445                          GLDV-36-JRNL-NO
TB0099*S10445                    MOVE WA-DUMMY-AMT      TO
TB0099*S10445                          GLDV-36-AMOUNT
TB0099*S10445                    MOVE "T"               TO
TB0099*S10445                          GLDV-36-DESC
TB0099*S10445                    MOVE STRT-AREA-TRN-NO  TO
TB0099*S10445                          GLDV-36-TRN-CODE
TB0099*S10445                    MOVE WA-REPAY-INPUT-ACCT-NO  TO
TB0099*S10445                          GLDV-36-ACCOUNT-NO
TB0099*S10445                    MOVE WA-DEP-TRF-ACCT-NO TO
TB0099*S10445                          DBIO-12-ACCT-NO
TB0099*S10445                    IF WA-NARR-TRF-ACCT-SYS = SPACES
TB0099*S10445                        MOVE "GLD"             TO
TB0099*S10445                             GLDV-36-SYSTEM
TB0099*S10445                    ELSE
TB0099*S10445                       MOVE WA-NARR-TRF-ACCT-SYS TO
TB0099*S10445                             GLDV-36-SYSTEM
TB0099*S10445                    END-IF
TB0099*S10445                    MOVE "GEN" TO
TB0099*S10445                          DBIO-12-SYSTEM
TB0099*S10445                    PERFORM M201-ADD-NEW-TXN THRU M201-EXIT
TB0099*S10445                    IF WA-MSG-ERR-FLAG = 1
TB0099*S10445                       GO TO B099-EXIT
TB0099*S10445                    END-IF
SC0847*S10445                END-IF
TB0099*S10445             END-IF
SC3174                 END-IF
SC3174*                ELSE
TB0232                    IF BOIS-LAST-TERM-PAID >=
SC0847                      (BORM-LOAN-TRM - BORM-REM-REPAYS)
SC0847                       AND BOIS-ARREARS-CTR  = 0
SC0847                       AND (STRT-AREA-TRN-NO NOT = 11044  
SC1128                                             AND   13031
SC0847                                             AND   11048
SC0847*S12384                                      AND   16030
SC0847                                             AND   16044
SC0847                                             AND   16048)
SC1341                       AND WA-INPUT-PARAM-TABLE (7) = 0
SC1779                       AND BOIS-LAST-ADV-PYMT-DATE
SC1779                                        > STRT-AREA-POST-DT
SC0847                       MOVE 0              TO BORM-INT-ACCR
SC1227                                              BORM-INT-ADJUSTMENT
SC0847                    END-IF
SC3174*                END-IF
054700                 PERFORM E000-COMPLETION-PARA THRU E099-EXIT
054710                 IF  WA-OUTPUT-ERR-MSG-NO = 0 AND
054720                     STRT-AREA-TRN-NO = 10121
054730                     PERFORM F100-PREP-LETTER THRU F199-EXIT
054740                 END-IF
054750                 IF  WA-MSG-ERR-FLAG = 0
054760                     PERFORM M1200-CAP-BAL-DTLS THRU M1299-EXIT
054770*                    PERFORM E000-COMPLETION-PARA THRU E099-EXIT
054780                 END-IF
ST0071                 IF STRT-AREA-BATCH-TANDEM = "B" AND
ST0071                    STRT-AREA-CHARGE-IND = "R"
ST0071                    PERFORM BA100-PROCESS-REMIT-FEE
ST0071                                         THRU BA109-EXIT
ST0071                 END-IF
054790                 GO TO B099-EXIT
054800             END-IF
054810         END-IF
054820     END-IF.
054830     IF  (STRT-AREA-TRN-NO = 10072)
054840      OR ((STRT-AREA-TRN-NO = 10071 OR 15071)
054850            AND (WA-ADV-LOC-ACCT-NO NOT = 0))
054860         CALL "BR0044" USING
054880                             STARTAREA
054890                             SOC-PARAMS
NR2001*054900                             BORV-RECORD-AREA
NR2001                             BOCT-RECORD-AREA
054910                             WA-PASSALONG
054920                             MULTI-OVERRIDE-AREA
TB0084                             BOIS-RECORD
054930         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
054940         GO TO B099-EXIT.
054950     IF WA-INPUT-PARAM-TABLE (5) = 1 AND
054960        WA-INPUT-PARAM-TABLE (10) = 1 AND
054970        WA-DUMMY-LST-TWO NOT = 90
054980        PERFORM V900-GET-SUSPENSE THRU V999-EXIT
054990        IF WA-MSG-ERR-FLAG = 1
055000           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
055010           GO TO B099-EXIT.
055020*SL  MOVE "1"    TO GL-DONT-WRITE-GLDM-IND.
055030* 760167
055040*    IF  WA-INPUT-PARAM-TABLE(5) = 1
055050     IF  WA-INPUT-PARAM-TABLE(5) = 1 AND
055060         WA-INPUT-PARAM-TABLE(25) = 0
055070         PERFORM M000-VALIDATE-ADVANCES THRU M099-EXIT
TB0157*
TB0157         IF WA-MSG-ERR-FLAG = ZERO
S12770            IF (STRT-AREA-TRN-NO = 11057 OR 16057 OR
S12770                                   11157 OR 16157)
S12770            AND STRT-BANCSLINK
S12770            AND BORP-CONSMR AND BORP-REORG-CREDIT-PROD
S15672            AND NOT WA-LOAN-ACCT-Y
S12770                INITIALIZE UTVTACCA-CALL-PARAM
S12770                MOVE 6            TO UTVTACCA-CALL-CODE
S12770                MOVE WA-INPUT-AMT TO UTVTACCA-DEPOSIT-AMT
S12770                MOVE WA-VIR-AC-FOR-REORG-AC TO
S12770                     UTVTACCA-VIRTUAL-ACCT-NO
S12770                CALL "UTVTAC"  USING STARTAREA
S12770                               UTVTACCA-CALL-PARAM
S12770                IF UTVTACCA-RET-STATUS  = 0
S12770                   MOVE 7      TO UTVTACCA-CALL-CODE
S12770                   MOVE WA-INPUT-AMT  TO UTVTACCA-DEPOSIT-AMT
S12770                   MOVE "ORGPROD"     TO UTVTACCA-TRANS-DESC
S12770                   CALL "UTVTAC" USING STARTAREA
S12770                                 UTVTACCA-CALL-PARAM
S12770                   IF UTVTACCA-RET-STATUS  <> 0
S12770                      MOVE 1           TO WA-MSG-ERR-FLAG
S12770                      MOVE UTVTACCA-ERROR-MSG-NO TO
S12770                           WA-OUTPUT-ERR-MSG-NO
S12770                      PERFORM E000-COMPLETION-PARA
S12770                                    THRU E099-EXIT
S12770                      GO TO B099-EXIT
S12770                   END-IF
S12770                ELSE
S12770                   MOVE 1         TO WA-MSG-ERR-FLAG
S12770                   MOVE UTVTACCA-ERROR-MSG-NO TO
S12770                        WA-OUTPUT-ERR-MSG-NO
S12770                   PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S12770                   GO TO B099-EXIT
S12770                END-IF
S12770            END-IF
TB0157            IF BORM-INS-IND = 2
TB0157               AND WA-INPUT-PARAM-TABLE(29) = 1
SC9759               IF STRT-AREA-TRN-NO = 11155 OR 16155
SC9759                CONTINUE
SC9759               ELSE
TB0157                PERFORM V100-INSURANCE-PREMUIM THRU V199-EXIT
SC9759               END-IF
TB0157            END-IF
SC4522            IF FEDI-BP-TXN
SC4522               PERFORM FEDI-WRITE-VTPV THRU FEDI-VTPV-EXIT
SC4522            END-IF
SC4522            IF WA-MSG-ERR-FLAG = 0
SC4522               PERFORM FEDI-TXN-PROCESS THRU
SC4522                            FEDI-TXN-EXIT
SC4522            END-IF
TB0157         END-IF
TB0157*
055080         GO TO B099-EXIT.
055090     IF  STRT-AREA-TRN-NO = 10440 OR 10442 OR 10450
055100                                           OR 10451
055110                                           OR 10401                     
055120         PERFORM W200-FIND-DATE-FILE THRU W299-EXIT
055130         IF WA-MSG-ERR-FLAG = 1
055140            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
055150            GO TO B099-EXIT
055160         ELSE
055170              MOVE BORM-APPRV-DATE TO DATE1                              
055180              CALL "BR0011" USING
055200                                  STARTAREA
055210                                  BORR-PARAMS
055220                                  DATE1
TB0069                                  BOIS-RECORD
055230*                                 WS-OL-APPL-FLAG                        
055240              GO TO B099-EXIT.
TB0215**
TB0215*** FSLON0045 - YAKEE
TB0215**
TB0215     IF  STRT-AREA-TRN-NO EQUAL 10724 OR 10726
TB0215         IF INPUT-10724-ACCT-NO NOT EQUAL SPACES AND
TB0215            INPUT-10724-ACCT-NO NOT EQUAL ZEROES AND
TB0215            STRT-AREA-TRN-NO EQUAL 10724
TB0215            PERFORM B620-FETCH-MASTER THRU
TB0215                    B629-EXIT
TB0215            IF  WA-MSG-ERR-FLAG = 1
TB0215                PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0215                GO TO B099-EXIT
TB0215            END-IF
S17197            PERFORM X920-ALBPS-RTN THRU X920-EXIT
S17197            IF  WA-MSG-ERR-FLAG = 1
S17197                PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S17197                GO TO B099-EXIT
S17197            END-IF
TB0215         END-IF
TB0215         IF INPUT-10726-ACCT-IND EQUAL "A" AND
TB0215            STRT-AREA-TRN-NO EQUAL 10726
TB0215            PERFORM B620-FETCH-MASTER THRU
TB0215                    B629-EXIT
TB0215            IF  WA-MSG-ERR-FLAG = 1
TB0215                PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0215                GO TO B099-EXIT
TB0215            END-IF
S17197            PERFORM X920-ALBPS-RTN THRU X920-EXIT
S17197            IF  WA-MSG-ERR-FLAG = 1
S17197                PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S17197                GO TO B099-EXIT
S17197            END-IF
TB0215         END-IF
TB0215     END-IF.
TB0215*
ST0115     IF STRT-AREA-TRN-NO = 10705 OR 10706
S11323                        OR 10707 OR 10708 OR 10709
ST0115         PERFORM W200-FIND-DATE-FILE THRU W299-EXIT
ST0115         IF  WA-MSG-ERR-FLAG = 1
ST0115             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
ST0115             GO TO B099-EXIT
ST0115         ELSE
ST0115             CALL "BR0056" USING
ST0115                                       STARTAREA
ST0115                                       DATE1
ST0115                                       BOIS-RECORD
SC9044*             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
ST0115             GO TO B099-EXIT.
055250     IF  STRT-AREA-TRN-NO = 10700 OR 10710 OR 10711 OR 10712
055260                         OR 10701 OR 10702 OR 10703 OR 10704              
TB0215                         OR 10722 OR 10723 OR 10724 OR 10725
S12068*TB0215                         OR 10726 OR 10727 OR 10728
S12068                         OR 10726 OR 10727 OR 10728 OR 10729
055280         PERFORM W200-FIND-DATE-FILE THRU W299-EXIT
055290         IF  WA-MSG-ERR-FLAG = 1
055300             PERFORM E000-COMPLETION-PARA THRU E099-EXIT
055310             GO TO B099-EXIT
055320         ELSE
055330             IF  STRT-AREA-TRN-NO = 10700 AND
055340                 BORM-BAD-DEBT-IND > 1
055350                 MOVE 326 TO WA-OUTPUT-ERR-MSG-NO
055360                 MOVE 1 TO WA-MSG-ERR-FLAG
055370                 PERFORM E000-COMPLETION-PARA THRU E099-EXIT
055380                 GO TO B099-EXIT
055390             ELSE
055400                 IF  STRT-AREA-TRN-NO = 10701 AND                         
055410                     BORM-BAD-DEBT-IND > 1                                
055420                     MOVE 326 TO WA-OUTPUT-ERR-MSG-NO                     
055430                     MOVE 1 TO WA-MSG-ERR-FLAG                            
055440                     PERFORM E000-COMPLETION-PARA THRU E099-EXIT          
055450                     GO TO B099-EXIT                                      
055460                 ELSE                                                     
055470                 MOVE BORM-APPRV-DATE TO DATE1
055480                 IF BR0005-DEVICE-TYPE = "I" AND
055490                    (STRT-AREA-TRN-NO = 10700 OR 10712
055500                                     OR 10701 OR 10704)                   
055510                    CALL "BR0055" USING
055520                                       STARTAREA
055530                                       DATE1
055540                    GO TO B099-EXIT
055550                 ELSE
SC8879                    IF STRT-AREA-TRN-NO = 10722
SC8879                       AND BORM-STAT < 7
SC8879                       MOVE 139 TO WA-OUTPUT-ERR-MSG-NO
SC8879                       MOVE 1 TO WA-MSG-ERR-FLAG
SC8879                       PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC8879                       GO TO B099-EXIT
SC8879                    END-IF
TB0215                    MOVE ZEROES        TO BR0005-JOURNAL-FLAG
055560                    CALL "BR0005" USING
055580                                       STARTAREA
S12068                                       MULTI-OVERRIDE-AREA                
055590                                       DATE1
TB0215                                       BOIS-RECORD
TB0215                                       BR0005-MISC-VARIABLE
S12068                    IF STRT-AREA-TRN-NO EQUAL 10729 AND 
S12068                       ST-STATUS-LEVEL-1 NOT EQUAL ZEROES 
S12068                       MOVE 1 TO WA-MSG-ERR-FLAG 
S12068                    ELSE 
TB0215                      IF STRT-AREA-TRN-NO EQUAL 10725 AND
TB0215                         OUTPUT-10725-ERROR NOT EQUAL ZEROES
TB0215                         MOVE 326 TO WA-OUTPUT-ERR-MSG-NO
TB0215                         MOVE 1 TO WA-MSG-ERR-FLAG
TB0215                     PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0215                      ELSE
TB0215                         IF STRT-AREA-TRN-NO EQUAL 10725 AND
TB0215                            BR0005-JOURNAL-FLAG  NOT EQUAL ZEROES
TB0215                            PERFORM Z10725-JNRST-RTN THRU
TB0215                                    Z10725-JNRST-EXIT
TB0215                         END-IF
TB0215                         IF STRT-AREA-TRN-NO EQUAL 10726 AND
TB0215                            BR0005-JOURNAL-FLAG  NOT EQUAL ZEROES
TB0215                            PERFORM Z10726-JNRST-RTN THRU
TB0215                                    Z10726-JNRST-EXIT
TB0215                         END-IF
TB0215                      END-IF
S12068                    END-IF
055600                    GO TO B099-EXIT.
SC6383*    FOR DISCHARGE - PDC VOUCHER PRINTING
SC6383     MOVE SPACES TO VCHR077-DISCH-PDC.
055610     IF  WA-INPUT-PARAM-TABLE(25) = 1
055620         PERFORM N500-PROCESS-DISCHARGES THRU N599-EXIT
TB0069         IF WA-MSG-ERR-FLAG = 1
TB0069            GO TO B099-EXIT
TB0069         END-IF
055630         PERFORM B3000-CHECK-LIMITS THRU B3099-EXIT
055640         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
NLB115         PERFORM I100-CALL-UT9998     THRU I199-EXIT
055660         IF STRT-AREA-TRN-NO NOT = 32110
055670            GO TO B099-EXIT
055680         ELSE
NR2001*055690            PERFORM F000-READ-BORV THRU F099-EXIT
NR2001            PERFORM F000-READ-BOCT THRU F099-EXIT
055700            IF WA-MSG-ERR-FLAG = 1
055710               GO TO B099-EXIT
055720            ELSE
055730               PERFORM F100-PREP-LETTER THRU F199-EXIT
055740               GO TO B099-EXIT.
055750     IF  STRT-AREA-TRN-NO = 17054 OR 17004 OR 17055 OR 17005 OR
055760                           17056 OR 17006 OR 17057 OR 17007 OR
055770                           17058 OR 17008 OR 17059 OR 17009 OR
055780                           17060 OR 17010 OR 10490 OR 17061 OR
055790                           17011 OR 17062 OR 17012 OR 17063 OR
055800                           17013 OR 17064 OR 17014 OR 17065 OR
055810                           17015 OR 17066 OR 17016 OR 17067 OR
055820                           17017 OR 17077 OR 17027 OR 19425 OR
055830                           19426
055840         CALL "BR0015"  USING
055860                              STARTAREA
S12147                              BOIS-RECORD
055870         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
055880         GO TO B099-EXIT.
055890     IF  STRT-AREA-TRN-NO = 17068 OR 17018 OR 17069 OR 17019 OR
055900                           17070 OR 17020 OR 17071 OR 17021 OR
055910                           17072 OR 17022 OR 17073 OR 17023 OR
055920                           17074 OR 17024 OR 17075 OR 17025
TB0069                                          OR 17076 OR 17026
TB0198                                          OR 17033
TB0223                        OR 17034 OR 17466 OR 17467
S10074         IF BORP-YOUBE                         
S10074         AND STRT-AREA-TRN-NO = 17034          
S10074              MOVE 307  TO WA-OUTPUT-ERR-MSG-NO
S10074              MOVE 1    TO WA-MSG-ERR-FLAG     
S10074              GO TO B099-EXIT                  
S10074         END-IF                                
TB0069         IF STRT-AREA-TRN-NO = 17076 OR 17026
69IR32**--start
TB0069*           IF  BOIS-NEGO-RATE-IND NOT = "1"
TB0069*           AND BOIS-NEGO-RATE-IND NOT = "2"
TB0069            IF  BOIS-NEGO-RATE-IND NOT = "2"
69IR32**--end  
TB0069              MOVE 4259 TO WA-OUTPUT-ERR-MSG-NO
TB0069              MOVE 1    TO WA-MSG-ERR-FLAG
TB0069              GO TO B099-EXIT
TB0069            END-IF
TB0069         END-IF
TB0223
TB0223         IF  (WA-REPAY-SUB-LEDG-CODE < 1 OR
TB0223           WA-REPAY-SUB-LEDG-CODE > 30)
TB0223           AND STRT-AREA-TRN-NO = 17467
TB0223             MOVE 1 TO WA-MSG-ERR-FLAG
TB0223             MOVE 194 TO WA-OUTPUT-ERR-MSG-NO
TB0223             GO TO B099-EXIT
TB0223         END-IF
S11177                                                                
S11177         IF STRT-AREA-TRN-NO = 17467                            
S11177            MOVE BOIS-DEF-INT-END-DTE TO WA-BOIS-DEF-INT-END-DTE
S11177         END-IF                                                 
TB0223
055930         CALL "BR0068"  USING
055950                              STARTAREA
055960                              UT0290CA-CALL-AREA
055970                              BORR-PARAMS                               
TB0069                              BOIS-RECORD
TB0223                              WA-PASSALONG
TB0223                              PBOOKCA-LINE-AREA
TB0198                              MULTI-OVERRIDE-AREA
SC5286*        MOVE WA-OUTPUT-ERR-MSG-NO     TO   WA-SAVE-UT0068-MSG-NO
SC6172         PERFORM C000-PRE-IMAGE-LOG THRU C099-EXIT
SC1605**SC5059 IF BOIS-AGREE-IND = 2
SC1605**SC5059  AND STRT-AREA-TRN-NO = 17022
S15871*SC5059   IF  (BOIS-AGREE-IND = 2 AND STRT-AREA-TRN-NO = 17022)
S15871          IF (BOIS-AGREE-FUNC-USE AND STRT-AREA-TRN-NO = 17022)
SC5059          OR (BOIS-AGREE-IND = 0 AND STRT-AREA-TRN-NO = 17033)
SC1605            PERFORM H000-CALC-INT THRU H099-EXIT
SC1605            IF WA-MSG-ERR-FLAG = 1
SC1605               GO TO B099-EXIT
SC1605            END-IF
SC1605         END-IF
SC3865         MOVE "N" TO WA-UPDATE-INT-INCR         
SC3865         IF BOIS-NEGO-RATE-IND = 2              
SC3865          AND STRT-AREA-TRN-NO = 17026          
SC3865          AND NOT BORP-YOUBE                    
SC5219          AND BORM-STAT > 06
S11843          AND BORM-STAT <> 50
SC3865            PERFORM NEGO-RATE-SET               
SC3865               THRU NEGO-RATE-SET-EXIT          
SC3865            IF WA-MSG-ERR-FLAG = 1              
SC3865               GO TO B099-EXIT                  
SC3865            END-IF                              
SC3865            PERFORM H000-CALC-INT THRU H099-EXIT
SC3865            IF WA-MSG-ERR-FLAG = 1              
SC3865               GO TO B099-EXIT                  
SC3865            END-IF                              
SC3865         END-IF                                 
S16588         IF  STRT-AREA-TRN-NO     = 17026
S16588         AND BORM-STAT        = 01
S16588         AND WA-17026-ACTION  = SPACES
S16588           PERFORM  G100-PREPARE-17085 THRU G100-EXIT
S16588         END-IF
SC6189         IF STRT-AREA-TRN-NO = 17467
SC6189            MOVE BORM-LOAN-BAL TO WA-PRINCIPAL-AMT1
SC6189*SC7749     PERFORM D300-POPULATE-BUCKETS THRU D309-EXIT
SC7749            MOVE SPACE  TO VCHR-FRM077
SC7749            PERFORM D250-READ-BUCKETS THRU D250-EXIT
SC6189            PERFORM D600-POPULATE-FORM77 THRU D609-EXIT
SC6189         END-IF
055980         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC2882         IF WA-MSG-ERR-FLAG = 0
SC2882            MOVE 0   TO STRT-AREA-IEXEC-CNTL
SC2882         END-IF
055990         GO TO B099-EXIT.
056000*
S16343     IF  STRT-AREA-TRN-NO   =  17200
S16343       PERFORM  Q000-AMOUNT-VALIDATION THRU Q009-EXIT
S16343       IF WA-MSG-ERR-FLAG   =  1
S16343         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S16343         GO                TO  B099-EXIT
S16343       END-IF
S16343     END-IF.
S16343
056010     IF  STRT-AREA-TRN-NO = 17029
NR2001*056020         PERFORM Q100-ADD-BORV-46 THRU Q199-EXIT.
NR2001         PERFORM Q100-ADD-BOCT-46 THRU Q199-EXIT.
056030*
S17736*S17326     IF  STRT-BANCSLINK
S17736*S17326     AND WA-MSG-ERR-FLAG           =  0
S17736*S17326     AND (STRT-AREA-TRN-NO         =  12000 OR 17000)
S17736*S17326     AND WA-TR-NA-SO-AUTO-DBT-ACCNO > 0
S17736*S17326         MOVE WA-TR-NA-SO-AUTO-DBT-ACCNO TO INVM-MEMB-CUST-AC
S17736*S17326         PERFORM B1000-READ-INVM    THRU B1999-EXIT
S17736*S17326         IF DBIO-CALL-STATUS = "****"
S17736*S17326         AND INVM-CURR-STATUS = '01'
S17736*S17326            MOVE 2                 TO  UT9000-CALL-CODE
S17736*S17326            MOVE SPACES            TO  UT9000-CALL-STATUS
S17736*S17326            MOVE STRT-AREA-SOC-NO  TO  UT9000-INST-NO
S17736*S17326            MOVE "IN0000"          TO  UT9000-CALLING-ID
S17736*S17326            MOVE SOC-LANGUAGE-CODE TO  UT9000-LANGUAGE-CODE
S17736*S17326            MOVE 15                TO  UT9000-REPORT-NO
S17736*S17326            MOVE 5                 TO  UT9000-SEQUENCE-NO
S17736*S17326            PERFORM U9100-RETRIEVE-TEXT THRU  U9199-EXIT
S17736*S17326            IF  UT9000-CALL-STATUS   =  "0"
S17736*S17326                MOVE "02"          TO  UT0082-CALL-CODE
S17736*S17326                MOVE "Y"           TO  UT0082-NEW-LINE-FLAG
S17736*S17326                MOVE UT9000-SOURCE-LENGTH TO UT0082-MSG-LENGTH
S17736*S17326                MOVE UT9000CA-SOURCE-DATA TO UT0082-MSG-TEXT
S17736*S17326                CALL "UT0082"     USING  UT0082-CALL-AREA
S17736*S17326                                  STARTAREA
S17736*S17326                IF UT0082-CALL-STATUS = ZEROS
S17736*S17326                   MOVE "09"         TO UT0082-CALL-CODE
S17736*S17326                   CALL "UT0082"  USING UT0082-CALL-AREA
S17736*S17326                                   STARTAREA
S17736*S17326                END-IF
S17736*S17326            END-IF
S17736*S17326         END-IF
S17736*S17326     END-IF.
056040     IF  STRT-AREA-TRN-NO = 12000 OR 17050 OR
056050                           17000 OR 17001 OR 17002 OR
TB0169                           12006 OR 12007 OR 12008 OR
TB0169                           17036 OR 17037 OR 17038 OR
056060                           17450 OR 17451 OR 17053 OR
056070                           17003 OR 17051 OR 17052 OR
056080                           17029 OR 17465 OR 17043 OR
056090                           17044 OR 17094 OR 17045 OR
056100                           17046 OR 10312 OR                            
056110*                          17081 OR 17082 OR 17083                      
TB0165                           17081 OR 17082 OR 17083 OR                     
TB0165*                          17032 OR 17035 OR
SC1223                           17035 OR
TB0095                           17081 OR 17082 OR 17083 OR
TB0095                           17084 OR 17085 OR
TB0105                           17047 OR 17039 OR 17099
TB0159                        OR 12009
TB0219                        OR 17100
TB0255                        OR 10915 OR 10916
SC9987                        OR 17200
S12328                        OR 17300
S15600                        OR 17204
S18279                        OR 17205
               IF STRT-AREA-TRN-NO = 17050
MICAH              MOVE SPACE TO O17047-JRNL-STAT
BCSON          END-IF
SC5868         MOVE WA-INPUT-ACCT-NO    TO  WA-SAVE-INPUT-ACCT-NO
S12078         MOVE BORM-ACT-TYPE       TO  WA-17200-OLD-ACT-TYPE
S12078         MOVE BORM-CAT            TO  WA-17200-OLD-CAT
S16484         MOVE BORM-APP-AMT        TO  WA-SAVE-APP-AMT
056120                           
056130         CALL "BR0001" USING
056150                             STARTAREA
056160                             BORR-PARAMS
056170                             UT0290CA-CALL-AREA
056180                             BR0001-CALL-AREA
056190                             MULTI-OVERRIDE-AREA
TB0027                             BOIS-RECORD
SC1959                             UT0073CA-CALL-AREA
S11778                             BR0032CA-CALL-PARAM
S16484         MOVE BORM-ACT-TYPE    TO  WA-BORM-ACT-TYPE
S16484         IF (STRT-AREA-TRN-NO = 12000 OR 17000)
S16484         AND WA-ACT-TYPE-PERSONAL
S16484             IF  WA-TR-NA-APPLN-AMT > BORP-MAX-LOAN
S16484             AND WA-TR-NA-APPLN-AMT <> WA-SAVE-APP-AMT
S16484                 IF STRT-AREA-BATCH-TANDEM = 0
S16484                    MOVE 4298 TO UT0060CA-CALL-ERROR-CODE
S16484                    PERFORM Y000-OVERRIDABLE-ERROR-CHECK
S16484                    THRU Y090-EXIT
S16484                    IF  WA-MSG-ERR-FLAG = 0
S16484                        MOVE 4298 TO WA-ERR-MSG-NO
S16484                    ELSE
S16484                        MOVE 4298 TO WA-OUTPUT-ERR-MSG-NO
S16484                        MOVE 1    TO WA-MSG-ERR-FLAG
S16484                    END-IF
S16484                 END-IF
S16484             END-IF
S16484         END-IF
S11778         IF  STRT-AREA-TRN-NO = 17047
S12371         OR (STRT-AREA-TRN-NO = 17200
S12417*S12371         AND STRT-TRICKLE-TXN
S15871*S12417         AND (STRT-TRICKLE-TXN OR BR0001CA-BILLING)
S15871         AND (STRT-TRICKLE-TXN OR BR0001CA-BILLING
S15871                               OR BR0001CA-ADJUST)
S12371         AND WA-17200-FUNC = "10")
S15846         OR (STRT-AREA-TRN-NO = 17200
S15846         AND WA-17200-FUNC = "AA"
S15955*S15846  AND BR0032CA-AMC-PROMO-CODE
S15955         AND BR0032CA-PROMO-CODE(1) = "DE"
S15846         AND STRT-TRICKLE-TXN        )
S15043*S12363  OR (STRT-AREA-TRN-NO = 17200 AND WA-17200-FUNC = "11")
S15043         OR ( STRT-AREA-TRN-NO = 17200
S17432         AND (WA-17200-FUNC = "11" OR "15" OR "A1" OR "A3" OR
S20687                              "A5" OR "A6" OR "A7" OR "A8" OR
S20687                              "A9" ))
S20687*S19351                              "A5" OR "A6" OR "A7" OR "A8"))
S19351*S17432                              "A5" OR "A6"))
S17432*S17301  AND (WA-17200-FUNC = "11" OR "15" OR "A1" OR "A3"))
S17301**S17121 AND (WA-17200-FUNC = "11" OR "15" OR "A1"))
S17121**S15043 AND (WA-17200-FUNC = "11" OR "15"))
S11778             MOVE "BOR"                TO UT0094CA-SYSTEM
S11778             MOVE BR0032CA-BUCKETS-TXN TO UT0094CA-BUCKETS-TXN
S11778             MOVE BR0032CA-BUCKETS-AMT TO UT0094CA-BUCKETS-AMT
S11778             MOVE BR0032CA-BALANCES-AFTER-POST TO
S11778                              UT0094CA-BALANCES-AFTER-POST
S15955             MOVE BR0032CA-PROMO-CODE-AREA TO
S15955                  UT0094CA-PROMO-CODE-AREA
S11778         END-IF
S12078         MOVE BORM-ACT-TYPE       TO  WA-17200-NEW-ACT-TYPE
S12078         MOVE BORM-CAT            TO  WA-17200-NEW-CAT
S17464         IF   STRT-AREA-TRN-NO    =   17200
S17464         AND  WA-17200-FUNC       =   "25"
S17464              PERFORM G300-FORMAT-MICV THRU G399-EXIT
S17464              PERFORM V300-RESET-CUSM  THRU V399-EXIT
S17464         END-IF
SC6497**
SC6497         IF WS-BRCH-ACCT-CHANGE
                  MOVE WA-INPUT-ACCT-NO TO VCHR055-LOAN-ACCT-NO
                  MOVE WA-IN-17046-OLD-BRANCH TO
                       VCHR055-EDTL-HOME-BRCH
                  MOVE WA-IN-17046-NEW-BRANCH TO
                       VCHR055-NDTL-HOME-BRCH
SC9797            IF NOT BORP-YOUBE                                   
SC9797             AND WA-IN-17046-OLD-BRANCH = WA-IN-17046-NEW-BRANCH
SC9797             AND ((BORM-INT-RATE       =  0                     
SC9797             AND BOIS-NEGO-RATE-IND  = "0")                     
SC9797             OR  (BOIS-NEGO-RATE-IND  = "2"                     
SC9797             AND BOIS-NEGO-RATE-FLAG = "2" ))                   
SC9797               PERFORM H000-CALC-INT                            
SC9797                  THRU H099-EXIT                                
SC9797            END-IF                                              
               END-IF
SC6497***end
SC2241*        IF   WA-OUTPUT-ERR-MSG-NO NOT = 0
SC3712         IF (WA-OUTPUT-ERR-MSG-NO < 900 AND > 99) OR
SC3712            (WA-OUTPUT-ERR-MSG-NO > 999)
SC2241            MOVE 1                 TO WA-MSG-ERR-FLAG
SC2241         END-IF
SC8774
SC8774*SC9469  IF BORP-YOUBE
SC8774*SC9469    AND STRT-AREA-TRN-NO = 17047
S11274*SC9469         IF (BORP-YOUBE OR BORP-CONSMR-MORT-COMBI)
S11274         IF (BORP-YOUBE OR BORP-CONSMR-MORT-COMBI OR BORP-CONSMR)
SC9469            AND STRT-AREA-TRN-NO = 17047
SC8774            IF CUSM-CUST-ACCT-NO NOT = BORM-CUSTOMER-NO
SC8774               MOVE STRT-AREA-SOC-NO     TO CUSM-SOC-NO
SC8774               MOVE BORM-CUSTOMER-NO TO CUSM-CUST-ACCT-NO
SC8774               MOVE "CUSM" TO DBIO-CALL-SYS-AREA
SC8774               MOVE CUSM-KEY TO DBIO-CALL-KEY-AREA
SC8774               MOVE 71 TO DBIO-CALL-FUNC
SC8774               CALL "DBIO" USING
SC8774                               DBIO-CALL-PARAM
SC8774                               DBIO-CALL-SYS-AREA
SC8774                               DBIO-CALL-KEY-AREA
SC8774                               DBIO-CALL-STATUS
SC8774                               CUSM-RECORD-AREA
SC8774               IF DBIO-CALL-STATUS NOT = "****"
SC8774                  MOVE 282 TO WA-OUTPUT-ERR-MSG-NO
SC8774                  MOVE 1 TO WA-MSG-ERR-FLAG
SC8774               END-IF
SC8774            END-IF
SC9469            IF WA-MSG-ERR-FLAG = 0 AND
SC9469               CUSM-REJECTED-STATUS = 1
SC8774
SC8774            MOVE 0             TO ST-STATUS-LEVEL-1
SC8774                                  WA-MSG-ERR-FLAG
SC8774            MOVE 3539          TO UT0060CA-CALL-ERROR-CODE
SC8774            PERFORM Y000-OVERRIDABLE-ERROR-CHECK
SC8774               THRU Y090-EXIT
SC8774            IF WA-MSG-ERR-FLAG NOT = 0
SC8774                  MOVE 1          TO WA-MSG-ERR-FLAG
SC8774                                     ST-STATUS-LEVEL-1
SC8774            END-IF
SC9469            END-IF
SC8774         END-IF
SC5868*        MOVE WA-INPUT-ACCT-NO    TO  WA-SAVE-INPUT-ACCT-NO
056200         MOVE  BORM-CURRENCY-IND  TO  WS-SAVE-TXN-CURRENCY
056210* SET UP TXN DATE TO PASS TO UT0069
NR2001*056220         INITIALIZE BORV-01-DETAIL
NR2001*056230         MOVE STRT-AREA-POST-DT TO BORV-01-TRN-DATE
NR2001         INITIALIZE BOCT-RECORD-AREA
NR2001         MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE
056240         PERFORM C000-PRE-IMAGE-LOG   THRU C099-EXIT
056250         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC4446         IF WA-MSG-ERR-FLAG = 0 AND STRT-AREA-TRN-NO = 12000
SC4446            PERFORM F200-DO-NEW-REFRESH THRU F299-EXIT
SC4446         END-IF
TB0169*
TB0169         IF  (STRT-AREA-TRN-NO    = 12000 OR 17000
TB0169                                 OR 12006 OR 17036
TB0169                                 OR 12007 OR 17037
TB0169                                 OR 12008 OR 17038)
TB0169         AND (WA-MSG-ERR-FLAG  = 0)
TB0169            PERFORM G0000-PREP-NEXT-SCRN THRU G0099-EXIT
TB0219            IF WA-MSG-ERR-FLAG = 1
TB0219               PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0219               GO TO B099-EXIT
TB0169            END-IF
TB0169         END-IF
TB0169*
TB0169***
TB0069***      IF  STRT-AREA-TRN-NO    = 12000
TB0069***      AND BOIS-NEGO-RATE-IND = "2"
TB0069***      AND WA-MSG-ERR-FLAG NOT = 1
TB0069***         PERFORM G000-PREPARE-17026 THRU G999-EXIT
TB0069***         GO TO B099-EXIT
TB0143***      ELSE
TB0143***      IF  STRT-AREA-TRN-NO  = 17000
TB0143***      AND BR0001CA-CHG-FAC
TB0143***      AND WA-MSG-ERR-FLAG NOT = 1
TB0143*TB0169      MOVE WA-TR-NA-FAC-NO-16
TB0143*TB0169           TO BR0090CA-CALL-FACILITY-NO
TB0169         IF  (STRT-AREA-TRN-NO  = 17036 OR 17037 OR 17038)
TB0169         AND WA-MSG-ERR-FLAG NOT = 1
TB0169             MOVE SPACES TO WA-CHG-FAC-IND
TB0169             IF BORP-CONSMR OR BORP-CONSMR-MORT-COMBI
TB0169                MOVE WA-12006-CHG-FAC-IND  TO WA-CHG-FAC-IND
TB0169                MOVE WA-12006-FAC-NO-16    
TB0169                     TO BR0090CA-CALL-FACILITY-NO
TB0169             ELSE 
TB0169                IF BORP-COMML
TB0169                   MOVE WA-12007-CHG-FAC-IND  TO WA-CHG-FAC-IND
TB0169                   MOVE WA-12007-FAC-NO-16    
TB0169                        TO BR0090CA-CALL-FACILITY-NO
TB0169                END-IF
TB0169             END-IF
TB0169             MOVE WA-CHG-FAC-IND TO BR0001CA-CHG-FAC-IND
TB0169             IF BR0001CA-CHG-FAC
TB0143                MOVE WA-TR-NA-INPUT-ID TO BR0090CA-CALL-ID-NO
TB0143                CALL "BR0090" USING    STARTAREA
TB0143                                       SOC-PARAMS
TB0143                                       BORR-PARAMS
TB0143                                       BR0090CA-CALL-AREA
TB0143                GO TO B099-EXIT
TB0169             END-IF
TB0069         END-IF
056260         IF  WA-MSG-ERR-FLAG = 1       OR
056270             STRT-AREA-TRN-NO = 12000  OR
TB0169                                12006  OR
TB0169                                12007  OR
TB0169                                12008  OR
056280                                17000  OR
056290                                17001  OR
056300                                17002  OR
TB0169                                17036  OR
TB0169                                17037  OR
TB0169                                17038  OR
056310                                17450  OR
056320                                17451  OR
056330                                17003  OR
056340                                17465  OR
056350                                17029  OR
SC1223*                               17032  OR
TB0105                                17035  OR
056360                                17043  OR
056370                                17039  OR
056380                                17044  OR
056390                                17045  OR
056400                                17046  OR
TB0105                                17047  OR
TB0105                                17099  OR
056410                                10312  OR                               
056420                                17081  OR                               
056430                                17082  OR                               
056440                                17083  OR
TB0095                                17083  OR
TB0095                                17085  OR
TB0159                                12009
TB0219                             OR 17100
TB0255                             OR 10915
tb0255                             OR 10916
SC9987                             OR 17200
S12328                             OR 17300
S15600                             OR 17204
S18279                             OR 17205
056450                GO TO B099-EXIT
056460              ELSE
056470                  IF ST-STATUS-LEVEL-1  NOT = ZERO
056480                     GO TO B099-EXIT
056490                  ELSE
056500                      PERFORM D000-SEND-NEXT-TRK-SCREEN
056510                          THRU D099-EXIT
056520                      GO TO B099-EXIT.
S15466     IF  NOT BORP-YOUBE
S15466     AND BR0000-SYSTEM-IN-NIGHT
S15466     AND STRT-AREA-TRN-NO = (14400 OR 10400)
S15466         INITIALIZE UT0086CA-AREA
S15466         MOVE 01 TO UT0086CA-CALL-CODE
S15466         CALL "UT0086" USING UT0086CA-CALL-AREA
S15466                             STARTAREA
S15466                             BORM-RECORD-AREA
S15466                             BOIS-RECORD
S15466                             BORR-PARAMS
S15466     END-IF
056530     IF  STRT-AREA-TRN-NO = 10400 OR 10405 OR 10410 OR
056540                           10420 OR
056550                           10470 OR 10471 OR
056560                           10720 OR
TB0096                           10230 OR
TB0081                           17452 OR 
TB0081                           17453 OR 17079 OR
TB0161                           17086 OR 17087 OR 17088 OR 17089 
TB0159                           OR 10460
TB0102                           OR 13005
TB0267                           OR 14400
ST0170                           OR 17201 OR 17202 OR 17203
S19524                           OR 17211 OR 17212 OR 17213
S19705                           OR 17215
S20318                           OR 17216
056570         CALL "BR0018" USING
056590                             STARTAREA
056600                             BORR-PARAMS
TB0069                             BOIS-RECORD
056610         GO TO B099-EXIT.
TB0096     IF STRT-AREA-TRN-NO = 10231
TB0096        PERFORM BC100-PROCESS-BUCKETS THRU BC099-EXIT
TB0096        GO TO B099-EXIT
TB0096      END-IF.
TB0096*
056620     IF  STRT-AREA-TRN-NO = 10421
056630         CALL "UT0016" USING
056650                             STARTAREA
056660                             SOC-PARAMS
FNSSSK****     PERFORM E000-COMPLETION-PARA THRU E099-EXIT
FNSSSK****     GO TO B099-EXIT.
FNSSSK         GO TO B099-PRE-EXIT.
056700     IF  STRT-AREA-TRN-NO = 10422
056710         IF IN10422-I-FROM-DATE = 0
056720            MOVE BORM-APPRV-DATE          TO UT0020-BINARY-DATE
056730            MOVE 1                        TO UT0020-FUNCTION
056740            PERFORM X600-UT0020-PARA THRU X609-EXIT
056750            MOVE UT0020-DATE-DDMMCCYY TO IN10422-I-FROM-DATE
056770         END-IF
056790         CALL "UT0018" USING
056810                             STARTAREA
SC1278                             SOC-DISP-DATE-FORMAT
056820         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
056830         GO TO B099-EXIT.
056840     IF  STRT-AREA-TRN-NO = 10800 OR 10801
056850         CALL "CO2000" USING
056870                             STARTAREA
056880         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
056890         GO TO B099-EXIT.
056900     IF  STRT-AREA-TRN-NO = 10461 OR 10478
056910         CALL "BR0019" USING
056930                             STARTAREA
056940         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
056950         GO TO B099-EXIT.
056960     IF  STRT-AREA-TRN-NO = 10445
056970         CALL "BR0040" USING
056990                             STARTAREA
057000         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057010         GO TO B099-EXIT.
057020     IF  STRT-AREA-TRN-NO = 17078 OR 17028
057030         CALL "BR0026" USING
057050                             STARTAREA
057060         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057070         GO TO B099-EXIT.
SC2046     IF  STRT-AREA-TRN-NO = 17468 OR 17469
               CALL "BR0091" USING
                             STARTAREA
               PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC2046         GO TO B099-EXIT.
057080     IF  STRT-AREA-TRN-NO = 17090 OR 17040 OR 17041 OR 17042
057090         CALL "BR0027" USING
057110                             STARTAREA
057120                             WA-BLDV-AREA-WW
057130                             BORR-PARAMS
057140                             SOC-PARAMS
057150         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057160         GO TO B099-EXIT.
057170     IF  STRT-AREA-TRN-NO = 12120 OR 12130 OR 12121 OR 12131
057180         PERFORM L300-SET-ATM-FLAG  THRU  L399-EXIT
057190         PERFORM E000-COMPLETION-PARA  THRU  E099-EXIT
057200         GO TO B099-EXIT.
057210     IF  STRT-AREA-TRN-NO = 12410
057220         PERFORM O100-CANCEL-LOAN THRU O199-EXIT
S15519         IF  WA-CANC-REAS-CODE  = 01
S15519             MOVE "Z" TO BOIS-LOANER-CLOSE-IND
S15519         END-IF
057230         MOVE 10 TO BORM-STAT
S15779         PERFORM G300-FORMAT-MICV THRU G399-EXIT
S15779         IF WA-MSG-ERR-FLAG = 1
S15779            GO TO B099-EXIT
S15779         END-IF
057240         PERFORM F100-PREP-LETTER THRU F199-EXIT
057250         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
NLB115         PERFORM I100-CALL-UT9998  THRU  I199-EXIT
SC7443         PERFORM S100-CALL-ATM THRU S100-CALL-ATM-EXIT
057270         GO TO B099-EXIT.
057280     IF  STRT-AREA-TRN-NO = 12476 OR 12576
057290         PERFORM S100-ADJ-BASIC-BAL THRU S199-EXIT
057300         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057310         GO TO B099-EXIT.
057320*
057330***  ARREARS/ADJUSTMENT ENQUIRY IS NOT REQUIRED
057340***  THEREFORE WA-INPUT-ENQ-CODE IS SET TO ZERO
057350*
057360     IF  STRT-AREA-TRN-NO = 12477 OR 12577
057370         PERFORM S300-ADJ-ARR-ADV THRU S399-EXIT
057380         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057390         GO TO B099-EXIT.
057400     IF  STRT-AREA-TRN-NO = 13031 OR 13131 OR
057410                           13032 OR 13132 OR
057420                           13050 OR 13150 OR
057430                           13503 OR 13504 OR
057440                           13033 OR 13133 OR
057450                           13034 OR 13134 OR
057460                           13035 OR 13135 OR
057470                           13051 OR 13151 OR
057480                           13052 OR 13152 OR
057490                           13053 OR 13153 OR
057500                           10730 OR 10750 OR                             
057510                           10731 OR 10751                                
057520         PERFORM S500-PRINCIPAL-DEBIT-CREDIT THRU S599-EXIT
057530         PERFORM B3000-CHECK-LIMITS THRU B3099-EXIT
057540         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057550         GO TO B099-EXIT.
057560*
057570     IF  STRT-AREA-TRN-NO = 10732
S12794         MOVE BORM-LOAN-BAL TO WA-PRINCIPAL-AMT1
057580         PERFORM S800-INTEREST-ADJUSTMENT THRU S809-EXIT
057590         PERFORM E000-COMPLETION-PARA     THRU E099-EXIT
057600         GO TO B099-EXIT.
057610                                                                          
SC9302     IF  STRT-AREA-TRN-NO = 10832 OR 10872
S11111                         OR 10882 OR 10892 OR 10862
S11151                         OR 10893
S10725*S11111                  OR 10882 OR 10892
S10725*                        OR 10892         
S12794         MOVE BORM-LOAN-BAL TO WA-PRINCIPAL-AMT1
S10925         IF  BORP-YOUBE
SC9302             CALL "BR0038"     USING
SC9302                                 STARTAREA
SC9302                                 SOC-PARAMS
SC9302                                 BORR-PARAMS
SC9302                                 WA-PASSALONG
SC9302                                 BOIS-RECORD
SC9302                                 BR0038CA-CALL-PARAM
SC9808                                 WA-VOUCHER-EXTENDED-INFO
S10925         ELSE
S12067          IF STRT-AREA-TRN-NO = 10872
S12067             CALL "BR0038"     USING
S12067                                 STARTAREA
S12067                                 SOC-PARAMS
S12067                                 BORR-PARAMS
S12067                                 WA-PASSALONG
S12067                                 BOIS-RECORD
S12067                                 BR0038CA-CALL-PARAM
S12067                                 WA-VOUCHER-EXTENDED-INFO
S12067          ELSE
S10925             MOVE 127  TO WA-OUTPUT-ERR-MSG-NO
S10925             MOVE 1    TO WA-MSG-ERR-FLAG
S12067          END-IF
S10925         END-IF
SC9302         IF WA-MSG-ERR-FLAG = 0
SC9302           MOVE "BOR"                TO UT0094CA-SYSTEM
SC9302           MOVE BR0038CA-BUCKETS-TXN TO UT0094CA-BUCKETS-TXN
SC9302           MOVE BR0038CA-BUCKETS-AMT TO UT0094CA-BUCKETS-AMT
SC9302           MOVE BR0038CA-BALANCES-AFTER-POST TO
SC9302                                  UT0094CA-BALANCES-AFTER-POST
SC9302         END-IF
SC9302         PERFORM E000-COMPLETION-PARA     THRU E099-EXIT
SC9302         GO TO B099-EXIT.
057620     IF  STRT-AREA-TRN-NO = 10733                                         
057630         PERFORM S900-TOM-ACRU-ADJUSTMENT THRU S909-EXIT                  
057640         PERFORM E000-COMPLETION-PARA     THRU E099-EXIT                  
057650         GO TO B099-EXIT.                                                 
057660*
S10614*057670 IF STRT-AREA-TRN-NO = 19091 OR 19092 OR 19093 OR 19094 OR
S10614     IF  STRT-AREA-TRN-NO = 19091 OR 19092 OR 19094 OR 
057680*TB0168                    19096 OR 19097
TB0168                           19096 OR 19097 OR 19098 OR 19099
057690         CALL "BR0003" USING
057700                             STARTAREA
057710                             UT0290CA-CALL-AREA
S12332                             WA-PASSALONG
057720         PERFORM M1200-CAP-BAL-DTLS THRU M1299-EXIT
057730         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057740         GO TO B099-EXIT.
S10614*
S11874*S10614     IF  STRT-AREA-TRN-NO = 19093 OR 19095 OR 11740 OR 11742
S11874*S10614         PERFORM BD100-CHECK-RTN      THRU BD100-EXIT
S11874*S10614         IF ( WA-MSG-ERR-FLAG         =    1 )
S11874*S10614              IF ( STRT-FEP-ATM-TXN              )
S11874*S10614              OR ( STRT-AREA-TRN-NO   =    11740 )
S11874*S10614                   CALL "MI0098"      USING STARTAREA
S11874*S10614                                           WA-PASSALONG
S11874*S10614                                           WA-FEP-OUTBOUND
S11874*S10614              END-IF
S11874*S10614              PERFORM E100-FMT-SEND-PARA   THRU E199-EXIT
S11874*S10614              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11874*S10614              GO                      TO   B099-EXIT
S11874*S10614         END-IF
S11874*S10614         CALL "BR0003" USING
S11874*S10614                             STARTAREA
S11874*S10614                             UT0290CA-CALL-AREA
S11874*S10614         IF ( STRT-FEP-ATM-TXN                   )
S11874*S10614         OR ( STRT-AREA-TRN-NO        =    11740 )
S11874*S10614         OR ( STRT-AREA-TRN-NO        =    11742 )
S11874*S10614              CALL "MI0098"           USING STARTAREA
S11874*S10614                                           WA-PASSALONG
S11874*S10614                                           WA-FEP-OUTBOUND
S11874*S10614         END-IF
S11874*S10614         PERFORM M1200-CAP-BAL-DTLS   THRU M1299-EXIT
S11874*S10614         IF ( STRT-FEP-ATM-TXN                   )
S11874*S10614         OR ( STRT-AREA-TRN-NO        =    11740 )
S11874*S10614         OR ( STRT-AREA-TRN-NO        =    11742 )
S11874*S10614              PERFORM E100-FMT-SEND-PARA   THRU E199-EXIT
S11874*S10614         END-IF
S11874*S10614         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11874*S10614         GO                           TO   B099-EXIT
S11874*S10614     END-IF.
S10614*
S11874** PRE AUTH TRANS NO NEED CALL "BR0003" SET HOLD AMOUNT
S10614     IF  STRT-AREA-TRN-NO = 11741
S10614      IF STRT-FEP-ATM-TXN
S10614         PERFORM BE100-11741-RTN      THRU BE100-EXIT
S10614         CALL    "MI0098"             USING STARTAREA
S10614                                      WA-PASSALONG
S10614                                      WA-FEP-OUTBOUND
S11874         IF (WA-MSG-ERR-FLAG = 1)
S11874            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11874         ELSE
S10614            PERFORM E100-FMT-SEND-PARA   THRU E199-EXIT
S10614            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11874         END-IF
S10614         GO                           TO   B099-EXIT
S10614      END-IF
S10614     END-IF.
S10614*
S11874* FIX SET HOLD TRANS PROCESS STRUCTURE
S11874     IF  STRT-AREA-TRN-NO = 19093 OR 19095 OR 11740 OR 11742
S11874         PERFORM BD100-CHECK-RTN THRU BD100-EXIT
S11874         IF  WA-MSG-ERR-FLAG  = 0
S11874             CALL "BR0003"      USING STARTAREA
S11874                                      UT0290CA-CALL-AREA
S12332                                      WA-PASSALONG
S11874             IF ST-STATUS-LEVEL-1 NOT = ZERO
S11874                MOVE 1               TO WA-MSG-ERR-FLAG
S11874             END-IF
S11874         END-IF
S11874         IF  STRT-FEP-ATM-TXN
S17209         OR  STRT-BIZTALK-CR-CARD-TXN
S17209         OR  STRT-AREA-TRN-NO = 11740
S11874             CALL "MI0098"      USING STARTAREA
S11874                                      WA-PASSALONG
S11874                                      WA-FEP-OUTBOUND
S11874         END-IF
S11874         IF WA-MSG-ERR-FLAG = 1
S11874            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11874         ELSE
S11874            PERFORM M1200-CAP-BAL-DTLS   THRU M1299-EXIT
S11874            IF STRT-FEP-ATM-TXN
S17209            OR STRT-BIZTALK-CR-CARD-TXN
S11874               PERFORM E100-FMT-SEND-PARA   THRU E199-EXIT
S11874               PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11874            ELSE
S11874               PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S11874            END-IF
S11874         END-IF
S15187         MOVE WA-FEP-INPUT-AREA   TO WA-INPUT-MSG
S11874         GO  TO   B099-EXIT
S11874     END-IF.
S11874
057750     IF  STRT-AREA-TRN-NO = 10210 OR 10220 OR 10310
057760         PERFORM S600-SHARE-DEP THRU S699-EXIT
057770         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057780         GO TO B099-EXIT.
057790     IF  STRT-AREA-TRN-NO = 10500
057800         PERFORM S700-CARRY-FORWARD-PB
057810         THRU S799-EXIT
057820         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057830         GO TO B099-EXIT.
057840     IF  STRT-AREA-TRN-NO = 10901 OR 10903 OR 10951 OR 10953
057850                            OR 10971 OR 10973 OR 899
057860         PERFORM X400-FORMAT-SDCV-CALL THRU X499-EXIT
057870         GO TO B099-EXIT.
057880*
057890     IF  STRT-AREA-TRN-NO = 10775
057900         PERFORM P100-AMD-CHR-FIELDS THRU P199-EXIT
057910         GO TO B099-EXIT.
057920*
057930     IF  STRT-AREA-TRN-NO = 10770
057940         PERFORM P300-FMT-TXN775 THRU P399-EXIT
057950         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
057960         GO TO B099-EXIT.
057970*
057980     IF  STRT-AREA-TRN-NO = 12095 OR 17095 OR 17096 OR 17097
057990         CALL "UT0195" USING
058000                            STARTAREA
058010         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
058020         GO TO B099-EXIT.
058030*
058040     IF  STRT-AREA-TRN-NO = 12090 OR 12091 OR 17091
058050                         OR 17092 OR 17093
058060         MOVE 2 TO UT0197-CALL-CODE
058070         CALL "UT0197" USING
058080                       UT0197-CALL-CODE
058090                       STARTAREA
058100         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
058110         GO TO B099-EXIT.
058120*
058130******************************************************************
058140*
058150*    CALL THE SYSTEM MAINTENANCE MODULE FOR THE TRACKING FACILITY
058160*
058170*    INCLUDE IN B000-CNTL-PARA AS AN INDEPENDENT TRANSACTION
058180*    PROCESSING FUNCTION.
058190*
058200     IF SOC-LOANS-TRACKING-OPTION = "Y" AND
058210         STRT-AREA-TRN-NO NOT < TRAK-CONTROL-DATA-LOW AND
058220         STRT-AREA-TRN-NO NOT > TRAK-CONTROL-DATA-HIGH
058230         CALL "BR0016" USING
058250
058260                              STARTAREA
058270         IF (WA-OUTPUT-ERR-MSG-NO < 900 AND > 99) OR
058280            (WA-OUTPUT-ERR-MSG-NO > 999)
058290             MOVE 1   TO WA-MSG-ERR-FLAG
058300             GO TO B099-EXIT
058310         END-IF
058320         GO TO B099-EXIT.
058330******************************************************************
058340*
058350*    CALL THE TRACKING FACILITY CONTROL MODULE
058360*
058370*    INCLUDE IN B000-CNTL-PARA AS AN INDEPENDENT TRANSACTION
058380*    PROCESSING FUNCTION FOR TRACKING CONTROL TRANSACTIONS
058390*
058400     IF SOC-LOANS-TRACKING-OPTION = "Y"  AND
058410         WA-INPUT-PARAM-TABLE(22) = 1
058420        IF  NOT  STRT-REPOST-TXN                                          
058430            CALL "BR0013" USING
058450                             STARTAREA
058460            IF (WA-OUTPUT-ERR-MSG-NO < 900 AND > 99) OR
058470               (WA-OUTPUT-ERR-MSG-NO > 999)
058480                MOVE 1   TO WA-MSG-ERR-FLAG
058490                GO TO B099-EXIT
058500            END-IF
058510        END-IF                                                            
058520        GO TO B099-EXIT.
TB0088******************************************************************
TB0088     IF STRT-AREA-TRN-NO = 17455  OR  17456
TB0088            CALL "BR0088" USING
TB0088
TB0088                                STARTAREA
TB0088                                BORR-PARAMS
TB0088                                SOC-PARAMS
TB0088                                BOIS-RECORD
TB0088        IF (WA-OUTPUT-ERR-MSG-NO < 900 AND > 99) OR
TB0088           (WA-OUTPUT-ERR-MSG-NO > 999)
TB0088           MOVE 1   TO WA-MSG-ERR-FLAG
TB0088           GO TO B099-EXIT
TB0088        END-IF
TB0088        PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0088        GO TO B099-EXIT
TB0088     END-IF.
TB0143*--- Link/Delink facility to/from account.
TB0143     IF STRT-AREA-TRN-NO = 17101
TB0143        CALL "BR0090" USING STARTAREA
TB0143                            SOC-PARAMS
TB0143                            BORR-PARAMS
TB0143                            BR0090CA-CALL-AREA
TB0143        GO TO B099-EXIT.
TB0143*---
058530******************************************************************
058540     PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
058550 B099-EXIT.
058560*****************************************************************
058570* RELOCATED CHARGE RELATED CODING STARTS HERE                    *
058580*****************************************************************
058590*
SC1514* MARK WARNING MSG
SC2380**ADDING THE PROCESS FOR DAILY CASH LIMIT WARNING MESSAGE ******
SC2380*    IF  (STRT-AREA-TRN-NO = 11010 OR 11060 OR 13010 OR 13031)
SC2380*    AND (WA-REPAY-AMOUNT NOT < SOC-DCSH-LIMT-DR)
SC2380*        MOVE WA-OUTPUT-MESSAGE TO WS-SAVE-OUTPUT-MESSAGE
SC2380*        MOVE SPACES            TO WA-OUTPUT-MESSAGE
SC2380*        IF (STRT-AREA-TRN-NO = 11010 OR 13010 OR 13031)
SC2380*           MOVE 3347           TO UT9000-REPORT-NO
SC2380*        END-IF
SC2380*        IF (STRT-AREA-TRN-NO = 11060)
SC2380*           MOVE 3348           TO UT9000-REPORT-NO
SC2380*        END-IF
SC2380*        MOVE 2                 TO UT9000-CALL-CODE
SC2380*        MOVE SPACES            TO UT9000-CALL-STATUS
SC2380*        MOVE STRT-AREA-SOC-NO  TO UT9000-INST-NO
SC2380*        MOVE "ERM"             TO UT9000-CALLING-ID
SC2380*        MOVE SOC-LANGUAGE-CODE TO UT9000-LANGUAGE-CODE
SC2380*        MOVE 1                 TO UT9000-SEQUENCE-NO
SC2380*        PERFORM U9100-RETRIEVE-TEXT  THRU  U9199-EXIT
SC2380*        IF UT9000-CALL-STATUS  NOT = "0"
SC2380*           MOVE SPACES         TO WA-OUTPUT-WARNING-MSG-TEXT
SC2380*        ELSE
SC2380*           MOVE UT9000RA-LINE1 TO WA-OUTPUT-WARNING-MSG-TEXT
SC2380*        END-IF
SC2380*        MOVE 998               TO WA-OUTPUT-ERR-MSG-NO
SC2380*        MOVE 50                TO WA-OUTPUT-MSG-LENGTH
SC2380*        MOVE 08                TO WA-INPUT-MSG-TYPE
SC2380*        CALL "FT0000"          USING  STARTAREA
SC2380*        MOVE 03                TO WA-INPUT-MSG-TYPE
SC2380*        MOVE 0                 TO WA-OUTPUT-ERR-MSG-NO
SC2380*        MOVE SPACES            TO WA-OUTPUT-MESSAGE
SC2380*        MOVE WS-SAVE-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE
SC2380*    END-IF.
058600*****************************************************************
058610*  IF FINANCIAL TXN, CORRESPONDING MODULE WOULD HAVE CALLED THE
058620*  CHARGE SYSTEM ALREADY, SO IT MUST BYPASS THE LINES BELOW
058630*****************************************************************
TB0147
SC2981     IF  STRT-AREA-TRN-NO = 13010 OR 13110
SC2981         COMPUTE BOIS-ACCUM-TOD-CASH-DR =
SC2981                 BOIS-ACCUM-TOD-CASH-DR + WA-REPAY-AMOUNT
SC2981     END-IF.
SC9409*    IF WA-INPUT-PARAM-TABLE(29) = 1
SC9409*       MOVE STRT-AREA-TRN-NO TO WA-UT0060-SAVE-TRAN-NO
SC9409*       MOVE WA-INPUT-KEY-R   TO WA-UT0060-SAVE-ACC-NO
SC9409*    END-IF.
SC2527
SC2591*    IF (WA-MSG-ERR-FLAG > 0) OR (WA-OUTPUT-ERR-MSG-NO > 0)
SC2591     IF  (WA-MSG-ERR-FLAG > 0)
SC2591     AND (WA-OUTPUT-ERR-MSG-NO >= 100 AND
SC2591          WA-OUTPUT-ERR-MSG-NO <= 899) OR
SC2591         (WA-OUTPUT-ERR-MSG-NO >= 1000)
TB0147        GO TO B099-SUP.
S12000     IF  (STRT-AREA-TRN-NO = 13031
S12000     AND BOIS-MISC-INC-DUE > 0)
S12000         COMPUTE UTOVRDCA-CALL-INPUT-AMT
S12000               = WA-REPAY-AMOUNT + BR0023-PENALTY-AMT
S12000         IF UTOVRDCA-CALL-INPUT-AMT < 1000000
S12000            GO TO B099-SUP
S12000         END-IF
S12000     END-IF.
TB0249     IF STRT-AREA-TRN-NO NOT = (17038 AND 17026 AND 63058 AND
TB0249                                17000)
SC1267                             AND 12008
SC1476                             AND 17036
S12474                             AND 12007 AND 17037
S15599*S15320                             AND 10872
SC4509                             AND 17468 AND 17469
S16588                             AND 17085
TB0147*    IF WA-MSG-ERR-FLAG = 0
TB0147        PERFORM H400-SUPER-OVERRIDE THRU H400-EXIT
ST0083        IF WA-MSG-ERR-FLAG = 1
ST0083           MOVE UTOVRDCA-CALL-ERROR-CODE TO
ST0083                WA-OUTPUT-ERR-MSG-NO
ST0083           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
ST0083           GO TO B099-SUP
ST0083        END-IF
SC4656        IF  WA-TFR-FROM-DEP-ACCT
S16871        AND NOT STRT-DSS-BUNCH-TXN
S16663            MOVE "N" TO WA-FUND-GUAR
SC4656            PERFORM H410-SUPER-OVERRIDE THRU H410-EXIT
S16663            IF STRT-TRICKLE-TXN
S16663            AND WA-FUND-GUAR = "N"
S16759            AND NOT WA-CUST-INC-EXP-FEES
S17719            AND NOT BORP-ALBPS
S16663               MOVE 1494 TO WA-OUTPUT-ERR-MSG-NO
S16663               MOVE 1    TO WA-MSG-ERR-FLAG
S16663               GO TO B099-EXIT-PARA
S16663            END-IF
ST0083            IF WA-MSG-ERR-FLAG = 1
S16618               IF WA-RPYMT-VIA-DEP
S16618                  MOVE 5323 TO UTOVRDCA-CALL-ERROR-CODE
S16618               END-IF
ST0083               MOVE UTOVRDCA-CALL-ERROR-CODE TO
ST0083                    WA-OUTPUT-ERR-MSG-NO
ST0083               PERFORM E000-COMPLETION-PARA THRU E099-EXIT
ST0083               GO TO B099-SUP
ST0083            END-IF
SC4656        END-IF
S16482        IF  WA-REPAY-SUPR-OVR-Y
S17263        OR ( WA-PRIN-CREDIT-TRF                 AND
S17263             STRT-BANCSLINK                     AND
S17263             STRT-AREA-BRANCH = 622             AND
S17263            (WA-REPAY-AMOUNT < SV-BORM-DUE-AMT) AND
S17448           (BORP-ACCT-TYPE-1-2 = "70" OR "71" OR "72" OR "73"
S17824                               OR "74"  OR "77" ) )
S17824*S17448                               OR "77" ) )
S17448*S17263    (BORP-ACCT-TYPE-1-2 = "70" OR "71") )
S16482            PERFORM H420-SUPER-OVERRIDE THRU H420-EXIT
S16482            IF WA-MSG-ERR-FLAG = 1
S16482               MOVE UTOVRDCA-CALL-ERROR-CODE TO
S16482                    WA-OUTPUT-ERR-MSG-NO
S16482               PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S16482               GO TO B099-SUP
S16482            END-IF
S16482        END-IF
SC2981        MOVE STRT-AREA-TRN-NO    TO  WA-CURR-TRCODE
SC2981        IF  (WA-CASH-DEBIT-ADD   OR  WA-CASH-DEBIT-LESS)
SC2981*       AND (BOIS-ACCUM-TOD-CASH-DR NOT < 3000000)
S16453*       AND ( WA-REPAY-AMOUNT NOT <  SOC-DCSH-LIMT-DR )
S16461        AND ( WA-REPAY-AMOUNT NOT <  1000000          )
S16453        AND ( WA-INPUT-PARAM-TABLE(7) = 0 )
SC2981              MOVE 2254   TO  UTOVRDCA-CALL-ERROR-CODE
SC2981              MOVE 1      TO  WA-MSG-ERR-FLAG
SC2981        END-IF
SC2981        IF  (WA-CASH-CREDIT-ADD  OR  WA-CASH-CREDIT-LESS)
SC2981*       AND (BOIS-ACCUM-TOD-CASH-CR NOT < 3000000)
S16453*       AND ( WA-REPAY-AMOUNT  NOT <  SOC-DCSH-LIMT-CR )
S16461        AND ( WA-REPAY-AMOUNT  NOT <  1000000          )
S16453        AND ( WA-INPUT-PARAM-TABLE(7) = 0 )
SC2981              MOVE 2254   TO  UTOVRDCA-CALL-ERROR-CODE
SC2981              MOVE 1      TO  WA-MSG-ERR-FLAG
SC2981        END-IF
SC2206*       IF  (STRT-AREA-TRN-NO = 11010 OR 11060 OR 13010 OR 13031)
SC2206*       AND (WA-REPAY-AMOUNT > SOC-DCSH-LIMT-DR)
SC2206*          MOVE 3742   TO  UTOVRDCA-CALL-ERROR-CODE
SC2206*          MOVE 1      TO  WA-MSG-ERR-FLAG
SC2206*       END-IF
TB0147        IF WA-MSG-ERR-FLAG = 1
TB0147           MOVE 0  TO WA-MSG-ERR-FLAG
TB0147           MOVE UTOVRDCA-CALL-ERROR-CODE TO
TB0147                UT0060CA-CALL-ERROR-CODE
TB0147           MOVE UTOVRDCA-CALL-PROMONO    TO WA-OVER-RIDE
TB0147           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
TB0147           IF WA-MSG-ERR-FLAG = 0
TB0147              MOVE UTOVRDCA-CALL-ERROR-CODE TO WA-ERR-MSG-NO
TB0147           ELSE
TB0147              MOVE UTOVRDCA-CALL-ERROR-CODE TO
TB0147                   WA-OUTPUT-ERR-MSG-NO
TB0147              PERFORM E000-COMPLETION-PARA THRU E099-EXIT
TB0147           END-IF
TB0147        END-IF.
S17263*S17013        IF  WA-MSG-ERR-FLAG = 0
S17263*S17013            AND STRT-AREA-BATCH-TANDEM = 0
S17263*S17013            AND BORP-ACCT-TYPE-1-2 = "70"
S17263*S17013            AND STRT-AREA-TRN-NO = 11048
S17263*S17013            AND STRT-AREA-BRANCH = 622
S17003*S17013     AND WA-REPAY-AMOUNT < BORM-DUE-AMT
S17263*S17003            AND WA-REPAY-AMOUNT < SV-BORM-DUE-AMT
S17263*S17013            MOVE 5342   TO  UTOVRDCA-CALL-ERROR-CODE
S17263*S17013            MOVE 0  TO WA-MSG-ERR-FLAG
S17263*S17013            MOVE UTOVRDCA-CALL-ERROR-CODE
S17263*S17013                           TO  UT0060CA-CALL-ERROR-CODE
S17263*S17013            MOVE UTOVRDCA-CALL-PROMONO  TO WA-OVER-RIDE
S17263*S17013            PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
S17263*S17013            IF WA-MSG-ERR-FLAG = 0
S17263*S17013                MOVE UTOVRDCA-CALL-ERROR-CODE  TO WA-ERR-MSG-NO
S17263*S17013            ELSE
S17263*S17013                MOVE UTOVRDCA-CALL-ERROR-CODE
S17263*S17013                              TO WA-OUTPUT-ERR-MSG-NO
S17263*S17013            END-IF
S17263*S17013        END-IF.
S17013*
TB0147 B099-SUP.
SC3975*SC6771 IF STRT-BANCSLINK
SC6276*SC6771 AND (WA-OUTPUT-ERR-MSG-NO = 998 OR 000 OR 999)
SC3975*SC6276 AND WA-OUTPUT-ERR-MSG-NO = 998 OR 000 OR 999
SC3975*SC6771 AND UT28-RCPT-PRINTING-IND <> 0
SC3975*SC6771    MOVE UT28-OUTPUT-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
SC3975*SC6771    MOVE UT28-OUTPUT-MSG-LENGTH TO WA-OUTPUT-MSG-LENGTH
SC3975*SC6771    MOVE UT28-OUTPUT-MSG        TO WA-OUTPUT-MSG
SC3975*SC6771    PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
SC3975*SC6771 END-IF.
058640     IF WA-MSG-ERR-FLAG NOT ZERO
058650        GO TO B099-SET-CALL.
058660     IF STRT-AREA-TRN-NO = 19301
058670        GO TO B099-EXIT-PARA.
058690     MOVE STRT-AREA-TRN-NO TO WA-SAVE-TRN-NO.
058700     MOVE WA-EDIT-MASK     TO WA-CORR-EDIT-MASK.
058710     MOVE BORR-PARAMS      TO WA-SAVE-BORPARM.
058720     MOVE STRT-AREA-EDIT-MASK TO WA-SAVE-TRAN-EDIT-MASK.
058740     IF   WA-INPUT-PARAM-TABLE(4) = 1        OR
058750          WA-INPUT-PARAM-TABLE(5) = 1
058760          GO TO B090-SEND
058770     ELSE
058780          NEXT SENTENCE.
058800 B001-PROCESS-CHARGES.
058810*
058820* 17046 PROCESSES CHARGES ON THE OLD ACCT TYPE
058830*
058840*    IF STRT-AREA-TRN-NO = 17046 AND
058850*       (WA-IN-17046-OLD-BRANCH NOT = WA-IN-17046-NEW-BRANCH OR
058860*        WA-IN-17046-OLD-ACCT-TYPE
058870*                 NOT = WA-IN-17046-NEW-ACCT-TYPE OR
058880*        WA-IN-17046-OLD-ACCT-CAT
058890*                 NOT = WA-IN-17046-NEW-ACCT-CAT )
058900*       MOVE 02 TO UT2000CA-CALL-CODE
058910*       MOVE 0 TO UT2000CA-CALL-INDEX
058920*       MOVE BORM-SOC-NO TO UT2000CA-CALL-SOC-NO
058930*       MOVE WA-IN-17046-OLD-ACCT-TYPE TO UT2000CA-CALL-ACCT-TYPE
058940*       MOVE WA-IN-17046-OLD-ACCT-CAT  TO UT2000CA-CALL-INT-CAT
058950*       PERFORM D100-CALL-UT2000 THRU D199-EXIT
058960*       IF WA-MSG-ERR-FLAG = 1
058970*         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
058980*         GO TO B099-EXIT.
SC1640     IF STRT-AREA-TRN-NO = 17046
SC1640        IF (WA-IN-17046-OLD-BRANCH NOT = WA-IN-17046-NEW-BRANCH)
SC1640            AND (WA-IN-17046-OLD-ACCT-TYPE
SC1640                NOT = WA-IN-17046-NEW-ACCT-TYPE OR
SC1640                WA-IN-17046-OLD-ACCT-CAT
SC1640                NOT = WA-IN-17046-NEW-ACCT-CAT)
SC1640            MOVE 983                     TO WA-OUTPUT-MSG-LENGTH
SC1640            MOVE 2113                    TO WA-OUTPUT-ERR-MSG-NO
SC1640            PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
SC1640        END-IF
SC1640     END-IF.
058990     IF STRT-AREA-TRN-NO = 17046 AND
059000        (WA-IN-17046-OLD-BRANCH NOT = WA-IN-17046-NEW-BRANCH OR
059010         WA-IN-17046-OLD-ACCT-TYPE
059020                  NOT = WA-IN-17046-NEW-ACCT-TYPE OR
059030         WA-IN-17046-OLD-ACCT-CAT
059040                  NOT = WA-IN-17046-NEW-ACCT-CAT )
059050         IF WA-IN-17046-OLD-BRANCH NOT = WA-IN-17046-NEW-BRANCH
059060           MOVE 98115 TO STRT-AREA-TRN-NO
059070                         LINK-IN-TXCODE
059080           PERFORM X700-CALL-UT0250 THRU X799-EXIT
059090           IF WA-MSG-ERR-FLAG = 1
059100              NEXT SENTENCE
059110           END-IF
059120           MOVE LINK-EDIT-MASK TO FIELD-B
059130           CALL "UT0022" USING
059150                         PUAREA
059160           MOVE FIELD-A TO WA-EDIT-MASK
059170           MOVE LINK-EDIT-TABLE TO STRT-AREA-EDIT-MASK
059180        ELSE
059190           MOVE 98116 TO STRT-AREA-TRN-NO
059200                         LINK-IN-TXCODE
059210           PERFORM X700-CALL-UT0250 THRU X799-EXIT
059220           IF WA-MSG-ERR-FLAG = 1
059230              NEXT SENTENCE
059240           END-IF
059250           MOVE LINK-EDIT-MASK TO FIELD-B
059260           CALL "UT0022" USING
059280                         PUAREA
059290           MOVE FIELD-A TO WA-EDIT-MASK
059300           MOVE LINK-EDIT-TABLE TO STRT-AREA-EDIT-MASK
059310        END-IF
059320     END-IF.
059330     PERFORM B900-CHECK-IF-TO-APPLY-CHARGES THRU B999-EXIT.
059340     IF WA-MSG-ERR-FLAG NOT ZERO
059350         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
059360         GO TO B099-PRE-EXIT.
059370*    ELSE
059380*        IF  WA-INPUT-PARAM-TABLE(17) = 1
059390*            MOVE 4 TO WA-INPUT-MSG-CODE
059400*            MOVE STRT-AREA-JRNL-NO TO WA-OUTPUT-JRNL-NO
059410*            MOVE 999 TO WA-OUTPUT-ERR-MSG-NO
059420*            MOVE 7 TO WA-OUTPUT-MSG-LENGTH
059430*            PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
059440*        END-IF
059450*    END-IF.
059460*
059470 B075.
059480     IF  CS0000RA-CHR-CNT = 0
059490         GO TO B085-SEND.
059500*
059510     MOVE 2                      TO  WA-LEDGER-CODE.
059520     MOVE "C"                    TO  WA-PRIORITY-CODE.
059530     MOVE CS0000RA-TOT-HOW-APPLY-3  TO  WA-AMOUNT-TO-ADD.
059540     MOVE BORM-LOAN-BAL          TO  CPY-BORM-LOAN-BAL.
059550     MOVE BORM-THEO-LOAN-BAL     TO  CPY-BORM-THEO-LOAN-BAL.
059570*
059580  IF BORP-PRIORITY-CODE-ON AND
TB0099     STRT-AREA-TRN-NO NOT = 13031 AND 11044 AND 11048
TB0099     AND 16044 AND  16048 AND 16144 AND 16148
TB0099     AND 13131 AND 11144 AND 11148
S11617     AND 16129
S17282     AND 16102
059590     IF WA-PRIORITY-CODE = SPACES
059600        INITIALIZE UT0095CA-AREA
059610        MOVE 03                  TO UT0095CA-CALL-CODE
059620        MOVE "BOR"               TO UT0095CA-SYSTEM
059630        MOVE STRT-AREA-LEDG-CODE TO UT0095CA-LEDG-CODE
NR2001*059640        MOVE STRT-AREA-POST-DT   TO BORV-01-TRN-DATE
NR2001*059650        MOVE BORV-01-DETAIL      TO UT0095CA-BORV-RECORD-AREA
NR2001        MOVE STRT-AREA-POST-DT   TO BOCT-TRN-DATE
NR2001        MOVE BOCT-RECORD-AREA    TO UT0095CA-BOCT-RECORD-AREA
059660        MOVE BORM-RECORD-AREA    TO UT0095CA-BORM-RECORD-AREA
059670        MOVE BORM-LOAN-BAL       TO UT0095CA-LOAN-BAL
059680        MOVE BORM-THEO-LOAN-BAL  TO UT0095CA-THEO-LOAN-BAL
059690        MOVE STRT-AREA-RECOVERY  TO UT0095CA-RECOVERY-FLAG
059700        CALL "UT0095" USING UT0095CA-CALL-PARAM
059710        IF UT0095CA-RET-STATUS = ZEROS
059720           MOVE UT0095CA-LOAN-BAL TO CPY-BORM-LOAN-BAL
059730                                     BORM-LOAN-BAL
059740           MOVE UT0095CA-THEO-LOAN-BAL TO CPY-BORM-THEO-LOAN-BAL
059750                                          BORM-THEO-LOAN-BAL
059760           MOVE UT0095CA-PRINCIPAL-BAL TO
059770                 BORM-UNPAID-PRINCIPAL-BAL
059780           MOVE UT0095CA-THEO-PRINCIPAL-BAL TO
059790                 BORM-THEO-UNPAID-PRINCIPAL-BAL
059800           MOVE UT0095CA-INTEREST-BAL TO
059810                 BORM-CAP-UNPAID-INT
059820           MOVE UT0095CA-THEO-INTEREST-BAL TO
059830                 BORM-CAP-THEO-UNPAID-INT
059840           MOVE UT0095CA-ARREARS-BAL TO
059850                 BORM-UNPAID-ARRS-INT-BAL
059860           MOVE UT0095CA-THEO-ARREARS-BAL TO
059870                 BORM-THEO-UNPAID-ARRS-INT-BAL
059880           MOVE UT0095CA-CHARGES-BAL TO
059890                 BORM-UNPAID-CHRG-BAL
059900           MOVE UT0095CA-THEO-CHARGES-BAL TO
059910                 BORM-THEO-UNPAID-CHRG-BAL
059920           MOVE UT0095CA-TOM-BAL TO                                     
059930                 BORM-UNPAID-TOM-INT                                    
059940           MOVE UT0095CA-THEO-TOM-BAL TO                                
059950                 BORM-THEO-UNPAID-TOM-INT                               
059960        END-IF
059970     ELSE
059980        PERFORM N000-ADD-TO-LOAN-BAL THRU NADD-EXIT
059990  ELSE
060000     PERFORM N100-ADD-TO-LOAN-BAL THRU N199-EXIT
060010  END-IF.
060020*
060030     MOVE CPY-BORM-LOAN-BAL      TO  BORM-LOAN-BAL.
060040     MOVE CPY-BORM-THEO-LOAN-BAL TO  BORM-THEO-LOAN-BAL.
060060     PERFORM BB00-PROCESS-CHARGE-TXNS THRU BB99-EXIT.
060070     IF CS0000RA-STATUS = 11 OR 01
060080        MOVE 1 TO WA-MSG-ERR-FLAG
060090        PERFORM E000-COMPLETION-PARA THRU E099-EXIT
060100        GO TO B099-EXIT.
060110     PERFORM B3000-CHECK-LIMITS THRU B3099-EXIT.
060120     IF   WA-MSG-ERR-FLAG = 1
060130          PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
060140          GO TO B099-EXIT.
060150*
060160 B080.
060170     IF WA-CS0000RA-STATUS NOT = 0 OR
060180        WA-CS0090RA-STATUS NOT = 0
060190         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
060200         MOVE SPACES TO UT8500CA-INPUT-MSG
060210         STRING "BR0000:(B080) INVALID RET STATUS CS0000/90 "
060220                  WA-CS0000RA-STATUS " / " WA-CS0090RA-STATUS
060230             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
060240         CALL "UT8500" USING
060260                             UT8500CA-AREA
060270*        MOVE WA-CHARGE-ERR (TXT-1, TXT-2)
060280*                                     TO WA-OUTPUT-LIMIT-MSG
060290         MOVE SPACES                  TO WA-OUTPUT-LIMIT-MSG
060300         MOVE "ERROR CONDITION FROM CHARGE SYSTEM"
060310                                      TO WA-OUTPUT-LIMIT-MSG
060320         MOVE 40                      TO WA-OUTPUT-MSG-LENGTH
060330         MOVE 998                     TO WA-OUTPUT-ERR-MSG-NO
060340         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
060350*
060360     IF BORP-ACCRUE-FREQ = 99
LB0511        AND STRT-AREA-TRN-NO NOT = 32110            
060380        PERFORM H000-CALC-INT THRU H099-EXIT
060390        IF WA-MSG-ERR-FLAG = 1
060400           GO TO B099-EXIT
060410        END-IF
060420     END-IF.
060430*
060440*NBG003
060450     IF BORP-INT-DAYS-YR = 0                                             
060460        MOVE UT1999CA-CCYYMMDD TO UT0310CA-CALENDAR-IN-CCYYMMDD          
060470        MOVE 6 TO UT0310CA-CALL-FUNC                                     
060480        MOVE ZEROES TO UT0310CA-CALL-STATUS                              
060490        MOVE ZEROES TO UT0310CA-CALENDAR-METHOD                          
060500        MOVE BORP-CALENDAR-CODE TO UT0310CA-CALENDAR-CODE                
060510        MOVE STRT-AREA-SOC-NO   TO UT0310CA-SOC-NO                      
060520        CALL "UT0310" USING UT0310CA-REC                                 
060530        IF UT0310CA-CALL-STATUS NOT = 0                                  
060540           MOVE 365 TO WS-DAYS-IN-YEAR                                   
060550        ELSE                                                             
060560           MOVE UT0310CA-DAYS-IN-YEAR TO WS-DAYS-IN-YEAR                 
060570        END-IF                                                           
060580     ELSE                                                                
060590        MOVE BORP-INT-DAYS-YR TO WS-DAYS-IN-YEAR                         
060600     END-IF.                                                             
060610*                                                                        
060620     IF  WA-INPUT-PARAM-TABLE(2) = 1                                     
060630     AND WA-INPUT-PARAM-TABLE(24) NOT = 1                                
060640         COMPUTE WS-ARREARS-AMT = BORM-LOAN-BAL -                        
060650                                  BORM-THEO-LOAN-BAL                     
060660         MOVE BORP-FINE-RATE       TO WS-FINE-RATE                       
060670         MOVE WS-ARREARS-AMT       TO WA-ARREARS                         
060680         IF BORP-COFM-METH = 'Y'                                         
060690            COMPUTE WS-ARREARS-AMT = WS-ARREARS-AMT       +              
060700                                     BORM-ARR-INT-ACCR    +              
060710                                     BLDV-FC-ARR-ADJ-ACCR +               
060720                                     BORM-BPI-ACCR        +              
060730                                     BLDV-FC-BPI-ADJ-ACCR +               
060740                                     BORM-INT-ACCR        +              
060750                                     BLDV-FC-LI-ADJ-ACCR  +               
060760                                     BORM-CI-ACCR         +              
060770                                     BLDV-FC-CI-ADJ-ACCR                  
060780*           ADD BORM-ARR-INT-ACCR  TO WS-ARREARS-AMT                     
060790*                              GIVING WS-ARREARS-AMT                     
060800            MOVE 01                TO UT0096CA-CALL-CODE                 
060810            MOVE WS-DAYS-IN-YEAR   TO UT0096CA-CALL-CALC-BSIS            
060820                                      UT0096CA-CALL-MULT-FCTR            
060830            MOVE 1                 TO UT0096CA-CALL-UNIT-IN-BSIS         
060840            MOVE BORP-FINE-RATE    TO UT0096CA-CALL-INT-RATE             
060850            CALL "UT0096"       USING UT0096CA-AREA                      
060860            MOVE UT0096CA-RTRN-COFM-RATE TO WS-FINE-RATE                 
060870         END-IF                                                          
060880         IF WA-SAVE-ARREARS > 0 AND                                      
060890            WA-SAVE-ARR-INT-INCR > 0                                     
060900            IF WA-ARREARS > 0                                            
060910                COMPUTE BORM-ARR-INT-INCR ROUNDED =                      
060920                  (WS-ARREARS-AMT  *                                     
060930                   WS-FINE-RATE / 36500)                                 
060940            ELSE                                                         
060950               MOVE 0      TO BORM-ARR-INT-INCR                          
060960            END-IF                                                       
060970         ELSE                                                            
060980         IF WA-SAVE-ARREARS <= 0                                         
060990            IF WA-ARREARS > 0                                            
061000               MOVE STRT-AREA-POST-DT TO BORM-LST-ARR-DATE               
061010            END-IF                                                       
061020         END-IF                                                          
061030     END-IF.                                                             
061040     PERFORM W700-REWRITE-MASTER THRU W799-EXIT                         
061050     IF  WA-MSG-ERR-FLAG = 1
061060         GO TO B099-EXIT.
061080*    IF  CS0000CA-LST-FEE = CS0000RA-LST-FEE-PROC
061090*        GO TO B090-SEND
061100*    ELSE
061110     IF  CS0000CA-LST-FEE NOT = CS0000RA-LST-FEE-PROC
061120         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
061130         MOVE SPACES TO UT8500CA-INPUT-MSG
061140         STRING "BR0000:(B080) > 30 CHARGES TO BE APPLIED "
061150             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
061160         CALL "UT8500" USING
061180                             UT8500CA-AREA
061190*        MOVE WA-CHARGE-GT30 (TXT-1, TXT-2)
061200*                                     TO WA-OUTPUT-LIMIT-MSG
061210         MOVE SPACES                  TO WA-OUTPUT-LIMIT-MSG
061220         MOVE "> 30 CHARGES TO BE APPLIED"
061230                                      TO WA-OUTPUT-LIMIT-MSG
061240         MOVE 40                      TO WA-OUTPUT-MSG-LENGTH
061250         MOVE 998                     TO WA-OUTPUT-ERR-MSG-NO
061260         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
061270*
061280 B085-SEND.
061290*
061300* TXN 12440/12441 NEED TO SEND OK HERE.
061310*
061320     IF  (WA-INPUT-PARAM-TABLE(17) = 1) OR
061330         (STRT-AREA-TRN-NO = 12440 OR 12441)
061340         MOVE SPACE TO WA-OUTPUT-MSG
061350         MOVE STRT-AREA-JRNL-NO TO WA-OUTPUT-JRNL-NO
061360         MOVE 999 TO WA-OUTPUT-ERR-MSG-NO
061370         MOVE 7 TO WA-OUTPUT-MSG-LENGTH
061380         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
061390*
061400*************************************************************
061410* RELOCATED CHARGED RELATED CODING ENDS HERE
061420*************************************************************
061430*
061440 B090-SEND.
061450     IF WA-GENR-TX-CNT = 0
061460        GO TO B090-SKIP-REDIR-FEES.
061470*************************************************************
061480*    CHECK PASALONG AREA, TO PROCESS REDIRECTED FEES.
061490*************************************************************
061500     MOVE 0 TO WA-FEE-CNT.
061510     IF WA-GENR-TX-CNT > 0
061520        MOVE BORM-RECORD-AREA TO WA-PREV-BORM-RECORD-AREA
061530        MOVE WA-TX-IND-FLAG TO WA-SAVE-TX-IND-FLAG
061540        MOVE 1 TO WA-TX-IND-FLAG
S20175        PERFORM O000-DEBIT-FEE-RTN THRU O099-EXIT
061560                UNTIL WA-FEE-CNT = WA-GENR-TX-CNT
061570        MOVE WA-SAVE-TX-IND-FLAG TO WA-TX-IND-FLAG
061580        MOVE WA-PREV-BORM-RECORD-AREA TO BORM-RECORD-AREA
061590     END-IF.
061600     IF WA-GENR-TX-CNT > 0
061610        PERFORM VARYING WA-CNT FROM 1 BY 1
061620        UNTIL WA-CNT > WA-GENR-TX-CNT
061630           MOVE  0      TO WA-CORR-IND(WA-CNT)
061640           MOVE  0      TO WA-GENR-TX-TYPE(WA-CNT)
061650           MOVE  0      TO WA-SRC-ACCT(WA-CNT)
061660           MOVE  0      TO WA-TRF-AMT(WA-CNT)
061670           MOVE  0      TO WA-FEE-BEAR-ACCT(WA-CNT)
061680           MOVE  SPACES TO WA-SRC-ACCT-CCY(WA-CNT)
061690           MOVE  SPACES TO WA-FEE-BEAR-ACCT-CCY(WA-CNT)
061700           MOVE  SPACES TO WA-FEE-SHRT-DESC(WA-CNT)
061710        END-PERFORM
061720        MOVE 0 TO WA-GENR-TX-CNT
061730     END-IF.
061740     IF  WA-MSG-ERR-FLAG = 1
061750         GO TO B099-SET-CALL.
061760     MOVE 0 TO WA-OUTPUT-ERR-MSG-NO.
061770     MOVE 0 TO STRT-AREA-IEXEC-CNTL.
061780     MOVE WA-CORR-EDIT-MASK TO WA-EDIT-MASK.
061790     MOVE WA-SAVE-TRN-NO    TO STRT-AREA-TRN-NO.
061800     MOVE WA-SAVE-BORPARM   TO BORR-PARAMS.
061810     MOVE WA-SAVE-TRAN-EDIT-MASK TO STRT-AREA-EDIT-MASK.
S12649*061820     PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
061840     IF WA-MSG-ERR-FLAG NOT = 0
061850        GO TO  B099-SET-CALL.
061860 B090-SKIP-REDIR-FEES.
061870*************************************************************
061880*
061890*    IF STRT-AREA-TRN-NO = 17046 AND
061900*       (WA-IN-17046-OLD-BRANCH NOT = WA-IN-17046-NEW-BRANCH OR
061910*        WA-IN-17046-OLD-ACCT-TYPE
061920*                 NOT = WA-IN-17046-NEW-ACCT-TYPE OR
061930*        WA-IN-17046-OLD-ACCT-CAT
061940*                 NOT = WA-IN-17046-NEW-ACCT-CAT )
061950*        IF WA-IN-17046-OLD-BRANCH NOT = WA-IN-17046-NEW-BRANCH
061960*          MOVE 98115 TO STRT-AREA-TRN-NO
061970*                        LINK-IN-TXCODE
061980*          PERFORM X700-CALL-UT0250 THRU X799-EXIT
061990*          IF WA-MSG-ERR-FLAG = 1
062000*             NEXT SENTENCE
062010*          END-IF
062020*          MOVE LINK-EDIT-MASK TO FIELD-B
062030*          CALL "UT0022" USING
062050*                        PUAREA
062060*          MOVE FIELD-A TO WA-EDIT-MASK
062070*          MOVE LINK-EDIT-TABLE TO STRT-AREA-EDIT-MASK
062080*       ELSE
062090*          MOVE 98116 TO STRT-AREA-TRN-NO
062100*                        LINK-IN-TXCODE
062110*          PERFORM X700-CALL-UT0250 THRU X799-EXIT
062120*          IF WA-MSG-ERR-FLAG = 1
062130*             NEXT SENTENCE
062140*          END-IF
062150*          MOVE LINK-EDIT-MASK TO FIELD-B
062160*          CALL "UT0022" USING
062180*                        PUAREA
062190*          MOVE FIELD-A TO WA-EDIT-MASK
062200*          MOVE LINK-EDIT-TABLE TO STRT-AREA-EDIT-MASK
062210*       END-IF
062220*       GO TO B001-PROCESS-CHARGES
062230*    END-IF.
062240     MOVE WA-CORR-EDIT-MASK TO WA-EDIT-MASK.
062250     MOVE WA-SAVE-TRN-NO    TO STRT-AREA-TRN-NO.
062260     MOVE WA-SAVE-BORPARM   TO BORR-PARAMS.
062270     MOVE WA-SAVE-TRAN-EDIT-MASK TO STRT-AREA-EDIT-MASK.
062280*    PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
062300*    IF WA-MSG-ERR-FLAG NOT = 0
062310*       GO TO  B099-SET-CALL.
062320***  WHEN A TRAN REACHES HERE, IT MUST HAVE BEEN ACCEPTED.
062330***  HENCE CLEAR ALL ERROR OVERRIDES RELATING TO IT, IF ANY.
062340***  IF NO OVERRIDE BEFORE, OR TRAN REJECTED, DON'T CLEAR
062350 B099-CALL-UT0460-CHECKS1.
062360     MOVE  ZEROS               TO  WA-CALL-UT0460-FLAG.
062370     IF   WA-INPUT-PARAM-TABLE (4) =  1
062380       OR
062390          WA-INPUT-PARAM-TABLE (5) = 1
062400          NEXT    SENTENCE
062410     ELSE
062420          GO  TO  B099-EXIT2.
062430**   IF    STRT-CONVERSION-TXN
062440**      GO  TO  B099-EXIT1.
062450**
062460** IF NOT FULL  MULTI-CURRENCY  TRANSACTION ***
062470**
062480     IF    SOC-MULTI-CURRENCY  = "0" OR "1"
062490        GO  TO  B099-EXIT1.
062500**
062510** IF FULL MULTI-CURRENCY BUT NOT CURRENCY CLEARING
062520** CHECK INTERBRANCH
062530**
062540     IF    SOC-CURR-CLEARING-IND  =  "0"
062550        GO TO B099-CALL-UT0460-CHECKS2
062560     ELSE
062570**
062580** IF FULL MULTI-CURRENCY AND CLEARING BUT BASE CURRENCY
062590** ALL AROUND STILL CHECK INTER-BRANCH
062600** ELSE CALL UT0460 BECAUSE FOREIGN CURRENCY INVOLVED
062610**
062620       IF  WS-SAVE-TXN-CURRENCY  =  WA-ACCT-CURR-CD    AND
062630            WA-ACCT-CURR-CD  =  SOC-NATIVE-CURRENCY
062640            GO TO B099-CALL-UT0460-CHECKS2
062650        ELSE
062660        GO  TO  B099-CALL-UT0460.
062670**
062680 B099-CALL-UT0460-CHECKS2.
062690**
062700** WE ARE HERE BECAUSE OF FULL MULTI-CURRENCY BUT NO
062710** CLEARING OR BASE CURRENCY ALL AROUND. IF INTER-BRANCH
062720** TRANSACTION GENERATION IS NOT REQUIRED THEN DON'T
062730** CALL UT0460
062740**
062750     IF    SOC-INTER-BRANCH-IND  NOT  =  "1"
062760        GO  TO  B099-EXIT1.
062770**
062780** AS ABOVE IF INTER-BRANCH TX BUT NOT ACTUALLY INTERBRANCH
062790** THEN DON'T CALL UT0460
062800**
062810     IF    BORM-BR-NO        =  STRT-AREA-BRANCH
062820        GO  TO  B099-EXIT1.
062830 B099-CALL-UT0460.
062840     IF (WA-DUMMY-LST-TWO NOT = 90
062850         AND WA-INPUT-PARAM-TABLE (5) = 1
062860         AND WA-INPUT-PARAM-TABLE(10) = 1)
062870         MOVE 10 TO UT0460CA-COMMISSION-IND
062880         MOVE WA-SAVE-TO-BRANCH TO UT0460CA-TRANSFER-BRANCH
062890     ELSE
062900     IF (WA-INPUT-PARAM-TABLE (29) = 1)
062910         MOVE 10 TO UT0460CA-COMMISSION-IND
062920         MOVE WA-SAVE-FROM-BRANCH TO UT0460CA-TRANSFER-BRANCH
062930     ELSE
062940         MOVE STRT-AREA-TRN-NO TO WA-DUMMY-TRN-NO
062950         IF  WA-DUMMY-LOAN-TXN
062960         AND (WA-DUMMY-CR-DB-TXN OR WA-GATEWAY-TXNS)
062970             MOVE 20 TO UT0460CA-COMMISSION-IND
062980         ELSE
062990             MOVE 00 TO UT0460CA-COMMISSION-IND
063000             MOVE BORM-BR-NO TO UT0460CA-TRANSFER-BRANCH.
063010     IF WA-MULTI-COMMISSION NOT = 0
063020         IF (WA-DUMMY-LST-TWO NOT = 90
063030             AND WA-INPUT-PARAM-TABLE (5) = 1
063040             AND WA-INPUT-PARAM-TABLE(10) = 1)
063050             ADD 2 TO UT0460CA-COMMISSION-IND
063060         ELSE
063070             ADD 9 TO UT0460CA-COMMISSION-IND.
063080     MOVE   1                  TO   UT0460CA-CALL-CODE
063090                                    WA-CALL-UT0460-FLAG.
063100     MOVE   0                  TO   UT0460CA-ERROR-STATUS.
063110     MOVE   "LON"              TO   UT0460CA-SYSTEM.
063120     MOVE   BORM-GL-CLASSIFICATION-CODE TO
063130            UT0460CA-CUSTOMER-GLCC.
063150     IF WA-INPUT-PARAM-TABLE (7) = 1
063160         MOVE WA-CORR-TXN-BRANCH TO UT0460CA-TXN-BRANCH.
063170     IF  WA-INPUT-PARAM-TABLE(4) = 1
063180     AND WA-INPUT-PARAM-TABLE(10) = 1
063190         MOVE 10 TO UT0460CA-COMMISSION-IND.
063200     CALL   "UT0460"   USING
063220                                UT0460-CALL-AREA
063230                                STARTAREA
063240                                SOC-PARAMS.
063250     IF     UT0460CA-ERROR-STATUS  NOT  =  ZEROS
063260        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
063270        MOVE SPACES TO UT8500CA-INPUT-MSG
063280        STRING "BR0000: UT0460 CALL ERROR -"
063290                UT0460CA-ERROR-STATUS
063300               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
063310        CALL "UT8500" USING
063330                               UT8500CA-AREA
063340        MOVE  UT0460CA-ERROR-STATUS TO WA-OUTPUT-ERR-MSG-NO
063350        MOVE  1  TO  WA-MSG-ERR-FLAG
063360        PERFORM  E000-COMPLETION-PARA THRU E099-EXIT
063370        GO TO B099-EXIT2.
063380 B099-EXIT1.
SC7050*---- Checking to make sure the FT0000 should not end the 
SC7050*---- Message sending if no error come across from Utilities 
SC7050*---- Last Message should be Voucher Printing. Please dont insert
SC7050*---- Calling of FT0000 if posible.   
SC7050     IF WA-UT0460-MSG-NO-N = 999 OR 000
SC7050        MOVE "NONE"      TO WA-UT0460-MSG-NO-A
SC7050     END-IF.
063390     IF WA-UT0460-MSG-NO-A = "NONE"
063400        NEXT SENTENCE
063410     ELSE
063420*SC7050 MOVE WA-UT0460-MSG-NO-N TO WA-OUTPUT-ERR-MSG-NO.
SC7050        MOVE WA-UT0460-MSG-NO-N TO WA-OUTPUT-ERR-MSG-NO
063430*                                                                        
063440     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.                          
063450*                                                                        
063460 B099-EXIT2.
063470     IF WA-CALL-UT0060-FLAG NOT = "Y"
063480        GO TO  B099-SET-CALL.
063490       MOVE "22" TO UT0060CA-CALL-CODE
063500       MOVE STRT-AREA-SOC-NO TO UT0060CA-CALL-SOCIETY-NO
063510       MOVE STRT-AREA-ABS-TERM TO UT0060CA-CALL-TERM-NO
063520       MOVE STRT-AREA-BATCH-TANDEM TO WK-BATCH-TANDEM.
063530       CALL "UT0060" USING
063540                           UT0060CA-AREA
063550                           MULTI-OVERRIDE-AREA
063560                           UT0060-WORK-AREA
063570       IF UT0060CA-CALL-STATUS NOT = 0
063580          MOVE UT0060CA-CALL-ACC-NO TO WA-DISPLAY-NUMBER1
063590          MOVE UT0060CA-CALL-TELR-NO TO WA-DISPLAY-NUMBER2
063600          MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
063610          MOVE SPACES TO UT8500CA-INPUT-MSG
063620          STRING "BR0000(B099) UT0060 CALL STATUS ERROR "
063630            UT0060CA-CALL-STATUS ","
063640            WA-DISPLAY-NUMBER1 ","
063650            WA-DISPLAY-NUMBER2
063660              DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
063670          CALL "UT8500" USING
063690                              UT8500CA-AREA
063700          MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
063710          MOVE 1 TO WA-MSG-ERR-FLAG
063720          GO TO B099-SET-CALL.
063730*
063740 B099-SET-CALL.
063750     MOVE UT0060-TERMINAL-AREA TO W300-ERROR-AREA.
063760 B099-PRE-EXIT.
SC2691     MOVE STRT-AREA-TRN-NO TO WS-NO-REFRESH-TRN-NO.
SC2691*    IF NOT REFRESH-OFF
ST0161     IF NOT REFRESH-OFF AND WA-MSG-ERR-FLAG = 0
S12259        IF STRT-AREA-TRN-NO <> 12410 THEN
TB0226           PERFORM M1200-CAP-BAL-DTLS THRU M1299-EXIT
S12259        END-IF
063770        IF WA-MSG-ERR-FLAG = 0
063780           PERFORM F200-DO-NEW-REFRESH THRU F299-EXIT
SC2691        END-IF
SC2691     END-IF.
063790 B099-EXIT-PARA.
063800     EXIT.
ST0071 BA100-PROCESS-REMIT-FEE.
ST0071     MOVE STRT-AREA-TRN-NO    TO WA-SAV-STRT-AREA-TRN-NO.
SC6937*    MOVE STRT-AREA-DATA      TO WA-SAV-STRT-AREA-DATA.
B19902*SC6937     MOVE STARTAREA(1:150)    TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)    TO WA-SAV-STRT-AREA-DATA.
ST0071     MOVE GLDM-RECORD-AREA    TO WA-SAV-GLDM-RECORD-AREA.
ST0071     MOVE WA-INPUT-MSG        TO WA-SAV-INPUT-MSG.
ST0071     MOVE WS-W800-TXN-FEE     TO WA-SAVE-FEE-AMT.
ST0071     MOVE WS-W800-SUSP-FEE-ACCT TO WA-SAVE-FEE-ACCT.
ST0071     MOVE WA-ADV-TXN-DATE     TO WA-SAVE-TXN-DATE.
ST0071
ST0071     MOVE STRT-AREA-SOC-NO    TO GLDM-INST-NO
ST0071     MOVE WA-DEP-ACCT-NO      TO GLDM-LEDGER-NO
ST0071                                 WA-SAVE-FROM-ACCT
ST0071                                 DBIO-01-ACCT-NO.
ST0071     PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT
ST0071        IF WA-MSG-ERR-FLAG NOT = 0
ST0071           GO TO BA109-EXIT.
ST0071
ST0071     INITIALIZE WA-INPUT-MSG.
ST0071     MOVE 3                TO GL-TRANS-IND.
ST0071     MOVE SPACES           TO GL-DONT-WRITE-GLDM-IND.
ST0071     MOVE WA-SAVE-TXN-DATE TO WA-GL-TXN-DATE.
ST0071     MOVE SPACES           TO WA-GL-DESC-AREA
ST0071                              WA-GL-PROMO-NO
ST0071     MOVE ZEROES           TO WA-GL-CHQ-NO
ST0071                              WA-GL-CHQ-TYPE
ST0071                              WA-GL-VALUE-DATE
ST0071                              WA-GL-MSG-TYPE.
ST0071     MOVE WA-SAVE-FEE-AMT  TO WA-GL-AMOUNT.
ST0071     MOVE GLDM-LEDGER-NO   TO WA-GL-ACCT-NO.
ST0071     MOVE WA-SAVE-FEE-ACCT TO WA-NARR-TRF-ACCT.
ST0071     MOVE 25055            TO STRT-AREA-TRN-NO.
ST0071      MOVE STRT-AREA-TRN-NO        TO LINK-IN-TXCODE.
ST0071      PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
ST0071      IF WA-MSG-ERR-FLAG NOT = ZERO
ST0071         GO TO BA109-EXIT.
ST0071      MOVE WA-GL-TXN-AREA          TO WA-INPUT-MSG.
ST0071      CALL "UT0820" USING  STARTAREA
ST0071                          W300-ERROR-AREA
ST0071                          GL-PASSALONG
ST0071                          WA-OTHER-SAVE-AREAS
ST0071                          MULTI-OVERRIDE-AREA
ST0071                          CHECK-RESPONSE-AREA
SC7181                          UTVTACCA-CALL-PARAM.
ST0071
ST0071      IF ST-STATUS-LEVEL-1 NOT = ZERO
ST0071         MOVE 1         TO WA-MSG-ERR-FLAG
ST0071         GO TO BA109-EXIT.
ST0071
ST0071     MOVE STRT-AREA-SOC-NO          TO GLDM-INST-NO
ST0071     MOVE WA-SAVE-FEE-ACCT       TO GLDM-LEDGER-NO
ST0071                                    DBIO-01-ACCT-NO.
ST0071     PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT
ST0071        IF WA-MSG-ERR-FLAG NOT = 0
ST0071           GO TO BA109-EXIT.
ST0071
ST0071     INITIALIZE WA-INPUT-MSG.
ST0071     MOVE 3                TO GL-TRANS-IND.
ST0071     MOVE "0"              TO GL-DONT-WRITE-GLDM-IND.
ST0071     MOVE WA-SAVE-TXN-DATE TO WA-GL-TXN-DATE.
ST0071     MOVE SPACES           TO WA-GL-DESC-AREA
ST0071                                 WA-GL-NAME-1
ST0071                                 WA-GL-NAME-2.
ST0071     MOVE 00                  TO WA-GL-NON-VALUE-DAYS.
ST0071     MOVE 00                  TO WA-GL-DEFER-DAYS.
ST0071     MOVE 00                  TO WA-GL-DEBIT-DEFER-DAYS.
ST0071     MOVE ZEROES           TO WA-GL-CHQ-NO
ST0071                              WA-GL-CHQ-TYPE
ST0071                              WA-GL-VALUE-DATE
ST0071                              WA-GL-MSG-TYPE.
ST0071
ST0071     MOVE GLDM-CURRENCY       TO WA-GL-CURRENCY.
ST0071     MOVE GLDM-LEDGER-NO         TO WA-GL-ACCT-NO
ST0071     MOVE WA-SAVE-FROM-ACCT   TO WA-NARR-TRF-ACCT.
ST0071     MOVE 25045              TO STRT-AREA-TRN-NO
ST0071      MOVE STRT-AREA-TRN-NO        TO LINK-IN-TXCODE.
ST0071      PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
ST0071      MOVE STRT-AREA-TRN-NO        TO LINK-IN-TXCODE.
ST0071
ST0071      PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
ST0071      IF WA-MSG-ERR-FLAG NOT = ZERO
ST0071         GO TO BA109-EXIT.
ST0071      MOVE WA-GL-TXN-AREA          TO WA-INPUT-MSG.
ST0071      CALL "UT0820" USING  STARTAREA
ST0071                          W300-ERROR-AREA
ST0071                          GL-PASSALONG
ST0071                          WA-OTHER-SAVE-AREAS
ST0071                          MULTI-OVERRIDE-AREA
ST0071                          CHECK-RESPONSE-AREA
SC7181                          UTVTACCA-CALL-PARAM.
ST0071
ST0071     MOVE WA-SAV-STRT-AREA-TRN-NO    TO STRT-AREA-TRN-NO.
SC6937*    MOVE WA-SAV-STRT-AREA-DATA      TO STRT-AREA-DATA.
B19902*SC6937     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:150).
B19902     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:200).
ST0071     MOVE WA-SAV-GLDM-RECORD-AREA    TO GLDM-RECORD-AREA.
ST0071     MOVE WA-SAV-INPUT-MSG           TO WA-INPUT-MSG.
ST0071 BA109-EXIT.
ST0071      EXIT.
TB0096*****************************************************************
TB0096*** process buckets                                          ****
TB0096*****************************************************************
TB0096 BC100-PROCESS-BUCKETS.
TB0096
TB0096     IF WA-10231-ACTION NOT = SPACES AND "N"
TB0096        MOVE 1958 TO WA-OUTPUT-ERR-MSG-NO
TB0096        MOVE 1   TO WA-MSG-ERR-FLAG
TB0096        GO TO BC099-EXIT
TB0096     ELSE
TB0096       IF WA-10231-ACTION = SPACES
TB0096          PERFORM VARYING WA-SUB FROM 1 BY 1 UNTIL WA-SUB > 10
TB0096             IF WA-10231-ADW-AMT(WA-SUB) NOT = ZEROES
TB0096                IF WA-10231-REASON-CD(WA-SUB) > 0
TB0096                   INITIALIZE RSNC-DATA-KEY
TB0096                   MOVE STRT-AREA-SOC-NO   TO RSNC-INST-NO
TB0096                   MOVE WA-10231-REASON-CD(WA-SUB)
TB0096                                       TO RSNC-REASON-CODE
TB0096                   PERFORM GET-REASON-CODE THRU
TB0096                                     GET-REASON-CODE-EXIT
TB0096                   PERFORM PROCESS-INPUT-BUCKET THRU
TB0096                                     PROCESS-INPUT-BUCKET-EXIT
TB0096                   IF WA-MSG-ERR-FLAG = 1
TB0096                      GO TO BC099-EXIT
TB0096                   END-IF
TB0096                   IF WA-10231-PROMO = SPACES
TB0096                      MOVE 4266 TO UT0060CA-CALL-ERROR-CODE
TB0096                      PERFORM Y000-OVERRIDABLE-ERROR-CHECK
TB0096                         THRU Y090-EXIT
TB0096                      IF WA-MSG-ERR-FLAG = 0
TB0096                         MOVE 4266 TO WA-ERR-MSG-NO
TB0096                      ELSE
TB0096                         MOVE 4266 TO WA-OUTPUT-ERR-MSG-NO
TB0096                         MOVE 1    TO WA-MSG-ERR-FLAG
TB0096                         GO TO BC099-EXIT
TB0096                      END-IF
TB0096                   END-IF
TB0096                ELSE
TB0096                   MOVE 621 TO WA-OUTPUT-ERR-MSG-NO
TB0096                   MOVE 1    TO WA-MSG-ERR-FLAG
TB0096                   GO TO BC099-EXIT
TB0096                END-IF
TB0096             END-IF
TB0096          END-PERFORM
TB0096       ELSE
TB0096         IF WA-10231-ACTION = "N"
TB0096            PERFORM PROCESS-NEXT-PAGE THRU
TB0096                            PROCESS-NEXT-PAGE-EXIT
TB0096              IF WA-MSG-ERR-FLAG = 1
TB0096                 GO TO BC099-EXIT
TB0096              END-IF
TB0096         END-IF
TB0096       END-IF 
TB0096     END-IF.
TB0096
TB0096     MOVE 0     TO WA-OUTPUT-ERR-MSG-NO.
TB0096     MOVE 613   TO WA-OUTPUT-MSG-LENGTH.
TB0096     MOVE 10231 TO STRT-AREA-TRN-NO.
TB0096
TB0096     SET STRT-AREA-LAST-MSG TO TRUE.
TB0096     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
TB0096
TB0096 BC099-EXIT.
TB0096      EXIT.
TB0096
S10614*
S10614 BD100-CHECK-RTN.
S10614*
S10614     MOVE WA-INPUT-MSG      TO WA-FEP-INPUT-AREA.
S10614*
S10614     IF ( STRT-AREA-TRN-NO  =  19093 OR 19095 OR 11740 OR
S10614                               11741 OR 11742 )
S10614          NEXT SENTENCE
S10614     ELSE
S10614          GO                TO BD100-EXIT
S10614     END-IF.
S10614*
S10614     IF   NOT ( BORP-YOUBE )
S10614          MOVE 0867         TO WA-OUTPUT-ERR-MSG-NO
S10614          MOVE 1            TO WA-MSG-ERR-FLAG
S10614          GO                TO BD100-EXIT
S10614     END-IF.
S10614*
S10614     IF ( BOIS-HOLD-AMT     NOT NUMERIC )
S10614          MOVE 0173         TO WA-OUTPUT-ERR-MSG-NO
S10614          MOVE 1            TO WA-MSG-ERR-FLAG
S10614          GO                TO BD100-EXIT
S10614     END-IF.
S10614*
S10614     IF ( STRT-AREA-TRN-NO  =  19095 )
S10614      IF  BOIS-HOLD-AMT     <= 0
S10614          MOVE 0173         TO WA-OUTPUT-ERR-MSG-NO
S10614          MOVE 1            TO WA-MSG-ERR-FLAG
S10614          GO                TO BD100-EXIT
S10614     END-IF.
S10614*
S10614     IF ( WA-BR0003-HOLD-AMOUNT NOT NUMERIC )
S10614     OR ( WA-BR0003-HOLD-AMOUNT <=  0       )
S10614          MOVE 5714         TO WA-OUTPUT-ERR-MSG-NO
S10614          MOVE 1            TO WA-MSG-ERR-FLAG
S10614          GO                TO BD100-EXIT
S10614     END-IF.
S10614*
S10614     IF ( WA-BR0003-HOLD-MSG = "  " )
S10614          MOVE 5715         TO WA-OUTPUT-ERR-MSG-NO
S10614          MOVE 1            TO WA-MSG-ERR-FLAG
S10614          GO                TO BD100-EXIT
S10614     END-IF.
S10614*
S12332*S11717  IF ( WA-BR0003-HOLD-TRAN-MESS-CODE = "020001300000"
S12332*S11717  OR   WA-BR0003-HOLD-TRAN-MESS-CODE = "020001003000" )
S12332*S11717       PERFORM C200-GET-CLMT-RTN THRU C200-GET-CLMT-EXIT
S12332*S11717       MOVE 0               TO UT1996CA-CALL-CODE
S12332*S11717       CALL "UT1996" USING     UT1996CA-CALL-AREA
S12332*S11717       IF ( CLMT-ATM-OVRS-WD-FLG = "Y"
S12332*S11717       OR ( CLMT-ATM-OVRS-WD-FLG = "A"
S12332*S11717       AND  CLMT-ATM-OVRS-WD-DATE NOT < UT1996CA-DATE ))
S12332*S12336       OR ( WA-CLMT-FOUND-NO AND
S12332*S12336            BORM-APPLIC-ISSUE-DATE < WA-OVRS-WD-CHK-DATE)
S12332*S11717            NEXT SENTENCE
S12332*S11717       ELSE
S12332*S11717            MOVE 5018         TO WA-OUTPUT-ERR-MSG-NO
S12332*S11717            MOVE 1            TO WA-MSG-ERR-FLAG
S12332*S11717            GO                TO BD100-EXIT
S12332*S11717       END-IF
S12332*S11717  END-IF.
S11717*
S10614     MOVE 2                 TO UT0290CA-CALL-CODE.
S10614     MOVE 0                 TO UT0290CA-CALL-STATUS.
S10614     MOVE 0                 TO UT0290CA-CALL-MSG-NO.
S10614     MOVE BORM-CURRENCY-IND TO UT0290CA-CALL-CURRENCY.
S10614     CALL "UT0290"          USING
S10614                            UT0290CA-CALL-AREA.
S10614*
S10614     IF ( UT0290CA-CALL-STATUS NOT = 0 )
S10614          MOVE UT0290CA-CALL-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
S10614          MOVE UT0290CA-CALL-MSG-NO TO WA-ERR-MSG-NO
S10614          MOVE 1            TO WA-MSG-ERR-FLAG
S10614          GO                TO BD100-EXIT
S10614     END-IF.
S10614*
S10614     COMPUTE WA-FEP-ACCT-BAL = BOIS-ACCOUNT-LIMIT 
S10614                            -  BORM-LOAN-BAL
S10614                            -  BOIS-HOLD-AMT.
S10614*
S10614     COMPUTE WA-FEP-ACCT-AVAIL-BAL = BOIS-ACCOUNT-LIMIT
S10614                            -  BORM-LOAN-BAL.
S15187
S15187* // COMPUTE EXTRA CHARGE FOR VISA DEBIT OVERSEAS TXN
S15187     IF (STRT-AREA-TRN-NO = 19093 OR 11740 OR 11742)
S17209     AND (STRT-FEP-ATM-TXN OR STRT-BIZTALK-CR-CARD-TXN)
S17209*S15187     AND STRT-FEP-ATM-TXN
S15187     AND WA-BR0003-CNTY-CODE NOT = "TW"
S15187         PERFORM U9200-GET-VDEFEE THRU U9299-EXIT
S15187         COMPUTE WA-INSU-AMT ROUNDED = WA-BR0003-HOLD-AMOUNT
S15187                                     * (1 + WA-OVRS-VDEFEE)
S15187         MOVE WA-INSU-AMT           TO WA-BR0003-HOLD-AMOUNT
S15187         IF STRT-AREA-TRN-NO = 11742
S15187            COMPUTE WA-INSU-AMT ROUNDED
S15187                                     = WA-BR0003-HOLD-ADJ-AMT
S15187                                     * (1 + WA-OVRS-VDEFEE)
S15187            MOVE WA-INSU-AMT        TO WA-BR0003-HOLD-ADJ-AMT
S15187         END-IF
S15187     END-IF.
S10614*
S10614* check overhide? 
S10614     IF ( STRT-AREA-TRN-NO  =  19093 )
S10614          IF ((BORM-LOAN-BAL + BOIS-HOLD-AMT 
S10614                             + WA-BR0003-HOLD-AMOUNT  ) 
S10614                            >  BOIS-ACCOUNT-LIMIT    )
S10614               MOVE 5716    TO WA-OUTPUT-ERR-MSG-NO
S10614               MOVE 5716    TO WA-ERR-MSG-NO
NQ0081               MOVE 1       TO WA-MSG-ERR-FLAG
S10614               GO           TO BD100-EXIT
S10614          END-IF
S10614     END-IF.
S11953
S17209*S11953     IF STRT-AREA-TRN-NO = 19093 AND STRT-FEP-ATM-TXN
S17209     IF  STRT-AREA-TRN-NO = 19093
S17209     AND (STRT-FEP-ATM-TXN OR STRT-BIZTALK-CR-CARD-TXN)
S11953        MOVE 1                TO UT0500CA-CALL-CODE
S11953        MOVE BORM-CUSTOMER-NO TO UT0500CA-CUSM-NO
S11953        PERFORM V500-CALL-UT0500 THRU V599-EXIT
S11953        IF WA-MSG-ERR-FLAG = 0
S11953           IF UT0500CA-NONUS-SUSPECT OR UT0500CA-ONUS-SUSPECT
S12648           OR UT0500CA-JOINT-DEFENSE
S11953              MOVE 1          TO WA-MSG-ERR-FLAG
S11953              MOVE 5026       TO WA-OUTPUT-ERR-MSG-NO
S11953                                 WA-ERR-MSG-NO
S11953              GO TO BD100-EXIT
S11953           END-IF
S11953        ELSE
S11953           MOVE UT0500RA-ERR-MSG-NO TO WA-ERR-MSG-NO
S11953           GO TO BD100-EXIT
S11953        END-IF
S11218*---CHECK IF YOUBE HAS BEEN SET UP TEMPORARILY STOP
S11218*S11953 IF BORP-YOUBE
S11218*S11953    IF STRT-AREA-TRN-NO  =  19093
S11218*S11953    AND BORM-STOP-TRAN-IND = "Y"
S11953        IF BORM-STOP-TRAN-IND = "Y"
S11218            MOVE 4632    TO WA-OUTPUT-ERR-MSG-NO
S11218*--------THIS ERROR MESSAGE IS FOR ATM
S11218            MOVE 4632    TO WA-ERR-MSG-NO
S11218            MOVE 1    TO WA-MSG-ERR-FLAG
S11218            GO TO BD100-EXIT
S11218        END-IF
S11218     END-IF.
S10614*
S10614     IF ( STRT-AREA-TRN-NO  =  19095 OR 11740 )
S10614          IF ( WA-BR0003-HOLD-AMOUNT > BOIS-HOLD-AMT )
S10614               MOVE 5716    TO WA-OUTPUT-ERR-MSG-NO
S10614               MOVE 5716    TO WA-ERR-MSG-NO
NQ0081               MOVE 1       TO WA-MSG-ERR-FLAG
S10614               GO           TO BD100-EXIT
S10614          END-IF
S10614          IF ( WA-BR0003-HOLD-ORIG-DATE = ZEROS OR SPACES )
S10614               MOVE 5717    TO WA-OUTPUT-ERR-MSG-NO
S10614               MOVE 5717    TO WA-ERR-MSG-NO
NQ0081               MOVE 1       TO WA-MSG-ERR-FLAG
S10614               GO           TO BD100-EXIT
S10614          END-IF
S10614     END-IF.
S10614*
S10614 BD100-EXIT.
S10614     EXIT.
S10614*
S10614 BE100-11741-RTN.
S10614*
S10614     IF ( STRT-AREA-TRN-NO  =  11741 )
S10614          NEXT SENTENCE
S10614     ELSE
S10614          GO                TO BE100-EXIT
S10614     END-IF.
S10614*
S10614     IF   NOT ( BORP-YOUBE )
S10614          MOVE 0867         TO WA-OUTPUT-ERR-MSG-NO
S10614          MOVE 1            TO WA-MSG-ERR-FLAG
S10614          GO                TO BE100-EXIT
S10614     END-IF.
S10614*
S10614     IF ( BOIS-HOLD-AMT     NOT NUMERIC )
S10614     OR ( BOIS-HOLD-AMT     <  0        )
S10614          MOVE 0173         TO WA-OUTPUT-ERR-MSG-NO
S10614          MOVE 1            TO WA-MSG-ERR-FLAG
S10614          GO                TO BE100-EXIT
S10614     END-IF.
S10614*
S10614     IF ( WA-BR0003-HOLD-AMOUNT NOT NUMERIC )
S10614     OR ( WA-BR0003-HOLD-AMOUNT <=  0       )
S10614          MOVE 5714         TO WA-OUTPUT-ERR-MSG-NO
S10614          MOVE 1            TO WA-MSG-ERR-FLAG
S10614          GO                TO BE100-EXIT
S10614     END-IF.
S10614*
S10614* check overhide? 
S10614     IF ( STRT-AREA-TRN-NO  =  11741 )
S10614          IF ((BORM-LOAN-BAL + BOIS-HOLD-AMT 
S10614                             + WA-BR0003-HOLD-AMOUNT  ) 
S10614                            >  BOIS-ACCOUNT-LIMIT    )
S10614               MOVE 5716    TO WA-OUTPUT-ERR-MSG-NO
S10614               MOVE 5716    TO WA-ERR-MSG-NO
S11178               MOVE 1       TO WA-MSG-ERR-FLAG
S10614*S11178        GO           TO BD100-EXIT
S11178               GO           TO BE100-EXIT
S10614          END-IF
S10614     END-IF.
S10614*
S10614 BE100-EXIT.
S10614     EXIT.
S10614*
TB0096 PROCESS-INPUT-BUCKET.
TB0096      IF WA-10231-IND(WA-SUB) NOT = "C"
NR2001*TB0096         INITIALIZE BORV-01-DETAIL
NR2001*TB0096         MOVE 01 TO BORV-01-CODE
NR2001*TB0096         MOVE 0 TO BORV-01-STATUS
NR2001*TB0096         MOVE STRT-AREA-POST-DT TO BORV-01-TRN-DATE
NR2001*TB0096         PERFORM U100-PK-BRANCH-TERM-TELL THRU U199-EXIT
NR2001*TB0096         MOVE UPTELLCA-TELLER-BRANCH TO BORV-01-TELL-AND-BR
NR2001*TB0096         MOVE 11040              TO BORV-01-TRN-CODE
NR2001*TB0096         MOVE STRT-AREA-POST-DT  TO BORV-01-POST-DATE
NR2001*TB0096         MOVE STRT-AREA-JRNL-NO  TO BORV-01-JRNL-NO
NR2001*TB0096         MOVE ZEROES             TO BORV-01-CHQ-DAYS
NR2001*TB0096         MOVE WA-10231-ADW-AMT(WA-SUB) TO BORV-01-AMOUNT
NR2001*TB0096         MOVE BORM-LOAN-BAL      TO BORV-01-BALANCE
NR2001*TB0096         MOVE SPACE              TO BORV-01-DAYFILE
NR2001*TB0096         MOVE ZEROES             TO BORV-01-ARREARS
NR2001*TB0096         MOVE WA-ADJ-SUB-LEDG-CODE TO BORV-01-SUB-LEDG-CODE
NR2001*TB0096         MOVE STRT-AREA-MSG-TIME TO BORV-01-POST-TIME
NR2001*TB0096         MOVE ZEROES             TO BORV-01-DEFER-DAYS
NR2001*TB0096         MOVE SPACES             TO BORV-01-PROMO-NO
NR2001*TB0096         MOVE STRT-AREA-TERM-NO  TO BORV-01-BRTERM
NR2001         INITIALIZE BOCT-TRAN-01
NR2001         MOVE 01                       TO BOCT-TRAN-TYPE
NR2001         MOVE 0                        TO BOCT-STAT
NR2001         MOVE STRT-AREA-POST-DT        TO BOCT-TRN-DATE
NR2001         MOVE 11040                    TO BOCT-TRN-CODE
NR2001         MOVE ZEROES                   TO BOCT-01-CHQ-DAYS
NR2001         MOVE WA-10231-ADW-AMT(WA-SUB) TO BOCT-01-AMOUNT
NR2001         MOVE BORM-LOAN-BAL            TO BOCT-01-BALANCE
NR2001         MOVE SPACE                    TO BOCT-01-DAYFILE
NR2001         MOVE ZEROES                   TO BOCT-01-ARREARS
NR2001         MOVE WA-ADJ-SUB-LEDG-CODE     TO BOCT-01-SUB-LEDG-CODE
NR2001         MOVE STRT-AREA-MSG-TIME       TO BOCT-01-REPOST-TIME
NR2001         MOVE ZEROES                   TO BOCT-01-DEFER-DAYS
NR2001         MOVE SPACES                   TO BOCT-01-PROMO-NO
TB0096         PERFORM W500-ADD-TXN THRU W599-EXIT
TB0096         IF  WA-MSG-ERR-FLAG = 1
TB0096             GO TO PROCESS-INPUT-BUCKET-EXIT
TB0096         END-IF
TB0096
TB0096         MOVE 07                  TO UT0094CA-CALL-CODE
TB0096         MOVE "BOR"               TO UT0094CA-SYSTEM
TB0096         MOVE STRT-AREA-JRNL-NO   TO UT0094CA-JRNL-NO
TB0096         MOVE STRT-AREA-LEDG-CODE TO UT0094CA-LEDG-CODE
TB0096         MOVE WA-10231-BCKT-CD    TO UT0094CA-PRIORITY-CODE
TB0096         MOVE WA-10231-TERM-NO(WA-SUB) TO
TB0096                                 UT0094CA-BASED-TERM-NO
TB0096         MOVE WA-10231-SEQ-NO(WA-SUB)  TO
TB0096                                 UT0094CA-SEQUENCE-NO
TB0096         MOVE WA-10231-REASON-CD(WA-SUB) TO
TB0096                                 UT0094CA-ADJ-REASON-CODE
SC2134         MOVE STRT-AREA-BATCH-TANDEM TO UT0094CA-BATCH-TANDEM
TB0096         CALL "UT0094" USING UT0094CA-CALL-PARAM
TB0096                             BORM-RECORD-AREA
NR2001*TB0096                             BORV-RECORD-AREA
NR2001                             BOCT-RECORD-AREA
TB0096                             BOIS-RECORD
TB0096                             BORR-PARAMS
TB0096         IF UT0094CA-RET-STATUS NOT = ZEROES
TB0096            MOVE 1              TO WA-MSG-ERR-FLAG
TB0096            MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0096                                TO UT8500CA-CALL-CODE
TB0096            MOVE SPACES TO UT8500CA-INPUT-MSG
TB0096            STRING "BR0000:(PROCESS-INPUT) ERROR UT0094, "
TB0096                   ", RETURN CODE=" UT0094CA-RET-STATUS
TB0096            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0096            CALL "UT8500" USING UT8500CA-AREA
TB0096            GO TO PROCESS-INPUT-BUCKET-EXIT
TB0096         END-IF
TB0096      ELSE
TB0096         MOVE 3910 TO WA-OUTPUT-ERR-MSG-NO
TB0096         MOVE 1    TO WA-MSG-ERR-FLAG
TB0096         GO TO PROCESS-INPUT-BUCKET-EXIT
TB0096      END-IF.
TB0096
TB0096 PROCESS-INPUT-BUCKET-EXIT.
TB0096      EXIT.
TB0096
TB0096 PROCESS-NEXT-PAGE.
TB0096
TB0096     MOVE WA-10231-ACCT-NO   TO UT0151CA-ACCT-IN.
TB0096     MOVE 2                  TO UT0151CA-CALL-FUNC.
TB0096     MOVE SOC-ACCT-NO-FORMAT TO UT0151CA-FORMAT.
TB0096     MOVE SOC-CHK-DGT        TO UT0151CA-CHK-DGT-TYPE.
TB0096     CALL "UT0151" USING        UT0151CA-CALL-AREA.
TB0096     IF UT0151CA-STATUS    NOT = 0
TB0096        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
TB0096        MOVE SPACES TO UT8500CA-INPUT-MSG
TB0096        STRING "BR0000:(G000) UT0151 CALL ERROR; A/C NO - "
TB0096               UT0151CA-ACCT-IN "; STATUS - " UT0151CA-STATUS
TB0096           DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0096        CALL "UT8500"   USING
TB0096                               UT8500CA-AREA
TB0096        MOVE 1       TO WA-MSG-ERR-FLAG
TB0096        GO TO PROCESS-NEXT-PAGE-EXIT
TB0096     END-IF.
TB0096*
TB0096     MOVE UT0151CA-ACCT-EX   TO WA-OUT-10231-ACCT-NO
TB0096     MOVE WA-10231-BCKT-CD   TO WA-OUT-BCKT-CD
TB0096     MOVE WA-10231-BCKT-DESC TO WA-OUT-BCKT-DESC
TB0096     PERFORM VARYING WA-SUB FROM 1 BY 1
TB0096     UNTIL WA-SUB > 10
TB0096         MOVE ZEROES TO  WA-OUT-TERM-NO(WA-SUB)
TB0096                         WA-OUT-BASE-DATE(WA-SUB)
TB0096                         WA-OUT-BASE-AMT(WA-SUB)
TB0096                         WA-OUT-INT-RATE(WA-SUB)
TB0096                         WA-OUT-ADW-AMT(WA-SUB)
TB0096                         WA-OUT-REASON-CD(WA-SUB)
TB0096         MOVE SPACES TO  WA-OUT-IND(WA-SUB)
TB0096                         WA-OUT-SEQ-NO(WA-SUB)
TB0096                         WA-OUT-ACTION
TB0096      END-PERFORM.
TB0096
TB0096      IF WA-10231-TERM-NO(WA-MAX-SUB) > ZEROES AND
TB0096      WA-10231-SEQ-NO(WA-MAX-SUB) > ZEROES
TB0096         MOVE WA-10231-TERM-NO(WA-MAX-SUB) TO
TB0096                            TEMP-TERM-NO
TB0096         MOVE WA-10231-SEQ-NO(WA-MAX-SUB)  TO
TB0096                            TEMP-SEQ-NO
TB0096         PERFORM READ-UT0094 THRU READ-UT0094-EXIT
TB0096         INITIALIZE WA-UT94-FLAG
TB0096         PERFORM VARYING WA-SUB FROM 1 BY 1
TB0096            UNTIL WA-SUB > WA-MAX-SUB
TB0096            OR WA-UT94-FLAG = "Y"
TB0096            IF UT0094CA-BUCV-RECORD(WA-SUB) = SPACES
TB0096               MOVE "Y" TO WA-UT94-FLAG
TB0096            ELSE
TB0096               MOVE UT0094CA-BUCV-RECORD(WA-SUB) TO
TB0096                                 UT0094-DATA(WA-SUB)
TB0096               MOVE UT0094-TERM-NO(WA-SUB)       TO
TB0096                                 WA-OUT-TERM-NO(WA-SUB)
TB0096*
TB0096               MOVE UT0094-BASED-DATE(WA-SUB)    TO
Tb0096                                 UT0020-BINARY-DATE
TB0096               MOVE 1 TO UT0020-FUNCTION
TB0096               CALL "UT0020" USING UT0020-FUNCTION
TB0096                                   UT0020-DATE-AREA
TB0096                                   UT0020-BINARY-DATE
TB0096               MOVE UT0020-DATE-DDMMCCYY         TO
TB0096                                 WA-OUT-BASE-DATE(WA-SUB)
TB0096*
TB0096               MOVE UT0094-TXN-AMT(WA-SUB)       TO
Tb0096                                 WA-OUT-BASE-AMT(WA-SUB)
TB0096               MOVE UT0094-BASED-RATE(WA-SUB)    TO
TB0096                                 WA-OUT-INT-RATE(WA-SUB)
TB0096               MOVE UT0094-TXN-IND(WA-SUB)       TO
TB0096                                 WA-OUT-IND(WA-SUB)
TB0096               MOVE ZEROES TO WA-OUT-ADW-AMT(WA-SUB)
TB0096               MOVE ZEROES TO WA-OUT-REASON-CD(WA-SUB)
TB0096               MOVE UT0094-SEQUENCE-NO(WA-SUB)   TO
TB0096                                 WA-OUT-SEQ-NO(WA-SUB)
TB0096            END-IF
TB0096         END-PERFORM
TB0096      ELSE
TB0096         MOVE 1957 TO WA-OUTPUT-ERR-MSG-NO
TB0096         MOVE 1    TO WA-MSG-ERR-FLAG
TB0096         GO        TO PROCESS-NEXT-PAGE-EXIT
TB0096      END-IF.
TB0096
TB0096     MOVE 998   TO WA-OUTPUT-ERR-MSG-NO.
TB0096     MOVE 6     TO STRT-AREA-IEXEC-CNTL.
TB0096     MOVE 613   TO WA-OUTPUT-MSG-LENGTH.
TB0096     MOVE 10231 TO STRT-AREA-TRN-NO.
TB0096     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
TB0096
TB0096*
TB0096 PROCESS-NEXT-PAGE-EXIT.
TB0096      EXIT.
TB0096
TB0096 READ-UT0094.
TB0099     initialize              UT0094CA-RET-STATUS.
TB0096     MOVE 05                    TO UT0094CA-CALL-CODE
TB0096     MOVE "BOR"                 TO UT0094CA-SYSTEM
TB0096     MOVE STRT-AREA-JRNL-NO     TO UT0094CA-JRNL-NO
TB0096     MOVE STRT-AREA-LEDG-CODE   TO UT0094CA-LEDG-CODE
TB0096     MOVE WA-10231-BCKT-CD      TO UT0094CA-PRIORITY-CODE
TB0096     MOVE TEMP-TERM-NO          TO UT0094CA-BASED-TERM-NO
TB0096     MOVE TEMP-SEQ-NO           TO UT0094CA-SEQUENCE-NO
TB0096     CALL "UT0094" USING UT0094CA-CALL-PARAM
TB0096                         BORM-RECORD-AREA
NR2001*TB0096                         BORV-RECORD-AREA
NR2001                         BOCT-RECORD-AREA
TB0096                         BOIS-RECORD
TB0096                         BORR-PARAMS
TB0096     IF UT0094CA-RET-STATUS = ZEROES
TB0096        CONTINUE
TB0096     ELSE
TB0096         MOVE 1              TO WA-MSG-ERR-FLAG
TB0096         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0096                               TO UT8500CA-CALL-CODE
TB0096         MOVE SPACES TO UT8500CA-INPUT-MSG
TB0096         STRING "BR0000:(A100) ERROR UT0094, "
TB0096                  ", RETURN CODE=" UT0094CA-RET-STATUS
TB0096             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0096         CALL "UT8500" USING UT8500CA-AREA
TB0096         GO TO READ-UT0094-EXIT
TB0096     END-IF.
TB0096
TB0096 READ-UT0094-EXIT.
TB0096      EXIT.
TB0096 
TB0096 GET-REASON-CODE.
TB0096
TB0096      MOVE "READ"          TO DBIOMOD-FUNCTION.
TB0096      MOVE SPACES          TO DBIOMOD-STAT.
TB0096      MOVE "RSNC"          TO DBIOMOD-FILE
TB0096                              DBIOMOD-SUFFIX.
TB0096      MOVE "DBIO"          TO DBIOMOD-PREFIX.
TB0096      MOVE RSNC-DATA-KEY   TO DBIOMOD-KEY.
TB0096      MOVE ZEROES          TO DBIOMOD-KEY-NO.
TB0096      MOVE SPACES          TO DBIOMOD-RELEASE-LOCK
TB0096                              DBIOMOD-ACCESS-COMMAND
TB0096                              DBIOMOD-ACCESS-COND
TB0096                              DBIOMOD-STATUS.
TB0096      CALL DBIOMODNAME USING
TB0096                       DBIOMOD-FILE
TB0096                       DBIOMOD-KEY
TB0096                       WA-REASON-CODE-REC
TB0096                       DBIOMOD-FUNCTION
TB0096                       DBIOMOD-KEY-NO
TB0096                       DBIOMOD-RELEASE-LOCK
TB0096                       DBIOMOD-ACCESS-COMMAND
TB0096                       DBIOMOD-ACCESS-COND
TB0096                       DBIOMOD-STATUS.
TB0096
TB0096      IF DBIOMOD-STAT = "MRNF"
TB0096         MOVE 1    TO WA-MSG-ERR-FLAG
TB0096         MOVE "Y"  TO WA-NO-MORE-FLAG
TB0096         MOVE 4274 TO WA-OUTPUT-ERR-MSG-NO
TB0096         GO TO GET-REASON-CODE-EXIT
TB0096      END-IF.
TB0096
TB0096      IF DBIOMOD-STAT NOT = "****"
TB0096         MOVE 1                TO WA-MSG-ERR-FLAG
TB0096         MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
TB0096         MOVE "RSNC"           TO WA-OUTPUT-DATA-SET
TB0096         MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
TB0096         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0096                               TO UT8500CA-CALL-CODE
TB0096         MOVE SPACES           TO UT8500CA-INPUT-MSG
TB0096         STRING "BR0000:(A0000) 'RSNC' READ ERROR, STAT "
TB0096                 DBIO-CALL-STATUS "KEY = "
TB0096                 DBIO-CALL-KEY-AREA
TB0096                 DELIMITED BY SIZE INTO
TB0096                 UT8500CA-INPUT-MSG
TB0096         CALL "UT8500" USING
TB0096                       UT8500CA-AREA
Tb0096         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
TB0096         GO TO GET-REASON-CODE-EXIT
TB0096      END-IF.
TB0096
TB0096 GET-REASON-CODE-EXIT.
TB0096      EXIT.
063810******************************************************************
063820*** D B I O   O P E R A T I O N   F O R   N E W    A C C T ***
063830******************************************************************
063840 B100-NEW-RCD-DBIO-PARA.
063850*
TB0008***** AUTO ACCOUNT RNMBER *********
           MOVE 0 TO AUTO-ACCT-IND
TB0008     IF AUTO-ACCT-FLAG = "Y"
063860        IF NOT STRT-REPOST-TXN                                             
063870           PERFORM B800-AUTO-ACCT-NO THRU B899-EXIT
063880           IF  WA-MSG-ERR-FLAG = 1
063890               GO TO B199-EXIT
063900           END-IF                                                         
063910        END-IF                                                             
063920*
TB0008*START TB0008
TB0008        IF SOC-RESERVE-NO = "Y"
TB0117           MOVE WA-INPUT-ACCT-NO TO WA-INPUT-KEY-CHOP
TB0117           MOVE WA-INPUT-KEY-13  TO KEY-RNUM-RESERVE-ACCT-NO
TB0117**         MOVE WA-INPUT-ACCT-NO TO KEY-RNUM-RESERVE-ACCT-NO
                 PERFORM B4000-READ-RNUM THRU B4000-EXIT
                 EVALUATE DBIOMOD-STAT
                    WHEN "MRNF"
                       PERFORM B110-READ-BORM THRU B110-EXIT
                       IF AUTO-ACCT-IND = 1
                          GO TO B100-NEW-RCD-DBIO-PARA
                       END-IF
                    WHEN "****"
                       IF (RNUM-STATUS = 0) AND (RNUM-ENTITY = "LON")
                       AND (RNUM-TELLER  = STRT-AREA-TELL-NO)
TB0117                     GO TO B100-NEW-RCD-DBIO-PARA
TB0117**                   MOVE 1 TO RNUM-STATUS
TB0117**                   MOVE "REWRITE"  TO DBIOMOD-FUNCTION
TB0117**                   MOVE "Y"              TO DBIOMOD-RELEASE-LOCK
TB0117**                   PERFORM B4100-RNUM-DBIO THRU B4100-EXIT
TB0117**                   PERFORM B110-READ-BORM THRU B110-EXIT
TB0117**                   IF AUTO-ACCT-IND = 1
TB0117**                      GO TO B100-NEW-RCD-DBIO-PARA
TB0117**                   END-IF
                       ELSE
                           GO TO B100-NEW-RCD-DBIO-PARA
                       END-IF
                    WHEN OTHER
                       MOVE 155   TO WA-OUTPUT-ERR-MSG-NO
                       MOVE 1    TO WA-MSG-ERR-FLAG
                       MOVE DBIOMOD-FILE   TO WA-OUTPUT-DATA-SET
                       MOVE DBIOMOD-STAT   TO WA-OUTPUT-STATUS
                       MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
                                           UT8500CA-CALL-CODE
                       MOVE SPACES TO UT8500CA-INPUT-MSG
                       STRING "BR0000(B100): ERROR ACCESS RNUM"
                              "/FUNCTION:" DBIOMOD-FUNCTION
                              "/STATUS:"   DBIOMOD-STAT
                              "/KEY:"      KEY-RNUM-AREA
                       DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
                       CALL "UT8500" USING
                                     UT8500CA-AREA
                       GO TO B199-EXIT
                 END-EVALUATE
              ELSE
                 PERFORM B110-READ-BORM THRU B110-EXIT
                 IF AUTO-ACCT-IND = 1
                     GO TO B100-NEW-RCD-DBIO-PARA
                 END-IF
              END-IF 
           END-IF.
TB0008***** RESERVED ACCOUNT NUMBER *******
           IF AUTO-ACCT-FLAG = "N"
TB0117        MOVE 02 TO UT2000CA-CALL-CODE
TB0117        MOVE 0  TO UT2000CA-CALL-INDEX
TB0117        MOVE STRT-AREA-SOC-NO  TO UT2000CA-CALL-SOC-NO
TB0117        MOVE WA-12000-ACT-TYPE TO UT2000CA-CALL-ACCT-TYPE
TB0117        MOVE WA-12000-ACT-CTG  TO UT2000CA-CALL-INT-CAT
TB0117        PERFORM D100-CALL-UT2000
TB0117           THRU D199-EXIT
TB0117        IF WA-MSG-ERR-FLAG = 1
TB0117           GO TO B899-EXIT
TB0117        END-IF
S16900        PERFORM W400-BRHM-BSB  THRU W499-EXIT
S16938        IF   WA-BRHM-OPEN-OK
S16938        AND (WA-TR-NA-REAL-BR-NO = ZEROS
S16938        OR   WA-TR-NA-REAL-BR-NO = SPACES)
S16938             MOVE STRT-AREA-BRANCH   TO WA-TR-NA-REAL-BR-NO
S16938        END-IF
TB0117
TB0117        IF BORP-AUTO-ACCT-GROUP-NO > 0 AND
TB0117           BORP-AUTO-ACCT-GROUP-NO NUMERIC
TB0117           MOVE BORP-AUTO-ACCT-GROUP-NO TO WA-GROUP-TYPE
TB0117        ELSE
TB0117           MOVE WA-TR-NA-TYPE TO WA-GROUP-TYPE
TB0117        END-IF
      ***** CHECK ACCOUNT NUMBER FORMAT *****
      *      IF SOC-SITE = 20                                            ***TB0008
             IF SOC-SITE-TIB                                             ***TB0008
               IF SOC-AUTO-ACCT-NO = 7
S19653         AND NOT STRT-REPOST-TXN
                 IF (ACCT-NO-BRANCH NOT = STRT-AREA-BRANCH) OR
TB0117**            (ACCT-NO-TYPE NOT = WA-TR-NA-TYPE(3:2)) OR
TB0117              (ACCT-NO-SPACE NOT = "00" AND SPACES)   OR
TB0117              (NOT ACCT-NO-FIRST-2)
TB0117**            (ACCT-NO-SPACE NOT = "000" AND SPACES)
                    MOVE 3543 TO WA-OUTPUT-ERR-MSG-NO
                    MOVE 1    TO WA-MSG-ERR-FLAG
                    GO TO B199-EXIT
                 END-IF
               END-IF
      *      END-IF                                                      ***TB0008
SC8720**--
SC8720       MOVE STRT-AREA-SOC-NO TO ANUM-INST-NO
SC8720       MOVE STRT-AREA-BRANCH TO ANUM-BR-NO
SC8720       MOVE WA-GROUP-TYPE    TO ANUM-ACCT-TYPE
SC8720       MOVE 71               TO DBIO-CALL-FUNC
SC8720       MOVE "ANUM"           TO DBIO-CALL-SYS-AREA
SC8720       MOVE SPACES           TO DBIO-CALL-STATUS
SC8720       MOVE ANUM-KEY         TO DBIO-CALL-KEY-AREA
SC8720       PERFORM B4300-READ-ANUM
SC8720          THRU B4300-EXIT
SC8720       IF DBIO-CALL-STATUS  NOT = "****"
SC8720          MOVE UT8500CA-FUNC-NORMAL-DISPLAY
SC8720            TO UT8500CA-CALL-CODE
SC8720          MOVE SPACES TO UT8500CA-INPUT-MSG
SC8720          STRING "BR0000(B100): ERROR ACCESSING DBIO "
SC8720                 "(ANUM) KEY = " DBIO-CALL-KEY-AREA
SC8720                 "/STATUS = " DBIO-CALL-STATUS
SC8720                   DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC8720          CALL "UT8500" USING UT8500CA-AREA
SC8720          MOVE 155    TO WA-OUTPUT-ERR-MSG-NO
SC8720          MOVE 1      TO WA-MSG-ERR-FLAG
SC8720          MOVE "ANUM" TO WA-OUTPUT-DATA-SET
SC8720          MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
SC8720          GO          TO B199-EXIT
SC8720       END-IF
SC8720       MOVE WA-INPUT-ACCT-NO TO WA-INPUT-KEY-CHOP
SC8720       IF NOT STRT-REPOST-TXN
SC8720          IF WA-INPUT-KEY-13 < ANUM-START-ACCT-NO OR
SC8720             WA-INPUT-KEY-13 > ANUM-END-ACCT-NO
SC8720             MOVE SPACES TO UT8500CA-INPUT-MSG
SC8720             STRING "BR0000(B100): A/C RANGE ERROR "
SC8720                    "A/C = " WA-INPUT-KEY
SC8720                    "/S-ACCT-NO = " ANUM-START-ACCT-NO
SC8720                    "/E-ACCT-NO = " ANUM-END-ACCT-NO
SC8720                    DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC8720             CALL "UT8500" USING UT8500CA-AREA
SC8720             MOVE 109 TO WA-OUTPUT-ERR-MSG-NO
SC8720             MOVE 1   TO WA-MSG-ERR-FLAG
SC8720             GO       TO B199-EXIT
SC8720          END-IF
SC8720       END-IF
SC8720**--
             IF SOC-RESERVE-NO = "Y"
TB0117          MOVE WA-TR-NEW-ACCT-NO TO WA-INPUT-KEY-CHOP
TB0117          MOVE WA-INPUT-KEY-13   TO KEY-RNUM-RESERVE-ACCT-NO
TB0117**        MOVE WA-TR-NEW-ACCT-NO TO KEY-RNUM-RESERVE-ACCT-NO
                PERFORM B4000-READ-RNUM THRU B4000-EXIT
                EVALUATE DBIOMOD-STAT
                  WHEN "MRNF"
TB0117**
S19653             IF NOT STRT-REPOST-TXN
TB0117               IF (ACCT-NO-BRANCH NOT = STRT-AREA-BRANCH) OR
TB0117                  (ACCT-NO-SPACE NOT  = "00" AND SPACES) OR
TB0117                  (NOT ACCT-NO-FIRST-2)
TB0117                  MOVE 3543 TO WA-OUTPUT-ERR-MSG-NO
TB0117                  MOVE 1    TO WA-MSG-ERR-FLAG
TB0117                  GO TO B199-EXIT
TB0117               END-IF
S19653             END-IF
TB0117**
                     PERFORM B110-READ-BORM THRU B110-EXIT
                  WHEN "****"
TB0117**            IF (RNUM-STATUS = 0) AND (RNUM-ENTITY = "LON")
TB0117**            AND (RNUM-EXP-DT > WA-DMY )                          ***TB0008
TB0117              IF (RNUM-STATUS = 0)
S16061              OR (STRT-REPOST-TXN AND RNUM-STATUS = 1)
TB0117                 IF (RNUM-ENTITY <> "LON")
TB0117                    MOVE 1488 TO WA-OUTPUT-ERR-MSG-NO
TB0117                    MOVE 1    TO WA-MSG-ERR-FLAG
TB0117                    GO TO B199-EXIT
TB0117                 END-IF
TB0117**
TB0117                 IF RNUM-EXP-DT < STRT-AREA-POST-DT
TB0117                    MOVE 1470 TO WA-OUTPUT-ERR-MSG-NO
TB0117                    MOVE 1    TO WA-MSG-ERR-FLAG
TB0117                    GO TO B199-EXIT
TB0117                 END-IF
TB0117**
                       IF RNUM-TELLER NOT = STRT-AREA-TELL-NO
                          MOVE 3533  TO UT0060CA-CALL-ERROR-CODE
      *                   MOVE WA-TR-NA-PROMO       TO WA-OVER-RIDE
                          PERFORM Y000-OVERRIDABLE-ERROR-CHECK
                                                      THRU Y090-EXIT
                          IF WA-MSG-ERR-FLAG = 0
                              MOVE 3533 TO WA-ERR-MSG-NO
                          ELSE
                             MOVE 3533 TO WA-OUTPUT-ERR-MSG-NO
                             MOVE 1    TO WA-MSG-ERR-FLAG
                             GO TO B199-EXIT
                          END-IF
                       END-IF
                       MOVE 1 TO RNUM-STATUS
                       MOVE "REWRITE"  TO DBIOMOD-FUNCTION
                       MOVE "Y"              TO DBIOMOD-RELEASE-LOCK
                       PERFORM B4100-RNUM-DBIO THRU B4100-EXIT
                       PERFORM B110-READ-BORM  THRU B110-EXIT
                    ELSE
TB0117                   MOVE 1480 TO WA-OUTPUT-ERR-MSG-NO
TB0117**                 MOVE 111  TO WA-OUTPUT-ERR-MSG-NO
                         MOVE 1    TO WA-MSG-ERR-FLAG
                         GO TO B199-EXIT
                    END-IF
                  WHEN OTHER
                       MOVE 155   TO WA-OUTPUT-ERR-MSG-NO
                       MOVE 1    TO WA-MSG-ERR-FLAG
                       MOVE DBIOMOD-FILE   TO WA-OUTPUT-DATA-SET
                       MOVE DBIOMOD-STAT   TO WA-OUTPUT-STATUS
                       MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
                                               UT8500CA-CALL-CODE
                       MOVE SPACES TO UT8500CA-INPUT-MSG
                       STRING "BR0000(B100): ERROR ACCESS RNUM"
                              "/FUNCTION:" DBIOMOD-FUNCTION
                              "/STATUS:"   DBIOMOD-STAT
                              "/KEY:"      KEY-RNUM-AREA
                       DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
                       CALL "UT8500" USING
                                     UT8500CA-AREA
                       GO TO B199-EXIT
                END-EVALUATE
             ELSE
                 MOVE 3535  TO WA-OUTPUT-ERR-MSG-NO
                 MOVE 1    TO WA-MSG-ERR-FLAG
                 GO TO B199-EXIT
TB0008       END-IF
TB0008     END-IF.
TB0008*END TB0008
TB0008 B199-EXIT.
TB0008     EXIT.
TB0008 B110-READ-BORM.
063930     MOVE 01                     TO DBIO-CALL-FUNC.
063940     MOVE "BOR"                  TO DBIO-CALL-SYS-AREA.
063950     MOVE STRT-AREA-SOC-NO       TO WA-BORM-SOC-NO.
063960     MOVE WA-INPUT-ACCT-NO       TO WA-BORM-ACCT-NO.
063970     MOVE WA-BORM-KEY            TO DBIO-CALL-KEY-AREA.
063980     MOVE SPACES                 TO DBIO-CALL-STATUS.
063990     CALL "DBIO" USING
064010                                 DBIO-CALL-PARAM
064020                                 DBIO-CALL-SYS-AREA
064030                                 DBIO-CALL-KEY-AREA
064040                                 DBIO-CALL-STATUS
064050                                 BORM-RECORD-AREA.
064060     IF  DBIO-CALL-STATUS = "MRNF"
TB0008         GO TO B110-EXIT.
TB0008     IF  DBIO-CALL-STATUS = "****" AND  AUTO-ACCT-FLAG = "Y"
TB0008         MOVE 1 TO AUTO-ACCT-IND
TB0008         GO TO B110-EXIT
TB0008     END-IF.
064080     IF  DBIO-CALL-STATUS = "****"
064090     OR  DBIO-CALL-STATUS = "HELD"
064100         MOVE 111   TO WA-OUTPUT-ERR-MSG-NO
064110         MOVE 1    TO WA-MSG-ERR-FLAG
064120         GO TO B110-EXIT.
064130     MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
064140     MOVE SPACES TO UT8500CA-INPUT-MSG
064150     STRING "BR0000:(B100) BAD BORM READ "
064160             DBIO-CALL-STATUS
064170         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
064180     CALL "UT8500" USING
064200                         UT8500CA-AREA.
064210     MOVE 155                    TO WA-OUTPUT-ERR-MSG-NO.
064220     MOVE "BORM" TO WA-DBERR-DATA-SET.
064230     MOVE DBIO-CALL-STATUS TO WA-DB-ERROR.
064240     MOVE 1                      TO WA-MSG-ERR-FLAG.
064250 B110-EXIT.
064260     EXIT.
S12770 B120-READ-BORM.
S12770     MOVE 01                     TO DBIO-CALL-FUNC.
S12770     MOVE "BOR"                  TO DBIO-CALL-SYS-AREA.
S12770     MOVE STRT-AREA-SOC-NO       TO WA-BORM-SOC-NO.
S12770     MOVE WA-INPUT-ACCT-NO       TO WA-BORM-ACCT-NO.
S12770     MOVE WA-BORM-KEY            TO DBIO-CALL-KEY-AREA.
S12770     MOVE SPACES                 TO DBIO-CALL-STATUS.
S12770     CALL "DBIO" USING
S12770
S12770                                 DBIO-CALL-PARAM
S12770                                 DBIO-CALL-SYS-AREA
S12770                                 DBIO-CALL-KEY-AREA
S12770                                 DBIO-CALL-STATUS
S12770                                 BORM-RECORD-AREA.
S12770     IF  DBIO-CALL-STATUS = "MRNF"
S12770         DISPLAY "BR0000: (B120) ERROR IN READING BORM"
S12770                 ", KEY = " DBIO-CALL-KEY-AREA
S12770                 ", STATUS = " DBIO-CALL-STATUS
S12770         MOVE 108        TO WA-OUTPUT-ERR-MSG-NO
S12770         MOVE 1 TO WA-MSG-ERR-FLAG
S12770         GO TO B120-EXIT.
S12770     IF  DBIO-CALL-STATUS = "HELD"
S12770         MOVE 112 TO WA-OUTPUT-ERR-MSG-NO
S12770         MOVE 1 TO WA-MSG-ERR-FLAG
S12770         GO TO B120-EXIT.
S12770     IF DBIO-CALL-STATUS NOT = "****"
S12770        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
S12770        MOVE SPACES TO UT8500CA-INPUT-MSG
S12770        STRING "BR0000:(B120) DATA BASE CORRUPT FOR KEY = "
S12770                                    DBIO-CALL-KEY-AREA
S12770            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S12770        CALL "UT8500" USING
S12770
S12770                         UT8500CA-AREA
S12770        MOVE 155                    TO WA-OUTPUT-ERR-MSG-NO
S12770        MOVE 1                      TO WA-MSG-ERR-FLAG
S12770        GO TO B120-EXIT.
S12770 B120-EXIT.
S12770     EXIT.
064270******************************************************************
064280*** D B I O   O P E R A T I O N  F O R   O L D   A C C T ***
064290******************************************************************
064300 B200-OLD-RCD-DBIO-PARA.
S12770     IF STRT-AREA-TRN-NO = 11063 OR 11163 OR 16063 OR 16163
S12770        MOVE WA-INPUT-ACCT-NO TO WA-SAVE-INPUT-AC-NO
S12770        MOVE WA-DEP-ACCT-NO   TO WA-INPUT-ACCT-NO
S12770        PERFORM B120-READ-BORM THRU B120-EXIT
S12770        IF WA-MSG-ERR-FLAG = 1
S12770           GO TO B299-EXIT
S12770        END-IF
S12770        MOVE BORM-BR-NO       TO WA-SAVE-BRCH-NO
S12770        MOVE WA-SAVE-INPUT-AC-NO TO WA-INPUT-ACCT-NO
S12770     END-IF.
S15963     MOVE "N"                    TO WA-OD-TO-LOAN.
S19753     MOVE 0                      TO WA-DUP-COUNT.
S15963 B200-READ-BORM.
064310     MOVE 01                     TO DBIO-CALL-FUNC.
064320     MOVE "BOR"                  TO DBIO-CALL-SYS-AREA.
064330     MOVE STRT-AREA-SOC-NO       TO WA-BORM-SOC-NO.
064340     MOVE WA-INPUT-ACCT-NO       TO WA-BORM-ACCT-NO.
064350     MOVE WA-BORM-KEY            TO DBIO-CALL-KEY-AREA.
064360     MOVE "1"                    TO DBIO-CALL-LOCK-FLAG.
064370     MOVE SPACES                 TO DBIO-CALL-STATUS.
064380     CALL "DBIO" USING
064400                                 DBIO-CALL-PARAM
064410                                 DBIO-CALL-SYS-AREA
064420                                 DBIO-CALL-KEY-AREA
064430                                 DBIO-CALL-STATUS
064440                                 BORM-RECORD-AREA.
064450     IF  DBIO-CALL-STATUS = "MRNF"
S15963         IF STRT-TRICKLE-TXN
S15963         AND STRT-AREA-TRN-NO = 17200
S15963         AND WA-17200-FUNC    = "10"
S15963         AND WA-OD-TO-LOAN    = "N"
S15963             PERFORM B210-ODTOLOAN-RTN THRU B210-EXIT
S15963             IF WA-OD-TO-LOAN = "Y"
S15963                GO TO B200-READ-BORM
S15963             END-IF
S15963             IF WA-MSG-ERR-FLAG = 1
S15963                GO TO B299-EXIT
S15963             END-IF
S15963         END-IF
SC8001         DISPLAY "BR0000: (B200) ERROR IN READING BORM"
SC8001                 ", KEY = " DBIO-CALL-KEY-AREA
SC8001                 ", STATUS = " DBIO-CALL-STATUS
064460         MOVE 108        TO WA-OUTPUT-ERR-MSG-NO
064470         MOVE 1 TO WA-MSG-ERR-FLAG
064480         GO TO B299-EXIT.
064490     IF  DBIO-CALL-STATUS = "HELD"
S19753         IF  WA-DUP-COUNT < DLAYHERECA-RETRIES-50
S19753             ADD 1 TO WA-DUP-COUNT
S19753             STRING "BR0000:(B200)- DLAYHERE FOR BORM "
S19753                    "KEY = " DBIO-CALL-KEY-AREA
S19753             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S19753             CALL "UT8500" USING UT8500CA-AREA
S19753             CALL "DLAYHERE" USING DLAYHERECA-TIME-10
S19753             GO TO B200-READ-BORM
S19753         ELSE
S19753             MOVE 112 TO WA-OUTPUT-ERR-MSG-NO
S19753             MOVE 1 TO WA-MSG-ERR-FLAG
S19753             GO TO B299-EXIT
S19753         END-IF
S19753     END-IF.
S19753*064500         MOVE 112 TO WA-OUTPUT-ERR-MSG-NO
S19753*064510         MOVE 1 TO WA-MSG-ERR-FLAG
S19753*064520         GO TO B299-EXIT.
064530     IF DBIO-CALL-STATUS NOT = "****"
064540        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
064550        MOVE SPACES TO UT8500CA-INPUT-MSG
064560        STRING "BR0000:(B200) DATA BASE CORRUPT FOR KEY = "
064570                                    DBIO-CALL-KEY-AREA
064580            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
064590        CALL "UT8500" USING
064610                         UT8500CA-AREA
064620        MOVE 155                    TO WA-OUTPUT-ERR-MSG-NO
064630        MOVE 1                      TO WA-MSG-ERR-FLAG
064640        GO TO B299-EXIT.
TB0027
TB0027     IF  DBIO-CALL-STATUS = "****"
TB0027         MOVE "READ" TO DBIOMOD-FUNCTION
TB0027         PERFORM B5100-ACCESS-BOIS THRU B5199-EXIT
TB0027         IF DBIOMOD-STAT NOT = "****"
TB0027            GO TO B299-EXIT
TB0027         END-IF
TB0027     END-IF.
TB0027
064650     MOVE STRT-AREA-LEDG-CODE TO WA-STORE-LEDG-CODE.
064660     MOVE BORM-LST-FIN-DATE TO WA-STORE-LST-FIN-DT.
064670     MOVE BORM-NO-PER-TRN TO WA-STORE-TOT-TRNS.
064680     MOVE BORM-LOAN-BAL TO WA-STORE-LN-BAL-IN.
064690     MOVE BORM-EOM-BASIC-BAL TO WA-STORE-EOM-BAS-IN.
064700     MOVE BORM-EOY-BASIC-BAL TO WA-STORE-EOY-BAS-IN.
064710     MOVE 0                  TO WA-OUT-BAL-T
064720                              WA-TBR7-OT-INT-PB-T
064730                              WA-OUT-CHARGES-T.
064740     MOVE BORM-NO-NPB        TO WA-OUT-NPB-NO-T.
064750     MOVE BORM-NPB-VAL       TO WA-OUT-NPB-VAL-T.
SC3158     MOVE BOIS-GRACE-PERIOD  TO WA-PREV-BOIS-GRACE-PERIOD
SC8046     MOVE BORM-REM-REPAYS    TO WA-SV-REM-REPAYS.
TB0015     MOVE 1                TO UT0500CA-CALL-CODE.
TB0015     MOVE BORM-CUSTOMER-NO TO UT0500CA-CUSM-NO.
SC5863     MOVE BORM-BR-NO       TO WA-SAVE-GL-BR-NO.
SC5863     MOVE BORM-ACT-TYPE    TO WA-SAVE-GL-ACCT-TYPE
SC5863     MOVE BORM-CAT         TO WA-SAVE-GL-INT-CAT  
S16013     MOVE BORM-GL-CLASSIFICATION-CODE TO WS-SAVE-GL-CLASS-CODE.
TB0015     PERFORM V500-CALL-UT0500 THRU V599-EXIT.
S11927     MOVE WS-UT0500RA-CUSM-STATUS-SAVE TO WA-SAVE-CUST-STATUS.
S16182*S12520     MOVE UT0500RA-ACC-NO  TO UTCICECA-CUST-NO.
064760     IF BORM-SOC-NO   NOT = BORP-SOC-NO
064770     OR BORM-ACT-TYPE NOT = BORP-ACCT-TYPE
064780     OR BORM-CAT      NOT = BORP-INT-CAT
064790        MOVE 02 TO UT2000CA-CALL-CODE
064800        MOVE 0 TO UT2000CA-CALL-INDEX
064810        MOVE BORM-SOC-NO TO UT2000CA-CALL-SOC-NO
064820        MOVE BORM-ACT-TYPE TO UT2000CA-CALL-ACCT-TYPE
064830        MOVE BORM-CAT TO UT2000CA-CALL-INT-CAT
064840        PERFORM D100-CALL-UT2000 THRU D199-EXIT
064850        IF  WA-MSG-ERR-FLAG = 1
064860            MOVE UT8500CA-FUNC-NORMAL-DISPLAY
064870                            TO UT8500CA-CALL-CODE
064880            MOVE SPACES TO UT8500CA-INPUT-MSG
064890            STRING "BR0000(B200) ERROR IN RETURN FROM D100 "
064900            BORM-ACT-TYPE " " BORM-CAT
064910            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
064920            CALL "UT8500" USING
064930                       UT8500CA-AREA.
064940 B299-EXIT.
064950     EXIT.
064960/
S15963 B210-ODTOLOAN-RTN.
S15963
S15963     INITIALIZE INOD-ALT3-KEY.
S15963     MOVE STRT-AREA-SOC-NO      TO INOD-ALT3-SOC-NO.
S15963     MOVE WA-INPUT-ACCT-NO      TO INOD-ALT3-OD-NO.
S15963     MOVE ZEROS                 TO INOD-ALT3-DEP-NO.
S15963     MOVE 3                     TO DBIOMOD-KEY-NO.
S15963     MOVE INOD-ALT3-KEY         TO DBIOMOD-KEY.
S15963     MOVE "READNEXT"            TO DBIOMOD-FUNCTION.
S15963     PERFORM H400-ACCESS-INOD THRU H499-EXIT
S15963     IF DBIOMOD-STAT         NOT = "****"
S15963     OR WA-INPUT-ACCT-NO     NOT = INOD-OD-NO
S15963     OR INOD-ACCT-STATUS     NOT = ("A" AND "E")
S15963        GO TO B210-EXIT
S15963     END-IF.
S15963
S15963     PERFORM B211-INVM-RTM    THRU B211-EXIT.
S15963     IF WA-MSG-ERR-FLAG = 1
S15993*S15963 GO TO B211-EXIT
S15993        GO TO B210-EXIT
S15963     END-IF
S15963     PERFORM B212-CALL-IN0095 THRU B212-EXIT.
S15963
S15963 B210-EXIT.
S15963     EXIT.
S15963
S15963 B211-INVM-RTM.
S15963
S15963     MOVE INOD-DEP-NO           TO INVM-MEMB-CUST-AC.
S15963     PERFORM B1000-READ-INVM  THRU B1999-EXIT.
S15963     IF DBIO-CALL-STATUS = "****"
S15963        MOVE INVM-SOC-NO        TO UT0200-CALL-SOC-NO
S15963        MOVE INVM-ACCT-TYPE     TO UT0200-CALL-ACCT-TYPE-A
S15963        MOVE INVM-INT-CAT       TO UT0200-CALL-INT-CAT-A
S15963        MOVE 0                  TO UT0200-CALL-INDEX
S15963                                   UT0200-CALL-STATUS
S15963        MOVE 02                 TO UT0200-CALL-CODE
S15963        CALL "UT0200"        USING UT0200-CALL-AREA
S15963        IF   UT0200-CALL-STATUS NOT = 0
S15963             DISPLAY "BR0000: (H000) ERROR IN READ DEPP"
S15963                     ", KEY =" INVM-ACCT-TYPE " - " INVM-INT-CAT
S15963                     ", STATUS =" UT0200-CALL-STATUS
S15963             MOVE 1   TO WA-MSG-ERR-FLAG
S15963             MOVE 108 TO WA-OUTPUT-ERR-MSG-NO
S15963             GO       TO B211-EXIT
S15963        END-IF
S15963     END-IF
S15963     MOVE STRT-AREA-SOC-NO      TO INVE-SOC-NO.
S15963     MOVE "READ"                TO DBIOMOD-FUNCTION.
S15963     PERFORM M003-ACCESS-INVE THRU M003-EXIT.
S15963
S15963 B211-EXIT.
S15963     EXIT.
S15963
S15963 B212-CALL-IN0095.
S15963**** SAVE START AREA
S15963     MOVE STRT-AREA-DATA         TO WA-SAVE-ST-AREA-DATA.
S15963     MOVE WA-INPUT-MSG           TO WA-SAVE-ST-AREA-INPUT-MSG.
S15963     MOVE STRT-AREA-TRN-NO       TO WA-SAVE-ST-AREA-TRN-NO.
S15963     MOVE 2057                   TO LINK-IN-TXCODE
S15963                                    STRT-AREA-TRN-NO.
S15963     MOVE STRT-AREA-SOC-NO       TO LINK-IN-SOC-NO.
S15963     MOVE 02                     TO LINK-IN-CALL-CODE.
S15963     CALL "UT0250" USING LINK-AREA
S15963     IF  LINK-OUT-STAT NOT = "****"
S15963        GO TO B212-EXIT
S15963     END-IF.
S15963     MOVE LINK-EDIT-TABLE        TO STRT-AREA-EDIT-MASK.
S15963
S15963     MOVE INOD-DEP-NO            TO IN0095-IN-2057-DEP-NO.
S15963     MOVE SPACES                 TO IN0095-IN-2057-ID-NO
S15963                                    IN0095-IN-2057-CUST-NAME.
S15963     MOVE "G"                    TO IN0095-IN-2057-ACTION-CODE.
S15963
S15963     CALL "IN0095"  USING
S15963                    STARTAREA
S15963                    ACCT-PARM
S15963                    INVE-RECORD-AREA
S15963                    WA-VOUCHER-EXTENDED-INFO.
S15963
S15963     IF WA-OUTPUT-ERR-MSG-NO      = 0
S15963        MOVE "Y"                 TO WA-OD-TO-LOAN
S15963     ELSE
S15963        MOVE 1                   TO WA-MSG-ERR-FLAG
S15963        MOVE SPACES              TO UT8500CA-INPUT-MSG
S15963        MOVE "N"                 TO UT8500CA-RESPONSE-REQD-FLAG
S15963        SET UT8500CA-NORMAL-DISPLAY TO TRUE
S15963        STRING "BR0000:(B212) IN0095 CALL ERROR "
S15963                               WA-OUTPUT-ERR-MSG-NO
S15963        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S15963        CALL "UT8500" USING UT8500CA-AREA
S15963     END-IF.
S15963**** RESTORE START AREA
S15963     MOVE WA-SAVE-ST-AREA-DATA      TO STRT-AREA-DATA.
S15963     MOVE WA-SAVE-ST-AREA-INPUT-MSG TO WA-INPUT-MSG.
S15963     MOVE WA-SAVE-ST-AREA-TRN-NO    TO STRT-AREA-TRN-NO.
S15963
S15963 B212-EXIT.
S15963     EXIT.
S15963
064970******************************************************************
064980*** T O   C H E C K   A C C T   S T A T U S ***
064990******************************************************************
065000 B300-STATUS-CHECK-PARA.
TB0212***
TB0212*** for backdating yoube processing, error trapping
TB0212***
S17197     COMPUTE WA-LAST-TERM = BORM-LOAN-TRM - BOIS-LAST-TERM-PAID
S17197     IF BOIS-NEXT-DUE-DATE < BOIS-MATURITY-DATE
S17197     AND WA-LAST-TERM = 1
S17197     AND (BORM-STAT NOT = 50)
S17197     AND BORM-1-ADDL-BILLING
S17197        ADD 1 TO WA-LAST-TERM
S17197     END-IF.
S17384     IF  BORM-1-ADDL-BILLING
S17384     AND BOIS-NEXT-DUE-DATE = BOIS-MATURITY-DATE
S17384     AND WA-LAST-TERM   NOT > 1
S17384          ADD 1            TO WA-LAST-TERM
S17384     END-IF.
TB0212     IF BORP-YOUBE
TB0212        IF STRT-BANCSLINK
TB0212           IF WA-INPUT-PARAM-TABLE(8) = 1
TB0212***
TB0212*** convert date from ddmmccyy to ccyymmdd
TB0212***
TB0212              MOVE W800-DD      TO WA-CONV-DD
TB0212              MOVE W800-MM      TO WA-CONV-MM
TB0212              MOVE W800-CC      TO WA-CONV-CC
TB0212              MOVE W800-YY      TO WA-CONV-YY
TB0212
TB0212              IF UT1999CA-CCYYMMDD = WA-CONV-DATE
TB0212                 MOVE 1    TO WA-MSG-ERR-FLAG
TB0212                 MOVE 4750 TO WA-OUTPUT-ERR-MSG-NO
TB0212              END-IF
TB0212           END-IF
TB0212        END-IF
TB0212     END-IF.
065010     IF  WA-INPUT-PARAM-TABLE(11) = 1
065020         GO TO B399-EXIT.
065030     IF  BORM-STAT = 10
S15893     AND STRT-AREA-TRN-NO NOT = 10729
S17239      IF  BORP-YOUBE
S17239      AND (STRT-AREA-TRN-NO = 13052 OR 13152 )
S17239          NEXT SENTENCE
S17239      ELSE
S17464      IF  (STRT-AREA-TRN-NO   =   17050
S17464      AND BR0001-SH-ENQ-TYPE  =   "B")
S17464      OR  (STRT-AREA-TRN-NO   =   17200
S17464      AND  WA-17200-FUNC      =   "25")
S17464          NEXT SENTENCE
S17464      ELSE
065040         MOVE 138 TO WA-OUTPUT-ERR-MSG-NO
065050         MOVE 1 TO WA-MSG-ERR-FLAG
065060         GO TO B399-EXIT.
065070* IF PENDING DISCHARGE, ONLY ALLOW DISCHARGE OR ENQUIRIES
065080     IF  BORM-STAT = 20  AND
065090         WA-INPUT-PARAM-TABLE(25) = 0 AND
065100         WA-INPUT-PARAM-TABLE(26) = 0 AND
065110        (STRT-AREA-TRN-NO NOT = 12477 AND 12577)
SC5579        AND (STRT-AREA-TRN-NO NOT = 10240 AND 10243 AND 
SC7289              10724 AND 10726 AND
SC9119              13042 AND 13142 AND
S12078              17200 AND 10872 AND
S16725              17034 AND 17466 AND
S11789              10244 AND 10434 AND 10245)
S11789*             10244 AND 10434 )
065120            MOVE 165 TO WA-OUTPUT-ERR-MSG-NO
065130            MOVE 1   TO WA-MSG-ERR-FLAG
065140            GO TO B399-EXIT.
065150* IF PENDING DISCHARGE, DISCHARGE ENQUIRY MUST HAVE ALREADY BEEN
065160* DONE, SO SEND SUP IF ANOTHER DISCHARGE ENQUIRY ATTEMPTED.
065170     IF  BORM-STAT = 20 AND STRT-AREA-TRN-NO = 13000
065180         MOVE 3042 TO UT0060CA-CALL-ERROR-CODE
065190         PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
065200         IF WA-MSG-ERR-FLAG = 0
065210            MOVE 3042 TO WA-ERR-MSG-NO
065220         ELSE
065230            MOVE 3042 TO WA-OUTPUT-ERR-MSG-NO
065240            MOVE 1    TO WA-MSG-ERR-FLAG
065250            GO TO B399-EXIT.
065260* IF DISCHARGED, ONLY ALLOW ENQUIRIES
065270     IF  BORM-STAT = 40 AND WA-INPUT-PARAM-TABLE(26) = 0
TB0102         IF BORP-DISCH-ENQ-REQD = "N" AND
TB0102           (STRT-AREA-TRN-NO = 13111 OR 13110 OR  13145 OR 13146
TB0232*                              OR 15109 OR  15145 OR 15146)                SC5259  
SC6379*                  OR 10726 OR 10724 OR 15109 OR  15145 OR 15146)          SC5259
S11271            OR 10726 OR 10724 OR 15109 OR 15145 OR 15146 OR 10723
S12068*S11271            OR 10728)
S16235*S12068            OR 10728 OR 10729)
S20383*S16235            OR 10728 OR 10729 OR 13147 OR 15147)
S20383            OR 10728 OR 10729 OR 13147 OR 15147 OR 17034 OR 17466)
TB0102           NEXT SENTENCE                                                           
TB0102         ELSE
SC2620            IF (STRT-AREA-TRN-NO = 17050
SC2620             AND BR0001-SH-ENQ-TYPE = 6)
S17464             OR  (STRT-AREA-TRN-NO  = 17200
S17464             AND  WA-17200-FUNC     = "25")
SC5708*S10739      OR ((STRT-AREA-TRN-NO = 17050 OR 17000 OR 17036)
S10739             OR ((STRT-AREA-TRN-NO = 17050 OR 17000 OR 17036
S16329                         OR 13012 OR 13112 OR 13042 OR 13142
S17813                         OR 13043 OR 13143
S18398                         OR 13158
S17173*S10739                                    OR 13058 OR 63058)
S17173                         OR 13052 OR 13152 OR 13058 OR 63058)
SC5708             AND BORM-STAT = 40)
SC2620               NEXT SENTENCE
SC2620            ELSE
065280            MOVE 168 TO WA-OUTPUT-ERR-MSG-NO
065290            MOVE 1 TO WA-MSG-ERR-FLAG
065300            GO TO B399-EXIT.
065310     IF  WA-INPUT-PARAM-TABLE(17) = 1
065320         IF  BORM-STAT < 1
065330             MOVE 195  TO UT0060CA-CALL-ERROR-CODE
065340             PERFORM Y000-OVERRIDABLE-ERROR-CHECK
065350                                     THRU Y090-EXIT
065360             IF WA-MSG-ERR-FLAG = 0
065370                MOVE 195 TO WA-ERR-MSG-NO
065380             ELSE
065390                MOVE 195 TO WA-OUTPUT-ERR-MSG-NO
065400                MOVE 1    TO WA-MSG-ERR-FLAG
065410                GO TO B399-EXIT.
065420     IF  WA-INPUT-PARAM-TABLE(5) = 1
SC2936*        IF  NOT (BORM-STAT = 3 OR 5 OR 6 OR 7 OR 8)
SC2936         IF  NOT (BORM-STAT = 3 OR 5 OR 6 OR 7 OR 8 OR 50)
S17173             IF  (STRT-AREA-TRN-NO = 13052 OR 13152 )
S17239*S17173             AND  BORM-STAT = 40
S17239             AND ( BORM-STAT = 40
S17239              OR ( BORM-STAT =  10
S17239             AND   BORP-YOUBE      ))
S17173                NEXT SENTENCE
S17173             END-IF
TB0082**--
TB0082**-- bypass approve and accept transaction
TB0082             IF BORP-APR-REQD = "N" AND
TB0082                BORP-ACCEPT-TXN-REQUIRED = "N" AND
TB0082                BORM-STAT = 1
TB0082                NEXT SENTENCE
TB0082             ELSE
TB0082**--
065440                MOVE 195  TO UT0060CA-CALL-ERROR-CODE
065450                PERFORM Y000-OVERRIDABLE-ERROR-CHECK
065460                                     THRU Y090-EXIT
065470                IF WA-MSG-ERR-FLAG = 0
065480                   MOVE 195 TO WA-ERR-MSG-NO
065490                ELSE
065500                   MOVE 195 TO WA-OUTPUT-ERR-MSG-NO
065510                   MOVE 1    TO WA-MSG-ERR-FLAG
065520                   GO TO B399-EXIT
TB0082**--
TB0082                END-IF
TB0082             END-IF.
TB0082**--
065530*
TB0159     IF BORP-YOUBE
S17755        OR BORP-ILOAN-R
TB0190        OR WA-CUST-INC-EXP-FEES
SC1171        OR ( BORP-LOAN-CLASS = 2
SC9328                   AND STRT-AREA-BATCH-TANDEM = "B")
SC1505        OR (STRT-AREA-TRN-NO = 16045 AND
SC1505           STRT-AREA-BATCH-TANDEM = "B")
TB0159        NEXT SENTENCE
TB0159     ELSE
065540     IF WA-INPUT-PARAM-TABLE (4) = 1
065550      AND WA-INPUT-PARAM-TABLE (25) NOT = 1
065560        IF (BORM-STAT > 0 AND BORM-STAT < 9)
SC2617        OR (BORM-STAT = 50)
SC6545           IF BORM-BAD-DEBT-IND = 52 OR 02 OR 53
SC6545                               OR 54 OR 59 OR 03
S12786                               OR 04
SC6545               GO TO B399-EXIT
SC6545           END-IF
065570           IF WA-REPAY-AMOUNT NOT < BORM-LOAN-BAL
065580              IF WA-INPUT-PARAM-TABLE (7) = 1
SC4775*                OR  WA-DEBIT-REPAY-TRCODE
065600                 OR STRT-BATCH-TXN
TB0099                 OR (STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048)
TB0099                 AND BORP-COMML
065610                 GO TO B399-EXIT
065620*             ELSE MOVE 171 TO WA-OUTPUT-ERR-MSG-NO                      
065630* Keymatrix 30 Day Loans can reduce the loan balance to zero             
065640              ELSE
065650                  IF  BORP-REPAY-SCHED = "C"
065660                      GO TO B399-EXIT
065670                  END-IF                                                 
SC1006
SC1006                  IF WA-REPAY-AMOUNT = BORM-LOAN-BAL
SC1006                   AND (STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048
S12384                                       OR 16044 OR 16048)
SC1006*S12384                                OR 16030 OR 16044 OR 16048)
SC1006                      GO TO B399-EXIT
SC1006                  END-IF
SC1006
SC1742                  IF BORM-REM-REPAYS = 1 AND BORP-COMML
SC1742                      GO TO B399-EXIT
SC1742                  END-IF
SC1742
SC2355                  IF BORM-LOAN-BAL = 0
sc2355                     GO TO B399-EXIT
sc2355                  END-IF
SC2355
SC7548                  IF BOIS-NEXT-DUE-DATE = BOIS-MATURITY-DATE  
SC7548                  AND (BORM-REM-REPAYS NOT > 0)  
SC7548                  AND (BORM-STAT NOT = 50)  
SC7548                  AND BORM-1-ADDL-BILLING  
SC7548                     GO TO B399-EXIT  
SC7548                  END-IF  
S17384                  IF (BORP-CONSMR OR
S17384                     BORP-CONSMR-MORT-COMBI) AND
S17384                     (BORP-REPAY-SCHED = "F" OR "G") AND
S17384                     WA-LAST-TERM > 1
S17384                     GO TO B399-EXIT
S17384                  END-IF
SC9750
SC9750                  IF (BORP-CONSMR OR
SC9750                     BORP-CONSMR-MORT-COMBI) AND
SC9750                     (BORP-REPAY-SCHED = "F" OR "G") AND
S17384                     (BORM-REM-REPAYS > 1)
S17301*SC9750                     (BORM-REM-REPAYS > 1)
S17384*S17301             ((BORM-REM-REPAYS  > 1 ) OR
S17384*S17301              (BOIS-ARREARS-CTR > 0 ))
SC9750                     GO TO B399-EXIT
SC9750                  END-IF
SC9750
S11142*** Since we are sure that billing amount for principal will not
S11142*** exceed loan balance, if there is arrears ctr it will contain
S11142*** interest and principal which will not exceed loan balance.
S11142                  IF BOIS-ARREARS-CTR > 0
S11289                  AND BORM-REPAY-SCHED = "B"
S11142                     GO TO B399-EXIT
S11142                  END-IF
S11142
S19705                  IF  PROD-RICHART
S19705                  AND BORM-REPAY-SCHED = "N"
S19705                     GO TO B399-EXIT
S19705                  END-IF
S19705
S17197                  IF BORP-ALBPS
S17197                     AND  WA-LAST-TERM = 1
S17197                     GO TO B399-EXIT
S17197                  END-IF
065680                   MOVE 171 TO WA-OUTPUT-ERR-MSG-NO
065690                   MOVE 1 TO WA-MSG-ERR-FLAG
065700                   GO TO B399-EXIT
065710           ELSE GO TO B399-EXIT
065720        ELSE
065730             MOVE 195  TO UT0060CA-CALL-ERROR-CODE
065740             PERFORM Y000-OVERRIDABLE-ERROR-CHECK
065750                                     THRU Y090-EXIT
065760             IF WA-MSG-ERR-FLAG = 0
065770                MOVE 195 TO WA-ERR-MSG-NO
065780             ELSE
065790                MOVE 195 TO WA-OUTPUT-ERR-MSG-NO
065800                MOVE 1    TO WA-MSG-ERR-FLAG
065810                GO TO B399-EXIT.
065820     IF  WA-INPUT-PARAM-TABLE(25) = 1
065830         IF  BORM-STAT NOT > 30
SC2452          OR BORM-STAT = 50
065840             NEXT SENTENCE
065850         ELSE
TB0102         IF BORP-DISCH-ENQ-REQD = "N" AND
TB0102           (STRT-AREA-TRN-NO = 13111 OR 13110 OR  13145 OR 13146
S16235                              OR 13147 OR 15147
TB0232                              OR 15109 OR  15145 OR 15146)
TB0102           NEXT SENTENCE
TB0102         ELSE
065860             MOVE 168 TO WA-OUTPUT-ERR-MSG-NO
065870             MOVE 1 TO WA-MSG-ERR-FLAG
065880             GO TO B399-EXIT.
065890 B399-EXIT.
065900     EXIT.
065910/
065920******************************************************************
065930*** T O   C H E C K   S T O P   S T A T U S ***
065940******************************************************************
065950 B400-STOP-CHECK-PARA.
065960     IF SOC-LOANS-TRACKING-OPTION = "Y" AND
065970         WA-INPUT-PARAM-TABLE(22) = 1
065980         AND
065990         WA-INPUT-PARAM-TABLE(11) = 1
066000         GO TO B499-EXIT.
066010     IF  WA-INPUT-PARAM-TABLE(12) = 1
066020         OR  STRT-AREA-EFT-TXN
066030         GO TO B499-EXIT.
066040     IF  BORM-STOP-IND > 0
066050*CHECK FOR  OVERRIDE-AUTHORISATION FOR STOPED ACCT
066060         MOVE 113 TO UT0060CA-CALL-ERROR-CODE
066070         PERFORM Y000-OVERRIDABLE-ERROR-CHECK
066080                                       THRU Y090-EXIT
066090         IF WA-MSG-ERR-FLAG = 0
066100               MOVE 113 TO WA-ERR-MSG-NO
066110         ELSE
066120               MOVE 113 TO WA-OUTPUT-ERR-MSG-NO
066130               MOVE SPACES TO WA-OUTPUT-MSG
066140               MOVE "STOP" TO WA-OUTPUT-STOP-MSG
NR2001*066150               MOVE 30 TO DBIO-CALL-TXN-TYPE
NR2001*066160               PERFORM W100-READ-STOP-HOLD-TRAN THRU W199-EXIT
NR2001*066170               IF  DBIO-CALL-STATUS NOT = "****"
NR2001*066180                   GO TO B499-EXIT
NR2001*066190               ELSE MOVE BORV-30-STOP-REASON-NO TO
NR2001*066200                         WA-STOP-INDICATOR
NR2001*066210                    MOVE BORV-30-TELL-AND-BR TO
NR2001               MOVE 30     TO WS-BOCT-TRAN-TYPE
NR2001               PERFORM W100-READ-STOP-HOLD-TRAN THRU W199-EXIT
NR2001               IF  NOT UTBOCTCA-OK
NR2001                   GO TO B499-EXIT
NR2001               ELSE MOVE BOCT-30-STOP-REASON-NO TO
NR2001                         WA-STOP-INDICATOR
NR2001                    MOVE BOCT-TELL-AND-BR TO
066220                         UPTELLCA-TELLER-BRANCH
066230                    CALL "UT0021" USING UPTELLCA-PARAM-1
066240                                  UPTELLCA-PARAM-2
066250                    MOVE UPTELLCA-BRCH    TO WA-STOP-BRANCH
066260                    MOVE UPTELLCA-TELR    TO WA-STOP-TELLER
NR2001*066270                    MOVE BORV-30-STOP-REASON TO WA-STOP-REASON.
NR2001                    MOVE BOCT-30-STOP-REASON TO WA-STOP-REASON.
066280 B499-EXIT.
066290     EXIT.
066300******************************************************************
066310*** T O   C H E C K   S T O P P E D    T R A N S A C T I O N   ***
066320******************************************************************
066330*B4A0-CHECK-STOP-TRAN.
066340*    IF WA-CHQ-REPAY-TRCODE
066350*    IF WA-INPUT-PARAM-TABLE(04) = 1 AND
066360*       WA-INPUT-PARAM-TABLE(10) = 1
066370*       IF BORM-STOP-TRAN-IND = "1"
066380*          MOVE 1970 TO WA-OUTPUT-ERR-MSG-NO
066390*          MOVE 1 TO WA-MSG-ERR-FLAG.
066400*B4A9-EXIT.
066410*    EXIT.
066420******************************************************************
066430*** T O   C H E C K   H O L D   S T A T U S ***
066440******************************************************************
066450 B500-HOLD-CHECK-PARA.
066460     IF SOC-LOANS-TRACKING-OPTION = "Y" AND
066470         WA-INPUT-PARAM-TABLE(22) = 1
066480         AND
066490         WA-INPUT-PARAM-TABLE(11) = 1
066500         GO TO B599-EXIT.
066510     IF  WA-INPUT-PARAM-TABLE(13) = 1
066520         OR  STRT-AREA-EFT-TXN
066530         GO TO B599-EXIT.
066540     IF  BORM-HOLD-IND > 0
066550*CHECK FOR  OVERRIDE-AUTHORISATION
066560         MOVE 854 TO UT0060CA-CALL-ERROR-CODE
066570         PERFORM Y000-OVERRIDABLE-ERROR-CHECK
066580                                       THRU Y090-EXIT
066590         IF WA-MSG-ERR-FLAG = 0
066600               MOVE 854 TO WA-ERR-MSG-NO
066610         ELSE
066620          MOVE SPACES TO WA-OUTPUT-MSG
066630          MOVE "HOLD" TO WA-OUTPUT-HOLD-MSG
066640*****     MOVE 113 TO WA-OUTPUT-ERR-MSG-NO
066650          MOVE 854 TO WA-OUTPUT-ERR-MSG-NO
066660          MOVE 1 TO WA-MSG-ERR-FLAG
NR2001*066670          MOVE 31 TO DBIO-CALL-TXN-TYPE
NR2001*066680          PERFORM W100-READ-STOP-HOLD-TRAN THRU W199-EXIT
NR2001*066690          IF  DBIO-CALL-STATUS NOT = "****"
NR2001*066700              GO TO B599-EXIT
NR2001*066710          ELSE MOVE BORV-31-HOLD-VAL TO WA-WORK-AMOUNT
NR2001          MOVE 31     TO WS-BOCT-TRAN-TYPE
NR2001          PERFORM W100-READ-STOP-HOLD-TRAN THRU W199-EXIT
NR2001          IF  NOT UTBOCTCA-OK
NR2001              GO TO B599-EXIT
NR2001          ELSE MOVE BOCT-31-HOLD-VAL TO WA-WORK-AMOUNT
066720              PERFORM C100-MOVE-DATA THRU C109-EXIT
066730              MOVE WA-EDIT-BAL-AMT TO WA-HOLD-VALUE
NR2001*066740              MOVE BORV-31-TELL-AND-BR TO UPTELLCA-TELLER-BRANCH
NR2001              MOVE BOCT-TELL-AND-BR TO UPTELLCA-TELLER-BRANCH
066750              CALL "UT0021" USING UPTELLCA-PARAM-1
066760                                  UPTELLCA-PARAM-2
066770              MOVE UPTELLCA-BRCH    TO WA-HOLD-BRANCH
066780              MOVE UPTELLCA-TELR    TO WA-HOLD-TELLER
NR2001*066790              MOVE BORV-31-HOLD-REASON TO WA-HOLD-REASON.
NR2001              MOVE BOCT-31-HOLD-REASON TO WA-HOLD-REASON.
066800 B599-EXIT.
066810     EXIT.
066820/
066830******************************************************************
066840*** T O   C H E C K   A P P R O V A L  O N  F I L E ***
066850******************************************************************
066860 B600-APPROVED-CHECK-PARA.
066870     IF  BORM-APP-AMT NOT > ZEROS
SC5826       AND NOT BORP-YOUBE
S16866       AND NOT VALID-OD-TRF-TO-LON
S12277*S12384 AND NOT (BORP-CONSMR AND (BORP-SUB-TYPE = "F" OR "A"))
S12384       AND NOT (BORP-CONSMR AND
S15922*S12384               (BORP-NEGO-PROD OR BORP-SUB-TYPE = "A"))
S15922     (BORP-NEGO-PROD OR BORP-PUBLIC-CONFER))
066880         MOVE 134 TO UT0060CA-CALL-ERROR-CODE
066890         PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
066900         IF WA-MSG-ERR-FLAG = 0
066910             MOVE 134 TO WA-ERR-MSG-NO
066920             GO TO B619-EXIT
066930         ELSE
066940             MOVE 134 TO WA-OUTPUT-ERR-MSG-NO
066950             MOVE 1 TO WA-MSG-ERR-FLAG
066960             GO TO B619-EXIT.
066980     IF WA-INPUT-PARAM-TABLE(5) = 1
066990*
067000       IF (BORP-ACCEPT-TXN-REQUIRED = "Y")
067010         AND (BORM-STAT < 5)
067020             MOVE 1828 TO UT0060CA-CALL-ERROR-CODE
067030             PERFORM Y000-OVERRIDABLE-ERROR-CHECK
067040                                   THRU Y090-EXIT
067050             IF WA-MSG-ERR-FLAG = 0
067060               MOVE 1828 TO WA-ERR-MSG-NO
067070               GO TO B619-EXIT
067080             ELSE
067090               MOVE 1828 TO WA-OUTPUT-ERR-MSG-NO
067100               MOVE 1 TO WA-MSG-ERR-FLAG
067110               GO TO B619-EXIT
067120             END-IF
067130       ELSE
067140       IF (BORM-STAT < 3)
TB0082**--
TB0082**-- bypass approve and accept transaction
TB0082          IF BORP-APR-REQD = "N" AND
TB0082             BORP-ACCEPT-TXN-REQUIRED = "N" AND
TB0082             BORM-STAT = 1
TB0082             NEXT SENTENCE
TB0082          ELSE
TB0082**--
067150             MOVE 134 TO UT0060CA-CALL-ERROR-CODE
067160             PERFORM Y000-OVERRIDABLE-ERROR-CHECK
067170                                THRU Y090-EXIT
067180             IF WA-MSG-ERR-FLAG = 0
067190                MOVE 134 TO WA-ERR-MSG-NO
067200*               GO TO B619-EXIT
067210             ELSE
067220                MOVE 134 TO WA-OUTPUT-ERR-MSG-NO
067230                MOVE 1 TO WA-MSG-ERR-FLAG
067240*               GO TO B619-EXIT
067250             END-IF
TB0082**--
TB0082          END-IF
TB0082**--
067260       END-IF
067270     END-IF.
067280*      IF BORM-STAT < 5
067290*
067300*         MOVE 134 TO UT0060CA-CALL-ERROR-CODE
067310*         PERFORM Y000-OVERRIDABLE-ERROR-CHECK
067320*                              THRU Y090-EXIT
067330*      IF WA-MSG-ERR-FLAG = 0
067340*         MOVE 1828 TO WA-ERR-MSG-NO
067350*      ELSE
067360*         MOVE 1828 TO WA-OUTPUT-ERR-MSG-NO
067370*         MOVE 1 TO WA-MSG-ERR-FLAG.
067380 B619-EXIT.
067390     EXIT.
067400/
067410 BB620-CALL-UT0296.
067420     IF   WA-INPUT-PARAM-TABLE (4) =  1
067430       OR
067440          WA-INPUT-PARAM-TABLE (5) = 1
067450          NEXT    SENTENCE
067460     ELSE
067470          GO  TO  BB629-EXIT.
067480*    IF  WA-INPUT-PARAM-TABLE (29) = 0
067490*    AND (WA-INPUT-PARAM-TABLE (4) = 1  OR
067500*         WA-INPUT-PARAM-TABLE (5) = 1)
S12441*S11626     IF  (STRT-AREA-TRN-NO = 11058 OR 16058)
S18857*S12441     IF  (STRT-AREA-TRN-NO = 11058 OR 16058 OR 11030 OR 16030)
S18857*S11626     AND  STRT-AREA-BATCH-TANDEM = 'B'
S18857     IF  (STRT-AREA-TRN-NO = 11058 OR 16058 OR 11030 OR 16030
S18857                          OR 13058 OR 63058 OR 13042 OR 63042
S18857                          OR 13052 OR 63052 OR 11049 OR 16049 )
S18857     AND (STRT-AREA-BATCH-TANDEM = "B" OR "T" )
S11626          MOVE SPACES             TO WA-MULTI-ACCT-CURR-CD
S11626                                     WA-MULTI-CURR-AMT-CURR-CD
S11626                                     WA-MULTI-CURR-VERSION
S11626          MOVE ZEROES             TO WA-MULTI-CURR-AMT
S11626                                     WA-MULTI-BASE-CURR-AMT
S11626                                     WA-MULTI-COMMISSION
S11626                                     WA-MULTI-CHANGE
S11626                                     WA-MULTI-RATE-TYPE
S11626     END-IF.
067510     IF  (WA-INPUT-PARAM-TABLE (4) = 1  OR
067520          WA-INPUT-PARAM-TABLE (5) = 1)
NLB205*         IF WA-MULTI-CURR-AMT = 0
NLB205*            MOVE BORM-CURRENCY-IND TO WA-MULTI-CURR-AMT-CURR-CD
NLB205*                                      WS-SAVE-TXN-CURRENCY
NLB205*            MOVE WA-INPUT-AMT      TO WA-MULTI-CURR-AMT
NLB205*                                      WA-SAVE-TXN-AMT
NLB205*         END-IF
TB0102          IF BORP-DISCH-ENQ-REQD = "N" AND
TB0232             WA-INPUT-PARAM-TABLE (25) = 1
TB0232*          (STRT-AREA-TRN-NO = 13010 OR 13110 OR  13011 OR 13111
TB0232*                           OR 13045 OR  13145 OR 13046 OR 13146)
TB0102             MOVE BORM-CURRENCY-IND TO WA-MULTI-ACCT-CURR-CD
TB0102                                       WA-ACCT-CURR-CD
TB0102                                       WS-SAVE-TXN-CURRENCY
TB0102             GO TO BB629-EXIT
TB0102          END-IF
TB0102
067590          IF WA-MULTI-ACCT-CURR-CD = SPACES
067600             MOVE BORM-CURRENCY-IND TO WA-MULTI-ACCT-CURR-CD
067610                                       WA-ACCT-CURR-CD
067620          END-IF
NLB205         
NLB205          IF WA-MULTI-CURR-AMT-CURR-CD = SPACES
NLB205             MOVE BORM-CURRENCY-IND TO WA-MULTI-CURR-AMT-CURR-CD
NLB205                                       WS-SAVE-TXN-CURRENCY
NLB205          END-IF
NLB205
NLB205          IF WA-MULTI-CURR-AMT = 0
NLB205             IF WA-MULTI-ACCT-CURR-CD = WA-MULTI-CURR-AMT-CURR-CD
NLB205                MOVE WA-INPUT-AMT TO WA-MULTI-CURR-AMT
NLB205                                     WA-SAVE-TXN-AMT
NLB205             END-IF
NLB205          END-IF
NLB205
067760          IF WA-MULTI-CURR-VERSION = SPACES
067770             MOVE "ZZZZ"            TO WA-MULTI-CURR-VERSION
067780          END-IF
067790          IF WA-MULTI-RATE-TYPE = 0
067800             MOVE 01                TO WA-MULTI-RATE-TYPE
067810          END-IF
067820          IF WA-MULTI-ACCT-CURR-CD = BORM-CURRENCY-IND
067830             NEXT SENTENCE
067840          ELSE
067850             MOVE 744               TO WA-OUTPUT-ERR-MSG-NO
067860             MOVE 1                 TO WA-MSG-ERR-FLAG
067870             GO TO BB629-EXIT.
067880     IF   SOC-MULTI-CURRENCY   = "0"
067890          GO   TO   BB629-EXIT.
067900     IF   SOC-MULTI-CURRENCY   = "1"
067910         IF WS-SAVE-TXN-CURRENCY  =  BORM-CURRENCY-IND
067920***********IF  WS-SAVE-TXN-CURRENCY  =  SOC-NATIVE-CURRENCY
067930***********GO  TO  BB629-EXIT
067940***********ELSE
067950               GO  TO  BB629-10
067960         ELSE
067970               MOVE  746   TO  WA-OUTPUT-ERR-MSG-NO
067980               MOVE  1     TO  WA-MSG-ERR-FLAG
067990               GO  TO  BB629-EXIT.
068000*****IF   SOC-MULTI-CURRENCY  = "2"
068010********IF  WA-ACCT-CURR-CD  =  WS-SAVE-TXN-CURRENCY
068020**********IF WA-ACCT-CURR-CD =  SOC-NATIVE-CURRENCY
068030*************GO  TO  BB629-EXIT.
068040 BB629-10.
068050     IF WA-MULTI-ACCT-CURR-CD  NOT  =  BORM-CURRENCY-IND
068060         MOVE  744                TO WA-OUTPUT-ERR-MSG-NO
068070         MOVE  1                  TO WA-MSG-ERR-FLAG
068080         GO                       TO BB629-EXIT.
068100     IF  WA-INPUT-PARAM-TABLE (29) =  1
NLB205*    AND WA-INPUT-PARAM-TABLE (4) =  1
NLB205         IF WA-INPUT-AMT = 0
NLB205            MOVE WA-MULTI-ACCT-CURR-CD  TO UT0296CA-FROM-CURRENCY
NLB205            MOVE WA-INPUT-AMT           TO UT0296CA-FROM-AMOUNT
NLB205            MOVE WA-MULTI-CURR-AMT-CURR-CD
NLB205                                        TO UT0296CA-TO-CURRENCY
NLB205            MOVE WA-MULTI-CURR-AMT      TO UT0296CA-TO-AMOUNT
NLB205         ELSE
068190            MOVE WA-MULTI-CURR-AMT-CURR-CD
068200                                        TO UT0296CA-FROM-CURRENCY
068210            MOVE WA-MULTI-CURR-AMT      TO UT0296CA-FROM-AMOUNT
068220            MOVE WA-MULTI-ACCT-CURR-CD  TO UT0296CA-TO-CURRENCY
068230            MOVE WA-INPUT-AMT           TO UT0296CA-TO-AMOUNT
NLB205            IF WA-MULTI-CURR-AMT = 0
NLB205               MOVE "Y"                TO  WA-SET-UT0296-CALL-2
NLB205            END-IF
NLB205         END-IF
068280     ELSE
NLB205         IF WA-INPUT-PARAM-TABLE (4) = 1
NLB205            IF WA-INPUT-AMT = 0
068310               MOVE WA-MULTI-ACCT-CURR-CD 
NLB205                                        TO UT0296CA-FROM-CURRENCY
068330               MOVE WA-INPUT-AMT        TO UT0296CA-FROM-AMOUNT
068340               MOVE WA-MULTI-CURR-AMT-CURR-CD
068350                                        TO UT0296CA-TO-CURRENCY
068360               MOVE WA-MULTI-CURR-AMT   TO UT0296CA-TO-AMOUNT
NLB205            ELSE
NLB205               MOVE WA-MULTI-CURR-AMT-CURR-CD
NLB205                                        TO UT0296CA-FROM-CURRENCY
NLB205               MOVE WA-MULTI-CURR-AMT   TO UT0296CA-FROM-AMOUNT
NLB205               MOVE WA-MULTI-ACCT-CURR-CD
NLB205                                        TO UT0296CA-TO-CURRENCY
NLB205               MOVE WA-INPUT-AMT        TO UT0296CA-TO-AMOUNT
NLB205               IF WA-MULTI-CURR-AMT = 0
NLB205                  MOVE "Y"              TO WA-SET-UT0296-CALL-2
NLB205               END-IF
NLB205            END-IF
NLB205         ELSE
NLB205            IF WA-INPUT-AMT = 0
NLB205               MOVE WA-MULTI-ACCT-CURR-CD
NLB205                                        TO UT0296CA-FROM-CURRENCY
NLB205               MOVE WA-INPUT-AMT        TO UT0296CA-FROM-AMOUNT
NLB205               MOVE WA-MULTI-CURR-AMT-CURR-CD
NLB205                                        TO UT0296CA-TO-CURRENCY
NLB205               MOVE WA-MULTI-CURR-AMT   TO UT0296CA-TO-AMOUNT
NLB205            ELSE
NLB205               MOVE WA-MULTI-CURR-AMT-CURR-CD
NLB205                                        TO UT0296CA-FROM-CURRENCY
NLB205               MOVE WA-MULTI-CURR-AMT   TO UT0296CA-FROM-AMOUNT
NLB205               MOVE WA-MULTI-ACCT-CURR-CD
NLB205                                        TO UT0296CA-TO-CURRENCY
NLB205               MOVE WA-INPUT-AMT        TO UT0296CA-TO-AMOUNT
NLB205               IF WA-MULTI-CURR-AMT = 0
NLB205                  MOVE "Y" TO WA-SET-UT0296-CALL-2
NLB205               END-IF
NLB205            END-IF
NLB205         END-IF
NLB205     END-IF.
NLB205
068700     MOVE WA-MULTI-RATE-TYPE        TO UT0296CA-RATE-TYPE.
068710     MOVE WA-MULTI-BASE-CURR-AMT    TO
068720                             UT0296CA-FROM-BASE-EQUIVALENT.
068730     MOVE WA-MULTI-CURR-VERSION     TO UT0296CA-RATE-VERSION.
068740     MOVE WA-MULTI-COMMISSION       TO UT0296CA-COMMISSION.
068750     MOVE WA-MULTI-CHANGE           TO UT0296CA-CHANGE.
068760     IF   WA-INPUT-PARAM-TABLE (8) =  1
068770        IF   WA-INPUT-PARAM-TABLE (4) =  1
068780          MOVE WA-REPAY-TXN-DATE    TO UT0030-DATE-DDMMCCYY
068790        ELSE
068800            MOVE WA-ADV-TXN-DATE    TO UT0030-DATE-DDMMCCYY
068810        END-IF
068820        PERFORM X610-UT0030-PARA THRU X619-EXIT
068830        MOVE UT0030-BINARY-DATE     TO UT0296CA-BACKDATED-DATE
068840     ELSE
068850        MOVE  ZEROES                TO UT0296CA-BACKDATED-DATE
068860     END-IF.
068870     MOVE ZEROS                   TO UT0296CA-MULT-FROM-AMOUNT(1)
068880                                     UT0296CA-MULT-FROM-AMOUNT(2)
068890                                     UT0296CA-MULT-FROM-AMOUNT(3)
068900                                     UT0296CA-MULT-FROM-AMOUNT(4).
068910     IF    SOC-MULTI-CURRENCY    =  1
068920        MOVE  2                  TO UT0296CA-CALL-CODE
068930     ELSE
068940     IF    WA-INPUT-AMT          =  0
NLB205     OR    WA-SET-UT0296-CALL-2  = "Y"
068960        MOVE  2                  TO UT0296CA-CALL-CODE
068970     ELSE
068980        MOVE  1                  TO UT0296CA-CALL-CODE.
068990     MOVE  0                     TO UT0296CA-CALL-STATUS.
069000     MOVE  "LON"                 TO UT0296CA-SYSTEM.
069010     MOVE  SPACES                TO UT0296CA-USER-CODES-LON.
069020 BB629-CALL.
NLB205*    IF  WA-INPUT-PARAM-TABLE (29) = 0                                  
NLB205*    IF  (BORM-CURRENCY-IND NOT = SOC-NATIVE-CURRENCY) OR               
NLB205*        (WA-CHK-ACCT-CD NOT = WA-CHK-CURR-CD)                          
NLB205*        IF (WA-CHK-ACCT-CD = SPACES) OR                                
NLB205*           (WA-CHK-CURR-CD = SPACES) OR                                
NLB205*           (WA-CHK-CURR-AMT = ZEROES)                                  
NLB205*           MOVE 899 TO WA-OUTPUT-ERR-MSG-NO                            
NLB205*           MOVE "ENTER MULTI CURRENCY CODE/AMOUNT !" TO                
NLB205*                   WA-OUTPUT-MSG                                       
NLB205*           MOVE 1 TO WA-MSG-ERR-FLAG                                   
NLB205*           GO TO BB629-EXIT                                            
NLB205*        END-IF                                                         
NLB205*        IF (WA-INPUT-AMT = 0 AND WA-CHK-BASE-AMT NOT = 0) OR           
NLB205*           (WA-INPUT-AMT NOT = 0 AND WA-CHK-BASE-AMT = 0)              
NLB205*           MOVE 899 TO WA-OUTPUT-ERR-MSG-NO                            
NLB205*           MOVE "ENTER BASE AMT AND INPUT AMT (OR ALL ZERO)!"          
NLB205*                TO WA-OUTPUT-MSG                                       
NLB205*           MOVE 1 TO WA-MSG-ERR-FLAG                                   
NLB205*           GO TO BB629-EXIT                                            
NLB205*        END-IF                                                         
NLB205*    END-IF                                                             
NLB205*    END-IF.                                                            
NLB205*    IF  WA-INPUT-PARAM-TABLE (29) = 1                                  
NLB205*    IF  (BORM-CURRENCY-IND NOT = SOC-NATIVE-CURRENCY) OR               
NLB205*        (WA-CHK-ACCT-CD NOT = WA-CHK-CURR-CD)                          
NLB205*        IF (WA-CHK-ACCT-CD = SPACES) OR                                
NLB205*           (WA-CHK-CURR-CD = SPACES)                                   
NLB205*           MOVE 899 TO WA-OUTPUT-ERR-MSG-NO                            
NLB205*           MOVE "ENTER MULTI CURRENCY CODE "  TO WA-OUTPUT-MSG         
NLB205*           MOVE 1 TO WA-MSG-ERR-FLAG                                   
NLB205*           GO TO BB629-EXIT                                            
NLB205*        END-IF                                                         
NLB205*        IF (WA-CHK-CURR-AMT = 0 AND WA-CHK-BASE-AMT NOT = 0) OR        
NLB205*           (WA-CHK-CURR-AMT NOT = 0 AND WA-CHK-BASE-AMT = 0)           
NLB205*           MOVE 899 TO WA-OUTPUT-ERR-MSG-NO                            
NLB205*           MOVE "ENTER BASE AMT AND CURR AMT (OR ALL ZERO)!"           
NLB205*                TO WA-OUTPUT-MSG                                       
NLB205*           MOVE 1 TO WA-MSG-ERR-FLAG                                   
NLB205*           GO TO BB629-EXIT                                            
NLB205*        END-IF                                                         
NLB205*    END-IF                                                             
NLB205*    END-IF.                                                            
069450*
069460****      IF SOURCE/DEST CURRENCY CODE = SOC-CURRENCY  ***
069470****      YOU DON'T HAVE TO CALCULATE CURRENCY RATE.   ***
069480*
069490     IF  UT0296CA-FROM-CURRENCY = SPACE
069500         MOVE SOC-NATIVE-CURRENCY TO UT0296CA-FROM-CURRENCY.
069510     IF  UT0296CA-TO-CURRENCY = SPACE
069520         MOVE SOC-NATIVE-CURRENCY TO UT0296CA-TO-CURRENCY.
069530*
069540     IF  (UT0296CA-FROM-CURRENCY = SOC-NATIVE-CURRENCY)
069550     AND (UT0296CA-TO-CURRENCY = SOC-NATIVE-CURRENCY)
069560         MOVE UT0296CA-TO-AMOUNT TO WA-INPUT-AMT
069570         IF WA-INPUT-PARAM-TABLE(28) = 0
069580            MOVE UT0296CA-TO-AMOUNT TO WA-MULTI-BASE-CURR-AMT
069590            GO TO BB629-EXIT
069600         END-IF
069610     END-IF.
NLB205
NLB205     IF  (UT0296CA-FROM-CURRENCY = UT0296CA-TO-CURRENCY)
NLB205     AND (UT0296CA-FROM-CURRENCY NOT = SOC-NATIVE-CURRENCY)
NLB205         MOVE UT0296CA-TO-AMOUNT TO UT0296CA-FROM-AMOUNT
NLB205         MOVE 2 TO UT0296CA-CALL-CODE
NLB205     END-IF.
NLB205
069690     CALL  "UT0296"              USING
069710                                        UT0296-CALL-AREA
069720                                        STRT-AREA-DATA
069730                                        SOC-PARAMS.
069740     IF    UT0296CA-CALL-STATUS  =  1072
069750       MOVE 1072                 TO UT0060CA-CALL-ERROR-CODE
069760       PERFORM Y000-OVERRIDABLE-ERROR-CHECK  THRU Y090-EXIT
069770       IF  WA-MSG-ERR-FLAG  =  0
069780           MOVE  1072   TO  WA-ERR-MSG-NO
069790           GO           TO  BB629-EXIT.
069800     IF UT0296CA-CALL-STATUS = 0
069810         IF  WA-INPUT-PARAM-TABLE(28) = 0
069820         AND WA-INPUT-AMT = 0
069830             MOVE UT0296CA-FROM-AMOUNT   TO WA-VA-AMT
069840             MOVE UT0296CA-FROM-CURRENCY TO WA-CURRENCY
069850             PERFORM BB630-FORMAT-AMT-DECIMAL THRU BB639-EXIT
069860             MOVE WA-VA-AMT TO WA-INPUT-AMT
069870         END-IF
069880         IF  WA-MULTI-BASE-CURR-AMT = 0
069890             MOVE UT0296RA-EQUIV-BASE-AMOUNT TO WA-VA-AMT
069900             MOVE SOC-NATIVE-CURRENCY        TO WA-CURRENCY
069910             PERFORM BB630-FORMAT-AMT-DECIMAL THRU BB639-EXIT
069920             MOVE WA-VA-AMT TO WA-MULTI-BASE-CURR-AMT
069930         END-IF
NLB205         IF  WA-SET-UT0296-CALL-2  = "Y"
NLB205             MOVE UT0296CA-FROM-AMOUNT   TO WA-VA-AMT
NLB205             MOVE UT0296CA-FROM-CURRENCY TO WA-CURRENCY
NLB205             PERFORM BB630-FORMAT-AMT-DECIMAL THRU BB639-EXIT
NLB205             MOVE WA-VA-AMT TO WA-MULTI-CURR-AMT
NLB205             MOVE SPACE TO WA-SET-UT0296-CALL-2
NLB205         END-IF
070010      ELSE
070020      MOVE UT0296CA-CALL-STATUS  TO WA-OUTPUT-ERR-MSG-NO
070030      MOVE 1                     TO WA-MSG-ERR-FLAG
070040      END-IF.
070050 BB629-EXIT.
070060     EXIT.
070070/
070080 BB630-FORMAT-AMT-DECIMAL.
070090     PERFORM Q910-RETRIEVE-CURRENCY-DETAILS THRU Q919-EXIT.
070100     IF WA-MSG-ERR-FLAG = 1
070110         GO TO BB639-EXIT.
070120     IF UT0290CA-CURR-DECS = 0
070130         MOVE 0 TO WA-DECS-0
070140     ELSE
070150         IF UT0290CA-CURR-DECS = 1
070160             MOVE 0 TO WA-DECS-1
070170         ELSE
070180             IF UT0290CA-CURR-DECS = 2
070190                 MOVE 0 TO WA-DECS-2.
070200 BB639-EXIT.
070210     EXIT.
070220/
070230 BC620-READ-BLDVFC.
070240     IF  WA-INPUT-PARAM-TABLE (4) = ZERO                                  
070250     AND WA-INPUT-PARAM-TABLE (5) = ZERO                                  
070260         GO TO BC629-EXIT                                                 
070270     END-IF.                                                              
070280     IF BORM-FCC-CLUS > ZERO                                              
070290         MOVE 61                 TO DBIO-CALL-FUNC                        
070300         MOVE "FC"               TO BLDV-FC-TRAN-TYPE                     
070310         MOVE STRT-AREA-SOC-NO   TO DBIO-01-SOC-NO                        
070320         MOVE WA-INPUT-ACCT-NO   TO DBIO-01-ACCT-NO                       
070330         MOVE DBIO-01-KEY        TO DBIO-CALL-KEY-AREA                    
070340         MOVE "BORM"             TO DBIO-CALL-N-SYS                       
070350         MOVE "BLDV"             TO DBIO-CALL-SYST-VAR                    
070360         MOVE "FC"               TO DBIO-CALL-CODE-B                      
070370         MOVE ZERO               TO DBIO-CALL-REFER-AREA                  
070380         MOVE SPACES             TO DBIO-CALL-STATUS                      
070390         CALL "DBIO" USING DBIO-CALL-PARAM                                
070400                           DBIO-CALL-SYS-AREA                             
070410                           DBIO-CALL-KEY-AREA                             
070420                           DBIO-CALL-STATUS                               
070430                           WS-BLDV-FC-RECORD-AREA                         
070440                           DBIO-CALL-REFER-AREA                           
070450                           DBIO-CALL-TXN-TYPE-AREA                        
070460         IF DBIO-CALL-SAVE-REFER = "END."                                 
070470         OR DBIO-CALL-STATUS NOT = "****"                                 
070480             MOVE 155              TO WA-OUTPUT-ERR-MSG-NO                
070490             MOVE 1                TO WA-MSG-ERR-FLAG                     
070500             MOVE "BLDV"           TO IN0014-OUTPUT-DATA-SET              
070510             MOVE DBIO-CALL-STATUS TO IN0014-OUTPUT-STATUS                
070520             MOVE UT8500CA-FUNC-NORMAL-DISPLAY                            
070530                                   TO UT8500CA-CALL-CODE                  
070540             MOVE SPACES           TO UT8500CA-INPUT-MSG                  
070550             STRING "BR0000:(BC620) READ BLDVFC ERROR"                    
070560                    ", SAVE-REFER = " DBIO-CALL-SAVE-REFER                
070570                    ", DBIO-STAT  = " DBIO-CALL-STATUS                    
070580                    ", KEY = " DBIO-CALL-KEY-AREA                         
070590                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG                
070600             CALL "UT8500" USING UT8500CA-AREA                            
070610             GO TO BC629-EXIT                                             
070620         ELSE                                                             
070630*****        MOVE SPACES         TO BLDV-FC-NOM-CURR                     
070640             MOVE ZERO           TO BLDV-FC-LI-ADJ-ACCR                   
070650                                    BLDV-FC-CI-ADJ-ACCR                   
070660                                    BLDV-FC-BPI-ADJ-ACCR                  
070670                                    BLDV-FC-ARR-ADJ-ACCR                  
070680                                    BLDV-FC-PRNC-ADJ-ACCR                 
070690         END-IF                                                           
070700     END-IF.                                                              
070710 BC629-EXIT.                                                              
070720     EXIT.                                                                
070730/
070740 B620-FETCH-MASTER.
070750*
070760***************************************************************
070770*
070780*SPR 760172 - COMMENT OUT THE CURRENCY SECTION.
070790*AS PER CTCB IR NO 58.
070800*
070810***START*******************************************************
070830*    IF  WS-SAVE-TXN-CURRENCY = SPACES OR SOC-NATIVE-CURRENCY
070840*        MOVE SOC-NATIVE-CURRENCY     TO WA-CURRENCY
070850*    ELSE
070860*        MOVE WS-SAVE-TXN-CURRENCY TO WA-CURRENCY.
070870*    PERFORM Q910-RETRIEVE-CURRENCY-DETAILS THRU Q919-EXIT.
070880*    IF  WA-MSG-ERR-FLAG = 1
070890*        GO TO B629-EXIT.
070910***END*********************************************************
070930     IF STRT-AREA-TRN-NO = 10901 OR 10903 OR 10951 OR 10953
070940                            OR 10971 OR 10973
070950         MOVE WA-INPUT-ACCT-NO TO WA-SAVE-INPUT-ACCT-NO
070960         MOVE WA-LON-ACCT-NO TO
070970                             WA-INPUT-ACCT-NO.
NLB205     IF STRT-AREA-TRN-NO = 10901 OR 10951 OR 10971
NLB205        IF SOC-ACCT-NO-FORMAT = 0
NLB205           MOVE WA-LON-ACCT-17 TO WA-INPUT-ACCT-NO
NLB205        END-IF
NLB205     END-IF.
NLB205
S11313*
S11313     MOVE BORM-ACT-TYPE      TO WA-BORM-ACT-TYPE.
S11313*
S11331*    IF  WA-ACT-TYPE-790
S11331*    AND WA-INPUT-PARAM-TABLE(4)  = 1
S11331*    AND WA-INPUT-PARAM-TABLE(25) NOT = 1
S11331*        IF BOIS-LEGAL-FEE1-DUE   > 0
S11331*           MOVE 1      TO WA-MSG-ERR-FLAG
S11331*           MOVE 3387   TO WA-OUTPUT-ERR-MSG-NO
S11331*        END-IF
S11331*    END-IF.
S11331*
071040     IF  WA-INPUT-PARAM-TABLE(24) = 1
TB0008         IF  WA-TR-NEW-ACCT-NO = 0
TB0008                MOVE "Y" TO AUTO-ACCT-FLAG
TB0008         ELSE
TB0008                MOVE "N" TO AUTO-ACCT-FLAG
TB0008         END-IF
071050         PERFORM B100-NEW-RCD-DBIO-PARA THRU B199-EXIT
071060         MOVE STRT-AREA-BRANCH TO BORM-BR-NO
071070         GO TO B629-EXIT
071080     ELSE
071090         PERFORM B200-OLD-RCD-DBIO-PARA THRU B299-EXIT
071100         IF  WA-MSG-ERR-FLAG = 1
071110             GO TO B629-EXIT
071120         ELSE
S15456             MOVE BORM-ACT-TYPE    TO  WA-BORM-ACT-TYPE
S15228             IF  STRT-FEP-ATM-TXN
S15228             AND BORM-BAD-DEBT-IND(2:1) >= 2
S15456             AND WA-ACT-TYPE-PERSONAL
S16708             AND (NOT BORP-YOUBE)
S15456*S15228             AND BORP-CONSMR
S15456*S15228             AND BORP-NEGO-PROD
S15228                 MOVE "Y"   TO WA-ATM-ALLOW
S15228                 IF WA-INPUT-PARAM-TABLE (8)  = 1
S15228                    PERFORM B7000-CONV-TXCODE THRU B7000-EXIT
S15228                    IF WA-MSG-ERR-FLAG = 1
S15228                       GO TO B629-EXIT
S15228                    END-IF
S15228                 END-IF
S15228             END-IF
S18413             IF  STRT-FEP-ATM-TXN
S18413             AND WA-INPUT-PARAM-TABLE (4) = 1
S18413             AND WA-INPUT-PARAM-TABLE (7) = 0
S18413             AND BORM-BAD-DEBT-IND(2:1)   = 0
S18413             AND WA-ACT-TYPE-PERSONAL
S18413             AND NOT BORP-YOUBE
S18413             AND NOT BORP-ALBPS
S18413             AND NOT BR0000-SYSTEM-IN-NIGHT
S18413                 PERFORM B7100-CHNG-TXCODE THRU B7100-EXIT
S18413                 IF WA-MSG-ERR-FLAG = 1
S18413                     GO TO B629-EXIT
S18413                 END-IF
S18413             END-IF
ST0121             IF  STRT-AREA-TRN-NO = 12003 OR 19098 OR 19099 OR
SC9950*                                   17076 OR 17072 OR 17033 OR
SC9950                                    17072 OR 17033 OR
S11796                                    17026 OR
ST0121                                    17034
ST0121                 MOVE BORM-ACT-TYPE TO WA-BORM-ACT-TYPE
ST0121                 IF WA-ACT-TYPE-790
ST0121                    MOVE  1         TO WA-MSG-ERR-FLAG
ST0121                    MOVE 307        TO WA-OUTPUT-ERR-MSG-NO
ST0121                    GO TO B629-EXIT
ST0121                 END-IF
ST0121             END-IF
071130             PERFORM B300-STATUS-CHECK-PARA THRU B399-EXIT
071140             IF WA-MSG-ERR-FLAG = 1
071150                GO TO B629-EXIT
071160             ELSE
071170                PERFORM B400-STOP-CHECK-PARA THRU B499-EXIT
071180                IF WA-MSG-ERR-FLAG = 1
071190                   GO TO B629-EXIT
071200                ELSE
071210*                  PERFORM B4A0-CHECK-STOP-TRAN THRU B4A9-EXIT
071220*                  IF WA-MSG-ERR-FLAG = 1
071230*                     GO TO B629-EXIT
071240*                  ELSE
071250                     PERFORM B500-HOLD-CHECK-PARA THRU B599-EXIT
071260                     IF  WA-MSG-ERR-FLAG = 1
071270                         GO TO B629-EXIT
071280                     ELSE
071290                         PERFORM B630-MESS-CHECK-PARA THRU
071300                                 B639-EXIT.
TB0082**--
      **-- READ GLDM HERE FOR XFER TO GL TRANSACTION; REQUIRED FOR
      **-- UPDATING THE JOURNAL TRANSFER BRANCH
SC6401     IF STRT-AREA-TRN-NO = 11041 OR 11141                       
SC7301*       MOVE W41-I-SYSTEM TO WA-SAVE-W41-I-SYSTEM
SC7301        MOVE W41-IN-SYSTEM TO WA-SAVE-W41-I-SYSTEM
SC6401     END-IF.                                                    
         
           IF STRT-AREA-TRN-NO = 11057 OR 11157 OR 16057 OR 16157
SC2759                        OR 16046 OR 16146 OR 16048 OR 16148
SC3849                        OR 11048 OR 11148
SC4485                        OR 13046 OR 13146 OR 15046 OR 15146
S16235                        OR 13047 OR 13147 OR 15047 OR 15147
S10982                        OR 11046 OR 11146 OR 11049 OR 11149
S10982                        OR 16049 OR 16149
S11455                        OR 11069 OR 11169
S11455                        OR 16069 OR 16169
SC5863                        OR (STRT-AREA-TRN-NO = 17467 AND  
SC5863                           BR17467-INP-DEF-SYSTEM = "GEN")
SC6401                        OR ((STRT-AREA-TRN-NO = 11041 OR 11141)  
SC7301*                            AND (W41-I-SYSTEM = "GEN"))
SC7301                             AND (W41-IN-SYSTEM = "GEN"))
              MOVE BORM-RECORD-AREA TO STORE-BORM-AREA
              MOVE WA-DEP-ACCT-NO   TO DBIO-01-ACCT-NO
              PERFORM V700-READ-GLDM-RECORD
                 THRU V799-EXIT
SC3849        MOVE GLDM-BRANCH      TO WA-SAVE-BRCH-NO
SC6274        MOVE GLDM-LEDGER-NAME TO WA-GLDM-LEDGER-NAME                 
              MOVE STORE-BORM-AREA  TO BORM-RECORD-AREA
              IF WA-MSG-ERR-FLAG = 1
                 GO TO B629-EXIT
              END-IF
SC3849*       MOVE GLDM-BRANCH   TO WA-SAVE-BRCH-NO
           END-IF.
SC2150     IF  BORM-STAT                  =  40
SC2150     AND BOIS-DISCHARGE-REASON-CODE = "57"
SC2150     AND WA-INPUT-PARAM-TABLE(23)   =   1
SC2150     AND WA-INPUT-PARAM-TABLE(15)   =   0
SC2150         MOVE 0                    TO  BORM-LOAN-BAL
S16317*SC2150                                       BOIS-BAD-DEBT-AMT
SC2150         PERFORM VARYING WA-COUNT FROM 1 BY 1
SC2150                 UNTIL WA-COUNT > 5
SC2150             MOVE  0      TO BOIS-GL-BUCKET-DUE (WA-COUNT)
SC2150         END-PERFORM
SC2150         PERFORM VARYING WA-COUNT FROM 1 BY 1
SC2150                 UNTIL WA-COUNT > 15
SC2150             MOVE  0      TO BOIS-BUCKET-DUE (WA-COUNT)
SC2150         END-PERFORM
SC2150     END-IF.
           MOVE STRT-AREA-TRN-NO TO WA-SAVE-ORIG-TRAN.
TB0082**--
ST0038     IF STRT-AREA-TRN-NO = 17033
ST0038*------ Loan Installment Agreement Form Previous Value
SC9453        MOVE BOIS-AGREE-INT-BUCKET TO WA-SAVE-AGREE-INT-BUCKET
SC9453        MOVE BOIS-AGREE-ARR-BUCKET TO WA-SAVE-AGREE-ARR-BUCKET
ST0038        MOVE BOIS-AGREE-IND    TO VCHR151-BF-AGREEMNT-IND.
071310      IF STRT-AREA-TRN-NO = 10901 OR 10903 OR 10951 OR 10953
071320                                OR 10971 OR 10973
071330      MOVE WA-SAVE-INPUT-ACCT-NO TO WA-INPUT-ACCT-NO.
071340     IF STRT-AREA-TRN-NO = 16039 OR 16059
071350         NEXT SENTENCE
071360     ELSE
071370         PERFORM   BB620-CALL-UT0296   THRU  BB629-EXIT.
071380*
071390*    IF STRT-AREA-TRN-NO = 11045 OR 11105                                  TB0267
TB0267**   IF STRT-AREA-TRN-NO = 11045 OR 11105 OR 14045
SC7091     IF STRT-AREA-TRN-NO = 11045 OR 11105 OR 14045 OR 19045
NLB205        IF WA-MULTI-ACCT-CURR-CD = WA-MULTI-CURR-AMT-CURR-CD
NLB205              AND  WA-MULTI-COMMISSION         = 0
NLB205              AND  WA-MULTI-CHANGE             = 0
NLB205             IF WA-MULTI-CURR-AMT NOT = WA-INPUT-AMT
NLB205                MOVE 1090 TO WA-OUTPUT-ERR-MSG-NO
NLB205                MOVE 1    TO WA-MSG-ERR-FLAG
NLB205                GO TO B629-EXIT
071470             END-IF
NLB205        END-IF
NLB205     END-IF.
NLB205
071510     COMPUTE WA-SAVE-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
071520     MOVE BORM-ARR-INT-INCR    TO WA-SAVE-ARR-INT-INCR.
SC8950     MOVE BORM-BAD-DEBT-IND    TO WA-BAD-DEBT-IND.
071530     MOVE BORM-APPRV-DATE          TO UT0020-BINARY-DATE.
071540     MOVE 1                        TO UT0020-FUNCTION.
071550     PERFORM X600-UT0020-PARA THRU X609-EXIT.
071560     MOVE UT0020-DATE-DDMMCCYY TO WA-BOR-BFY.
071570*
071580 B629-EXIT.
071590     EXIT.
071600/
071610 B630-MESS-CHECK-PARA.
071620     IF SOC-LOANS-TRACKING-OPTION = "Y"  AND
071630         WA-INPUT-PARAM-TABLE(22) = 1
071640         AND
071650         WA-INPUT-PARAM-TABLE(11) = 1
071660         GO TO B639-EXIT.
071670     IF  WA-INPUT-PARAM-TABLE(12) = 1
071680         OR  STRT-AREA-EFT-TXN
071690         GO TO B639-EXIT.
071700     IF  BORM-NO-OF-MESSAGES = 1
071710         MOVE SPACES TO WA-OUTPUT-MSG
071720         MOVE "MESSAGE" TO WA-OUTPUT-FREE-MSG
NR2001*071730         MOVE 33 TO DBIO-CALL-TXN-TYPE
NR2001*071740         PERFORM W100-READ-STOP-HOLD-TRAN THRU W199-EXIT
NR2001*071750         MOVE 0 TO WA-MSG-ERR-FLAG
NR2001*071760         MOVE BORV-33-MESSAGE-NO TO WA-OUTPUT-FREE-MSG-NO
NR2001*071770         MOVE "/" TO WA-OUTPUT-FREE-MSG-SLASH                           
NR2001*071780         MOVE BORV-33-JRNL-NO  TO WA-OUTPUT-FREE-MSG-JRNL               
NR2001*071790         MOVE BORV-33-FREE-MSG TO WA-OUTPUT-FREE-MSG-TEXT
NR2001         MOVE 33     TO WS-BOCT-TRAN-TYPE
NR2001         PERFORM W100-READ-STOP-HOLD-TRAN THRU W199-EXIT
NR2001         MOVE 0 TO WA-MSG-ERR-FLAG
NR2001         MOVE BOCT-33-MESSAGE-NO TO WA-OUTPUT-FREE-MSG-NO
NR2001         MOVE "/" TO WA-OUTPUT-FREE-MSG-SLASH
NR2001         MOVE BOCT-JRNL-NO     TO WA-OUTPUT-FREE-MSG-JRNL
NR2001         MOVE BOCT-33-FREE-MSG TO WA-OUTPUT-FREE-MSG-TEXT
071800*        MOVE 30 TO WA-INPUT-MSG-CODE                                   
071810         MOVE 998 TO WA-OUTPUT-ERR-MSG-NO                               
071820         MOVE 50  TO WA-OUTPUT-MSG-LENGTH                               
071830         CALL "FT0000"  USING
071840                        STARTAREA
071850                                                                        
071860         MOVE 03 TO WA-INPUT-MSG-CODE                                   
071870         MOVE 0  TO WA-OUTPUT-ERR-MSG-NO                                
071880         MOVE 0 TO WA-MSG-ERR-FLAG
071900     ELSE                                                               
071910     IF  BORM-NO-OF-MESSAGES > 1                                        
071920         MOVE SPACES TO WA-OUTPUT-MSG                                   
071930         MOVE "BR0000" TO UT9000-CALLING-ID
071940         MOVE 1        TO UT9000-REPORT-NO
071950         MOVE 1        TO UT9000-SEQUENCE-NO
071960         MOVE 2        TO UT9000-CALL-CODE
071970         MOVE STRT-AREA-SOC-NO TO UT9000-INST-NO
071980         MOVE SOC-LANGUAGE-CODE TO UT9000-LANGUAGE-CODE
071990         PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT
072000         IF UT9000-CALL-STATUS NOT = 0
072010            MOVE SPACES TO WA-OUTPUT-FREE-MSG-R
072020         ELSE
072030            MOVE UT9000RA-LINE1 TO WA-OUTPUT-FREE-MSG-R
072040         END-IF
072050*        MOVE "MESSAGES FOR ACCOUNT, PLEASE ENQIRE"
072060*                       TO WA-OUTPUT-FREE-MSG-R                         
072070*        MOVE 30 TO WA-INPUT-MSG-CODE                                   
072080         MOVE 998 TO WA-OUTPUT-ERR-MSG-NO                               
072090         MOVE 40 TO WA-OUTPUT-MSG-LENGTH                                
072100         CALL "FT0000"  USING                                           
072110                        STARTAREA                                       
072130         MOVE 03 TO WA-INPUT-MSG-CODE                                   
072140         MOVE 0  TO WA-OUTPUT-ERR-MSG-NO.                               
072150* CHECK FOR SEVERITY MESSAGES FROM ELECTRONIC MAIL.
072160     IF  BORM-SEVERITY-COUNT > 0
072170         MOVE 761 TO UT0060CA-CALL-ERROR-CODE                           
072180         PERFORM Y000-OVERRIDABLE-ERROR-CHECK   THRU  Y090-EXIT         
072190         IF WA-MSG-ERR-FLAG = 0                                         
072200            MOVE 761 TO WA-ERR-MSG-NO                                   
072210         ELSE                                                           
072220            MOVE 761 TO WA-OUTPUT-ERR-MSG-NO                            
072230            MOVE 1 TO WA-MSG-ERR-FLAG                                   
072240            GO TO B639-EXIT.
072250* CHECK FOR NORMAL MESSAGES FROM ELECTRONIC MAIL.
072260     IF  BORM-MSGS-PENDING > 0
072270         ADD 2 TO STRT-AREA-MSG-PENDING.
072280 B639-EXIT.
072290     EXIT.
072300/
072310 B640-LOANSAVER-PARA.
072320     IF WA-INPUT-PARAM-TABLE(8) NOT = 1
072330         GO TO B649-EXIT.
072340     IF WA-INPUT-PARAM-TABLE(23) = 1
072350         GO TO B649-EXIT.
072360     MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE.
072370     MOVE 1 TO UT0020-FUNCTION.
072380     PERFORM X600-UT0020-PARA THRU X609-EXIT.
072390     IF WA-REPAY-TXN-DATE = UT0020-DATE-DDMMCCYY
072400         GO TO B649-EXIT.
072410     IF STRT-AREA-BATCH-TANDEM = "2"
072420         MOVE UT0020-DATE-DDMMCCYY TO WA-REPAY-TXN-DATE
072430     ELSE
072440     IF STRT-AREA-EFT-TXN OR STRT-AREA-ADVICE
072450         MOVE UT0020-DATE-DDMMCCYY TO WA-REPAY-TXN-DATE
072460     ELSE
072470     IF STRT-AREA-OTHER-OVERRIDE = "0" OR "2"
072480         MOVE 127 TO WA-OUTPUT-ERR-MSG-NO
072490         MOVE 1 TO WA-MSG-ERR-FLAG.
072500 B649-EXIT.
072510     EXIT.
072520/
072530******************************************************************
072540*** A C C T   T Y P E   C H E C K S ***
072550******************************************************************
072560 B700-ACCT-TYPE-CHECK-PARA.
S18788     IF WA-MSG-ERR-FLAG = 1
S18788     AND (WA-OUTPUT-ERR-MSG-NO = 0
S18788      OR  WA-OUTPUT-ERR-MSG-NO < 100
S18788      OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
S18788         DISPLAY "!!BR0000, BEG B700, ERR-" WA-OUTPUT-ERR-MSG-NO
S18788     END-IF.
072570     IF STRT-AREA-POSTING-LEVEL > 0 AND < 33
072580        MOVE BORM-POSTING-MASK TO FIELD-B
072590        CALL "UT0022" USING
072600                      PUAREA
072610        MOVE FIELD-A TO WA-TABLE
072620        IF WA-TABLE-ENTRY (STRT-AREA-POSTING-LEVEL) = 1
S15781* //    PRINCIPAL REPAYMENT RESTRICTED SKIP BUCKET-14 > 0
S15781          IF  STRT-AREA-POSTING-LEVEL =  1
S15781          AND BOIS-BUCKET-DUE(14)     >  0
S15781            NEXT SENTENCE
S15781          END-IF
S17743          IF  STRT-AREA-POSTING-LEVEL =  1
S17862*S17743   AND ( BORP-TIB-CONFER OR BORP-PUBLIC-CONFER-CDC )
S17862           IF ( BORP-TIB-CONFER OR BORP-PUBLIC-CONFER-CDC )
S17862           OR ( STRT-AREA-BRANCH      =  622 )
S17743              NEXT SENTENCE
S17862           END-IF
S17743          END-IF
072630            MOVE 2035 TO UT0060CA-CALL-ERROR-CODE
072640            PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
072650            IF WA-MSG-ERR-FLAG = 0
072660                MOVE 2035 TO WA-ERR-MSG-NO
072670            ELSE
072680                MOVE 2035 TO WA-OUTPUT-ERR-MSG-NO
NR2001*072690                PERFORM M070-GET-BORV-REASON THRU M079-EXIT
NR2001                PERFORM M070-GET-BOCT-REASON THRU M079-EXIT
072700                MOVE 1 TO WA-MSG-ERR-FLAG
072710                GO TO B799-EXIT.
072720*
072730*     MOVE 02 TO UT2000CA-CALL-CODE.
072740*     MOVE 0 TO UT2000CA-CALL-INDEX.
072750*     MOVE BORM-SOC-NO TO UT2000CA-CALL-SOC-NO.
072760*     MOVE BORM-ACT-TYPE TO UT2000CA-CALL-ACCT-TYPE.
072770*     MOVE BORM-CAT TO UT2000CA-CALL-INT-CAT.
072780*     PERFORM D100-CALL-UT2000 THRU D199-EXIT.
072790*     IF  WA-MSG-ERR-FLAG = 1
072800*         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
072810*         MOVE SPACES TO UT8500CA-INPUT-MSG
072820*         STRING "BR0000(B700) ERROR IN RETURN FROM D100 "
072830*                 BORM-ACT-TYPE " " BORM-CAT
072840*             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
072850*         CALL "UT8500" USING
072870*                             UT8500CA-AREA
072880*         GO TO B799-EXIT.
072890*
072900*    IF  WA-INPUT-PARAM-TABLE(4)  = 1 OR
072910*        WA-INPUT-PARAM-TABLE(5)  = 1 OR
072920*        WA-INPUT-PARAM-TABLE(17) = 1 OR
072930*        WA-INPUT-PARAM-TABLE(25) = 1
072940*         NEXT SENTENCE
072950*    ELSE
072960*         GO TO B700-CONT.
072970*
072980     IF  STRT-AREA-TRN-NO = 10730 OR 10731 OR 10750 OR 10751              
072990          MOVE WA-ADJ-PROMO TO WA-INPUT-PROMO.                            
073000*                                                                         
TB0102**** FSLON0014 - FOR TIB DISCHARGE SPECS.
TB0102     IF STRT-AREA-TRN-NO = 13010 OR 13011 OR 13045 OR 13046
TB0102       OR 13111 OR 13110 OR 13145 OR 13146
S16235       OR 13047 OR 13147
TB0102        IF BORP-DISCH-ENQ-REQD = "N"
TB0102           Go TO B700-CONT
TB0102        END-IF
TB0102     END-IF.
TB0102
073010     IF  (WA-INPUT-PROMO = SPACES  OR
073020          WA-INPUT-PROMO IS NUMERIC)
073030           GO TO B700-CONT
073040     END-IF.
073050*
073060     MOVE 2                 TO UT0270CA-IN-CALL-CODE.
073070     MOVE WA-INPUT-PROMO    TO UT0270CA-IN-PROMO.
073080     MOVE STRT-AREA-SOC-NO  TO UT0270CA-IN-SOC-NO.
073090     MOVE SOC-LANGUAGE-CODE TO UT0270CA-IN-LANGUAGE-CODE.
073100     CALL "UT0270" USING
073120                         UT0270CA-AREA.
073130     IF  UT0270CA-OUT-STAT NOT = "****"
073140         MOVE 1            TO WA-MSG-ERR-FLAG
073150         MOVE 730          TO WA-OUTPUT-ERR-MSG-NO
073160         GO TO B799-EXIT
073170     END-IF.
073180 B700-CONT.
073190     IF  WA-INPUT-PARAM-TABLE(17) = 1
073200         IF STRT-AREA-TRN-NO = 12690 OR 12691
073210            MOVE WA-APP-AMOUNT TO WS-APP-AMOUNT
073220         ELSE IF STRT-AREA-SIGN = "-"
073230            COMPUTE WS-APP-AMOUNT = (BORM-APP-AMT +
073240                                     BORM-ADD-LOAN-APP) -
073250                                     WA-APP-AMOUNT
073260         ELSE
073270            COMPUTE WS-APP-AMOUNT = (BORM-APP-AMT +
073280                                     BORM-ADD-LOAN-APP) +
073290                                     WA-APP-AMOUNT
073300         END-IF.
073310     IF  WA-INPUT-PARAM-TABLE(17) = 1
073320         IF WS-APP-AMOUNT > BORP-MAX-LOAN
073330           MOVE 166 TO UT0060CA-CALL-ERROR-CODE
073340           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
073350           IF WA-MSG-ERR-FLAG = 0
073360             MOVE 166 TO WA-ERR-MSG-NO
073370           ELSE
073380             MOVE 166 TO WA-OUTPUT-ERR-MSG-NO
073390             MOVE 1 TO WA-MSG-ERR-FLAG
073400             GO TO B799-EXIT
073410         ELSE
073420           IF STRT-AREA-TRN-NO = 12430 OR 12530
073430              NEXT SENTENCE
073440           ELSE
073450           IF WA-APP-AMOUNT < BORP-MIN-LOAN
073460             MOVE 167 TO UT0060CA-CALL-ERROR-CODE
073470             PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
073480             IF WA-MSG-ERR-FLAG = 0
073490               MOVE 167 TO WA-ERR-MSG-NO
073500             ELSE
073510               MOVE 167 TO WA-OUTPUT-ERR-MSG-NO
073520               MOVE 1 TO WA-MSG-ERR-FLAG
073530               GO TO B799-EXIT.
073540*
073550*    THE ATM MACHINE WILL STOP ZERO TXNS AS PART OF ITS MINIMUM
073560*    TRANSACTION AMOUNT PROCESSING, SO WE WILL ONLY CHECK NON-ATM
073570*    TRANSACTIONS SO IT DOESN'T GET TOO CONFUSING FOR AMENDING
073580*    PROGGIES IN THE FUTURE.             CLW
073590*
073600     IF  WA-INPUT-PARAM-TABLE(30) NOT = 1
073610       IF  WA-INPUT-PARAM-TABLE(4) = 1
073620       OR  WA-INPUT-PARAM-TABLE(5) = 1
073630         IF  WA-INPUT-AMT = ZERO
073640**  ALLOW A ZERO AMOUNT DISCHARGE  **
073650        AND NOT (STRT-AREA-TRN-NO OF STARTAREA
TB0102*                           = 13010 OR 13020 OR 13045)
TB0102            = 13010 OR 13110 OR 13020 OR 13045 OR 13011 OR 13111
S16235*SC4726             OR 17467
S16235             OR 17467 OR 13047 OR 13147
TB0102             OR 13145 OR 13046 OR 13146)
073670                MOVE 417 TO WA-OUTPUT-ERR-MSG-NO
073680                MOVE 1 TO WA-MSG-ERR-FLAG
073690                GO TO B799-EXIT.
TB0070     IF  SOC-SITE-TIB
TB0070*      IF  WA-INPUT-PARAM-TABLE(30) NOT = 1 AND                      SC6800
SC6800       IF  WA-INPUT-PARAM-TABLE(25) NOT = 1 AND
TB0070           WA-INPUT-PARAM-TABLE(7)  NOT = 1 AND
TB0070           WA-INPUT-PARAM-TABLE(4) = 1 AND
TB0099           STRT-AREA-TRN-NO NOT = 13031 AND 11044 AND
TB0099            11048 AND 16044 AND 16048
TB0070           IF WA-REPAYMENT-TXN
TB0159           AND NOT BORP-YOUBE
SC7548              IF BOIS-NEXT-DUE-DATE = BOIS-MATURITY-DATE  
SC7548              AND (BORM-REM-REPAYS NOT > 0)  
SC7548              AND (BORM-STAT NOT = 50)  
SC7548              AND BORM-1-ADDL-BILLING  
SC7548                 SET WA-RESTORE-REPAY TO TRUE  
SC7548                 MOVE 1 TO BORM-REM-REPAYS  
SC7548              ELSE  
SC7548                 MOVE " " TO WA-RESTORE-REPAY-IND  
SC7548              END-IF  
TB0070              PERFORM D200-MAX-MIN-REPAY-VALIDATION THRU D200-EXIT
S18788              IF WA-MSG-ERR-FLAG = 1
S18788              AND (WA-OUTPUT-ERR-MSG-NO = 0
S18788               OR  WA-OUTPUT-ERR-MSG-NO < 100
S18788               OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
S18788                DISPLAY "!!BR0000, AFT D200, ERR-"
S18788                        WA-OUTPUT-ERR-MSG-NO
S18788              END-IF
SC7548              IF WA-RESTORE-REPAY  
SC7548                 MOVE 0 TO BORM-REM-REPAYS  
SC7548                 MOVE " " TO WA-RESTORE-REPAY-IND  
SC7548              END-IF  
TB0070              IF  WA-MSG-ERR-FLAG = 1
TB0070                  GO TO B799-EXIT
TB0070              END-IF
TB0070           END-IF
TB0070       END-IF
TB0070     ELSE
073710     IF  WA-INPUT-PARAM-TABLE(30) NOT = 1
073720      AND  WA-INPUT-PARAM-TABLE(25) NOT = 1
073730       IF  WA-INPUT-PARAM-TABLE(4) = 1
073740         IF  WA-INPUT-AMT < BORP-MIN-DEP
073750             MOVE 107 TO UT0060CA-CALL-ERROR-CODE
073760             PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
073770             IF WA-MSG-ERR-FLAG = 0
073780                MOVE 107 TO WA-ERR-MSG-NO
073790             ELSE
073800                MOVE 107 TO WA-OUTPUT-ERR-MSG-NO
073810                MOVE 1 TO WA-MSG-ERR-FLAG
073820                GO TO B799-EXIT.
073830*
073840     IF STRT-AREA-TRN-NO = 12410 OR 12440 OR 12441
073850        NEXT SENTENCE
073860     ELSE
073870       IF  WA-INPUT-PARAM-TABLE(23) = 0
073880         IF  STRT-AREA-SIGN = "-"
073890             MULTIPLY WA-ADV-AMOUNT BY -1
073900                  GIVING WA-ACCT-TYPE-AMT
073910         ELSE
073920             MOVE WA-ADV-AMOUNT      TO WA-ACCT-TYPE-AMT
073930         END-IF
073940         ADD BORM-LOAN-BAL WA-ACCT-TYPE-AMT
073950             GIVING WA-DUMMY-BAL
073960       END-IF
073970     END-IF.
073980     IF  WA-INPUT-PARAM-TABLE(5) = 1
073990       IF WA-DUMMY-BAL > 0
074000         MOVE 02 TO UT0093CA-CALL-CODE
074010         MOVE 00 TO UT0093CA-RET-STATUS
074020         MOVE 0 TO UT0093CA-FUN-CODE
074030         MOVE BORM-SOC-NO TO UT0093CA-SOC-NO
074040         MOVE BORM-ACT-TYPE  TO UT0093CA-ACCT-TYPE
074050         MOVE BORM-CAT     TO UT0093CA-INT-CAT
074060         MOVE BORM-MEMB-CUST-AC TO UT0093CA-ACCT-NO
074070         MOVE BORM-CUSTOMER-NO TO UT0093CA-CUSTOMER-NO
074080         MOVE "B" TO UT0093CA-ACCT-SYS
074090         MOVE "00"         TO UT0093CA-OVERRIDE
074100         MOVE WA-DUMMY-BAL TO UT0093CA-RESULT-BAL
074110         MOVE 0 TO UT0093CA-LIMIT
074120         MOVE 0 TO UT0093CA-LIMIT-TOL
074130         MOVE 0 TO UT0093CA-TOTAL-DEBT
074140         CALL "UT0093" USING
074160                             UT0093CA-LINKAGE
074170         IF UT0093CA-RET-STATUS = 01
074180           MOVE 772 TO UT0060CA-CALL-ERROR-CODE
074190           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
074200           IF WA-MSG-ERR-FLAG = 0
074210             MOVE 772 TO WA-ERR-MSG-NO
074220             MOVE 1 TO WA-LIM-TOL-FLAG
074230           ELSE
074240             MOVE 772 TO WA-OUTPUT-ERR-MSG-NO
074250             MOVE 1 TO WA-MSG-ERR-FLAG
074260             GO TO B799-EXIT
074270         ELSE
074280         IF UT0093CA-RET-STATUS = 09
074290           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
074300             MOVE SPACES TO UT8500CA-INPUT-MSG
074310             STRING "BR0000:(B700) BAD RETURN FROM UT0093 "
074320                                    UT0093CA-ACCT-NO
074330                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
074340             CALL "UT8500" USING
074360                                 UT8500CA-AREA
074370             MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
074380             MOVE 1 TO WA-MSG-ERR-FLAG
074390             GO TO B799-EXIT
074400         ELSE
074410         IF UT0093CA-RET-STATUS = 02
074420             MOVE 1 TO WA-LIM-TOL-FLAG
074430         ELSE
074440             MOVE 0 TO WA-LIM-TOL-FLAG.
074450 B799-EXIT.
074460     EXIT.
074470/
074480 B800-AUTO-ACCT-NO.
074490*
SC0865     INITIALIZE UT5001CA-CALL-AREA.
074500     IF  SOC-AUTO-ACCT-NO = 0
074510         GO TO B899-EXIT.
074520*
074530     PERFORM F200-RETRIEVE-CUSTOMER THRU F209-EXIT.
074540     MOVE SOC-AUTO-ACCT-NO       TO UT5001CA-SOC-AUTO-ACCT-NO.
074550     MOVE SOC-ACCT-NO-FORMAT     TO UT5001CA-SOC-ACCT-NO-FORMAT.
074560     MOVE STRT-AREA-SOC-NO       TO UT5001CA-INST-NO.
074570     MOVE STRT-AREA-BRANCH       TO UT5001CA-BR-NO.
S12060     PERFORM W400-BRHM-BSB  THRU W499-EXIT.
S15988*
S15988     IF   WA-BRHM-OPEN-OK
S15988     AND (WA-TR-NA-REAL-BR-NO = ZEROS
S15988     OR   WA-TR-NA-REAL-BR-NO = SPACES)
S16272*S15988     AND (NOT STRT-BANCSLINK)
S15988          MOVE STRT-AREA-BRANCH   TO WA-TR-NA-REAL-BR-NO
S15988     END-IF.
S15988*
S12060     IF (WA-BRHM-OPEN-OK)  AND
S12060        (WA-TR-NA-REAL-BR-NO NOT = SPACES AND ZEROS)
S12060         MOVE WA-TR-NA-REAL-BR-NO
S12060                                 TO WA-STORE-HME-BRH
S12060         MOVE "Y"                TO WA-HOME-BR
S12060         PERFORM W300-READ-BRHM  THRU W399-EXIT
S12060         MOVE "N"                TO WA-HOME-BR
S12060         IF  WA-MSG-ERR-FLAG  =  1
S12060             MOVE 526  TO WA-OUTPUT-ERR-MSG-NO
S12060             MOVE 01   TO WA-MSG-ERR-FLAG
S12060         ELSE
S12060             MOVE WA-TR-NA-REAL-BR-NO
S12060                                 TO UT5001CA-BR-NO
S12060         END-IF
S12060     ELSE
S15967*S12060  IF  WA-TR-NA-REAL-BR-NO NOT = SPACES AND ZEROS
S15967         IF  (WA-TR-NA-REAL-BR-NO NOT = SPACES AND ZEROS)
S19269             AND (WA-TR-NA-TYPE (1:2) NOT = '78')
S20771             AND (WA-TR-NA-TYPE (1:4) NOT = '7421')
S15967             AND (WA-TR-NA-TYPE (1:1) NOT = '6')
S12060             MOVE 751  TO WA-OUTPUT-ERR-MSG-NO
S12060             MOVE 01   TO WA-MSG-ERR-FLAG
S12060         END-IF
S12060     END-IF.
074580     MOVE WA-TR-NA-TYPE          TO UT5001CA-ACCT-TYPE.
074590     MOVE CUSM-LAST-USED-ACCT-NO TO UT5001CA-LAST-USED-ACCT-NO.
074600     MOVE 0                      TO UT5001RA-STATUS
074610                                    UT5001RA-ERR-MSG-NO.
074620     MOVE "BOR"                  TO UT5001CA-SYSTEM.
074630*
074640*  ADD NEW OPTION FOR ACCOUNT GROUP NO WHEN CALLING "UT5001"
074650*  (MUBARIK ALI) (16-05-1995)
074660     MOVE 02 TO UT2000CA-CALL-CODE.
074670     MOVE 0 TO UT2000CA-CALL-INDEX.
074680     MOVE STRT-AREA-SOC-NO TO UT2000CA-CALL-SOC-NO.
074690     MOVE WA-12000-ACT-TYPE TO UT2000CA-CALL-ACCT-TYPE.
074700     MOVE WA-12000-ACT-CTG TO UT2000CA-CALL-INT-CAT.
074710     PERFORM D100-CALL-UT2000 THRU D199-EXIT.
074720     IF WA-MSG-ERR-FLAG = 1
074730        GO TO B899-EXIT.
074740     IF  BORP-AUTO-ACCT-GROUP-NO  >  0
074750     AND BORP-AUTO-ACCT-GROUP-NO  NUMERIC
074760         MOVE BORP-AUTO-ACCT-GROUP-NO TO UT5001CA-ACCT-TYPE
TB0117         MOVE BORP-AUTO-ACCT-GROUP-NO TO UT5001CA-PARM-GROUP-NO
TB0117         MOVE SOC-AUTO-ACCT-NO        TO UT5001CA-SOC-AUTO-ACCT-NO
TB0117     END-IF.
TB0117** COMMENT OUT BELOW STATEMENT TO PASS THE ACCOUNT CREATION FOR
TB0117** BRANCH /ACCOUNT TYPE AND BRANCH /GROUP NO
074770**       MOVE 4  TO  UT5001CA-SOC-AUTO-ACCT-NO.
074780     CALL "UT5001" USING
074800                         UT5001CA-CALL-AREA.
074810     IF  UT5001RA-STATUS = 0
TB0117**--
TB0117         IF SOC-ACCT-NO-FORMAT = "4"
TB0117            MOVE UT5001RA-FULL-ACCT-NO TO UT0151CA-ACCT-IN
TB0117            MOVE 7                     TO UT0151CA-CALL-FUNC
TB0117            MOVE SOC-ACCT-NO-FORMAT    TO UT0151CA-FORMAT
TB0117            CALL "UT0151" USING
TB0117                          UT0151CA-CALL-AREA
TB0117
TB0117            IF UT0151CA-STATUS <> 0
TB0117               MOVE 0169 TO WA-OUTPUT-ERR-MSG-NO
TB0117               MOVE 01   TO WA-MSG-ERR-FLAG
TB0117            ELSE
TB0117               MOVE UT0151CA-ACCT-EX TO WA-INPUT-ACCT-NO
TB0117            END-IF
TB0117         ELSE
TB0117**--
074820            MOVE UT5001RA-FULL-ACCT-NO TO WA-INPUT-ACCT-NO
TB0117         END-IF
074830         MOVE UT5001RA-FULL-ACCT-NO TO CUSM-LAST-USED-ACCT-NO
074840         PERFORM F300-UPDATE-CUSTOMER THRU F399-EXIT
074850     ELSE
074860         MOVE UT5001RA-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
074870         MOVE UT5001RA-OUTPUT-DATA-SET TO IN0014-OUTPUT-DATA-SET
074880         MOVE UT5001RA-OUTPUT-STATUS TO IN0014-OUTPUT-STATUS
074890         MOVE 1 TO WA-MSG-ERR-FLAG.
074900*
S15967         IF STRT-AREA-TRN-NO = 12000
S16682*S15967     AND WA-TR-NA-TYPE (1:1) = '6'
S19269*S16682     AND WA-TR-NA-TYPE (1:1) = ('6' OR '8')
S19269            AND (WA-TR-NA-TYPE (1:1) = ('6' OR '8')
S20771             OR  WA-TR-NA-TYPE (1:4) = '7421'
S19269             OR  WA-TR-NA-TYPE (1:2) = '78')
S15967                 GO  TO B899-EXIT
S15967         END-IF.
S15967*
S12212     IF  NOT STRT-BATCH-TXN
S12212     AND NOT STRT-TRICKLE-TXN
S12237     AND STRT-AREA-BRANCH NOT = UT5001CA-BR-NO
S12212         PERFORM X720-CALL-UT0251 THRU X729-EXIT
S12212         IF  UT0251CA-CALL-STATUS = "****"
S12212             EVALUATE UT0251RA-IB-ALLOWED-FLG
S12212             WHEN "N"
S12212                MOVE 1   TO WA-MSG-ERR-FLAG
S12212                MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
S12212                PERFORM E000-COMPLETION-PARA
S12212                         THRU E099-EXIT
S12212             WHEN "Y"
S12212                IF BORP-IB-ALLOWED
S12212                   NEXT SENTENCE
S12212                ELSE
S12212                   IF WA-INPUT-PARAM-TABLE(25) = 1
S12212                      IF BORP-DSCHG-IB-NOT-ALLOWED
S12212                         MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
S12212                         MOVE 1   TO WA-MSG-ERR-FLAG
S12212                         PERFORM E000-COMPLETION-PARA
S12212                                  THRU E099-EXIT
S12212                         GO TO B899-EXIT
S12212                      ELSE
S12212                         IF WA-INPUT-PARAM-TABLE(26) = 1
S12212                            NEXT SENTENCE
S12212                         ELSE
S12212                            MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
S12212                            MOVE 1   TO WA-MSG-ERR-FLAG
S12212                            PERFORM E000-COMPLETION-PARA
S12212                                     THRU E099-EXIT
S12212                            GO TO B899-EXIT
S12212                         END-IF
S12212                      END-IF
S12212                   ELSE
S12212                      IF WA-INPUT-PARAM-TABLE(26) = 1
S12212                         NEXT SENTENCE
S12212                      ELSE
S12212                         MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
S12212                         MOVE 1   TO WA-MSG-ERR-FLAG
S12212                         GO TO B899-EXIT
S12212                      END-IF
S12212                   END-IF
S12212                END-IF
S12212             END-EVALUATE
S12212         END-IF
S12212     END-IF.
074910 B899-EXIT.
074920     EXIT.
074930*
074940*****************************************************************
074950* RELOCATED CHARGE CODING START HERE, AS WELL
074960*****************************************************************
074970 B900-CHECK-IF-TO-APPLY-CHARGES.
074980*
074990     MOVE 0 TO CS0000RA-CHR-CNT
075000               CS0000RA-TOT-HOW-APPLY-3.
TB0125     PERFORM H300-MERGE-CUST-BASED-FEE THRU H399-EXIT.
TB0125     IF CS0012RA-FEE-MASK = LOW-VALUES OR SPACES
075010*    IF BORP-FEE-MASK = LOW-VALUES OR SPACES
075020         GO TO B999-EXIT.
075030*
075050*    IF   WA-INPUT-PARAM-TABLE(4)  = 1 OR
075060*         WA-INPUT-PARAM-TABLE(5)  = 1 OR
075070*         WA-INPUT-PARAM-TABLE(17) = 1 OR
075080*         WA-INPUT-PARAM-TABLE(25) = 1
075090*           NEXT SENTENCE
075100*    ELSE
075110*        MOVE STRT-AREA-FEE-MASK TO CS0007CA-TRAN-FEE-MASK
075120*        GO TO  B910.
075140     IF  (WA-INPUT-PROMO = SPACES  OR
075150          WA-INPUT-PROMO IS NUMERIC)
075160         IF STRT-AREA-FEE-MASK = LOW-VALUES
075170            GO TO B999-EXIT
075180         ELSE
075190            MOVE STRT-AREA-FEE-MASK TO CS0007CA-TRAN-FEE-MASK
075200            GO TO B910
075210         END-IF
075220     END-IF.
075230*
075240     IF  UT0270CA-EXEMPT-IND = "Y"                                       
075250         GO TO B999-EXIT.                                                
075260*                                                                        
075270     IF UT0270CA-FEE-MASK = LOW-VALUES                                   
075280        IF STRT-AREA-FEE-MASK = LOW-VALUES                               
075290           GO TO B999-EXIT                                               
075300        ELSE                                                             
075310           MOVE STRT-AREA-FEE-MASK TO CS0007CA-TRAN-FEE-MASK             
075320     ELSE                                                                
075330        MOVE UT0270CA-FEE-MASK TO CS0007CA-TRAN-FEE-MASK.                
075340 B910.                                                                   
075350*                                                                        
075360**** MAKE PROMO CODE OVERRIDE TXN'S FEE MASK FOR TXN 12120/19200         
075370*                                                                        
075380     IF STRT-AREA-TRN-NO = 12120 OR 19200                                
075400         NEXT SENTENCE                                                   
075410     ELSE                                                                
075420         GO TO B920                                                      
075430     END-IF.                                                             
075450     EVALUATE STRT-AREA-TRN-NO                                           
075460        WHEN 12120                                                       
075470             MOVE IN0002-PROMO-CODE TO UT0270CA-IN-PROMO                 
075480        WHEN 19200                                                       
075490             MOVE IN0020-BATCH-NO   TO UT0270CA-IN-PROMO                 
075500         WHEN 19210
075510              MOVE IN0020-BATCH-NO TO UT0270CA-IN-PROMO
075520     END-EVALUATE.                                                       
075530     MOVE 2                 TO UT0270CA-IN-CALL-CODE.                    
075540     MOVE STRT-AREA-SOC-NO  TO UT0270CA-IN-SOC-NO.                       
075550     MOVE SOC-LANGUAGE-CODE TO UT0270CA-IN-LANGUAGE-CODE.                
075560     CALL "UT0270" USING UT0270CA-AREA.                                  
075570*                                                                        
075580     IF UT0270CA-OUT-STAT NOT = "****"                                   
075590        MOVE UT8500CA-FUNC-NORMAL-DISPLAY                                
075600             TO UT8500CA-CALL-CODE                                        7
075610        MOVE SPACES TO UT8500CA-INPUT-MSG                                
075620        STRING "BR0000:(B910) INVALID PROMO CODE "                       
075630        UT0270CA-IN-PROMO, "STATUS " UT0270CA-OUT-STAT                   
075640        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG                        
075650        CALL "UT8500" USING                                              
075660                           UT8500CA-AREA                                 
075670        MOVE 1 TO WA-MSG-ERR-FLAG                                        
075680        MOVE 730 TO WA-OUTPUT-ERR-MSG-NO                                 
075690        GO TO B999-EXIT                                                  
075700     END-IF.                                                             
075710*                                                                        
075720     IF  UT0270CA-EXEMPT-IND = "Y"
075730         GO TO B999-EXIT.
075740*
075750     IF UT0270CA-FEE-MASK = LOW-VALUES
075760        IF STRT-AREA-FEE-MASK = LOW-VALUES
075770           GO TO B999-EXIT
075780        ELSE
075790           MOVE STRT-AREA-FEE-MASK TO CS0007CA-TRAN-FEE-MASK
075800     ELSE
075810        MOVE UT0270CA-FEE-MASK TO CS0007CA-TRAN-FEE-MASK
075820     END-IF.
075830*
075840 B920.
075850*
TB0125*    MOVE BORP-FEE-MASK TO CS0007CA-ACCT-FEE-MASK.
TB0125     MOVE CS0012RA-FEE-MASK TO CS0007CA-ACCT-FEE-MASK.
075870     CALL "CS0007" USING
075880                         WA-CS0007CA-CALL-AREA
075890                         WA-CS0007RA-RETURN-AREA.
075900     IF  CS0007RA-RET-STATUS NOT = 0
075910         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
075920         MOVE SPACES TO UT8500CA-INPUT-MSG
075930         STRING "BR0000:(B920) INVALID RET STATUS CS0007 "
075940         CS0007RA-RET-STATUS
075950             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
075960         CALL "UT8500" USING
075980                             UT8500CA-AREA
075990         MOVE 1            TO WA-MSG-ERR-FLAG
076000         MOVE 810          TO WA-OUTPUT-ERR-MSG-NO
076010         GO TO B999-EXIT.
076020*
076030     MOVE 0                 TO CS0000RA-CHR-CNT.
076040     IF  CS0007RA-LST-FEE = 0
076050         NEXT SENTENCE
076060     ELSE
076070         PERFORM BA00-CHARGE-CALC THRU BA99-EXIT
076080         IF CS0000RA-STATUS NOT = 01 AND 11 AND 12
076090            NEXT SENTENCE
076100         ELSE
076110             IF  CS0000RA-CHR-CNT > 0
076120                 MOVE CS0000RA-ERR-MSG (CS0000RA-CHR-CNT)
076130                   TO WA-OUTPUT-ERR-MSG-NO
076140             ELSE
076150                 MOVE 825 TO WA-OUTPUT-ERR-MSG-NO
076160             END-IF
076170             MOVE 1 TO WA-MSG-ERR-FLAG.
076180 B999-EXIT.
076190     EXIT.
076210 B1000-READ-INVM.
076220     MOVE STRT-AREA-SOC-NO TO INVM-SOC-NO.
076230     MOVE 01               TO DBIO-CALL-FUNC.
076240     MOVE INVM-KEY         TO DBIO-CALL-KEY-AREA.
076250     MOVE "INV"            TO DBIO-CALL-SYS-AREA.
076260     MOVE SPACES           TO DBIO-CALL-STATUS.
076270     CALL "DBIO" USING
076290                       DBIO-CALL-PARAM
076300                       DBIO-CALL-SYS-AREA
076310                       DBIO-CALL-KEY-AREA
076320                       DBIO-CALL-STATUS
076330                       WA-INVM-RECORD-AREA
076340                       DBIO-CALL-REFER-AREA.
076350     IF DBIO-CALL-STATUS NOT = "****" AND "MRNF"
076360        MOVE 223 TO WA-OUTPUT-ERR-MSG-NO
076370        MOVE 1 TO WA-MSG-ERR-FLAG.
076390 B1999-EXIT.
076400    EXIT.
076420/
076430 BA00-CHARGE-CALC.
076440*-----------------
076450*
076460*
076470     MOVE 02                     TO  CS0000CA-CALL-CODE.
076480     MOVE 0                      TO  CS0000CA-CALL-FUNC.
076490     MOVE CS0007RA-LST-FEE       TO  CS0000CA-LST-FEE.
076500     MOVE STRT-AREA-SOC-NO        TO  CS0000CA-SOC.
076510     MOVE CS0007RA-FEE-MASK      TO  CS0000CA-FEE-MASK.
076520     MOVE "B"                    TO  CS0000CA-SYS.
S15848*S15296     MOVE CUSM-VIP-CODE          TO  CS0000CA-VIP-CODE.
S15848     MOVE WA-CSCP-IND            TO  CS0000CA-VIP-CODE.
B19901     INITIALIZE                      CS0000CA-RICHART-IND
B19901                                     CS0000CA-PAY-CODE
B19901                                     CS0000CA-SALARY-CO-ID
B19901                                     CS0000CA-CUSTOMER-NO
B19901                                     CS0000CA-ACCT-NO.
076530     MOVE BORP-ACCT-TYPE         TO  CS0000CA-ACTYPE.
076540     MOVE BORP-INT-CAT           TO  CS0000CA-INT-CAT.
076550     MOVE STRT-AREA-TRN-NO        TO  CS0000CA-EVT-NO.
076560     MOVE 0                      TO  CS0000CA-EVT-IND
076570                                     CS0000RA-LST-FEE-PROC
076580                                     CS0000RA-TOT-HOW-APPLY-3.
076590     MOVE BORP-CURRENCY-IND      TO  CS0000CA-BASE-CCY.
076600     MOVE WA-ORIG-TXN-EVT        TO  CS0000CA-ORIG-TXN-EVT.
076610     MOVE WA-ORIG-JRNL-NO        TO  CS0000CA-ORIG-JRNL-NO.
076620     MOVE WA-ORIG-POST-DATE      TO  CS0000CA-ORIG-POST-DATE.
076630     MOVE WA-ORIG-POST-TIME      TO  CS0000CA-ORIG-POST-TIME.
076640     MOVE WA-ORIG-POST-SEQ       TO  CS0000CA-ORIG-POST-SEQ.
076650*
076660     MOVE 0                      TO  WA-CS0000RA-STATUS
076670                                     WA-CS0090RA-STATUS.
076680     IF WA-INPUT-PARAM-TABLE (23) = 1
076690        MOVE ZERO                TO  WA-INPUT-AMT.
076700     MOVE WA-INPUT-AMT           TO  WA-TXN-AMT.
076710*
076720 BA20.
076730*
076740     CALL "CS0000" USING
076760                         STARTAREA
076770                         BORR-PARAMS
076780                         WA-CS0000CA-CALL-AREA
076790                         WA-CS0000RA-RETURN-AREA
076800                         WA-TXN-AMT
076810                         WA-PASSALONG.
076820*
076830*    IF CS0000RA-STATUS = 11
076840*        DISPLAY "BR0000:(BA20) INVALID RET STATUS CS0000 "
076850*                 CS0000RA-STATUS
076860*        MOVE 1                       TO WA-MSG-ERR-FLAG
076870*        GO TO BA99-EXIT.
076880*
076890     IF CS0000RA-STATUS = 0
SC4465        MOVE CS0000RA-GROSS-CHR(1) TO WA-FEE-AMT
076900        NEXT SENTENCE
076910     ELSE
076920        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
076930        MOVE SPACES TO UT8500CA-INPUT-MSG
076940        STRING "BR0000:(BA20) INVALID RET STATUS CS0000 "
076950                CS0000RA-STATUS
076960            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
076970        CALL "UT8500" USING
076990                            UT8500CA-AREA
077000        MOVE CS0000RA-STATUS          TO WA-CS0000RA-STATUS.
077010*
077020*    IF  CS0000CA-LST-FEE = CS0000RA-LST-FEE-PROC
077030*        GO TO BA99-EXIT
077040*    ELSE
077050*        DISPLAY "BR0000:(BA20) > 30 CHARGES TO BE APPLIED "
077060*        MOVE WA-CHARGE-GT30-ERR-MSG  TO WA-OUTPUT-LIMIT-MSG
077070*        MOVE 119                     TO WA-OUTPUT-MSG-LENGTH
077080*        MOVE 998                     TO WA-OUTPUT-ERR-MSG-NO
077090*        PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
077100*        GO TO BA99-EXIT.
077110*
077120 BA99-EXIT.
077130     EXIT.
077140/
077150 BB00-PROCESS-CHARGE-TXNS.
077160*
077170*YH
077180*************************************************************
077190*                                                           *
077200*    CS0090CA-CALL-CODE = 1 : PRINT MESSAGE,WRITE JOURNAL   *
077210*                       2,4 : NO PRINT MESSAGE, NO WRITE    *
077220*                                JOURNAL                    *
077230*                         3 : NO PRINT MESSAGE              *
077240*                                                           *
077250*************************************************************
077260*
077270*
077280*
077290     MOVE 01                         TO CS0090CA-CALL-CODE.
077300     MOVE 0                          TO CS0090CA-CALL-FUNC.
077310     MOVE "B"                        TO CS0090CA-SYS.
077320     MOVE STRT-AREA-SOC-NO            TO CS0090CA-SOC.
077330     MOVE WA-INPUT-ACCT-NO           TO CS0090CA-ACCT.
077340*
077350     CALL "CS0090" USING
077370                         STARTAREA
077380                         BORR-PARAMS
077390                         WA-CS0090CA-CALL-AREA
077400                         WA-CS0000RA-RETURN-AREA
077410                         WA-PASSALONG
077420                         PBOOKCA-LINE-AREA.
077430*
077440     IF CS0000RA-STATUS = 0
077450        NEXT SENTENCE
077460     ELSE
077470        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
077480        MOVE SPACES TO UT8500CA-INPUT-MSG
077490        STRING "BR0000:(BB00) INVALID RET STATUS CS0090 "
077500                CS0000RA-STATUS
077510            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
077520        CALL "UT8500" USING
077540                            UT8500CA-AREA
077550        MOVE CS0000RA-STATUS TO WA-CS0090RA-STATUS.
077560 BB99-EXIT.
077570     EXIT.
077580**************************************************************
077590* END OF RELOCATED CHARGE RELATED CODING ENDS HERE
077600**************************************************************
077610/
077620 B3000-CHECK-LIMITS.
077630*
077640     IF  WA-ACT-BAL-BEF-TXN <= 0
077650       AND BORM-LOAN-BAL <= 0
077660       AND WA-INPUT-PARAM-TABLE(25) = 0
077670         GO TO B3099-EXIT.
077680*
077690     IF  WA-ACT-BAL-BEF-TXN = BORM-LOAN-BAL
077700       AND WA-INPUT-PARAM-TABLE(25) = 0
077710         GO TO B3099-EXIT.
077730*  A DEBIT TRANSACTION IS AN INCREASE TO THE CELM/CUSL AMOUNT
077750     IF  WA-ACT-BAL-BEF-TXN < BORM-LOAN-BAL
077760         MOVE "I" TO UT7400CA-COMPUTATION-TYPE
077770     ELSE
077780         MOVE "D" TO UT7400CA-COMPUTATION-TYPE
077790     END-IF.
077810*  THE FOLLOWING LOGIC WILL USE THE DEBIT PORTION ONLY OF THE
077820*  TRANSACTION AMOUNT WHEN AN ACCOUNT GOES FROM DR TO CR OR
077830*  VICE VERSA.  IN ALL OTHER CASES THE TRANSACTION AMOUNT IS USED
077850     IF  WA-ACT-BAL-BEF-TXN <= 0
077860         MOVE BORM-LOAN-BAL TO WA-LIMIT-AMT
077870     ELSE
077880     IF  BORM-LOAN-BAL <= 0
077890         MOVE WA-ACT-BAL-BEF-TXN TO WA-LIMIT-AMT
077900     ELSE
077910         SUBTRACT BORM-LOAN-BAL FROM WA-ACT-BAL-BEF-TXN
077920                    GIVING WA-LIMIT-AMT
077930     END-IF.
077950*  ABSOLUTE AMOUNTS ARE EXPECTED, UT7400 USES COMPUTATION-TYPE
077960*  TO DETERMINE INCREASE/DECREASE (SET ABOVE)
077980     IF  WA-LIMIT-AMT < 0
077990         MULTIPLY WA-LIMIT-AMT BY -1 GIVING WA-LIMIT-AMT.
078010     PERFORM B3300-UPDATE-RETAIL-FAC-LIMITS THRU B3399-EXIT.            
078020     IF   WA-MSG-ERR-FLAG = 1                                           
078030          GO TO B3099-EXIT.                                             
TB0023     PERFORM B3400-UPDATE-EXPOSURE-LIMITS THRU B3499-EXIT.
TB0023     IF  WA-MSG-ERR-FLAG = 1
TB0023         GO TO B3099-EXIT.
078050     MOVE STRT-AREA-SOC-NO     TO CUSM-SOC-NO.
078060     MOVE BORM-CUSTOMER-NO TO CUSM-CUST-ACCT-NO.
078070     MOVE "CUSM" TO DBIO-CALL-SYS-AREA.
078080     MOVE CUSM-KEY TO DBIO-CALL-KEY-AREA.
078090     MOVE 71 TO DBIO-CALL-FUNC.
078100     CALL "DBIO" USING
078120
078130                                 DBIO-CALL-PARAM
078140                                 DBIO-CALL-SYS-AREA
078150                                 DBIO-CALL-KEY-AREA
078160                                 DBIO-CALL-STATUS
078170                                 CUSM-RECORD-AREA.
078180     IF  DBIO-CALL-STATUS NOT = "****"
078190         MOVE 282 TO WA-OUTPUT-ERR-MSG-NO
078200         MOVE 1 TO WA-MSG-ERR-FLAG
078210         GO TO B3099-EXIT.
078220*
078230*     IF  BORM-CHECK-CUST-LMT
078240     IF  CHECK-CUST-LMT
078250         PERFORM B3100-CHECK-CUST-LIMIT THRU B3199-EXIT
078260         IF WA-OUTPUT-ERR-MSG-NO NOT = 0
078270            MOVE 1 TO WA-MSG-ERR-FLAG
078280            GO TO B3099-EXIT.
078290*
078300 B3099-EXIT.
078310     EXIT.
078320/
078330 B3100-CHECK-CUST-LIMIT.
078340*
078350     MOVE BORM-SOC-NO             TO UT7770CA-INST-NO.
078360     MOVE 3                       TO UT7770CA-CALL-TYPE.
078370     MOVE BORM-CURRENCY-IND       TO UT7770CA-CURRENCY-1.
078380     MOVE WA-LIMIT-AMT            TO UT7770CA-AMOUNT-1.
078390     MOVE SOC-CRDT-RT-ID          TO UT7770CA-TABLE-ID.
078400     MOVE ZEROES                  TO UT7770CA-ERR-MSG-NO.
078410*
078420     CALL "UT7770" USING UT7770CA-CALL-AREA.
078430*
078440     MOVE UT7770CA-ERR-MSG-NO     TO WA-OUTPUT-ERR-MSG-NO.
078450*
078460     IF   WA-OUTPUT-ERR-MSG-NO NOT = 0
078470          GO TO B3199-EXIT.
078480*
078490     MOVE BORM-SOC-NO             TO UT7400CA-INST-NO.
078500     MOVE BORM-CUSTOMER-NO        TO UT7400CA-CUSTOMER-NO.
078510     IF BORP-PRODUCT-CODE  NOT = SPACES
078520        MOVE 01                      TO UTTPPRCA-CALL-CODE
078530        MOVE BORM-SOC-NO             TO UTTPPRCA-CALL-INST-NO
078540        MOVE BORP-PRODUCT-CODE  TO UTTPPRCA-CALL-PRODUCT-CODE
078550        CALL "UTTPPR" USING   UTTPPRCA-CALL-AREA
078560                              TPPR-RECORD-AREA
078570        IF UTTPPRCA-CALL-STATUS NOT = 0
078580           MOVE SPACES            TO UT7400CA-SYSTEM
078590        ELSE
078600           MOVE TPPR-SYSTEM-CODE  TO UT7400CA-SYSTEM
078610        END-IF
078620     ELSE
078630        MOVE SPACES               TO UT7400CA-SYSTEM
078640     END-IF.
078650*     MOVE "RETAIL"                TO UT7400CA-SYSTEM.
078660     MOVE BORP-PRODUCT-CODE       TO UT7400CA-PRODUCT.
TRE906     MOVE BORM-ACT-TYPE           TO WA-TEMP-ACT-TYPE.
TRE906     MOVE WA-TEMP-ACT-TYPE        TO UT7400CA-SUB-PRODUCT.
078690     MOVE BORM-CURRENCY-IND       TO UT7400CA-ORIG-CURRENCY.
078700     MOVE WA-LIMIT-AMT            TO UT7400CA-ORIG-AMT.
078710     MOVE UT7770CA-LOCAL-CURRENCY TO UT7400CA-LOCAL-CURRENCY.
078720     MOVE UT7770CA-LOCAL-AMT-EQUIV
078730                                  TO UT7400CA-LOCAL-AMT.
078740     MOVE UT7770CA-BASE-CURRENCY  TO UT7400CA-BASE-CURRENCY.
078750     MOVE UT7770CA-BASE-AMT-EQUIV TO UT7400CA-BASE-AMT.
078770*  3900 IS THE ERROR NUMBER SETUP BY UT7400 WHEN THE OVERALL
078780*  CUSTOMER LIMIT IS EXCEEDED.  WE CHECK TO SEE IF IT HAS ALREADY
078790*  BEEN OVERRIDEN, AND IF IT HAS WE PLUG THE OVERRIDE CODE FROM UT    
078800*  TO THE CALL AREA FOR UT7400.  NOTE THIS IS REQUIRED BECAUSE OF    
078810*  DIFFERENT METHOD OF STORING OVERRIDEN MESSAGES BETWEEN RETAIL A  
078820*  TREASURY.
078840     MOVE 3900                    TO UT0060CA-CALL-ERROR-CODE.
078850     PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT.
078860     IF  WA-MSG-ERR-FLAG = 0
078870         PERFORM B3200-CALL-UTEXPT THRU B3299-EXIT
078880         IF  WA-OUTPUT-ERR-MSG-NO NOT = 0
078890             GO TO B3199-EXIT
078900         ELSE
078910             MOVE WA-3900-OVERRIDE TO UT7400CA-OVERRIDE-CODE(1)
078920         END-IF
078930     ELSE
078940         MOVE 0                   TO WA-MSG-ERR-FLAG
078950         MOVE SPACES              TO UT7400CA-OVERRIDE-CODE(1)
078960     END-IF.
078970     MOVE ZEROES                  TO UT7400CA-ERR-MSG-NO.
078980*
078990     CALL "UT7400" USING UT7400CA-CALL-AREA.
079000*
079010     MOVE UT7400CA-ERR-MSG-NO     TO WA-OUTPUT-ERR-MSG-NO.
079020*
079030     IF   WA-OUTPUT-ERR-MSG-NO NOT = 0
079040          GO TO B3199-EXIT.
079050*
079060 B3199-EXIT.
079070     EXIT.
079080/
079090 B3200-CALL-UTEXPT.
079110     IF  STRT-AREA-SOC-NO = UTEXPTCA-INST-NO
079120         GO TO B3299-EXIT.
079140     MOVE 2                      TO UTEXPTCA-CALL-CODE.
079150     MOVE STRT-AREA-SOC-NO       TO UTEXPTCA-INST-NO.
079160     MOVE "CUST"                 TO UTEXPTCA-EXP-TYPE
079170     CALL "UTEXPT" USING UTEXPTCA-AREA
079180     IF  UTEXPTCA-CALL-MSG-NO NOT = 0
079190         MOVE UTEXPTCA-CALL-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
079200         GO TO B3299-EXIT
079210     END-IF.
079230     MOVE UTEXPTCA-OVERRIDE-CODE TO WA-3900-OVERRIDE.
079250 B3299-EXIT.
079260     EXIT.
079280 B3300-UPDATE-RETAIL-FAC-LIMITS.
079300*
079310* RETRIEVE PRODUCT CODE AND CALL UT0681 FOR FACILITY UPDATE
S16871* CORPORATION CHECK LIMIT FROM BANCS TO WBS
S19269*S16871     IF (NOT BORP-FOREIGN-LABORER
S19269*S16871     AND BORP-CORPORATION)
S19269     IF ((NOT BORP-FOREIGN-LABORER
S19269     AND BORP-CORPORATION)
S20771     OR  BORP-FBOND
S19269     OR  BORP-PB)
S16871        GO TO B3399-EXIT
S16871     END-IF.
079320     PERFORM W800-READ-ACFR THRU W899-EXIT.
079330     IF   WA-MSG-ERR-FLAG = 1 OR
079340          WA-NO-FACILITY-FLAG = "Y"
079350          GO TO B3399-EXIT.
TS0081     IF WA-INPUT-PARAM-TABLE(05) = 1 AND
TS0081        WA-INPUT-PARAM-TABLE(07) = 0
ST0081        PERFORM R000-READ-FACM THRU R099-EXIT
ST0081        IF WA-MSG-ERR-FLAG = 1
ST0081           GO TO B3399-EXIT
ST0081        END-IF
ST0081        PERFORM Q000-REVALUATION THRU Q000-EXIT
ST0081        IF WA-MSG-ERR-FLAG = 1
ST0081           GO TO B3399-EXIT
ST0081        END-IF
ST0081        IF WA-NEGATIVE-DRAWDOWN
ST0081           MOVE "Y" TO UT0681CA-CALL-ALLOW-NEG-LMT
ST0081        ELSE
ST0081           MOVE "N" TO UT0681CA-CALL-ALLOW-NEG-LMT
ST0081        END-IF
TS0081     END-IF.
079370     IF BORP-PRODUCT-CODE NOT = SPACES
079380        MOVE 01                TO UTTPPRCA-CALL-CODE
079390        MOVE STRT-AREA-SOC-NO  TO UTTPPRCA-CALL-INST-NO
079400        MOVE BORP-PRODUCT-CODE TO UTTPPRCA-CALL-PRODUCT-CODE
079410        CALL "UTTPPR" USING
079420                              UTTPPRCA-CALL-AREA
079430                              TPPR-RECORD-AREA
079440        IF UTTPPRCA-CALL-STATUS NOT = 0
079450           MOVE SPACES  TO UT0681CA-CALL-BRKDWN-SYSTEM
079460                           UT0681CA-CALL-BRKDWN-PRODUCT
079470        ELSE
079480           MOVE TPPR-SYSTEM-CODE
079490                        TO UT0681CA-CALL-BRKDWN-SYSTEM
079500           MOVE BORP-PRODUCT-CODE
079510                        TO UT0681CA-CALL-BRKDWN-PRODUCT
079520        END-IF
079530     ELSE
079540        MOVE SPACES  TO UT0681CA-CALL-BRKDWN-SYSTEM
079550                        UT0681CA-CALL-BRKDWN-PRODUCT
079560     END-IF.
079580     MOVE BORM-LOAN-BAL     TO WA-ACCT-BAL-AFT-TXN.
079590     MOVE BORM-UNC-VAL      TO WA-UNCL-BAL-AFT-TXN.
079600     MOVE ZEROES            TO UT0681CA-CALL-STATUS.
079610     MOVE STRT-AREA-SOC-NO  TO UT0681CA-CALL-INST-NO.
079620     MOVE ACFR-FACILITY-NO  TO UT0681CA-CALL-FACILITY-NO.
TB0023     MOVE ACFR-FAC-LEVEL-NO TO UT0681CA-CALL-LEVEL-NO.
TB0023     IF SOC-SITE-TIB
TB0023        MOVE ACFR-FAC-REF-CODE   TO UT0681CA-CALL-REF-CODE
TB0023     ELSE
TB0023        MOVE ACFR-FAC-PARENT-REF TO UT0681CA-CALL-PAR-REF.
079630     MOVE BORM-CURRENCY-IND TO UT0681CA-CALL-BRKDWN-CURR.
079640     MOVE BORM-ACT-TYPE     TO UT0681CA-CALL-BRKDWN-ACTYPE.
079650     MOVE "LON"             TO UT0681CA-CALL-CURR-SYS.
079660     MOVE BORM-CURRENCY-IND TO UT0681CA-CALL-AMOUNT-CURR.
079670     MOVE 2                 TO UT0681CA-CALL-CODE.
079690     IF WA-ACCT-BAL-BEF-TXN < 0 AND WA-ACCT-BAL-AFT-TXN > 0
079700        MOVE WA-ACCT-BAL-AFT-TXN TO WA-ACCT-BAL-DIFF
079710     ELSE
079720        SUBTRACT WA-ACCT-BAL-BEF-TXN FROM WA-ACCT-BAL-AFT-TXN
079730                 GIVING WA-ACCT-BAL-DIFF
079740     END-IF.
079750     SUBTRACT WA-UNCL-BAL-BEF-TXN FROM WA-UNCL-BAL-AFT-TXN
079760              GIVING WA-UNCL-BAL-DIFF.
079770     SUBTRACT WA-UNCL-BAL-DIFF    FROM WA-ACCT-BAL-DIFF
079780              GIVING WA-ACCT-UNCL-DIFF.
079790*START
079800* LIMIT FOR APPROVAL IS DONE IN BR0017
079810     IF STRT-AREA-TRN-NO NOT = 12420
079820        COMPUTE UT0681CA-CALL-APP-AMOUNT =
079830                    (BORM-APP-AMT + BORM-ADD-LOAN-APP) * -1
079840     ELSE
079850        MOVE ZEROES               TO UT0681CA-CALL-APP-AMOUNT
079860     END-IF.
079870*END
079890     IF SOC-LIMIT-CLR-BAL-IND <> 1
079900        IF WA-ACCT-BAL-AFT-TXN >= 0
079910              MOVE WA-ACCT-BAL-DIFF TO UT0681CA-CALL-AMOUNT
079920              CALL "UT0681" USING
079930                         UT0681CA-CALL-AREA
079940                         STARTAREA
079950                         MULTI-OVERRIDE-AREA
079960        ELSE IF WA-ACCT-BAL-AFT-TXN < WA-ACCT-BAL-DIFF
079970              SUBTRACT WA-ACCT-BAL-AFT-TXN FROM WA-ACCT-BAL-DIFF
079980                       GIVING WA-FACI-UPDT-AMT
079990              MOVE WA-FACI-UPDT-AMT TO UT0681CA-CALL-AMOUNT
080000              CALL "UT0681" USING
080010                         UT0681CA-CALL-AREA
080020                         STARTAREA
080030                         MULTI-OVERRIDE-AREA
080040        END-IF
080050     ELSE
080060        IF WA-ACCT-UNCL-DIFF <> 0
080070           IF WA-ACCT-BAL-AFT-TXN >= 0
080080              MOVE WA-ACCT-UNCL-DIFF TO UT0681CA-CALL-AMOUNT
080090              CALL "UT0681" USING
080100                         UT0681CA-CALL-AREA
080110                         STARTAREA
080120                         MULTI-OVERRIDE-AREA
080130            ELSE IF WA-ACCT-BAL-AFT-TXN < WA-ACCT-UNCL-DIFF
080140              SUBTRACT WA-ACCT-BAL-AFT-TXN FROM WA-ACCT-UNCL-DIFF
080150                       GIVING WA-FACI-UPDT-AMT
080160              MOVE WA-FACI-UPDT-AMT TO UT0681CA-CALL-AMOUNT
080170              CALL "UT0681" USING
080180                         UT0681CA-CALL-AREA
080190                         STARTAREA
080200                         MULTI-OVERRIDE-AREA
080210           END-IF
080220        END-IF
080230     END-IF.
080250     IF UT0681CA-CALL-STATUS NOT = 0
080260        IF UT0681CA-CALL-MSG-NO = 772
080270           MOVE 772           TO UT0060CA-CALL-ERROR-CODE
080280           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
080290           IF WA-MSG-ERR-FLAG = 0
080300              MOVE 772 TO WA-ERR-MSG-NO
080310           ELSE
080320              MOVE 772 TO WA-OUTPUT-ERR-MSG-NO
080330              MOVE 1   TO WA-MSG-ERR-FLAG
080340            END-IF
080350            GO TO B3399-EXIT
080360         END-IF
S15349        IF UT0681CA-CALL-MSG-NO = 5065
S15349           MOVE  5065        TO UT0060CA-CALL-ERROR-CODE
S15349           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
S15349           IF WA-MSG-ERR-FLAG = 0
S15349              MOVE 5065  TO  WA-ERR-MSG-NO
S15349           ELSE
S15349              MOVE 5065  TO WA-OUTPUT-ERR-MSG-NO
S15349              MOVE 1   TO WA-MSG-ERR-FLAG
S15349           END-IF
S15349           GO TO B3399-EXIT
S15349         END-IF
080370        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
080380                    TO UT8500CA-CALL-CODE
080390        MOVE SPACES TO UT8500CA-INPUT-MSG
080400        STRING "BR0000:(B3300) CALL TO UT0681 ERROR, STAT- "
080410                UT0681CA-CALL-STATUS
080420            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
080430        CALL "UT8500" USING
080440                            UT8500CA-AREA
080450        MOVE UT0681CA-CALL-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
080460        MOVE 1                    TO WA-MSG-ERR-FLAG
080470     END-IF.
080490     IF   WA-OUTPUT-ERR-MSG-NO NOT = 0
080500          GO TO B3399-EXIT.
080510*
080520*  END OF UT0681 CALL
080530*
080550 B3399-EXIT.
080560     EXIT.
340300/
TB0023 B3400-UPDATE-EXPOSURE-LIMITS.
SC4907     MOVE WA-DUMMY-AMT    TO WA-SAVE-DUMMY-AMT.                 
SC4907     IF STRT-AREA-TRN-NO = 11010 OR 11045 OR 11046              
SC9557                        OR 11020 OR 11120
SC4907                        OR 11110 OR 11145 OR 11146              
S11929                        OR 14011 OR 14030 OR 14035
S11929                        OR 19011 OR 19030 OR 19045
SC4907                        OR 16010 OR 16045 OR 16046              
SC4907                        OR 16110 OR 16145 OR 16146              
S10982                        OR 16120 OR 11049 OR 11149
S10982                        OR 16049 OR 16149
S10542                        OR 16130 OR 16111
S12394                        OR 16101
SC4907        PERFORM Z680-GET-BUCKET-GLCC                            
SC4907           THRU Z689-EXIT                                       
SC4907                                                                
SC4907        IF WA-MSG-ERR-FLAG NOT = 0                              
SC4907           GO TO B3499-EXIT                                     
SC4907        END-IF                                                  
SC4907                                                                
SC4907        MOVE 0             TO WA-DUMMY-AMT                      
SC4907        PERFORM                                                 
SC4907            VARYING WA-PTR-BK FROM 1 BY 1                       
SC4907                UNTIL WA-PTR-BK > 15                            
SC4907            IF  UT0094CA-BUCKET-DUE (WA-PTR-BK) <> WA-ZERO      
SC4907            AND UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) <> WA-ZERO 
SC4907                MOVE UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) TO    
SC4907                                                  WA-BUCKET-TRAN
SC4907                IF WA-INPUT-PARAM-TABLE(7) = 0                  
SC4907                   PERFORM Z610-SEARCH-BUCKET-VIA-TRAN           
SC4907                      THRU Z619-EXIT                             
SC4907                ELSE                                             
SC4907                  PERFORM Z620-SEARCH-BUCKET-VIA-CORR            
SC4907                     THRU Z629-EXIT                              
SC4907                END-IF                                           
SC4907                                                                 
SC4907                 IF WA-PRIORITY-CDE = "P"                        
SC4907                  OR WA-BUCKET-TRAN = 13031 OR 11044 OR 11048    
SC4907                                   OR 13131 OR 11144 OR 11148    
S11929                                   OR 14044 OR 14031 OR 14048
S11929                                   OR 14144 OR 14131 OR 14148
SC4907                    ADD UT0094CA-BUCKET-DUE (WA-PTR-BK) TO
SC4907                                                     WA-DUMMY-AMT
SC4907                END-IF                                           
SC4907           END-IF                                                
SC4907        END-PERFORM                                              
SC4907     END-IF.                                                     
SC4907                                                                 
TB0023     INITIALIZE XFAR-KEY.
TB0023     MOVE STRT-AREA-SOC-NO           TO XFAR-SOC-NO.
TB0023     MOVE "BOR"                      TO XFAR-SYSTEM.
TB0023     MOVE BORM-MEMB-CUST-AC          TO XFAR-ACCT-NO.
TB0023     MOVE 71                         TO DBIO-CALL-FUNC.
TB0023     MOVE XFAR-KEY                   TO DBIO-CALL-KEY-AREA.
TB0023     MOVE "XFAR"                     TO DBIO-CALL-SYS-AREA.
TB0023     MOVE SPACES                     TO DBIO-CALL-STATUS.
TB0023     CALL "DBIO" USING DBIO-CALL-PARAM
TB0023                       DBIO-CALL-SYS-AREA
TB0023                       DBIO-CALL-KEY-AREA
TB0023                       DBIO-CALL-STATUS
TB0023                       XFAR-AREA
TB0023                       DBIO-CALL-REFER-AREA.
TB0023     IF DBIO-CALL-STATUS  = "MRNF"
S11929        MOVE WA-SAVE-DUMMY-AMT    TO WA-DUMMY-AMT
TB0023        GO TO B3499-EXIT.
TB0023     IF DBIO-CALL-STATUS <> "****"
TB0023        MOVE 155                     TO WA-OUTPUT-ERR-MSG-NO
TB0023        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
TB0023        MOVE SPACES                  TO UT8500CA-INPUT-MSG
TB0023        STRING "BR0000:(B3400) 'XFAR' READ ERROR, STAT-"
TB0023                DBIO-CALL-STATUS ", KEY-"
TB0023                DBIO-CALL-KEY-AREA
TB0023                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0023        CALL "UT8500" USING UT8500CA-AREA
TB0023        MOVE 1 TO WA-MSG-ERR-FLAG
TB0023        GO TO B3499-EXIT.
TB0084     MOVE 0                        TO UT0683CA-CALL-STATUS
TB0023     MOVE STRT-AREA-SOC-NO         TO UT0683CA-CALL-INST-NO
TB0084     PERFORM VARYING WA-EXP FROM 1 BY 1 UNTIL WA-EXP > 3
TB0084             OR UT0683CA-CALL-STATUS <> 0
TB0084        IF XFAR-EXPOSURE-NO(WA-EXP)  <> WA-ZERO AND
TB0143           XFAR-CAR-RET-FLAG(WA-EXP) <> "1"
TB0023           MOVE XFAR-EXPOSURE-NO  (WA-EXP) TO 
TB0084                         UT0683CA-CALL-EXPOSURE-NO
TB0023           MOVE XFAR-FAC-BREAKDOWN(WA-EXP) TO 
TB0084                         UT0683CA-CALL-BRKDWN-LEVEL 
TB0023           MOVE "LON"                 TO UT0683CA-CALL-CURR-SYS
TB0023           MOVE BORM-CURRENCY-IND     TO UT0683CA-CALL-AMOUNT-CURR
TB0023           MOVE 2                     TO UT0683CA-CALL-CODE 
TB0023           MOVE WA-DUMMY-AMT          TO UT0683CA-CALL-AMOUNT 
TB0023           MOVE ZEROES                TO UT0683CA-CALL-APP-AMOUNT 
TB0023           IF STRT-AREA-TRN-NO <> 12420
TB0023              COMPUTE UT0683CA-CALL-APP-AMOUNT =
TB0023                  (BORM-APP-AMT + BORM-ADD-LOAN-APP) * -1 
TB0084           END-IF
#14TIB           MOVE BORP-LOAN-CLASS  TO UT0683CA-CALL-PRODUCT-CLASS
#14TIB           MOVE BOIS-CREDIT-TYPE TO UT0683CA-CALL-ACCT-CR-TYPE
#14TIB           MOVE BORM-ADV-VAL     TO UT0683CA-CALL-ADV-VALUE
#14TIB           IF WA-FIRST-ADV
#14TIB              SET UT0683CA-FIRST-DRAWDOWN TO TRUE
#14TIB           END-IF
TB0023           CALL "UT0683" USING
TB0023                         UT0683CA-CALL-AREA
TB0023                         STARTAREA
TB0023                         MULTI-OVERRIDE-AREA
TB0084        END-IF
TB0084     END-PERFORM.
TB0023     IF UT0683CA-CALL-STATUS NOT = 0
TB0023        IF UT0683CA-CALL-MSG-NO = 772
TB0023           MOVE 772           TO UT0060CA-CALL-ERROR-CODE
TB0023           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
TB0023           IF WA-MSG-ERR-FLAG = 0
TB0023              MOVE 772 TO WA-ERR-MSG-NO
TB0023           ELSE
TB0023              MOVE 772 TO WA-OUTPUT-ERR-MSG-NO
TB0023              MOVE 1   TO WA-MSG-ERR-FLAG
TB0023           END-IF
TB0023           GO TO B3499-EXIT
TB0023        END-IF
TB0023        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0023                    TO UT8500CA-CALL-CODE
TB0023        MOVE SPACES TO UT8500CA-INPUT-MSG
TB0023        STRING "BR0000:(B3400) CALL TO UT0683 ERROR, STAT- "
TB0023                UT0683CA-CALL-STATUS
TB0023            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0023        CALL "UT8500" USING
TB0023                            UT8500CA-AREA
TB0023        MOVE UT0683CA-CALL-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
TB0023        MOVE 1                    TO WA-MSG-ERR-FLAG
TB0023     END-IF.
SC4907     MOVE WA-SAVE-DUMMY-AMT    TO WA-DUMMY-AMT.
TB0023 B3499-EXIT.
TB0023     EXIT.
TB0023/
TB0008* TB0008 START
TB0008 B4000-READ-RNUM.
           MOVE STRT-AREA-SOC-NO           TO KEY-RNUM-INST-NO.
           MOVE STRT-AREA-BRANCH           TO KEY-RNUM-BRANCH-NO.
           MOVE WA-GROUP-TYPE              TO KEY-RNUM-ACCT-TYPE.
TB0117**   MOVE WA-TR-NA-TYPE              TO KEY-RNUM-ACCT-TYPE.
SC8720**--
SC8720     IF  SOC-SITE-TIB
SC8720         MOVE ZEROS                  TO KEY-RNUM-ACCT-TYPE
SC8720     END-IF.
SC8720**--
           MOVE KEY-RNUM-AREA              TO RNUM-KEY
                                              DBIOMOD-KEY.
           MOVE "READ"                     TO DBIOMOD-FUNCTION.
           MOVE "N"                        TO DBIOMOD-RELEASE-LOCK.
           MOVE ZEROES                     TO DBIOMOD-KEY-NO.
           PERFORM B4100-RNUM-DBIO THRU B4100-EXIT.
       B4000-EXIT.
           EXIT.
       B4100-RNUM-DBIO.
           MOVE "RNUM"                     TO DBIOMOD-FILE
                                              DBIOMOD-SUFFIX.
           MOVE "DBIO"                     TO DBIOMOD-PREFIX.
           MOVE SPACES          TO
                                   DBIOMOD-ACCESS-COMMAND
                                   DBIOMOD-ACCESS-COND
                                   DBIOMOD-STATUS.
           CALL DBIOMODNAME USING
                               DBIOMOD-FILE
                               DBIOMOD-KEY
                               RNUM-DATA-REC-WA
                               DBIOMOD-FUNCTION
                               DBIOMOD-KEY-NO
                               DBIOMOD-RELEASE-LOCK
                               DBIOMOD-ACCESS-COMMAND
                               DBIOMOD-ACCESS-COND
                               DBIOMOD-STATUS.
TB0008 B4100-EXIT.
           EXIT.
TB0008* END TB0008
TB0027/
TB0027 B5100-ACCESS-BOIS.
TB0027     MOVE "BOIS"   TO DBIOMOD-FILE
TB0027                      DBIOMOD-SUFFIX.
TB0027     MOVE "DBIO"   TO DBIOMOD-PREFIX.
TB0027     MOVE BORM-KEY OF BORM-RECORD-AREA
TB0027                   TO DBIOMOD-KEY
TB0027                      BOIS-KEY.
TB0027     MOVE ZEROES   TO DBIOMOD-KEY-NO.
TB0027     MOVE SPACES   TO DBIOMOD-STATUS
TB0027                      DBIOMOD-RELEASE-LOCK
TB0027                      DBIOMOD-ACCESS-COMMAND
TB0027                      DBIOMOD-ACCESS-COND.
TB0027     CALL DBIOMODNAME USING
TB0027                              DBIOMOD-FILE
TB0027                              DBIOMOD-KEY
TB0027                              BOIS-RECORD
TB0027                              DBIOMOD-FUNCTION
TB0027                              DBIOMOD-KEY-NO
TB0027                              DBIOMOD-RELEASE-LOCK
TB0027                              DBIOMOD-ACCESS-COMMAND
TB0027                              DBIOMOD-ACCESS-COND
TB0027                              DBIOMOD-STATUS.
TB0027     IF DBIOMOD-STAT NOT = "****"
TB0027         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
TB0027              UT8500CA-CALL-CODE
TB0027         MOVE SPACES TO UT8500CA-INPUT-MSG
TB0027         STRING "BR0000:(B5100)  "
TB0027                " ERROR ACCESSING BOIS"
TB0027                ", FUNC=" DBIOMOD-FUNCTION
TB0027                ", KEY="  DBIOMOD-KEY
TB0027                ", STAT=" DBIOMOD-STAT
TB0027                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0027         CALL "UT8500"    USING
TB0027                                  UT8500CA-AREA
TB0027
TB0027         MOVE DBIOMOD-STAT   TO WA-DB-ERROR
TB0027         MOVE "BOIS"         TO WA-DBERR-DATA-SET
TB0027         MOVE 155            TO WA-OUTPUT-ERR-MSG-NO
TB0027         MOVE 1              TO WA-MSG-ERR-FLAG.
TB0027
TB0027 B5199-EXIT.
TB0027     EXIT.
080570/
080580 C000-PRE-IMAGE-LOG.
080590     IF  WA-INPUT-PARAM-TABLE(24)  = 1
080600        MOVE  BORM-CURRENCY-IND   TO CASHIER-CURRENCY
080610     ELSE
080620        MOVE WS-SAVE-TXN-CURRENCY TO CASHIER-CURRENCY.
080630 C000-CASHIER-CHK2.
080640     IF STRT-BATCH-TRICKLE-TXN
080650     OR STRT-SWIFT-TXN
080660*ST0029 OR STRT-AREA-EFT-TXN
080670*SC9192 OR STRT-REPOST-TXN                                             
SC7166     OR STRT-MORTGAGE-TXN
080680        GO TO C099-EXIT.
080690     IF CASHIER-CURRENCY      = SPACE    OR
080700                                SOC-NATIVE-CURRENCY
080710       IF   STRT-CONVERSION-TXN
080720         MOVE 21   TO CASHIER-TOTAL-FUNCTION
080730         GO TO C020
080740       ELSE
080750         MOVE 01   TO CASHIER-TOTAL-FUNCTION
080760         GO   TO   C020.
080770     IF  SOC-MULTI-CURRENCY       = "2"
080780*        MOVE 31 TO CASHIER-TOTAL-FUNCTION
080790         MOVE 01   TO CASHIER-TOTAL-FUNCTION
080800         GO   TO    C020.
080810*    MOVE 11 TO CASHIER-TOTAL-FUNCTION.
080820     MOVE 01 TO CASHIER-TOTAL-FUNCTION.
080830*
080840 C020.
080850     MOVE STRT-AREA-SOC-NO       TO CAST-SOC-NO.
080860     MOVE STRT-AREA-BRANCH       TO CAST-BRANCH-NO.
080870     MOVE STRT-AREA-TELL-NO      TO CAST-TELLER-NO.
080880     MOVE SOC-NATIVE-CURRENCY    TO CASHIER-BASE-CURRENCY.
080890     MOVE ZEROES                 TO CASHIER-AMOUNT
080900                                    CASHIER-CLOSE-INT-AVAIL.
080910     MOVE "LON"                  TO CASHIER-SYSTEM.
080920     CALL "UT0019" USING
080940                         STARTAREA
080950                         SOC-PARAMS
080960                         CASHIER-TOTALS
080970*                        CASHIER-CURRENCY.
080980                         CASHIER-CALL-AREA.
080990     IF CASHIER-TOTAL-STATUS NOT = 0
081000         MOVE 1         TO WA-MSG-ERR-FLAG
081010         MOVE 184                  TO WA-OUTPUT-ERR-MSG-NO
081020         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
081030         MOVE SPACES TO UT8500CA-INPUT-MSG
081040         STRING "BR0000:(C020) CAST READ ERROR, KEY-AC"
081050                CASHIER-CURRENCY ", " CASHIER-TOTAL-FUNCTION ", "
081060                CAST-KEY
081070                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
081080         CALL "UT8500" USING
081100                             UT8500CA-AREA
081110         GO TO C099-EXIT.
081120     MOVE 1                      TO WA-CAST-LOCK-FLAG.
081130*
081140 C099-EXIT.
081150     EXIT.
081160/
081170 C100-MOVE-DATA.
081180     MOVE SPACES TO WA-EDIT-BAL-AMT.
081190     IF UT0290CA-CURR-DECS NOT = 3
081200         PERFORM C110-CHECK-ZERO THRU C119-EXIT
081210     ELSE
081220         MOVE WA-WORK-AMOUNT TO WA-EDIT-BAL-AMT-1.
081230 C109-EXIT.
081240     EXIT.
081250/
081260 C110-CHECK-ZERO.
081270     IF UT0290CA-CURR-DECS = 0
081280         MOVE WA-WORK-AMOUNT TO WA-EDITED-AMT-4
081290     ELSE
081300         IF UT0290CA-CURR-DECS = 1
081310             MOVE WA-WORK-AMOUNT TO WA-EDITED-AMT-3
081320         ELSE
081330             IF UT0290CA-CURR-DECS = 2
081340                 MOVE WA-WORK-AMOUNT TO WA-EDITED-AMT-2
081350             ELSE
081360                 MOVE WA-WORK-AMOUNT TO WA-EDIT-BAL-AMT-1.
081370 C119-EXIT.
081380     EXIT.
S19100
S19100 C120-CHECK-STRF-DATA.
S19100     MOVE SPACES            TO WA-STRF-FEE-FLG.
S19100     IF STRT-REPOST-TXN
S19100        MOVE 2              TO UT9002CA-CALL-CODE
S19100        CALL "UT9002" USING    UT9002CA-CALL-AREA
S19100        MOVE UT9002CA-IMG0-DATE TO WA-TEMP-DATE
S19100     ELSE
S19100        MOVE 0              TO UT1996CA-CALL-CODE
S19100        CALL "UT1996" USING    UT1996CA-CALL-AREA
S19100        MOVE UT1996CA-DATE  TO WA-TEMP-DATE
S19100     END-IF.
S19100
S19100     INITIALIZE STRA-RECORD-AREA.
S19100     MOVE STRT-AREA-SOC-NO  TO STRA-INST-NO.
S19100     MOVE W800-TO-ACCT      TO STRA-ACCT-NO.
S19100     MOVE "00006"           TO STRA-TYPE-CODE.
S19100     MOVE SPACES            TO STRA-SE-CODE.
S19100     MOVE STRA-KEY          TO DBIOMOD-KEY.
S19100     SET READ-CMD           TO TRUE.
S19100     PERFORM M800-ACCESS-STRA THRU M800-EXIT.
S19100     IF DBIOMOD-STAT NOT = "****" AND "MRNF"
S19100        MOVE 1              TO WA-MSG-ERR-FLAG
S19100        MOVE 155            TO WA-OUTPUT-ERR-MSG-NO
S19100        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
S19100                            TO UT8500CA-CALL-CODE
S19100        MOVE SPACES         TO UT8500CA-INPUT-MSG
S19100        STRING "BR0000(C120): READ STRA ERROR: "
S19100               DBIOMOD-STAT ", STRA-KEY: " STRA-KEY
S19100        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S19100        CALL "UT8500" USING UT8500CA-AREA
S19100        GO TO C129-EXIT
S19100     END-IF.
S19100
S19100     IF DBIOMOD-STAT = "****"
S19100        IF WA-INPUT-PARAM-TABLE(7) = 1
S19100           IF  WA-TEMP-DATE = STRA-MNT-DATE
S19100           AND STRA-CREATE
S19100           AND W800-CORR-JRNL-NO = STRA-PROC-DATA
S19100               SET STRA-CANCEL TO TRUE
S19100           ELSE
S19100               GO TO C129-EXIT
S19100           END-IF
S19100        ELSE
S19100           IF  WA-TEMP-DATE = STRA-MNT-DATE
S19100           AND STRA-CREATE
S19100               GO TO C129-EXIT
S19100           END-IF
S19100           MOVE STRT-AREA-JRNL-NO TO STRA-PROC-DATA
S19100           SET STRA-CREATE TO TRUE
S19100        END-IF
S19100        MOVE "1"               TO WA-STRF-FEE-FLG
S19100        MOVE STRT-AREA-TELL-NO TO STRA-MNT-TELLER
S19100        MOVE STRT-AREA-BRANCH  TO STRA-MNT-BRANCH
S19100        MOVE WA-TEMP-DATE      TO STRA-MNT-DATE
S19100        SET REWRITE-CMD TO TRUE
S19100     ELSE
S19100        IF WA-INPUT-PARAM-TABLE(7) = 1
S19100           GO TO C129-EXIT
S19100        END-IF
S19100        MOVE "1"               TO WA-STRF-FEE-FLG
S19100        MOVE STRT-AREA-JRNL-NO TO STRA-PROC-DATA
S19100        MOVE STRT-AREA-TELL-NO TO STRA-MNT-TELLER
S19100        MOVE STRT-AREA-BRANCH  TO STRA-MNT-BRANCH
S19100        MOVE WA-TEMP-DATE      TO STRA-MNT-DATE
S19100        SET STRA-CREATE TO TRUE
S19100        SET WRITE-CMD   TO TRUE
S19100     END-IF.
S19100
S19100     PERFORM M800-ACCESS-STRA THRU M800-EXIT.
S19100     IF DBIOMOD-STAT NOT = "****"
S19100        MOVE 1              TO WA-MSG-ERR-FLAG
S19100        MOVE 155            TO WA-OUTPUT-ERR-MSG-NO
S19100        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
S19100                            TO UT8500CA-CALL-CODE
S19100        MOVE SPACES         TO UT8500CA-INPUT-MSG
S19100        STRING "BR0000(C120): ACCESS STRA ERROR: "
S19100               DBIOMOD-FUNCTION ": " DBIOMOD-STAT
S19100               " KEY: " STRA-KEY
S19100        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S19100        CALL "UT8500" USING UT8500CA-AREA
S19100        GO TO C129-EXIT
S19100     END-IF.
S19100 C129-EXIT.
S19100     EXIT.
S12332*S11717*--------------
S12332*S11717 C200-GET-CLMT-RTN.
S12332*S11717*--------------
S12332*S11717     INITIALIZE CLMT-RECORD.
S12332*S11717*
S12332*S12336     MOVE SPACES               TO WA-CLMT-FOUND-FLG.
S12332*S11717     MOVE BORM-SOC-NO          TO CLMT-INST-NO.
S12332*S11717     MOVE WA-CLMT-CHANNEL      TO CLMT-CHANNEL.
S12332*S11717     MOVE BORM-MEMB-CUST-AC    TO CLMT-ACCT-NO.
S12332*S11717     MOVE CLMT-KEY             TO DBIOMOD-KEY.
S12332*S11717     MOVE "CLMT"               TO WA-TABLE-NAME.
S12332*S11717     MOVE 0                    TO DBIOMOD-KEY-NO.
S12332*S11717     SET READ-CMD              TO TRUE.
S12332*S11717*
S12332*S11717     PERFORM C300-CALL-DBIO    THRU C300-EXIT.
S12332*S11717*
S12332*S11717     IF DBIOMOD-STAT NOT = "****"
S12332*S12336        IF DBIOMOD-STAT  = "MRNF"
S12332*S12336           SET  WA-CLMT-FOUND-NO  TO TRUE
S12332*S12336        END-IF
S12332*S11717        MOVE  "N"              TO CLMT-ATM-OVRS-WD-FLG
S12332*S11717        MOVE  0                TO CLMT-ATM-OVRS-WD-DATE
S12332*S11717        GO                     TO C200-GET-CLMT-EXIT
S12332*S11717     END-IF.
S12332*S11717*
S12332*S11717     IF NOT  ( CLMT-ACTIVE )
S12332*S11717      IF NOT ( CLMT-MB     )
S12332*S11717        MOVE  1                TO WA-MSG-ERR-FLAG
S12332*S11717        MOVE  3330             TO WA-OUTPUT-ERR-MSG-NO
S12332*S11717      END-IF
S12332*S11717     END-IF.
S12332*S11717*
S12332*S11717 C200-GET-CLMT-EXIT.
S12332*S11717     EXIT.
S12332*S11717*
S12332*S11717*---------------
S12332*S11717 C300-CALL-DBIO.
S12332*S11717*---------------
S12332*S11717     MOVE WA-TABLE-NAME      TO DBIOMOD-FILE
S12332*S11717                                DBIOMOD-SUFFIX
S12332*S11717     MOVE "DBIO"             TO DBIOMOD-PREFIX
S12332*S11717     MOVE SPACES             TO DBIOMOD-RELEASE-LOCK
S12332*S11717                                DBIOMOD-ACCESS-COMMAND
S12332*S11717                                DBIOMOD-ACCESS-COND
S12332*S11717                                DBIOMOD-STATUS
S12332*S11717
S12332*S11717     CALL DBIOMODNAME USING DBIOMOD-FILE
S12332*S11717                            DBIOMOD-KEY
S12332*S11717                            CLMT-RECORD
S12332*S11717                            DBIOMOD-FUNCTION
S12332*S11717                            DBIOMOD-KEY-NO
S12332*S11717                            DBIOMOD-RELEASE-LOCK
S12332*S11717                            DBIOMOD-ACCESS-COMMAND
S12332*S11717                            DBIOMOD-ACCESS-COND
S12332*S11717                            DBIOMOD-STATUS.
S12332*S11717 C300-EXIT.
S12332*S11717     EXIT.
081390/
081400 D000-SEND-NEXT-TRK-SCREEN.
081410     IF  STRT-AREA-TRN-NO = 17081 OR 17082 OR 17083                     
081420         GO TO D099-EXIT.                                               
081430     IF  STRT-AREA-TRN-NO = 17050
081440         MOVE 17000 TO STRT-AREA-TRN-NO
081450         MOVE WA-INPUT-MSG TO WA-OUTPUT-MSG
081460*        MOVE 544 TO WA-OUTPUT-MSG-LENGTH
081470*        MOVE 567 TO WA-OUTPUT-MSG-LENGTH                                 
081480*        MOVE 568 TO WA-OUTPUT-MSG-LENGTH                                 
TB0007*        MOVE 572 TO WA-OUTPUT-MSG-LENGTH                          
TB0007*        MOVE 578 TO WA-OUTPUT-MSG-LENGTH
TB0023*        MOVE 608 TO WA-OUTPUT-MSG-LENGTH
TB0069*        MOVE 706 TO WA-OUTPUT-MSG-LENGTH
TB0023*        MOVE 714 TO WA-OUTPUT-MSG-LENGTH
TB0082**       MOVE 759 TO WA-OUTPUT-MSG-LENGTH
TB0082*        MOVE 773 TO WA-OUTPUT-MSG-LENGTH
TB0101*---     MOVE 777 TO WA-OUTPUT-MSG-LENGTH
TB0084*--      MOVE 800 TO WA-OUTPUT-MSG-LENGTH
TB0023*        MOVE 808 TO WA-OUTPUT-MSG-LENGTH
TB0104*TB0169  MOVE 982 TO WA-OUTPUT-MSG-LENGTH
TB0169*TB0196  MOVE 548 TO WA-OUTPUT-MSG-LENGTH
TB0196*        MOVE 556 TO WA-OUTPUT-MSG-LENGTH
S15903*TB0284         MOVE 558 TO WA-OUTPUT-MSG-LENGTH
S16757*S15903         MOVE 600 TO WA-OUTPUT-MSG-LENGTH
S18379*S16757         MOVE 647 TO WA-OUTPUT-MSG-LENGTH
S19472*S18379         MOVE 648 TO WA-OUTPUT-MSG-LENGTH
S19833*S19472         MOVE 649 TO WA-OUTPUT-MSG-LENGTH
S20355*S19833         MOVE 652 TO WA-OUTPUT-MSG-LENGTH
S20669*S20355         MOVE 653 TO WA-OUTPUT-MSG-LENGTH
S20699*S20669         MOVE 656 TO WA-OUTPUT-MSG-LENGTH
S20699         MOVE 657 TO WA-OUTPUT-MSG-LENGTH
081500         GO TO D090-SEND-SCREEN.
081510     IF  STRT-AREA-TRN-NO = 17051
081520         MOVE 17001 TO STRT-AREA-TRN-NO
081530*        MOVE 323 TO WA-OUTPUT-MSG-LENGTH
081540         MOVE 328 TO WA-OUTPUT-MSG-LENGTH                               
081550         GO TO D090-SEND-SCREEN.
081560     IF  STRT-AREA-TRN-NO = 17052
081570         MOVE 17002 TO STRT-AREA-TRN-NO
081580         MOVE 177 TO WA-OUTPUT-MSG-LENGTH
081590         GO TO D090-SEND-SCREEN.
081600     IF  STRT-AREA-TRN-NO = 17053
081610         MOVE 17003 TO STRT-AREA-TRN-NO
TB0094         MOVE 624 TO WA-OUTPUT-MSG-LENGTH.
081620*        MOVE 109 TO WA-OUTPUT-MSG-LENGTH.
081630*
081640 D090-SEND-SCREEN.
081650     MOVE 6 TO STRT-AREA-IEXEC-CNTL.
081660     MOVE 998 TO WA-OUTPUT-ERR-MSG-NO.
081670     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
081680 D099-EXIT.
081690     EXIT.
081700/
081710 D100-CALL-UT2000.
081720     CALL "UT2000" USING
081740                         UT2000CA-CALL-AREA.
081750     IF UT2000CA-CALL-STATUS NOT = 0
081760         MOVE 201 TO UT0060CA-CALL-ERROR-CODE
081770         PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
081780         IF WA-MSG-ERR-FLAG = 0
081790             MOVE 201 TO WA-ERR-MSG-NO
081800         ELSE
081810             MOVE 201 TO WA-OUTPUT-ERR-MSG-NO
081820             MOVE 1 TO WA-MSG-ERR-FLAG
081830           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
081840             MOVE SPACES TO UT8500CA-INPUT-MSG
081850             STRING "BR0000:(D100) INVALID A/C TYPE OR INT CAT "
081860             UT2000CA-CALL-ACCT-TYPE " " UT2000CA-CALL-INT-CAT
081870                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
081880             CALL "UT8500" USING
081900                                 UT8500CA-AREA.
081910 D199-EXIT.
081920     EXIT.
081930/
TB0070
TB0070 D200-MAX-MIN-REPAY-VALIDATION.
TB0070
S15466     IF  NOT BORP-YOUBE
S15466     AND WA-INPUT-PARAM-TABLE(7) = 0
S15466     AND BR0000-SYSTEM-IN-NIGHT
S15466         INITIALIZE UT0086CA-AREA
S15466         MOVE 01 TO UT0086CA-CALL-CODE
S15466         CALL "UT0086" USING UT0086CA-CALL-AREA
S15466                             STARTAREA
S15466                             BORM-RECORD-AREA
S15466                             BOIS-RECORD
S15466                             BORR-PARAMS
S15466     END-IF.
TB0070     MOVE BORM-BAD-DEBT-IND  TO WA-BAD-DEBT-IND
S16105*S16201     IF  STRT-BANCSLINK
S16105     IF (STRT-BANCSLINK OR STRT-TRICKLE-TXN)
S16201     AND (STRT-AREA-TRN-NO = 11030 OR 16030)
S16201     AND WA-BAD-DEBT-IND-2 > 1
S16201         MOVE 4744 TO WA-OUTPUT-ERR-MSG-NO
S16201         MOVE 1    TO WA-MSG-ERR-FLAG
S16201         GO TO D200-EXIT
S16201     END-IF.
S16901     IF  (BORP-TIB-CONFER OR BORP-CARD-CONFER)
S16901     AND  WA-BAD-DEBT-IND-2 = 2
S16901     AND  STRT-BATCH-TXN
S16901     AND  BOIS-LAST-UNPAID-DUE-DATE < STRT-AREA-POST-DT
S16901     AND  STRT-AREA-TRN-NO = 16045
S16901          INITIALIZE UT0072CA-AREA
S16901          MOVE 12                TO UT0072CA-CALL-CODE
S16901          MOVE STRT-AREA-POST-DT TO UT0072CA-PREV-DUE-DATE
S16901          CALL "UT0072"       USING UT0072CA-CALL-AREA
S16901                                    BORM-RECORD-AREA
S16901                                    BOIS-RECORD
S16901                                    BORR-PARAMS
S16901          IF UT0072CA-RET-STATUS NOT = 0
S16901             MOVE 1                     TO WA-MSG-ERR-FLAG
S16901             MOVE UT0072CA-ERROR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
S16901             GO TO D200-EXIT
S16901          END-IF
S16901          COMPUTE WA-REPAY-AMOUNT  = WA-REPAY-AMOUNT
S16901                                   + UT0072CA-ARRS-AMT
S16901                                   + BOIS-ARREARS-ADJUSTMENT
S16901
S16901          MOVE WA-REPAY-AMOUNT    TO WA-SAVE-TXN-AMT
S16901                                     W800-CURR-AMT
S16901     END-IF.
SC4159*    IF WA-BAD-DEBT-IND > 51 OR
SC4159*       WA-BAD-DEBT-IND > 1
SC4159     IF WA-BAD-DEBT-IND-2 > 1
TB0070        GO TO D200-EXIT
TB0070     END-IF.
SC8008     IF STRT-FEP-ATM-TXN
SC8008        IF BORM-REPAY-SCHED = "B"
SC8008           MOVE 1      TO WA-MSG-ERR-FLAG
SC8008           MOVE 4751   TO  WA-OUTPUT-ERR-MSG-NO
SC8008           GO TO D200-EXIT
SC8008        END-IF
SC8008     END-IF.
SC6655     
SC6655     IF BORM-STAT = 50
SC6655*SC9640 AND BOIS-LAST-TERM-PAID >= (BORM-LOAN-TRM - BORM-REM-REPAYS)
SC8858      AND BOIS-ARREARS-CTR = 0
S17599        IF BORP-RECEIVABLE-YES
S17599        AND STRT-AREA-BATCH-TANDEM = "B"
S17599        AND (BORP-PUBLIC-CONFER-DC OR BORP-PUBLIC-CONFER-CDC)
S17599        AND NOT ((STRT-AREA-TRN-NO = 11030 OR 16030) AND
S17599                  WA-REPAY-PROMO = 'BA')
S17599            MOVE "Y" TO WA-REPAY-PRN-RECALC
S17599        END-IF
SC6655        GO TO D200-EXIT
SC6655     END-IF.
TB0070
S15871*TB0198     IF BOIS-AGREE-IND = 2 AND BORM-REPAY-SCHED = "N"
S16238*S15871     IF BOIS-AGREE-FUNC-USE AND BORM-REPAY-SCHED = "N"
S16238     IF BOIS-AGREE-IND = 2 AND BORM-REPAY-SCHED = "N"
SC3673      AND BOIS-LAST-TERM-PAID >= (BORM-LOAN-TRM - BORM-REM-REPAYS)
SC3673        AND BOIS-ARREARS-CTR  = 0
TB0198        GO TO D200-EXIT
TB0198     END-IF.
TB0198
SC1543     PERFORM D210-LOAD-PRIORITIES
SC1543        THRU D219-EXIT.
S10467*****GET EFFECTIVE RATE TODAY.                 
S10467     MOVE BORM-STORE-RATE  TO WA-INT-RATE-A    
S10467     IF WA-INPUT-PARAM-TABLE(8) NOT = 1        
S10467        MOVE STRT-AREA-POST-DT TO WA-DMY       
S10467        PERFORM H010A-GET-RATE  THRU H019A-EXIT
S10467     END-IF.                                   
S18788     IF WA-MSG-ERR-FLAG = 1
S18788     AND (WA-OUTPUT-ERR-MSG-NO = 0
S18788      OR  WA-OUTPUT-ERR-MSG-NO < 100
S18788      OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
S18788        DISPLAY "!!BR0000, AFT H010A, ERR-"
S18788                WA-OUTPUT-ERR-MSG-NO
S18788     END-IF.
SC1543
TB0070     INITIALIZE UT0075CA-CALL-PARAMETER
TB0070     MOVE 02    TO UT0075CA-CALL-CODE
TB0070     IF BOIS-LAST-ADV-PYMT-DATE > STRT-AREA-POST-DT
TB0070        MOVE BOIS-LAST-ADV-PYMT-DATE TO UT0075CA-SYS-DATE
TB0070                                        UT0075CA-EFF-DATE
TB0070     ELSE
TB0070        MOVE STRT-AREA-POST-DT       TO UT0075CA-SYS-DATE
TB0070                                        UT0075CA-EFF-DATE
SC9006        COMPUTE UT0075CA-EFF-DATE = BOIS-LAST-UNPAID-DUE-DATE
SC9006                                  - 1
tb0070     END-IF.
S11977     MOVE BOIS-LAST-ADV-PYMT-DATE  TO UT0020-BINARY-DATE.
S11977     MOVE 1                        TO UT0020-FUNCTION
S11977     CALL "UT0020"              USING UT0020-FUNCTION
S11977                                      UT0020-DATE-AREA
S11977                                      UT0020-BINARY-DATE.
S11977     MOVE UT0020-DATE-DDMMCCYY TO WA-LAST-ADV-PYMT-DATE.
S11977     IF  BOIS-LAST-ADV-PYMT-DATE  =  BOIS-PREV-DUE-DATE
S11977     AND BOIS-LAST-ADV-PYMT-DATE  >  STRT-AREA-POST-DT
S11977     AND WA-LAST-ADV-PYMT-DD  NOT =  BORM-REPAY-DAY
S11977         COMPUTE UT0075CA-EFF-DATE   =  BOIS-NEXT-DUE-DATE - 1
S11977     END-IF.
SC1227*    ADD BORM-INT-RATE, BORM-RT-INCR GIVING UT0075CA-INT-RATE.
SC1227     MOVE BORM-STORE-RATE                TO UT0075CA-INT-RATE.
S10467     MOVE WA-INT-RATE-A      TO UT0075CA-INT-RATE
TB0070     MOVE UT0290CA-CURR-DECS TO UT0075CA-CURR-DECS.
TB0070     IF BORM-REPAY-SCHED = SPACE
TB0070        MOVE BORP-REPAY-SCHED TO UT0075CA-REPAY-SCHED
TB0070     ELSE
TB0070        MOVE BORM-REPAY-SCHED TO UT0075CA-REPAY-SCHED
TB0070     END-IF.
TB0070     CALL "UT0075" USING UT0075CA-CALL-AREA
TB0070                         BORM-RECORD-AREA
TB0070                         BOIS-RECORD
TB0070                         BORR-PARAMS
TB0070                         SOC-PARAMS
TB0070     IF UT0075CA-RET-STATUS <> ZERO
TB0070        MOVE 1 TO WA-MSG-ERR-FLAG
TB0070        MOVE UT0075CA-RET-ERROR-MSG TO WA-OUTPUT-ERR-MSG-NO
TB0070        GO TO D200-EXIT
Tb0070     END-IF.
TB0091     MOVE UT0075CA-NEXT-DUE-DATE TO UT0020-BINARY-DATE
TB0091     MOVE 1                      TO UT0020-FUNCTION
TB0091     CALL "UT0020" USING UT0020-FUNCTION
TB0091                                 UT0020-DATE-AREA
TB0091                                 UT0020-BINARY-DATE
TB0091     MOVE UT0020-DATE-DDMMCCYY    TO WA-TMP-PREV-DUE-DTE
TB0091
TB0091     COMPUTE WA-TMP-PREV-DTE-MM = WA-TMP-PREV-DTE-MM - 1
TB0091
TB0091     MOVE 1                      TO UT0030-FUNCTION
TB0091     MOVE WA-TMP-PREV-DUE-DTE    TO UT0030-DATE-DDMMCCYY
TB0091     CALL "UT0030" USING  UT0030-FUNCTION
TB0091                                  UT0030-DATE-AREA
TB0091                                  UT0030-BINARY-DATE.
TB0091     MOVE UT0030-BINARY-DATE TO WA-TMP-PREV-DUE-DTE1.
TB0091
TB0232*    IF STRT-AREA-POST-DT < UT0075CA-NEXT-DUE-DATE
TB0232     IF BOIS-LAST-TERM-PAID >= (BORM-LOAN-TRM - BORM-REM-REPAYS)
TB0091        AND BOIS-ARREARS-CTR  = 0
TB0070**      MOVE 03  TO UT0075CA-CALL-CODE
SC6442        MOVE 02  TO UT0075CA-CALL-CODE
SC4932        IF   BORM-REPAY-SCHED = 'F'
SC4932             MOVE BORM-DUE-AMT    TO UT0075CA-CALC-EQUAL-REPAY
SC4932        ELSE
SC4932          IF BORM-REPAY-SCHED = 'G'
SC4932             MOVE BORM-LOAN-REPAY TO UT0075CA-CALC-EQUAL-PRIN
SC4932          END-IF
SC4932        END-IF
SC4932
TB0070        CALL "UT0075" USING UT0075CA-CALL-AREA
TB0070                            BORM-RECORD-AREA
TB0070                            BOIS-RECORD
TB0070                            BORR-PARAMS
TB0070                            SOC-PARAMS
TB0070        IF UT0075CA-RET-STATUS <> ZERO
TB0070           MOVE 1 TO WA-MSG-ERR-FLAG
TB0070           MOVE UT0075CA-RET-ERROR-MSG TO WA-OUTPUT-ERR-MSG-NO
TB0070           GO TO D200-EXIT
Tb0070        END-IF
TB0070*S11634 MOVE UT0075CA-REPAY-AMT TO WA-NEW-DUE-AMT
S11634        IF (NOT BORP-YOUBE)
S11634            AND BORP-FINE-METH    =  99
S11634            AND BORP-FINE-CONDT   =  99
S11634            MOVE BORM-DUE-AMT TO WA-NEW-DUE-AMT
S11634            COMPUTE UT0075CA-PRINCIPAL-DUE =
S11634                    WA-NEW-DUE-AMT - UT0075CA-INTEREST-DUE
S11634        ELSE
S18597*S11634     MOVE UT0075CA-REPAY-AMT TO WA-NEW-DUE-AMT
S18597            COMPUTE WA-NEW-DUE-AMT = UT0075CA-INTEREST-DUE
S18597                                   + UT0075CA-PRINCIPAL-DUE
S11634        END-IF
SC1742
SC1742*SC9640 IF BORM-REM-REPAYS = 1
SC9640        IF UT0075CA-NEXT-INT-DATE = BOIS-MATURITY-DATE
SC1742         AND BORM-REPAY-SCHED = "B"
SC1742         AND BORP-COMML
SC2459*SC9514  AND WA-INPUT-AMT = UT0075CA-INTEREST-DUE
SC1742           MOVE UT0075CA-INTEREST-DUE    TO WA-NEW-DUE-AMT
SC1742        END-IF
SC1742
S10332        IF   BORM-LOAN-BAL     = 0
S10332         AND BORM-DUE-AMT      = 0
S10332         AND BOIS-INTEREST-DUE > 0
S10332             MOVE BOIS-INTEREST-DUE TO WA-NEW-DUE-AMT
S10332        END-IF
S10830
S10830        IF BORM-LOAN-BAL      = 0 AND
S10830           BORM-DUE-AMT       = 0 AND
S10830           BOIS-INTEREST-DUE  = 0 AND
S10830           UT0075CA-REPAY-AMT = 0 AND
S10830           UT0075CA-INTEREST-DUE > 0
S10830           MOVE UT0075CA-INTEREST-DUE    TO WA-NEW-DUE-AMT
S10830        END-IF
S10830
SC1543*
SC1543*       PERFORM VARYING WA-BOIS-SUB
SC1543*          FROM 1 BY 1 UNTIL WA-BOIS-SUB > 15
SC1543*            OR WA-MSG-ERR-FLAG NOT = 0
SC1543*          IF BOIS-BUCKET-CDE (WA-BOIS-SUB) NOT = "I"
SC1543*            AND "P" AND "A"
SC1543*             MOVE BOIS-BUCKET-CDE (WA-BOIS-SUB) TO WA-BUCKET-CDE
SC1543*             PERFORM D220-CHECK-PRIORITY
SC1543*                THRU D229-EXIT
SC1543*
SC1543*             IF NOT WA-PRIORITIZED
SC1543*              AND BOIS-BUCKET-DUE (WA-BOIS-SUB) > 0
SC1543*                MOVE 3387 TO WA-OUTPUT-ERR-MSG-NO
SC1543*                MOVE 1   TO WA-MSG-ERR-FLAG
SC1543*             END-IF
SC1543*          END-IF
SC1543*       END-PERFORM
SC1543*
SC1543*       IF WA-MSG-ERR-FLAG NOT = 0
SC1543*          GO TO D200-EXIT
SC1543*       END-IF
SC1543*
SC3737        MOVE 0                        TO WA-DEF-AMORT-AMT
SC2439        IF BOIS-DEF-BUCKET-AMT > 0 AND
SC2439         UT0075CA-NEXT-INT-DATE > BOIS-DEF-INT-END-DTE
SC2439           COMPUTE WA-DEF-AMORT-AMT =
SC2439                   BOIS-DEF-TOT-AMT / BOIS-DEF-AMORT-TERM
SC2439           MOVE WA-DEF-AMORT-AMT      TO WA-WORK-INT
SC2439           PERFORM U000-CHECK-ZERO
SC2439              THRU U009-EXIT
SC2439           MOVE WA-WORK-INT           TO WA-DEF-AMORT-AMT
SC2439
SC2439           IF WA-DEF-AMORT-AMT > BOIS-DEF-BUCKET-AMT
SC2439              MOVE BOIS-DEF-BUCKET-AMT TO WA-DEF-AMORT-AMT
SC2439           END-IF
SC2439
SC2439           ADD  WA-DEF-AMORT-AMT      TO WA-NEW-DUE-AMT
SC2439        END-IF
SC2439
SC3737        COMPUTE WA-INT-DUE       = UT0075CA-INTEREST-DUE
SC3737                                 + WA-DEF-AMORT-AMT
TB0099        IF BORP-MAX-REPAY-AMT-PC = 0
TB0099           MOVE WA-NEW-DUE-AMT TO WA-WORK-MAX-AMT
TB0099        ELSE
TB0070           COMPUTE WA-WORK-MAX-AMT ROUNDED =
SC3737**           (WA-NEW-DUE-AMT + BOIS-LEGAL-FEE1-DUE) *
SC3737**                 BORP-MAX-REPAY-AMT-PC
SC3737              WA-NEW-DUE-AMT * BORP-MAX-REPAY-AMT-PC
TB0099        END-IF
TB0099
TB0099        IF BORP-MIN-REPAY-AMT-PC = 0
TB0099           MOVE WA-NEW-DUE-AMT TO WA-WORK-MIN-AMT
TB0099        ELSE
TB0070           COMPUTE WA-WORK-MIN-AMT ROUNDED =
SC3737**           (WA-NEW-DUE-AMT + BOIS-LEGAL-FEE1-DUE) *
SC3737**                BORP-MIN-REPAY-AMT-PC
SC3737              WA-NEW-DUE-AMT * BORP-MIN-REPAY-AMT-PC
TB0099        END-IF
TB0099
TB0099*        COMPUTE WA-WORK-MAX-AMT ROUNDED =
TB0099*             WA-NEW-DUE-AMT * BORP-MAX-REPAY-AMT-PC
TB0099*        COMPUTE WA-WORK-MIN-AMT ROUNDED =
TB0099*             WA-NEW-DUE-AMT * BORP-MIN-REPAY-AMT-PC
TB0223**      MOVE 0                          TO WA-DEF-BILL-DUE-AMT
TB0223**
TB0223**      IF UT0075CA-NEXT-INT-DATE > BOIS-DEF-INT-END-DTE
TB0223**         ADD UT0075CA-INTEREST-DUE    TO WA-DEF-BILL-DUE-AMT
TB0223**      END-IF
TB0223**
TB0223**      IF UT0075CA-NEXT-DUE-DATE > BOIS-DEF-PRIN-END-DTE
TB0223**         ADD UT0075CA-PRINCIPAL-DUE   TO WA-DEF-BILL-DUE-AMT
TB0223**      END-IF
SC4472        MOVE WA-NEW-DUE-AMT             TO WA-DEF-BILL-DUE-AMT
TB0070     ELSE
TB0070        PERFORM D201-READ-BUCKETS THRU D201-EXIT
TB0069        IF  WA-MSG-ERR-FLAG = 1
TB0069            GO TO D200-EXIT
TB0069        END-IF
TB0070        PERFORM D202-PROCESS-BUCKETS THRU D202-EXIT
SC9118        MOVE WA-PRIN-DUE TO UT0075CA-PRINCIPAL-DUE
TB0069        IF  WA-MSG-ERR-FLAG = 1
TB0069            GO TO D200-EXIT
TB0069        END-IF
TB0099        IF BORP-MAX-REPAY-AMT-PC = 0
TB0099           MOVE WA-NEW-DUE-AMT TO WA-WORK-MAX-AMT
TB0099        ELSE
TB0070           COMPUTE WA-WORK-MAX-AMT ROUNDED =
SC3737**           (WA-NEW-DUE-AMT + BOIS-LEGAL-FEE1-DUE) *
SC3737**              BORP-MAX-REPAY-AMT-PC
SC3737              WA-NEW-DUE-AMT * BORP-MAX-REPAY-AMT-PC
TB0099        END-IF
TB0099
TB0099        IF BORP-MIN-REPAY-AMT-PC = 0
TB0099           MOVE WA-NEW-DUE-AMT TO WA-WORK-MIN-AMT
TB0099        ELSE
TB0070           COMPUTE WA-WORK-MIN-AMT ROUNDED =
SC3737**           (WA-NEW-DUE-AMT + BOIS-LEGAL-FEE1-DUE) *
SC3737**               BORP-MIN-REPAY-AMT-PC
SC3737              WA-NEW-DUE-AMT * BORP-MIN-REPAY-AMT-PC
TB0099        END-IF
TB0099*        COMPUTE WA-WORK-MAX-AMT ROUNDED =
TB0099*             WA-NEW-DUE-AMT * BORP-MAX-REPAY-AMT-PC
TB0099*        COMPUTE WA-WORK-MIN-AMT ROUNDED =
TB0099*             WA-NEW-DUE-AMT * BORP-MIN-REPAY-AMT-PC
TB0070        IF WA-BAD-DEBT-CURRENT
SC8290           IF BORM-REPAY-SCHED NOT = "B"
SC8783*SC8888     OR (BORM-REPAY-SCHED = "B"
SC8783*SC8888     AND BOIS-ARREARS-CTR = 1
SC8783*SC8888     AND (BOIS-LAST-TERM-PAID + 1) = BORM-LOAN-TRM)
TB0070              COMPUTE WA-INT-DUE 
SC8290                    = WA-NEW-DUE-AMT - WA-PRIN-DUE
SC8290           ELSE
SC8290              MOVE WA-NEW-DUE-AMT TO WA-INT-DUE
SC8290           END-IF
SC7038
SC7038           IF (BOIS-LAST-TERM-PAID + 1) = BORM-LOAN-TRM
SC7038            AND BOIS-ARREARS-CTR = 1
SC7038            AND (BORP-CONSMR OR BORP-CONSMR-MORT-COMBI
SC7038            OR BORP-COMML)
S17599            AND NOT BORP-PUBLIC-CONFER-DC
S17599            AND NOT BORP-PUBLIC-CONFER-CDC
SC7038              MOVE WA-INT-DUE           TO WA-WORK-MIN-AMT
SC7038           END-IF
TB0070        ELSE
TB0070           COMPUTE WA-INT-DUE = WA-LEGAL    +
TB0070                                WA-INTEREST +
TB0070                                WA-PENALTY  +
TB0070                                WA-DEF-INT
TB0070        END-IF
TB0223        MOVE WA-NEW-DUE-AMT             TO WA-DEF-BILL-DUE-AMT
TB0070     END-IF.
TB0070
S10830     IF BORM-LOAN-BAL      = 0 AND
S10830        BORP-CONSMR 
S10830        MOVE WA-NEW-DUE-AMT TO WA-WORK-MIN-AMT
S10830                               WA-WORK-MAX-AMT
S10830     END-IF
S15728*S10830     IF BORP-COMMERCIAL
S15728     IF (BORP-COMMERCIAL
S15728     OR  BORP-AUTO-ACCT-GROUP-NO = 70)
SC9514      AND BORM-REPAY-SCHED = "B"              
SC9514        MOVE WA-NEW-DUE-AMT TO WA-WORK-MIN-AMT
SC9514                               WA-WORK-MAX-AMT
SC9514     END-IF                                   
SC9514                                              
SC8479     IF NOT STRT-BATCH-TXN
SC8479        IF UT0075CA-PRINCIPAL-DUE NOT < BORM-LOAN-BAL
SC8479           AND BORM-REPAY-SCHED = "F"
SC8479*          AND WA-INPUT-AMT NOT < WA-NEW-DUE-AMT
SC9037           AND WA-INPUT-AMT > WA-NEW-DUE-AMT
S17197           AND NOT  (BORP-ALBPS)
SC8479           MOVE 171 TO WA-OUTPUT-ERR-MSG-NO
SC8479           MOVE 1   TO WA-MSG-ERR-FLAG
SC8479           GO TO D200-EXIT
SC8479        END-IF
SC8479     END-IF
SC8301* SORD REPYMNT NOT ALLOWED FOR MATURED ACCOUNT UNLESS RENEWD/EXTENDD
S12273*SC8301    IF BORM-REPAY-TYPE = 0 AND
S12273*SC8301       BORP-PRIORITY-TERM-BY-TERM AND
S12273*SC8301       STRT-AREA-TRN-NO = 16045 AND
S12273*SC8301       STRT-BATCH-TXN
SC8301*SC9330MOVE 4261 TO WA-OUTPUT-ERR-MSG-NO
S12273*SC9330       MOVE 4773 TO WA-OUTPUT-ERR-MSG-NO
S12273*SC8301       MOVE 1 TO WA-MSG-ERR-FLAG
S12273*SC8301       GO TO D200-EXIT
S12273*SC8301     END-IF.
S12078*
S12116*S12078    IF BORP-SUB-TYPE   = "A"      AND
S12116*S12078       BORM-REPAY-TYPE = 0        AND
S12116*S12078       BORP-PRIORITY-TERM-BY-TERM AND
S12116*S12078       STRT-BATCH-TXN
S12116*S12078       MOVE 4773 TO WA-OUTPUT-ERR-MSG-NO
S12116*S12078       MOVE 1 TO WA-MSG-ERR-FLAG
S12116*S12078       GO TO D200-EXIT
S12116*S12078     END-IF.
S12078*
SC4241     IF STRT-BATCH-TXN   AND
SC4241        WA-NEW-DUE-AMT > 0 AND
SC4241        STRT-AREA-TRN-NO = 16045
SC9859** FOR RENEWED MORTGAGE LOAN ACCOUNT, MUST PAY OFF THE
SC9859** REMAINING BALANCE
SC9859        IF BORP-CONSMR-MORT-COMBI AND
SC9859           BOIS-OD-ACCT-NUMBER <> 0 AND
SC9859           BORM-REPAY-SCHED = "F" AND
SC9859           BOIS-NO-OF-RENEWAL > 0
SC9859* GET LAST WORKING DAY
SC9859           MOVE WA-DMY      TO UT0020-BINARY-DATE
SC9859           MOVE 2           TO UT0020-FUNCTION
SC9859           CALL "UT0020" USING UT0020-FUNCTION
SC9859                         UT0020-DATE-AREA
SC9859                         UT0020-BINARY-DATE
SC9859           MOVE UT0020-DATE-CCYYMMDD TO
SC9859                UT0310CA-CALENDAR-IN-CCYYMMDD
SC9859           MOVE 4             TO UT0310CA-CALL-FUNC
SC9859           PERFORM B6100-FIND-WK-DAY THRU B6199-EXIT
SC9859           IF UT0030-BINARY-DATE = BORM-RENEWAL-DATE
SC9589              COMPUTE WA-REPAY-AMOUNT = BOIS-INTEREST-DUE +
SC9859                                        BORM-LOAN-BAL
SC9859              MOVE WA-REPAY-AMOUNT TO WA-SAVE-TXN-AMT
SC9859                                      W800-CURR-AMT
SC9859           ELSE
SC9859              MOVE WA-NEW-DUE-AMT TO WA-INPUT-AMT
SC9859                                     WA-REPAY-AMOUNT
SC9859                                     WA-SAVE-TXN-AMT
SC9859                                     W800-CURR-AMT
SC9859           END-IF
SC9859        ELSE
SC4241        MOVE WA-NEW-DUE-AMT TO WA-INPUT-AMT
SC4241                               WA-REPAY-AMOUNT
SC4241                               WA-SAVE-TXN-AMT
SC4241*SC9576                        W800-CURR-AMT.
SC9576                               W800-CURR-AMT
SC9330*******TRANSFER VALIDATION TO BR0023 TO DET
SC9330*******IF MIN AMT AND DEP BAL IS STILL LESS
SC9330*******THAN LOAN BAL(SC9775)
SC9576*SC9330 IF WA-REPAY-AMOUNT NOT < BORM-LOAN-BAL
SC9576*SC9330    MOVE 171 TO WA-OUTPUT-ERR-MSG-NO
SC9576*SC9330    MOVE 1 TO WA-MSG-ERR-FLAG
SC9576*SC9330    GO TO D200-EXIT
SC9576*SC9330 END-IF
SC9576     END-IF.
SC4241
S16510*S16564     IF  STRT-TRICKLE-TXN
S17676*S16510     IF  STRT-BATCH-TXN
S17676*S16564     AND WA-NEW-DUE-AMT > 0
S17676*S16564     AND WA-REPAY-PROMO    = 'DJ'
S17676*S16564         MOVE WA-NEW-DUE-AMT TO WA-INPUT-AMT
S17676*S16564                                WA-REPAY-AMOUNT
S17676*S16564                                WA-SAVE-TXN-AMT
S17676*S16564                                W800-CURR-AMT
S17676*S16564     END-IF.
S12453     IF  STRT-BATCH-TXN
S12453     AND (STRT-AREA-TRN-NO = 11030 OR 16030)
S12453     AND WA-REPAY-PROMO    = 'BA'
S16725*S12453     AND NOT BORP-RECEIVABLE-YES
S16725     AND (NOT BORP-RECEIVABLE-YES
S16725      OR  BOIS-ARREARS-CTR = 0)
S12453         MOVE 3417 TO WA-OUTPUT-ERR-MSG-NO
S12453         MOVE 1    TO WA-MSG-ERR-FLAG
S12453         GO TO D200-EXIT
S12453     END-IF.
S12453
S12384     IF  STRT-BATCH-TXN
S12384     AND WA-NEW-DUE-AMT > 0
S12384     AND (STRT-AREA-TRN-NO = 11030 OR 16030)
S12384     AND BORP-RECEIVABLE-YES
S12384     AND WA-REPAY-PROMO    = 'BA'
S12384         IF BOIS-PRE-RECEIVABLE  < WA-NEW-DUE-AMT
S12384            MOVE 266 TO WA-OUTPUT-ERR-MSG-NO
S12384            MOVE 1   TO WA-MSG-ERR-FLAG
S12384            GO TO D200-EXIT
S12384         ELSE
S12384            MOVE WA-NEW-DUE-AMT TO WA-INPUT-AMT
S12384                                   WA-REPAY-AMOUNT
S12384                                   WA-SAVE-TXN-AMT
S12384                                   W800-CURR-AMT
S17755            IF  BORP-ILOAN-R
S17755            AND BOIS-ARREARS-CTR        =  1
S17755               MOVE BOIS-PRE-RECEIVABLE TO WA-INPUT-AMT
S17755                                           WA-REPAY-AMOUNT
S17755                                           WA-SAVE-TXN-AMT
S17755                                           W800-CURR-AMT
S17755            END-IF
S12384         END-IF
S12384     END-IF.
TB0095     IF (BOIS-MATURITY-DATE < WA-DMY-1)
TB0095        AND (WA-CREDIT-REPAY-TRCODE
SC4775*       OR WA-DEBIT-REPAY-TRCODE
TB0095        OR WA-CASH-REPAY-TRCODE
SC6507        OR WA-TRF-REPAY-TRCODE
TB0095        OR WA-CHQ-REPAY-TRCODE)
SC5381        AND BOIS-ARREARS-CTR = 0               
SC5381        AND BOIS-LAST-TERM-PAID = BORM-LOAN-TRM
TB0095        GO TO D200-EXIT
TB0095     ELSE
TB0070*    IF (BORM-LOAN-BAL < WA-NEW-DUE-AMT) OR (BORM-REM-REPAYS = 1)
SC1518     COMPUTE WA-LAST-TERM = BORM-LOAN-TRM - BOIS-LAST-TERM-PAID
SC7548     IF BOIS-NEXT-DUE-DATE < BOIS-MATURITY-DATE  
SC7548     AND WA-LAST-TERM = 1  
SC7548     AND (BORM-STAT NOT = 50)  
SC7548     AND BORM-1-ADDL-BILLING  
SC7548        ADD 1 TO WA-LAST-TERM  
SC7548     END-IF.  
S17384     IF  BORM-1-ADDL-BILLING
S17384     AND BOIS-NEXT-DUE-DATE = BOIS-MATURITY-DATE
S17384     AND WA-LAST-TERM   NOT > 1
S17384          ADD 1            TO WA-LAST-TERM
S17384     END-IF.
S17384**S11634 IF WA-LAST-TERM = 0
S17384**S11634 AND ((NOT BORP-YOUBE)
S17384**S11634   AND BORP-FINE-METH  = 99
S17384**S11634   AND BORP-FINE-CONDT = 99)
S17384**S11634 AND STRT-AREA-TRN-NO <> 13031 AND 11044 AND 11048
S17384**S11634    MOVE 2866 TO WA-OUTPUT-ERR-MSG-NO
S17384**S11634    MOVE 1   TO WA-MSG-ERR-FLAG
S17384**S11634    GO TO D200-EXIT
S17384**S11634 END-IF.
SC1518     IF WA-LAST-TERM = 1
SC1740        AND STRT-AREA-TRN-NO <> 13031 AND 11044 AND 11048
SC1742        AND NOT BORP-COMML
SC2442        AND NOT STRT-BATCH-TXN
SC7038*S11634 IF (BORP-CONSMR OR BORP-CONSMR-MORT-COMBI)
SC7038*S11634  AND BORM-REPAY-SCHED = "B"
S11634        IF ((BORP-CONSMR OR BORP-CONSMR-MORT-COMBI)
S11634        AND BORM-REPAY-SCHED = "B")
S11634        OR ((NOT BORP-YOUBE)
S11634        AND BORP-FINE-METH    =  99
S11634        AND BORP-FINE-CONDT   =  99)
S17197        OR  (BORP-ALBPS)
SC7038           NEXT SENTENCE
SC7038        ELSE
TB0070        MOVE 3765 TO WA-OUTPUT-ERR-MSG-NO
TB0070        MOVE 1   TO WA-MSG-ERR-FLAG
TB0070        GO TO D200-EXIT
SC7038        END-IF
TB0070     END-IF.
SC9559
SC9559     IF WA-LAST-TERM = 1 AND
S10982*       STRT-AREA-TRN-NO = 16046 AND
S17816*S10982       (STRT-AREA-TRN-NO = 16046 OR 16049) AND
S17816       (STRT-AREA-TRN-NO = 16046 OR 16049 OR 11046) AND
S16976*SC9559        API-PRSB-FILE
S16976       (API-PRSB-FILE OR API-NRSB-FILE)
SC9559        MOVE 171  TO WA-OUTPUT-ERR-MSG-NO
SC9559        MOVE 1    TO WA-MSG-ERR-FLAG
SC9559        GO        TO D200-EXIT
SC9559     END-IF.
TB0070
TB0070     IF BOIS-MATURITY-DATE < WA-DMY-1
TB0070        IF BORM-REM-REPAYS = BORM-LOAN-TRM
TB0070           GO TO D200-EXIT
TB0070        END-IF
TB0070     END-IF.
TB0070
TB0070     IF WA-WORK-MIN-AMT > WA-INT-DUE
TB0070        NEXT SENTENCE
TB0070     ELSE
TB0070        MOVE WA-INT-DUE TO WA-WORK-MIN-AMT
TB0070     END-IF.
TB0070
TB0070     MOVE WA-INPUT-AMT TO WA-WORK-INPUT
TB0070     IF (BORM-REPAY-SCHED = "N" OR BORP-REPAY-SCHED = "N") AND
TB0070        WA-WORK-INPUT <> WA-NEW-DUE-AMT
S15871        AND (NOT BOIS-AGREE-FUNC-USE)
S15871*SC3429        AND BOIS-AGREE-IND NOT = 2
TB0070        MOVE 1468 TO WA-OUTPUT-ERR-MSG-NO
TB0070        MOVE 1   TO WA-MSG-ERR-FLAG
TB0070        GO TO D200-EXIT
TB0070     END-IF.
TB0070
TB0223**** For deferred account, payment allowed should not exceed billed
TB0223**** amount.
TB0223     IF BOIS-AGREE-IND = 1
TB0223        IF STRT-AREA-POST-DT > BOIS-DEF-INT-END-DTE
TB0223         AND STRT-AREA-POST-DT > BOIS-DEF-PRIN-END-DTE
TB0223           NEXT SENTENCE
TB0223        ELSE
TB0223*SC8507    IF UT0075CA-NEXT-INT-DATE > BOIS-DEF-INT-END-DTE
TB0223*SC8507     AND UT0075CA-NEXT-DUE-DATE > BOIS-DEF-PRIN-END-DTE
TB0223*SC8507     AND BOIS-LAST-TERM-PAID >=
TB0223*SC8507         (BORM-LOAN-TRM - BORM-REM-REPAYS)
TB0223*SC8507       NEXT SENTENCE
SC8507**PER USER REQUEST NO REPAYMENT WITHIN DEFERRED PERIOD
SC8507           IF STRT-AREA-POST-DT < BOIS-DEF-INT-END-DTE AND
SC8507              STRT-AREA-POST-DT < BOIS-DEF-PRIN-END-DTE
SC8507              MOVE 849                     TO WA-OUTPUT-ERR-MSG-NO
SC8507              MOVE 1                       TO WA-MSG-ERR-FLAG
TB0223           ELSE
TB0223              IF WA-WORK-INPUT > WA-DEF-BILL-DUE-AMT
S10597               OR WA-WORK-INPUT < (WA-INTEREST + WA-DEF-INT
S10597                                    + WA-PENALTY)          
TB0223                 MOVE 849                  TO WA-OUTPUT-ERR-MSG-NO
TB0223                 MOVE 1                    TO WA-MSG-ERR-FLAG
TB0223              END-IF
TB0223           END-IF
TB0223        END-IF
TB0223
TB0223        GO TO D200-EXIT
SC3673     ELSE
S15871*SC3673        IF BOIS-AGREE-IND = 2
S15871        IF BOIS-AGREE-FUNC-USE
SC3429**** Load BLDVNN to get Agreed installment repay       
SC3429            MOVE BOIS-LAST-UNPAID-DUE-DATE             
SC3449                               TO WA-AGREE-REPAY-DT-BIN
SC3429            PERFORM GET-NEG-AGREE-DUE                  
SC3429               THRU GET-NEG-AGREE-DUE-EXIT             
SC3429                                                       
SC3429           ADD WA-AGR-REPAY    TO WA-NEW-DUE-AMT       
SC3429                                                       
S15542           IF STRT-AREA-BATCH-TANDEM = "B"
S15542           AND STRT-AREA-TRN-NO = 16045
S15542           AND WA-NEW-DUE-AMT NOT = WA-WORK-INPUT
S15871           AND BOIS-AGREE-FUNC-USE
S15871*S15542           AND BOIS-AGREE-IND = 2
S15542           AND BORM-REPAY-SCHED = "N"
S15542               MOVE WA-NEW-DUE-AMT TO WA-INPUT-AMT
S15542                                      WA-REPAY-AMOUNT
S15542                                      WA-SAVE-TXN-AMT
S15542                                      W800-CURR-AMT
S15542               GO TO D200-EXIT
S15542           END-IF
S15542
S16238           IF BORP-MAX-REPAY-AMT-PC = 0
S16238              MOVE WA-NEW-DUE-AMT TO WA-WORK-MAX-AMT
S16238           ELSE
S16238              COMPUTE WA-WORK-MAX-AMT ROUNDED =
S16238                   WA-NEW-DUE-AMT * BORP-MAX-REPAY-AMT-PC
S16238           END-IF
S16238           IF BORP-MIN-REPAY-AMT-PC = 0
S16238              MOVE WA-NEW-DUE-AMT TO WA-WORK-MIN-AMT
S16238           ELSE
S16238              COMPUTE WA-WORK-MIN-AMT ROUNDED =
S16238                   WA-NEW-DUE-AMT * BORP-MIN-REPAY-AMT-PC
S16238           END-IF
S16238           IF  STRT-BATCH-TXN
S16238           AND WA-NEW-DUE-AMT > 0
S16238           AND (STRT-AREA-TRN-NO = 11030 OR 16030)
S16238           AND BORP-RECEIVABLE-YES
S16238           AND WA-REPAY-PROMO    = 'BA'
S16238               IF (BOIS-PRE-RECEIVABLE  < WA-NEW-DUE-AMT)
S16238                   MOVE 266 TO WA-OUTPUT-ERR-MSG-NO
S16238                   MOVE 1   TO WA-MSG-ERR-FLAG
S16238                   GO       TO D200-EXIT
S16238               ELSE
S16238                   MOVE WA-NEW-DUE-AMT TO WA-INPUT-AMT
S16238                                          WA-REPAY-AMOUNT
S16238                                          WA-SAVE-TXN-AMT
S16238                                          W800-CURR-AMT
S16238               END-IF
S16238           END-IF
S16238           MOVE WA-INPUT-AMT TO WA-WORK-INPUT
S16238           IF ( BOIS-AGREE-CONFER
S16238           AND  BORM-REPAY-SCHED = "N" )
S16238            MOVE WA-WORK-MIN-AMT TO WA-WORK-INT
S16238            PERFORM U000-CHECK-ZERO THRU U009-EXIT
S16238            MOVE WA-WORK-INT     TO WA-WORK-MIN-AMT
S16269            COMPUTE WA-WORK-INT-0 ROUNDED = WA-WORK-MIN-AMT
S16269            MOVE WA-WORK-INT-0 TO WA-WORK-MIN-AMT
S16238            IF WA-WORK-INPUT < WA-WORK-MIN-AMT
S16238              IF BORP-RECEIVABLE-YES
S16201              AND NOT ((STRT-AREA-TRN-NO = 11030 OR 16030) AND
S16201                        WA-REPAY-PROMO = 'BA')
S16238                 MOVE "Y" TO WA-REPAY-PRN-RECALC
S16238              ELSE
S16238                 MOVE 1466 TO WA-OUTPUT-ERR-MSG-NO
S16238                 MOVE 1   TO WA-MSG-ERR-FLAG
S16238              END-IF
S16238              GO TO D200-EXIT
S16238            END-IF
S16238            MOVE WA-WORK-MAX-AMT TO WA-WORK-INT
S16238            PERFORM U000-CHECK-ZERO THRU U009-EXIT
S16238            MOVE WA-WORK-INT     TO WA-WORK-MAX-AMT
S16238            COMPUTE WA-WORK-INT-0 ROUNDED = WA-WORK-MAX-AMT
S16238            MOVE WA-WORK-INT-0 TO WA-WORK-MAX-AMT
S16238            IF WA-WORK-INPUT > WA-WORK-MAX-AMT
S16238              IF BORP-RECEIVABLE-YES
S16201              AND NOT ((STRT-AREA-TRN-NO = 11030 OR 16030) AND
S16201                        WA-REPAY-PROMO = 'BA')
S16238                 MOVE "Y" TO WA-REPAY-PRN-RECALC
S16238              ELSE
S16238                 MOVE 1467 TO WA-OUTPUT-ERR-MSG-NO
S16238                 MOVE 1   TO WA-MSG-ERR-FLAG
S16238              END-IF
S16238              GO TO D200-EXIT
S16238            END-IF
S16238           END-IF
S16238*S15871           IF BORP-RECEIVABLE-YES
S16238*S15871              MOVE "Y" TO WA-REPAY-PRN-RECALC
S16238*S15871              GO       TO D200-EXIT
S16238*S15871           END-IF
SC3673           IF WA-NEW-DUE-AMT NOT = WA-WORK-INPUT
SC3673              MOVE 2802 TO WA-OUTPUT-ERR-MSG-NO
SC3673              MOVE 1 TO WA-MSG-ERR-FLAG
SC3673              GO TO D200-EXIT
SC3673           END-IF
SC3429                          
SC3429           GO TO D200-EXIT
SC3673        END-IF
TB0223     END-IF.
SC3974     IF STRT-AREA-BATCH-TANDEM = "B"
SC3974        AND STRT-AREA-TRN-NO = 16045
SC9330        MOVE ZEROES TO WA-OS-MIN-DUE-AMOUNT
SC9775                       WA-OS-INT-DUE-AMOUNT
S15149*SC3974 IF BORP-MIN-REPAY-AMT-PC = 0
S15149        IF BORP-MIN-REPAY-AMT-PC-SORD = 0
SC3974           MOVE WA-OS-REPAY-AMOUNT TO WA-OS-MIN-DUE-AMOUNT
SC3974        ELSE
SC3974           COMPUTE WA-DUE-AMT-ROUND ROUNDED =
S15149*SC3974       WA-OS-REPAY-AMOUNT * BORP-MIN-REPAY-AMT-PC
S15149              WA-OS-REPAY-AMOUNT * BORP-MIN-REPAY-AMT-PC-SORD
SC3974              MOVE WA-DUE-AMT-ROUND TO WA-OS-MIN-DUE-AMOUNT
SC3974        END-IF
SC9178        IF WA-OS-MIN-DUE-AMOUNT < WA-INT-DUE
SC9178           MOVE WA-INT-DUE TO WA-OS-MIN-DUE-AMOUNT
SC9178        END-IF
SC9775        MOVE WA-INT-DUE TO WA-OS-INT-DUE-AMOUNT
SC3974     END-IF
TB0223
SC1505*     IF BORP-LOAN-CLASS = 2 AND
S11222*SC1505      IF (BORP-LOAN-CLASS = 2 OR STRT-AREA-TRN-NO = 16045) AND
S11222     IF (BORP-LOAN-CLASS = 2 AND STRT-AREA-TRN-NO = 16045) AND
SC1171        STRT-AREA-BATCH-TANDEM = "B"
SC1171        GO TO D200-EXIT
SC1171     ELSE
SC2943**   IF BORM-REPAY-SCHED <> "N" AND "J" AND "K"
SC6997     IF BORM-REPAY-SCHED <> "N"
SC7544        MOVE WA-WORK-MIN-AMT TO WA-WORK-INT
SC7544        PERFORM U000-CHECK-ZERO
SC7544                THRU U009-EXIT
SC7544        MOVE WA-WORK-INT     TO WA-WORK-MIN-AMT
S17197        IF BORP-ALBPS
S17197           AND BORP-RECEIVABLE-YES
S17197           AND ((STRT-AREA-POST-DT < BOIS-LAST-UNPAID-DUE-DATE)
S17197               OR (WA-LAST-TERM = 1))
S17197                MOVE "Y" TO WA-REPAY-PRN-RECALC
S17197                GO TO D200-EXIT
S17197        END-IF
S17755        IF  BORP-ILOAN-R
S17755        AND BORP-RECEIVABLE-YES
S17755        AND STRT-AREA-BATCH-TANDEM <> "B"
S17755        AND BOIS-ARREARS-CTR        = 0
S17755        AND STRT-AREA-POST-DT       < BOIS-LAST-UNPAID-DUE-DATE
S17755        AND WA-WORK-INPUT           < WA-WORK-MIN-AMT
S17755            GO TO D200-EXIT
S17755        END-IF
TB0070        IF WA-WORK-INPUT < WA-WORK-MIN-AMT
S12384           IF BORP-RECEIVABLE-YES
S16201           AND NOT ((STRT-AREA-TRN-NO = 11030 OR 16030) AND
S16201                     WA-REPAY-PROMO = 'BA')
S12384              MOVE "Y" TO WA-REPAY-PRN-RECALC
S12384           ELSE
TB0070              MOVE 1466 TO WA-OUTPUT-ERR-MSG-NO
TB0070              MOVE 1   TO WA-MSG-ERR-FLAG
S12384           END-IF
TB0070           GO TO D200-EXIT
SC2943        END-IF
TB0070     END-IF.
TB0070
TB0159     IF BORP-YOUBE
TB0159        GO TO D200-EXIT
TB0159     ELSE
SC2943**      IF BORM-REPAY-SCHED <> "N" AND "J" AND "K"
SC6997        IF BORM-REPAY-SCHED <> "N"
SC7544           MOVE WA-WORK-MAX-AMT TO WA-WORK-INT
SC7544           PERFORM U000-CHECK-ZERO
SC7544                THRU U009-EXIT
SC7544           MOVE WA-WORK-INT     TO WA-WORK-MAX-AMT
S10157           COMPUTE WA-WORK-INT-0 ROUNDED = WA-WORK-MAX-AMT
S10157           MOVE WA-WORK-INT-0 TO WA-WORK-MAX-AMT
TB0070           IF WA-WORK-INPUT > WA-WORK-MAX-AMT
S12384              IF BORP-RECEIVABLE-YES
S16201              AND NOT ((STRT-AREA-TRN-NO = 11030 OR 16030) AND
S16201                        WA-REPAY-PROMO = 'BA')
S12384                 MOVE "Y" TO WA-REPAY-PRN-RECALC
S12384              ELSE
TB0070                 MOVE 1467 TO WA-OUTPUT-ERR-MSG-NO
TB0070                 MOVE 1   TO WA-MSG-ERR-FLAG
S12384              END-IF
TB0070              GO TO D200-EXIT
SC2943           END-IF
S17599           IF WA-WORK-INPUT > BORM-LOAN-BAL
S17599           AND STRT-AREA-BATCH-TANDEM = "B"
S17599           AND BORM-STORE-RATE = 0
S17599           AND BORP-RECEIVABLE-YES
S17599           AND (BORP-PUBLIC-CONFER-DC OR BORP-PUBLIC-CONFER-CDC)
S17599           AND NOT ((STRT-AREA-TRN-NO = 11030 OR 16030) AND
S17599                     WA-REPAY-PROMO = 'BA')
S17599               MOVE "Y" TO WA-REPAY-PRN-RECALC
S17599               GO TO D200-EXIT
S17599           END-IF
S17755           IF  BORP-ILOAN-R
S17755           AND BORP-RECEIVABLE-YES
S17755           AND STRT-AREA-BATCH-TANDEM <> "B"
S17755           AND BOIS-ARREARS-CTR        > 1
S17755               MOVE "Y" TO WA-REPAY-PRN-RECALC
S17755               GO TO D200-EXIT
S17755           END-IF
TB0159        END-IF
TB0070     END-IF.
TB0070
TB0070 D200-EXIT.
TB0070     EXIT.
TB0070/
TB0070 D201-READ-BUCKETS.
TB0070
TB0070*    MOVE BOIS-LAST-TERM-PAID TO UT0094CA-BASED-TERM-NO
TB0158     COMPUTE UT0094CA-BASED-TERM-NO = BOIS-LAST-TERM-PAID + 1
TB0070     MOVE ZEROES              TO UT0094CA-SEQUENCE-NO
TB0070     MOVE SPACES              TO UT0094CA-PRIORITY-CODE
TB0070     MOVE 06                  TO UT0094CA-CALL-CODE
TB0070     CALL "UT0094" USING  UT0094CA-CALL-PARAM
TB0070                             BORM-RECORD-AREA
NR2001*TB0070                             BORV-RECORD-AREA
NR2001                             BOCT-RECORD-AREA
TB0070                             BOIS-RECORD
TB0070                             BORR-PARAMS
TB0070     IF UT0094CA-RET-STATUS <> ZEROES
TB0070        MOVE 188 TO WA-OUTPUT-ERR-MSG-NO
TB0070        MOVE 1   TO WA-MSG-ERR-FLAG
TB0070        GO TO D201-EXIT
TB0070     END-IF.
TB0070
TB0070 D201-EXIT.
TB0070     EXIT.
Tb0070
TB0070 D202-PROCESS-BUCKETS.
TB0070
TB0070     MOVE ZEROES              TO WA-PRIN-DUE
TB0070                                 WA-INT-DUE
TB0070                                 WA-LEGAL
TB0070                                 WA-PENALTY
TB0070                                 WA-INTEREST
TB0070                                 WA-DEF-INT
TB0070                                 WA-NEW-DUE-AMT
TB0232                                 WA-BACK-ADJ-AMT
CIR541                                 WA-TMP-DAYS
S10736                                 WA-PRN-DAYS       
S10736                                 WA-PRN-NXT-DUE-DTE
SC2606*NQ0009                          WA-TMP-TXN-DTE
SC2606                                 WA-TMP-NXT-DUE-DTE
S10597                                 WA-INTEREST-B4-ADJ
S18365                                 WA-BASED-AMT
S19220                                 WS-BASED-RATE
TB0070     MOVE "N"                 TO WA-EOF.
TB0232
TB0232     INITIALIZE UT0076CA-AREA
TB0232     MOVE 01                  TO UT0076CA-CALL-CODE.
TB0232
TB0232     IF WA-INPUT-PARAM-TABLE (8) = 1
SC1171        AND STRT-AREA-BATCH-TANDEM NOT = "B"
TB0232        PERFORM D203-CALL-UT0076
TB0232           THRU D203-EXIT
TB0232
TB0232        IF WA-MSG-ERR-FLAG NOT = 0
TB0232           GO TO D202-EXIT
TB0232        END-IF
TB0232     END-IF.
TB0232
SC4330     SET PENALTY-NO-EXIST      TO TRUE.
TB0070     ADD 1 TO BOIS-LAST-TERM-PAID GIVING WA-TERM-CTR.
ST0152     MOVE  0                   TO WA-WITH-AMT-FLAG.
TB0070     PERFORM VARYING WA-TERM-CTR2 FROM 1 BY 1
TB0070             UNTIL WA-EOF = "Y"
TB0091             OR WA-TERM-CTR2 > 10
TB0070        IF UT0094CA-BUCV-RECORD(WA-TERM-CTR2) NOT = SPACES
TB0070           MOVE UT0094CA-BUCV-RECORD(WA-TERM-CTR2) TO
TB0070                                             WA-BUCV-AREA
TB0232
TB0232           IF WA-INPUT-PARAM-TABLE (8) = 1
TB0232              PERFORM D204-LOCATE-BACK-ADJ
TB0232                 THRU D204-EXIT
TB0232           END-IF
TB0232
TB0070           IF BUCV-TERM-NO = WA-TERM-CTR
SC1543*             IF BUCV-BUCKET-CODE NOT = "I" AND "P" AND "A"
SC1543*                MOVE BUCV-BUCKET-CODE  TO WA-BUCKET-CDE
SC1543*                PERFORM D220-CHECK-PRIORITY
SC1543*                   THRU D229-EXIT
SC1543*
SC1543*                IF NOT WA-PRIORITIZED AND
SC1543*                     (BUCV-TXN-AMT + BUCV-ADJUSTED-AMT) > 0
SC1543*                   MOVE 3387 TO WA-OUTPUT-ERR-MSG-NO
SC1543*                   MOVE 1   TO WA-MSG-ERR-FLAG
SC1543*                   GO TO D202-EXIT
SC1543*                END-IF
SC1543*             END-IF
SC1543*
ST0152              IF  (BUCV-BUCKET-CODE = "I" OR "P")
ST0152              AND (BUCV-TXN-IND = 'B' OR 'A' OR 'W')
ST0152                   SET WITH-AMOUNT TO TRUE
ST0152              END-IF
TB0070              EVALUATE (BUCV-BUCKET-CODE)
TB0070                 WHEN "P"
SC4330                    IF BUCV-TXN-BILLING
TB0232*                   MOVE BUCV-TXN-AMT TO WA-PRIN-DUE
TB0232                    COMPUTE WA-PRIN-DUE = BUCV-TXN-AMT
TB0232                                        + BUCV-ADJUSTED-AMT
TB0232                                        + WA-BACK-ADJ-AMT
S10736                       MOVE BUCV-BASED-TO-DATE TO               
S10736                                              WA-PRN-NXT-DUE-DTE
S10736                       MOVE BUCV-BASED-DAYS    TO WA-PRN-DAYS   
S18365                       MOVE BUCV-BASED-AMT     TO WA-BASED-AMT
S19220                       MOVE BUCV-BASED-RATE    TO WS-BASED-RATE
SC4330                    END-IF
TB0070                 WHEN "L"
TB0232*                   MOVE BUCV-TXN-AMT TO WA-LEGAL
TB0232                    COMPUTE WA-LEGAL    = BUCV-TXN-AMT
TB0232                                        + BUCV-ADJUSTED-AMT
TB0232                                        + WA-BACK-ADJ-AMT
TB0070                 WHEN "I"
TB0232*                   MOVE BUCV-TXN-AMT TO WA-INTEREST
SC9037                    MOVE BUCV-TXN-AMT TO WA-INT-DUE-14
TB0232                    IF BUCV-SUB-BUCKET-CODE = " "
TB0232                       COMPUTE WA-INTEREST = BUCV-TXN-AMT
TB0232                                           + BUCV-ADJUSTED-AMT
TB0232                                           + WA-BACK-ADJ-AMT
SC7587                       MOVE BUCV-TXN-AMT TO WA-INTEREST-B4-ADJ
SC2606*NQ0009                MOVE BUCV-BASED-DATE    TO WA-TMP-TXN-DTE
SC2606                       MOVE BUCV-BASED-TO-DATE TO
SC2606                                              WA-TMP-NXT-DUE-DTE
CIR541                       MOVE BUCV-BASED-DAYS    TO WA-TMP-DAYS
S19220                       MOVE BUCV-BASED-RATE    TO WS-BASED-RATE
TB0232                    ELSE
TB0232                       IF BUCV-SUB-BUCKET-CODE = "D"
S10597                          ADD  BUCV-TXN-AMT TO WA-INTEREST-B4-ADJ
TB0232                          MOVE BUCV-TXN-AMT TO WA-DEF-INT
TB0232                          COMPUTE WA-DEF-INT  = BUCV-TXN-AMT
TB0232                                              + BUCV-ADJUSTED-AMT
TB0232                                              + WA-BACK-ADJ-AMT
TB0232                       END-IF
TB0232                    END-IF
TB0070                 WHEN "A"
TB0232                   MOVE BUCV-TXN-AMT TO WA-PENALTY
TB0232                    COMPUTE WA-PENALTY  = BUCV-TXN-AMT
TB0232                                        + BUCV-ADJUSTED-AMT
TB0232                                        + WA-BACK-ADJ-AMT
SC4330                    IF BUCV-TXN-AMT     > 0
S11727                        AND BUCV-TXN-BILLING
SC4330                       SET PENALTY-EXIST TO TRUE
SC4330                    END-IF
TB0070                 WHEN "D"
TB0070                    MOVE BUCV-TXN-AMT TO WA-DEF-INT
TB0070              END-EVALUATE
TB0070              IF BUCV-TXN-BILLING
SC2437                 OR BUCV-TXN-WAIVE OR BUCV-TXN-ADJUST
TB0070                 COMPUTE WA-NEW-DUE-AMT = WA-NEW-DUE-AMT +
TB0070                                          BUCV-TXN-AMT
TB0232                                        + BUCV-ADJUSTED-AMT
TB0232                                        + WA-BACK-ADJ-AMT
SC6499                 IF  STRT-BATCH-TXN
SC6499                 AND BOIS-OFFSET-ACCT-IND = 1
SC6499**               AND BOIS-DUE-REPAY-TYPE  = 2
SC7314                 AND BOIS-DUE-REPAY-TYPE  = 1
SC6499                 AND BUCV-BUCKET-CODE     = "I"
SC6499                 AND BUCV-ADJUSTED-AMT    < 0
SC6499                     COMPUTE WA-NEW-DUE-AMT = WA-NEW-DUE-AMT
SC6499                                            - BUCV-ADJUSTED-AMT
SC6499                 END-IF
TB0070              END-IF
TB0070           ELSE
TB0070              MOVE "Y" TO WA-EOF
TB0070           END-IF
TB0070     END-PERFORM.
ST0152     IF    NOT WITH-AMOUNT
ST0152           MOVE 1                 TO  WA-MSG-ERR-FLAG
ST0152           MOVE 4784              TO  WA-OUTPUT-ERR-MSG-NO
ST0152           GO  TO                 D202-EXIT
ST0152     END-IF.
SC3295*    IF    BORP-COMML                                              SC8888
SC3295*    AND   BORM-REPAY-SCHED  = 'B'                                 SC8888
SC8888     IF    BORM-REPAY-SCHED  = 'B'
SC3295     AND   BORM-REM-REPAYS   =  0
SC3295*SC9640 AND   WA-TERM-CTR       =  BORM-LOAN-TRM
SC9640     AND  (WA-TERM-CTR       =  BORM-LOAN-TRM      
SC9640      OR  WA-TMP-NXT-DUE-DTE = BOIS-MATURITY-DATE) 
SC3295           SUBTRACT WA-PRIN-DUE FROM WA-NEW-DUE-AMT
SC3295     END-IF.
S18365     MOVE "N" TO WA-CAR-LOAN.
S18365     IF (BORM-ACT-TYPE(1:2) = 71 AND BORP-SUB-TYPE = " "
S18365     AND BORM-STORE-RATE = 0 AND BOIS-BANK-RATE > 0)
S18365         MOVE "Y" TO WA-CAR-LOAN
S18365     END-IF.
S19220     MOVE "N" TO WA-COMML-HOUSE-IND.
S19269*S19220     IF BORP-CORPORATION
S20771*S19269     IF (BORP-CORPORATION OR BORP-PB)
S20771     IF (BORP-CORPORATION OR BORP-PB OR BORP-FBOND)
S19220     AND BORM-PURPOSE-CODE-A = 43
S19220         MOVE "Y" TO WA-COMML-HOUSE-IND
S19220     END-IF.
SC2606*S10736     IF  ( WA-INTEREST + WA-DEF-INT )   <= 0
S10736     IF  (( WA-INTEREST + WA-DEF-INT )   <= 0
S18365     AND  NOT WA-CAR-LOAN-0
S19220     AND  NOT BORP-CONSMR-FIN
S19220     AND  NOT WA-COMML-HOUSE
S10736     AND  BORP-FINE-METH NOT = 14)           
SC4330**   OR  ( WA-PENALTY                   >  0 )
SC4330     OR    PENALTY-EXIST
SC2606           GO  TO              D202-EXIT.
SC2606     IF    WA-INPUT-PARAM-TABLE (8) = 1
SC2606       IF  WA-REPAY-TXN-DATE       <= WA-TMP-NXT-DUE-DTE
SC2606           GO  TO              D202-EXIT
SC2606       END-IF
SC2606     ELSE
SC2606       IF  STRT-AREA-POST-DT       <= WA-TMP-NXT-DUE-DTE
SC2606           GO  TO              D202-EXIT
SC2606       END-IF
SC2606     END-IF.
SC2606
SC2606     INITIALIZE UT0072CA-AREA.
SC2606*    COMPUTE UT0072CA-TRAN-AMT        =  WA-INTEREST
SC7587     COMPUTE UT0072CA-TRAN-AMT        =  WA-INTEREST-B4-ADJ
SC2606*S10597                               +  WA-DEF-INT.
S19220     IF WA-PRIN-DUE > 0
S19220     AND (BORP-CONSMR-FIN OR WA-COMML-HOUSE)
S19269     AND NOT BORP-PB
S20771     AND NOT BORP-FBOND
S19220        COMPUTE UT0072CA-TRAN-AMT     =  WA-PRIN-DUE
S19220     END-IF.
S19220     COMPUTE UT0072CA-INTEREST = WS-BASED-RATE.
SC9037     IF BORP-FINE-METH = 14
SC9037        COMPUTE UT0072CA-TRAN-AMT = WA-PRIN-DUE +
SC9037                                    WA-INT-DUE-14
SC9037     END-IF.
S19220*S18365     IF WA-CAR-LOAN-0 AND WA-PRN-DAYS > 0
S19220*S18365        COMPUTE UT0072CA-TRAN-AMT
S19220*S18365              = (WA-BASED-AMT * BOIS-BANK-RATE * WA-PRN-DAYS
S19220*S18365                 / 36500)
S19220*S18365     END-IF.
SC2606     MOVE 06                          TO UT0072CA-CALL-CODE.
SC2606     IF    WA-INPUT-PARAM-TABLE (8) = 1
SC7865*      MOVE  WA-REPAY-TXN-DATE        TO UT0072CA-NEXT-WORK-DATE
SC7865       MOVE WA-REPAY-TXN-DATE         TO UT0030-DATE-DDMMCCYY
SC7865       PERFORM X610-UT0030-PARA     THRU X619-EXIT
SC7865       MOVE UT0030-BINARY-DATE        TO UT0072CA-NEXT-WORK-DATE
SC2606     ELSE
SC2606       MOVE  STRT-AREA-POST-DT        TO UT0072CA-NEXT-WORK-DATE.
SC2606     MOVE WA-TMP-NXT-DUE-DTE          TO UT0072CA-PREV-WORK-DATE.
SC2606**   COMPUTE UT0072CA-DAYS = WA-TMP-NXT-DUE-DTE - WA-TMP-TXN-DTE.
CIR541     MOVE WA-TMP-DAYS                 TO UT0072CA-DAYS.
S10736                                                                
S10736     IF UT0072CA-PREV-WORK-DATE = 0 AND WA-PRN-NXT-DUE-DTE > 0  
S10736        MOVE WA-PRN-NXT-DUE-DTE       TO UT0072CA-PREV-WORK-DATE
S10736     END-IF.                                                    
S10736                                                                
S10736     IF UT0072CA-DAYS = 0 AND WA-PRN-DAYS > 0                   
S10736        MOVE WA-PRN-DAYS              TO UT0072CA-DAYS          
S10736     END-IF.                                                    
SC2606
SC2606     CALL "UT0072"  USING UT0072CA-CALL-AREA
SC2606                          BORM-RECORD-AREA
SC2606                          BOIS-RECORD
SC2606                          BORR-PARAMS.
SC2606
SC2606     IF UT0072CA-RET-STATUS = 0
SC2606        ADD  UT0072CA-ARRS-AMT        TO WA-NEW-DUE-AMT
SC7865        ADD  UT0072CA-ARRS-AMT        TO WA-PENALTY
SC6040        ADD  BOIS-ARREARS-ADJUSTMENT  TO WA-NEW-DUE-AMT
SC8777        ADD  BOIS-ARREARS-ADJUSTMENT  TO WA-PENALTY
SC2606     ELSE
SC2606        MOVE 1                        TO  WA-MSG-ERR-FLAG
SC2606        MOVE UT0072CA-ERROR-MSG-NO    TO  WA-OUTPUT-ERR-MSG-NO
SC2606     END-IF.
TB0070
TB0070 D202-EXIT.
TB0070     EXIT.
TB0070
TB0232/
TB0232 D203-CALL-UT0076.
TB0232     MOVE WA-REPAY-TXN-DATE      TO UT0030-DATE-DDMMCCYY.
TB0232     CALL "UT0030" USING  UT0030-FUNCTION
TB0232                                  UT0030-DATE-AREA
TB0232                                  UT0030-BINARY-DATE.
TB0232     MOVE UT0030-BINARY-DATE     TO UT0076CA-TRAN-DATE
TB0232     MOVE "E"                    TO UT0076CA-CALL-TYPE
TB0232
TB0232     CALL "UT0076" USING UT0076CA-CALL-PARAM
TB0232                          BORM-RECORD-AREA
NR2001*TB0232                          BORV-RECORD-AREA
NR2001                          BOCT-RECORD-AREA
TB0232                          BOIS-RECORD
TB0232                          BORR-PARAMS.
TB0232
TB0232     IF UT0076CA-RET-STATUS NOT = 0
TB0232        MOVE 1                        TO  WA-MSG-ERR-FLAG
TB0232        MOVE UT0076CA-ERROR-MSG-NO    TO  WA-OUTPUT-ERR-MSG-NO
TB0232     END-IF.
TB0232
TB0232 D203-EXIT.
TB0232     EXIT.
TB0232/
TB0232 D204-LOCATE-BACK-ADJ.
TB0232     MOVE 0                           TO WA-BACK-ADJ-AMT
TB0232                                         WA-BACK-ADJ-SUB.
TB0232     MOVE "N"                         TO WA-LOC-END-FLAG.
TB0232
TB0232     PERFORM D205-LOC-BACK
TB0232        THRU D205-EXIT
TB0232     VARYING WA-BACK-ADJ-SUB
TB0232        FROM 1 BY 1
TB0232       UNTIL WA-BACK-ADJ-SUB  > UT0076CA-BUCV-ARRAY-COUNT
TB0232          OR WA-LOC-END.
TB0232
TB0232 D204-EXIT.
TB0232     EXIT.
TB0232/
TB0232 D205-LOC-BACK.
TB0232     IF BUCV-CYCLE-NO = UT0076CA-BUCV-CYCLE-NO (WA-BACK-ADJ-SUB)
TB0232      AND BUCV-TERM-NO = UT0076CA-BUCV-TERM-NO (WA-BACK-ADJ-SUB)
TB0232      AND BUCV-BUCKET-CODE =
TB0232                       UT0076CA-BUCV-BUCKET-CODE (WA-BACK-ADJ-SUB)
TB0232      AND BUCV-SEQUENCE-NO =
TB0232                       UT0076CA-BUCV-SEQUENCE-NO (WA-BACK-ADJ-SUB)
TB0232        MOVE UT0076CA-BUCV-BACK-ADJ-AMT (WA-BACK-ADJ-SUB) TO
TB0232                                       WA-BACK-ADJ-AMT
TB0232        MOVE "Y"                    TO WA-LOC-END-FLAG
TB0232     END-IF.
TB0232
TB0232 D205-EXIT.
TB0232     EXIT.
TB0232/
SC1543 D210-LOAD-PRIORITIES.
SC1543     INITIALIZE UTHISTCA-CALL-AREA
SC1543     MOVE 02 TO UTHISTCA-CALL-CODE
SC1543     MOVE "BOR"               TO UTHISTCA-SYSTEM
SC1543     MOVE BORM-SOC-NO         TO UTHISTCA-SOC-NO
SC1543     MOVE BORM-ACT-TYPE       TO UTHISTCA-ACCT-TYPE
SC1543     MOVE BORM-CAT            TO UTHISTCA-INT-CAT
SC1543     MOVE STRT-AREA-POST-DT   TO UTHISTCA-EFFECTIVE-DATE
SC1543
SC1543     CALL "UTHIST" USING UTHISTCA-CALL-PARAM.
SC1543
SC1543     IF UTHISTRA-RET-STATUS <> 0
SC1543        MOVE 1 TO WA-MSG-ERR-FLAG
SC1543        MOVE UTHISTRA-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
SC1543        SET UT8500CA-NORMAL-DISPLAY TO TRUE
SC1543        MOVE SPACES TO UT8500CA-INPUT-MSG
SC1543        STRING "BR0000:(D210) ERROR CALLING UTHIST"
SC1543               ", STATUS="    UTHISTRA-RET-STATUS
SC1543               ", CALL CODE=" UTHISTCA-CALL-CODE
SC1543               ", ACCT TYPE=" BORM-ACT-TYPE
SC1543               ", INT CAT="   BORM-CAT
SC1543               ", CODE="      UTHISTCA-CALL-PRIO-CD
SC1543               ", PRIORITY="  UTHISTCA-CALL-PRIO-NO
SC1543        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC1543        CALL "UT8500" USING    UT8500CA-AREA
SC1543     END-IF.
SC1543
SC1543 D219-EXIT.
SC1543     EXIT.
SC1543/
SC1543 D220-CHECK-PRIORITY.
SC1543     MOVE "N"                        TO WA-PRIORITIZED-FLAG.
SC1543
SC1543     PERFORM VARYING WA-UTHIST-SUB
SC1543        FROM 1 BY 1
SC1543       UNTIL WA-PRIORITIZED-FLAG = "Y"
SC1543          OR WA-UTHIST-SUB > 15
SC1543             IF UTHISTRA-PRIO-CDE(WA-UTHIST-SUB) = WA-BUCKET-CDE
SC1543                IF UTHISTRA-PRIO-NUM(WA-UTHIST-SUB) > 0
SC1543                   MOVE "Y"         TO WA-PRIORITIZED-FLAG
SC1543                END-IF
SC1543             END-IF
SC1543     END-PERFORM.
SC1543
SC1543 D229-EXIT.
SC1543     EXIT.
SC1543/
ST0055 D250-READ-BUCKETS.
             INITIALIZE WA-BUCV-AREA
             MOVE BORM-SOC-NO         TO BUCV-INST-NO
             MOVE BORM-MEMB-CUST-AC   TO BUCV-ACCT-NO
             MOVE BOIS-CYCLE-NO       TO BUCV-CYCLE-NO
             MOVE 0          TO DBIO-CALL-REFER-AREA
             MOVE 78         TO DBIO-CALL-FUNC
             MOVE "FC"       TO DBIO-CALL-CODE-B
             MOVE BUCV-KEY   TO DBIO-CALL-KEY-AREA
             MOVE "BUCV"     TO DBIO-CALL-SYS-AREA
             MOVE SPACES     TO WS-SAVE-REFER
             MOVE "N"        TO BUCV-RECORD-CODE
                                WS-BUCV-RECORD-FOUND
SC5681       MOVE ZEROS      TO VCHR077-PRINCIPAL-AMT
             PERFORM UNTIL BUCV-RECORD-NO-MORE
                PERFORM S800-BUCV-SEARCH THRU S800-EXIT
                IF WS-BUCV-RECORD-FOUND = "Y"
                   IF BUCV-INST-NO     = BORM-SOC-NO       AND
                      BUCV-ACCT-NO     = BORM-MEMB-CUST-AC AND
                      BUCV-CYCLE-NO    = BOIS-CYCLE-NO
                      IF (BUCV-TXN-IND = "C"  AND
                         BUCV-COLLECTED-AMT > 0)
                        AND (BUCV-POSTING-DATE = STRT-AREA-POST-DT)
SC5678                   MOVE BUCV-BASED-DATE TO
SC5678*                  MOVE UT0094CA-BASED-DATE TO
                              UT0020-BINARY-DATE
                         MOVE 1 TO UT0020-FUNCTION
                         PERFORM X600-UT0020-PARA THRU X609-EXIT
                         MOVE UT0020-DATE-DDMMCCYY TO
                              VCHR077-STRT-DATE
SC5678                   MOVE BUCV-BASED-TO-DATE TO
SC5678*                  MOVE UT0094CA-BASED-TO-DATE TO
                              UT0020-BINARY-DATE
                         MOVE 1 TO UT0020-FUNCTION
                         PERFORM X600-UT0020-PARA THRU X609-EXIT
                         MOVE UT0020-DATE-DDMMCCYY TO
                              VCHR077-END-DATE
S11487                   IF BORP-INT-RATE-PRINT = 'N'
S11487                      MOVE 0  TO VCHR077-RATE
S11487                   ELSE
S11487                      MOVE BUCV-BASED-RATE      TO VCHR077-RATE
S11487                   END-IF
S11487*SC7749                   MOVE BUCV-BASED-RATE      TO VCHR077-RATE
SC6355                   MOVE BUCV-TERM-NO         TO  WA-TERM          
                         EVALUATE BUCV-BUCKET-CODE
                         WHEN "A"
                           ADD BUCV-COLLECTED-AMT TO
                               VCHR077-PENALTY
                           MULTIPLY -1 BY VCHR077-PENALTY
SC5678                     MOVE BUCV-BASED-DAYS   TO   VCHR077-DUE-DAYS
                         WHEN "I"
SC5681                      MOVE BUCV-COLLECTED-AMT TO
SC5681*                     ADD BUCV-COLLECTED-AMT TO
                                VCHR077-INT-AMT
                            MULTIPLY -1 BY VCHR077-INT-AMT
SC5678                      MOVE BUCV-BASED-DAYS   TO   VCHR077-DAYS
                         WHEN "L"
                            ADD BUCV-COLLECTED-AMT TO
                                VCHR077-LEGAL-FEE1-DUE
                            MULTIPLY -1 BY VCHR077-LEGAL-FEE1-DUE
                         WHEN "M"
                           ADD BUCV-COLLECTED-AMT TO VCHR077-MISC-FEE1
                            MULTIPLY -1 BY VCHR077-MISC-FEE1
                         WHEN "X"
                            ADD BUCV-COLLECTED-AMT TO
                                VCHR077-LEGAL-FEE2-DUE
                            MULTIPLY -1 BY VCHR077-LEGAL-FEE2-DUE
                         WHEN "T"
                            ADD BUCV-COLLECTED-AMT TO
                                VCHR077-TEMP-PYMNT-DR
                            MULTIPLY -1 BY VCHR077-TEMP-PYMNT-DR
                         WHEN "P"
SC5678*SC7050              MOVE BUCV-COLLECTED-AMT TO
SC5678*SC7050              ADD BUCV-COLLECTED-AMT TO
SC7050*                        VCHR077-PRINCIPAL-AMT
SC7050*                    MULTIPLY -1 BY VCHR077-PRINCIPAL-AMT
SC7050                     ADD BUCV-COLLECTED-AMT TO
                               VCHR077-PRINCIPAL-AMT
                         WHEN "R"
                           ADD BUCV-COLLECTED-AMT TO
                               VCHR077-REV-RECEIVABLE
                           MULTIPLY -1 BY VCHR077-REV-RECEIVABLE
                         WHEN "Z"
                           ADD BUCV-COLLECTED-AMT TO
                               VCHR077-MISC-FEE2
                           MULTIPLY -1 BY VCHR077-MISC-FEE2
                         WHEN OTHER
                           CONTINUE
                         END-EVALUATE
                      END-IF
                   ELSE
                      MOVE "Y" TO BUCV-RECORD-CODE
                END-IF
             END-PERFORM.
SC7050       IF  VCHR077-PRINCIPAL-AMT NOT = 0
SC7050           MULTIPLY -1 BY VCHR077-PRINCIPAL-AMT
SC7050       END-IF.
       D250-EXIT.
            EXIT.
       S800-BUCV-SEARCH.
           MOVE "N"           TO WS-BUCV-RECORD-FOUND.
           MOVE WS-SAVE-REFER TO DBIO-CALL-SAVE-REFER.
           CALL "DBIO" USING
                       DBIO-CALL-PARAM
                       DBIO-CALL-SYS-AREA
                       DBIO-CALL-KEY-AREA
                       DBIO-CALL-STATUS
                       WA-BUCV-AREA
                       DBIO-CALL-REFER-AREA
                       DBIO-CALL-CODE-B.
           DISPLAY 'S800-BUCV-SEARCH - ' DBIO-CALL-KEY-AREA
           IF DBIO-CALL-SAVE-REFER = "END."
              DISPLAY 'END REC BUCV - ' DBIO-CALL-KEY-AREA
              MOVE "N" TO WS-BUCV-RECORD-FOUND
              MOVE "Y" TO BUCV-RECORD-CODE
           END-IF.
           IF DBIO-CALL-STATUS = "****"
              MOVE "Y"                  TO WS-BUCV-RECORD-FOUND
              MOVE DBIO-CALL-SAVE-REFER TO WS-SAVE-REFER
           ELSE
              MOVE "N" TO WS-BUCV-RECORD-FOUND
           END-IF.
       S800-EXIT.
           EXIT.
ST0055 D300-POPULATE-BUCKETS.
SC6449     MOVE SPACE  TO VCHR-FRM077.
ST0055     PERFORM D310-READ-BUCKETS THRU D319-EXIT.
ST0055*    PERFORM D250-READ-BUCKETS THRU D250-EXIT.
       D309-EXIT.
           EXIT.
ST0055 D310-READ-BUCKETS.
ST0055
ST0055     MOVE "N" TO BUCV-RECORD-CODE.
ST0055     PERFORM VARYING WA-INDEX FROM 1 BY 1
ST0055       UNTIL WA-INDEX > 10 OR BUCV-RECORD-NO-MORE
ST0055             IF UT0094CA-BUCV-RECORD (WA-INDEX) = SPACES
ST0055                SET BUCV-RECORD-NO-MORE TO TRUE
ST0055             ELSE
ST0055                MOVE UT0094CA-BUCV-RECORD (WA-INDEX)
ST0055                     TO WA-BUCV-AREA
ST0055                PERFORM D320-PROCESS-BUCV-AREA THRU D329-EXIT
ST0055             END-IF
ST0055     END-PERFORM.
SC7050     IF  VCHR077-PRINCIPAL-AMT NOT = 0
SC7050         MULTIPLY -1 BY VCHR077-PRINCIPAL-AMT
SC7050     END-IF.
SC9292     IF BORM-STAT = 50
SC9292        AND UT0094CA-MATURED-SWITCH = 1
SC9292        MOVE UT0094CA-PEN-AFT-MATURITY TO VCHR077-PENALTY
SC9292     END-IF.
SC7219     IF  VCHR077-PENALTY NOT = 0
SC7219         MULTIPLY -1 BY VCHR077-PENALTY
SC7219     END-IF.
SC7219     IF  VCHR077-INT-AMT NOT = 0
SC7219         MULTIPLY -1 BY VCHR077-INT-AMT
SC7219     END-IF.
ST0055
ST0055 D319-EXIT.
ST0055     EXIT.
ST0055 D320-PROCESS-BUCV-AREA.
ST0055     IF NOT ((BUCV-TXN-IND = "C")
              AND (BUCV-COLLECTED-AMT > 0)
              AND (BUCV-POSTING-DATE = STRT-AREA-POST-DT))
ST0055        GO TO D329-EXIT.
SC5678     MOVE BUCV-BASED-DATE TO UT0020-BINARY-DATE.
           MOVE 1                     TO UT0020-FUNCTION.
           PERFORM X600-UT0020-PARA THRU X609-EXIT.
           MOVE UT0020-DATE-DDMMCCYY  TO VCHR077-STRT-DATE.
SC5678     MOVE BUCV-BASED-TO-DATE    TO UT0020-BINARY-DATE.
           MOVE 1                     TO UT0020-FUNCTION.
           PERFORM X600-UT0020-PARA THRU X609-EXIT.
           MOVE UT0020-DATE-DDMMCCYY  TO VCHR077-END-DATE.
SC6355     MOVE BUCV-TERM-NO          TO WA-TERM.
S11487     IF   BORP-INT-RATE-PRINT = 'N'
S11487        MOVE 0  TO VCHR077-RATE
S11487     ELSE
S11487        MOVE BUCV-BASED-RATE       TO VCHR077-RATE
S11487     END-IF.
S11487*SC7697     MOVE BUCV-BASED-RATE       TO VCHR077-RATE.
           EVALUATE BUCV-BUCKET-CODE
              WHEN "A"
                   ADD BUCV-COLLECTED-AMT  TO VCHR077-PENALTY
SC7219*            MULTIPLY -1 BY VCHR077-PENALTY
SC7219             IF BUCV-SUB-BUCKET-CODE = "A"
SC5678             MOVE BUCV-BASED-DAYS    TO VCHR077-DUE-DAYS
SC7219             END-IF
              WHEN "I"
SC7219             ADD  BUCV-COLLECTED-AMT TO VCHR077-INT-AMT
SC7219*SC5681      MOVE BUCV-COLLECTED-AMT TO VCHR077-INT-AMT
SC7219*            MULTIPLY -1 BY VCHR077-INT-AMT
SC7219             IF BUCV-SUB-BUCKET-CODE <> "R"
SC5678             MOVE BUCV-BASED-DAYS    TO VCHR077-DAYS
SC7219             END-IF
              WHEN "L"
                   ADD BUCV-COLLECTED-AMT  TO VCHR077-LEGAL-FEE1-DUE
                   MULTIPLY -1 BY VCHR077-LEGAL-FEE1-DUE
              WHEN "M"
                    ADD BUCV-COLLECTED-AMT TO VCHR077-MISC-FEE1
                    MULTIPLY -1 BY VCHR077-MISC-FEE1
              WHEN "X"
                    ADD BUCV-COLLECTED-AMT TO VCHR077-LEGAL-FEE2-DUE
                    MULTIPLY -1 BY VCHR077-LEGAL-FEE2-DUE
              WHEN "T"
                    ADD BUCV-COLLECTED-AMT TO VCHR077-TEMP-PYMNT-DR
                    MULTIPLY -1 BY VCHR077-TEMP-PYMNT-DR
              WHEN "P"
SC7050              ADD BUCV-COLLECTED-AMT TO VCHR077-PRINCIPAL-AMT
              WHEN "R"
                    ADD BUCV-COLLECTED-AMT TO VCHR077-REV-RECEIVABLE
                    MULTIPLY -1 BY VCHR077-REV-RECEIVABLE
              WHEN "Z"
                    ADD BUCV-COLLECTED-AMT TO VCHR077-MISC-FEE2
                    MULTIPLY -1 BY VCHR077-MISC-FEE2
              WHEN OTHER
                    CONTINUE
           END-EVALUATE.
ST0055 D329-EXIT.
ST0055     EXIT.
ST0055 D400-POPULATE-FORM77.
SC5678     MOVE WA-DEP-ACCT-NO         TO VCHR077-TRF-ACCT-NO.
SC5678     MOVE NARRATIVE-11045   TO VCHR077-DESC. 
           MOVE WA-REPAY-INPUT-ACCT-NO TO VCHR077-ACCT-NO.
           MOVE SPACES TO VCHR077-ACCT-NAME.
           MOVE WA-REPAY-AMOUNT TO VCHR077-TXN-AMT.
SC7399     IF STRT-AREA-TRN-NO = 13031
SC7399        MOVE WA-REPAY-AMOUNT TO VCHR077-PRINCIPAL-AMT
SC7399     END-IF.
           MOVE WA-PRINCIPAL-AMT1 TO VCHR077-PRINCIPAL-AMT1.
           MOVE BORM-LOAN-BAL TO VCHR077-PRINCIPAL-AMT2.
SC7697*    MOVE BORM-STORE-RATE TO VCHR077-RATE.
SC6355*    COMPUTE WA-TERM = BORM-LOAN-TRM - BORM-REM-REPAYS.          
           MOVE WA-TERM TO VCHR077-TERM.
           MOVE SPACES TO VCHR077-TRF-NAME.
SC7033     IF STRT-AREA-TRN-NO = (11010 OR 11045 OR 11046 OR 16045
S18344        OR 16046 OR 11049 OR 16049)
S18344        AND PROD-CAR-SME
S18344*S10982 OR 16046 OR 11049 OR 16049) AND BORP-FINE-METH = 14
S10982*       OR 16046) AND BORP-FINE-METH = 14
SC7033        IF BORP-INT-RATE-PRINT = "N"
SC7033           MOVE 0 TO VCHR077-RATE
SC7033        END-IF
SC7033     END-IF.
       D409-EXIT.
           EXIT.
NR2001*SC7033 D450-POPUPATE-BORV.
NR2001 D450-POPUPATE-BOCT.
SC9645 IF STRT-AREA-TRN-NO = 11045 OR 16045 OR 16046 OR 11046 OR 
S10982                       11049 OR 16049
SC7033        MOVE WA-DEP-ACCT-NO TO VCHR077-TRF-ACCT-NO
SC7033                               UT0500CA-CUSM-NO
SC7033        MOVE 1 TO UT0500CA-CALL-CODE
SC7033        PERFORM V500-CALL-UT0500 THRU V599-EXIT
SC7033        IF UT0500RA-CALL-STATUS NOT = 0
SC7033           MOVE SPACES TO VCHR075-TRF-ACCT-NME
SC7033        ELSE
SC7033           MOVE UT0500RA-FULL-NAME TO VCHR077-TRF-NAME
SC7033        END-IF
SC7033        MOVE NARRATIVE-11045   TO VCHR077-DESC
SC7033     END-IF
SC7033     MOVE WA-REPAY-INPUT-ACCT-NO TO VCHR077-ACCT-NO.
SC7033     MOVE WA-REPAY-AMOUNT TO VCHR077-TXN-AMT.
SC7033     MOVE WA-PRINCIPAL-AMT1 TO VCHR077-PRINCIPAL-AMT1.
SC7033     MOVE WA-BOIS-REV-RECEIVABLE-DUE TO VCHR077-REV-RECEIVABLE
S10077*--- GET LAST 2 REPAYMENT FOR START DATE AND END DATE ---*
S10077*--- THIS WILL READ IN DESCENDING ORDER OF YENQ
S10077     MOVE WA-EDIT-MASK               TO WA-CORR-EDIT-MASK
S10077     MOVE STRT-AREA-EDIT-MASK        TO WA-SAVE-TRAN-EDIT-MASK
S15769*S10077     MOVE STRT-AREA-SOC-NO           TO YENQ-ALT2-INST-NO
S15769*S10077     MOVE WA-REPAY-INPUT-ACCT-NO     TO YENQ-ALT2-ACCT-NO
S15769*S10077     MOVE 99999999                   TO YENQ-ALT2-TXN-DATE
S15769*S10077     MOVE 99999999                   TO YENQ-ALT2-POST-DATE
S15769*S10077     MOVE 99999999                   TO YENQ-ALT2-POST-TIME
S15769*S10077     MOVE 999999                     TO YENQ-ALT2-JRNL-NO
S15769*S10077     MOVE 0                          TO YENQ-ALT2-TXN-CODE
S15769*S10077     MOVE 0                          TO WS-VCHR-READRSW
S15769*S10077     MOVE 0                          TO WS-VCHR-STRT-DATE
S15769*S10077     MOVE 0                          TO WS-VCHR-END-DATE
S15769*S10077     PERFORM UNTIL WS-VCHR-READRSW = 1
S15769*S10077        MOVE YENQ-ALT2-KEY      TO DBIOMOD-KEY
S15769*S10077        MOVE "READNEXT"         TO DBIOMOD-FUNCTION
S15769*S10077        MOVE "YENQ"             TO DBIOMOD-FILE
S15769*S10077                                   DBIOMOD-SUFFIX
S15769*S10077        MOVE "DBIO"             TO DBIOMOD-PREFIX
S15769*S10077        MOVE 2                  TO DBIOMOD-KEY-NO
S15769*S10077        MOVE SPACES             TO DBIOMOD-RELEASE-LOCK
S15769*S10077                                   DBIOMOD-ACCESS-COMMAND
S15769*S10077                                   DBIOMOD-ACCESS-COND
S15769*S10077                                   DBIOMOD-STATUS
S15769*S10077        CALL DBIOMODNAME USING
S15769*S10077                                DBIOMOD-FILE
S15769*S10077                                DBIOMOD-KEY
S15769*S10077                                YENQ-RECORD-AREA
S15769*S10077                                DBIOMOD-FUNCTION
S15769*S10077                                DBIOMOD-KEY-NO
S15769*S10077                                DBIOMOD-RELEASE-LOCK
S15769*S10077                                DBIOMOD-ACCESS-COMMAND
S15769*S10077                                DBIOMOD-ACCESS-COND
S15769*S10077                                DBIOMOD-STATUS
S15769*S10077        IF DBIOMOD-STAT NOT = "****" AND "MRNF"
S15769*S10077           MOVE 1                  TO WS-VCHR-READRSW
S15769*S10077           SET UT8500CA-NORMAL-DISPLAY  TO TRUE
S15769*S10077           MOVE SPACES             TO UT8500CA-INPUT-MSG
S15769*S10077           STRING "BR0000:(D450) "
S15769*S10077                  " DBIOMOD-STAT : " DBIOMOD-STAT
S15769*S10077           DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S15769*S10077           MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
S15769*S10077           CALL "UT8500" USING   UT8500CA-AREA
S15769*S10077           MOVE 155                TO WA-OUTPUT-ERR-MSG-NO
S15769*S10077        ELSE
S15769*S10077           IF DBIOMOD-STAT = "MRNF"
S15769*S10077              MOVE 1               TO WS-VCHR-READRSW
S15769*S10077              IF WS-VCHR-END-DATE NOT = 0
S15769*S10077                 AND WS-VCHR-STRT-DATE = 0
S15769*S10077                 MOVE WS-VCHR-END-DATE TO WS-VCHR-STRT-DATE
S15769*S10077              END-IF
S15769*S10077           ELSE
S15769*S10077              MOVE YENQ-INST-NO    TO YENQ-ALT2-INST-NO
S15769*S10077              MOVE YENQ-ACCT-NO    TO YENQ-ALT2-ACCT-NO
S15769*S10077              MOVE YENQ-TXN-DATE   TO YENQ-ALT2-TXN-DATE
S15769*S10077              MOVE YENQ-POST-DATE  TO YENQ-ALT2-POST-DATE
S15769*S10077              MOVE YENQ-POST-TIME  TO YENQ-ALT2-POST-TIME
S15769*S10077              MOVE YENQ-JRNL-NO    TO YENQ-ALT2-JRNL-NO
S15769*S10077              MOVE YENQ-TXN-CODE   TO YENQ-ALT2-TXN-CODE
S15769*S10077              MOVE YENQ-TXN-CODE   TO LINK-IN-TXCODE
S15769*S10077              IF YENQ-ACCT-NO = WA-REPAY-INPUT-ACCT-NO
S15769*S10077                 IF LINK-IN-TXCODE NOT = 6196 AND 6296
S15769*S10077                                     AND 6211 AND 6101
S15769*S10077                    PERFORM X700-CALL-UT0250 THRU X799-EXIT
S15769*S10077                    IF WA-MSG-ERR-FLAG = 0
S15769*S10077                       MOVE LINK-EDIT-MASK TO FIELD-B
S15769*S10077                       CALL "UT0022" USING
S15769*S10077                                           PUAREA
S15769*S10077                       MOVE FIELD-A TO WA-EDIT-MASK
S15769*S10077                       MOVE LINK-EDIT-TABLE
S15769*S10077                                    TO STRT-AREA-EDIT-MASK
S15769*S10077                    ELSE
S15769*S10077                       MOVE 1       TO WS-VCHR-READRSW
S15769*S10077                    END-IF
S15769*S10077                 END-IF
S15769*S11372                 IF  YENQ-LOAN-BAL   > 0
S15769*S11372                 AND YENQ-STATUS     = 0
S15769*S11372                    MOVE YENQ-TXN-DATE TO WA-SAVE-Y-TXN-DATE
S15769*S11372                 END-IF
S15769*S10077                 IF ((WA-INPUT-PARAM-TABLE(4) = 1
S15769*S10077                 AND  WA-INPUT-PARAM-TABLE(7) = 0)
S15769*S10077                 OR  (YENQ-TXN-CODE = 6296 OR 6211))
S15769*S10077                 AND  WA-MSG-ERR-FLAG = 0
S15769*S10077                 AND  YENQ-STATUS = 0
S15769*S10077                    IF WS-VCHR-END-DATE = 0
S15769*S10077                       MOVE YENQ-TXN-DATE
S15769*S10077                            TO WS-VCHR-END-DATE
S15769*S10077                    ELSE
S15769*S10077                       IF WS-VCHR-STRT-DATE = 0
S15769*S10077                          MOVE YENQ-TXN-DATE
S15769*S10077                               TO WS-VCHR-STRT-DATE
S15769*S11372                          IF YENQ-LOAN-BAL NOT > 0
S15769*S11372                             MOVE WA-SAVE-Y-TXN-DATE
S15769*S11372                                  TO WS-VCHR-STRT-DATE
S15769*S11372                          END-IF
S15769*S10077                          MOVE 1 TO WS-VCHR-READRSW
S15769*S10077                      END-IF
S15769*S10077                    END-IF
S15769*S10077                 END-IF
S15769*S10077              ELSE
S15769*S10077                 MOVE 1          TO WS-VCHR-READRSW
S15769*S10077              END-IF
S15769*S10077           END-IF
S15769*S10077        END-IF
S15769*S10077     END-PERFORM
S10077     MOVE WA-CORR-EDIT-MASK          TO WA-EDIT-MASK
S10077     MOVE WA-SAVE-TRAN-EDIT-MASK     TO STRT-AREA-EDIT-MASK
S15769*S10077     IF WS-VCHR-STRT-DATE NOT = 0
S15769*S10077        MOVE WS-VCHR-STRT-DATE       TO WA-BIN-DATE
S15769*S10077     ELSE
S15769*SC7033        MOVE WA-BOIS-PREV-DUE-DATE   TO WA-BIN-DATE
S15769*S10077     END-IF
S15769     MOVE WA-BOIS-PREV-DUE-DATE      TO WA-BIN-DATE
SC7033     PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
SC7033     MOVE WA-DDMMCCYY-DATE           TO VCHR077-STRT-DATE
S15769*S10077     IF WS-VCHR-END-DATE NOT = 0
S15769*S10077        MOVE WS-VCHR-END-DATE        TO WA-BIN-DATE
S15769*S10077     ELSE
S15769*SC7033        MOVE WA-BOIS-NEXT-DUE-DATE   TO WA-BIN-DATE
S15769*S10077     END-IF
S15769     MOVE BOIS-PREV-DUE-DATE         TO WA-BIN-DATE
SC7033     PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
SC7033     MOVE WA-DDMMCCYY-DATE TO VCHR077-END-DATE
SC7033     MOVE 0 TO VCHR077-RATE
SC7033     PERFORM VARYING WA-INDEX FROM 1 BY 1
SC7033       UNTIL WA-INDEX > 15
SC7033       PERFORM Z680-GET-BUCKET-GLCC THRU Z689-EXIT
SC7033            IF  UT0094CA-BUCKET-DUE (WA-INDEX) <> WA-ZERO
SC7033            AND UT0094CA-BUCKET-TXN-CODE (WA-INDEX) <> WA-ZERO
SC7033                MOVE UT0094CA-BUCKET-TXN-CODE (WA-INDEX) TO
SC7033                                                  WA-BUCKET-TRAN
SC7033                PERFORM Z610-SEARCH-BUCKET-VIA-TRAN
SC7033                      THRU Z619-EXIT
SC7033                IF WA-PRIORITY-CDE  = "P"
SC7033                   OR (WA-BUCKET-TRAN = 13031)
SC7033                   ADD UT0094CA-BUCKET-DUE (WA-INDEX) TO
SC7033                       VCHR077-PRINCIPAL-AMT
SC7033                END-IF
SC7033                IF STRT-AREA-TRN-NO = 11045
SC7033                   IF WA-BUCKET-TRAN = 13528
SC7033                     ADD UT0094CA-BUCKET-DUE(WA-INDEX) TO
SC7033                         VCHR077-TEMP-PYMNT-DR
SC7033                   ELSE
SC7033                     IF WA-BUCKET-TRAN = 11044
SC7033                        ADD UT0094CA-BUCKET-DUE (WA-INDEX) TO
SC7033                            VCHR077-PRINCIPAL-AMT
SC7033                     END-IF
SC7033                   END-IF
SC7033                END-IF
S10982                IF STRT-AREA-TRN-NO = 11046 OR 11049
SC7033                   IF WA-BUCKET-TRAN = 11048
SC7033                      ADD UT0094CA-BUCKET-DUE (WA-INDEX) TO
SC7033                      VCHR077-PRINCIPAL-AMT
SC7033                   END-IF
SC7033                END-IF
SC7033                EVALUATE WA-PRIORITY-CDE
SC7033                WHEN "A"
SC7033                     COMPUTE VCHR077-PENALTY =
SC7033                       UT0094CA-BUCKET-DUE(WA-INDEX) * -1
SC7033                WHEN "I"
SC7033                     COMPUTE VCHR077-INT-AMT =
SC7033                       UT0094CA-BUCKET-DUE(WA-INDEX) * -1
SC7033                WHEN "L"
SC7033                     COMPUTE VCHR077-LEGAL-FEE1-DUE =
SC7033                       UT0094CA-BUCKET-DUE(WA-INDEX) * -1
SC7033                WHEN "M"
SC7033                     COMPUTE VCHR077-MISC-FEE1 =
SC7033                       UT0094CA-BUCKET-DUE(WA-INDEX) * -1
SC7033                WHEN "X"
SC7033                     COMPUTE VCHR077-LEGAL-FEE2-DUE =
SC7033                       UT0094CA-BUCKET-DUE(WA-INDEX) * -1
SC7033                WHEN "T"
SC7033                     COMPUTE VCHR077-TEMP-PYMNT-DR  =
SC7033                       UT0094CA-BUCKET-DUE(WA-INDEX) * -1
SC7033                WHEN "P"
SC7033                     COMPUTE VCHR077-PRINCIPAL-AMT  =
SC7033                       UT0094CA-BUCKET-DUE(WA-INDEX) * -1
SC7033                WHEN "Z"
SC7033                     COMPUTE VCHR077-MISC-FEE2 =
SC7033                       UT0094CA-BUCKET-DUE(WA-INDEX) * -1
SC7033                WHEN OTHER
SC7033                     CONTINUE
SC7033                END-EVALUATE
SC7033            END-IF
SC7033     END-PERFORM.
SC7033     IF WA-REPAY-AMOUNT <= VCHR077-REV-RECEIVABLE
SC7033        MOVE WA-REPAY-AMOUNT TO VCHR077-REV-RECEIVABLE
SC7033     END-IF
SC7033     IF BORM-LOAN-BAL < 0
SC7033        MOVE 0 TO VCHR077-PRINCIPAL-AMT2
S10805*       MULTIPLY VCHR077-PRINCIPAL-AMT BY -1
S10805*         GIVING VCHR077-PRINCIPAL-AMT
SC7033        MULTIPLY BORM-LOAN-BAL BY -1
SC7033          GIVING VCHR077-TEMP-RECEIVABLE
S10805*        SUBTRACT VCHR077-PRINCIPAL-AMT FROM  
S10805*                 VCHR077-TEMP-RECEIVABLE     
S10805*                 GIVING VCHR077-PRINCIPAL-AMT
S11415*S10805         SUBTRACT VCHR077-TEMP-RECEIVABLE
S11415*S10805             FROM VCHR077-PRINCIPAL-AMT
S11415*S10805           GIVING VCHR077-PRINCIPAL-AMT
S11415         COMPUTE VCHR077-PRINCIPAL-AMT =
S11415                 VCHR077-PRINCIPAL-AMT + VCHR077-TEMP-RECEIVABLE
SC7033        IF WA-PRINCIPAL-AMT1 <= 0
SC7033           MOVE SPACE TO VCHR077-STRT-DATE
SC7033                          VCHR077-END-DATE
S10805*          SUBTRACT VCHR077-PRINCIPAL-AMT FROM
S10805*                   VCHR077-TEMP-RECEIVABLE
S10805*                   GIVING VCHR077-TEMP-RECEIVABLE
S10805           COMPUTE VCHR077-TEMP-RECEIVABLE = WA-PRINCIPAL-AMT1
S10805                                           - BORM-LOAN-BAL    
SC7033           MOVE 0 TO VCHR077-PRINCIPAL-AMT1
SC7033                     VCHR077-PRINCIPAL-AMT
SC7033        END-IF
SC7033     ELSE
SC7033        MOVE BORM-LOAN-BAL TO VCHR077-PRINCIPAL-AMT2
SC7033     END-IF.
SC7033 D459-EXIT.
SC7033     EXIT.
SC7033 D410-CONVERT-BIN-DATE.
SC7033
SC7033     MOVE WA-BIN-DATE TO UT0020-BINARY-DATE.
SC7033     MOVE 1           TO UT0020-FUNCTION.
SC7033     CALL "UT0020" USING UT0020-FUNCTION
SC7033                         UT0020-DATE-AREA
SC7033                         UT0020-BINARY-DATE.
SC7033     MOVE UT0020-DATE-DDMMCCYY TO WA-DDMMCCYY-DATE.
SC7033
SC7033 D419-EXIT.
SC7033     EXIT.
       D500-POPULATE-PRINCIPAL.
SC6449     MOVE SPACE  TO VCHR-FRM077.                           
           MOVE WA-REPAY-INPUT-ACCT-NO TO VCHR077-ACCT-NO.
           MOVE SPACES TO VCHR077-ACCT-NAME.
           IF STRT-AREA-TRN-NO = 11048 OR 16048
SC6449*       MOVE WA-BR0023-DUE-AMT TO VCHR077-TXN-AMT                  
SC6449*       MOVE UT0072CA-EARLY-PRINCIPAL-AMT TO                       
SC6449*            VCHR077-PENALTY                                       
SC6449*       MOVE BR0023-DUE-AMT TO VCHR077-PRINCIPAL-AMT               
SC6449*           VCHR077-PRINCIPAL-AMT                                  
SC6449        MOVE WA-REPAY-AMOUNT TO VCHR077-TXN-AMT                    
SC6449                                VCHR077-PRINCIPAL-AMT              
SC6449        COMPUTE VCHR077-PENALTY =                                  
SC6449                BR0023-PENALTY-AMT + BR0023-WAIVE-AMT              
           ELSE
              MOVE WA-REPAY-AMOUNT TO VCHR077-TXN-AMT
SC6275                                VCHR077-PRINCIPAL-AMT
              MOVE BR0023-PENALTY-AMT TO VCHR077-PENALTY
SC6275*       MOVE BORM-LOAN-BAL TO VCHR077-PRINCIPAL-AMT
           END-IF.
           MOVE WA-PRINCIPAL-AMT1 TO VCHR077-PRINCIPAL-AMT1.
           IF STRT-AREA-TRN-NO = 11048 OR 16048 OR 11044
              OR 16044
SC6275*      MOVE BR0023-DEP-ACC-NO TO VCHR077-TRF-ACCT-NO
SC6275       MOVE WA-DEP-ACCT-NO    TO VCHR077-TRF-ACCT-NO
SC6275       MOVE NARRATIVE-11045   TO VCHR077-DESC
S11239*SC6541       IF STRT-AREA-TRN-NO = 16048 OR 16044
S11239*SC6541          MOVE NARRA-16048    TO VCHR077-DESC
S11239*SC6541       END-IF
           ELSE
              MOVE 0 TO VCHR077-TRF-ACCT-NO
           END-IF.
           MOVE SPACES TO VCHR077-TRF-NAME.
           MOVE BORM-LOAN-BAL TO VCHR077-PRINCIPAL-AMT2.
SC6542*    PERFORM X710-GET-RATE THRU X719-EXIT                          SC7697
SC6542*    MOVE WA-INT-RATE-A TO VCHR077-RATE                            SC7697
S11487     IF   BORP-INT-RATE-PRINT = 'N'
S11487        MOVE 0 TO VCHR077-RATE
S11487     ELSE
S11487        MOVE BORM-STORE-RATE TO VCHR077-RATE
S11487     END-IF.
S11487*SC7697     MOVE BORM-STORE-RATE TO VCHR077-RATE.
SC6542*    MOVE BORM-STORE-RATE TO VCHR077-RATE.
           MOVE SPACES TO VCHR077-TRF-NAME.
       D509-EXIT.
           EXIT.
SC6189 D600-POPULATE-FORM77.
SC6189     MOVE BR17467-INP-TRF-ACCOUNT TO VCHR077-TRF-ACCT-NO.
SC6189     MOVE BR17467-INP-ACCT-NO TO VCHR077-ACCT-NO.
SC6189     MOVE SPACES TO VCHR077-ACCT-NAME.
SC6189     COMPUTE WA-DEF-INT-AMT = BR17467-INP-DEF-INT-AMT -
SC6189             BR17467-INP-DEF-WAIVE-INT
SC6189     MOVE WA-DEF-INT-AMT TO VCHR077-TXN-AMT.
SC6189     MOVE BR17467-INP-DEF-INT-AMT TO VCHR077-INT-AMT
SC6189     MOVE WA-PRINCIPAL-AMT1 TO VCHR077-PRINCIPAL-AMT1.
SC6189     MOVE BORM-LOAN-BAL TO VCHR077-PRINCIPAL-AMT2.
SC6189*    MOVE BORM-STORE-RATE TO VCHR077-RATE.                         SC7697
SC6189     MOVE SPACES TO VCHR077-TRF-NAME.
SC6189 D609-EXIT.
           EXIT.
SC6895 D700-NPL-VOUCHER-PRT.
SC6895     MOVE WA-DEP-ACCT-NO         TO VCHR077-TRF-ACCT-NO.
SC6895     MOVE NARRATIVE-11045        TO VCHR077-DESC.
SC6895     MOVE WA-REPAY-INPUT-ACCT-NO TO VCHR077-ACCT-NO.
SC6895     MOVE SPACES                 TO VCHR077-ACCT-NAME.
SC6895     MOVE WA-REPAY-AMOUNT        TO VCHR077-TXN-AMT.
SC6895     MOVE STRT-AREA-POST-DT      TO VCHR077-TXN-DATE.
SC6895 D709-EXIT.
SC6895     EXIT.
NLB115 I100-CALL-UT9998.
SC5458     IF SOC-SITE-TIB
SC5458        GO TO I199-EXIT.
NLB115     IF (BORM-CSLD-STMT-PROS = "Y")   OR
NLB115        (BORM-CSLD-STMT-PROS = " "
NLB115                    AND BORP-CSLD-STMT-PROS = "Y")   OR
NLB115        (BORM-CSLD-STMT-PROS = " "
NLB115                      AND BORP-CSLD-STMT-PROS = " "
NLB115                      AND SOC-CSLD-STMT-PROS = "Y" )
NLB115        NEXT SENTENCE
NLB115     ELSE
NLB115        GO TO I199-EXIT     
NLB115     END-IF.
082090      MOVE ZEROS                  TO UT9998CA-ERR-STATUS.
082100      MOVE WA-INPUT-KEY-R         TO UT9998CA-CUSTOMER-NO.
082110      MOVE SOC-NO-1               TO UT9998CA-INST-NO.   
082120      MOVE 05                     TO UT9998CA-CALL-CODE.  
082140      CALL "UT9998" USING UT9998-CALL-AREA.
082160      IF UT9998CA-ERR-STATUS NOT = ZERO
082170         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
082180                                   TO UT8500CA-CALL-CODE
082190         MOVE SPACES TO UT8500CA-INPUT-MSG
082200         STRING "BR0000:(R100) UT9998 CALL ERROR - "
082210                                    UT9998CA-ERR-STATUS
082220               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
082230         CALL "UT8500" USING   UT8500CA-AREA
082240         MOVE 1                    TO WA-MSG-ERR-FLAG
082250         MOVE UT9998CA-ERR-STATUS  TO WA-OUTPUT-ERR-MSG-NO
082260         MOVE UT9998CA-CALL-SYS    TO WA-DBERR-DATA-SET
082270         MOVE UT9998CA-CALL-STATUS TO WA-DB-ERROR
082280      END-IF.
NLB115 I199-EXIT.
NLB115      EXIT.
082310*
082320******************************************************************
082330*** C O M P L E T I O N   P A R A ***
082340******************************************************************
082350 E000-COMPLETION-PARA.
ST0137     IF ST-STATUS-LEVEL-1 = 1
S18753        IF (WA-OUTPUT-ERR-MSG-NO = 0
S18753        OR  WA-OUTPUT-ERR-MSG-NO < 100
S18753        OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
S18753          MOVE UT8500CA-FUNC-NORMAL-DISPLAY
S18753                            TO UT8500CA-CALL-CODE
S18753          MOVE SPACES TO UT8500CA-INPUT-MSG
S18753          STRING "BR0000(E000) LEVEL-1 ERR 0 "
S18753            ",TRN-" STRT-AREA-TRN-NO
S18753            ",TEL-" STRT-AREA-TELL-NO
S18753            ",MSG-" WA-OUTPUT-ERR-MSG-NO
S18753            ",ACT-" BORM-MEMB-CUST-AC
S18753            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S18753            CALL "UT8500" USING
S18753                                UT8500CA-AREA
S18753        END-IF
ST0137        MOVE 1 TO WA-MSG-ERR-FLAG
ST0137     END-IF.
ST0137     IF   WA-MSG-ERR-FLAG      = 1
ST0137     AND (WA-OUTPUT-ERR-MSG-NO = 0
ST0137      OR  WA-OUTPUT-ERR-MSG-NO < 100
ST0137      OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
ST0137**        COMMENT OUT ERROR NO AND ONLY DISPLAY
ST0137**        MOVE 1062 TO WA-OUTPUT-ERR-MSG-NO
ST0137          MOVE UT8500CA-FUNC-NORMAL-DISPLAY
ST0137                            TO UT8500CA-CALL-CODE
ST0137          MOVE SPACES TO UT8500CA-INPUT-MSG
ST0137          STRING "BR0000(E000) ERR 0 "
ST0137            ",TRN-" STRT-AREA-TRN-NO
ST0137            ",TEL-" STRT-AREA-TELL-NO
S18753            ",MSG-" WA-OUTPUT-ERR-MSG-NO
ST0137            ",INP-" WA-DISP-ORIG-INP-MSG
ST0137            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
ST0137            CALL "UT8500" USING
ST0137                                UT8500CA-AREA
ST0137     END-IF.
SC9268***
SC9268*** update EFTM table for correction transactions
SC9268***
SC9268      IF NOT STRT-REPOST-TXN AND NOT STRT-BATCH-TRICKLE-TXN
SC9268         AND WA-MSG-ERR-FLAG = 0
SC9268***  UPDATE THE EFTM RECORD WHEN THE CORRECTION TRANSACTION WAS SUCCESSFU+
SC9268        IF  (STRT-INT-VALID-FLAG4            AND
SC9268          (WA-INPUT-PARAM-TABLE(23) = 0   OR
SC9268           WA-INPUT-PARAM-TABLE(30) = 1) AND
SC9268           WA-MSG-ERR-FLAG = 0)
SC9268           IF WA-INPUT-PARAM-TABLE(7) = 1
SC9268              MOVE EFTMTMP-INST-NO       TO EFTMCA-INST-NO
SC9268              MOVE EFTMTMP-CHANNEL-TYPE  TO EFTMCA-CHANNEL-TYPE
SC9268              MOVE EFTM-SEQUENCE-NO      TO EFTMCA-EC-SEQUENCE-NO
SC9268              MOVE EFTMTMP-SEQUENCE-NO   TO EFTMCA-SEQUENCE-NO
SC9268              MOVE EFTMTMP-TERMINAL-DATE TO EFTMCA-TERMINAL-DATE
SC9268              MOVE EFTMTMP-TERMINAL-TIME TO EFTMCA-TERMINAL-TIME
SC9268              MOVE EFTMTMP-TERMINAL-ID   TO EFTMCA-TERMINAL-ID
SC9268              MOVE EFTMTMP-ACCOUNT-NO    TO EFTMCA-ACCOUNT-NO
SC9268              MOVE EFTMTMP-BANCS-JOURNAL-NO TO
SC9268                                   EFTMCA-BANCS-JOURNAL-NO
SC9268              MOVE "N"                   TO EFTMCA-EC-TXN
SC9268              MOVE "Y"                   TO EFTMCA-BE-CORRECTED
SC9268
SC9268              MOVE 2                     TO UTEFTMCA-CALL-CODE
SC9268              CALL "UTEFTM" USING
SC9268                                 UTEFTM-CALL-AREA
SC9268                                 WA-PASSALONG
SC9268              END-CALL
SC9268              IF WA-MSG-ERR-FLAG NOT = 0
SC9268                 MOVE WA-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
SC9268                 GO TO E199-EXIT
S17209              END-IF
SC9268           END-IF
SC9268        END-IF
SC9268      END-IF.
SC9268*--*
082370*    IF  ST-STATUS-LEVEL-1 NOT = 00
082380*        GO TO E099-EXIT.
082390*
082400***  ------------------------------------
082410***  POST TO SUSPENSE ACCOUNT IF REQUIRED
082420***  ------------------------------------
082430*
082440     IF  WA-MSG-ERR-FLAG NOT = ZERO
082450     AND UT0460CA-ERROR-STATUS = ZERO
082460     AND ((WA-INPUT-PARAM-TABLE (4) = 1) OR
082470          (WA-INPUT-PARAM-TABLE (5) = 1))
082480     AND WA-INPUT-PARAM-TABLE (28) NOT = 1
082490     AND WA-INPUT-PARAM-TABLE (29) NOT = 1
082500     AND WA-INPUT-PARAM-TABLE (25) NOT = 1
082510     AND WA-INPUT-PARAM-TABLE (10) NOT = 1
082520     AND WA-DUMMY-FST-ONE NOT = 2
082530     AND (STRT-BATCH-TRICKLE-TXN OR STRT-AREA-EFT-TXN OR
082540             STRT-AREA-ADVICE OR STRT-OLRR-TXN)
082550         PERFORM E050-CHECK-EPIP THRU E059-EPIP-EXIT.
082560*
082570***  ---------------------------------------------------------
082580***  IF REQUIRED, WRITE A RECORD TO THE ONLINE REJECT REFERRAL
082590***  FILE (OLRR) WITH DETAILS OF REJECTS/OVERRIDES/SUSPENSE
082600***  ---------------------------------------------------------
082610*
082620     IF WA-GL-TRANSACTION-FLAG NOT = "Y"
082630        IF STRT-BATCH-TRICKLE-TXN OR STRT-AREA-EFT-TXN OR
082640           STRT-AREA-ADVICE
082650           MOVE "Y" TO WA-GL-TRANSACTION-FLAG
082660           PERFORM E060-WRITE-REFERRALS THRU E069-EXIT.
082680     IF  WA-MSG-ERR-FLAG = 1
082690         PERFORM E100-FMT-SEND-PARA
082700            THRU E199-EXIT
082710         GO TO E099-EXIT.
SC6000*
SC6000* NO NEED TO BYPASS E000 FOR ATM TXN SENT FROM NON ATM CHANNEL
SC6000*
SC6000*    IF  WA-INPUT-PARAM-TABLE(30) = 1
SC4490*        IF  (WA-MSG-ERR-FLAG = 1 OR ST-ATM-UPDT-FLAG = "U")
SC4490*        IF  WA-MSG-ERR-FLAG = 1                               SC4803
SC6000*        IF  WA-MSG-ERR-FLAG = 1 OR NOT STRT-ASYNC-TPS
SC6000*            GO TO E099-EXIT.
082770     IF WA-INPUT-PARAM-TABLE(17) = 1
082780        IF STRT-AREA-SIGN = "-"
082790           MULTIPLY WA-APP-AMOUNT BY -1 GIVING WA-DUMMY-AMT
082800        ELSE
082810           MOVE WA-APP-AMOUNT     TO WA-DUMMY-AMT.
082830     IF  (WA-OVER-RIDE-USED = "69") OR
082840         (WA-SUPERVISOR-OVERRIDE-USED = "2" OR "3" OR "7")
082850         IF  WA-BYPASS-ENQ-FLG = "Y"
082860             MOVE SPACE          TO WA-BYPASS-ENQ-FLG.
082870     IF CHECK-POSTED-TO-SUSP
082880        GO TO E005-CONTINUE.
082890*-----------------------------------------------------------------
082900* IF CORRESPONDENCE PRODUCTION IS ACTIVE FOR THIS INSTITUTION AND
082910* THIS TRANSACTION REQUIRES CORRESPONDENCE AND THERE ARE NO ERRORS
082920* THEN CALL CORRESPONDENCE PRODUCTION MODULE.
082930*-----------------------------------------------------------------
082940*
082950     IF STRT-AREA-TRN-NO = 12426
082960        IF  SOC-FORM-IN-USE = "Y" AND WA-MSG-ERR-FLAG = 0
082970        AND STRT-AREA-CORRESPONDENCE-REQ = "Y"
082980        AND WA-12426-FULLYDRAWN = "Y"
082990           MOVE 0                  TO CP0010CA-CALL-CODE
083000           MOVE SPACES             TO CP0010CA-AREA-ONE-CODE
083010           MOVE "BORM"             TO CP0010CA-AREA-TWO-CODE
083020           MOVE SOC-LANGUAGE-CODE  TO CP0010CA-SOC-LANGUAGE-CODE
083030           MOVE STRT-AREA-SOC-NO   TO CP0010CA-SOC-NO
083040           MOVE STRT-AREA-BRANCH   TO CP0010CA-BRANCH
083050           IF CP0010CA-TRN-NO = SPACES
083060              MOVE STRT-AREA-TRN-NO TO CP0010CA-TRN-NO
083070           END-IF
083080           MOVE STRT-AREA-JRNL-NO  TO CP0010CA-JRNL-NO
083090           MOVE BORM-ACT-TYPE      TO CP0010CA-ACCT-TYPE
083100           MOVE BORM-CAT           TO CP0010CA-INT-CAT
083110           MOVE SPACES             TO CP0010CA-FORM-ID
083120           MOVE STRT-AREA-CORR-DESTINATION
083130                                   TO CP0010CA-CORR-DESTINATION
083140           MOVE BORM-RECORD-AREA   TO CP0010-RECORD-AREA-TWO
083150           CALL "CP0010" USING
083160                       CP0010CA-PARAM
083170                       CP0010-RECORD-AREA-ONE
083180                       CP0010-RECORD-AREA-TWO
083190                       CP0010-RECORD-AREA-THREE
083200        END-IF
083210     ELSE
083220        IF  SOC-FORM-IN-USE = "Y"   AND WA-MSG-ERR-FLAG = 0 AND
083230         STRT-AREA-CORRESPONDENCE-REQ = "Y"
083240             MOVE 0                  TO CP0010CA-CALL-CODE
083250             MOVE SPACES             TO CP0010CA-AREA-ONE-CODE
083260             MOVE "BORM"             TO CP0010CA-AREA-TWO-CODE
083270             MOVE SOC-LANGUAGE-CODE  TO CP0010CA-SOC-LANGUAGE-CODE
083280             MOVE STRT-AREA-SOC-NO   TO CP0010CA-SOC-NO
083290             MOVE STRT-AREA-BRANCH   TO CP0010CA-BRANCH
083300             MOVE STRT-AREA-TELL-NO  TO CP0010CA-TELLER-NUMBER
083310             MOVE STRT-AREA-POST-DT  TO CP0010CA-POST-DATE
083330             IF CP0010CA-TRN-NO = SPACES
083340                MOVE STRT-AREA-TRN-NO TO CP0010CA-TRN-NO
083350             END-IF
083360             IF STRT-AREA-TRN-NO = 19001
083370                MOVE ZEROES TO CP0010CA-ACCT-TYPE
083380                               CP0010CA-INT-CAT
083390                MOVE COFL-RECORD TO WA-COFL-DATA
083400             ELSE
083410                MOVE BORM-ACT-TYPE      TO CP0010CA-ACCT-TYPE
083420                MOVE BORM-CAT           TO CP0010CA-INT-CAT
083430             END-IF 
083440             MOVE BORM-RECORD-AREA   TO CP0010-RECORD-AREA-TWO
083450             MOVE STRT-AREA-JRNL-NO  TO CP0010CA-JRNL-NO
083460             MOVE SPACES             TO CP0010CA-FORM-ID
083470             MOVE STRT-AREA-CORR-DESTINATION
083480                                     TO CP0010CA-CORR-DESTINATION
083490             CALL "CP0010" USING
083500                         CP0010CA-PARAM
083510                         CP0010-RECORD-AREA-ONE
083520                         CP0010-RECORD-AREA-TWO
083530                         CP0010-RECORD-AREA-THREE
083540        END-IF
083550     END-IF.
083560     IF STRT-AREA-TRN-NO = 19001
083570        GO TO E099-EXIT
083580     END-IF.
SC7808*    IF STRT-AREA-TRN-NO = 17047
SC7808*       IF  ST-STATUS-LEVEL-1 = 00 AND O17047-JRNL-STAT = "Y"
SC7808*           PERFORM E410-JRNL-17047 THRU E410-EXIT
SC7808*       END-IF
SC7808*    END-IF.
083590*
SC9872*    IF  BORP-YOUBE
SC9872*    AND WA-INPUT-PARAM-TABLE(5) = 1
SC9872*       PERFORM Z100-CALCULATE-MIN-DUE-AMT THRU Z109-EXIT
SC9872*       MOVE WA-MIN-DUE-AMT TO BOIS-MIN-DUE-AMOUNT
SC9872*    END-IF.
083600*
083610 E005-CONTINUE.
S19705* RICHART PROD. VIA EAI NOT TO RESET THE ERR-MSG-NO TO ZERO
083630     IF ST-STATUS-LEVEL-1 = 00
S19705       IF PROD-RICHART
S19705          AND  (STRT-AREA-TRN-NO = 15045 OR 13011 OR 13045 )
S19705          AND   STRT-DIB-TXN
S19705          NEXT SENTENCE
S19705       ELSE
083640        MOVE 0 TO WA-OUTPUT-ERR-MSG-NO
S19705                  WA-MSG-ERR-FLAG
S19705*083650           WA-MSG-ERR-FLAG.
S19705       END-IF
S19705     END-IF.
083660     IF WA-POST-2ND-PASS
083670        GO TO E010-CONTINUE
083680     END-IF.
083690*
083700     IF WA-DUMMY-FST-ONE = 2
083710              GO TO E009.
083720*
083730***  760505
083740***  DON'T NEED TO CALL INT CALC MODULE FOR DAILY REST ACCOUNTS
083750***  WHEN DOING BASIC BALANCE ADJUSTMENT (12476 AND 12576)
083760*
083770     IF (((WA-INPUT-PARAM-TABLE(23) = 0) AND                              
083780        (STRT-AREA-TRN-NO NOT = 12477 AND 12577)) OR                      
083790        (STRT-AREA-TRN-NO = 10732 OR 10733))                              
083800        IF BORP-ACCRUE-FREQ = 99
083810           IF STRT-AREA-TRN-NO = 12476 OR 12576
083820              NEXT SENTENCE
083830           ELSE
083840              PERFORM H000-CALC-INT THRU H099-EXIT
083850              IF WA-MSG-ERR-FLAG = 1
083860                  PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
083870                  GO TO E099-EXIT.
083880*
083890     IF BORP-INT-DAYS-YR = 0                                             
083900        MOVE UT1999CA-CCYYMMDD TO UT0310CA-CALENDAR-IN-CCYYMMDD          
083910        MOVE 6 TO UT0310CA-CALL-FUNC                                     
083920        MOVE ZEROES TO UT0310CA-CALL-STATUS                              
083930        MOVE ZEROES TO UT0310CA-CALENDAR-METHOD                          
083940        MOVE BORP-CALENDAR-CODE TO UT0310CA-CALENDAR-CODE                
083950        MOVE STRT-AREA-SOC-NO   TO UT0310CA-SOC-NO                      
083960        CALL "UT0310" USING UT0310CA-REC                                 
083970        IF UT0310CA-CALL-STATUS NOT = 0                                  
083980           MOVE 365 TO WS-DAYS-IN-YEAR                                   
083990                       WA-NO-INT-DAYS-YR                                
084000        ELSE                                                             
084010           MOVE UT0310CA-DAYS-IN-YEAR TO WS-DAYS-IN-YEAR                 
084020                                         WA-NO-INT-DAYS-YR              
084030        END-IF                                                           
084040     ELSE                                                                
084050        MOVE BORP-INT-DAYS-YR TO WS-DAYS-IN-YEAR                         
084060                                 WA-NO-INT-DAYS-YR                      
084070     END-IF.                                                             
084080*                                                                        
084090     IF  WA-INPUT-PARAM-TABLE(2) = 1
084100     AND WA-INPUT-PARAM-TABLE(24) NOT = 1
084110         COMPUTE WS-ARREARS-AMT = BORM-LOAN-BAL -                        
084120                                  BORM-THEO-LOAN-BAL                     
084130         MOVE BORP-FINE-RATE       TO WS-FINE-RATE                       
084140         MOVE WS-ARREARS-AMT       TO WA-ARREARS                         
084150         IF BORP-COFM-METH = 'Y'                                         
084160            COMPUTE WS-ARREARS-AMT = WS-ARREARS-AMT       +              
084170                                     BORM-ARR-INT-ACCR    +              
084180                                     BLDV-FC-ARR-ADJ-ACCR +               
084190                                     BORM-BPI-ACCR        +              
084200                                     BLDV-FC-BPI-ADJ-ACCR +               
084210                                     BORM-INT-ACCR        +              
084220                                     BLDV-FC-LI-ADJ-ACCR  +               
084230                                     BORM-CI-ACCR         +              
084240                                     BLDV-FC-CI-ADJ-ACCR                  
084250*           ADD BORM-ARR-INT-ACCR  TO WS-ARREARS-AMT                     
084260*                              GIVING WS-ARREARS-AMT                     
084270            MOVE 01                TO UT0096CA-CALL-CODE                 
084280            MOVE WS-DAYS-IN-YEAR   TO UT0096CA-CALL-CALC-BSIS            
084290                                      UT0096CA-CALL-MULT-FCTR            
084300            MOVE 1                 TO UT0096CA-CALL-UNIT-IN-BSIS         
084310            MOVE BORP-FINE-RATE    TO UT0096CA-CALL-INT-RATE             
084320            CALL "UT0096"       USING UT0096CA-AREA                      
084330            MOVE UT0096CA-RTRN-COFM-RATE TO WS-FINE-RATE                 
084340         END-IF                                                          
084350         IF WA-SAVE-ARREARS <= 0
084360            IF WA-ARREARS > 0
084370               MOVE STRT-AREA-POST-DT TO BORM-LST-ARR-DATE
084380            END-IF
084390         END-IF
084400         IF WA-ARREARS <= 0
084410            GO TO E008-EXEMPT
084420         END-IF
084430         IF BORP-FINE-METH NOT = 8 AND 12
084440            GO TO E008-EXEMPT
084450         END-IF
084460         IF BORP-FINE-METH = 8
084470            COMPUTE BORM-ARR-INT-INCR ROUNDED =
084480                  (WS-ARREARS-AMT  *                                    
084490                   WS-FINE-RATE / (WA-NO-INT-DAYS-YR * 100))            
084500         ELSE
084510            COMPUTE BORM-ARR-INT-INCR ROUNDED =
084520                 ((BORM-DUE-AMT *
084530                   WS-FINE-RATE) / (WA-NO-INT-DAYS-YR * 100))           
084540         END-IF
084560     END-IF.
084570*
084580 E008-EXEMPT.
084590*
084600* CHECK WHETHER LOAN A/C BALANCE CHANGED SIGN AND WRITE JOURNAL
084610* IF SO.
084620* MOVE THE BALANCE OF THE ACCOUNT TO WA-ACCT-BAL-BEF-TXN FIELD
084630* WHEN THE ACCOUNT MASTER RECORD IS READ IN THE PROGRAM INITIALLY.
084640*
084650     IF STRT-AREA-TRN-NO = 12410 OR 12440 OR 12441                      
084660        NEXT SENTENCE                                                   
084670     ELSE                                                               
084680        IF WA-INPUT-PARAM-TABLE(23) = 0                                 
S12142        OR STRT-AREA-TRN-NO = 10872
084690           IF STRT-AREA-SIGN = "-"                                      
084700              MULTIPLY WA-INPUT-AMT BY -1                               
084710                    GIVING WA-SIGNED-TXN-AMOUNT                         
084720           ELSE                                                         
084730              MOVE WA-INPUT-AMT TO WA-SIGNED-TXN-AMOUNT                 
084740           END-IF                                                       
084750        END-IF                                                          
084760     END-IF.                                                            
084780     MOVE "N"                    TO WA-17046-BRANCH-CHANGE.
084790*
084800* 17046 (CHANGE ACCOUNT TYPE / HOME BRANCH) REQUIRES GLCC RECALC
084810* AND BALANCE TRANSFER
084820*
084830     IF STRT-AREA-TRN-NO = 17046
084840        IF WA-IN-17046-OLD-BRANCH NOT =
084850           WA-IN-17046-NEW-BRANCH
084860           MOVE "Y"       TO WA-17046-BRANCH-CHANGE.
S12701     IF ( STRT-AREA-TRN-NO           =  17200
S12701     AND  BORM-BAD-DEBT-IND(2:1)     =  "2"
S12701     AND  WA-17200-FUNC              =  "10"  )
S12701     AND (WA-17200-OLD-ACT-TYPE  NOT =  WA-17200-NEW-ACT-TYPE
S12701     OR   WA-17200-OLD-CAT       NOT =  WA-17200-NEW-CAT     )
S12701          MOVE 0 TO WA-GLCC-XFER-AMOUNT
S12701          PERFORM
S12701            VARYING WA-GL-INDX FROM 1 BY 1
S12701            UNTIL WA-GL-INDX > 5
S17043**S12701      IF (BOIS-GL-BUCKET-CDE(WA-GL-INDX) = "I" OR "P" )
S17043              IF (BOIS-GL-BUCKET-CDE(WA-GL-INDX) = "P" )
S12701              AND (BOIS-GL-BUCKET-DUE(WA-GL-INDX) <> 0)
S12701                 MOVE BOIS-GL-BUCKET-DUE(WA-GL-INDX)
S12701                                   TO WA-WORK-INT
S12701*S12703          PERFORM U000-CHECK-ZERO THRU U009-EXIT
S12701*S12703          ADD WA-WORK-INT   TO WA-GLCC-XFER-AMOUNT
S12703                 COMPUTE WA-WORK-INT-0 ROUNDED = WA-WORK-INT
S12703                 ADD WA-WORK-INT-0 TO WA-GLCC-XFER-AMOUNT
S12701              END-IF
S12701          END-PERFORM
S12701          MOVE BORP-NON-CGL-COMPONENT-1 TO
S12701                              WA-SAVE-COMPONENT-1
S12701          MOVE BORP-NON-CGL-COMPONENT-2 TO
S12701                               WA-SAVE-COMPONENT-2
S12701          PERFORM Z500-GLCC-TRANSFER-PROCESS THRU
S12701                  Z599-EXIT
S12701          IF  WA-MSG-ERR-FLAG = 1
S12701              PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
S12701              GO TO E099-EXIT
S12701          END-IF
S12701        GO TO E009
S12701     END-IF.
S12078*
S12078     IF ( STRT-AREA-TRN-NO           =  17200 
S12157     AND  BORM-BAD-DEBT-IND(2:1)     <  "2" 
S12696*S12078     AND  WA-17200-FUNC              =  "10"  )
S12696     AND (WA-17200-FUNC              =  "10" OR "14"))
S12078     AND (WA-17200-OLD-ACT-TYPE  NOT =  WA-17200-NEW-ACT-TYPE 
S12078     OR   WA-17200-OLD-CAT       NOT =  WA-17200-NEW-CAT     )     
S12078        COMPUTE WA-GLCC-XFER-AMOUNT = BORM-LOAN-BAL
S12078        IF BORM-LOAN-BAL > 0
S12078        OR  (BORP-YOUBE           
S12078        AND BORM-LOAN-BAL NOT < 0)
S12078               IF (BOIS-921-FLAG  = "0" OR SPACE) OR BORP-YOUBE
S12078               MOVE BORP-CGL-COMPONENT-1-DR TO
S12078                                WA-SAVE-COMPONENT-1
S12078               MOVE BORP-CGL-COMPONENT-2-DR TO
S12078                                WA-SAVE-COMPONENT-2
S12078               ELSE
S12078               MOVE BORP-921-L-CGL-1 TO
S12078                                WA-SAVE-COMPONENT-1
S12078               MOVE BORP-921-L-CGL-2 TO
S12078                                WA-SAVE-COMPONENT-2
S12078               END-IF
S12078               PERFORM Z500-GLCC-TRANSFER-PROCESS THRU
S12078                       Z599-EXIT
S12078               IF  WA-MSG-ERR-FLAG = 1
S12078                   PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
S12078                   GO TO E099-EXIT
S12078               END-IF
S12078        ELSE
S12078              IF (BOIS-921-FLAG  = "0" OR SPACE) OR BORP-YOUBE
S12078              MOVE BORP-CGL-COMPONENT-1-CR TO
S12078                               WA-SAVE-COMPONENT-1
S12078              MOVE BORP-CGL-COMPONENT-2-CR TO
S12078                               WA-SAVE-COMPONENT-2
S12078              ELSE
S12078              MOVE BORP-921-L-CGL-1 TO
S12078                               WA-SAVE-COMPONENT-1
S12078              MOVE BORP-921-L-CGL-2 TO
S12078                               WA-SAVE-COMPONENT-2
S12078              END-IF
S12078              PERFORM Z500-GLCC-TRANSFER-PROCESS THRU Z599-EXIT
S12078              IF  WA-MSG-ERR-FLAG = 1
S12078                  PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
S12078                  GO TO E099-EXIT
S12078              END-IF
S12078        END-IF
S12078*        PERFORM Z670A-GET-BOIS-RTN THRU Z679A-GET-EXIT
S12078        GO TO E009
S12078     END-IF.
S12078*
084880     IF (STRT-AREA-TRN-NO = 17046  AND
084890        (WA-IN-17046-OLD-BRANCH NOT = WA-IN-17046-NEW-BRANCH OR
084900         WA-IN-17046-OLD-ACCT-TYPE
084910                  NOT = WA-IN-17046-NEW-ACCT-TYPE OR
084920         WA-IN-17046-OLD-ACCT-CAT
084930                  NOT = WA-IN-17046-NEW-ACCT-CAT ))
084940      OR (STRT-AREA-TRN-NO = 17000 AND
084950           BR0001CA-CHG-INT-CAT = "Y")
084960        COMPUTE WA-GLCC-XFER-AMOUNT = BORM-LOAN-BAL
084970        IF BORM-LOAN-BAL > 0
S10328        OR  (BORP-YOUBE           
S10328        AND BORM-LOAN-BAL NOT < 0)
084980*              SUBTRACT BORM-LOAN-BAL FROM WA-SIGNED-TXN-AMOUNT
084990*                       GIVING WA-GLCC-XFER-AMOUNT
S10458               IF (BOIS-921-FLAG  = "0" OR SPACE) OR BORP-YOUBE
085000               MOVE BORP-CGL-COMPONENT-1-DR TO
085010                                WA-SAVE-COMPONENT-1
085020               MOVE BORP-CGL-COMPONENT-2-DR TO
085030                                WA-SAVE-COMPONENT-2
S10458               ELSE
S10458               MOVE BORP-921-L-CGL-1 TO
S10458                                WA-SAVE-COMPONENT-1
S10458               MOVE BORP-921-L-CGL-2 TO
S10458                                WA-SAVE-COMPONENT-2
S10458               END-IF
085040               PERFORM Z500-GLCC-TRANSFER-PROCESS THRU
085050                       Z599-EXIT
085060               IF  WA-MSG-ERR-FLAG = 1
085070                   PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
085080                   GO TO E099-EXIT
085090               END-IF
085100        ELSE
085110*             SUBTRACT BORM-LOAN-BAL FROM WA-SIGNED-TXN-AMOUNT
085120*                       GIVING WA-GLCC-XFER-AMOUNT
S10458              IF (BOIS-921-FLAG  = "0" OR SPACE) OR BORP-YOUBE
085130              MOVE BORP-CGL-COMPONENT-1-CR TO
085140                               WA-SAVE-COMPONENT-1
085150              MOVE BORP-CGL-COMPONENT-2-CR TO
085160                               WA-SAVE-COMPONENT-2
S10458              ELSE
S10458              MOVE BORP-921-L-CGL-1 TO
S10458                               WA-SAVE-COMPONENT-1
S10458              MOVE BORP-921-L-CGL-2 TO
S10458                               WA-SAVE-COMPONENT-2
S10458              END-IF
085170              PERFORM Z500-GLCC-TRANSFER-PROCESS THRU Z599-EXIT
085180              IF  WA-MSG-ERR-FLAG = 1
085190                  PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
085200                  GO TO E099-EXIT
085210              END-IF
085220        END-IF
TB0155/
TB0155*        PERFORM Z670-GET-BOIS-RTN UNTIL
TB0155*                WS-BOIS-EOF EQUAL 1
SC3441         PERFORM Z670A-GET-BOIS-RTN THRU Z679A-GET-EXIT
TB0155/
085230        GO TO E009
085240     END-IF.
SC2046     IF STRT-AREA-TRN-NO = 17468 OR 17469
              MOVE 0 TO BORM-LOAN-BAL
           END-IF.
S10032     IF  BORP-YOUBE                         
S10032     AND WA-INPUT-PARAM-TABLE(23) = 1       
S12142     AND STRT-AREA-TRN-NO <> 10872
S10032         GO TO E009                         
S10032     END-IF.                                
SC4745     IF BOIS-921-FLAG NOT = "0" AND SPACE
SC4745        NEXT SENTENCE
SC4745     ELSE
085260     IF BORM-LOAN-BAL = 0
SC4954        IF WA-ACCT-BAL-BEF-TXN < 0
SC4954        COMPUTE YOUBE-PREV-TEMP-BAL = WA-ACCT-BAL-BEF-TXN * -1
SC4954           IF BORP-YOUBE
SC4954              COMPUTE YOUBE-27-TEMP-AMT = WA-ACCT-BAL-BEF-TXN * -1
SC4954              MOVE 0   TO YOUBE-27-PRIN-CRE-AMT
SC6855              MOVE BORM-LOAN-BAL TO  YOUBE-TEMP-BAL
SC4954              PERFORM E010-WRITE-NON-FINANCIAL THRU E019-EXIT
SC8627             IF WA-INPUT-PARAM-TABLE(7) = 1
SC8276              COMPUTE WA-GLCC-XFER-AMOUNT =              
SC8276                                 WA-ACCT-BAL-BEF-TXN * -1
SC8627             ELSE
SC8627              COMPUTE WA-GLCC-XFER-AMOUNT =
SC8627                                 WA-SIGNED-TXN-AMOUNT * -1
SC8627             END-IF
SC6855              MOVE BORP-CGL-COMPONENT-1-DR TO
SC6855                                WA-SAVE-COMPONENT-1
SC6855              MOVE BORP-CGL-COMPONENT-2-DR TO
SC6855                                WA-SAVE-COMPONENT-2
SC6855              PERFORM Z500-GLCC-TRANSFER-PROCESS THRU
SC6855                         Z599-EXIT
SC6855              IF WA-MSG-ERR-FLAG = 1
SC6855                 PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
SC6855                 GO TO E099-EXIT
SC6855              END-IF
SC4954           END-IF
SC4954        END-IF
085270        NEXT SENTENCE
085280     ELSE
085290        IF BORM-LOAN-BAL > 0
085300*SC5380    IF WA-ACCT-BAL-BEF-TXN > 0
SC5380           IF WA-ACCT-BAL-BEF-TXN >= 0
085310              NEXT SENTENCE
085320           ELSE
085330               SUBTRACT BORM-LOAN-BAL FROM WA-SIGNED-TXN-AMOUNT
085340                        GIVING WA-GLCC-XFER-AMOUNT
SC3121               IF BORP-YOUBE
SC5121                 IF WA-ACCT-BAL-BEF-TXN < 0
SC8127                   MOVE WA-ACCT-BAL-BEF-TXN TO WA-GLCC-XFER-AMOUNT
NR2001*SC4954                 INITIALIZE BORV-27-DETAIL
NR2001                 INITIALIZE BOCT-TRAN-27
SC4954                   MOVE 0  TO YOUBE-TEMP-BAL
SC4954             COMPUTE YOUBE-27-TEMP-AMT = WA-ACCT-BAL-BEF-TXN * -1
SC4954                  IF WA-INPUT-PARAM-TABLE(7) = 1
SC8127                     MULTIPLY -1 BY WA-GLCC-XFER-AMOUNT
SC4954                     MOVE BORM-LOAN-BAL
SC4954                                     TO YOUBE-27-PRIN-CRE-AMT
SC4954                  ELSE
SC4954                     MOVE 0 TO YOUBE-27-PRIN-CRE-AMT
SC4954                  END-IF
SC4954                  PERFORM E010-WRITE-NON-FINANCIAL THRU E019-EXIT
SC5121                  END-IF
SC8291*                 MULTIPLY -1 BY WA-GLCC-XFER-AMOUNT
SC3121               END-IF
085350               MOVE BORP-CGL-COMPONENT-1-DR TO
085360                                WA-SAVE-COMPONENT-1
085370               MOVE BORP-CGL-COMPONENT-2-DR TO
085380                                WA-SAVE-COMPONENT-2
085390               PERFORM Z500-GLCC-TRANSFER-PROCESS THRU
085400                       Z599-EXIT
085410               IF  WA-MSG-ERR-FLAG = 1
085420                   PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
085430                   GO TO E099-EXIT
085440               ELSE
085450                   NEXT SENTENCE
085460        ELSE
085470           IF WA-ACCT-BAL-BEF-TXN < 0
SC4954           COMPUTE YOUBE-PREV-TEMP-BAL = WA-ACCT-BAL-BEF-TXN * -1
SC5121              IF BORP-YOUBE
NR2001*SC5121                 INITIALIZE BORV-27-DETAIL
NR2001                 INITIALIZE BOCT-TRAN-27
SC4954                 COMPUTE YOUBE-27-TEMP-AMT =
SC4954                               ( WA-ACCT-BAL-BEF-TXN
SC4954                                 - BORM-LOAN-BAL ) * -1
SC4954                   COMPUTE YOUBE-TEMP-BAL =
                                 YOUBE-PREV-TEMP-BAL - YOUBE-27-TEMP-AMT
SC4954                 MOVE 0    TO YOUBE-27-PRIN-CRE-AMT
SC5121                 PERFORM E010-WRITE-NON-FINANCIAL
SC5121                                      THRU E019-EXIT
SC8745*****NO NEED TO GENERATE GLIF IF LOAN BAL SIGN IS NOT CHANGE
SC6855*                 COMPUTE WA-GLCC-XFER-AMOUNT =
SC6855*                                 WA-SIGNED-TXN-AMOUNT * -1
SC6855*                 MOVE BORP-CGL-COMPONENT-1-DR TO
SC6855*                                WA-SAVE-COMPONENT-1
SC6855*                 MOVE BORP-CGL-COMPONENT-2-DR TO
SC6855*                                WA-SAVE-COMPONENT-2
SC6855*                 PERFORM Z500-GLCC-TRANSFER-PROCESS THRU
SC6855*                         Z599-EXIT
SC6855*                 IF WA-MSG-ERR-FLAG = 1
SC6855*                    PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
SC6855*                    GO TO E099-EXIT
SC6855*                 END-IF
SC5121              END-IF
085480              NEXT SENTENCE
085490           ELSE
TB0159              IF BORP-YOUBE
SC8276                 MOVE WA-ACCT-BAL-BEF-TXN TO WA-GLCC-XFER-AMOUNT
SC8276*                IF WA-INPUT-PARAM-TABLE(7) = 1                 
SC8276*                   COMPUTE WA-GLCC-XFER-AMOUNT =               
SC8276*                                            BORM-LOAN-BAL * -1 
SC8276*                ELSE                                           
SC8276*                   MOVE BORM-LOAN-BAL    TO WA-GLCC-XFER-AMOUNT
SC8276*                END-IF                                         
NR2001*SC4954                 INITIALIZE BORV-27-DETAIL
NR2001                 INITIALIZE BOCT-TRAN-27
SC4954                 MOVE BORM-LOAN-BAL TO YOUBE-27-TEMP-AMT
                       COMPUTE  YOUBE-TEMP-BAL = BORM-LOAN-BAL * -1
SC4954                 IF WA-INPUT-PARAM-TABLE(7) NOT = 1
SC8034                 OR WA-INPUT-PARAM-TABLE(5) = 1     
SC4954                    COMPUTE YOUBE-27-PRIN-CRE-AMT =
SC4954                                       WA-ACCT-BAL-BEF-TXN * -1
SC4954                 END-IF
SC4954                 PERFORM E010-WRITE-NON-FINANCIAL THRU E019-EXIT
TB0159              ELSE
085500                 SUBTRACT BORM-LOAN-BAL FROM WA-SIGNED-TXN-AMOUNT
085510                          GIVING WA-GLCC-XFER-AMOUNT
TB0159              END-IF
085520              MOVE BORP-CGL-COMPONENT-1-CR TO
085530                               WA-SAVE-COMPONENT-1
085540              MOVE BORP-CGL-COMPONENT-2-CR TO
085550                               WA-SAVE-COMPONENT-2
085560              PERFORM Z500-GLCC-TRANSFER-PROCESS THRU Z599-EXIT
085570              IF  WA-MSG-ERR-FLAG = 1
085580                  PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
085590                  GO TO E099-EXIT.
085600*
085610* FOLLOWING STATEMENTS MOVED FROM E000 PARA TO HERE.
085620*
085630 E009.
085640     INITIALIZE JNRST-DB-DATA.
085650*
085660     IF  WA-INPUT-PARAM-TABLE(8) = 1
085670         MOVE "Y" TO JNRST-BOR-BACKDATED-FLAG
085680     ELSE
085690         MOVE "N" TO JNRST-BOR-BACKDATED-FLAG.
085700*
085710     MOVE WA-MARG-INT-ACCR-BEFORE TO JNRST-MARG-INT-ACCR-BEFORE.
085720     MOVE WA-MARG-INT-ACCR-AFTER  TO JNRST-MARG-INT-ACCR-AFTER.
085730     MOVE WA-BASE-INT-ACCR-BEFORE TO JNRST-BASE-INT-ACCR-BEFORE.
085740     MOVE WA-BASE-INT-ACCR-AFTER  TO JNRST-BASE-INT-ACCR-AFTER.
085750*
085760     IF  WA-CALL-UT0060-FLAG = "Y"
085770       IF  WA-ERR-MSG-NO NOT = 0
085780         MOVE SOC-OVERRIDE-ENQ-HDR TO JNRST-OVERRIDE-HDR-NO.
085790*
085800* CHANGES TO MOVE COMPLETED.
085810*
085820***  NEXT IF:  CALCULATES  "FID"  ON REPAYMENT AMOUNT.
085830*
085840     GO TO E010-CONTINUE.
085850*    IF WA-DUMMY-FST-ONE = 2
085860*       MOVE 9   TO WA-SOURCE-CODE
085870*    ELSE
085880*       MOVE BORM-SOURCE-CDE TO WA-SOURCE-CODE.
085890*    IF WA-SRCE-CDE-2 NOT = 9
085900*     IF (WA-INPUT-PARAM-TABLE(4) = 1) OR
085910*        (STRT-AREA-TRN-NO = 13032)     OR
085920*        (STRT-AREA-TRN-NO = 13132)
085930*       IF WA-INPUT-PARAM-TABLE(7) = 1
085940*          COMPUTE WA-AMOUNT-STORE = WA-REPAY-AMOUNT * -1
085950*          COMPUTE WA-FEE-STORE ROUNDED = WA-AMOUNT-STORE *
085960*                                   SOC-TAX-RATE / 100
085970*          ADD WA-FEE-STORE TO BORM-FEE
085980*       ELSE MOVE WA-REPAY-AMOUNT TO WA-AMOUNT-STORE
085990*            COMPUTE WA-FEE-STORE ROUNDED = WA-AMOUNT-STORE *
086000*                                   SOC-TAX-RATE / 100
086010*            ADD WA-FEE-STORE TO BORM-FEE.
086020*    IF BORP-ACCRUE-METHOD = "4"
086030*      IF BORM-LOAN-BAL NOT = WA-STORE-LN-BAL-IN
086040*        IF WA-INPUT-PARAM-TABLE(8) = 1
086050*          MOVE WA-STORE-TXN-DT TO BORM-IR-ACTIVITY
086060*        ELSE
086070*          MOVE STRT-AREA-POST-DT TO BORM-IR-ACTIVITY.
086080*    IF BORP-ACCRUE-METHOD = "2"
086090*      IF BORM-EOM-BASIC-BAL NOT = WA-STORE-EOM-BAS-IN
086100*        IF WA-INPUT-PARAM-TABLE(8) = 1
086110*          MOVE WA-STORE-TXN-DT TO BORM-IR-ACTIVITY
086120*        ELSE
086130*          MOVE STRT-AREA-POST-DT TO BORM-IR-ACTIVITY.
086140*    IF BORP-ACCRUE-METHOD = "3"
086150*      IF BORM-EOY-BASIC-BAL NOT = WA-STORE-EOY-BAS-IN
086160*        IF WA-INPUT-PARAM-TABLE(8) = 1
086170*          MOVE WA-STORE-TXN-DT TO BORM-IR-ACTIVITY
086180*        ELSE
086190*          MOVE STRT-AREA-POST-DT TO BORM-IR-ACTIVITY.
086200*    IF  (STRT-AREA-TRN-NO = 10071 OR 15071)
086210*        PERFORM L100-VALIDATE-INPUT THRU L199-EXIT.
086220*
086230***  NEXT IF:  CALCULATES  "SD"  AND  "BADT" ON CHEQUE
086240*
086250*    IF 1 = WA-INPUT-PARAM-TABLE(5) AND WA-INPUT-PARAM-TABLE(10)
086260*       PERFORM E270-CALC-SD-AND-BADT THRU E279-EXIT.
086270 E010-CONTINUE.
SC9610**BACKDATE CORRECTION TXN BYPASS E300 ALREADY INITIATED BEFORE CALL BR-23/24
SC9610     IF  ST-LOAN-BACKDATED-CORR-YES
SC9610         AND WA-CAST-LOCK-FLAG = 0
SC9610         CONTINUE
SC9610     ELSE
086280     IF  WA-INPUT-PARAM-TABLE(14) = 1
086290         PERFORM E300-TELLER-TOT-PARA
086300            THRU E399-EXIT
086310         IF  WA-MSG-ERR-FLAG = 1
086320             GO TO E099-EXIT.
086330     IF WA-DUMMY-FST-ONE = 2 OR CHECK-POSTED-TO-SUSP
086340         PERFORM E200-JRNL-RESTART-PARA THRU E299-EXIT
086350         IF  WA-MSG-ERR-FLAG = 1
086360             PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
086370             GO TO E099-EXIT
086380         ELSE
086390             NEXT SENTENCE
086400     ELSE
086410        IF  WA-INPUT-PARAM-TABLE(15) = 1
S11778        OR  STRT-AREA-TRN-NO = 17047
086420            PERFORM W600-REWRITE-MASTER THRU W699-EXIT
086430            IF  WA-MSG-ERR-FLAG = 1
086440                GO TO E099-EXIT
086450            ELSE
086460               PERFORM E200-JRNL-RESTART-PARA THRU E299-EXIT
086470               IF  WA-MSG-ERR-FLAG = 1
086480                   PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
086490                   GO TO E099-EXIT.
086500*SC2263 IF   STRT-AREA-TRN-NO = 32110
SC2263     IF   STRT-AREA-TRN-NO = 32110 OR 17003
086510         PERFORM W600-REWRITE-MASTER THRU W699-EXIT
086520            IF  WA-MSG-ERR-FLAG = 1
086530                GO TO E099-EXIT.
086540     IF  STRT-AREA-SOC-NO  = SOC-TRAINING-SOCIETY OR
086550         WA-INPUT-PARAM-TABLE(14) = 0
086560         GO TO E099-EXIT.
086580     IF  STRT-BATCH-TRICKLE-TXN OR STRT-SWIFT-TXN
086590*ST0029 OR  STRT-AREA-EFT-TXN
086600     OR  STRT-REPOST-TXN                                                  
086610         GO TO E099-EXIT
086620     END-IF.
086640     MOVE "L" TO WA-WORK-SYSTEM-ID.
086660     IF WA-DUMMY-FST-ONE = 2 OR CHECK-POSTED-TO-SUSP
086670        MOVE "GEN"           TO WA-WORK-SECTION-ID
086680     ELSE
086690        MOVE "BOR"           TO WA-WORK-SECTION-ID.
086710     MOVE WA-WORK-SYSTEM     TO UT0017CA-CALL-SYSTEM.
086730     MOVE WA-EDIT-MASK       TO UT0017CA-CALL-PROCESS-BITS.
086740     MOVE WA-SAVE-TXN-AMT    TO UT0017CA-CALL-AMOUNT.
086750     IF WS-SAVE-TXN-CURRENCY = SOC-NATIVE-CURRENCY
086760        MOVE SPACES          TO UT0017CA-CALL-CURRENCY
086770     ELSE
086780        MOVE WS-SAVE-TXN-CURRENCY TO UT0017CA-CALL-CURRENCY.
086790     CALL "UT0017" USING
086810                         UT0017-CALL-AREA
086820                         STARTAREA.
086830     IF (WA-OUTPUT-ERR-MSG-NO > 99 AND < 900)
086840     OR WA-OUTPUT-ERR-MSG-NO > 999
086850        MOVE 1 TO WA-MSG-ERR-FLAG
086860     END-IF.
086880 E099-EXIT.
086890     EXIT.
SC4954 E010-WRITE-NON-FINANCIAL.
SC4954      IF YOUBE-27-PRIN-CRE-AMT NOT = 0
NR2001*SC4954         INITIALIZE BORV-27-DETAIL
NR2001*SC4954         MOVE 27 TO BORV-27-CODE
NR2001*SC4954         MOVE 0 TO BORV-27-STATUS
NR2001*SC4954         MOVE YOUBE-27-PRIN-CRE-AMT TO BORV-27-AMOUNT
NR2001*SC6878         IF  WA-INPUT-PARAM-TABLE(8) = 1                     
NR2001*SC6878             MOVE WA-REPAY-TXN-DATE  TO UT0030-DATE-DDMMCCYY 
NR2001*SC6878             PERFORM X610-UT0030-PARA THRU X619-EXIT         
NR2001*SC6878             MOVE UT0030-BINARY-DATE TO BORV-27-TRN-DATE     
NR2001*SC6878         ELSE                                                
NR2001*SC4954             MOVE STRT-AREA-POST-DT TO BORV-27-TRN-DATE      
NR2001*SC6878         END-IF                                              
NR2001*SC4954         PERFORM U100-PK-BRANCH-TERM-TELL THRU U199-EXIT
NR2001*SC4954         MOVE UPTELLCA-TELLER-BRANCH TO BORV-27-TELL-AND-BR
NR2001*SC4954*NR0011  MOVE 0                  TO BORV-27-TRN-CODE
NR2001*NR0011         MOVE STRT-AREA-TRN-NO   TO BORV-27-TRN-CODE
NR2001*SC4954         MOVE STRT-AREA-POST-DT  TO BORV-27-POST-DATE
NR2001*SC4954         MOVE STRT-AREA-JRNL-NO  TO BORV-27-JRNL-NO
NR2001*SC4954         MOVE ZEROES             TO BORV-27-CHQ-DAYS
NR2001*SC4954         MOVE ZEROES             TO BORV-27-BALANCE
NR2001*SC4954         MOVE SPACE              TO BORV-27-DAYFILE
NR2001*SC4954         MOVE ZEROES             TO BORV-27-ARREARS
NR2001*SC4954         MOVE STRT-AREA-MSG-TIME TO BORV-27-POST-TIME
NR2001*SC4954         MOVE ZEROES             TO BORV-27-DEFER-DAYS
NR2001*SC4954         MOVE SPACES             TO BORV-27-PROMO-NO
NR2001*SC4954         MOVE STRT-AREA-TERM-NO  TO BORV-27-BRTERM
NR2001         INITIALIZE BOCT-TRAN-27
NR2001         MOVE 27                     TO BOCT-TRAN-TYPE
NR2001         MOVE 0                      TO BOCT-STAT
NR2001         IF  WA-INPUT-PARAM-TABLE(8) = 1                     
NR2001             MOVE WA-REPAY-TXN-DATE  TO UT0030-DATE-DDMMCCYY 
NR2001             PERFORM X610-UT0030-PARA THRU X619-EXIT         
NR2001             MOVE UT0030-BINARY-DATE TO BOCT-TRN-DATE
NR2001         ELSE                                                
NR2001             MOVE STRT-AREA-POST-DT  TO BOCT-TRN-DATE
NR2001         END-IF
NR2001         MOVE STRT-AREA-TRN-NO       TO BOCT-TRN-CODE
NR2001         MOVE YOUBE-27-PRIN-CRE-AMT  TO BOCT-27-AMOUNT
NR2001         MOVE STRT-AREA-MSG-TIME     TO BOCT-27-REPOST-TIME
SC4954         PERFORM W500-ADD-TXN THRU W599-EXIT
SC4954         IF  WA-MSG-ERR-FLAG = 1
SC4954             GO TO E019-EXIT
SC4954         END-IF
SC4954      END-IF.
NR2001*SC4954      INITIALIZE BORV-27-DETAIL
NR2001*SC4954      MOVE 27 TO BORV-27-CODE
NR2001*SC4954      MOVE 0 TO BORV-27-STATUS
NR2001*SC4954      COMPUTE BORV-01-AMOUNT = YOUBE-27-TEMP-AMT * -1.
NR2001*SC6878      IF  WA-INPUT-PARAM-TABLE(8) = 1                      
NR2001*SC6878          MOVE WA-REPAY-TXN-DATE  TO UT0030-DATE-DDMMCCYY  
NR2001*SC6878          PERFORM X610-UT0030-PARA THRU X619-EXIT          
NR2001*SC6878          MOVE UT0030-BINARY-DATE TO BORV-27-TRN-DATE      
NR2001*SC6878      ELSE                                                 
NR2001*SC4954          MOVE STRT-AREA-POST-DT TO BORV-27-TRN-DATE       
NR2001*SC6878      END-IF.                                              
NR2001*SC4954      PERFORM U100-PK-BRANCH-TERM-TELL THRU U199-EXIT
NR2001*SC4954      MOVE UPTELLCA-TELLER-BRANCH TO BORV-27-TELL-AND-BR
NR2001*SC4954      MOVE 98904              TO BORV-27-TRN-CODE
NR2001*SC4954      MOVE STRT-AREA-POST-DT  TO BORV-27-POST-DATE
NR2001*SC4954      MOVE STRT-AREA-JRNL-NO  TO BORV-27-JRNL-NO
NR2001*SC4954      MOVE ZEROES             TO BORV-27-CHQ-DAYS
NR2001*SC4954      COMPUTE BORV-27-BALANCE = YOUBE-TEMP-BAL
NR2001*SC4954      MOVE SPACE              TO BORV-27-DAYFILE
NR2001*SC4954      MOVE ZEROES             TO BORV-27-ARREARS
NR2001*SC4954      MOVE STRT-AREA-MSG-TIME TO BORV-27-POST-TIME
NR2001*SC4954      MOVE ZEROES             TO BORV-27-DEFER-DAYS
NR2001*SC4954      MOVE SPACES             TO BORV-27-PROMO-NO
NR2001*SC4954      MOVE STRT-AREA-TERM-NO  TO BORV-27-BRTERM
NR2001      INITIALIZE BOCT-TRAN-27.
NR2001      MOVE 27                     TO BOCT-TRAN-TYPE.
NR2001      MOVE 0                      TO BOCT-STAT.
NR2001      IF  WA-INPUT-PARAM-TABLE(8) = 1                      
NR2001          MOVE WA-REPAY-TXN-DATE  TO UT0030-DATE-DDMMCCYY  
NR2001          PERFORM X610-UT0030-PARA THRU X619-EXIT          
NR2001          MOVE UT0030-BINARY-DATE TO BOCT-TRN-DATE
NR2001      ELSE                                                 
NR2001          MOVE STRT-AREA-POST-DT  TO BOCT-TRN-DATE
NR2001      END-IF.
NR2001      MOVE 98904                  TO BOCT-TRN-CODE.
NR2001      COMPUTE BOCT-27-AMOUNT  = YOUBE-27-TEMP-AMT * -1.
NR2001      COMPUTE BOCT-27-BALANCE = YOUBE-TEMP-BAL.
NR2001      MOVE STRT-AREA-MSG-TIME     TO BOCT-27-REPOST-TIME.
SC4954      PERFORM W500-ADD-TXN THRU W599-EXIT.
SC4954      IF  WA-MSG-ERR-FLAG = 1
SC4954          GO TO E019-EXIT
SC4954      END-IF.
SC4954 E019-EXIT.
SC4954      EXIT.
TB0266*------------------- 
TB0266 E020-VOUCHER-PRINT.
TB0266*-------------------
ST0038     IF WA-OUTPUT-ERR-MSG-NO NOT NUMERIC
ST0038        MOVE 0                 TO WA-OUTPUT-ERR-MSG-NO
ST0038     END-IF
S11650     MOVE ZEROS                TO VCHR077-TEMP-PYMT-DUE.
TB0266*S12215     IF STRT-BANCSLINK
S12215     IF (STRT-BANCSLINK OR
S16871         STRT-DSS-BUNCH-TXN OR
S12215         (STRT-TRICKLE-TXN AND STRT-AREA-TRN-NO = 17003))
TB0266        AND (WA-OUTPUT-ERR-MSG-NO = 998 OR 000 OR 999
ST0055            OR 73)
TB0266        MOVE 02                TO UT0251CA-CALL-CODE
TB0266        MOVE STRT-AREA-SOC-NO  TO UT0251CA-SOC-NO
TB0266        MOVE STRT-AREA-TRN-NO  TO UT0251CA-TRAN-CODE
TB0266        CALL "UT0251"          USING UT0251CA-CALL-AREA
TB0266        IF UT0251CA-CALL-STATUS = "****"
TB0266           AND UT0251RA-VOUCHER-REQ-IND = "Y"
TB0266           IF WA-OUTPUT-ERR-MSG-NO = 998
TB0266              IF STRT-AREA-TRN-NO = WS-VCHR-TRANS
TB0266                 MOVE 2        TO WS-TRIGER-VCTR
TB0266              ELSE
TB0266                 ADD 1         TO WS-TRIGER-VCTR
TB0266              END-IF
TB0266           ELSE
TB0266              MOVE 2           TO WS-TRIGER-VCTR
TB0266           END-IF
TB0266        ELSE
TB0266           MOVE 0              TO WS-VCHR-TRANS
TB0266                                  WS-TRIGER-VCTR
TB0266        END-IF
SC7280        IF STRT-AREA-TRN-NO = 10242
SC7298                              OR 10244 OR 10243
S11789                              OR 10245
SC7280           MOVE 2              TO WS-TRIGER-VCTR
SC7280        END-IF
S11651        IF  STRT-AREA-TRN-NO = 12410
S11651        AND NOT BORP-YOUBE
S11651            MOVE 0             TO WS-VCHR-TRANS
S11651                                  WS-TRIGER-VCTR
S11651        END-IF
SC6542        IF STRT-AREA-TRN-NO = 16046 OR 16146 OR 16057 OR 16157
JJ0033                           OR 17033 OR 17466 OR 17039
S10982                           OR 16049 OR 16149
S11455                           OR 16069 OR 16169
SC6542           MOVE WS-STRT-ORG-INPUT-MSG TO WA-INPUT-MSG
SC6542        END-IF
S10982        IF   STRT-AREA-TRN-NO = 11049 OR 16049 OR 11149 OR 16149
S10982             MOVE "SPCL REF  :"      TO VCHR077-DISCH-PDC(41:11)
S10982             MOVE WA-11049-SRN-NO    TO VCHR077-DISCH-PDC(52:12)
S10982        END-IF
S16235        IF   STRT-AREA-TRN-NO = 13047 OR 15047 OR 13147 OR 15147
S16235             MOVE "SPCL REF  :"      TO VCHR077-DISCH-PDC(41:11)
S16235             MOVE WA-13047-SRN-NO    TO VCHR077-DISCH-PDC(52:12)
S16235        END-IF
S11650        IF BORP-YOUBE AND
S11650           (WS-VCHR-ORG-TRANCODE = 11010 OR 11045 OR 11046 OR
S11650                                   16010 OR 16045 OR 16046)
S11650           MOVE BOIS-TEMP-PAYMENT-DUE TO VCHR077-TEMP-PYMT-DUE
S11787           IF VCHR077-TXN-AMT = VCHR077-TEMP-PYMNT-DR AND
S11787              VCHR077-INT-AMT NOT >  0  AND
S11787              VCHR077-PRINCIPAL-AMT1 NOT > 0
S11787              MOVE ZEROS TO VCHR077-STRT-DATE
S11787                            VCHR077-END-DATE
S11787           END-IF
S11650        END-IF
TB0266        IF WS-TRIGER-VCTR = 2
ST0038           PERFORM E040-FILL-FORM THRU E049-EXIT
TB0266           CALL "UTVCHR" USING
TB0266                               STARTAREA
TB0266                               WA-VOUCHER-EXTENDED-INFO
TB0266                               UT0251CA-CALL-AREA
ST0055                               BORM-RECORD-AREA
TB0266           MOVE STRT-AREA-TRN-NO TO WS-VCHR-TRANS
TB0266           MOVE 0                TO WS-TRIGER-VCTR
TB0266        END-IF
TB0266     END-IF.
SC6828***-- READY TO PRINT VOUCHER IF HAVING INSURANCE PREMIUM --***
S12056     IF WA-INS-FLAG-2 = "Y"
S16871*S12056     AND STRT-BANCSLINK
S16871     AND (STRT-BANCSLINK OR STRT-DSS-BUNCH-TXN)
S12056        MOVE STRT-AREA-DATA      TO WA-SAV-STRT-AREA-DATA
S12056        MOVE WA-INPUT-MSG        TO SAVE-INPUT-MESSAGE
S12056        EVALUATE STRT-AREA-TRN-NO
S12056        WHEN 11055
S12056        WHEN 11155
S12056        WHEN 11057
S12056        WHEN 11157
S15238        WHEN 16057
S15238        WHEN 16055
S15238        WHEN 16157
S15238        WHEN 16155
S12056           MOVE WA-INS-INC-BGL      TO GLDM-LEDGER-NO
S12056                                       DBIO-01-ACCT-NO
S12056           PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT
S12056           IF DBIO-01-RETURN-STATUS NOT = "****"
S12056              DISPLAY "BR0000: (E020) ERROR IN READING GLDM"
S12056                   ", KEY = " DBIO-CALL-KEY-AREA
S12056                   ", STATUS = " DBIO-CALL-STATUS
S12056              MOVE 1   TO WA-MSG-ERR-FLAG
S12056              MOVE 108 TO WA-OUTPUT-ERR-MSG-NO
S12056              GO TO E029-EXIT
S12056           END-IF
S12056
S12056           MOVE WA-INS-STRT-AREA-DATA-2 TO STRT-AREA-DATA
S12056           INITIALIZE WA-INPUT-MSG
S12056           MOVE WA-INS-FROM-ACCT-2    TO WA-20045-FROM-GL-ACCT
S12056           MOVE WA-INS-TO-ACCT-2      TO WA-20045-TO-GL-ACCT
S12056           MOVE WA-INS-TXN-AMT-2      TO WA-20045-TRAN-AMT
S12056                                         WA-20045-ETXN-AMT
S12056
S12056           MOVE 02                    TO UT0251CA-CALL-CODE
S12056           MOVE STRT-AREA-SOC-NO      TO UT0251CA-SOC-NO
S12056           MOVE STRT-AREA-TRN-NO      TO UT0251CA-TRAN-CODE
S12056           CALL "UT0251"              USING UT0251CA-CALL-AREA
S12056           IF UT0251CA-CALL-STATUS = "****"
S12056              AND UT0251RA-VOUCHER-REQ-IND = "Y"
S12056              CALL "UTVCHR" USING
S12056                            STARTAREA
S12056                            WA-VOUCHER-EXTENDED-INFO
S12056                            UT0251CA-CALL-AREA
S12056                            GLDM-RECORD-AREA
S12056           END-IF
S12056        END-EVALUATE
S12056        MOVE WA-SAV-STRT-AREA-DATA TO STRT-AREA-DATA
S12056        MOVE SAVE-INPUT-MESSAGE    TO WA-INPUT-MSG
S12056     END-IF.
SC6828     IF WA-INS-FLAG = "Y"
S16871*SC6828     AND STRT-BANCSLINK
S16871     AND (STRT-BANCSLINK OR STRT-DSS-BUNCH-TXN)
SC9216        MOVE STRT-AREA-DATA      TO WA-SAV-STRT-AREA-DATA
SC9216        MOVE WA-INPUT-MSG        TO SAVE-INPUT-MESSAGE
SC9216        EVALUATE STRT-AREA-TRN-NO
S15238*SC9216        WHEN 16057
S15238*SC9216        WHEN 16157
S11455        WHEN 16069
S11455        WHEN 16169
SC9216             INITIALIZE WA-INPUT-MSG
SC9216             MOVE INPUT-INTERNAL-FORM TO WA-INPUT-MSG
SC9216*S11455      IF STRT-AREA-TRN-NO = 16057
S15238*S11455             IF STRT-AREA-TRN-NO = 16057 OR 16069
S15238             IF STRT-AREA-TRN-NO = 16069
SC9216                MOVE 25045       TO STRT-AREA-TRN-NO
SC9216             ELSE
SC9216                MOVE 25145       TO STRT-AREA-TRN-NO
SC9216             END-IF
SC9216        WHEN OTHER
SC6828           MOVE WA-INS-FROM-ACCT      TO INVM-MEMB-CUST-AC
SC6828           PERFORM B1000-READ-INVM    THRU B1999-EXIT
SC6828           IF DBIO-CALL-STATUS NOT = "****"
SC8001              DISPLAY "BR0000: (E020) ERROR IN READING INVM"
SC8001                   ", KEY = " DBIO-CALL-KEY-AREA
SC8001                   ", STATUS = " DBIO-CALL-STATUS
SC6828              MOVE 1   TO WA-MSG-ERR-FLAG
SC6828              MOVE 108 TO WA-OUTPUT-ERR-MSG-NO
SC6828              GO TO E029-EXIT
SC6828           END-IF
SC6828
SC6828           MOVE WA-INS-STRT-AREA-DATA TO STRT-AREA-DATA
SC6828           INITIALIZE WA-INPUT-MSG
SC6828           MOVE WA-INS-FROM-ACCT      TO W800-FROM-ACCT
SC6828           MOVE WA-INS-TO-ACCT        TO W800-TO-ACCT
SC9216           IF WA-INPUT-PARAM-TABLE(29) = 1
SC9216              AND (STRT-AREA-TRN-NO = 1045 OR 1145)
SC9216              MOVE WA-INS-FROM-ACCT TO W800-TO-ACCT
SC9216              MOVE WA-INS-TO-ACCT   TO W800-FROM-ACCT
SC9216           END-IF
SC6828           MOVE WA-INS-TRF-DATE       TO W800-TRF-DATE
SC6828           MOVE WA-INS-TXN-AMT        TO W800-TRF-AMOUNT
SC9216        END-EVALUATE
SC9216        MOVE 02                    TO UT0251CA-CALL-CODE
SC9216        MOVE STRT-AREA-SOC-NO      TO UT0251CA-SOC-NO
SC9216        MOVE STRT-AREA-TRN-NO      TO UT0251CA-TRAN-CODE
SC9216        CALL "UT0251"              USING UT0251CA-CALL-AREA
SC9216        IF UT0251CA-CALL-STATUS = "****"
SC9216           AND UT0251RA-VOUCHER-REQ-IND = "Y"
SC9216           CALL "UTVCHR" USING
SC9216                         STARTAREA
SC9216                         WA-VOUCHER-EXTENDED-INFO
SC9216                         UT0251CA-CALL-AREA
SC9216                         WA-INVM-RECORD-AREA
SC9216        END-IF
SC6828        MOVE WA-SAV-STRT-AREA-DATA TO STRT-AREA-DATA
SC6828        MOVE WA-SAV-INPUT-MSG      TO WA-INPUT-MSG
SC6828     END-IF.
TB0266 E029-EXIT.
TB0266     EXIT.
TB0266
ST0054 E030-FILL-FORM.
ST0054     IF WS-VCHR-FORM1
ST0054        MOVE WA-INPUT-ACCT-NO      TO VCHR075-LOAN-ACCT-NO
ST0054        MOVE WA-ADV-AMOUNT         TO VCHR075-DB-AMOUNT
ST0054                                      VCHR075-CR-AMOUNT
ST0054        MOVE SPACES                TO VCHR075-LOAN-ACCT-NME
ST0054                                      VCHR075-TRF-ACCT-NME
ST0054                                      VCHR075-NARRATIVE
ST0054        MOVE WA-DEP-ACCT-NO        TO VCHR075-TRF-ACCT-NO
S11323        IF  STRT-AREA-TRN-NO = 11058 OR 11158 OR 16058 OR 16158
S11323            MOVE WA-INPUT-ACCT-NO  TO VCHR075-TRF-ACCT-NO
S11323            MOVE 'INSTALLMENT'     TO VCHR075-TRF-ACCT-NME
S11323        END-IF
S11483        IF STRT-AREA-TRN-NO = 11055
S11483          MOVE SAVE-W800-TO-ACNO     TO VCHR075-VIRTUAL-ACNO
S11483        ELSE
S12770           IF  STRT-AREA-TRN-NO = 11057 OR 16057
S12770           AND BORP-CONSMR
S12770           AND BORP-REORG-CREDIT-PROD
S12770               MOVE  WA-VIR-AC-FOR-REORG-AC
S12770                 TO  VCHR075-VIRTUAL-ACNO
S12770           ELSE
S11483               MOVE 0                TO VCHR075-VIRTUAL-ACNO
S12770           END-IF
S11483        END-IF
ST0054        MOVE BOIS-REV-RECEIVABLE-DUE
ST0054                                   TO VCHR075-REV-RCVBLE
S11993*SC6804        IF BORP-YOUBE AND
S11993*SC6804           (STRT-AREA-TRN-NO = 11060 OR
S11993*SC6804            STRT-AREA-TRN-NO = 11055 OR
S11993*SC6804            STRT-AREA-TRN-NO = 11057 OR
S11993*SC6804            STRT-AREA-TRN-NO = 16055 OR
S11993*S11455            STRT-AREA-TRN-NO = 16068 OR
S11993*S11455            STRT-AREA-TRN-NO = 16069 OR
S11993*S11455            STRT-AREA-TRN-NO = 11068 OR
S11993*S11455            STRT-AREA-TRN-NO = 11069 OR
S11993*S11323            STRT-AREA-TRN-NO = 11058 OR
S11993*S11323            STRT-AREA-TRN-NO = 16058 OR
S11993*SC6804            STRT-AREA-TRN-NO = 16057)
S11993*SC6804           PERFORM E031-SEARCH-AMT-BORV THRU E031-EXIT
S11993*SC6804        END-IF
S11993        MOVE 0 TO VCHR075-REV-RCVBLE
S11993        IF BORP-YOUBE AND WA-INPUT-PARAM-TABLE (5) = 1
S11993           PERFORM VARYING BR0024CA-IX FROM 1 BY 1
S11993           UNTIL BR0024CA-IX > 15
S11993             IF BR0024CA-TXN-CODE(BR0024CA-IX) = 13540 OR 13640
S11993                MOVE BR0024CA-AMOUNT(BR0024CA-IX)
S11993                     TO VCHR075-REV-RCVBLE
S11993             END-IF
S11993           END-PERFORM
S11993        END-IF
ST0054        MOVE BORM-UNEARNED-INT     TO VCHR075-UPFRONT-INT
ST0054        MOVE ZEROES                TO VCHR075-FEE-AMOUNT
ST0054                                      VCHR075-OTHER
ST0054                                      VCHR075-END-DATE
SC6480        PERFORM X710-GET-RATE THRU X719-EXIT
SC6480        MOVE WA-INT-RATE-A TO VCHR075-RATE
ST0054*SC6480 MOVE BORM-STORE-RATE       TO VCHR075-RATE
ST0054        IF WA-ADV-TXN-DATE = ZEROES OR SPACES
ST0054           MOVE STRT-AREA-POST-DT        TO UT0020-BINARY-DATE
ST0054           MOVE 1                        TO UT0020-FUNCTION
ST0054           PERFORM X600-UT0020-PARA THRU X609-EXIT
ST0054           MOVE UT0020-DATE-DDMMCCYY TO VCHR075-START-DATE
ST0054        ELSE
ST0054           MOVE WA-ADV-TXN-DATE       TO VCHR075-START-DATE
SC5673        END-IF
SC5673        MOVE BOIS-MATURITY-DATE    TO UT0020-BINARY-DATE
SC5673        MOVE 1                     TO UT0020-FUNCTION
SC5673        PERFORM X600-UT0020-PARA THRU X609-EXIT
SC5673        MOVE UT0020-DATE-DDMMCCYY TO VCHR075-END-DATE
SC5673        MOVE BORM-MEMB-CUST-AC TO UT0500CA-CUSM-NO
SC5673        MOVE 1                      TO UT0500CA-CALL-CODE
SC5673        PERFORM V500-CALL-UT0500 THRU V599-EXIT
SC5673        IF UT0500RA-CALL-STATUS NOT = 0
SC5673           GO TO E039-EXIT
SC5673        ELSE
SC5673            MOVE UT0500RA-FULL-NAME TO VCHR075-LOAN-ACCT-NME
SC5673        END-IF
SC5673*       IF STRT-AREA-TRN-NO = 11060 OR 11055                        SC6274     
SC6274        IF STRT-AREA-TRN-NO = 11060 OR 11055 OR 11057                          
SC6542                           OR 16057 OR 16055
S11455                           OR 16068 OR 16069
S11455                           OR 11068 OR 11069
SC5673          MOVE NARRATIVE-11045   TO VCHR075-NARRATIVE
SC5673        END-IF
SC6274*SC6279 IF STRT-AREA-TRN-NO = 11057                                  
SC6279*S11455 IF STRT-AREA-TRN-NO = 11057 OR 16057                         
S11455        IF STRT-AREA-TRN-NO = 11057 OR 16057 OR 11069 OR 16069
SC6274           MOVE WA-GLDM-LEDGER-NAME   TO VCHR075-TRF-ACCT-NME        
SC6274        END-IF                                                       
SC5673*SC6276 IF STRT-AREA-TRN-NO = 11055
SC6276*S11455 IF STRT-AREA-TRN-NO = 11055 OR 16055
S11455        IF STRT-AREA-TRN-NO = 11055 OR 16055 OR 11068 OR 16068
S12770                           OR 11063 OR 16063
SC5673          MOVE WA-DEP-ACCT-NO    TO UT0500CA-CUSM-NO
SC5673          MOVE 1                 TO UT0500CA-CALL-CODE
SC5673          PERFORM V500-CALL-UT0500 THRU V599-EXIT
SC5673          IF UT0500RA-CALL-STATUS NOT = 0
SC5673             GO TO E039-EXIT
SC5673          ELSE
SC5673              MOVE UT0500RA-FULL-NAME TO VCHR075-TRF-ACCT-NME
SC5673          END-IF
SC5673        END-IF
SC5673     END-IF.
ST0054
ST0054 E039-EXIT.
ST0054     EXIT.
NR2001*SC6804 E031-SEARCH-AMT-BORV.
NR2001*SC6804     MOVE SPACES   TO DBIO-CALL-PARAM
NR2001*SC6804                      DBIO-CALL-SYS-AREA
NR2001*SC6804                      DBIO-CALL-KEY-AREA
NR2001*SC6804                      DBIO-CALL-STATUS
NR2001*SC6804     MOVE ZERO     TO DBIO-CALL-REFER-AREA
NR2001*SC6804     MOVE 07       TO DBIO-CALL-FUNC
NR2001*SC6804     MOVE "BOR"    TO DBIO-CALL-SYS
NR2001*SC6804     MOVE BORM-KEY TO DBIO-CALL-KEY
NR2001*SC6804     MOVE 01       TO DBIO-CALL-TXN-TYPE
NR2001*SC6804
NR2001*SC6804     MOVE "N"      TO WA-TRN-MATCH-FOUND
NR2001*SC6804
NR2001*SC6804     PERFORM UNTIL WA-TRN-MATCH-FOUND = "Y"
NR2001*SC6804       CALL "DBIO" USING
NR2001*SC6804                   DBIO-CALL-PARAM
NR2001*SC6804                   DBIO-CALL-SYS-AREA
NR2001*SC6804                   DBIO-CALL-KEY-AREA
NR2001*SC6804                   DBIO-CALL-STATUS
NR2001*SC6804                   BORV-RECORD-AREA
NR2001*SC6804                   DBIO-CALL-REFER-AREA
NR2001*SC6804                   DBIO-CALL-TXN-TYPE
NR2001*SC6804       IF (DBIO-CALL-STATUS NOT = "****")
NR2001*SC6804          AND (DBIO-CALL-STATUS  =  "XCOT")
NR2001*SC6804          GO TO E031-EXIT
NR2001*SC6804       END-IF
NR2001*SC6804
NR2001*SC6804       IF BORV-01-JRNL-NO = STRT-AREA-JRNL-NO
NR2001*SC6804          MOVE BORV-01-AMOUNT TO VCHR075-REV-RCVBLE
NR2001*SC6804       ELSE
NR2001*SC6804          MOVE "Y"          TO WA-TRN-MATCH-FOUND
NR2001*SC6804       END-IF
NR2001*SC6804     END-PERFORM.
NR2001*SC6804 E031-EXIT.
NR2001*SC6804      EXIT.
ST0038 E040-FILL-FORM.
ST0038     EVALUATE STRT-AREA-TRN-NO
ST0038     WHEN 17003
ST0038          MOVE UT0073CA-BAD-DEBT-IND-BEFORE
ST0038                                 TO VCHR149-BAD-DEBT-IND-BF
ST0038          MOVE UT0073CA-BAD-DEBT-IND-AFTER
ST0038                                 TO VCHR149-BAD-DEBT-IND-AF
ST0038          MOVE 0                 TO WS-VCHR-CALC-AMT
ST0038          IF (VCHR149-BAD-DEBT-IND-BF = 00 OR 01 OR 50 OR 51
ST0038             AND VCHR149-BAD-DEBT-IND-AF = 52)
ST0038             OR (VCHR149-BAD-DEBT-IND-BF = 02 OR 52 OR 53
ST0038             AND VCHR149-BAD-DEBT-IND-AF = 54)
ST0038             OR (VCHR149-BAD-DEBT-IND-BF = 02 OR 52
ST0038             AND VCHR149-BAD-DEBT-IND-AF = 53)
ST0038             PERFORM VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB > 5
ST0038                IF (VCHR149-BAD-DEBT-IND-BF = 00 OR 01 OR 50 OR 51
ST0038                   AND VCHR149-BAD-DEBT-IND-AF = 52)
ST0038                  IF UT0073CA-GL-BUCKET-CDE(WS-SUB) = "P " OR "I "
ST0038                     ADD UT0073CA-GL-BUCKET-DUE(WS-SUB)
ST0038                     TO  WS-VCHR-CALC-AMT
ST0038                  END-IF
ST0038                END-IF
ST0038                IF (VCHR149-BAD-DEBT-IND-BF = 02 OR 52 OR 53
ST0038                   AND VCHR149-BAD-DEBT-IND-AF = 54)
ST0038                   OR (VCHR149-BAD-DEBT-IND-BF = 02 OR 52
ST0038                   AND VCHR149-BAD-DEBT-IND-AF = 53)
SC7213                   IF (UT0073CA-GL-BUCKET-CDE(WS-SUB) = 
ST0029                                             "P " OR "I ")
ST0029                     AND (VCHR149-BAD-DEBT-IND-AF = 53)
ST0038                     ADD UT0073CA-GL-BUCKET-DUE(WS-SUB)
ST0029                          TO WS-VCHR-CALC-AMT
ST0029                   ELSE
ST0029                     IF VCHR149-BAD-DEBT-IND-AF = 54
ST0029                        AND UT0073CA-GL-BUCKET-CDE(WS-SUB) = "B"
ST0029                        MOVE UT0073CA-GL-BUCKET-DUE(WS-SUB) TO
ST0029                             WS-VCHR-CALC-AMT
ST0029                     END-IF
ST0038                  END-IF
ST0038                END-IF
ST0038             END-PERFORM
ST0038             COMPUTE WA-DUE-AMT-ROUND ROUNDED = WS-VCHR-CALC-AMT
ST0038             MOVE WA-DUE-AMT-ROUND   TO VCHR149-BAD-DEBT-AMT
S12215             IF STRT-TRICKLE-TXN
S12215                MOVE WA-DUE-AMT-ROUND TO BR0001-BAD-DEBT-AMOUNT
S12215             END-IF
ST0038          END-IF
ST0038     WHEN 17033
ST0038          MOVE 0                 TO WS-VCHR-CALC-AMT
SC9453          IF BOIS-AGREE-IND = 0
S15871*SC9453             AND VCHR151-BF-AGREEMNT-IND = 2
S15871             AND (VCHR151-BF-AGREEMNT-IND = 2 OR 4)
SC9453             ADD BORM-LOAN-BAL
SC9453                 WA-SAVE-AGREE-INT-BUCKET
SC9453                 WA-SAVE-AGREE-ARR-BUCKET
SC9453             TO  WS-VCHR-CALC-AMT
SC9453          ELSE
ST0038             ADD BORM-LOAN-BAL
ST0038                 BOIS-AGREE-INT-BUCKET
ST0038                 BOIS-AGREE-ARR-BUCKET
ST0038             TO  WS-VCHR-CALC-AMT
SC9453          END-IF
ST0038          MOVE WS-VCHR-CALC-AMT  TO VCHR151-INST-AGREEMENT-AMT
SC9216     WHEN 16057
SC9216     WHEN 16157
S11455     WHEN 16069
S11455     WHEN 16169
S15573*SC9216  MOVE "Y"                TO WA-INS-FLAG
S15573         IF   BORM-INS-IND = 2
S15573              MOVE "Y"           TO WA-INS-FLAG
S15573         END-IF
SC9216         MOVE WA-INPUT-MSG       TO INPUT-INTERNAL-FORM
SC9216         MOVE WA-DEP-ACCT-NO     TO WA-25045-FROM-ACCT
SC9216         MOVE WA-ADV-AMOUNT      TO WA-25045-AMOUNT
SC9216         MOVE WA-ADV-ACCT-NO     TO WA-25045-TO-ACCT
SC9216         MOVE WA-ADV-TXN-DATE    TO WA-25045-DATE
SC9216         MOVE W800-CORR-JRNL-NO  TO WA-25045-CORR-JRNL
ST0038     END-EVALUATE.
SC8298*SC9292     IF BORM-STAT = 50
SC8298*SC9292        AND UT0094CA-MATURED-SWITCH = 1
SC8298*SC9292        MOVE ZEROS           TO VCHR077-REV-RECEIVABLE
SC8298*SC9292                                VCHR077-LEGAL-FEE1-DUE
SC8298*SC9292                                VCHR077-TEMP-RECEIVABLE
SC8298*SC9292                                VCHR077-LEGAL-FEE2-DUE
SC8298*SC9292                                VCHR077-TEMP-PYMNT-DR
SC8298*SC9292                                VCHR077-INT-AMT
SC8298*SC9292                                VCHR077-PRINCIPAL-AMT1
SC8298*SC9292                                VCHR077-PRINCIPAL-AMT2
SC8298*SC9292                                VCHR077-TEMP-PYMNT-CR
SC8298*SC9292                                VCHR077-PENALTY
SC8298*SC9292                                VCHR077-DAYS
SC8298*SC9292                                VCHR077-RATE
SC8298*SC9292                                VCHR077-TERM
SC8298*SC9292                                VCHR077-DUE-DAYS
SC8298*SC9292                                VCHR077-MISC-FEE1
SC8298*SC9292                                VCHR077-MISC-INCOME
SC8298*SC9292                                VCHR077-MISC-FEE2
SC8298*SC9292                                VCHR077-PRINCIPAL-AMT
SC8298*SC9292     END-IF.
ST0038 E049-EXIT.
ST0038     EXIT.
086910 E050-CHECK-EPIP.
086930***  ------------------------------------------------------
086940***  READ EPIP FOR THE ERROR WHICH HAS BEEN SET. IF THE
086950***  EPIP POSTING INSTRUCTION = "S" THEN THE TRANSACTION IS
086960***  TO BE POSTED TO THE SUSPENSE ACCT AS INDICATED IN EPIP
086970***  ------------------------------------------------------
086990     MOVE 02                     TO UTEPIPCA-CALL-CODE.
087000     MOVE STRT-AREA-SOC-NO       TO UTEPIPCA-CALL-SOC-NO.
087010     MOVE WA-OUTPUT-ERR-MSG-NO   TO UTEPIPCA-CALL-ERROR-NO.
087020*
087030     IF STRT-TRICKLE-TXN
087040        MOVE "Y"                 TO UTEPIPCA-CALL-TRAN-SOURCE
087050     ELSE
087060     IF WA-OVER-RIDE = "DD" OR "DI"
087070        MOVE "D"                 TO UTEPIPCA-CALL-TRAN-SOURCE
087080     ELSE IF WA-OVER-RIDE = "DC"
087090        MOVE "U"                 TO UTEPIPCA-CALL-TRAN-SOURCE
087100     ELSE IF STRT-AREA-EFT-TXN
087110        MOVE "A"                 TO UTEPIPCA-CALL-TRAN-SOURCE
087120     ELSE IF STRT-AREA-ADVICE
087130        MOVE "F"                 TO UTEPIPCA-CALL-TRAN-SOURCE
087140     ELSE
087150        MOVE STRT-AREA-BATCH-TANDEM
087160                                 TO UTEPIPCA-CALL-TRAN-SOURCE.
087180     MOVE 0                      TO UTEPIPCA-CALL-STATUS
087190                                    UTEPIPCA-CALL-INDEX.
087210     PERFORM Z5200-RETRIEVE-EPIP THRU Z5299-EXIT.
087230     IF UTEPIPCA-CALL-STATUS NOT = ZERO
087240        GO TO E059-EPIP-EXIT.
087260     MOVE "Y"                    TO WA-ACCESS-EPIP.
087280     IF EPIP-POSTING-INSTRUCTION NOT = "S"
087290        GO TO E059-EPIP-EXIT.
087310     PERFORM P000-GET-SUSP-ACCT THRU P099-EXIT.
087330 E059-EPIP-EXIT.
087340     EXIT.
087350/
087360 E060-WRITE-REFERRALS.
087380***  ---------------------------------------------------------
087390***  A RECORD IS TO BE WRITTEN TO OLRR IF:
087400***    1. THE TRANSACTION REJECTED AND THE EPIP-REFER-FLAG
087410***       FOR THAT ERROR = "Y"
087420***    2. THE TRANSACTION WAS POSTED TO SUSPENSE AND THE EPIP-
087430***       REFER-FLAG FOR THE ORIGINAL ERROR = "Y" OR
087440***    3. THE TRANSACTION POSTED TO THE ACCOUNT OK, AND 1 OR
087450***       MORE ERRORS WERE OVERRIDDEN (AS PER EPIP-POSTING-
087460***       INSTRUCTION) AND THE EPIP-REFER-FLAG FOR AT LEAST
087470***       ONE OF THOSE ERRORS WAS SET TO "Y".
087480***  ---------------------------------------------------------
087500     IF WA-MSG-ERR-FLAG = 1
087510        IF WA-ACCESS-EPIP = "Y"
087520           IF EPIP-REFER-FLAG = "Y"
087530              GO TO E060-OLRR.
087550     IF WA-MSG-ERR-FLAG NOT = 1
087560        IF CHECK-POSTED-TO-SUSP
087570           IF EPIP-REFER-FLAG = "Y"
087580              GO TO E060-OLRR
087590           ELSE
087600              NEXT SENTENCE
087610        ELSE
087620           IF WA-CALL-UT0060-FLAG = "Y"
087630              IF W300-TELLER-ERROR-OVERRIDE(1) NOT = SPACES
087640                 MOVE "N" TO WA-OLRR-FLAG
087650                 PERFORM E070-CHECK-OVERRIDES THRU E079-EXIT
087660                 IF WA-OLRR-FLAG = "Y"
087670                    GO TO E060-OLRR.
087690     GO TO E069-EXIT.
087710 E060-OLRR.
087730     IF WA-MSG-ERR-FLAG NOT = 1
087740        GO TO E060-CONT.
087760***  -------------------------------------------------------
087770***  IF A TXN HAS REJECTED THEN A ROLLBACK MUST BE PERFORMED
087780***  BEFORE THE OLRR RECORD CAN BE COMMITTED TO THE DATABASE
087790***  -------------------------------------------------------
087810     MOVE 26                       TO WA-COMROL-CALL-CODE.
087830     CALL "DBIO" USING
087840                                      WA-COMROL-PARAM
087850                                      WA-COMROL-SYSTEM
087860                                      WA-COMROL-ACCT-NO
087870                                      WA-COMROL-STATUS.
087890     IF  WA-COMROL-STATUS NOT = "****"
087900         MOVE SPACES TO UT8500CA-INPUT-MSG
087910         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
087920         STRING "BR0000 (E060) : ROLLBACK FAILURE "
087930                 "STAT- " WA-COMROL-STATUS " ACCT "
087940                WA-INPUT-ACCT-NO " EPIP KEY " EPIP-KEY
087950             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
087960         CALL "UT8500" USING
087970                                      UT8500CA-AREA
087980         MOVE 155                  TO WA-OUTPUT-ERR-MSG-NO
087990         GO TO E069-EXIT.
088010 E060-CONT.
088030     MOVE 2                        TO UTOLRRCA-CALL-CODE.
088040     MOVE 0                        TO UTOLRRCA-CALL-STATUS
088050                                      UTOLRRCA-CALL-MSG-NO
088060                                      UTOLRRCA-CALL-KEY-NO.
088080     IF WA-MSG-ERR-FLAG = 1
088090        MOVE WA-OUTPUT-ERR-MSG-NO  TO UTOLRRCA-ERROR-NO
088100        MOVE EPIP-POSTING-INSTRUCTION
088110                                   TO UTOLRRCA-ERROR-POST-IND
088120     ELSE
088130        IF CHECK-POSTED-TO-SUSP
088140           MOVE CHECK-RESPONSE-ERR-NO TO UTOLRRCA-ERROR-NO
088150           MOVE EPIP-POSTING-INSTRUCTION
088160                                   TO UTOLRRCA-ERROR-POST-IND
088170        ELSE
088180           MOVE W300-TELLER-ERROR-CODE(WA-TELLER-ERROR-CTR)
088190                                   TO UTOLRRCA-ERROR-NO
088200           MOVE W300-TELLER-ERROR-OVERRIDE(WA-TELLER-ERROR-CTR)
088210                                  TO WA-ERROR-OVERRIDE
088220           MOVE WA-POSTING-INSTRUCTION
088230                                   TO UTOLRRCA-ERROR-POST-IND.
088250     MOVE STRT-AREA-SOC-NO         TO UTOLRRCA-INST-NO.
088260     MOVE STRT-AREA-POST-DT        TO UT0020-BINARY-DATE.
088270     MOVE 2                        TO UT0020-FUNCTION.
088290     CALL "UT0020" USING
088310                                      UT0020-FUNCTION
088320                                      UT0020-DATE-AREA
088330                                      UT0020-BINARY-DATE.
088350     MOVE UT0020-DATE-CCYYMMDD     TO UTOLRRCA-CCYYMMDD
088360                                      UTOLRRCA-POST-DATE
088370                                      UTOLRRCA-TRAN-DATE.
088380     MOVE WA-STORE-TXN-DT          TO UT0020-BINARY-DATE.
088390     MOVE 2                        TO UT0020-FUNCTION.
088410     CALL "UT0020" USING
088430                                      UT0020-FUNCTION
088440                                      UT0020-DATE-AREA
088450                                      UT0020-BINARY-DATE.
088470     IF UT0020-DATE-CCYYMMDD NOT = 99999999
088480        MOVE UT0020-DATE-CCYYMMDD  TO UTOLRRCA-TRAN-DATE.
088500     MOVE STRT-AREA-MSG-TIME       TO UTOLRRCA-HHMMSSHS.
088520     IF WA-OVER-RIDE = "DD" OR "DI"
088530        MOVE "D"                 TO UTEPIPCA-CALL-TRAN-SOURCE
088540     ELSE IF WA-OVER-RIDE = "DC"
088550        MOVE "U"                 TO UTEPIPCA-CALL-TRAN-SOURCE
088560     ELSE IF STRT-BATCH-TRICKLE-TXN OR STRT-SWIFT-TXN
088570        MOVE STRT-AREA-BATCH-TANDEM TO UTOLRRCA-TRAN-SRC
088580     ELSE IF STRT-AREA-EFT-TXN
088590        MOVE "A"                   TO UTOLRRCA-TRAN-SRC
088600     ELSE
088610        MOVE "F"                   TO UTOLRRCA-TRAN-SRC.
088630     IF CHECK-POSTED-TO-SUSP
088640        MOVE WA-SUSP-HOME-BR       TO UTOLRRCA-ACCOUNT-HOME-BR-NO
088650        MOVE WA-SUSP-ACCT-NO       TO UTOLRRCA-ACCOUNT-NO
088660                                      UT0730CA-ACCOUNT-NO
088670        MOVE WA-SUSP-TYPE-CURRENCY TO UTOLRRCA-ACCOUNT-CURRENCY
088680        MOVE WA-SUSP-CUST-NO       TO UT0730CA-CUSTOMER-NO
088690     ELSE
088700        MOVE BORM-BR-NO            TO UTOLRRCA-ACCOUNT-HOME-BR-NO
088710        MOVE WA-INPUT-ACCT-NO      TO UTOLRRCA-ACCOUNT-NO
088720                                      UT0730CA-ACCOUNT-NO
088730        MOVE BORM-CURRENCY-IND     TO UTOLRRCA-ACCOUNT-CURRENCY
088740        MOVE BORM-CUSTOMER-NO      TO UT0730CA-CUSTOMER-NO.
088750*
088760***  CALL UT0730 TO GET THE RELATIONSHIP MANAGER
088770*
088780     MOVE 0                        TO UT0730CA-CALL-STATUS.
088790     MOVE 01                       TO UT0730CA-CALL-CODE.
088800     MOVE STRT-AREA-SOC-NO         TO UT0730CA-INST-NO.
088810     MOVE "LON"                    TO UT0730CA-SYS.
088830     CALL "UT0730" USING
088850                                      UT0730-CALL-AREA.
088870     IF UT0730CA-CALL-STATUS NOT = "****" AND "RCNF" AND "MRNF"
088880        MOVE 1                    TO WA-MSG-ERR-FLAG
088890        MOVE 155                  TO WA-OUTPUT-ERR-MSG-NO
088900        MOVE "RELM"               TO WA-DBERR-DATA-SET
088910        MOVE UT0730CA-CALL-STATUS TO WA-DB-ERROR
088920        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
088930        MOVE SPACES               TO UT8500CA-INPUT-MSG
088940        STRING "BR0000:(E060) 'RELM' READ ERROR, STAT - "
088950                UT0730CA-CALL-STATUS
088960               " " UT0730CA-CALL-CODE
088970               " " UT0730CA-ACCOUNT-NO " " UT0730CA-CUSTOMER-NO
088980           DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
088990        CALL "UT8500" USING
089010                                     UT8500CA-AREA
089020        GO TO E069-EXIT.
089040     IF UT0730CA-CALL-STATUS = "RCNF" OR "MRNF"
089050        MOVE 0                     TO UTOLRRCA-ACCOUNT-MANAGER
089060     ELSE
089070        MOVE UT0730RA-REL-MGR      TO UTOLRRCA-ACCOUNT-MANAGER.
089090     MOVE STRT-AREA-BRANCH         TO UTOLRRCA-TRANSACTING-BR-NO.
089100     MOVE "BOR"                    TO UTOLRRCA-ACCOUNT-SYS.
089120     IF CHECK-POSTED-TO-SUSP
089130        MOVE WA-GL-AMOUNT          TO UTOLRRCA-AMOUNT
089140     ELSE
089150        MOVE WA-INPUT-AMT          TO UTOLRRCA-AMOUNT.
089170     MOVE WA-MULTI-CURR-AMT-CURR-CD TO UTOLRRCA-AMOUNT-CURRENCY.
089180     MOVE 0                        TO UTOLRRCA-CHEQUE-NO.
089190     MOVE WA-OVER-RIDE             TO UTOLRRCA-PROMO-NO.
089210     IF CHECK-POSTED-TO-SUSP
089220        MOVE WA-SUSP-TRAN-CODE     TO UTOLRRCA-ORIG-TRAN-CODE
089230        MOVE WA-SUSP-STARTAREA     TO UTOLRRCA-ORIG-TXN-DETAILS
089240     ELSE
089250        MOVE STRT-AREA-TRN-NO      TO UTOLRRCA-ORIG-TRAN-CODE
089260        MOVE STARTAREA             TO UTOLRRCA-ORIG-TXN-DETAILS.
089280     IF WA-MSG-ERR-FLAG = 1
089290        IF EPIP-POSTING-INSTRUCTION = "S"
089300***        (POSTING TO SUSPENSE FAILED)
089310           MOVE "E"                TO UTOLRRCA-POSTING-IND
089320           MOVE 0                  TO UTOLRRCA-SUSP-ACCT-NO
089330                                      UTOLRRCA-POSTING-TRACER-NO
089340           MOVE STRT-AREA-TRN-NO   TO UTOLRRCA-POSTING-TRAN-CODE
089350           MOVE WA-OUTPUT-ERR-MSG-NO TO UTOLRRCA-POSTING-ERROR-NO
089360        ELSE
089370***        (REJECTED, NO SUSPENSE POSTING REQUIRED)
089380           MOVE SPACE              TO UTOLRRCA-POSTING-IND
089390           MOVE 0                  TO UTOLRRCA-SUSP-ACCT-NO
089400                                      UTOLRRCA-POSTING-TRACER-NO
089410                                      UTOLRRCA-POSTING-TRAN-CODE
089420           MOVE WA-OUTPUT-ERR-MSG-NO TO UTOLRRCA-POSTING-ERROR-NO
089430     ELSE
089440        IF CHECK-POSTED-TO-SUSP
089450***        (POSTED TO SUSPENSE OK)
089460           MOVE "S"                TO UTOLRRCA-POSTING-IND
089470           MOVE WA-INPUT-ACCT-NO   TO UTOLRRCA-SUSP-ACCT-NO
089480           MOVE STRT-AREA-JRNL-NO  TO UTOLRRCA-POSTING-TRACER-NO
089490           MOVE STRT-AREA-TRN-NO   TO UTOLRRCA-POSTING-TRAN-CODE
089500           MOVE 0                  TO UTOLRRCA-POSTING-ERROR-NO
089510        ELSE
089520***        (POSTED TO CUSTOMER ACCOUNT OK, ERRORS WERE OVERRIDDEN)
089530           MOVE "A"                TO UTOLRRCA-POSTING-IND
089540           MOVE 0                  TO UTOLRRCA-SUSP-ACCT-NO
089550           MOVE STRT-AREA-JRNL-NO  TO UTOLRRCA-POSTING-TRACER-NO
089560           MOVE STRT-AREA-TRN-NO   TO UTOLRRCA-POSTING-TRAN-CODE
089570           MOVE 0                  TO UTOLRRCA-POSTING-ERROR-NO.
089590     MOVE SPACES                   TO UTOLRRCA-ACTION.
089600     MOVE 0                        TO UTOLRRCA-ACTION-STATUS
089610                                      UTOLRRCA-ACTION-DATE
089620                                      UTOLRRCA-ACTION-BR-NO
089630                                      UTOLRRCA-ACTION-BR-TERM-NO
089640                                      UTOLRRCA-ACTION-TELL-NO
089650                                      UTOLRRCA-DISHONOUR-REASON.
089670     CALL "UTOLRR" USING
089690                                      UTOLRRCA-CALL-AREA
089700                                      UTOLRRCA-CALL-OLRR-AREA.
089720     IF UTOLRRCA-CALL-STATUS NOT = 0
089730        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
089740        MOVE SPACES TO UT8500CA-INPUT-MSG
089750        MOVE UTOLRRCA-ERROR-NO     TO WA-OLRR-ERROR
089760        STRING "BR0000:(E060) INVALID RET STATUS UTOLRR "
089770                UTOLRRCA-CALL-STATUS " ERR "
089780                UTOLRRCA-CALL-MSG-NO
089790                " KEY " UTOLRRCA-KEY " " UTOLRRCA-TRAN-SRC
089800                " " WA-OLRR-ERROR " " UTOLRRCA-ERROR-POST-IND
089810                " ACCT " UTOLRRCA-ACCOUNT-NO " TRAN "
089820                WA-STORE-TRN-NO
089830            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
089840        CALL "UT8500" USING
089860                                      UT8500CA-AREA
089870        MOVE 155                   TO WA-OUTPUT-ERR-MSG-NO
089880        MOVE 1                     TO WA-MSG-ERR-FLAG
089890        GO TO E069-EXIT.
089910***  ----------------------------------------------------------
089920***  FOR REJECTED TRANSACTIONS WHICH HAVE BEEN LOGGED TO OLRR
089930***  SUCCESSFULLY, A COMMIT WILL BE PERFORMED HERE. THIS IS
089940***  REQUIRED BECAUSE THE OUTPUT-ERR-MSG-NO CONTAINS THE ERROR
089950***  NO OF THIS TRANSACTION AND THEREFORE ININTER WILL ROLLBACK
089960***  IE. THE ONLY TABLE TO BE UPDATED IS OLRR
089970***  ----------------------------------------------------------
089990     IF WA-MSG-ERR-FLAG NOT = 1
090000        GO TO E069-EXIT.
090020     MOVE 25                       TO WA-COMROL-CALL-CODE.
090040     CALL "DBIO" USING
090060                                      WA-COMROL-PARAM
090070                                      WA-COMROL-SYSTEM
090080                                      WA-COMROL-ACCT-NO
090090                                      WA-COMROL-STATUS.
090110     IF  WA-COMROL-STATUS NOT = "****"
090120         MOVE SPACES TO UT8500CA-INPUT-MSG
090130         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
090140         STRING "BR0000 (E060) : COMMIT FAILURE "
090150                 "STAT- " WA-COMROL-STATUS " ACCT "
090160                WA-INPUT-ACCT-NO " EPIP KEY " EPIP-KEY
090170             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
090180         CALL "UT8500" USING
090190                                      UT8500CA-AREA
090200         MOVE 155                  TO WA-OUTPUT-ERR-MSG-NO.
090220 E069-EXIT.
090230     EXIT.
090240/
090250 E070-CHECK-OVERRIDES.
090270***  CHECK THE 2ND BYTE OF THE OVERRIDE IN EACH OF THE 10
090280***  OCCURRENCES IN THE ERROR AREA. THIS WILL CONTAIN THE
090290***  EPIP-REFER-FLAG FOR THE OVERRIDDEN ERROR - WHICH WAS
090300***  SET UP IN THE CALL TO UT0060
090310***  IF ANY OF THE REFER-FLAGS = Y THEN AN OLRR RECORD IS REQD
090330     MOVE 1                          TO WA-TELLER-ERROR-CTR.
090350 E070-LOOP.
090370     MOVE W300-TELLER-ERROR-OVERRIDE(WA-TELLER-ERROR-CTR)
090380                                     TO WA-ERROR-OVERRIDE.
090400     IF WA-REFER-FLAG = "Y"
090410        MOVE "Y"                     TO WA-OLRR-FLAG
090420        GO TO E079-EXIT.
090440     ADD 1                           TO WA-TELLER-ERROR-CTR.
090460     IF WA-TELLER-ERROR-CTR < 11
090470        GO TO E070-LOOP.
090490 E079-EXIT.
090500     EXIT.
090510/
090520 E100-FMT-SEND-PARA.
090530******************************************************************
090540*
090550*    CALL THE TRACKING FACILITY CONTROL MODULE
090560*
090570*    ULTIMATELY SHOULD BE INCLUDED IN ALL MODULES IMMEDIATELY
090580*    BEFORE CALLS TO FT0000
090590*
TB0212***
TB0212*** No need to Update EFTM table for a financial transaction during reposting
TB0212***
TB0212*    IF  ((STRT-TRAD-STOCK                                  ST0153
TB0212*     OR STRT-MORTGAGE-TXN                                  ST0153
TB0212*     OR STRT-STOCK-TXN                                     ST0153
ST0153
TB0212      IF ((STRT-REPOST-TXN
TB0212      OR STRT-BATCH-TRICKLE-TXN)
141670      AND WA-MSG-ERR-FLAG = 0)
141680         GO TO E199-EXIT.
SC3409***  UPDATE THE EFTM RECORD WHEN THE CORRECTION TRANSACTION WAS SUCCESSFU+
SC3409     IF  (STRT-INT-VALID-FLAG4            AND
SC3409          (WA-INPUT-PARAM-TABLE(23) = 0   OR
SC3409           WA-INPUT-PARAM-TABLE(30) = 1) AND
SC3409           WA-MSG-ERR-FLAG = 0)
SC3409           IF WA-INPUT-PARAM-TABLE(7) = 1
SC3409              MOVE EFTMTMP-INST-NO       TO EFTMCA-INST-NO
SC3409              MOVE EFTMTMP-CHANNEL-TYPE  TO EFTMCA-CHANNEL-TYPE
SC3409              MOVE EFTM-SEQUENCE-NO      TO EFTMCA-EC-SEQUENCE-NO
SC3409              MOVE EFTMTMP-SEQUENCE-NO   TO EFTMCA-SEQUENCE-NO
SC3409              MOVE EFTMTMP-TERMINAL-DATE TO EFTMCA-TERMINAL-DATE
SC3409              MOVE EFTMTMP-TERMINAL-TIME TO EFTMCA-TERMINAL-TIME
SC3409              MOVE EFTMTMP-TERMINAL-ID   TO EFTMCA-TERMINAL-ID
ST0159              MOVE EFTMTMP-ACCOUNT-NO    TO EFTMCA-ACCOUNT-NO
SC3409              MOVE EFTMTMP-BANCS-JOURNAL-NO TO
SC3409                                   EFTMCA-BANCS-JOURNAL-NO
SC3409              MOVE "N"                   TO EFTMCA-EC-TXN
SC3409              MOVE "Y"                   TO EFTMCA-BE-CORRECTED
SC3409
SC3409              MOVE 2                     TO UTEFTMCA-CALL-CODE
SC3409              CALL "UTEFTM" USING
SC3409                                 UTEFTM-CALL-AREA
SC3409                                 WA-PASSALONG
SC3409              END-CALL
TB0212              IF WA-MSG-ERR-FLAG NOT = 0
TB0212                 MOVE WA-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
TB0212                 GO TO E199-EXIT
S17209              END-IF
SC3409           END-IF
SC3409     END-IF.
090600     IF STRT-AREA-OK-MSG-CNTL-FLAG NOT = SPACE
090610        IF (WA-OUTPUT-ERR-MSG-NO < 100 AND > 0) AND
090620           PBOOKCA-VALID-TYPE
090630           PERFORM E200-PB-LINE-SET-UP THRU E209-EXIT
090640           GO TO E199-EXIT.
090650     IF SOC-LOANS-TRACKING-OPTION = "Y" AND
090660        WA-INPUT-PARAM-TABLE(22) = 1
090670        IF  NOT  STRT-REPOST-TXN                                          
090680            CALL "BR0013" USING
090700                             STARTAREA
090710        END-IF                                                            
090720     ELSE
090730     IF STRT-TRICKLE-TXN
090740        GO TO E199-EXIT
090750*** 760167 BEGIN ***
090760*    THE RESPONSE IS DROPPED IF IT IS AN ATM TRANSACTION ALREADY
090770*    RESPONDED TO BY WAY OF AN ATM REFRESH MESSAGE (INFERRED
090780*    FROM A NON  NULL MREF KEY), OR IF IT IS SWIFT,
090790*    TRICKLE FEED, OR BATCH TRANSACTION.
090800*
090810     ELSE
090820     IF (STRT-AREA-BATCH-TANDEM = "T" OR "S" OR "B")
090830        GO TO E199-EXIT
090840     ELSE
090850     IF (STRT-AREA-EFT-TXN AND WA-MSG-ERR-FLAG = 0)
090860        GO TO E199-EXIT
090870     ELSE
SC5266        IF STRT-AREA-EFT-TXN
SC5266        AND (WA-ORIG-EFT-TRN-NO NOT = STRT-AREA-TRN-NO)
SC5266            MOVE WA-ORIG-EFT-TRN-NO TO STRT-AREA-TRN-NO
SC5266        END-IF
090880        CALL "FT0000" USING
090900                         STARTAREA.
090910 E199-EXIT.
090920     EXIT.
090930/
090940 E200-PB-LINE-SET-UP.
090950     IF PBOOKCA-PB-PRINT
090960        ADD 1 TO PBOOKCA-LINE-CNT
090970        MOVE WA-OUTPUT-MESSAGE TO
090980             PBOOKCA-LINE-MSG (PBOOKCA-LINE-CNT)
090990     END-IF.
091000     IF PBOOKCA-CHQ-PRINT
091010        ADD 1 TO PBOOKCA-CHQ-CNT
091020        MOVE WA-OUTPUT-MESSAGE TO
091030             PBOOKCA-CHQ-MSG (PBOOKCA-CHQ-CNT)
091040     END-IF.
091050     IF PBOOKCA-RCPT-PRINT
091060        ADD 1 TO PBOOKCA-RCPT-CNT
091070        MOVE WA-OUTPUT-MESSAGE TO
091080             PBOOKCA-RCPT-MSG (PBOOKCA-RCPT-CNT)
091090     END-IF.
091100     MOVE SPACE TO PBOOKCA-PRINT-TYPE.
091110 E209-EXIT.
091120     EXIT.
091130/
091140 E1000-PRE-FMT-SEND-PARA.
091150* THE FOLLOWING CODE WAS ADDED TO MAKE THIS PARAGRAPH CONSISTENT
091160* WITH THE CODE IN B099-EXIT PARAGRAPH. UT0460 IS ONLY CALLED FOR
091170* DEPOSIT AND WITHDRAWAL TRANSACTIONS. TRANSACTIONS SUCH AS
091180* 13031 - PRINCIPAL CREDIT DO NOT CURRENTLY SUPPORT MULTI-CURRENCY
091190     IF WA-INPUT-PARAM-TABLE (4) = 1
091200     OR
091210     WA-INPUT-PARAM-TABLE (5) = 1
091220     IF  SOC-MULTI-CURRENCY = "2"
091230*****    IF  (SOC-CURR-CLEARING-IND = "1" OR "2")
091240*****       OR
091250*****            SOC-INTER-BRANCH-IND = "1"
091260              IF  WA-OUTPUT-ERR-MSG-NO = 0 OR 999
091270                  MOVE WA-OUTPUT-ERR-MSG-NO
091280                               TO WA-UT0460-MSG-NO-N
091290                  GO TO E1999-EXIT.
091300     PERFORM  E100-FMT-SEND-PARA  THRU  E199-EXIT.
091310 E1999-EXIT.
091320     EXIT.
091330/
091340 E200-JRNL-RESTART-PARA.
091350     IF  STRT-AREA-SOC-NO = SOC-TRAINING-SOCIETY
091360         GO TO E299-EXIT.
SC5708     IF ((STRT-AREA-TRN-NO = 17050 OR 17000 OR 17036)
SC5708        AND BORM-STAT = 40)
SC5708         GO TO E299-EXIT.
091370     IF WA-DUMMY-FST-ONE = 2
091380        MOVE "GEN"  TO JNRST-SYST
091390     ELSE
091400        MOVE "BOR"  TO JNRST-SYST.
091410* INITIALISE CROSS CURRENCY INDICATOR.
091420     MOVE STRT-AREA-XCURR-IND     TO JNRST-XCURR-IND.
091430* BUILD GLCC BASED ON CUSTOMER SEGMENT CODE.
091440     IF JNRST-SYST = "GEN"
SC7546        IF GLDM-PROFIT-CODE NOT = SPACES
SC7546           MOVE "PC"              TO WA-PROF-CODE-TYPE
SC7546           MOVE GLDM-PROFIT-CODE  TO WA-PROF-CODE-DETAIL
SC7546           MOVE WA-PROF-CODE-NARR TO JNRST-PROFIT-CENTRE-NARR
SC7546        END-IF
S10982        IF   WS-VCHR-ORG-TRANCODE = 11049 OR 16049 OR 11149 OR
S10982                                    16149
S10982             MOVE WA-NARR-TEXT(1:16)  TO JNRST-PROFIT-CENTRE-NARR
S10982        END-IF
091450        MOVE BORM-GL-CLASSIFICATION-CODE TO
091460             W190-GL-CLASS-CODE
091470        MOVE SOC-GL-CLASS-CODE-STRUCTURE TO W190-GL-CODE-STRUCT
091480        PERFORM X100-GLCC-SPLIT THRU
091490                X109-EXIT
091500        MOVE W190-GL-CLASS-CODE(W190-SEG-START:W190-SEG-LEN)
091510             TO WA-SAVE-CUST-SEGMENT
091520        MOVE GLDM-GL-CLASSIFICATION-CODE TO
091530             W190-GL-CLASS-CODE
091540        MOVE SOC-GL-CLASS-CODE-STRUCTURE TO W190-GL-CODE-STRUCT
091550        PERFORM X100-GLCC-SPLIT THRU
091560                X109-EXIT
091570        MOVE W190-GL-CLASS-CODE(W190-BRCH-START:W190-BRCH-LEN)
091580             TO UT0099CA-BRANCH
091590        MOVE W190-GL-CLASS-CODE
091600             (W190-ACT-NBR-START:W190-ACT-NBR-LEN) TO
091610                UT0099CA-COMPONENT-1
091620        MOVE W190-GL-CLASS-CODE(W190-PROD-START:W190-PROD-LEN)
091630             TO UT0099CA-COMPONENT-2
091640        MOVE WA-SAVE-CUST-SEGMENT TO UT0099CA-SEGMENT
091650        MOVE W190-GL-CLASS-CODE(W190-CCY-START:W190-CCY-LEN)
091660             TO UT0099CA-CURRENCY
091670        MOVE W190-GL-CLASS-CODE(W190-GROUP-START:W190-GROUP-LEN)        
091680          TO UT0099CA-GROUP-CODE                                        
091690        MOVE SOC-GL-CLASS-CODE-STRUCTURE
091700             TO UT0099CA-GLCC-STRUCTURE
091710        CALL "UT0099" USING
091730                      UT0099CA-AREA
091740        IF UT0099CA-RETURN-STATUS NOT = 0
091750           MOVE 2083 TO WA-OUTPUT-ERR-MSG-NO
091760           MOVE 1 TO WA-MSG-ERR-FLAG
091770           GO TO E299-EXIT
091780        ELSE
091790           MOVE UT0099CA-GLCC-OUTPUT-KEY
091800                  TO WA-DEST-GL-CLASS-CODE
TB0190         EVALUATE UT28-GLCC-OVERRIDE-IND
TB0190         WHEN 1
TB0190           MOVE UT28-GL-CLASS-CODE1   TO JNRST-GL-CLASS-CODE
TB0190         WHEN 2
TB0190           MOVE UT28-GL-CLASS-CODE2   TO JNRST-GL-CLASS-CODE
TB0190         WHEN OTHER
091810           MOVE WA-DEST-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
TB0190         END-EVALUATE
091820           MOVE UT0120RA-CGL-POSTING-IND TO JNRST-CGL-POSTING-IND
091830     ELSE                                                                 
TB0190      EVALUATE UT28-GLCC-OVERRIDE-IND
TB0190      WHEN 1
TB0190           MOVE UT28-GL-CLASS-CODE1   TO JNRST-GL-CLASS-CODE
TB0190      WHEN 2
TB0190           MOVE UT28-GL-CLASS-CODE2   TO JNRST-GL-CLASS-CODE
TB0190      WHEN OTHER
SC6000*       IF BORP-YOUBE
SC6000*          MOVE WA-SOUR-GL-CLASS-CODE to JNRST-GL-CLASS-CODE
SC6000*       ELSE
091840        MOVE BORM-GL-CLASSIFICATION-CODE TO JNRST-GL-CLASS-CODE
SC6000*       END-IF
SC6000*       IF STRT-ASYNC-TPS
SC6000*          MOVE BORM-GL-CLASSIFICATION-CODE TO JNRST-GL-CLASS-CODE
SC6000*       END-IF
TB0190      END-EVALUATE
091850        MOVE BORP-CGL-POSTING-IND        TO JNRST-CGL-POSTING-IND.
091860*
TB0211     IF STRT-AREA-TRN-NO = 17003
TB0211        IF WA-17003-CORR-TRAN-CD <> 17103
SC4921           IF BORM-BAD-DEBT-IND = 50
S16459           AND (UT0073CA-BAD-DEBT-IND-BEFORE = 52 OR 02)
SC4921              PERFORM NPL-TO-NORMAL-PROCESS
SC4921                 THRU NPL-TO-NORMAL-PROCESS-EXIT
SC4921           END-IF
S11761*TB0211           IF BORM-BAD-DEBT-IND = 52
S11761           IF BORM-BAD-DEBT-IND = 52 OR 02
SC6343            IF UT0073CA-FLAG-53-52 = "Y"
SC6343              CONTINUE
SC6343            ELSE
S15998*SC5843              IF BOIS-921-FLAG > 0
S15998*SC5843                 PERFORM 921-TO-NPL-PROCESS
S15998*SC5843                    THRU 921-TO-NPL-PROCESS-EXIT
S15998*SC5843              ELSE
TB0211                 PERFORM NORMAL-TO-NPL-PROCESS
TB0211                    THRU NORMAL-TO-NPL-PROCESS-EXIT
S15998*SC5843              END-IF
SC6343            END-IF
TB0211           END-IF
SC5014           IF BORM-BAD-DEBT-IND = 53 
SC5014              PERFORM NPL-TO-BAD-DEBT-PROCESS
SC5014                 THRU NPL-TO-BAD-DEBT-PROCESS-EXIT
SC5014           END-IF
SC4701           IF BORM-BAD-DEBT-IND = 54
SC4701              PERFORM FULL-BAD-DEBT-GLIF
SC4701                 THRU FULL-BAD-DEBT-GLIF-EXIT
SC4701           END-IF
S11659           IF BORM-BAD-DEBT-IND = 59
S11659              PERFORM COUNTERFEIT-GLIF
S11659                 THRU COUNTERFEIT-GLIF-EXIT
S11659           END-IF
TB0211        ELSE
SC4921           IF UT0073CA-CORR-IND = 50
SC4921              PERFORM NPL-TO-NORMAL-PROCESS
SC4921                 THRU NPL-TO-NORMAL-PROCESS-EXIT
SC4921           END-IF
SC4696           IF BORM-BAD-DEBT-IND = 00 OR 50 OR 51 OR 01
S15998*SC5843              IF BOIS-921-FLAG > 0
S15998*SC5843                 PERFORM 921-TO-NPL-PROCESS
S15998*SC5843                    THRU 921-TO-NPL-PROCESS-EXIT
S15998*SC5843              ELSE
S16459*S11567                IF (BORM-BAD-DEBT-IND = 00
S16459*S11567                    AND UT0073CA-BAD-DEBT-IND-BEFORE = 51)
S16459                IF (BORM-BAD-DEBT-IND = 00 OR 50)
S16459                AND UT0073CA-BAD-DEBT-IND-BEFORE = 51
S11567                   CONTINUE
S11567                ELSE
TB0211                 PERFORM NORMAL-TO-NPL-PROCESS
TB0211                    THRU NORMAL-TO-NPL-PROCESS-EXIT
S11567                END-IF
S15998*SC5843              END-IF
SC4696           END-IF
SC5014           IF UT0073CA-CORR-IND = 53
SC6343            IF UT0073CA-FLAG-53-52 = "Y"
SC6343              CONTINUE
SC6343            ELSE
SC5014              PERFORM NPL-TO-BAD-DEBT-PROCESS
SC5014                 THRU NPL-TO-BAD-DEBT-PROCESS-EXIT
SC6343            END-IF
SC5014           END-IF
SC5173           IF UT0073CA-CORR-IND = 54
SC5173              PERFORM FULL-BAD-DEBT-GLIF
SC5173                 THRU FULL-BAD-DEBT-GLIF-EXIT
SC5173           END-IF
S11659           IF UT0073CA-CORR-IND = 59
S11659              PERFORM COUNTERFEIT-GLIF
S11659                 THRU COUNTERFEIT-GLIF-EXIT
S11659           END-IF
SC4696        END-IF
              GO TO E299-EXIT
TB0211     END-IF.
SC4680** No more generation of NPL transfer to normal since it is now         
SC4680** required for an account to be normal before set to agree installment.
TB0198*    IF STRT-AREA-TRN-NO = 17033
TB0198**     DISPLAY       "WHOA!!"
TB0198*      IF BR17033-AGREE-IND = 2 AND BOIS-AGREE-NP-FLAG = 0
TB0198*         GO TO E299-EXIT
TB0198*      END-IF
TB0198*
TB0198*      IF BR17033-AGREE-IND = 0 AND BOIS-AGREE-NP-FLAG = 0
TB0198*         GO TO E299-EXIT
TB0198*      END-IF
TB0198*
TB0198*      MOVE "I"        TO WA-AGR-TRANSFER-FLAG
TB0198*      PERFORM TRANSFER-NPL-PROCESS
TB0198*         THRU TRANSFER-NPL-PROCESS-EXIT
TB0198*      IF WA-MSG-ERR-FLAG NOT = 0
TB0198*         GO TO E299-EXIT
TB0198*      END-IF
TB0198*
TB0198*
TB0198*      MOVE "P"        TO WA-AGR-TRANSFER-FLAG
TB0198*      PERFORM TRANSFER-NPL-PROCESS
TB0198*         THRU TRANSFER-NPL-PROCESS-EXIT
TB0198*
TB0198*      GO TO E299-EXIT
TB0198*    END-IF.
SC4680** End of comment.
TB0198
091870     IF STRT-AREA-TRN-NO = 17046
091880          MOVE WA-IN-17046-OLD-BRANCH     TO JNRST-OLD-HOME-BRANCH
091890          MOVE WA-IN-17046-NEW-BRANCH     TO JNRST-NEW-HOME-BRANCH
091900          MOVE WA-IN-17046-OLD-ACCT-TYPE  TO JNRST-OLD-ACCT-TYPE
091910          MOVE WA-IN-17046-NEW-ACCT-TYPE  TO JNRST-NEW-ACCT-TYPE
091920          MOVE WA-IN-17046-OLD-ACCT-CAT   TO JNRST-OLD-INT-CAT
091930          MOVE WA-IN-17046-NEW-ACCT-CAT   TO JNRST-NEW-INT-CAT
091940          MOVE WA-SOUR-GL-CLASS-CODE      TO JNRST-OLD-GLCC
091950          MOVE BORM-GL-CLASSIFICATION-CODE TO JNRST-NEW-GLCC
091960          MOVE BR0001CA-CR-INT            TO JNRST-CLOSE-INT
091970          MOVE BR0001CA-DR-INT            TO JNRST-CL-DR-INT-VAL
091980          MOVE 0                          TO JNRST-CL-COM-INT-VAL
091990          MOVE ZEROS                      TO JNRST-TOM-CR-ACRU            
092000                                             JNRST-TOM-DR-ACRU            
092010          MOVE BR0001CA-TOM-CR-ACRU       TO JNRST-TOM-CR-ACRU            
092020          MOVE BR0001CA-TOM-DR-ACRU       TO JNRST-TOM-DR-ACRU            
092030          MOVE BR0001CA-FCC-DR-ACRU       TO JNRST-FCC-DR-ACRU-ADJ        
092040          MOVE BR0001CA-FCC-ARR-ACRU     TO JNRST-FCC-ARR-ACRU-ADJ        
092050          MOVE BR0001CA-FCC-PRNC-ADJ      TO JNRST-FCC-PRNC-ACRU          
092060          MOVE BORM-LOAN-BAL              TO JNRST-AMOUNT
092070                                             WA-DUMMY-AMT
092080     END-IF.
092100     MOVE 0 TO JNRST-BOR-FEE.
092110     MOVE STRT-AREA-MSG-TIME      TO JNRST-TIME.
092120     IF JNRST-SYST = "BOR"
092130        MOVE BORM-REPORT-MASK     TO JNRST-REPORT-MASK.
092140     IF JNRST-SYST = "GEN"
092150        MOVE GLDM-REPORT-MASK     TO JNRST-REPORT-MASK.
092160     MOVE STRT-AREA-EDIT-MASK     TO WA-INPUT-EDIT-MASK-1-2
092170                                     WA-STORE-EDIT-MASK.
092180     MOVE WA-INPUT-EDIT-MASK-1   TO JNRST-EDIT-MASK.
092190     IF JNRST-SYST = "BOR"
092200        MOVE BORM-GROUP          TO JNRST-BOR-GROUP
092210        MOVE BORM-SUB-GROUP      TO JNRST-BOR-SUB-GROUP.
092220     MOVE STRT-AREA-SOC-NO        TO JNRST-SOC.
092230     IF (STRT-AREA-TRN-NO = 10071 OR 15071)
092240         MOVE WA-ADV-LOC-ACCT-NO TO JNRST-CUSM-NO
092250     ELSE
092260         MOVE WA-INPUT-ACCT-NO       TO JNRST-CUSM-NO.
092270     MOVE STRT-AREA-BRANCH        TO JNRST-BRCH.
092280     IF  WA-INPUT-PARAM-TABLE(23) = 0
NR2001*092290         MOVE BORV-01-CODE TO JNRST-TRN-TYP
NR2001         MOVE BOCT-TRAN-TYPE TO JNRST-TRN-TYP
092300     ELSE
092310         MOVE 0            TO JNRST-TRN-TYP.
092320     MOVE STRT-AREA-TERM-NO       TO JNRST-TERMNL.
092330     MOVE STRT-AREA-TELL-NO       TO JNRST-TELLER.
092340     MOVE STRT-AREA-TRN-NO        TO JNRST-TRAN-CODE.
092350*
092360*** 760167 BEGIN ***
092370     MOVE STRT-AREA-OTHER-OVERRIDE TO JNRST-ATM-SAF-FLAG.
092380     IF  STRT-AREA-EFT-TXN
092390         IF JNRST-ATM-FIELDS NOT EQUAL SPACES
092400            MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
092410                 UT8500CA-CALL-CODE
092420            MOVE SPACES TO UT8500CA-INPUT-MSG
092430            STRING "OVERWRITING JNRST-ATM-FIELDS, TRAN:"
092440                    JNRST-TRAN-CODE
092450                   ", CALLED FROM " W-PROGRAM-NAME
092460                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
092470            CALL "UT8500" USING
092480                                UT8500CA-AREA
092490             MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
092500                  UT8500CA-CALL-CODE
092510             MOVE SPACES TO UT8500CA-INPUT-MSG
092520             STRING "BR0000(E200): JNRST-ATM-FIELDS "
092530                     JNRST-ATM-FIELDS
092540                    ", CALLED FROM " W-PROGRAM-NAME
092550                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
092560             CALL "UT8500" USING
092570                                 UT8500CA-AREA
092580         END-IF
092590       MOVE ST-ATM-SEQ-NO   TO JNRST-ATM-SEQ-NO                         
092600       MOVE WA-ATM-ATM-SEQ-NO TO JNRST-ATM-ATM-SEQ-NO
092610       MOVE ST-ATM-TXN-TYPE TO JNRST-ATM-TXN-TYPE                       
092620       MOVE WA-ATM-TXN-DATE TO JNRST-ATM-TXN-DATE
092630       MOVE WA-ATM-TXN-TIME TO WS-TEMP-TIME-8
092640       MOVE WS-TEMP-TIME-6  TO JNRST-ATM-TXN-TIME
092650       MOVE STRT-AREA-ABS-TERM TO JNRST-ATM-TERM-NO
092660     ELSE
092670         IF  (STRT-BATCH-TRICKLE-TXN)
092680         AND (STRT-AREA-TRN-NO = 14060 OR 14160 OR 18060 OR
092690                                 18160 OR 19023 OR 18062 OR
092700                                 18010 OR 18110 OR 18020 OR
092710                                 18120 OR 18030 OR 18050 OR
092720                                 18130 OR 18150 OR
092730                                 18162 OR
SC7091                                 19060 OR 19160 OR
092740                                 16065 OR 16061 OR 16066 OR
092750                                 16165 OR 16161 OR
092760                                 16033 OR 16034 OR 16035 OR
092770                                 16133)
092780           IF JNRST-ATM-FIELDS NOT EQUAL SPACES
092790           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
092800             MOVE SPACES TO UT8500CA-INPUT-MSG
092810             STRING "OVERWRITING JNRST-ATM-FIELDS FOR TRAN "
092820             JNRST-TRAN-CODE
092830                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
092840             CALL "UT8500" USING
092850                                 UT8500CA-AREA
092860           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
092870             MOVE SPACES TO UT8500CA-INPUT-MSG
092880             STRING "JNRST-ATM-FIELDS " JNRST-ATM-FIELDS
092890                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
092900             CALL "UT8500" USING
092910                                 UT8500CA-AREA
092920           END-IF
092930         MOVE ST-ATM-SEQ-NO   TO JNRST-ATM-SEQ-NO                       
092940         MOVE WA-ATM-ATM-SEQ-NO TO JNRST-ATM-ATM-SEQ-NO
092950         MOVE ST-ATM-TXN-TYPE TO JNRST-ATM-TXN-TYPE                     
092960         MOVE WA-ATM-TXN-DATE TO JNRST-ATM-TXN-DATE
092970         MOVE WA-ATM-TXN-TIME TO WS-TEMP-TIME-8
092980         MOVE WS-TEMP-TIME-6  TO JNRST-ATM-TXN-TIME
092990         MOVE STRT-AREA-ABS-TERM TO JNRST-ATM-TERM-NO
093000         MOVE WA-ATM-CARD-NO TO JNRST-ATM-CARD-NO
093010         MOVE STRT-AREA-BATCH-TANDEM TO JNRST-ATM-SAF-FLAG.
093020*** 760167 END ***
093030*
093040     IF JNRST-SYST = "GEN"
093050        MOVE WS-SAVE-TXN-CURRENCY TO JNRST-CURRENCY-CODE
093060     ELSE
093070        MOVE BORM-CURRENCY-IND    TO JNRST-CURRENCY-CODE.
093080     MOVE STRT-AREA-POST-DT       TO JNRST-POST-DATE.
093090     MOVE STRT-AREA-JRNL-NO       TO JNRST-JRNL-NO.
093100     MOVE 1                       TO JNRST-FLAG.
093110* THE FOLLOWING STATEMENT REPLES THE ONE FOLLOWING IT
093120     MOVE LOW-VALUES              TO JNRST-ERROR-RESULT.
093130     MOVE ZEROS                   TO JNRST-OVERRIDE-HDR-NO
093140                                     JNRST-NEW-ACC-FLG.
093150* MOVE CHEQUE CLEARANCE FIELDS
093160     MOVE WA-BANK-NUMBER          TO JNRST-BANK-NUMBER.
093170     MOVE WA-REGION-ID            TO JNRST-REGION-ID.
093180     MOVE WA-LIM-TOL-FLAG         TO JNRST-LIM-TOL-FLAG.
093200     IF STRT-AREA-TRN-NO = 16039 OR 16059
093210                        OR 16139 OR 16159
093220        MOVE WA-SOURCE-APPLN TO JNRST-SOURCE-APPLN.
S18829     IF  (WA-SAVE-AGREE-INT-BUCKET > 0
S18829      AND BOIS-AGREE-INT-BUCKET = 0
S18829      AND BR17033-AGREE-IND = 0
S18829      AND STRT-AREA-TRN-NO = 17033)
S18829          IF BOIS-INTEREST-DUE > 0
S18829             COMPUTE WA-ADD-AGREE-INT-BUCKET =
S18829                     WA-SAVE-AGREE-INT-BUCKET -
S18829                     BOIS-INTEREST-DUE
S18829          ELSE
S18829             COMPUTE WA-ADD-AGREE-INT-BUCKET =
S18829                     WA-SAVE-AGREE-INT-BUCKET
S18829
S18829          END-IF
S18829     END-IF.
SC4680     IF (BR17033-INT-BUCKET > 0                              
SC4680      AND STRT-AREA-TRN-NO = 17033                          
SC4680      AND BORM-STAT = 50)
SC6148      OR (BR17033-INT-AMT > 0
SC6148      AND STRT-AREA-TRN-NO = 17033)
S18829      OR (WA-ADD-AGREE-INT-BUCKET > 0
S18829      AND BOIS-AGREE-INT-BUCKET = 0
S18829      AND BR17033-AGREE-IND = 0
S18829      AND STRT-AREA-TRN-NO = 17033)
SC4680        MOVE 01                       TO JNRST-SUB-LEDG-CODE
SC4680        MOVE BR17033-INT-BUCKET       TO JNRST-AMOUNT       
S18829        IF (WA-ADD-AGREE-INT-BUCKET > 0
S18829        AND BOIS-AGREE-INT-BUCKET = 0
S18829        AND BR17033-AGREE-IND = 0
S18829        AND STRT-AREA-TRN-NO = 17033)
S18829            MOVE WA-ADD-AGREE-INT-BUCKET TO JNRST-AMOUNT
S18829        END-IF
SC4680        MOVE STRT-AREA-POST-DT        TO UT0020-BINARY-DATE 
SC4680        MOVE 1 TO UT0020-FUNCTION                           
SC4680        CALL "UT0020" USING UT0020-FUNCTION                 
SC4680                            UT0020-DATE-AREA                
SC4680                            UT0020-BINARY-DATE              
SC4680        MOVE UT0020-DATE-DDMMCCYY TO UT0030-DATE-DDMMCCYY   
SC4680                                                            
SC4680        PERFORM CREATE-13509-JR01                           
SC4680           THRU CREATE-13509-JR01-EXIT                      
SC4680                                                            
SC4680        GO TO E299-EXIT                                     
SC4680     END-IF                                                 
SC4680                                                            
TB0223     IF STRT-AREA-TRN-NO = 17467
SC5863        IF BR17467-INP-DEF-SYSTEM = "INV"           
SC5863           MOVE WA-DEP-ACCT-NO TO INVM-MEMB-CUST-AC 
SC5863           PERFORM B1000-READ-INVM                  
SC5863              THRU B1999-EXIT                       
SC5863           IF WA-MSG-ERR-FLAG = 1                   
SC5863              GO TO E299-EXIT                       
SC5863           ELSE                                     
SC5863              MOVE INVM-BRANCH-NO TO WA-SAVE-BRCH-NO
SC5863           END-IF                                   
SC5863        END-IF                                      
SC5863                                                    
NR2001*TB0233        MOVE SPACES   TO DBIO-CALL-PARAM
NR2001*TB0223                         DBIO-CALL-SYS-AREA
NR2001*TB0223                         DBIO-CALL-KEY-AREA
NR2001*TB0223                         DBIO-CALL-STATUS
NR2001*TB0223        MOVE ZERO     TO DBIO-CALL-REFER-AREA
NR2001*TB0223        MOVE 07       TO DBIO-CALL-FUNC
NR2001*TB0223        MOVE "BOR"    TO DBIO-CALL-SYS
NR2001*TB0223        MOVE BORM-KEY TO DBIO-CALL-KEY
NR2001*TB0223        MOVE 01       TO DBIO-CALL-TXN-TYPE
NR2001        INITIALIZE UTBOCTCA-CALL-AREA
NR2001        MOVE BORM-SOC-NO       TO BOCT-INST-NO
NR2001        MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO
NR2001        MOVE 0                 TO BOCT-REC-NO
NR2003*NR2001 MOVE 999999999         TO BOCT-TRN-DATE
NR2003        MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE
NR2001        MOVE 1                 TO UTBOCTCA-KEY-NO
NR2001        SET  UTBOCTCA-READNEXT TO TRUE
NR2001        MOVE 01                TO WS-BOCT-TRAN-TYPE
TB0223        MOVE "N"      TO WA-TRAN-NO-MORE-FLAG
TB0223
TB0223**** AMEND AND REUSE DISCHARGE-JR01 ROUTINE TO CREATE JOURNAL ENTRIES
TB0223**** FROM BORV.
SC5863        MOVE WA-SAVE-GL-ACCT-TYPE  TO JNRST-ACC-TYPE  
SC5863        MOVE WA-SAVE-GL-INT-CAT    TO JNRST-INT-CAT   
SC5863        MOVE WA-SAVE-GL-BR-NO      TO JNRST-HOME-BRNCH
SC5863                                                      
TB0223        PERFORM DISCHARGE-JR01
TB0223           THRU DISCHARGE-JR01-EXIT
TB0223        UNTIL WA-TRAN-NO-MORE
TB0223          OR WA-MSG-ERR-FLAG NOT = 0
TB0223
SC5863        IF BR17467-INP-DEF-INT-AMT > 0                           
S11177         AND WA-BOIS-DEF-INT-END-DTE > 0                
S11177         AND WA-BOIS-DEF-INT-END-DTE > STRT-AREA-POST-DT
SC5863           MOVE BR17467-INP-SUB-LEDGER-CD TO JNRST-SUB-LEDG-CODE 
SC5863           MOVE BR17467-INP-DEF-INT-AMT   TO JNRST-AMOUNT        
SC5863           MOVE STRT-AREA-POST-DT         TO UT0030-DATE-DDMMCCYY
SC5863                                                                 
SC5863           PERFORM CREATE-13509-JR01                             
SC5863              THRU CREATE-13509-JR01-EXIT                        
SC5863                                                                 
SC5863           IF WA-MSG-ERR-FLAG NOT = 0                            
SC5863              GO TO E299-EXIT                                    
SC5863           END-IF                                                
SC5863       END-IF                                                    
SC5863                                                                 
TB0223       GO TO E299-EXIT
TB0223     END-IF.
TB0223
093240     IF  WA-INPUT-PARAM-TABLE(25) = 1
093250         PERFORM E250-LOG-DISCH THRU E259-EXIT
093260         GO TO E299-EXIT.
093270     IF JNRST-SYST = "GEN" OR CHECK-POSTED-TO-SUSP
093280         GO TO E204-CONTINUE.
093300     IF  STRT-AREA-TRN-NO = 10732
093310         ADD  BORM-INT-ACCR
093320              BLDV-FC-LI-ADJ-ACCR                                         
093330              BORM-INT-ADJUSTMENT GIVING WA-BORM-AMT1
093340         MOVE WA-BORM-AMT1            TO JNRST-BALANCE
093350         MOVE WA-10732-INT-ADJ        TO JNRST-AMOUNT
093360         MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE
093370     ELSE                                                                 
093380     IF  STRT-AREA-TRN-NO = 10733                                         
093390         MOVE BORM-TOM-ACRU-AMT       TO JNRST-BALANCE                    
093400         MOVE WA-10733-TOM-ADJ        TO JNRST-AMOUNT                     
093410         MOVE STRT-AREA-POST-DT       TO JNRST-TRAN-DATE                  
093420     ELSE
093430     IF  STRT-AREA-TRN-NO = 12000 OR
093440                            17000 OR 17001 OR 17002 OR
093450                            12410
093460         PERFORM E210-PROCESS-NEW-CANCEL-LOG THRU E219-EXIT
093470         IF  WA-MSG-ERR-FLAG = 1
093480             GO TO E299-EXIT
093490         ELSE
093500         IF  STRT-AREA-TRN-NO = 12410
093510             PERFORM E211-PROCESS-12411-TXN
093520                  THRU E211-EXIT
093530         END-IF
093540     ELSE IF STRT-AREA-TRN-NO = 17004 OR 17005 OR 17006 OR
093550                                17007 OR 17008 OR 17009 OR
093560                                17010 OR 17011 OR 17012 OR
093570                                17013 OR 17014 OR 17016 OR
093580                                17017 OR 17027 OR
093590                                17018 OR 17019 OR 17020 OR
093600                                17021 OR 17022 OR 17023 OR
093610                                17024 OR 17025 OR 17028
TB0069                                      OR 17026
093620              MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE
093630              MOVE ZEROS TO JNRST-TRN-TYP
093640              PERFORM E240-PROCESS-LOAN-LOG THRU E249-EXIT
093650         ELSE
093660             PERFORM E220-PROCESS-OLD-LOG
093670                THRU E229-EXIT.
093680 E204-CONTINUE.
SC8064     IF (STRT-FEP-ATM-TXN AND
SC8064         WA-INPUT-PARAM-TABLE(29) NOT = 1 AND
SC8064         WA-INPUT-PARAM-TABLE(4) NOT = 1)
093690        MOVE WA-INPUT-PROMO TO JNRST-BATCH-NO.
S12067*SC9302     IF  BORP-YOUBE
S12067*S11111     AND (STRT-AREA-TRN-NO = 10872 OR 10862)
SC9302*S11111     AND STRT-AREA-TRN-NO = 10872
S12067     IF  STRT-AREA-TRN-NO = 10872 OR 10862
SC9302     AND WA-ADV-PROMO NOT = SPACES
SC9302         MOVE WA-ADV-PROMO           TO JNRST-BATCH-NO
S12524         IF ( BR0038CA-AMC
S12524         AND  BORM-BAD-DEBT-IND(2:1) > 3 )
S12524              MOVE BR0038CA-AMC-PROMO-NO TO JNRST-BATCH-NO
S12524              MOVE BORM-BR-NO        TO JNRST-BRCH
S12524         END-IF
SC9302     END-IF.
S12564*
S12564     IF  STRT-AREA-TRN-NO = 10892
S12564     AND WA-ADV-PROMO     = SPACES
S12564         IF ( BR0038CA-AMC
S12564         AND  BORM-BAD-DEBT-IND(2:1) > 3 )
S12564              MOVE BR0038CA-AMC-PROMO-NO TO JNRST-BATCH-NO
S12564              MOVE BORM-BR-NO        TO JNRST-BRCH
S12564         END-IF
S12564     END-IF.
S12564*
S10578     IF BORP-YOUBE                                              
S10578     AND WA-ADV-PROMO NOT = SPACES                              
S10578     AND WA-INPUT-PARAM-TABLE(5) = 1
S10578*S10623     AND STRT-AREA-TRN-NO NOT = 13062
S10578*S10623     AND STRT-AREA-TRN-NO NOT = 13052
S10578         INITIALIZE UT0270CA-AREA
S10578         MOVE WA-ADV-PROMO          TO UT0270CA-IN-PROMO        
S10578         MOVE 2                     TO UT0270CA-IN-CALL-CODE    
S10578         MOVE STRT-AREA-SOC-NO      TO UT0270CA-IN-SOC-NO       
S10578         MOVE SOC-LANGUAGE-CODE     TO UT0270CA-IN-LANGUAGE-CODE
S10578         CALL "UT0270" USING           UT0270CA-AREA            
S10578         IF UT0270CA-OUT-STAT NOT = "****"                      
S10578            MOVE 730                TO WA-OUTPUT-ERR-MSG-NO     
S10578            MOVE 1                  TO WA-MSG-ERR-FLAG          
S10578            GO TO E299-EXIT                                     
S10578         END-IF                                                 
S10578         IF UT0270CA-GLC-OVRD-IND = "Y"                         
S10578            MOVE WA-ADV-PROMO       TO JNRST-BATCH-NO           
S10578         END-IF                                                 
S10711         IF  WA-INPUT-PARAM-TABLE(7) = 1              
S10711         AND WA-ADV-PROMO = "F9"                      
S11192         AND STRT-BANCSLINK
S10711             MOVE SPACES             TO JNRST-BATCH-NO
S10711         END-IF                                       
S10578     END-IF.                                                    
093700     IF JNRST-SYST = "BOR"
093710        IF  WA-INPUT-PARAM-TABLE(24) = 1
093720            MOVE STRT-AREA-BRANCH    TO JNRST-HOME-BRNCH
093730        ELSE
093740            MOVE BORM-BR-NO          TO JNRST-HOME-BRNCH
093750     ELSE
SC2302        IF WA-POST-TO-GL
SC2302            MOVE WA-GLDM-BRANCH      TO JNRST-HOME-BRNCH
SC2302        ELSE
093760            MOVE STRT-AREA-BRANCH    TO JNRST-HOME-BRNCH.
093770     IF (STRT-AREA-TRN-NO = 10071 OR 15071)
093780         PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
093790         IF  WA-MSG-ERR-FLAG = 1
093800             GO TO E299-EXIT
093810         ELSE
093820             PERFORM E230-LOG-LOC THRU E239-EXIT
093830             GO TO E299-EXIT.
093840     IF (STRT-AREA-TRN-NO = 10171 OR 15171)
093850         IF BORM-LOC-IND = 1
093860            PERFORM Z3000-RETRIEVE-BBLC THRU Z3099-EXIT
093870            IF WA-MSG-ERR-FLAG = 1
093880               GO TO E299-EXIT
093890            END-IF
093900         ELSE
093910         IF BORM-LOC-IND = 0
093920            MOVE ZEROS                   TO BBLC-LOC-ACCT-NO
093930                                            BBLC-LOC-DT
093940            MOVE SPACES                  TO BBLC-LOC-ID-DOC
093950                                            BBLC-LOC-ID-NO
093960         END-IF
093970       IF  BBLC-LOC-ACCT-NO NOT = 0
093980       AND BBLC-LOC-DT = ZEROES
093990*      AND (BORM-LOC-ACC NOT = 0)
094000*      AND (BORM-LOC-DATE = ZEROES)
094010           PERFORM E230-LOG-LOC THRU E239-EXIT
094020           GO TO E299-EXIT.
TB0082**--
           MOVE 0 TO JNRST-TRANSFER-TXN-BRANCH.
           IF JNRST-SYST = "GEN"
               IF STRT-AREA-TRN-NO = 11057 OR 11157 OR 16057 OR 16157
S11455                            OR 11069 OR 11169
S11455                            OR 16069 OR 16169
SC2759                            OR 16046 OR 16146
SC2760*                           OR 26055 OR 26155
SC3842                            OR 25055 OR 25155
SC3833                            OR 20055 OR 20155
SC4522         OR (FEDI-FROM-TO-GL AND 
SC4522             (STRT-AREA-TRN-NO = 11055 OR 11155))
SC7091         OR (FEDI-FROM-TO-GL AND
SC7091             (STRT-AREA-TRN-NO = 16055 OR 16155))
                  MOVE WA-STORE-HME-BRH TO JNRST-TRANSFER-TXN-BRANCH
               END-IF
           ELSE
              IF STRT-AREA-TRN-NO = 11057 OR 11157 OR 16057 OR 16157
SC2759                            OR 16046 OR 16146 OR 16048 OR 16148
SC3849                            OR 11048 OR 11148
S11455                            OR 11069 OR 11169
S11455                            OR 16069 OR 16169
SC4485                            OR 13046 OR 13146 OR 15046 OR 15146
S10982                            OR 11046 OR 11146 OR 11049 OR 11149  
S10982                            OR 16120 OR 16049 OR 16149   
S16235                            OR 13047 OR 13147 OR 15047 OR 15147
S12770                            OR 11063 OR 11163 OR 16063 OR 16163
SC4522        OR (FEDI-FROM-TO-GL AND 
SC4522            (STRT-AREA-TRN-NO = 11055 OR 11155))
SC7091        OR (FEDI-FROM-TO-GL AND
SC7091            (STRT-AREA-TRN-NO = 16055 OR 16155))
SC6401        OR ((STRT-AREA-TRN-NO = 11041 OR 11141)                            
SC6401*                    AND (W41-I-SYSTEM = "GEN"))                   
SC6401                     AND (WA-SAVE-W41-I-SYSTEM = "GEN"))           
                 MOVE WA-SAVE-BRCH-NO  TO JNRST-TRANSFER-TXN-BRANCH
S12384        ELSE
S12384           IF ((STRT-AREA-TRN-NO = 11030 OR 16030) AND
S16201*S12384              STRT-BATCH-TXN AND BORP-RECEIVABLE-YES AND
S16201              BORP-RECEIVABLE-YES AND
S12384              WA-REPAY-PROMO   = 'BA') OR
S12384              (STRT-AREA-TRN-NO = 16130 AND BORP-RECEIVABLE-YES
S12384              AND WA-REPAY-PROMO   = 'BA')
S12384              MOVE WA-STORE-HME-BRH TO JNRST-TRANSFER-TXN-BRANCH
S12384                                       JNRST-BRCH
S12384           END-IF
              END-IF
SC2156*SC3849 IF STRT-AREA-TRN-NO = 11048 OR 11148
SC2371****SC2759                 OR 16048 OR 16148
SC2156*SC3849    MOVE GLDM-BRANCH      TO JNRST-TRANSFER-TXN-BRANCH
SC2156*SC3849 END-IF
           END-IF
TB0082**--
094040     IF (JNRST-SYST NOT = "GEN") AND (NOT CHECK-POSTED-TO-SUSP)
094050        GO TO E205-CONTINUE.
094070     IF WA-INPUT-PARAM-TABLE(8) = 1
094080        MOVE WA-STORE-TXN-DT TO JNRST-TRAN-DATE
094090     ELSE
094100        MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE.
094110     MOVE LOW-VALUES         TO JNRST-ERROR-RESULT.
094120     MOVE ZEROES             TO JNRST-LST-FIN-DT.
094130     MOVE 0                  TO JNRST-ARR.
094140     MOVE GLDM-NO-TRANS      TO JNRST-TOT-NO-TRNS.
094150     MOVE 0                  TO JNRST-RATE
094160                                JNRST-DISCH-FEE.
094170     IF  CHECK-POSTED-TO-SUSP
094180         MOVE CHECK-RESPONSE-ERR-NO TO JNRST-ERR-NO(1)
094190         MOVE "SU"                  TO JNRST-ERR-OVERRIDE-CD(1)
094200         MOVE WA-SUSP-ACCT-NO       TO JNRST-ATM-ERROR-ACCT-NO
094210         MOVE "GEN"                 TO JNRST-SYST.
094230     IF WA-INPUT-PARAM-TABLE (5) = 1
094240        AND WA-DUMMY-LST-TWO = 80
094250        MOVE WA-ADV-NAME-1   TO JNRST-SECOND-DTL
094260     ELSE
094270        MOVE SPACES          TO JNRST-SECOND-DTL.
094280     MOVE SPACES             TO JNRST-TRAP.
094290     MOVE WA-GL-CHQ-NO       TO JNRST-CHQ-DAYS.
094300     MOVE 1                  TO JNRST-FLAG.
094310     MOVE 0                  TO JNRST-GL-IBB-XCURR-IND.
094320     MOVE 01                 TO JNRST-TRN-TYP.
094330     MOVE SPACE              TO JNRST-ORIGINAL-TXN-IND.
094340     MOVE WA-SAVE-ORIG-TRAN  TO JNRST-TRANSFER-TRAN-CODE.
094350     MOVE WA-SAVE-FROM-ACCT  TO JNRST-TRANSFER-ACCT.
094360     MOVE GLDM-LEDGER-NO     TO JNRST-CUSM-NO.
094370     MOVE GLDM-PRODUCT-TYPE  TO JNRST-ACC-TYPE.
094380     MOVE GLDM-PRODUCT-CATEGORY TO JNRST-INT-CAT.
094390     MOVE UT0120RA-CGL-POSTING-IND TO JNRST-CGL-POSTING-IND.
094400     MOVE WA-GL-AMOUNT       TO JNRST-AMOUNT.
094410     MOVE WA-GL-PROMO-NO     TO JNRST-BATCH-NO.
094420     MOVE WA-GL-NAME-1       TO JNRST-GL-NAME-1.
094430     MOVE WA-GL-NAME-2       TO JNRST-GL-NAME-2.
094440     IF WA-INPUT-PARAM-TABLE (10) = 1
094450         MOVE WA-GL-CHQ-NO   TO JNRST-GL-DESC
094460     ELSE
094470         MOVE WA-GL-DESC     TO JNRST-GL-DESC
094480     END-IF.
094490     MOVE GLDM-CUM-CURR-VAL  TO JNRST-GL-BALANCE.
094500     MOVE GLDM-PRODUCT-TYPE  TO JNRST-GL-ACC-TYPE.
094510     MOVE 0                  TO JNRST-NEW-ACC-FLG.
094520     MOVE 1                  TO JNRST-RATE-TYPE.
094530     MOVE GLDM-CURRENCY      TO JNRST-FROM-CURRENCY-CODE.
094540     MOVE WA-SAVE-ACCT-AMT   TO JNRST-TO-CURR-AMOUNT.
094550     MOVE WA-ACCT-CURR-CD    TO JNRST-TO-CURRENCY-CODE.
094560     IF GLDM-CURRENCY = SOC-NATIVE-CURRENCY
094570         MOVE 1              TO JNRST-RATE-TYPE
094580         MOVE WA-GL-AMOUNT   TO JNRST-FROM-BASE-EQUIVALENT
094590                                JNRST-TO-BASE-EQUIVALENT
094600     ELSE
094610         MOVE UT0296CA-RATE-TYPE TO JNRST-RATE-TYPE
094620         MOVE UT0296RA-TO-BASE-EQUIVALENT TO
094630                               JNRST-FROM-BASE-EQUIVALENT
094640         MOVE UT0296RA-EQUIV-BASE-AMOUNT  TO
094650                          JNRST-TO-BASE-EQUIVALENT.
094660     MOVE  0  TO JNRST-CURR-COMMISSION
094670                 JNRST-CURR-CHANGE.
SC2302     IF STRT-AREA-TRN-NO = 20045 OR 20145
SC2302                        OR 25045 OR 25145
SC3833                        OR 20055 OR 20155
SC3833                        OR 25055 OR 25155
S10982                        OR 21053 OR 21153
SC2302        MOVE WA-STORE-HME-BRH TO JNRST-TRANSFER-TXN-BRANCH
SC2302     ELSE
094680        MOVE WA-SAVE-FROM-BRANCH TO JNRST-TRANSFER-TXN-BRANCH.
094690     MOVE WA-GL-CHQ-NO TO JNRST-GL-CHEQUE-NO.
094700     MOVE CH0000RA-UPD-CHQ-DUP-NO TO JNRST-GL-CHQ-DUP-NO.
094710 E205-CONTINUE.
094720*
SC2156*SC2302 IF WA-DUMMY-LST-TWO = 44 OR 45 OR 55
SC2760*SC2302 AND JNRST-SYST NOT = "GEN"
SC2302*    IF (WA-DUMMY-LST-TWO = 44 OR 45 OR 55)                         SC6401        
SC2302*    AND (JNRST-SYST NOT = "GEN")                                   SC6401        
SC6401     IF ((WA-DUMMY-LST-TWO = 44 OR 45 OR 55)                                      
SC6401           AND (JNRST-SYST NOT = "GEN"))     OR                                   
SC6401        ((STRT-AREA-TRN-NO = 11041 OR 11141)                                      
SC6401*          AND  (W41-I-SYSTEM = "DEP"))              
SC6401           AND  (WA-SAVE-W41-I-SYSTEM = "DEP"))      
S11584     OR ((STRT-AREA-TRN-NO = 11068 OR 11168 OR 16068 OR 16168)
S11584           AND (JNRST-SYST NOT = "GEN"))                      
094740         MOVE WA-DEP-ACCT-NO TO INVM-MEMB-CUST-AC
094750         PERFORM B1000-READ-INVM THRU B1999-EXIT
094760         IF  WA-MSG-ERR-FLAG = 1
094770             GO TO E299-EXIT
094780         ELSE
SC5340             IF WA-DUMMY-LST-TWO = 55
SC5340             AND (WA-SAVE-TO-BRANCH = 0
SC5340                 OR WA-SAVE-TO-BRANCH NOT NUMERIC)
SC5340                MOVE INVM-BRANCH-NO TO WA-SAVE-TO-BRANCH
SC5340             END-IF
SC8776             IF UTVTACCA-ATM-POSTING
SC8776                OR UTVTACCA-POST-METHOD = 'B'
SC8776* UTVTACCA-TXN-BRANCH HOME BRANCH OF NOM ACCT OF VA ACCT
SC8776* MOVED AT JNRST-HOME BRANCH @ UT0820
SC8776                MOVE UTVTACCA-TXN-BRANCH TO
SC8776                     JNRST-TRANSFER-TXN-BRANCH
SC8776             ELSE
094790               MOVE INVM-BRANCH-NO TO JNRST-TRANSFER-TXN-BRANCH.
      *
SC5340*SC9693     PERFORM VA-POST-TO-VTPV THRU VA-EXIT.
SC5340     IF WA-MSG-ERR-FLAG = 1
SC5340         GO TO E299-EXIT.
SC7677     IF  WA-DUMMY-LST-TWO = 20
SC7677       AND STRT-BATCH-TRICKLE-TXN  
SC7677         MOVE  STRT-AREA-BRANCH  TO JNRST-TRANSFER-TXN-BRANCH.
SC1574     IF WA-CUST-INC-EXP-FEES
SC1574     AND WA-INPUT-PARAM-TABLE (29) = 1
SC1574        MOVE WA-SAVE-ACCT-BRANCH TO JNRST-TRANSFER-TXN-BRANCH
SC1574     END-IF.
SC7260     MOVE JNRST-TRANSFER-TXN-BRANCH TO WA-SAVE-TFR-TXN-BRANCH
TB0190     IF UT28-GLCC-OVERRIDE-IND = 1 OR 2
SC1574*       MOVE WA-INPUT-AMT TO JNRST-AMOUNT
SC1574        IF  STRT-AREA-SIGN = "-"
SC1574            MULTIPLY WA-INPUT-AMT BY -1 GIVING
SC1574                     JNRST-AMOUNT
SC1574        ELSE
SC1574            MOVE WA-INPUT-AMT TO JNRST-AMOUNT
SC1574        END-IF
TB0190     ELSE
TB0091     IF WA-INPUT-PARAM-TABLE (4) = 1
S12371     OR (STRT-AREA-TRN-NO = 17200
S12372     AND WA-BAD-DEBT-IND-2 < 2
S12417*S12371     AND STRT-TRICKLE-TXN
S15871*S12417     AND (STRT-TRICKLE-TXN OR BR0001CA-BILLING)
S15871     AND (STRT-TRICKLE-TXN OR BR0001CA-BILLING
S15871                           OR BR0001CA-ADJUST)
S12371     AND WA-17200-FUNC = "10")
S15043*S12363     OR (STRT-AREA-TRN-NO = 17200 AND WA-17200-FUNC = "11")
S15043     OR ( STRT-AREA-TRN-NO = 17200
S17432     AND (WA-17200-FUNC = "11" OR "15" OR "A1" OR "A3" OR
S20687                          "A5" OR "A6" OR "A7" OR "A8" OR
S20687                          "A9" ))
S20687*S19351                          "A5" OR "A6" OR "A7" OR "A8"))
S19351*S17432                          "A5" OR "A6"))
S17432*S17301  AND (WA-17200-FUNC = "11" OR "15" OR "A1" OR "A3"))
S17301**S17121 AND (WA-17200-FUNC = "11" OR "15" OR "A1"))
S17121**S15043 AND (WA-17200-FUNC = "11" OR "15"))
S15846     OR ( STRT-AREA-TRN-NO = 17200
S15846     AND  WA-17200-FUNC = "AA"
S15846     AND  STRT-TRICKLE-TXN
S15955*S15846     AND  BR0032CA-AMC-PROMO-CODE )
S15955     AND BR0032CA-PROMO-CODE(1) = "DE")
S16901     OR  (STRT-AREA-TRN-NO = 17200
S16901     AND  WA-17200-FUNC = "10"
S16901     AND (BORP-TIB-CONFER OR BORP-CARD-CONFER)
S16901     AND  WA-BAD-DEBT-IND-2 = 2)
S10725     OR STRT-AREA-TRN-NO = 10832 OR 10872 OR 10882 OR 10892
S11111     OR 10862
S11151     OR 10893
S11778     OR 17047
S10725*    OR STRT-AREA-TRN-NO = 10832 OR 10872
TB0091        IF BORP-PRIORITY-CODE-ON
TB0161           IF WA-BAD-DEBT-IND-2 > 1
S10257*S11605    AND (STRT-AREA-TRN-NO NOT = 10832 AND 10872)
S11605           AND (STRT-AREA-TRN-NO NOT = 10832 AND 10872 AND 10882
S11605                                   AND 10892 AND 10862 AND 10893)
S15846           AND (NOT (STRT-AREA-TRN-NO = 17200
S15846           AND  WA-17200-FUNC        = "AA"
S15846           AND  STRT-TRICKLE-TXN
S15955*S15846    AND  BR0032CA-AMC-PROMO-CODE))
S15955           AND BR0032CA-PROMO-CODE(1) = "DE"))
S10971*S11281    AND (STRT-AREA-TRN-NO NOT = 20045)
S16901           AND NOT (STRT-AREA-TRN-NO = 17200
S16901                    AND  WA-17200-FUNC = "10"
S16901                    AND (BORP-TIB-CONFER OR BORP-CARD-CONFER)
S16901                    AND  WA-BAD-DEBT-IND-2 = 2)
S17192           AND NOT (STRT-AREA-TRN-NO = 17200
S17192                    AND  WA-17200-FUNC = "11")
S17432           AND NOT (STRT-AREA-TRN-NO = 17200
S17432                    AND  (WA-17200-FUNC = "A5" OR "A6"))
S17454           AND NOT (STRT-AREA-TRN-NO = 17200
S17454                    AND  WA-17200-FUNC = "A3")
S19351           AND NOT (STRT-AREA-TRN-NO = 17200
S19351                    AND  (WA-17200-FUNC = "A7" OR "A8"))
S20687           AND NOT (STRT-AREA-TRN-NO = 17200
S20687                    AND  WA-17200-FUNC = "A9")
TB0211                PERFORM E400-NPL-JRNL THRU E409-EXIT
SC2156                GO TO E299-EXIT
TB0161           ELSE
TB0099              IF STRT-AREA-TRN-NO NOT = 13031 AND 11044 AND
SC0796*                20021 AND 20121 AND 13131 AND 11144
SC0796                 11048 AND 13131 AND 11144 AND 11148
S10971*S11281          AND 20045
SC5862*SC4593          AND NOT STRT-ASYNC-TPS
TB0091                PERFORM E250A-LOG-BUCKETS THRU E259D-EXIT
CS6271                IF (STRT-AREA-TRN-NO = 16010 OR 16045 OR 16046  
SC8399                           OR 16044 OR 16048 OR 16144 OR 16148
S10982                           OR 16120 OR 16049 OR 16149
S10542                           OR 16130 OR 16111
S11617                           OR 16129
S17282                           OR 16102
S18530                           OR 16020
S12668                           OR 16030
S15700                           OR 19011 OR 19030 OR 19045
S12394                           OR 16101
CS6271                                    OR 16110 OR 16145 OR 16146) 
SC7197                AND NOT BORP-YOUBE 
SC6271** Create GLIF 18403/18503 from BORV by reusing code in DISCHARGE-JR01
NR2001*SC6271                MOVE SPACES   TO DBIO-CALL-PARAM                      
NR2001*SC6271                                 DBIO-CALL-SYS-AREA                   
NR2001*SC6271                                 DBIO-CALL-KEY-AREA                   
NR2001*SC6271                                 DBIO-CALL-STATUS                     
NR2001*SC6271                MOVE ZERO     TO DBIO-CALL-REFER-AREA                 
NR2001*SC6271                MOVE 07       TO DBIO-CALL-FUNC                       
NR2001*SC6271                MOVE "BOR"    TO DBIO-CALL-SYS                        
NR2001*SC6271                MOVE BORM-KEY TO DBIO-CALL-KEY                        
NR2001*SC6271                MOVE 01       TO DBIO-CALL-TXN-TYPE                   
NR2001                INITIALIZE UTBOCTCA-CALL-AREA
NR2001                MOVE BORM-SOC-NO       TO BOCT-INST-NO
NR2001                MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO
NR2001                MOVE 0                 TO BOCT-REC-NO
NR2003*NR2001         MOVE 999999999         TO BOCT-TRN-DATE
NR2003                MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE
NR2001                MOVE 1                 TO UTBOCTCA-KEY-NO
NR2001                SET  UTBOCTCA-READNEXT TO TRUE
NR2001                MOVE 01                TO WS-BOCT-TRAN-TYPE
SC6271                MOVE "N"      TO WA-TRAN-NO-MORE-FLAG                 
SC6271                                                                      
SC6271                PERFORM DISCHARGE-JR01                                
SC6271                   THRU DISCHARGE-JR01-EXIT                           
SC6271                UNTIL WA-TRAN-NO-MORE                                 
SC6271                  OR WA-MSG-ERR-FLAG NOT = 0                          
SC6271                                                                      
CS6271                END-IF
SC4890*               IF STRT-ASYNC-TPS           SC6789
SC4890*                  NEXT SENTENCE            SC6789
SC4890*               END-IF                      SC6789
SC2156                GO TO E299-EXIT
TB0099              END-IF
TB0161           END-IF
TB0091        END-IF.
TB0091*           GO TO E299-EXIT.
      *
S16081*
S16081     IF  (BORM-CAPN-METHOD = "X" OR
S16081              (BORM-CAPN-METHOD = " " AND
S16081                BORP-CAPN-METHOD = "X"))
S16081          AND  JNRST-TRAN-CODE = 11155
S16081               MOVE  34       TO   JNRST-TRN-TYP
S16081               MOVE  SPACES   TO  JNRST-ATM-SAF-FLAG
S16081     END-IF.
S16081*
SC6783*    IF STRT-AREA-TRN-NO NOT = 014011        SC6789
094800      IF (JNRST-AMOUNT NOT = 0)
094810      OR (JNRST-TRAN-CODE = 12440 OR 12441 OR 17046 OR 12691)
SC4593        IF STRT-ASYNC-TPS
SC4593            MOVE STRT-AREA-TRN-NO TO JNRST-TRAN-CODE
SC4593        END-IF
094820        PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
094830        IF  WA-MSG-ERR-FLAG = 1
094840            GO TO E299-EXIT
SC5844        END-IF
SC5862     END-IF.
094850     IF JNRST-SYST = "GEN"
094860        GO TO E299-EXIT.
           IF  (BORM-CAPN-METHOD = "X" OR
020360              (BORM-CAPN-METHOD = " " AND
020370                BORP-CAPN-METHOD = "X")) 
                MOVE 0   TO WA-BORM-INS-PREMIUM.
 
094870     IF  (WA-INPUT-PARAM-TABLE (5) = 1)
094880     AND (WA-BORM-INS-PREMIUM > 0)
094890         NEXT SENTENCE
094900     ELSE
094910         GO TO E260-PROCESS-COMMISSION.
094920*
SC8627     IF BORP-YOUBE AND WS-TRANSFER-IND = "Y"
SC8627        MOVE WS-BORM-GL-CLASS-CODE  TO JNRST-GL-CLASS-CODE
SC8627     END-IF.
094930     MOVE WA-BORM-INS-PREMIUM TO JNRST-AMOUNT.
094940     MOVE WA-PPP-PREM-TXN-CODE TO JNRST-TRAN-CODE.
094950     MOVE WA-PPP-EDIT-MASK-1 TO JNRST-EDIT-MASK.
094960     MOVE 0 TO WA-LEDG-CODE1 WA-LEDG-CODE2 WA-LEDG-CODE3.
094970     MOVE WA-PPP-LEDGER-CODE TO WA-LEDG-CODE4.
094980     MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE.
094990     MOVE BORM-LOAN-BAL TO JNRST-BALANCE.
095000     MOVE WA-PPP-PREM-SUB-LEDG TO JNRST-SUB-LEDG-CODE.
095010     MOVE BORM-GROUP TO JNRST-BOR-GROUP.
095020     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
095030     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE.
095040     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
095050     IF  WA-MSG-ERR-FLAG = 1
095060         GO TO E299-EXIT.
095070*
095080 E260-PROCESS-COMMISSION.
095090*
095100     IF  WA-INPUT-PARAM-TABLE (4) = 1
095110         PERFORM VARYING BR0023CA-IX FROM 1 BY 1
095120                     UNTIL BR0023CA-IX > 2
095130            IF BR0023CA-TXN-CODE(BR0023CA-IX) NOT = ZERO
095140               MOVE BR0023CA-TXN (BR0023CA-IX) TO
095150                                 WA-GENERATED-TXN
095160               PERFORM E265-LOG-BR0023-24-TXNS THRU E265-EXIT
095170            END-IF
095180         END-PERFORM
095190     END-IF.
S10578     IF  BORP-YOUBE                                   
S10578     AND WA-INPUT-PARAM-TABLE (5) = 1                 
S10578         MOVE SPACES                 TO JNRST-BATCH-NO
S10578     END-IF.                                          
S17755     IF  BORP-ILOAN-R
S17755     AND WA-INPUT-PARAM-TABLE (5) = 1
S17755         MOVE SPACES                 TO JNRST-BATCH-NO
S17755     END-IF.
095210     IF  WA-INPUT-PARAM-TABLE (5) = 1
095220         PERFORM VARYING BR0024CA-IX FROM 1 BY 1
SC7197                     UNTIL BR0024CA-IX > 15
SC7197*                    UNTIL BR0024CA-IX > 5
095240            IF BR0024CA-TXN-CODE(BR0024CA-IX) NOT = ZERO
095250               MOVE BR0024CA-TXN (BR0024CA-IX) TO
095260                                 WA-GENERATED-TXN
095270               PERFORM E265-LOG-BR0023-24-TXNS THRU E265-EXIT
095280            END-IF
095290         END-PERFORM
095300     END-IF.
SC3109*****ADD ADDITIONAL GLIF ENTRY FOR PENALTY VIA CASH
SC3109     IF STRT-AREA-TRN-NO = 13031 OR 13131
SC8514        IF (BR0023-PENALTY-AMT + BR0023-WAIVE-AMT) > 0
                 COMPUTE JNRST-AMOUNT =  BR0023-PENALTY-AMT +
                                        BR0023-WAIVE-AMT
                 IF STRT-AREA-TRN-NO = 13031
                    MOVE 18201          TO JNRST-TRAN-CODE
                    MULTIPLY JNRST-AMOUNT BY -1 GIVING 
                                  JNRST-AMOUNT
                 ELSE
                    MOVE 18301          TO JNRST-TRAN-CODE
                 END-IF
                 PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
                 IF WA-MSG-ERR-FLAG = 1
                    GO TO E299-EXIT
                 END-IF
              END-IF
SC3109     END-IF.
SC3109*****ADD ADDITIONAL GLIF ENTRY FOR PENALTY VIA DEP
SC3109     IF STRT-AREA-TRN-NO = 11044 OR 11144
SC8514        IF (BR0023-PENALTY-AMT + BR0023-WAIVE-AMT) > 0
                 COMPUTE JNRST-AMOUNT =  BR0023-PENALTY-AMT +
                                        BR0023-WAIVE-AMT 
                 IF STRT-AREA-TRN-NO = 11044
                    MOVE 18280          TO JNRST-TRAN-CODE
SC4554                                     LINK-IN-TXCODE
                    MULTIPLY JNRST-AMOUNT BY -1 GIVING
                                  JNRST-AMOUNT
                 ELSE
                    MOVE 18380          TO JNRST-TRAN-CODE
SC4554                                     LINK-IN-TXCODE
                 END-IF
SC4554           PERFORM X700-CALL-UT0250 THRU X799-EXIT
SC4554           IF WA-MSG-ERR-FLAG = 1
SC4554              GO TO E299-EXIT
SC4554           ELSE
SC4554              MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
SC4554           END-IF
                 PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
                 IF WA-MSG-ERR-FLAG = 1
                    GO TO E299-EXIT
                 END-IF
              END-IF
SC3109     END-IF.
SC3109*****ADD ADDITIONAL GLIF ENTRY FOR PENALTY VIA GEN
SC3109     IF STRT-AREA-TRN-NO = 11048 OR 11148
SC8514        IF (BR0023-PENALTY-AMT + BR0023-WAIVE-AMT) > 0
                 COMPUTE JNRST-AMOUNT = BR0023-PENALTY-AMT +
                                        BR0023-WAIVE-AMT
                 IF STRT-AREA-TRN-NO = 11048
                    MOVE 18260          TO JNRST-TRAN-CODE
SC4554                                     LINK-IN-TXCODE
                    MULTIPLY JNRST-AMOUNT BY -1 GIVING
                                  JNRST-AMOUNT
                 ELSE
                    MOVE 18360          TO JNRST-TRAN-CODE
SC4554                                     LINK-IN-TXCODE
                 END-IF
SC4554           PERFORM X700-CALL-UT0250 THRU X799-EXIT
SC4554           IF WA-MSG-ERR-FLAG = 1
SC4554              GO TO E299-EXIT
SC4554           ELSE
SC4554              MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
SC4554           END-IF
                 PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
                 IF WA-MSG-ERR-FLAG = 1
                    GO TO E299-EXIT
                 END-IF
              END-IF
SC3109     END-IF.
S17306     IF  STRT-AREA-TRN-NO = 10732
S17306     AND STRT-TRICKLE-TXN
S17306     AND WA-BONUS-EXCHANGE
S17306         MOVE 13509                 TO UT0145CA-CALL-TRAN
S17306         PERFORM X910-REPL-COMPONENT   THRU X910-EXIT
S17306         MOVE WA-GL-CLASS-CODE-D    TO JNRST-GL-CLASS-CODE
S17306         MOVE 18503                 TO JNRST-TRAN-CODE
S17306                                       LINK-IN-TXCODE
S17306         PERFORM X700-CALL-UT0250 THRU X799-EXIT
S17306         IF WA-MSG-ERR-FLAG = 1
S17306            GO TO E299-EXIT
S17306         ELSE
S17306            MOVE LINK-EDIT-TABLE    TO JNRST-EDIT-MASK
S17306         END-IF
S17306         MOVE "C6"                  TO JNRST-BATCH-NO
S17306         PERFORM Z000-WRITE-JRNL  THRU Z009-EXIT
S17306         IF WA-MSG-ERR-FLAG = 1
S17306            GO TO E299-EXIT
S17306         END-IF
S17306     END-IF.
SC9391     IF (STRT-AREA-TRN-NO = 11041 OR 11141)
SC9393        AND (W41-IN-WTAX-AMT NOT = 0)
SC9391        IF UT28-GLCC-OVERRIDE-IND = 1 OR 2
SC9393* UT0028 ALREADY MANIPULATED THE SIGN.  JUST REVERSE IT HERE
SC9391*SC9393    IF  STRT-AREA-SIGN = "-"
SC9391               MULTIPLY W41-IN-WTAX-AMT BY -1 GIVING
SC9391                        JNRST-AMOUNT
SC9391*SC9393    ELSE
SC9391*SC9393        MOVE W41-IN-WTAX-AMT TO JNRST-AMOUNT
SC9391*SC9393    END-IF
S10190           MOVE WA-SAVE-DEST-BRANCH TO JNRST-TRANSFER-TXN-BRANCH
SC9391           PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
SC9391           IF WA-MSG-ERR-FLAG = 1
SC9391              GO TO E299-EXIT
SC9391           END-IF
SC9391        END-IF
SC9391     END-IF.
095320     IF (STRT-AREA-TRN-NO = 13507 OR 13509 OR 13609) OR
S16081        (STRT-AREA-TRN-NO = 13730 OR 13830)
S16081         OR
095330         WA-INPUT-PARAM-TABLE (4) = 1
095340       GO TO E299-EXIT.
095350     IF ((BORP-CAPN-METHOD NOT = " ")
095360     AND (BORP-CAPN-METHOD IS ALPHABETIC))
095370        NEXT SENTENCE
095380     ELSE
095390        GO TO E299-EXIT.
095400     IF WA-INPUT-PARAM-TABLE (5) = 1
095410        IF WA-INPUT-PARAM-TABLE (7) = 1
095420           MOVE 13609    TO JNRST-TRAN-CODE
095430                            LINK-IN-TXCODE
095440        ELSE
095450           MOVE 13509     TO JNRST-TRAN-CODE
095460                             LINK-IN-TXCODE.
S16081*
S16081     IF   (BORM-CAPN-METHOD = "X" OR
S16081            (BORM-CAPN-METHOD = " " AND
S16081             BORP-CAPN-METHOD = "X"))
S16081          IF WA-INPUT-PARAM-TABLE (5) = 1
S16081             IF WA-INPUT-PARAM-TABLE (7) = 1
S16081                MOVE 13830    TO JNRST-TRAN-CODE
S16081                                 LINK-IN-TXCODE
S16081             ELSE
S16081                MOVE 13730     TO JNRST-TRAN-CODE
S16081                                  LINK-IN-TXCODE
S16081             END-IF
S16081          END-IF
S16081     END-IF.
S16081*
SC9066     IF WA-COMMISSION-AMOUNT = ZEROES
SC9066        GO TO E299-EXIT.             
096070     MOVE WA-COMMISSION-AMOUNT  TO  JNRST-AMOUNT.
095470     IF BORM-CURRENCY-IND = SOC-NATIVE-CURRENCY
095480         GO TO E200-CONT.
095490     MOVE BORM-CURRENCY-IND  TO UT0296CA-FROM-CURRENCY
095500                            UT0296CA-TO-CURRENCY.
095510     MOVE WA-COMMISSION-AMOUNT  TO UT0296CA-TO-AMOUNT
095520                                   UT0296CA-FROM-AMOUNT.
095530     MOVE 1              TO UT0296CA-RATE-TYPE.
095540     MOVE 0              TO UT0296CA-COMMISSION
095550                            UT0296CA-CHANGE
095560                            UT0296CA-FROM-BASE-EQUIVALENT
095570                            UT0296CA-CALL-STATUS.
095580     IF WA-INPUT-PARAM-TABLE(8) = 1
095590        MOVE WA-STORE-TXN-DT TO UT0296CA-BACKDATED-DATE
095600     ELSE
095610        MOVE ZEROS TO UT0296CA-BACKDATED-DATE.
095620     MOVE STRT-AREA-SOC-NO TO LINK-IN-SOC-NO.
095630     MOVE 02 TO LINK-IN-CALL-CODE.
095640     CALL "UT0250" USING LINK-AREA.
095650     IF  LINK-OUT-STAT NOT = "****"
095660         MOVE 100 TO WA-OUTPUT-ERR-MSG-NO
095670         MOVE 1 TO WA-MSG-ERR-FLAG
095680         MOVE 0 TO LINK-IN-TXCODE
095690         GO TO E299-EXIT
095700     ELSE
095710         MOVE LINK-POSTING-LEVEL TO STRT-AREA-POSTING-LEVEL
095720         MOVE LINK-EDIT-MASK TO STRT-AREA-PROCESS-BITS
SC7107         MOVE LINK-SIGN TO STRT-AREA-SIGN
095730     END-IF.
095750     MOVE ZEROS          TO UT0296CA-MULT-FROM-AMOUNT(1)
095760                            UT0296CA-MULT-FROM-AMOUNT(2)
095770                            UT0296CA-MULT-FROM-AMOUNT(3)
095780                            UT0296CA-MULT-FROM-AMOUNT(4).
095790     MOVE "LON"          TO UT0296CA-SYSTEM.
095800     MOVE SPACES         TO UT0296CA-USER-CODES-LON.
095810     MOVE 5              TO UT0296CA-CALL-CODE.
095820     CALL "UT0296" USING
095830                         UT0296-CALL-AREA
095840                         STARTAREA
095850                         SOC-PARAMS.
095860     IF UT0296CA-CALL-STATUS NOT = 0
095870         MOVE UT0296CA-CALL-STATUS TO WA-OUTPUT-ERR-MSG-NO
095880         MOVE 1 TO WA-MSG-ERR-FLAG
095890         GO TO E299-EXIT
095900     ELSE
095910         MULTIPLY UT0296RA-EQUIV-BASE-AMOUNT BY -1 GIVING
095920                                    JNRST-TO-CURR-AMOUNT
095930                                    JNRST-FROM-BASE-EQUIVALENT
095940                                    JNRST-TO-BASE-EQUIVALENT.
095950 E200-CONT.
095960     IF WA-INPUT-PARAM-TABLE (5) = 1
095970        PERFORM X700-CALL-UT0250 THRU X799-EXIT
095980        IF WA-MSG-ERR-FLAG = 1
095990           GO TO E299-EXIT
096000        ELSE
SC9066           IF WA-COMMISSION-AMOUNT = ZEROES      
SC9066              GO TO E299-EXIT                    
SC9066           END-IF                                
096010           MOVE LINK-EDIT-TABLE       TO  JNRST-EDIT-MASK
096020           MOVE 0                     TO  WA-LEDG-CODE1
096030                                          WA-LEDG-CODE2
096040                                          WA-LEDG-CODE3
096050           MOVE WA-LEDG-CODE          TO  JNRST-LEDG-CODE
096060           MOVE BORM-LOAN-BAL         TO  JNRST-BALANCE
096070*          MOVE WA-COMMISSION-AMOUNT  TO  JNRST-AMOUNT
096080           COMPUTE JNRST-AMOUNT = WA-COMMISSION-AMOUNT * -1
S16081*SC5557           IF JNRST-TRAN-CODE = 13509
S16081           IF JNRST-TRAN-CODE = 13509 OR 13730
SC5557              IF WA-COMMISSION-AMOUNT IS NEGATIVE
SC5557                 COMPUTE JNRST-AMOUNT = WA-COMMISSION-AMOUNT * -1
SC5557              ELSE
SC5557                 MOVE WA-COMMISSION-AMOUNT TO JNRST-AMOUNT
SC5557              END-IF
SC5557           END-IF
SC5557           IF JNRST-TRAN-CODE = 13609
SC5557              IF WA-COMMISSION-AMOUNT IS POSITIVE
SC5557                 COMPUTE JNRST-AMOUNT = WA-COMMISSION-AMOUNT * -1
SC5557              ELSE
SC5557                 MOVE WA-COMMISSION-AMOUNT TO JNRST-AMOUNT
SC5557              END-IF
SC5557           END-IF
TB0237           MOVE JNRST-AMOUNT     TO  JNRST-TO-CURR-AMOUNT
TB0237                                     JNRST-FROM-BASE-EQUIVALENT
TB0237                                     JNRST-TO-BASE-EQUIVALENT
S16081*
S16081           IF  JNRST-TRAN-CODE = 13830
S16081               MOVE WA-COMMISSION-AMOUNT TO JNRST-AMOUNT
S16081               MOVE SPACES        TO  JNRST-ATM-SAF-FLAG
S16081               MOVE  34           TO   JNRST-TRN-TYP
S16081           END-IF
S16081*
096090           MOVE BORM-GROUP       TO  JNRST-BOR-GROUP
096100           MOVE BORM-SUB-GROUP   TO  JNRST-BOR-SUB-GROUP
096110           MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
096120           PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
096130           IF  WA-MSG-ERR-FLAG = 1
096140               GO TO E299-EXIT.
096150*
096160 E299-EXIT.
096170     EXIT.
096180/
096190 E210-PROCESS-NEW-CANCEL-LOG.
096200*
096210***  IF BIT 23 IS SET TO ZERO IT IS A CANCEL LOAN TRAN  ***
096220*
096230     IF  WA-INPUT-PARAM-TABLE (23) = 0
096240         MOVE ZEROS TO JNRST-CHQ-DAYS      JNRST-ARR
096250                       JNRST-INT-BON-AVAIL JNRST-INT-BON-INCR
096260                       JNRST-INT-BON-PROJ  JNRST-BALANCE
096270         MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE
096280         MOVE BORM-BR-NO TO JNRST-HOME-BRNCH
096290         INITIALIZE JNRST-SECOND-DTL
096300         MOVE BORM-ACT-TYPE TO JNRST-ACC-TYPE
096310         MOVE BORM-CAT      TO JNRST-INT-CAT
096320         MOVE WA-STORE-LEDG-CODE TO WA-LEDG-CODE4
096330         MOVE BORM-ACT-TYPE TO WA-TYPE
096340         MOVE 0             TO WA-LEDG-CODE1
096350         MOVE 0             TO WA-LEDG-CODE2
096360         MOVE 0 TO WA-LEDG-CODE3
096370         MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE
096380         MOVE 1 TO JNRST-SUB-LEDG-CODE
096390         MOVE WA-STORE-LST-FIN-DT TO JNRST-LST-FIN-DT
096400         MOVE WA-STORE-TOT-TRNS TO JNRST-TOT-NO-TRNS
096410         MOVE STRT-AREA-TRN-NO TO JNRST-TRAN-CODE
096420         MOVE WA-DUMMY-BAL TO JNRST-AMOUNT
096430         MOVE STRT-AREA-EDIT-MASK TO WA-STORE-EDIT-MASK
096440         MOVE BORM-GROUP TO WA-STORE-GROUP
096450         MOVE BORM-SUB-GROUP TO WA-STORE-SUB-GROUP
096460         MOVE WA-STORE-EDIT-MASK-1 TO JNRST-EDIT-MASK
096470         MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
096480         MOVE 0 TO JNRST-AMOUNT
096490         PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
096500         IF  WA-MSG-ERR-FLAG = 1
096510             GO TO E219-EXIT
096520         END-IF
096530*
096540***   LOG CRUED SHARE CAPITAL AND INTEREST
096550*
096560***      MOVE STRT-AREA-TRN-NO TO JNRST-TRAN-CODE
096570***      MOVE ZEROS TO JNRST-LEDG-CODE
096580***                    JNRST-SUB-LEDG-CODE
096590***      MOVE WA-DUMMY-AMT TO JNRST-AMOUNT
096600***      MOVE STRT-AREA-EDIT-MASK TO WA-STORE-EDIT-MASK
096610***      MOVE BORM-GROUP TO JNRST-BOR-GROUP
096620***      MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP
096630***      MOVE "-" TO WA-STORE-SIGN
096640***      MOVE "0600000000" TO WA-ST-TOTS-MASK1
096650***      MOVE "0000000000" TO WA-ST-TOTS-MASK2
096660***      MOVE 0 TO WA-ST-ENQ-CODE
096670***      MOVE WA-STORE-EDIT-MASK-1 TO JNRST-EDIT-MASK
096680***      MOVE 1 TO WA-JRNL-FUNCTION
096690***      CALL "SY10SEND" USING
096700***
096710***                            STARTAREA WA-JRNL-CALL-AREA
096720***      IF  WA-JRNL-STATUS NOT = "****"
096730***          GO TO E219-EXIT
096740***      ELSE
096750***      MOVE "Y" TO CHECK-RESPONSE-JRNL-UPDATED
096760***      MOVE 12411 TO JNRST-TRAN-CODE
096770***      MOVE ZEROS TO JNRST-LEDG-CODE
096780***                    JNRST-SUB-LEDG-CODE
096790***      MOVE WA-STORE-ACCR-INT TO JNRST-AMOUNT
096800***      MOVE STRT-AREA-EDIT-MASK TO WA-STORE-EDIT-MASK
096810***      MOVE BORM-GROUP TO JNRST-BOR-GROUP
096820***      MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP
096830***      MOVE "-" TO WA-STORE-SIGN
096840***      MOVE "0600000000" TO WA-ST-TOTS-MASK1
096850***      MOVE "0000000000" TO WA-ST-TOTS-MASK2
096860***      MOVE 0 TO WA-ST-ENQ-CODE
096870***      MOVE WA-STORE-EDIT-MASK-1 TO JNRST-EDIT-MASK
096880         GO TO E219-EXIT.
096890     IF  STRT-AREA-TRN-NO = 12000 OR 17000
096900         PERFORM E214-PROC-TRK-CREATE-AMEND THRU E214-EXIT.
096910     IF  STRT-AREA-TRN-NO =  17001
096920         PERFORM E216-PROC-TRK-PERS-DTLS THRU E216-EXIT.
096930     IF  STRT-AREA-TRN-NO = 17002
096940         PERFORM E218-PROC-TRK-USER-CODES THRU E218-EXIT.
096950     IF  STRT-AREA-TRN-NO = 17001 OR 17002
096960         GO TO E219-EXIT.
096970     IF STRT-AREA-TRN-NO = 12000
096980         MOVE 1 TO JNRST-NEW-ACC-FLG
096990         MOVE BORM-DISCH-REFERENCE TO JNRST-DISCH-REFERENCE
097000         MOVE ZEROES TO         JNRST-DUE-STRT JNRST-INT-STRT
097010                                JNRST-PEND-DUES-DATE
097020         MOVE ZEROES TO         JNRST-REM-TERM
097030                                JNRST-PEND-DUES-AMT
097040                                JNRST-ADD-DUES
097050                                JNRST-LOAN-RPY
097060         GO TO E219-EXIT.
097070     IF  STRT-AREA-TRN-NO = 17000
097080          MOVE BORM-DUE-STRT-DATE TO JNRST-DUE-STRT
097090          MOVE BORM-INT-START-DATE TO JNRST-INT-STRT
097100          MOVE BORM-PEND-DUES-DATE TO JNRST-PEND-DUES-DATE
097110          MOVE BORM-PEND-DUES TO JNRST-PEND-DUES-AMT
097120          MOVE BORM-REM-REPAYS TO JNRST-REM-TERM
S16757*097130          MOVE BORM-ADD-DUES TO JNRST-ADD-DUES
097140          MOVE ZEROES TO JNRST-TYPE
S16757                         JNRST-ADD-DUES
097150                         JNRST-DUE-AMT.
097160 E219-EXIT.
097170     EXIT.
097180 E211-PROCESS-12411-TXN.
097190     IF WA-BSHR-CAP-VAL  = 0 AND
097200        WA-BSHR-INT-ACCR = 0
097210          GO TO E211-EXIT.
097220     MOVE ZEROS TO JNRST-CHQ-DAYS      JNRST-ARR
097230                   JNRST-INT-BON-AVAIL JNRST-INT-BON-INCR
097240                   JNRST-INT-BON-PROJ  JNRST-BALANCE.
097250     MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE.
097260     MOVE BORM-BR-NO TO JNRST-HOME-BRNCH.
097270     MOVE 12411 TO JNRST-TRAN-CODE
097280                   LINK-IN-TXCODE.
097290     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
097300     IF WA-MSG-ERR-FLAG = 1
097310        GO TO E211-EXIT
097320     ELSE
097330        MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK.
097340     INITIALIZE JNRST-SECOND-DTL.
097350     MOVE BORM-ACT-TYPE TO JNRST-ACC-TYPE.
097360     MOVE BORM-CAT      TO JNRST-INT-CAT.
097370     MOVE LINK-BOR-CODE TO WA-LEDG-CODE4.
097380     MOVE 0             TO WA-LEDG-CODE1.
097390     MOVE 0             TO WA-LEDG-CODE2.
097400     MOVE 0             TO WA-LEDG-CODE3.
097410     MOVE WA-LEDG-CODE  TO JNRST-LEDG-CODE.
097420     MOVE 1 TO JNRST-SUB-LEDG-CODE.
097430     MOVE WA-STORE-LST-FIN-DT TO JNRST-LST-FIN-DT.
097440     MOVE WA-STORE-TOT-TRNS TO JNRST-TOT-NO-TRNS.
097450     MOVE LINK-BOR-CODE    TO JNRST-TRAN-CODE.
097460     MOVE BORM-GROUP       TO JNRST-BOR-GROUP.
097470     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
097480     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE.
097490     MOVE 0 TO JNRST-AMOUNT.
097500     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
097510     IF  WA-MSG-ERR-FLAG = 1
097520         GO TO E211-EXIT
097530     END-IF.
097540 E211-EXIT.
097550     EXIT.
097560/
097570 E214-PROC-TRK-CREATE-AMEND.
097580     MOVE ZEROES TO JNRST-TRN-TYP.
097590     MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE.
097600     MOVE WA-TR-NA-NAME-1 TO JNRST-NAME-1.
TB0169***-- input data not anymore in scr12000/scr17000
097610***  MOVE WA-TR-NA-ADDRESS-1 TO JNRST-ADD-1.
097620***  MOVE WA-TR-NA-ADDRESS-2 TO JNRST-ADD-2.
097630***  MOVE WA-TR-NA-ADDRESS-3 TO JNRST-ADD-3.
097640***  MOVE WA-TR-NA-POST-CODE TO JRNL-RSRT-POSTCODE.
TB0169     MOVE SPACES             TO JNRST-ADD-1
TB0169                                JNRST-ADD-2
TB0169                                JNRST-ADD-3
TB0169                                JRNL-RSRT-POSTCODE.
097650     MOVE BORM-ACT-TYPE TO JNRST-TYPE.
097660     MOVE BORM-CAT TO JNRST-CAT.
097670     MOVE WA-TR-NA-PURPOSE TO JNRST-LOAN-PURPOSE.
097680     MOVE BORM-APPLIC-AMOUNT TO JNRST-APPLN-AMT.
097690     MOVE BORM-LOAN-TRM TO JNRST-TERM.
TB0169***-- ff. data not anymore used
097700*169 MOVE WA-TR-NA-ENDOW-EXP-DTE TO JNRST-ENDOW-EXP-DTE.
097710*169 MOVE WA-TR-NA-ENDOW-AMT TO JNRST-ENDOW-AMT.
TB0169     MOVE 0                       TO JNRST-ENDOW-EXP-DTE.
TB0169     MOVE 0                       TO JNRST-ENDOW-AMT.
097720     MOVE BORM-PAY-DAY TO JNRST-PAY-DAY.
097730*169 MOVE WA-TR-NA-REPAY-FREQ TO JNRST-REPAY-FREQ.
TB0169     MOVE BORM-REPAY-FREQ         TO JNRST-REPAY-FREQ.
097740     IF  STRT-AREA-TRN-NO = 17000
097750         MOVE BORM-LOAN-REPAY TO JNRST-LOAN-RPY.
097760***      MOVE WA-TR-NA-REM-REPAYS TO JNRST-TR-REM-REPAYS.
097770     IF  STRT-AREA-TRN-NO = 12000
097780         MOVE BORM-DUE-AMT TO JNRST-DUE-AMT.
097790     MOVE WA-TR-NA-APPLN-DATE TO UT0030-DATE-DDMMCCYY.
097800     PERFORM X610-UT0030-PARA THRU X619-EXIT.
097810     MOVE UT0030-BINARY-DATE TO JNRST-RENEWAL-DATE.
TB0169***-- ff. fields derived from borm or borp or default zero or space
097820*169 MOVE WA-TR-NA-INT-DAY TO JNRST-INT-DAY.
097830*169 MOVE WA-TR-NA-INT-FREQ TO JNRST-INT-FREQ.
TB0169     MOVE BORP-CAPN-DAY           TO JNRST-INT-DAY.
TB0169     MOVE BORM-INT-REST           TO JNRST-INT-FREQ.
097840     MOVE BORM-RT-INCR   TO JNRST-TR-RT-INCR.
097850     MOVE BORM-INT-RATE  TO JNRST-INT-RATE.
097860**** MOVE WA-TR-FINE-CDE TO JNRST-TR-FINE-CDE.
097870*169 MOVE WA-TR-FINE-CDE TO JNRST-FINE-CDE.
TB0169     MOVE BORM-FINE-CDE           TO JNRST-FINE-CDE.
TB0169***-- end of ff. field derived from borm or borp
TB0169***-- ff. fields get from CUSM
097880*169 MOVE WA-TR-NA-MAIL-INDIC TO JNRST-MAIL.
097890*169 MOVE WA-TR-NA-NOTICE-INDIC TO JNRST-NOTICE.
097900*169 MOVE WA-TR-NA-NOTICE-PROC  TO JNRST-NOTICE-PROCESS.
097910*169 MOVE WA-TR-NA-NOTICE-CUST-NO TO JNRST-NOTICE-CUST-NO-L.
TB0169     MOVE SPACES                  TO JNRST-MAIL
TB0169                                     JNRST-NOTICE
TB0169                                     JNRST-NOTICE-PROCESS.
TB0169     MOVE 0                       TO JNRST-NOTICE-CUST-NO-L.
TB0169***-- end of fields get from CUSM
097920     MOVE 0                   TO JNRST-LOAN-INSUR-CODE.
097930     MOVE 0                 TO JNRST-LOAN-INSUR-CUST.
097940     MOVE BORM-INT-REST TO JNRST-REST.
097950     MOVE ZEROES TO JNRST-MORTGAGE-NO.
TB0169***--?
097960     MOVE WA-OLD-CUSV-SORT-KEY TO JNRST-OLD-SORT-KEY-BOR.
097970     MOVE WA-OLD-CUSV-PCODE TO JNRST-OLD-PCODE-BOR.
TB0169***--?
097980     MOVE ZEROES   TO JNRST-SECURITY-AGE
097990                      JNRST-CONST-CDE
098000                      JNRST-SOLICITOR-CDE
098010                      JNRST-COUNCIL-CDE
098020                      JNRST-MPI-CDE
098030                      JNRST-RATIO-VAL-CDE
098040                      JNRST-REASON-ARR-CDE
098050                      JNRST-ADD-LOAN-CDE
098060                      JNRST-SOURCE-CDE.
098070     MOVE SPACES   TO JNRST-SEC-LESD-CDE
098080                      JNRST-MORTGAGE-INSU
098090                      JNRST-SPL-LOAN-CDE
098100                      JNRST-SETTLE-FEE-CDE.
098110     MOVE WA-TR-NA-FACILITY-NO TO JNRST-FACILITY-NO.
098120 E214-EXIT.
098130     EXIT.
098140/
098150 E216-PROC-TRK-PERS-DTLS.
098160     MOVE BORM-BORR-TYPE TO JNRST-BOR.
098170     MOVE BORM-GROUP TO JNRST-GROUP.
098180     MOVE BORM-SUB-GROUP TO JNRST-SUB-GROUP.
098190     MOVE BORM-INT-RATE TO JNRST-INT-RATE.
098200     MOVE WA-TR-INT-CONC TO JNRST-TR-INT-CONC.
098210     MOVE WA-TR-INT-CONC-MOV TO JNRST-TR-INT-CONC-MOV.
098220     MOVE WA-TR-INT-CONC-MOV-AD TO JNRST-TR-INT-CONC-MOV-AD.
098230     MOVE WA-TR-RT-INCR-MOV  TO JNRST-TR-RT-INCR-MOV.
098240     MOVE WA-TR-RT-INCR-MOV-AD  TO JNRST-TR-RT-INCR-MOV-AD.
098250     MOVE WA-TR-NA-DUES-START-DATE TO JNRST-DUES-START-DATE.
098260     MOVE WA-TR-REPAY-SCHED TO JNRST-TR-REPAY-SCHED.
098270     MOVE WA-TR-INT-START-DTE TO JNRST-INT-START-DTE.
098280     MOVE WA-TR-INT-METHOD TO JNRST-TR-INT-METHOD.
098290     MOVE WA-TR-NA-PEND-DUES-DATE TO JNRST-PEND-DUES-DATE.
098300     MOVE WA-TR-NA-PEND-DUES-AMT TO JNRST-PEND-DUES-AMT.
098310     MOVE WA-TR-NA-PEND-DUES-RATE TO JNRST-PEND-DUES-RATE.
098320     MOVE WA-TR-ADD-LOAN-CDE TO JNRST-TR-ADD-LOAN-CDE.
098330     MOVE WA-TR-NA-ADD-DUES-AMT TO JNRST-ADD-DUES.
098340     MOVE WA-TR-INT-CAP-PERC TO JNRST-TR-INT-CAP-PERC.
098350     MOVE WA-TR-INT-TAX-YTD TO JNRST-INT-TAX-YTD.
098360     MOVE WA-TR-NA-DISCHARGE-MTHS TO JNRST-DISCH-MTH.
098370     MOVE WA-TR-FIXED-RT-PER TO JNRST-TR-FIXED-RT-PER.
098380     MOVE WA-TR-INST-NOT-DAYS TO JNRST-TR-INST-NOT-DAYS.
098390     MOVE WA-TR-SPECIAL-LOAN-CDE TO JNRST-TR-SPECIAL-LOAN-CDE.
098400     MOVE WA-TR-REASON-ARR-CDE TO JNRST-TR-REASON-ARR-CDE.
098410     MOVE WA-TR-SOURCE-CDE TO JNRST-TR-SOURCE-CDE.
098420     MOVE WA-TR-SETTLEMENT-CDE TO JNRST-TR-SETTLEMENT-CDE.
098430     MOVE WA-TR-PL-APP-REF-DEC TO JNRST-APP-REF-DEC.
098440     MOVE BORM-MISC-DR(1) TO JNRST-MISC-DR1.
098450     MOVE BORM-LEDG-CODE(1) TO JNRST-LEDG-CDE1.
098460     MOVE BORM-SUB-LEDG(1) TO JNRST-SUB-LEDG-1.
098470     MOVE BORM-TRN-CODE(1) TO JNRST-TRN-CDE1.
098480     MOVE BORM-MISC-DR(2) TO JNRST-MISC-DR2.
098490     MOVE BORM-LEDG-CODE(2) TO JNRST-LEDG-CDE2.
098500     MOVE BORM-SUB-LEDG(2) TO JNRST-SUB-LEDG-2.
098510     MOVE BORM-TRN-CODE(2) TO JNRST-TRN-CDE2.
098520     MOVE BORM-MISC-DR(3) TO JNRST-MISC-DR3.
098530     MOVE BORM-LEDG-CODE(3) TO JNRST-LEDG-CDE3.
098540     MOVE BORM-SUB-LEDG(3) TO JNRST-SUB-LEDG-3.
098550     MOVE BORM-TRN-CODE(3) TO JNRST-TRN-CDE3.
098560 E216-EXIT.
098570     EXIT.
098580/
098590 E218-PROC-TRK-USER-CODES.
098600     MOVE BORM-DISCH-REFERENCE TO JNRST-DISCH-REFERENCE.
098610     MOVE WA-TR-SECURITY-AGE TO JNRST-SECURITY-AGE.
098620     MOVE WA-TR-SEC-METHOD-CDE TO JNRST-TR-SEC-METHOD-CDE.
098630     MOVE WA-TR-SEC-LSD-CDE TO JNRST-TR-SEC-LSD-CDE.
098640     MOVE WA-TR-CONSTRUCTION-CDE TO JNRST-CONSTR-CODE.
098650     MOVE WA-TR-COUNCIL-CODE TO JNRST-COUNCIL-CODE.
098660     MOVE WA-TR-REGISTRY-CDE TO JNRST-TR-REGISTRY-CDE.
098670     MOVE WA-TR-RATIO-VAL-CDE TO JNRST-RATIO-VAL-CDE.
098680     MOVE WA-TR-VALUER-CDE TO JNRST-TR-VALUER-CDE.
098690     MOVE WA-TR-SOLICITOR-CDE TO JNRST-TR-SOLICITOR-CDE.
098700     MOVE WA-TR-MPI-CODE TO JNRST-MPI-MORT-INSU-CDE.
098710     MOVE WA-TR-MORTGAGE-INSURANCE TO JNRST-MORTGAGE-INSU.
098720     MOVE WA-TR-NA-SERV-FEE-CDE TO JNRST-SERV-FEE-CDE.
098730     MOVE WA-TR-LOC-CDE TO JNRST-TR-LOC-CDE.
098740     MOVE WA-TR-ID-DOC TO JNRST-TR-ID-DOC.
098750     MOVE WA-TR-ID-NO TO JNRST-TR-ID-NO.
098760 E218-EXIT.
098770     EXIT.
098780
098790/
098800 E220-PROCESS-OLD-LOG.
098810     IF  STRT-AREA-TRN-NO = 12120 OR 12130
098820         GO TO E229-EXIT.
098830     IF STRT-AREA-TRN-NO = 17451
098840        MOVE 0 TO JNRST-TRN-TYP
098850        MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE
098860        MOVE WA-SEC-NAME-1 TO JNRST-NAME-1
098870        MOVE WA-SEC-NAME-2 TO JNRST-NAME-2
098880        MOVE WA-SEC-ADD-1 TO JNRST-ADD-1
098890        MOVE WA-SEC-ADD-2 TO JNRST-ADD-2
098900        MOVE WA-SEC-ADD-3 TO JNRST-ADD-3
098910        MOVE WA-SEC-ADD-POST-CODE TO JRNL-RSRT-POSTCODE
098920        GO TO E229-EXIT.
098930     IF  WA-INPUT-PARAM-TABLE(5) = 1
098940     AND WA-INPUT-PARAM-TABLE(10) = 1
098950         MOVE WA-ADV-CHQ-NO      TO JNRST-CHQ-DAYS
098960         MOVE WA-FEE-STORE TO JNRST-BOR-FEE
098970         MOVE 0 TO JNRST-DISCH-FEE
098980     ELSE
098990         IF (WA-INPUT-PARAM-TABLE(4)  = 1 AND
099000             WA-INPUT-PARAM-TABLE(10) = 1)
099010         OR WA-CREDIT-REPAY-TRCODE
099020            MOVE ST-CHQ-CLEAR-DAYS TO JNRST-CHQ-DAYS
099030            MOVE WA-DEFER-DAYS     TO JNRST-DEFER-DAYS
099040         ELSE
099050            IF WA-DEBIT-REPAY-TRCODE
099060               MOVE ZERO          TO JNRST-CHQ-DAYS
099070               MOVE WA-DEFER-DAYS TO JNRST-DEFER-DAYS
099080            ELSE
099090               MOVE ZERO TO JNRST-CHQ-DAYS
099100                            JNRST-DEFER-DAYS.
099110          IF WA-CASH-REPAY-TRCODE
099120        MOVE ST-CHQ-CLEAR-DAYS TO JNRST-DEFER-DAYS.
099140     IF  WA-INPUT-PARAM-TABLE(8) = 1
099150         MOVE WA-STORE-TXN-DT  TO JNRST-TRAN-DATE
099160     ELSE
099170         MOVE STRT-AREA-POST-DT   TO JNRST-TRAN-DATE.
099180     IF WA-INPUT-PARAM-TABLE (4) = 1
099190        MOVE 0 TO JNRST-DISCH-FEE
099200        MOVE WA-FEE-STORE TO JNRST-BOR-FEE.
099210     IF (WA-INPUT-PARAM-TABLE(17) = 1) OR
099220        (WA-INPUT-PARAM-TABLE(5)  = 1)     OR
099230        (WA-INPUT-PARAM-TABLE(4)  = 1)
099240        MOVE BORM-STORE-RATE TO JNRST-RATE.
099250     MOVE BORM-INT-INCR      TO JNRST-INT-BON-INCR.
099260     MOVE BORM-INT-ACCR      TO JNRST-INT-BON-AVAIL.
099270*
099280     IF WA-INPUT-PARAM-TABLE(5) = 1
099290        ADD BORM-INT-RATE
099300            BORM-RT-INCR
099310        GIVING JNRST-RATE.
099320*
099330     MOVE WA-DUMMY-AMT       TO JNRST-AMOUNT.
099340     IF  (WA-INPUT-PARAM-TABLE (5) = 1)
099350     AND (WA-BORM-INS-PREMIUM NOT = 0)
099360         MOVE WA-BORM-LOAN-BAL-EX-PPP TO JNRST-BALANCE
099370     ELSE
099380         MOVE BORM-LOAN-BAL      TO JNRST-BALANCE.
099390*
099400*  FOR CASH ADVANCE OR CHEQUE ADVANCE FOR UPFRONT LOANS
099410*  USED FIELDS SAVED IM PARAGRAPH M1300/M1400/M1500.
099420*
099430     IF ((WA-INPUT-PARAM-TABLE (5) = 1)
099440     AND (BORP-CAPN-METHOD NOT = " ")
099450     AND (BORP-CAPN-METHOD IS ALPHABETIC))
099460           MOVE WA-BAL-BEFORE-COMMISSION    TO JNRST-BALANCE
099470           MOVE WA-DUMMY-AMT                TO JNRST-AMOUNT.
099480     MOVE BORM-STORE-RATE        TO JNRST-RATE.
099490     IF  WA-INPUT-PARAM-TABLE(5) = 1
099500         AND  WA-DUMMY-LST-TWO = 80
099510             MOVE WA-ADV-NAME-1 TO JNRST-SECOND-DTL
099520     ELSE INITIALIZE JNRST-SECOND-DTL.
099530     IF  STRT-AREA-TRN-NO = 12440 OR 12441
099540         MOVE 0 TO JNRST-AMOUNT.
099550     IF  STRT-AREA-TRN-NO = 19091 OR 19092
099560         MOVE 0 TO JNRST-AMOUNT
099570         MOVE WA-STOP-NO TO JNRST-STOP-NO.
099580     IF  STRT-AREA-TRN-NO = 19091
099590         MOVE WA-STOP-REASON-IN TO JNRST-STOP-REASON.
S10614*099600     IF  STRT-AREA-TRN-NO = 19093 OR 19094
S10614     IF  STRT-AREA-TRN-NO = 19093 OR 19095
099610         MOVE 0 TO JNRST-AMOUNT
S10614         MOVE WA-BR0003-HOLD-AMOUNT TO JNRST-HOLD-AMOUNT.
S10614*099620         MOVE WA-HOLD-AMOUNT TO JNRST-HOLD-AMOUNT.
099630     IF  STRT-AREA-TRN-NO = 19093
S10614         MOVE WA-BR0003-HOLD-MSG TO JNRST-HOLD-REASON.
S10614*099640         MOVE WA-HOLD-REASON-IN TO JNRST-HOLD-REASON.
099650     MOVE BORM-ACT-TYPE         TO JNRST-ACC-TYPE.
099660     MOVE BORM-CAT              TO JNRST-INT-CAT.
099670     MOVE WA-STORE-LEDG-CODE TO WA-LEDG-CODE4.
099680     MOVE BORM-ACT-TYPE TO WA-TYPE.
099690     MOVE 0             TO WA-LEDG-CODE1.
099700     MOVE 0             TO WA-LEDG-CODE2.
099710     MOVE 0 TO WA-LEDG-CODE3.
099720     MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE.
099730     IF  STRT-AREA-TRN-NO = 19091 OR 19092 OR
099740                           19093 OR 19094 OR 19096 OR 19097
099750         MOVE ZERO TO JNRST-SUB-LEDG-CODE
099760     ELSE MOVE WA-REPAY-SUB-LEDG-CODE TO JNRST-SUB-LEDG-CODE.
099770     COMPUTE JNRST-ARR = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
099780     MOVE WA-STORE-LST-FIN-DT TO JNRST-LST-FIN-DT.
099790     MOVE WA-STORE-TOT-TRNS TO JNRST-TOT-NO-TRNS.
099800*****MOVE ZEROS TO JNRST-INT-BON-AVAIL
099810*****              JNRST-INT-BON-INCR.
099820     IF WA-INPUT-PARAM-TABLE (4) = 1      OR
099830          WA-INPUT-PARAM-TABLE (5) = 1
099840          MOVE  WA-MULTI-ACCT-CURR-CD         TO
099850                               JNRST-FROM-CURRENCY-CODE
099860          MOVE  WA-MULTI-CURR-AMT             TO
099870                               JNRST-TO-CURR-AMOUNT
099880          MOVE  WA-MULTI-CURR-AMT-CURR-CD     TO
099890                               JNRST-TO-CURRENCY-CODE
099900          MOVE  WA-MULTI-COMMISSION           TO
099910                               JNRST-CURR-COMMISSION
099920          MOVE  WA-MULTI-CHANGE               TO
099930                               JNRST-CURR-CHANGE
099940          MOVE  WA-MULTI-RATE-TYPE            TO
099950                               JNRST-RATE-TYPE
099960          MOVE  UT0296RA-TO-BASE-EQUIVALENT TO
099970                               JNRST-TO-BASE-EQUIVALENT
099980          MOVE  UT0296RA-EQUIV-BASE-AMOUNT  TO
099990                               JNRST-FROM-BASE-EQUIVALENT
100000          MOVE  UT0296RA-FROM-RATE  TO  JNRST-FROM-CURRENCY-RATE
100010          MOVE  UT0296RA-TO-RATE    TO  JNRST-TO-CURRENCY-RATE.
100020     IF (WA-INPUT-PARAM-TABLE (4) = 1 AND
100030        WA-INPUT-PARAM-TABLE (25) NOT = 1 AND
100040        STRT-AREA-SIGN = "-") OR
100050        (WA-INPUT-PARAM-TABLE (7) = 1 AND WA-DUMMY-LST-TWO = 55)
100060         MULTIPLY -1 BY JNRST-TO-CURR-AMOUNT
100070         MULTIPLY -1 BY JNRST-TO-BASE-EQUIVALENT
100080         MULTIPLY -1 BY JNRST-FROM-BASE-EQUIVALENT
100090     END-IF.
SC6069     IF WA-INPUT-PARAM-TABLE(7) = 1
SC6069*       AND (JNRST-TRAN-CODE = 11157 OR  11160)
SC5557        AND (JNRST-TRAN-CODE = 11157 OR  11160 OR 11155
S12770        OR  16163 OR 11163
SC6555        OR  16157 OR 16160 OR 16155)
SC6069        AND (JNRST-AMOUNT > 0)
SC6069        MULTIPLY -1 BY JNRST-AMOUNT
SC6069     END-IF.
100100 E229-EXIT.
100110     EXIT.
100120/
100130 E230-LOG-LOC.
100140********         LOG TIVATION FEE    *********
100150     IF (WA-INPUT-PARAM-TABLE(7) = 1)
100160     AND (WA-STORE-ACT-CORR-AMT = 0)
100170         GO TO E239-EXIT.
100180     IF (WA-INPUT-PARAM-TABLE(7) = 1)
100190         GO TO E231.
100200     IF  WA-ACT-FEE = 0
100210         GO TO E233.
100220 E231.
100230     MOVE STRT-AREA-EDIT-MASK TO WA-STORE-EDIT-MASK.
100240     MOVE 0 TO WA-ST-ENQ-CODE.
100250     MOVE ZEROS TO JNRST-CHQ-DAYS.
100260     MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE.
100270     MOVE BORM-BR-NO TO JNRST-HOME-BRNCH.
100280     INITIALIZE JNRST-SECOND-DTL.
100290     MOVE 02 TO JNRST-LEDG-CODE.
100300     MOVE 08 TO JNRST-SUB-LEDG-CODE.
100310     MOVE BORM-LST-FIN-DATE TO JNRST-LST-FIN-DT.
100320     MOVE BORM-NO-PER-TRN TO JNRST-TOT-NO-TRNS.
100330     MOVE ZEROS TO JNRST-INT-BON-AVAIL
100340                   JNRST-INT-BON-INCR
100350                   JNRST-INT-BON-PROJ.
100360     IF WA-INPUT-PARAM-TABLE(7) = 1
100370         MOVE  13520  TO JNRST-TRAN-CODE
100380         COMPUTE JNRST-AMOUNT = WA-STORE-ACT-CORR-AMT * -1
100390         MOVE "-" TO WA-STORE-SIGN
100400     ELSE
100410         MOVE  13510  TO JNRST-TRAN-CODE
100420         MOVE WA-ACT-FEE TO JNRST-AMOUNT
100430         MOVE "+" TO WA-STORE-SIGN.
100440     MOVE BORM-LOAN-BAL TO JNRST-BALANCE.
100450     COMPUTE JNRST-ARR = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
100460     MOVE BORM-GROUP TO WA-STORE-GROUP.
100470     MOVE BORM-SUB-GROUP TO WA-STORE-SUB-GROUP.
100480     MOVE "0000000000" TO WA-ST-TOTS-MASK1.
100490     MOVE "0800000000" TO WA-ST-TOTS-MASK2.
100500     MOVE WA-STORE-EDIT-MASK-1 TO JNRST-EDIT-MASK.
100510     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE.
100520     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
100530     IF  WA-MSG-ERR-FLAG = 1
100540         GO TO E239-EXIT.
100550     IF WA-INPUT-PARAM-TABLE(7) = 1
100560         GO TO E239-EXIT.
100570*
100580 E233.
100590     IF BORM-APPRV-DATE NOT = BORM-ADV-DATE
100600         GO TO E237.
100610     MOVE STRT-AREA-EDIT-MASK TO WA-STORE-EDIT-MASK.
100620     MOVE 52 TO WA-ST-ENQ-CODE.
100630     MOVE "2300000000" TO WA-ST-TOTS-MASK1.
100640     MOVE "2300000000" TO WA-ST-TOTS-MASK2.
100650     MOVE WA-STORE-EDIT-MASK-1 TO JNRST-EDIT-MASK.
100660     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE.
100670     MOVE  12000  TO JNRST-TRAN-CODE.
100680*
100690     MOVE WA-ADV-LOC-ACCT-NO TO UT0500CA-CUSM-NO.
100700     MOVE 1                  TO UT0500CA-CALL-CODE.
100710     PERFORM V500-CALL-UT0500 THRU V599-EXIT.
100720     IF UT0500RA-CALL-STATUS NOT = 0
100730        MOVE 0                   TO WA-MSG-ERR-FLAG
100740                                    WA-OUTPUT-ERR-MSG-NO
100750                                    JNRST-NOTICE-PROCESS
100760        MOVE SPACES              TO JNRST-MAIL
100770                                    JNRST-NOTICE
100780     ELSE
100790        MOVE UT0500RA-NAME-1 TO JNRST-NAME-1
100800        MOVE UT0500RA-NAME-2 TO JNRST-NAME-2
100810        MOVE UT0500RA-ADD-1 TO JNRST-ADD-1
100820        MOVE UT0500RA-ADD-2 TO JNRST-ADD-2
100830        MOVE UT0500RA-ADD-3 TO JNRST-ADD-3
100840        MOVE UT0500RA-POST-CODE TO JRNL-RSRT-POSTCODE.
100850     MOVE 0 TO JNRST-TRN-TYP.
100860     MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE.
100870     MOVE SPACES TO JNRST-OLD-SORT-KEY-BOR
100880                    JNRST-OLD-PCODE-BOR.
100890     MOVE BORM-ACT-TYPE TO JNRST-TYPE.
100900     MOVE BORM-CAT TO JNRST-CAT.
100910     MOVE BORM-INT-REST TO JNRST-REST.
100920     MOVE BORM-GROUP TO JNRST-GROUP.
100930     MOVE BORM-SUB-GROUP TO JNRST-SUB-GROUP.
100940     MOVE BORM-PAY-DAY TO JNRST-PAY-DAY.
100950     MOVE BORM-BORR-TYPE TO JNRST-BOR.
100960     MOVE BORM-LOAN-TRM TO JNRST-TERM.
100970     MOVE BORM-DISCH-MTHS TO JNRST-DISCH-MTH.
100980     MOVE BORM-INT-RATE TO JNRST-INT-RATE.
100990     MOVE ZERO TO JNRST-MORTGAGE-NO.
101000     MOVE BORM-MISC-DR(1) TO JNRST-MISC-DR1.
101010     MOVE BORM-LEDG-CODE(1) TO JNRST-LEDG-CDE1.
101020     MOVE BORM-TRN-CODE(1) TO JNRST-TRN-CDE1.
101030     MOVE BORM-SUB-LEDG(1) TO JNRST-SUB-LEDG-1.
101040     MOVE BORM-MISC-DR(2) TO JNRST-MISC-DR2.
101050     MOVE BORM-LEDG-CODE(2) TO JNRST-LEDG-CDE2.
101060     MOVE BORM-TRN-CODE(2) TO JNRST-TRN-CDE2.
101070     MOVE BORM-SUB-LEDG(2) TO JNRST-SUB-LEDG-2.
101080     MOVE BORM-MISC-DR(3) TO JNRST-MISC-DR3.
101090     MOVE BORM-LEDG-CODE(3) TO JNRST-LEDG-CDE3.
101100     MOVE BORM-TRN-CODE(3) TO JNRST-TRN-CDE3.
101110     MOVE BORM-SUB-LEDG(3) TO JNRST-SUB-LEDG-3.
101120     MOVE BORM-RENEWAL-DATE TO JNRST-RENEWAL-DATE.
101130     MOVE BORM-SEGMENT-CODE TO JNRST-SECURITY-AGE.
101140     MOVE BORM-CONST-CDE TO JNRST-CONST-CDE.
101150     MOVE BORM-SOLICITOR-CDE TO JNRST-SOLICITOR-CDE.
101160     MOVE BORM-COUNCIL-CDE TO JNRST-COUNCIL-CDE.
101170     MOVE BORM-SEC-LESD-CDE TO JNRST-SEC-LESD-CDE.
101180     MOVE BORM-INT-CDE TO JNRST-SERV-FEE-CDE.
101190     MOVE BORM-FINE-CDE TO JNRST-FINE-CDE.
101200     MOVE BORM-MPI-CDE TO JNRST-MPI-CDE.
101210     MOVE BORM-MORTGAGE-INSU TO JNRST-MORTGAGE-INSU.
101220     MOVE BORM-SPL-LOAN-CDE TO JNRST-SPL-LOAN-CDE.
101230     MOVE BORM-RATIO-VAL-CDE TO JNRST-RATIO-VAL-CDE.
101240     MOVE BORM-REASON-ARR-CDE TO JNRST-REASON-ARR-CDE.
101250     MOVE BORM-ADD-LOAN-CDE TO JNRST-ADD-LOAN-CDE.
101260     MOVE BORM-SOURCE-CDE TO JNRST-SOURCE-CDE.
101270     MOVE BORM-REGISTRY-CODE TO JNRST-REGISTRY-CODE.
101280     MOVE BORM-SECURITY-METHOD TO JNRST-SECURITY-METHOD.
S15418*101290     MOVE BORM-DISCH-FEE-CODE TO JNRST-SETTLE-FEE-CDE.
S15418     MOVE "Y"                 TO JNRST-SETTLE-FEE-CDE.
101300     MOVE BORM-DUE-AMT TO JNRST-DUE-AMT.
101310     MOVE ZEROES TO JNRST-APPLN-AMT
101320                    JNRST-PHONE-NO.
101330     MOVE BORM-LOAN-REPAY TO JNRST-LOAN-RPY.
101340     MOVE BORM-DUE-STRT-DATE TO JNRST-DUE-STRT.
101350     MOVE BORM-INT-START-DATE TO JNRST-INT-STRT.
101360     MOVE ZEROES TO JNRST-PEND-DUES-DATE.
101370     MOVE ZERO TO JNRST-PEND-DUES-AMT
101380                  JNRST-ADD-DUES.
101390     MOVE BORM-REM-REPAYS TO JNRST-REM-TERM.
101400     MOVE 1 TO JNRST-NEW-ACC-FLG.
101410     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
101420     IF  WA-MSG-ERR-FLAG = 1
101430         GO TO E239-EXIT.
101440 E237.
101450     MOVE 89 TO WA-ST-ENQ-CODE.
101460     MOVE WA-STORE-EDIT-MASK-1 TO JNRST-EDIT-MASK.
101470     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE.
101480     MOVE  10715  TO JNRST-TRAN-CODE.
101490     MOVE BORM-GROUP TO JNRST-BOR-GROUP.
101500     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
101510     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE.
101520     MOVE WA-ADV-AMOUNT TO JNRST-AMOUNT.
101530     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
101540     IF  WA-MSG-ERR-FLAG = 1
101550         GO TO E239-EXIT.
101560*
101570 E239-EXIT.
101580     EXIT.
101590/
101600 E240-PROCESS-LOAN-LOG.
101610*     IF  STRT-AREA-TRN-NO = 10901
101620*         MOVE IN0014-INPUT-AMOUNT TO JNRST-SDC-AMT
101630*         MOVE IN0014-INPUT-REC-SYS TO JNRST-TRF-ACCT-SYS
101640*         MOVE IN0014-INPUT-RECACC-NO  TO JNRST-TRF-ACCT
101650**         MOVE IN0014-INPUT-REC2     TO JNRST-TRF-ACCT
101660*         GO TO E249-EXIT.
101670     IF  STRT-AREA-TRN-NO = 17004
101680         MOVE WA-PROP-COST TO JNRST-PROP-COST
101690         MOVE WA-PROP-VAL TO JNRST-PROP-VALUE
101700         MOVE WA-LATEST-VAL TO JNRST-LATEST-VAL
101710         MOVE WA-VALUE-DATE TO UT0030-DATE-DDMMCCYY
101720         PERFORM X610-UT0030-PARA THRU X619-EXIT
101730         MOVE UT0030-BINARY-DATE TO JNRST-VAL-DATE
101740         MOVE WA-LAST-VALUE TO UT0030-DATE-DDMMCCYY
101750         PERFORM X610-UT0030-PARA THRU X619-EXIT
101760         MOVE UT0030-BINARY-DATE TO JNRST-LAST-VAL-DATE
101770         MOVE WA-PURCHASE-DATE TO UT0030-DATE-DDMMCCYY
101780         PERFORM X610-UT0030-PARA THRU X619-EXIT
101790         MOVE UT0030-BINARY-DATE TO JNRST-PURCHASE-DATE
101800         MOVE WA-PROP-AGE TO JNRST-PROP-AGE
101810         MOVE WA-CONSTR-CODE TO JNRST-CONSTR-CODE
101820         MOVE WA-COUNCIL-CODE TO JNRST-COUNCIL-CODE
101830         GO TO E249-EXIT.
101840     IF  STRT-AREA-TRN-NO = 17005
101850         MOVE WA-INSU-COVER TO JNRST-INS-COVER
101860         MOVE WA-INSU-DUE TO JNRST-INS-DUE
101870         MOVE WA-INSU-CO TO JNRST-INS-CO
101880         MOVE WA-POLICY-TYPE TO JNRST-POLICY-TYPE
101890         MOVE WA-INSU-DUE-DATE TO UT0030-DATE-DDMMCCYY
101900         PERFORM X610-UT0030-PARA THRU X619-EXIT
101910         MOVE UT0030-BINARY-DATE TO JNRST-DUE-DATE
101920         MOVE WA-POLICY-NO TO JNRST-POLICY-NO
101930         MOVE SPACES TO JNRST-MPI-MORT-INSU-CDE
101940         GO TO E249-EXIT.
101950     IF  STRT-AREA-TRN-NO = 17006 OR 17007
101960         MOVE WA-INSU-COVER TO JNRST-INS-COVER
101970         MOVE WA-INSU-DUE TO JNRST-INS-DUE
101980         MOVE WA-INSU-CO TO JNRST-INS-CO
101990         MOVE WA-POLICY-TYPE TO JNRST-POLICY-TYPE
102000         MOVE WA-INSU-DUE-DATE TO UT0030-DATE-DDMMCCYY
102010         PERFORM X610-UT0030-PARA THRU X619-EXIT
102020         MOVE UT0030-BINARY-DATE TO JNRST-DUE-DATE
102030         MOVE WA-POLICY-NO TO JNRST-POLICY-NO
102040         MOVE WA-MPI-MORT-INSU-CDE TO JNRST-MPI-MORT-INSU-CDE
102050         GO TO E249-EXIT.
102060     IF  STRT-AREA-TRN-NO = 17008
102070         MOVE WA-SEC-DOC-NO TO JNRST-SEC-DOC-NO
102080         MOVE WA-SEC-DOC-DESCR TO JNRST-SEC-DOC-DESCR
102090         MOVE WA-SEC-DOC-FROM-LOC TO JNRST-SEC-DOC-FROM-LOC
102100         MOVE WA-SEC-DOC-TO-LOC TO JNRST-SEC-DOC-TO-LOC
102110         GO TO E249-EXIT.
102120     IF  STRT-AREA-TRN-NO = 17009
102130         MOVE WA-REFEREE-TELL-NO TO JNRST-REFEREE-TELL-NO
102140         GO TO E249-EXIT.
102150     IF  STRT-AREA-TRN-NO = 17010
102160         MOVE WA-REFERRER TO JNRST-REFERRER
102170         MOVE WA-REF-KNOW-FLAG TO JNRST-REF-ACKNOW-FLAG
102180         GO TO E249-EXIT.
102190     IF  STRT-AREA-TRN-NO = 17012
102200         MOVE WA-TITLE-LOT-NO      TO JNRST-TITLE-LOT-NO
102210         MOVE WA-TITLE-DEP-PLAN-NO TO JNRST-TITLE-DEP-PLAN-NO
102220         MOVE WA-TITLE-FOLIO-NO    TO JNRST-TITLE-FOLIO-NO
102230         MOVE WA-TITLE-VOLUME      TO JNRST-TITLE-VOLUME
102240         MOVE WA-TITLE-STRATA-PLAN TO JNRST-TITLE-STRATA-PLAN
102250         MOVE WA-TITLE-OLD-SYSTEM-NO TO JNRST-TITLE-OLD-SYSTEM-NO
102260         MOVE WA-TITLE-BOOK        TO JNRST-TITLE-BOOK
102270         MOVE WA-TITLE-DETAILS     TO JNRST-TITLE-DETAILS
102280         MOVE WA-TITLE-SEARCH-DATE TO JNRST-TITLE-SEARCH-DATE
102290         MOVE WA-TITLE-INST-1      TO JNRST-TITLE-INST-1
102300         MOVE WA-TITLE-INST-2      TO JNRST-TITLE-INST-2
102310         MOVE WA-TITLE-AMOUNT-1    TO JNRST-TITLE-AMOUNT-1
102320         MOVE WA-TITLE-AMOUNT-2    TO JNRST-TITLE-AMOUNT-2
102330         MOVE WA-TITLE-REPAY-1     TO JNRST-TITLE-REPAY-1
102340         MOVE WA-TITLE-REPAY-2     TO JNRST-TITLE-REPAY-2
102350         MOVE WA-TITLE-IDENTIFIER  TO JNRST-TITLE-IDENTIFIER
102360         GO TO E249-EXIT.
102370     IF  STRT-AREA-TRN-NO = 17028
102380         MOVE WA-STAMPED-ACCT      TO JNRST-STAMPED-ACCT
102390         MOVE WA-STAMPED-AMT       TO JNRST-STAMPED-AMT
102400         GO TO E249-EXIT.
102410     IF  STRT-AREA-TRN-NO = 17011
102420*S12147  MOVE WA-MEMB-SOL-NAME     TO JNRST-MEMB-SOL-NAME
102430         MOVE WA-MEMB-SOL-ADD1     TO JNRST-MEMB-SOL-ADD1
102440         MOVE WA-MEMB-SOL-ADD2     TO JNRST-MEMB-SOL-ADD2
102450*S12147  MOVE WA-MEMB-SOL-ADD3     TO JNRST-MEMB-SOL-ADD3
102460         MOVE WA-MEMB-SOL-POSTCODE TO JNRST-MEMB-SOL-POSTCODE
102470*S12147  MOVE WA-MEMB-SOL-DX-NO    TO JNRST-MEMB-SOL-DX-NO
102480*S12147  MOVE WA-MEMB-SOL-DX-TOWN  TO JNRST-MEMB-SOL-DX-TOWN
S12147         MOVE WA-MEMB-EXPI-DATE    TO JNRST-MEMB-EXPI-DATE
102490         GO TO E249-EXIT.
102500     IF  STRT-AREA-TRN-NO = 17013
102510         MOVE WA-SPEC-COND-NO TO JNRST-SPEC-COND-NO
102520         MOVE WA-SPEC-COND-VERSION TO JNRST-SPEC-COND-VERSION
102530         MOVE WA-SPEC-COND-DESC TO JNRST-SPEC-COND-DESC
102540         MOVE WA-SPEC-COND-STAGE TO JNRST-SPEC-COND-STAGE
102550         MOVE WA-SPEC-COND-NO-PERIODS
102560             TO JNRST-SPEC-COND-NO-PERIODS
102570         MOVE WA-SPEC-COND-PERIOD TO JNRST-SPEC-COND-PERIOD
102580         MOVE WA-SPEC-COND-BUP-STAGE TO JNRST-SPEC-COND-BUP-STAGE
102590         PERFORM E242-MOVE-SP-COND-INSERTS THRU E242-EXIT
102600             VARYING WA-SPEC-COND-IX2 FROM 1 BY 1
102610                 UNTIL WA-SPEC-COND-IX2 > 5
102620         GO TO E249-EXIT.
102630     IF  STRT-AREA-TRN-NO = 17014 OR 17017 OR 17027
102640         MOVE WA-SP-COND-NO TO JNRST-SP-COND-NO
102650         MOVE WA-SP-COND-VERS TO JNRST-SP-COND-VERSION
102660         MOVE WA-SP-COND-DESC TO JNRST-SP-COND-DESC
102670         MOVE WA-SP-COND-RESPONSE TO JNRST-SP-COND-RESPONSE
102680         GO TO E249-EXIT.
102690     IF  STRT-AREA-TRN-NO = 17016
102700         MOVE WA-SP-COND-NUMBER TO JNRST-SP-CONDITION-NO
102710         MOVE WA-SP-COND-VERSION TO JNRST-SP-CONDITION-VERS
102720         MOVE WA-SP-COND-DESCRIP TO JNRST-SP-CONDITION-DESC
102730         MOVE WA-SP-COND-NO-PERS TO JNRST-SP-COND-NO-PERS
102740         MOVE WA-SP-COND-PER TO JNRST-SP-COND-PER
102750         MOVE WA-SP-COND-STAGE TO JNRST-SP-COND-STAGE
102760         GO TO E249-EXIT.
102770     IF  STRT-AREA-TRN-NO = 17018
102780         MOVE WA-PROP-LESSEE-NAME     TO JNRST-PROP-LESSEE-NAME
102790         MOVE WA-PROP-LEASE-START-DATE
102800                            TO JNRST-PROP-LEASE-START-DATE
102810         MOVE WA-PROP-LEASE-EXPIRY-DATE
102820                            TO JNRST-PROP-LEASE-EXPIRY-DATE
102830         MOVE WA-PROP-RENTAL-AMOUNT TO JNRST-PROP-RENTAL-AMOUNT
102840         GO TO E249-EXIT.
102850     IF STRT-AREA-TRN-NO = 17019
102860         PERFORM E244-MOVE-MORT-DETAILS THRU E244-EXIT
102870             VARYING WA-MORT-IX FROM 1 BY 1
102880             UNTIL   WA-MORT-IX > 3
102890         GO TO E249-EXIT.
102900     IF STRT-AREA-TRN-NO = 17020
102910         MOVE WA-COSN-COSIGNOR-NAME TO JNRST-COSN-COSIGNOR-NAME
102920         MOVE WA-COSN-COSIGNOR-ADD1 TO JNRST-COSN-COSIGNOR-ADD1
102930         MOVE WA-COSN-COSIGNOR-ADD2 TO JNRST-COSN-COSIGNOR-ADD2
102940         MOVE WA-COSN-COSIGNOR-ADD3 TO JNRST-COSN-COSIGNOR-ADD3
102950         MOVE WA-COSN-POSTCODE      TO JNRST-COSN-POSTCODE
102960         MOVE WA-COSN-SEC-CODE      TO JNRST-COSN-SEC-CODE
102970         MOVE WA-COSN-SEC-DESC      TO JNRST-COSN-SEC-DESC
102980         GO TO E249-EXIT.
102990     IF STRT-AREA-TRN-NO = 17021
103000         MOVE WA-JUDG-JUDGE-DATE    TO JNRST-JUDG-JUDGE-DATE
103010         MOVE WA-JUDG-JUDGE-AMOUNT  TO JNRST-JUDG-JUDGE-AMOUNT
103020         MOVE WA-JUDG-JUDGE-RATE    TO JNRST-JUDG-JUDGE-RATE
103030         MOVE WA-JUDG-SURRENDER-DATE TO JNRST-JUDG-SURRENDER-DATE
103040         MOVE WA-JUDG-JUDGE-DETAILS TO JNRST-JUDG-JUDGE-DETAILS
103050         GO TO E249-EXIT.
103060     IF STRT-AREA-TRN-NO = 17022
103070         PERFORM E243-MOVE-NEGP-DETAILS THRU E243-EXIT
103080             VARYING WA-NEGP-IX FROM 1 BY 1
103090             UNTIL   WA-NEGP-IX > 15
103100         GO TO E249-EXIT.
103110     IF STRT-AREA-TRN-NO = 17023
103120         MOVE WA-AGRE-START-DATE    TO JNRST-AGRE-START-DATE
103130         MOVE WA-AGRE-AGREED-AMT    TO JNRST-AGRE-AGREED-AMT
103140         MOVE WA-AGRE-FREQUENCY     TO JNRST-AGRE-FREQUENCY
103150         MOVE WA-AGRE-CYCLE         TO JNRST-AGRE-CYCLE
103160         MOVE WA-AGRE-CONTT-METH  TO JNRST-AGRE-CONTACT-METH
103170         MOVE WA-AGRE-ARREARS-REASON TO JNRST-AGRE-ARREARS-REASON
103180         MOVE WA-AGRE-LOAN-OFFICER   TO JNRST-AGRE-LOAN-OFFICER
103190         GO TO E249-EXIT.
103200     IF STRT-AREA-TRN-NO = 17024
103210         MOVE WA-EXTN-EXTENSION-FEES TO JNRST-EXTN-EXTENSION-FEES
103220         MOVE WA-EXTN-EXTENSION TO JNRST-EXTN-EXTENSION
103230         MOVE WA-EXTN-EXTENSION-REASON
103240                              TO JNRST-EXTN-EXTENSION-REASON
103250         MOVE WA-EXTN-LOAN-OFFICER  TO JNRST-EXTN-LOAN-OFFICER
103260         GO TO E249-EXIT.
103270     IF STRT-AREA-TRN-NO = 17025
103280         MOVE WA-COLL-COLLATERAL-TYPE
103290                              TO JNRST-COLL-COLLATERAL-TYPE
103300         MOVE WA-COLL-ABS-CODE TO JNRST-COLL-ABS-CODE
103310         MOVE WA-COLL-COLLATERAL-AMT TO JNRST-COLL-COLLATERAL-AMT
103320         MOVE WA-COLL-COLLATERAL-VAL TO JNRST-COLL-COLLATERAL-VAL
103330         MOVE WA-COLL-COLLATERAL-DESC
103340                                  TO JNRST-COLL-COLLATERAL-DESC
103350         MOVE WA-COLL-COVERAGE TO JNRST-COLL-COVERAGE
103360         MOVE WA-COLL-EXPOSURE-CODE (1)
103370                                  TO JNRST-COLL-EXPOSURE-CODE (1)
103380         MOVE WA-COLL-EXPOSURE-CODE (2)
103390                                  TO JNRST-COLL-EXPOSURE-CODE (2)
103400         MOVE WA-COLL-EXPOSURE-CODE (3)
103410                                  TO JNRST-COLL-EXPOSURE-CODE (3).
103420 E249-EXIT.
103430     EXIT.
103440/
103450 E242-MOVE-SP-COND-INSERTS.
103460     SET JNRST-SPEC-COND-IX2 TO WA-SPEC-COND-IX2.
103470     MOVE WA-SPEC-COND-DATA-DESC (WA-SPEC-COND-IX2)
103480         TO JNRST-SPEC-COND-DATA-DESC (JNRST-SPEC-COND-IX2).
103490     MOVE WA-SPEC-COND-DEFLT-DATA (WA-SPEC-COND-IX2)
103500         TO JNRST-SPEC-COND-DEFLT-DATA (JNRST-SPEC-COND-IX2).
103510 E242-EXIT.
103520     EXIT.
103530*
103540 E243-MOVE-NEGP-DETAILS.
103550     SET JNRST-NEGP-IX TO WA-NEGP-IX.
103560     MOVE WA-NEGP-START-DATE (WA-NEGP-IX)
103570         TO JNRST-NEGP-START-DATE (JNRST-NEGP-IX).
103580     MOVE WA-NEGP-CYCLE (WA-NEGP-IX)
103590         TO JNRST-NEGP-CYCLE (JNRST-NEGP-IX).
103600     MOVE WA-NEGP-FREQUENCY  (WA-NEGP-IX)
103610         TO JNRST-NEGP-FREQUENCY  (JNRST-NEGP-IX).
103620     MOVE WA-NEGP-REPAYMENT (WA-NEGP-IX)
103630         TO JNRST-NEGP-REPAYMENT (JNRST-NEGP-IX).
103640 E243-EXIT.
103650     EXIT.
103660*
103670 E244-MOVE-MORT-DETAILS.
103680     SET JNRST-MORT-IX TO WA-MORT-IX.
103690     MOVE WA-MORT-MORTGAGEE (WA-MORT-IX)
103700         TO JNRST-MORT-MORTGAGEE (JNRST-MORT-IX).
103710     MOVE WA-MORT-RANK (WA-MORT-IX)
103720         TO JNRST-MORT-RANK (JNRST-MORT-IX).
103730     MOVE WA-MORT-AMOUNT (WA-MORT-IX)
103740         TO JNRST-MORT-AMOUNT (JNRST-MORT-IX).
103750     MOVE WA-MORT-RATE (WA-MORT-IX)
103760         TO JNRST-MORT-RATE (JNRST-MORT-IX).
103770     MOVE WA-MORT-REPAYMENT (WA-MORT-IX)
103780         TO JNRST-MORT-REPAYMENT (JNRST-MORT-IX).
103790 E244-EXIT.
103800     EXIT.
103810/
103820 E250-LOG-DISCH.
103830     IF WA-DUMMY-LST-TWO = 45
103840         MOVE WA-DEP-ACCT-NO TO INVM-MEMB-CUST-AC
103850         PERFORM B1000-READ-INVM THRU B1999-EXIT
103860         IF  WA-MSG-ERR-FLAG = 1
103870             GO TO E259-EXIT
103880         ELSE
103890             MOVE INVM-BRANCH-NO TO JNRST-TRANSFER-TXN-BRANCH.
103900     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
103910                               JNRST-FROM-CURRENCY-CODE
103920                               JNRST-TO-CURRENCY-CODE.
103930     MOVE STRT-AREA-EDIT-MASK TO WA-STORE-EDIT-MASK.
103940     MOVE ZEROS TO JNRST-CHQ-DAYS.
103950     MOVE STRT-AREA-POST-DT TO JNRST-TRAN-DATE.
103960     MOVE BORM-BR-NO TO JNRST-HOME-BRNCH.
103970     INITIALIZE JNRST-SECOND-DTL.
103980     MOVE BORM-ACT-TYPE         TO JNRST-ACC-TYPE.
103990     MOVE BORM-CAT              TO JNRST-INT-CAT.
104000     MOVE WA-STORE-LEDG-CODE TO WA-LEDG-CODE4.
104010     MOVE BORM-ACT-TYPE TO WA-TYPE.
104020     MOVE 0             TO WA-LEDG-CODE1.
104030     MOVE 0             TO WA-LEDG-CODE2.
104040     MOVE 0 TO WA-LEDG-CODE3.
104050     MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE.
104060     MOVE 3 TO JNRST-SUB-LEDG-CODE.
104070     MOVE WA-STORE-LST-FIN-DT TO JNRST-LST-FIN-DT.
104080     MOVE WA-STORE-TOT-TRNS TO JNRST-TOT-NO-TRNS.
104090     MOVE ZEROS TO JNRST-INT-BON-AVAIL
104100                   JNRST-INT-BON-INCR
104110                  JNRST-INT-BON-PROJ.
SC4066     IF WA-BAD-DEBT-IND-2 > 1
SC4066        IF STRT-AREA-TRN-NO = 13046 OR 13146
SC4066                           OR 15046 OR 15146
S16235                           OR 13047 OR 13147 OR 15047 OR 15147
SC4066           MOVE WA-SAVE-BRCH-NO  TO JNRST-TRANSFER-TXN-BRANCH
SC4066        END-IF
SC8812        IF (STRT-AREA-TRN-NO = 13011 OR 13111)
SC8812*S10006    AND (WA-BAD-DEBT-IND-2 = 4)
S10006           AND (WA-BAD-DEBT-IND-2 > 1)
SC8812           CONTINUE
SC8812        ELSE
SC4066           PERFORM E400-NPL-JRNL THRU E409-EXIT
SC8812        END-IF
SC4066        GO TO E259-EXIT
SC4066     END-IF
TB0102
TB0102     IF BORP-DISCH-ENQ-REQD = "N"
NR2001*TB0102        MOVE SPACES   TO DBIO-CALL-PARAM
NR2001*TB0102                         DBIO-CALL-SYS-AREA
NR2001*TB0102                         DBIO-CALL-KEY-AREA
NR2001*TB0102                         DBIO-CALL-STATUS
NR2001*TB0102        MOVE ZERO     TO DBIO-CALL-REFER-AREA
NR2001*TB0102        MOVE 07       TO DBIO-CALL-FUNC
NR2001*TB0102        MOVE "BOR"    TO DBIO-CALL-SYS
NR2001*TB0102        MOVE BORM-KEY TO DBIO-CALL-KEY
NR2001*TB0102        MOVE 01       TO DBIO-CALL-TXN-TYPE
NR2001        INITIALIZE UTBOCTCA-CALL-AREA
NR2001        MOVE BORM-SOC-NO       TO BOCT-INST-NO
NR2001        MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO
NR2001        MOVE 0                 TO BOCT-REC-NO
NR2003*NR2001 MOVE 999999999         TO BOCT-TRN-DATE
NR2003        MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE
NR2001        MOVE 1                 TO UTBOCTCA-KEY-NO
NR2001        SET  UTBOCTCA-READNEXT TO TRUE
NR2001        MOVE 01                TO WS-BOCT-TRAN-TYPE
TB0102
TB0102        MOVE "N"      TO WA-TRAN-NO-MORE-FLAG
TB0102
SC4881        MOVE STRT-AREA-TRN-NO TO WA-DUMMY-TRN-NO
SC4881        IF BR0025CA-AGR-INT NOT = 0             
SC4881         OR BR0025CA-AGR-ARR NOT = 0            
SC4881           PERFORM Z680-GET-BUCKET-GLCC         
SC4881              THRU Z689-EXIT                    
SC4881                                                
SC4881           IF WA-MSG-ERR-FLAG NOT = 0           
SC4881              GO TO E259-EXIT                   
SC4881           END-IF                               
SC4881        END-IF                                  
SC4881                                                
TB0102        PERFORM DISCHARGE-JR01
TB0102           THRU DISCHARGE-JR01-EXIT
TB0102       UNTIL WA-TRAN-NO-MORE
TB0102          OR WA-MSG-ERR-FLAG <> 0
TB0102
SC4881        IF BR0025CA-AGR-INT NOT = 0                     
SC4881           MOVE "I"                   TO WA-PRIORITY-CDE
SC4881           MOVE BR0025CA-AGR-INT      TO JNRST-AMOUNT   
SC4881                                                        
SC4881           PERFORM CREATE-AGR-GLIF                      
SC4881              THRU CREATE-AGR-GLIF-EXIT                 
SC4881                                                        
SC4881           IF WA-MSG-ERR-FLAG NOT = 0                   
SC4881              GO TO E259-EXIT                           
SC4881           END-IF                                       
SC4881        END-IF                                          
SC4881                                                        
SC4881        IF BR0025CA-AGR-ARR NOT = 0                     
SC4881           MOVE "A"                   TO WA-PRIORITY-CDE
SC4881           MOVE BR0025CA-AGR-ARR      TO JNRST-AMOUNT   
SC4881                                                        
SC4881           PERFORM CREATE-AGR-GLIF                      
SC4881              THRU CREATE-AGR-GLIF-EXIT                 
SC4881                                                        
SC4881           IF WA-MSG-ERR-FLAG NOT = 0                   
SC4881              GO TO E259-EXIT                           
SC4881           END-IF                                       
SC4881        END-IF
SC4475**** Create force billing for interest accrual.                 
SC4475        IF WA-MSG-ERR-FLAG NOT = 0                              
SC4475           GO TO E259-EXIT                                      
SC4475        END-IF                                                  
SC4475                                                                
SC4475        IF BR0025CA-ACCRUED-INT > 0                             
SC4475           MOVE WA-DISCH-I-SUB-LEDG-CODE TO JNRST-SUB-LEDG-CODE 
SC4475           MOVE BR0025CA-ACCRUED-INT     TO JNRST-AMOUNT        
SC4475           MOVE WA-DISCH-I-TRAN-DATE     TO UT0030-DATE-DDMMCCYY
SC4475                                                                
SC4475           PERFORM CREATE-13509-JR01                            
SC4475              THRU CREATE-13509-JR01-EXIT                       
SC4475                                                                
SC4475           IF WA-MSG-ERR-FLAG NOT = 0                           
SC4475              GO TO E259-EXIT                                   
SC4475           END-IF                                               
SC4475        END-IF                                                  
SC4475                                                                
S12735        IF (BR0025CA-UNEARNT-INT-REBATE <> 0)
S12735           AND (BORM-CAPN-METHOD = "X" OR
S12735           (BORM-CAPN-METHOD = " " AND BORP-CAPN-METHOD = "X"))
S12735            MOVE 98920    TO LINK-IN-TXCODE
S12735                             JNRST-TRAN-CODE
S12735            PERFORM X700-CALL-UT0250 THRU X799-EXIT
S12735            IF WA-MSG-ERR-FLAG = 1
S12735               GO TO E259-EXIT
S12735            ELSE
S12735               MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
S12735            END-IF
S12735            MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE
S12735            MOVE 6  TO JNRST-SUB-LEDG-CODE
S12735            IF  WA-INPUT-PARAM-TABLE(7) = 1
S12735                MULTIPLY BORM-UNEARNED-INT  BY -1
S12735                               GIVING WA-040-REB
S12735            ELSE
S12735                MULTIPLY BR0025CA-UNEARNT-INT-REBATE BY 1
S12735                               GIVING WA-040-REB
S12735            END-IF
S12735            MOVE WA-040-REB TO JNRST-AMOUNT
S12735            MOVE JNRST-AMOUNT TO JNRST-FROM-BASE-EQUIVALENT
S12735                                 JNRST-TO-CURR-AMOUNT
S12735            MOVE JNRST-TO-CURR-AMOUNT
S12735                                    TO JNRST-TO-BASE-EQUIVALENT
S12735            MOVE WA-STORE-LOAN-BAL-1 TO JNRST-BALANCE
S12735            MOVE WA-STORE-ARREARS-1 TO JNRST-ARR
S12735            MOVE BORM-GROUP TO JNRST-BOR-GROUP
S12735            MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP
S12735            MOVE 0 TO WA-ST-ENQ-CODE
S12735            MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
S12735                                      JNRST-TO-CURRENCY-CODE
S12735            MOVE  WA-MULTI-ACCT-CURR-CD
S12735                                  TO JNRST-FROM-CURRENCY-CODE
S12735            PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
S12735            IF  WA-MSG-ERR-FLAG = 1
S12735                GO TO E259-EXIT
S12735            END-IF
S12735         END-IF
SC1772***     DO NOT WRITE JOURNAL FOR THE MAIN TRANSACTION SINCE
SC1772***     BUCKET AMT FOR PRINCIPAL & INTEREST HAVE BEEN WRITTEN.
SC1772*       GO TO E264
SC1772        GO TO E265
TB0102     END-IF
104120*
104130*** LOG REBATE
104140*
104150     IF BR0025CA-UNEARNT-INT-REBATE = 0
104160         GO TO E252.
TB0237     IF BORM-CAPN-METHOD = "X" OR  (BORM-CAPN-METHOD = " "          
TB0237           AND BORP-CAPN-METHOD = "X")   
TB0237        MOVE 98920    TO LINK-IN-TXCODE
TB0237                      JNRST-TRAN-CODE 
TB0237     ELSE
104170        MOVE 13507    TO LINK-IN-TXCODE
104180                      JNRST-TRAN-CODE.
104190     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
104200     IF WA-MSG-ERR-FLAG = 1
104210       GO TO E259-EXIT
104220     ELSE
104230       MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK.
104240     MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE.
104250     MOVE 6  TO JNRST-SUB-LEDG-CODE.
104260     MULTIPLY BR0025CA-UNEARNT-INT-REBATE BY -1
104270              GIVING WA-040-REB.
104280     MOVE WA-040-REB TO JNRST-AMOUNT.
044920     MOVE JNRST-AMOUNT TO JNRST-FROM-BASE-EQUIVALENT
                                JNRST-TO-CURR-AMOUNT.    
044930     MOVE JNRST-TO-CURR-AMOUNT
044940                               TO JNRST-TO-BASE-EQUIVALENT.
104290     MOVE WA-STORE-LOAN-BAL-1 TO JNRST-BALANCE.
104300     MOVE WA-STORE-ARREARS-1 TO JNRST-ARR.
104310     MOVE BORM-GROUP TO JNRST-BOR-GROUP.
104320     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
104330     MOVE 0 TO WA-ST-ENQ-CODE.
104340     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
104350                               JNRST-TO-CURRENCY-CODE.
104360     MOVE  WA-MULTI-ACCT-CURR-CD
104370                                 TO JNRST-FROM-CURRENCY-CODE
104380     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
104390     IF  WA-MSG-ERR-FLAG = 1
104400         GO TO E259-EXIT.
104410 E252.
104420*
104430*****      LOG CLOSING INTEREST
104440*
104450     IF BR0025CA-ACCRUED-INT = 0
104460         GO TO E253.
104470     MOVE  13600  TO JNRST-TRAN-CODE
104480                     LINK-IN-TXCODE.
104490     MOVE BR0025CA-ACCRUED-INT TO JNRST-AMOUNT.
104500     MOVE WA-STORE-LOAN-BAL-2 TO JNRST-BALANCE.
104510     MOVE WA-STORE-ARREARS-2 TO JNRST-ARR.
104520     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
104530     IF WA-MSG-ERR-FLAG = 1
104540       GO TO E259-EXIT
104550     ELSE
104560       MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK.
104570     MOVE BORM-GROUP TO JNRST-BOR-GROUP.
104580     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
104590     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
104600                               JNRST-TO-CURRENCY-CODE.
104610     MOVE  WA-MULTI-ACCT-CURR-CD
104620                                 TO JNRST-FROM-CURRENCY-CODE
104630     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
104640     IF  WA-MSG-ERR-FLAG = 1
104650         GO TO E259-EXIT.
104660*
104670****** LOG INTEREST TRANSFER
104680*************************************************************
104690*A GANESH ** ADDING PROCEDURE FOR INTEREST TRANSFER**********
104700     IF (BORM-INT-CODE NOT = "T")
104710     OR (BORP-REPAY-SCHED = "C")
104720         GO TO E253.
104740     MOVE  13651  TO JNRST-TRAN-CODE
104750                     LINK-IN-TXCODE.
104760*-- FIND OUT TRANSFER TXN BRANCH OF BORM-TRF-ACCT-NO
104770     MOVE JNRST-TRANSFER-TXN-BRANCH TO  WA-SAVE-TFR-TXN-BRANCH.
104780     MOVE BORM-TRF-ACCT-NO  TO INVM-MEMB-CUST-AC
104790     PERFORM B1000-READ-INVM THRU B1999-EXIT
104800     IF  WA-MSG-ERR-FLAG = 1
104810          GO TO E259-EXIT
104820     ELSE
104830          MOVE INVM-BRANCH-NO TO JNRST-TRANSFER-TXN-BRANCH
104840     END-IF.
104850*
104860*    MOVE BR0025CA-ACCRUED-INT TO JNRST-AMOUNT.
104870     COMPUTE JNRST-AMOUNT = BR0025CA-ACCRUED-INT * -1.
104880     MOVE WA-STORE-LOAN-BAL-2 TO JNRST-BALANCE.
104890     MOVE WA-STORE-ARREARS-2 TO JNRST-ARR.
104900     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
104910     IF WA-MSG-ERR-FLAG = 1
104920       GO TO E259-EXIT
104930     ELSE
104940       MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK.
104950     MOVE BORM-GROUP TO JNRST-BOR-GROUP.
104960     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
104970     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
104980                               JNRST-TO-CURRENCY-CODE.
104990     MOVE  WA-MULTI-ACCT-CURR-CD
105000                                 TO JNRST-FROM-CURRENCY-CODE
105010     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
105020     IF  WA-MSG-ERR-FLAG = 1
105030         GO TO E259-EXIT.
105040*
105050     MOVE WA-SAVE-TFR-TXN-BRANCH   TO  JNRST-TRANSFER-TXN-BRANCH.
105060*
105070*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*+*
105080******LOG INTEREST RELIEF SUBSIDY.
105090 E253.
105100     IF BR0025CA-IR-SUBSIDY = 0
105110        GO TO E254.
105120     MOVE  13550  TO JNRST-TRAN-CODE
105130                     LINK-IN-TXCODE.
105140     COMPUTE BR0025CA-IR-SUBSIDY = BR0025CA-IR-SUBSIDY * -1.
105150     MOVE BR0025CA-IR-SUBSIDY  TO JNRST-AMOUNT.
105160     MOVE WA-STORE-LOAN-BAL-3 TO JNRST-BALANCE
105170     MOVE WA-STORE-ARREARS-3 TO JNRST-ARR.
105180     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
105190     IF WA-MSG-ERR-FLAG = 1
105200       GO TO E259-EXIT
105210     ELSE
105220       MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
105230       MOVE BORM-GROUP          TO JNRST-BOR-GROUP
105240       MOVE BORM-SUB-GROUP      TO JNRST-BOR-SUB-GROUP
105250       MOVE BORM-CURRENCY-IND   TO JNRST-CURRENCY-CODE
105260                                   JNRST-TO-CURRENCY-CODE
105270       MOVE  WA-MULTI-ACCT-CURR-CD
105280                                 TO JNRST-FROM-CURRENCY-CODE
105290       PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
105300       IF  WA-MSG-ERR-FLAG = 1
105310           GO TO E259-EXIT.
105320 E254.
105330*
105340***   LOG ARREARS PENALTIES.
105350*
105360     IF BR0025CA-ARREARS-PENALTY = 0
105370        GO TO E255.
105380     MOVE  13503  TO JNRST-TRAN-CODE
105390                     LINK-IN-TXCODE.
105400     MOVE BR0025CA-ARREARS-PENALTY TO JNRST-AMOUNT.
105410     MOVE WA-STORE-LOAN-BAL-4 TO JNRST-BALANCE.
105420     MOVE WA-STORE-ARREARS-4 TO JNRST-ARR.
105430     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
105440     IF WA-MSG-ERR-FLAG = 1
105450        GO TO E259-EXIT
105460     ELSE
105470        MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
105480        MOVE BORM-GROUP          TO JNRST-BOR-GROUP
105490        MOVE BORM-SUB-GROUP      TO JNRST-BOR-SUB-GROUP
105500        MOVE BORM-CURRENCY-IND   TO JNRST-CURRENCY-CODE
105510                                    JNRST-TO-CURRENCY-CODE
105520        MOVE  WA-MULTI-ACCT-CURR-CD
105530                                 TO JNRST-FROM-CURRENCY-CODE
105540        PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
105550        IF  WA-MSG-ERR-FLAG = 1
105560           GO TO E259-EXIT.
105570 E255.
105580*
105590*    LOG CRUED FEE
105600*
105610     IF BR0025CA-ACCRUED-FEE = 0
105620        GO TO E256.
105630     MOVE  13505  TO JNRST-TRAN-CODE
105640                     LINK-IN-TXCODE.
105650     MOVE BR0025CA-ACCRUED-FEE TO JNRST-AMOUNT.
105660     MOVE WA-STORE-LOAN-BAL-5 TO JNRST-BALANCE.
105670     MOVE WA-STORE-ARREARS-5 TO JNRST-ARR.
105680     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
105690     IF WA-MSG-ERR-FLAG = 1
105700        GO TO E259-EXIT
105710     ELSE
105720        MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
105730        MOVE BORM-GROUP          TO JNRST-BOR-GROUP
105740        MOVE BORM-SUB-GROUP      TO JNRST-BOR-SUB-GROUP
105750        MOVE BORM-CURRENCY-IND   TO JNRST-CURRENCY-CODE
105760                                    JNRST-TO-CURRENCY-CODE
105770        MOVE  WA-MULTI-ACCT-CURR-CD
105780                                 TO JNRST-FROM-CURRENCY-CODE
105790        PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
105800        IF  WA-MSG-ERR-FLAG = 1
105810           GO TO E259-EXIT.
105820 E256.
105830*
105840*    LOG MISCELLANEOUS DEBITS
105850*
105860*
105870     IF BR0025CA-MISC-DEBIT = 0
105880        GO TO E257.
105890     MOVE  13610  TO JNRST-TRAN-CODE
105900                     LINK-IN-TXCODE.
105910     MOVE BR0025CA-MISC-DEBIT TO JNRST-AMOUNT.
105920     MOVE WA-STORE-LOAN-BAL-6 TO JNRST-BALANCE.
105930     MOVE WA-STORE-ARREARS-6 TO JNRST-ARR.
105940     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
105950     IF WA-MSG-ERR-FLAG = 1
105960        GO TO E259-EXIT
105970     ELSE
105980        MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
105990        MOVE BORM-GROUP          TO JNRST-BOR-GROUP
106000        MOVE BORM-SUB-GROUP      TO JNRST-BOR-SUB-GROUP
106010        MOVE BORM-CURRENCY-IND   TO JNRST-CURRENCY-CODE
106020                                    JNRST-TO-CURRENCY-CODE
106030        MOVE  WA-MULTI-ACCT-CURR-CD
106040                                 TO JNRST-FROM-CURRENCY-CODE
106050        PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
106060        IF  WA-MSG-ERR-FLAG = 1
106070           GO TO E259-EXIT.
106080*
106090*    ALL MISC DEBIT WRITTEN AS ONE TRANSACTION.
106100*
106110***  LOG MISCELLANEOUS DEBIT (1) TO JOURNAL FILE.
106120*
106130*    IF BORM-MISC-DR (1) NOT = 0
106140*       IF BORM-LEDG-CODE (1) NOT = 6
106150*          MOVE BORM-LEDG-CODE (1) TO WA-LEDG-CODE4
106160*          MOVE BORM-SUB-LEDG (1) TO JNRST-SUB-LEDG-CODE
106170*          MOVE BORM-MISC-DR (1) TO JNRST-AMOUNT
106180*          PERFORM E260-LOG-MISC-DR THRU E269-EXIT.
106190*
106200***  LOG MISCELLANEOUS DEBIT (2) TO JOURNAL FILE.
106210*
106220*    IF BORM-MISC-DR (2) NOT = 0
106230*       IF BORM-LEDG-CODE (2) NOT = 6
106240*          MOVE BORM-LEDG-CODE (2) TO WA-LEDG-CODE4
106250*          MOVE BORM-SUB-LEDG (2) TO JNRST-SUB-LEDG-CODE
106260*          MOVE BORM-MISC-DR (2) TO JNRST-AMOUNT
106270*          PERFORM E260-LOG-MISC-DR THRU E269-EXIT.
106280*
106290***  LOG MISCELLANEOUS DEBIT (3) TO JOURNAL FILE.
106300*
106310*    IF BORM-MISC-DR (3) NOT = 0
106320*       IF BORM-LEDG-CODE (3) NOT = 6
106330*          MOVE BORM-LEDG-CODE (3) TO WA-LEDG-CODE4
106340*          MOVE BORM-SUB-LEDG (3) TO JNRST-SUB-LEDG-CODE
106350*          MOVE BORM-MISC-DR (3) TO JNRST-AMOUNT
106360****       PERFORM E260-LOG-MISC-DR THRU E269-EXIT.
106370*
106380 E257.
106390*
106400***  LOG SHARE REFUND
106410*
106420     IF BR0025CA-SHARE-CAP-VAL = 0
106430        GO TO E258.
106440     MOVE WA-STORE-LEDG-CODE TO WA-LEDG-CODE4.
106450     MOVE BORM-ACT-TYPE TO WA-TYPE.
106460     MOVE 0             TO WA-LEDG-CODE1.
106470     MOVE 0             TO WA-LEDG-CODE2.
106480     MOVE 0 TO WA-LEDG-CODE3.
106490     MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE.
106500     MOVE 4  TO JNRST-SUB-LEDG-CODE.
106510     MOVE 10220 TO JNRST-TRAN-CODE
106520                   LINK-IN-TXCODE.
106530     COMPUTE BR0025CA-SHARE-CAP-VAL = BR0025CA-SHARE-CAP-VAL * -1.
106540     MOVE BR0025CA-SHARE-CAP-VAL TO JNRST-AMOUNT.
106550     MOVE WA-STORE-LOAN-BAL-7 TO JNRST-BALANCE.
106560     MOVE WA-STORE-ARREARS-7 TO JNRST-ARR.
106570     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
106580     IF WA-MSG-ERR-FLAG = 1
106590        GO TO E259-EXIT
106600     ELSE
106610        MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
106620        MOVE BORM-GROUP          TO JNRST-BOR-GROUP
106630        MOVE BORM-SUB-GROUP      TO JNRST-BOR-SUB-GROUP
106640        MOVE BORM-CURRENCY-IND   TO JNRST-CURRENCY-CODE
106650                                    JNRST-TO-CURRENCY-CODE
106660        MOVE  WA-MULTI-ACCT-CURR-CD
106670                                 TO JNRST-FROM-CURRENCY-CODE
106680        PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
106690        IF  WA-MSG-ERR-FLAG = 1
106700           GO TO E259-EXIT.
106710 E258.
106720*
106730***   LOG SHARE INTEREST REFUND
106740*
106750     IF BR0025CA-SHARE-INT-REFUND = 0
106760        GO TO E259.
106770     MOVE 10221 TO JNRST-TRAN-CODE
106780                   LINK-IN-TXCODE.
106790     COMPUTE BR0025CA-SHARE-INT-REFUND =
106800             BR0025CA-SHARE-INT-REFUND * -1.
106810     MOVE BR0025CA-SHARE-INT-REFUND TO JNRST-AMOUNT.
106820     MOVE WA-STORE-LOAN-BAL-8 TO JNRST-BALANCE.
106830     MOVE WA-STORE-ARREARS-8 TO JNRST-ARR.
106840     MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE.
106850     MOVE 5  TO JNRST-SUB-LEDG-CODE.
106860     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
106870     IF WA-MSG-ERR-FLAG = 1
106880        GO TO E259-EXIT.
106890     MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK.
106900     MOVE BORM-GROUP TO JNRST-BOR-GROUP.
106910     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
106920     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
106930                               JNRST-TO-CURRENCY-CODE.
106940     MOVE  WA-MULTI-ACCT-CURR-CD
106950                                 TO JNRST-FROM-CURRENCY-CODE
106960     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
106970     IF  WA-MSG-ERR-FLAG = 1
106980         GO TO E259-EXIT.
106990 E259.
107000*
107010***   LOG SETTLEMENT PENALTY
107020*
107030     IF BR0025CA-DISCH-PENALTY = 0
107040        GO TO E260.
107050     MOVE 13601 TO JNRST-TRAN-CODE
107060                   LINK-IN-TXCODE.
107070     MOVE BR0025CA-DISCH-PENALTY TO JNRST-AMOUNT.
107080     MOVE WA-STORE-LOAN-BAL-9 TO JNRST-BALANCE.
107090     MOVE WA-STORE-ARREARS-9 TO JNRST-ARR.
107100     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
107110     IF WA-MSG-ERR-FLAG = 1
107120        GO TO E259-EXIT
107130     ELSE
107140        MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
107150        MOVE BORM-GROUP          TO JNRST-BOR-GROUP
107160        MOVE BORM-SUB-GROUP      TO JNRST-BOR-SUB-GROUP
107170        MOVE BORM-CURRENCY-IND   TO JNRST-CURRENCY-CODE
107180                                    JNRST-TO-CURRENCY-CODE
107190        MOVE  WA-MULTI-ACCT-CURR-CD
107200                                 TO JNRST-FROM-CURRENCY-CODE
107210        MOVE LINK-BOR-CODE       TO WA-LEDG-CODE4
107220        MOVE WA-LEDG-CODE        TO JNRST-LEDG-CODE
107230        MOVE 28                  TO JNRST-SUB-LEDG-CODE
107240        PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
107250        IF  WA-MSG-ERR-FLAG = 1
107260           GO TO E259-EXIT.
107270 E260.
107280*
107290***  LOG DISCHARGE TAX.
107300*
107310     IF BR0025CA-DISCH-TAX = 0
107320        GO TO E261.
107330     MOVE "13505" TO JNRST-TRAN-CODE
107340                     LINK-IN-TXCODE.
107350     MOVE BR0025CA-DISCH-TAX TO JNRST-AMOUNT.
107360     MOVE WA-STORE-LOAN-BAL-10 TO JNRST-BALANCE.
107370     MOVE WA-STORE-ARREARS-10 TO JNRST-ARR.
107380     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
107390     IF WA-MSG-ERR-FLAG = 1
107400        GO TO E259-EXIT
107410     ELSE
107420        MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
107430        MOVE BORM-GROUP          TO JNRST-BOR-GROUP
107440        MOVE BORM-SUB-GROUP      TO JNRST-BOR-SUB-GROUP
107450        MOVE BORM-CURRENCY-IND   TO JNRST-CURRENCY-CODE
107460                                    JNRST-TO-CURRENCY-CODE
107470        MOVE  WA-MULTI-ACCT-CURR-CD
107480                                 TO JNRST-FROM-CURRENCY-CODE
107490        PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
107500        IF  WA-MSG-ERR-FLAG = 1
107510           GO TO E259-EXIT.
107520*                                                                         
107530 E261.                                                                    
107540***                                                                       
107550***  LOG BR0025CA-TOM-INFL-AMT                                            
107560***                                                                       
107570     IF BR0025CA-TOM-INFL-AMT = 0                                         
107580        GO TO E262.                                                       
107590     MOVE "13512" TO JNRST-TRAN-CODE                                      
107600                     LINK-IN-TXCODE.                                      
107610     MOVE ZEROS                 TO JNRST-AMOUNT                           
107620                                   JNRST-TOM-CR-ACRU.                     
107630     COMPUTE JNRST-AMOUNT ROUNDED =                                       
107640                                BR0025CA-TOM-INFL-AMT * 1.                
107650     MOVE BR0025CA-TOM-INFL-AMT TO JNRST-TOM-CR-ACRU.                     
107660     MOVE ZEROS                 TO JNRST-TOM-DR-ACRU.                     
107670     MOVE WA-STORE-LOAN-BAL-12  TO JNRST-BALANCE.                         
107680     MOVE WA-STORE-ARREARS-12   TO JNRST-ARR.                             
107690     PERFORM X700-CALL-UT0250   THRU X799-EXIT.                           
107700     IF WA-MSG-ERR-FLAG = 1                                               
107710       GO TO E259-EXIT                                                    
107720     ELSE                                                                 
107730       MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK.                       
107740     MOVE BORM-GROUP            TO JNRST-BOR-GROUP.                       
107750     MOVE BORM-SUB-GROUP        TO JNRST-BOR-SUB-GROUP.                   
107760     MOVE BORM-CURRENCY-IND     TO JNRST-CURRENCY-CODE                    
107770                                   JNRST-TO-CURRENCY-CODE.                
107780     MOVE  WA-MULTI-ACCT-CURR-CD                                          
107790                                TO JNRST-FROM-CURRENCY-CODE               
107800     PERFORM Z000-WRITE-JRNL    THRU Z009-EXIT                            
107810     IF  WA-MSG-ERR-FLAG = 1                                              
107820         GO TO E259-EXIT.                                                 
107830 E262.                                                                    
107840***                                                                       
107850***  LOG BR0025CA-FCC-PRNC-ADJ                                            
107860***                                                                       
107870     IF BR0025CA-FCC-PRNC-ADJ = ZERO                                      
107880        GO TO E263.                                                       
107890     MOVE "13513" TO JNRST-TRAN-CODE                                      
107900                     LINK-IN-TXCODE.                                      
107910     MOVE ZERO                  TO JNRST-AMOUNT                           
107920                                   JNRST-FCC-CR-ACRU-ADJ                  
107930                                   JNRST-FCC-DR-ACRU-ADJ                  
107940                                   JNRST-FCC-COM-ACRU-ADJ                 
107950                                   JNRST-FCC-ARR-ACRU-ADJ.                
107960     COMPUTE JNRST-AMOUNT ROUNDED =                                       
107970                                BR0025CA-FCC-PRNC-ADJ * 1.                
107980     MOVE BR0025CA-FCC-PRNC-ADJ TO JNRST-FCC-PRNC-ACRU.                   
107990     MOVE WA-STORE-LOAN-BAL-12  TO JNRST-BALANCE.                         
108000     MOVE WA-STORE-ARREARS-12   TO JNRST-ARR.                             
108010     PERFORM X700-CALL-UT0250   THRU X799-EXIT.                           
108020     IF WA-MSG-ERR-FLAG = 1                                               
108030       GO TO E259-EXIT                                                    
108040     ELSE                                                                 
108050       MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK.                       
108060     MOVE BORM-GROUP            TO JNRST-BOR-GROUP.                       
108070     MOVE BORM-SUB-GROUP        TO JNRST-BOR-SUB-GROUP.                   
108080     MOVE BORM-CURRENCY-IND     TO JNRST-CURRENCY-CODE                    
108090                                   JNRST-TO-CURRENCY-CODE.                
108100     MOVE  WA-MULTI-ACCT-CURR-CD                                          
108110                                TO JNRST-FROM-CURRENCY-CODE.              
108120     PERFORM Z000-WRITE-JRNL    THRU Z009-EXIT.                           
108130     IF  WA-MSG-ERR-FLAG = 1                                              
108140         GO TO E259-EXIT.                                                 
108150*                                                                         
108160 E263.
108170     IF BR0025CA-CGL-INT-ACCR = 0    
108180         GO TO E264.
108190     MOVE 98903    TO LINK-IN-TXCODE
108200                      JNRST-TRAN-CODE.
108210     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
108220     IF WA-MSG-ERR-FLAG = 1
108230       GO TO E259-EXIT
108240     ELSE
108250       MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK.
108260     MOVE 0 TO JNRST-LEDG-CODE.
108270     MOVE 0 TO JNRST-SUB-LEDG-CODE.
108280     MOVE BR0025CA-CGL-INT-ACCR TO JNRST-AMOUNT.   
108290     MOVE 0                  TO JNRST-BALANCE
108300                                JNRST-ARR.
108310     MOVE BORM-GROUP TO JNRST-BOR-GROUP.
108320     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
108330     MOVE 0 TO WA-ST-ENQ-CODE.
108340     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
108350                               JNRST-TO-CURRENCY-CODE.
108360     MOVE  WA-MULTI-ACCT-CURR-CD
108370                                 TO JNRST-FROM-CURRENCY-CODE
108380     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
108390     IF  WA-MSG-ERR-FLAG = 1
108400         GO TO E259-EXIT.
108410 E264.                                                                   
108420*
108430***  LOG DISCHARGE TRANSACTION
108440*
TB0102     IF STRT-AREA-TRN-NO = 13011 OR 13111
TB0102        GO TO E259-EXIT
TB0102     END-IF.
TB0102
TB0102     IF  WA-MSG-ERR-FLAG = 1
TB0102         GO TO E259-EXIT
TB0102     END-IF.
TB0102
108450     MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE.
108460     MOVE STRT-AREA-TRN-NO TO JNRST-TRAN-CODE.
108470*DISCHARGES PASS A CREDIT TO A LOAN ACCOUNT ,HENCE NEGATIVE
108480*JOURNAL AMOUNT****
108490     MOVE BR0025CA-DISCH-AMOUNT TO JNRST-AMOUNT.
108500     MULTIPLY -1 BY JNRST-AMOUNT .
108510     MOVE BORM-LOAN-BAL TO JNRST-BALANCE.
NR2001*108520     COMPUTE BORV-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001*108530     MOVE BORV-01-ARREARS TO JNRST-ARR.
NR2001     COMPUTE BOCT-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001     MOVE BOCT-01-ARREARS TO JNRST-ARR.
108540     MOVE WA-DISCH-I-SUB-LEDG-CODE TO JNRST-SUB-LEDG-CODE.
108550     MOVE BORM-STORE-RATE         TO JNRST-RATE.
108560     IF  WA-INPUT-PARAM-TABLE(10) = 1
108570         MOVE ST-CHQ-CLEAR-DAYS TO JNRST-CHQ-DAYS.
108580     MOVE WA-INPUT-EDIT-MASK-1 TO JNRST-EDIT-MASK.
108590     MOVE BORM-GROUP TO JNRST-BOR-GROUP.
108600     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
108610     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE.
108620     MOVE  WA-MULTI-ACCT-CURR-CD         TO
108630                               JNRST-FROM-CURRENCY-CODE
108640     MOVE  WA-MULTI-CURR-AMT             TO
108650                               JNRST-TO-CURR-AMOUNT
108660     MOVE  WA-MULTI-CURR-AMT-CURR-CD     TO
108670                               JNRST-TO-CURRENCY-CODE
108680     MOVE  WA-MULTI-COMMISSION           TO
108690                               JNRST-CURR-COMMISSION
108700     MOVE  WA-MULTI-CHANGE               TO
108710                               JNRST-CURR-CHANGE
108720     MOVE  WA-MULTI-RATE-TYPE            TO
108730                               JNRST-RATE-TYPE
108740     MOVE  UT0296RA-TO-BASE-EQUIVALENT TO
108750                               JNRST-TO-BASE-EQUIVALENT
108760     MOVE  UT0296RA-EQUIV-BASE-AMOUNT  TO
108770                               JNRST-FROM-BASE-EQUIVALENT
108780     MULTIPLY -1 BY JNRST-FROM-BASE-EQUIVALENT
108790                    JNRST-TO-BASE-EQUIVALENT.
108800     MOVE  UT0296RA-FROM-RATE  TO  JNRST-FROM-CURRENCY-RATE
108810     MOVE  UT0296RA-TO-RATE    TO  JNRST-TO-CURRENCY-RATE.
108820     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
108830     IF  WA-MSG-ERR-FLAG = 1
108840         GO TO E259-EXIT.
108850*
SC1772 E265.
TB0102     IF BORM-BAD-DEBT-IND = 02 OR 03 OR 52 OR 53
TB0102        MOVE "I"        TO WA-AGR-TRANSFER-FLAG
TB0102        PERFORM TRANSFER-NPL-PROCESS
TB0102           THRU TRANSFER-NPL-PROCESS-EXIT
TB0102        IF WA-MSG-ERR-FLAG NOT = 0
TB0102           GO TO E259-EXIT
TB0102        END-IF
TB0102
TB0102        MOVE "P"        TO WA-AGR-TRANSFER-FLAG
TB0102        PERFORM TRANSFER-NPL-PROCESS
TB0102           THRU TRANSFER-NPL-PROCESS-EXIT
TB0102
TB0102        IF WA-MSG-ERR-FLAG NOT = 0
TB0102           GO TO E259-EXIT
TB0102        END-IF
TB0102     END-IF.
TB0102
108860 E259-EXIT.
108870     EXIT.
TB0091/
TB0091 E250A-LOG-BUCKETS.
SC4420     IF UT0094CA-SYSTEM = SPACES
SC4420        GO TO E259D-EXIT.
TB0091     MOVE WA-INPUT-ACCT-NO          TO JNRST-CUSM-NO
TB0091     MOVE BORM-ACT-TYPE             TO JNRST-TYPE
TB0091     MOVE BORM-CAT                  TO JNRST-CAT
TB0091     MOVE BORM-GL-CLASSIFICATION-CODE TO JNRST-GL-CLASS-CODE
SC7190*SC7260     MOVE STRT-AREA-BRANCH          TO JNRST-TRANSFER-TXN-BRANCH
SC6855     IF BORP-YOUBE AND WS-TRANSFER-IND = "Y"
SC6855        MOVE WS-BORM-GL-CLASS-CODE  TO JNRST-GL-CLASS-CODE
SC6855     END-IF.
S12371     IF STRT-AREA-TRN-NO     =  17200
S12371     AND STRT-TRICKLE-TXN
S12371     AND WA-17200-FUNC = "10"
S16261*S16013        IF WA-IN-17200-2-FLAG = "Y"
S16261        IF WA-IN-17200-2-FLAG = "Y" OR "E" OR "F"
S19470                             OR "X"
S16013           MOVE WS-SAVE-GL-CLASS-CODE TO WA-SOUR-GL-CLASS-CODE
S16013        END-IF
S12371        MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
S12371        MOVE WA-SAVE-GL-ACCT-TYPE  TO JNRST-ACC-TYPE
S12371        MOVE WA-SAVE-GL-INT-CAT    TO JNRST-INT-CAT
S12371        MOVE WA-SAVE-GL-BR-NO      TO JNRST-HOME-BRNCH
S12371     END-IF.
TB0091     MOVE UT0094CA-SYSTEM           TO JNRST-SYST
TB0091     PERFORM
TB0091         VARYING WA-PTR-BK FROM 1 BY 1
TB0091*****  EXCESS PAYMENT
TB0091             UNTIL WA-PTR-BK > 15
TB0091         IF  UT0094CA-BUCKET-DUE (WA-PTR-BK) <> WA-ZERO
TB0091         AND UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) <> WA-ZERO
TB0091             MOVE UT0094CA-BUCKET-DUE (WA-PTR-BK) TO JNRST-AMOUNT
SC5824*SC4593      IF NOT STRT-ASYNC-TPS
TB0091             MOVE UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK)
TB0091                                               TO JNRST-TRAN-CODE
TB0091                                                  LINK-IN-TXCODE
S11617             IF STRT-AREA-TRN-NO = 16129
S11617             AND UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) = 16129
S11617                MOVE 16148                     TO JNRST-TRAN-CODE
S11617                                                  LINK-IN-TXCODE
S11617             END-IF
S17282             IF STRT-AREA-TRN-NO = 16102
S17282             AND UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) = 16102
S17282                MOVE 16148                     TO JNRST-TRAN-CODE
S17282                                                  LINK-IN-TXCODE
S17282             END-IF
SC5824*SC4593      ELSE
SC5824*SC4593      MOVE STRT-AREA-TRN-NO TO JNRST-TRAN-CODE
SC5824*SC4593                               LINK-IN-TXCODE
SC5824*SC4593      END-IF
S12371            IF STRT-AREA-TRN-NO     =  17200
S12371            AND STRT-TRICKLE-TXN
S15846            AND WA-17200-FUNC   NOT =  "AA"
S12371               MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
S12371               MOVE SPACES          TO JNRST-BATCH-NO
S15955*S12371        IF UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) = 18426
S15955*S12371           MOVE "B2"         TO JNRST-BATCH-NO
S15955*S12371        END-IF
S15955*S12371        IF UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) = 18431
S15955*S12371           MOVE "B6"         TO JNRST-BATCH-NO
S15955*S12371        END-IF
S15955               MOVE UT0094CA-PROMO-CODE (WA-PTR-BK)
S15955                                    TO JNRST-BATCH-NO
S12371            END-IF
S15846            IF  STRT-AREA-TRN-NO   =  17200
S15846            AND WA-17200-FUNC      =  "AA"
S15846            AND STRT-TRICKLE-TXN
S15846               IF UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) = 18413
S15846               AND PROD-CREDIT-AMC
S15846                  SET  WS-AMC-PROMO-NO TO TRUE
S15846                  MOVE WS-PROMO-NO  TO JNRST-BATCH-NO
S15846                  MOVE BORM-BR-NO   TO JNRST-BRCH
S15846               END-IF
S15846            END-IF
S17432            IF  STRT-AREA-TRN-NO   =  17200
S17432            AND STRT-TRICKLE-TXN
S19351*S17432            AND (WA-17200-FUNC = "A5" OR "A6")
S20687*S19351            AND (WA-17200-FUNC = "A5" OR "A6" OR "A7" OR "A8")
S20687            AND (WA-17200-FUNC = "A5" OR "A6" OR "A7" OR "A8" OR
S20687                                 "A9")
S17432                MOVE BORM-GL-CLASSIFICATION-CODE
S17432                                    TO JNRST-GL-CLASS-CODE
S17432                MOVE BORM-ACT-TYPE  TO JNRST-ACC-TYPE
S17432                MOVE BORM-CAT       TO JNRST-INT-CAT
S17432                MOVE BORM-BR-NO     TO JNRST-HOME-BRNCH
S17432                MOVE BORM-BR-NO     TO JNRST-BRCH
S17432            END-IF
S12417            IF  STRT-AREA-TRN-NO   =  17200
S12417            AND UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) = 13509
S12417            AND STRT-TRICKLE-TXN
S12417            AND BR0001CA-BILLING
S12417            AND WA-17200-FUNC = "10"
S12417                MOVE BORM-GL-CLASSIFICATION-CODE
S12417                                    TO JNRST-GL-CLASS-CODE
S12417                MOVE BORM-ACT-TYPE  TO JNRST-ACC-TYPE
S12417                MOVE BORM-CAT       TO JNRST-INT-CAT
S12417                MOVE BORM-BR-NO     TO JNRST-HOME-BRNCH
S12417            END-IF
S15871            IF  STRT-AREA-TRN-NO   =  17200
S15871            AND BR0001CA-ADJUST
S15871            AND WA-17200-FUNC = "10"
S15871             IF UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) = 13609
S16238*S15871         MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
S16238                MOVE WS-SAVE-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
S15871                MOVE WA-SAVE-GL-ACCT-TYPE  TO JNRST-ACC-TYPE
S15871                MOVE WA-SAVE-GL-INT-CAT    TO JNRST-INT-CAT
S15871                MOVE WA-SAVE-GL-BR-NO      TO JNRST-HOME-BRNCH
S15871             END-IF
S15871             IF UT0094CA-BUCKET-TXN-CODE (WA-PTR-BK) = 13509
S15871                MOVE BORM-GL-CLASSIFICATION-CODE
S15871                                    TO JNRST-GL-CLASS-CODE
S15871                MOVE BORM-ACT-TYPE  TO JNRST-ACC-TYPE
S15871                MOVE BORM-CAT       TO JNRST-INT-CAT
S15871                MOVE BORM-BR-NO     TO JNRST-HOME-BRNCH
S15871             END-IF
S15871            END-IF
S16559*S11847     IF STRT-AREA-TRN-NO     =  10872
S16503*S11847     AND WA-ADV-PROMO        =  'B4'
S16503*S11847        IF JNRST-TRAN-CODE   =  13509
S16559*S16503        IF (JNRST-TRAN-CODE  =  13509
S16559*S16503        AND WA-ADV-PROMO     =  'B4')
S16559*S16503        OR (JNRST-TRAN-CODE  =  18407
S16559*S16503        AND WA-ADV-PROMO     =  'B3')
S16559*S11847            MOVE SPACES       TO JNRST-BATCH-NO
S16559*S11847        ELSE
S16559*S11847            MOVE WA-ADV-PROMO TO JNRST-BATCH-NO
S16559*S11847        END-IF
S16559*S11847     END-IF
S16559            IF STRT-AREA-TRN-NO     =  10872
S16559            AND WA-ADV-PROMO        =  'B4'
S16559               IF JNRST-TRAN-CODE   =  13509
S16559                  MOVE SPACES       TO JNRST-BATCH-NO
S16559               ELSE
S16559                  MOVE WA-ADV-PROMO TO JNRST-BATCH-NO
S16559               END-IF
S16559            END-IF
S16559            IF STRT-AREA-TRN-NO     =  10872
S16559            AND WA-ADV-PROMO        =  'B3'
S16559               IF JNRST-TRAN-CODE   =  18407
S16559                  MOVE SPACES       TO JNRST-BATCH-NO
S16559               ELSE
S16559                  MOVE WA-ADV-PROMO TO JNRST-BATCH-NO
S16559               END-IF
S16559            END-IF
TB0091            PERFORM X700-CALL-UT0250 THRU X799-EXIT
TB0091            IF WA-MSG-ERR-FLAG = 0
TB0091                MOVE LINK-EDIT-TABLE    TO JNRST-EDIT-MASK
SC7260                MOVE WA-EDIT-MASK       TO WA-SAVE-PROC-BITS
SC7260                MOVE LINK-EDIT-MASK     TO FIELD-B
SC7260                CALL "UT0022" USING PUAREA
SC7260                MOVE FIELD-A TO WA-EDIT-MASK
SC7260                IF WA-INPUT-PARAM-TABLE(29) = 1
SC6854*                  14030 GEN 24056 NON-TIB
SC6854                   IF STRT-AREA-TRN-NO = 14030
SC7091                                      OR 19030
SC6854                      MOVE SOC-SETTLE-BRANCH TO
SC6854                           JNRST-TRANSFER-TXN-BRANCH
SC6854                   ELSE
SC7260                      MOVE WA-SAVE-TFR-TXN-BRANCH
SC7260                        TO JNRST-TRANSFER-TXN-BRANCH
SC9610                      IF ST-LOAN-BACKDATED-CORR-YES
S12488                      AND WA-REPAY-PROMO <> 'BA'
SC9610                         MOVE STRT-AREA-BRANCH
SC9610                              TO JNRST-TRANSFER-TXN-BRANCH
SC9610                      END-IF
SC6854                   END-IF
S15955                   IF STRT-TRICKLE-TXN
S15955                   AND STRT-AREA-TRN-NO =  17200
S15955                   AND WA-17200-FUNC    = "10"
S15955                   AND JNRST-TRAN-CODE  = 18265
S15955                       MOVE WA-SAVE-GL-BR-NO
S15955                         TO JNRST-TRANSFER-TXN-BRANCH
S15955                   END-IF
S17432                   IF STRT-TRICKLE-TXN
S17432                   AND STRT-AREA-TRN-NO =  17200
S19351*S17432                   AND (WA-17200-FUNC   = "A5" OR "A6")
S19351                   AND (WA-17200-FUNC   = "A5" OR "A6"
S20687                                       OR "A7" OR "A8" OR "A9")
S20687*S19351                                       OR "A7" OR "A8")
S17432                   AND (JNRST-TRAN-CODE = 18265 OR 18262 OR 18426)
S17432                       MOVE WA-SAVE-GL-BR-NO
S17432                         TO JNRST-TRANSFER-TXN-BRANCH
S17432                   END-IF
S15509                   IF  BORP-RECEIVABLE-MULTI
S15509                   AND WA-REPAY-PRN-RECALC-M
S15509                     IF JNRST-TRAN-CODE = 13206 OR 13285 OR 13265
S15509                                       OR 13252 OR 13225
S15509                                       OR 13306 OR 13385 OR 13365
S15509                                       OR 13352 OR 13325
S15509                        CONTINUE
S15509                     ELSE
S15509                        MOVE BORM-BR-NO
S15509                                    TO JNRST-TRANSFER-TXN-BRANCH
S15509                     END-IF
S15509                   END-IF
SC7260                ELSE
SC7260                   MOVE JNRST-HOME-BRNCH
SC7260                        TO JNRST-TRANSFER-TXN-BRANCH
SC7260                END-IF
SC8263*               IF BORP-YOUBE                       
SC8263*                  IF JNRST-HOME-BRNCH NOT =        
SC8263*                     WA-SAVE-TFR-TXN-BRANCH        
SC8263*                     MOVE WA-SAVE-TFR-TXN-BRANCH TO
SC8263*                          JNRST-TRANSFER-TXN-BRANCH
SC8263*                  ELSE                             
SC8263*                     MOVE JNRST-HOME-BRNCH TO      
SC8263*                          JNRST-TRANSFER-TXN-BRANCH
SC8263*                  END-IF                           
SC8263*               END-IF                              
TB0091                MOVE UT0094CA-BUCKET-BAL (WA-PTR-BK)
TB0091                                        TO JNRST-BALANCE
TB0091                PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
SC7260                MOVE WA-SAVE-PROC-BITS TO WA-EDIT-MASK
TB0091            END-IF
SC4463            IF WA-MSG-ERR-FLAG = 0
SC4463               AND LINK-PRIORITY-CODE = "I"
SC4463               AND ( (BOIS-LAST-ADV-PYMT-DATE > STRT-AREA-POST-DT
CS4463               OR (WA-INPUT-PARAM-TABLE (7) = 1
CS4463               AND BOIS-ARREARS-CTR = 0))      
SC6655               OR  (BORM-STAT = 50
SC8033               AND UT0094CA-MATURED-SWITCH = 1
SC6655               AND BOIS-LAST-TERM-PAID >=
SC6655                   (BORM-LOAN-TRM - BORM-REM-REPAYS)) )
SC8294               AND NOT BORP-YOUBE
S17525               AND NOT (STRT-AREA-TRN-NO = 17200
S19351*S17525                   AND (WA-17200-FUNC = "A5" OR "A6"))
S19351                   AND (WA-17200-FUNC   = "A5" OR "A6"
S19351                                       OR "A7" OR "A8"))
SC4463
SC4463               MOVE 01                   TO JNRST-SUB-LEDG-CODE
SC4463               MOVE UT0094CA-BUCKET-DUE(WA-PTR-BK) TO JNRST-AMOUNT
S15871*SC7752               IF BOIS-AGREE-IND = 2
S15871               IF BOIS-AGREE-FUNC-USE
SC7752                  COMPUTE WA-AGREE-INT-AMT =
SC7752                     WA-OLD-BOIS-AGREE-INT - BOIS-AGREE-INT-BUCKET
SC7752
SC7752                  IF WA-AGREE-INT-AMT < 0
SC7752                     COMPUTE WA-AGREE-INT-AMT =
SC7752                             WA-AGREE-INT-AMT  * -1
SC7752                  END-IF
SC7752
SC7752                  IF JNRST-AMOUNT > 0
SC7752                     SUBTRACT WA-AGREE-INT-AMT
SC7752                              FROM JNRST-AMOUNT
SC7732                  ELSE
SC7752                     ADD WA-AGREE-INT-AMT TO JNRST-AMOUNT
SC7752                  END-IF
SC7752               END-IF
S11624** FOR ADVANCE PYMT DEF INT SHLD NOT BE INCLUDED
S11624               IF (WA-OLD-BOIS-DEF-BUCKET-AMT > 0) AND
S11624                  (BOIS-DEF-INT-END-DTE < STRT-AREA-POST-DT)
S11624                  COMPUTE WA-DEF-AMORT-AMT =
S11624                     BOIS-DEF-TOT-AMT / BOIS-DEF-AMORT-TERM
S11624                  MOVE WA-DEF-AMORT-AMT      TO WA-WORK-INT
S11624                  PERFORM U000-CHECK-ZERO THRU U009-EXIT
S11624                  MOVE WA-WORK-INT           TO WA-DEF-AMORT-AMT
S11624                  IF WA-DEF-AMORT-AMT > WA-OLD-BOIS-DEF-BUCKET-AMT
S11624                     MOVE WA-OLD-BOIS-DEF-BUCKET-AMT
S11624                                             TO WA-DEF-AMORT-AMT
S11624                  END-IF
S11624                  IF JNRST-AMOUNT > 0
S11624                     SUBTRACT WA-DEF-AMORT-AMT FROM JNRST-AMOUNT
S11624                  ELSE
S11624                     ADD WA-DEF-AMORT-AMT TO JNRST-AMOUNT
S11624                  END-IF
S11624               END-IF
SC4463               MOVE STRT-AREA-POST-DT    TO UT0020-BINARY-DATE
SC4463               MOVE 1 TO UT0020-FUNCTION
SC4463               CALL "UT0020" USING UT0020-FUNCTION
SC4463                                   UT0020-DATE-AREA
SC4463                                   UT0020-BINARY-DATE
SC4463               MOVE UT0020-DATE-DDMMCCYY TO UT0030-DATE-DDMMCCYY
SC4463
SC4463               PERFORM CREATE-13509-JR01
SC4463                  THRU CREATE-13509-JR01-EXIT
SC4463
SC4463            END-IF
TB0091        END-IF
TB0091     END-PERFORM.
TB0091 E259D-EXIT.
TB0091     EXIT.
TB0091*
108880*E260-LOG-MISC-DR.
108890*    MOVE "13610" TO JNRST-TRAN-CODE.
108900*    MOVE WA-LEDG-CODE TO JNRST-LEDG-CODE.
108910*    MOVE WA-STORE-LOAN-BAL-2 TO JNRST-BALANCE.
108920*    MOVE WA-STORE-ARREARS-2 TO JNRST-ARR.
108930*    MOVE BORM-GROUP TO WA-STORE-GROUP.
108940*    MOVE BORM-SUB-GROUP TO WA-STORE-SUB-GROUP.
108950*    MOVE "+" TO WA-STORE-SIGN.
108960*    MOVE 0 TO WA-ST-ENQ-CODE.
108970*    MOVE "0700000000" TO WA-ST-TOTS-MASK2.
108980*    MOVE WA-STORE-EDIT-MASK-1 TO JNRST-EDIT-MASK.
108990*    MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE.
109000*    MOVE 01 TO WA-JRNL-FUNCTION.
109010*    CALL "SY10SEND" USING
109020*
109030*                          STARTAREA WA-JRNL-CALL-AREA.
109040*    IF  WA-JRNL-STATUS = "****"
109050*        MOVE "Y" TO CHECK-RESPONSE-JRNL-UPDATED.
109060*E269-EXIT.
109070*    EXIT.
109080/
109090 E265-LOG-BR0023-24-TXNS.
109100*
109110     MOVE WA-GEN-TXN-CODE TO JNRST-TRAN-CODE
109120                            LINK-IN-TXCODE
109130     MOVE STRT-AREA-SOC-NO TO LINK-IN-SOC-NO.
109140     MOVE 02 TO LINK-IN-CALL-CODE.
109150     CALL "UT0250" USING LINK-AREA.
109160     IF  LINK-OUT-STAT NOT = "****"
109170         MOVE 100 TO WA-OUTPUT-ERR-MSG-NO
109180         MOVE 1 TO WA-MSG-ERR-FLAG
109190         MOVE 0 TO LINK-IN-TXCODE
109200         GO TO E265-EXIT
109210     ELSE
109220         MOVE LINK-POSTING-LEVEL TO STRT-AREA-POSTING-LEVEL
109230         MOVE LINK-EDIT-MASK TO STRT-AREA-PROCESS-BITS
109240     END-IF.
109260     IF BORM-CURRENCY-IND = SOC-NATIVE-CURRENCY
109270         GO TO E265-CONT.
109290     MOVE 1              TO UT0296CA-RATE-TYPE.
109300     MOVE 0              TO UT0296CA-COMMISSION
109310                            UT0296CA-CHANGE
109320                            UT0296CA-FROM-BASE-EQUIVALENT
109330                            UT0296CA-CALL-STATUS.
109340     MOVE BORM-CURRENCY-IND  TO UT0296CA-FROM-CURRENCY
109350                            UT0296CA-TO-CURRENCY.
109360     MOVE WA-GEN-AMOUNT  TO UT0296CA-TO-AMOUNT
109370                                   UT0296CA-FROM-AMOUNT.
109380     IF WA-INPUT-PARAM-TABLE(8) = 1
109390        MOVE WA-STORE-TXN-DT TO UT0296CA-BACKDATED-DATE
109400     ELSE
109410        MOVE ZEROS TO UT0296CA-BACKDATED-DATE.
109420     MOVE ZEROS          TO UT0296CA-MULT-FROM-AMOUNT(1)
109430                            UT0296CA-MULT-FROM-AMOUNT(2)
109440                            UT0296CA-MULT-FROM-AMOUNT(3)
109450                            UT0296CA-MULT-FROM-AMOUNT(4).
109460     MOVE "LON"          TO UT0296CA-SYSTEM.
109470     MOVE SPACES         TO UT0296CA-USER-CODES-LON.
109480     MOVE 5              TO UT0296CA-CALL-CODE.
109490     CALL "UT0296" USING
109500                         UT0296-CALL-AREA
109510                         STARTAREA
109520                         SOC-PARAMS.
109530     IF UT0296CA-CALL-STATUS NOT = 0
109540         MOVE UT0296CA-CALL-STATUS TO WA-OUTPUT-ERR-MSG-NO
109550         MOVE 1 TO WA-MSG-ERR-FLAG
109560         GO TO E265-EXIT
109570     ELSE
109580         MULTIPLY UT0296RA-EQUIV-BASE-AMOUNT BY -1 GIVING
109590                                    JNRST-TO-CURR-AMOUNT
109600                                    JNRST-FROM-BASE-EQUIVALENT
109610                                    JNRST-TO-BASE-EQUIVALENT.
109620 E265-CONT.
109630       MOVE LINK-EDIT-TABLE       TO  JNRST-EDIT-MASK
109640       MOVE 0                     TO  WA-LEDG-CODE1
109650                                      WA-LEDG-CODE2
109660                                      WA-LEDG-CODE3
109670       MOVE WA-LEDG-CODE          TO  JNRST-LEDG-CODE
109680       MOVE WA-GEN-BALANCE        TO  JNRST-BALANCE
109690       MOVE WA-GEN-AMOUNT         TO  JNRST-AMOUNT 
109700       MOVE BORM-GROUP       TO  JNRST-BOR-GROUP
109710       MOVE BORM-SUB-GROUP   TO  JNRST-BOR-SUB-GROUP
109720       MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
SC9610       IF ST-LOAN-BACKDATED-CORR-YES
SC9610          MOVE WA-SAVE-DEST-BRANCH TO JNRST-TRANSFER-TXN-BRANCH.
S11200*S10229      MOVE JNRST-PROMO-NO         TO WA-13540-PROMO-NO.
S11200*S10229      IF ( JNRST-TRAN-CODE = 13540 or 13640 ) AND
S11200*S10229         ( JNRST-PROMO-NO  = 'F9'           )
S11200*S10229         MOVE JNRST-PROMO-NO      TO WA-13540-PROMO-NO
S11200*S10229         MOVE SPACES              TO JNRST-BATCH-NO
S11200*S10229         MOVE SPACES              TO JNRST-PROMO-NO
S11200*S10229      END-IF.
109730       PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
S11200*S10229      MOVE WA-13540-PROMO-NO      TO JNRST-PROMO-NO.
S11200*S10229      MOVE WA-13540-PROMO-NO      TO JNRST-BATCH-NO.
109740*
109750 E265-EXIT.
109760     EXIT.
109770/
109780***  THIS ROUTINE CALCULATES STAMP DUTY AND BANK COUNT  ***
109790***  DEBIT TAX ON THE CHEQUE ADVANCED AMOUNT.             ***
109800**
109810*
109820*E270-CALC-SD-AND-BADT.
109830*    MOVE 0 TO WA-FEE-STORE.
109840*    MOVE WA-ADV-AMOUNT TO WA-AMOUNT-STORE.
109850*    IF  BORP-BADT-WDL-AMT-5 NOT = 0
109860*        IF  WA-AMOUNT-STORE NOT < BORP-BADT-WDL-AMT-5
109870*            ADD BORP-BADT-RATE-5 TO WA-FEE-STORE
109880*            GO TO E273-CHECK-IF-CORRECTION.
109890*    IF  BORP-BADT-WDL-AMT-4 NOT = 0
109900*        IF  WA-AMOUNT-STORE NOT < BORP-BADT-WDL-AMT-4
109910*            ADD BORP-BADT-RATE-4 TO WA-FEE-STORE
109920*            GO TO E273-CHECK-IF-CORRECTION.
109930*    IF  BORP-BADT-WDL-AMT-3 NOT = 0
109940*        IF  WA-AMOUNT-STORE NOT < BORP-BADT-WDL-AMT-3
109950*            ADD BORP-BADT-RATE-3 TO WA-FEE-STORE
109960*            GO TO E273-CHECK-IF-CORRECTION.
109970*    IF  BORP-BADT-WDL-AMT-2 NOT = 0
109980*        IF  WA-AMOUNT-STORE NOT < BORP-BADT-WDL-AMT-2
109990*            ADD BORP-BADT-RATE-2 TO WA-FEE-STORE
110000*            GO TO E273-CHECK-IF-CORRECTION.
110010*    IF  BORP-BADT-WDL-AMT-1 NOT = 0
110020*        IF  WA-AMOUNT-STORE NOT < BORP-BADT-WDL-AMT-1
110030*            ADD BORP-BADT-RATE-1 TO WA-FEE-STORE.
110040*E273-CHECK-IF-CORRECTION.
110050*    ADD SOC-CHQ-TAX TO WA-FEE-STORE.
110060*    IF WA-INPUT-PARAM-TABLE(7) = 1
110070*       COMPUTE WA-FEE-STORE = WA-FEE-STORE * -1.
110080*    ADD WA-FEE-STORE TO BORM-FEE.
110090*E279-EXIT.
110100*    EXIT.
110110/
110120*E280-FIND-RATE.
110130*    MOVE WA-DMY TO WA-INT-DATE-A.
110140*    ADD 1                       TO WA-TIER-LEVEL.
110150*    IF WA-TIER-METH-1 = 1
110160*        GO TO E282
110170*    ELSE
110180*    IF WA-TIER-METH-1 = 2
110190*        GO TO E282
110200*    ELSE
110210*        MOVE 0                  TO WA-INT-RATE-A
110220*        GO TO E289-EXIT.
110230*E282.
110240*    SET BORP-I                  TO WA-TIER-LEVEL.
110250*    IF (BORP-RT-MAX-BAL(BORP-I) < BORM-LOAN-BAL) AND
110260*       (WA-TIER-LEVEL < 5)
110270*        ADD 1                   TO WA-TIER-LEVEL
110280*        GO TO E282.
110290*E288.
110300*    MOVE 10                     TO WA-TIER-SUB.
110310*E289.
110320*    IF WA-TIER-SUB = 0
110330*        MOVE 0                  TO WA-INT-RATE-A
110340*        GO TO E289-EXIT.
110350*    SET BORP-J                  TO WA-TIER-SUB.
110360*    IF BORP-RT-DT(BORP-I BORP-J) = ZEROES
110370*        SUBTRACT 1              FROM WA-TIER-SUB
110380*        GO TO E289.
110390*    IF BORP-RT-DT(BORP-I BORP-J) > WA-DMY
110400*        SUBTRACT 1              FROM WA-TIER-SUB
110410*        GO TO E289.
110420*    SET BORP-K                  TO BORP-J.
110430*    MOVE BORP-RATE(BORP-I BORP-K)
110440*                                TO WA-INT-RATE-A.
110450*E289-EXIT.
110460*    EXIT.
110470*
110480 E290-SEARCH-RATE-TABLE.
110490**** USE CALL CODE 2 AND 3 IF SHARED MEMORY
110500     MOVE BORP-SOC-NO    TO UT0298CA-CALL-SOC-NO
110510     MOVE BORP-ACCT-TYPE TO UT0298CA-CALL-ACCT-TYPE
110520     MOVE BORP-INT-CAT   TO UT0298CA-CALL-INT-CAT
110530     MOVE BORP-BASM-BASE-ID TO UT0298CA-CALL-BASE-ID
110540     MOVE BORP-BASM-RATE-ID TO UT0298CA-CALL-RATE-ID
110550     MOVE "BOR"             TO UT0298CA-CALL-SYS
110560     IF BORP-TIER-GROUP-ID = SPACES
110570         MOVE 2 TO UT0298CA-CALL-CODE
110580     ELSE
110590         MOVE 3 TO UT0298CA-CALL-CODE
110600         MOVE BORP-TIER-GROUP-ID TO UT0298CA-CALL-TIER-ID
110610         MOVE SPACES             TO UT0298CA-CALL-TIER-RATE-ID
110620         MOVE SPACES             TO UT0298CA-ACCT-TIER-ID
110630         MOVE BORM-LOAN-BAL TO UT0298CA-CALL-TIER-MAX-VAL
110640     END-IF.
110650**** USE CALL CODE 4 AND 5 TO DIRECT SEARCH DB (NOT SHAREMEM OR WS 
110660**** MOVE BORP-SOC-NO        TO UT0298CA-CALL-SOC-NO
110670**** MOVE BORP-BASM-BASE-ID  TO UT0298CA-CALL-BASE-ID
110680**** MOVE BORP-BASM-RATE-ID  TO UT0298CA-CALL-RATE-ID
110690**** MOVE BORP-TIER-GROUP-ID TO UT0298CA-CALL-TIER-ID
110700**** IF BORP-TIER-GROUP-ID = SPACES
110710****     MOVE 4 TO UT0298CA-CALL-CODE
110720**** ELSE
110730****     MOVE 5 TO UT0298CA-CALL-CODE
110740****     MOVE BORM-LOAN-BAL TO UT0298CA-CALL-TIER-MAX-VAL
110750**** END-IF.
TB0069     IF  WA-FIRST-ADV
TB0069         MOVE WA-ADV-DATE-BIN TO UT0298CA-CALL-TXN-DATE
TB0069     ELSE
110760         MOVE WA-DMY TO UT0298CA-CALL-TXN-DATE.
110770     CALL "UT0298" USING
110790                         UT0298CA-CALL-AREA.
110800     IF UT0298CA-RET-STATUS = 0
S16466         MOVE UT0298CA-CALL-TXN-DATE TO WA-SEARCH-RATE-DATE
110810         MOVE UT0298CA-RET-EFF-RATE TO WA-INT-RATE-A
S16466         PERFORM X750-SEARCH-BLDVWW THRU X759-EXIT
S16466         MOVE WA-INT-RATE-A         TO
TB0069                                       WA-INT-RATE-BASM
110820         MOVE UT0298CA-RET-EFF-DATE TO WA-INT-DATE-A
110830     ELSE
110840         MOVE 1920 TO WA-OUTPUT-ERR-MSG-NO
110850         MOVE 1    TO WA-MSG-ERR-FLAG
110860         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
110870         MOVE SPACES TO UT8500CA-INPUT-MSG
110880         STRING "BR0000:(E290) - INVALID CALL TO UT0298, "
110890                "STATUS:"    UT0298CA-RET-STATUS
110900                " FOR BORP:" UT0298CA-CALL-KEY
110910                ", ACCT:"    BORM-KEY
110920             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
110930         CALL "UT8500" USING
110950                             UT8500CA-AREA.
110960 E299A-EXIT.
110970     EXIT.
110980/
110990 E300-TELLER-TOT-PARA.
111000*IF TRANSFER READ CAST TO UPDATE DEPOSIT SIDE.
S16235*111010   IF (WA-DUMMY-LST-TWO = 45 OR 55
S16235   IF (WA-DUMMY-LST-TWO = 45 OR 55 OR 47
S12770       OR 44 OR 46 OR 48 OR 49 OR 57 OR 68 OR 69 OR 63)
S12770*S11455       OR 44 OR 46 OR 48 OR 49 OR 57 OR 68 OR 69)
S10982*S11455                OR 44 OR 46 OR 48 OR 49 OR 57 )
111020*ST0029 AND (NOT STRT-AREA-EFT-TXN)
111030   AND (NOT STRT-BATCH-TRICKLE-TXN)
111040   AND (NOT STRT-SWIFT-TXN)
111050*SC9192 AND (NOT STRT-REPOST-TXN)                                     
SC7166   AND (NOT STRT-MORTGAGE-TXN)
111060     IF  WA-INPUT-PARAM-TABLE(24)  =  1
111070       MOVE  BORM-CURRENCY-IND   TO  CASHIER-CURRENCY
111080     ELSE
111090       MOVE WS-SAVE-TXN-CURRENCY TO  CASHIER-CURRENCY
111100     END-IF
111110     MOVE 01 TO CASHIER-TOTAL-FUNCTION
111120     MOVE STRT-AREA-SOC-NO       TO CAST-SOC-NO
111130     MOVE STRT-AREA-BRANCH       TO CAST-BRANCH-NO
111140     MOVE STRT-AREA-TELL-NO      TO CAST-TELLER-NO
111150     MOVE SOC-NATIVE-CURRENCY    TO CASHIER-BASE-CURRENCY
111160     MOVE ZEROES                 TO CASHIER-AMOUNT
111170                                    CASHIER-CLOSE-INT-AVAIL
SC5651     IF WA-CAST-GEN
SC5651        MOVE "GEN"               TO CASHIER-SYSTEM
SC5651     ELSE
111180     MOVE "LON"                  TO CASHIER-SYSTEM
SC5651     END-IF
111190     CALL "UT0019" USING
111210                         STARTAREA
111220                         SOC-PARAMS
111230                         CASHIER-TOTALS
111240                         CASHIER-CALL-AREA
111250     IF CASHIER-TOTAL-STATUS NOT = 0
111260         MOVE 1         TO WA-MSG-ERR-FLAG
111270         MOVE 184                  TO WA-OUTPUT-ERR-MSG-NO
111280         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
111290         MOVE SPACES TO UT8500CA-INPUT-MSG
111300         STRING "BR0000:(C020) CAST READ ERROR, KEY-AC"
111310                CASHIER-CURRENCY ", " CASHIER-TOTAL-FUNCTION ", "
111320                CAST-KEY
111330                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
111340         CALL "UT8500" USING
111360                             UT8500CA-AREA
111370         GO TO E399-EXIT
111380     END-IF.
111390********************
111400     MOVE  WA-DUMMY-AMT  TO  WS-AMT.
111410     IF  WA-INPUT-PARAM-TABLE(24) = 1
111420         PERFORM E310-NEW-ACCT-TOTS
111430            THRU E319-EXIT
111440     ELSE
SC5647         IF STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048
SC5647            OR 16044 OR  16048 OR 16144 OR 16148
SC5647            OR 13131 OR 11144 OR 11148
S11617            OR 16129
S17282            OR 16102
SC5647            MOVE WA-TOT-TXN-AMT TO  WA-DUMMY-AMT
SC5647         ELSE
111450            MOVE  WA-SAVE-TXN-AMT  TO  WA-DUMMY-AMT
S11504            IF ( STRT-AREA-TRN-NO  =   11041 OR 11141 )
S11504                 MOVE W41-I-AMOUNT TO  WA-DUMMY-AMT
S11504            END-IF
SC5647         END-IF
111460         PERFORM E330-OLD-ACCT-TOTS
111470            THRU E339-EXIT.
111480*****MOVE 02 TO CASHIER-TOTAL-FUNCTION.
111490     IF  WA-INPUT-PARAM-TABLE(24)  =  1
111500       MOVE  BORM-CURRENCY-IND   TO  CASHIER-CURRENCY
111510     ELSE
111520       MOVE WS-SAVE-TXN-CURRENCY TO  CASHIER-CURRENCY.
111530*    IF CASHIER-CURRENCY = SPACES  OR
111540*                          SOC-NATIVE-CURRENCY
111550*        MOVE 02               TO CASHIER-TOTAL-FUNCTION
111560*    ELSE
111570*        MOVE 12               TO CASHIER-TOTAL-FUNCTION.
111580*
111590     MOVE 02                   TO CASHIER-TOTAL-FUNCTION.
111600     MOVE SOC-NATIVE-CURRENCY  TO CASHIER-BASE-CURRENCY.
111610     MOVE ZEROES               TO CASHIER-AMOUNT
111620                                  CASHIER-CLOSE-INT-AVAIL.
SC5651     IF WA-CAST-GEN
SC5651        MOVE "GEN"             TO CASHIER-SYSTEM
SC5651     ELSE
111630     MOVE "LON"                TO CASHIER-SYSTEM.
111640 E300-UT0019.
111650* CHECK THE CASHIER TOTAL STATUS ONLY WHEN UT0019 IS CALLED.
111660* (SIE YOU)
111670*
111680     IF  (NOT STRT-BATCH-TRICKLE-TXN AND NOT STRT-SWIFT-TXN)
111690*ST0029 AND (NOT STRT-AREA-EFT-TXN)
111700*SC9192 AND (NOT STRT-REPOST-TXN)                                     
SC7166     AND (NOT STRT-MORTGAGE-TXN)
SC6172*    AND (WA-INPUT-PARAM-TABLE(15)  = 1 )
SC6172     AND (WA-INPUT-PARAM-TABLE(14)  = 1 )
111720          CALL "UT0019" USING
111740                         STARTAREA
111750                         SOC-PARAMS
111760                         CASHIER-TOTALS
111770*                        CASHIER-CURRENCY
111780                         CASHIER-CALL-AREA
111790       MOVE  0   TO  WA-CAST-LOCK-FLAG
TB0144       IF CASHIER-TOTAL-STATUS = 889
TB0144          MOVE 1   TO WA-MSG-ERR-FLAG
TB0144          MOVE WA-INPUT-PROMO TO WA-OVER-RIDE
TB0144          MOVE 889 TO UT0060CA-CALL-ERROR-CODE
TB0144          PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
TB0144          IF WA-MSG-ERR-FLAG = 0
TB0144             MOVE 0    TO CASHIER-TOTAL-STATUS
TB0144                          WA-MSG-ERR-FLAG
TB0144             MOVE 889  TO WA-ERR-MSG-NO
TB0144          ELSE
TB0144             MOVE 889  TO WA-ERR-MSG-NO
TB0144             MOVE 1    TO WA-MSG-ERR-FLAG
TB0144             GO        TO E399-EXIT
TB0144          END-IF
TB0144       END-IF
111800       IF CASHIER-TOTAL-STATUS NOT = 0
TB0144          AND CASHIER-TOTAL-STATUS NOT = 889  
111810          MOVE 1         TO WA-MSG-ERR-FLAG
111820          MOVE 180                  TO WA-OUTPUT-ERR-MSG-NO
111830         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
111840         MOVE SPACES TO UT8500CA-INPUT-MSG
111850         STRING "BR0000:(E300) CAST RECORD WAS NOT WRITTEN BACK"
111860             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
111870         CALL "UT8500" USING
111890                             UT8500CA-AREA
111900         GO TO E399-EXIT.
111910 E310-1.
111920     IF  WA-INPUT-PARAM-TABLE (24) = 1  OR
111930         WA-SAVE-CHANGE-AMT  =  0
111940         GO   TO   E390-END.
111950     IF  SOC-MCURR-CHANGE-IND  =  "O"
111960       IF WA-INPUT-PARAM-TABLE(5) = 1
111970          MOVE WA-ACCT-CURR-CD        TO  WA-CHANGE-CURR
111980       ELSE
111990          MOVE WS-SAVE-TXN-CURRENCY   TO  WA-CHANGE-CURR
112000     ELSE
112010     IF  SOC-MCURR-CHANGE-IND  =  "R"
112020       IF WA-INPUT-PARAM-TABLE(5) = 1
112030          MOVE WS-SAVE-TXN-CURRENCY   TO  WA-CHANGE-CURR
112040       ELSE
112050          MOVE WA-ACCT-CURR-CD        TO  WA-CHANGE-CURR
112060     ELSE
112070       MOVE SPACES                    TO  WA-CHANGE-CURR.
112080     IF  WS-SAVE-TXN-CURRENCY  NOT =  WA-CHANGE-CURR
112090         MOVE WA-CHANGE-CURR          TO  CASHIER-CURRENCY
112100         PERFORM C000-CASHIER-CHK2  THRU  C099-EXIT.
112110     MULTIPLY WA-SAVE-CHANGE-AMT BY -1 GIVING WA-DUMMY-AMT.
112120     ADD WA-DUMMY-AMT TO CAST-BORR-DETL-AMT-R (12).
112130*    IF   CASHIER-CURRENCY  =  SOC-NATIVE-CURRENCY OR SPACES
112140*       MOVE SPACES                 TO  CASHIER-CURRENCY
112150*       MOVE    02                  TO  CASHIER-TOTAL-FUNCTION
112160*    ELSE
112170*       MOVE    12                  TO  CASHIER-TOTAL-FUNCTION.
112180     MOVE    02                     TO  CASHIER-TOTAL-FUNCTION.
112190     MOVE SOC-NATIVE-CURRENCY       TO CASHIER-BASE-CURRENCY.
112200     MOVE ZEROES                    TO CASHIER-AMOUNT
112210                                       CASHIER-CLOSE-INT-AVAIL.
SC5651     IF WA-CAST-GEN
SC5651        MOVE "GEN"                  TO  CASHIER-SYSTEM
SC5651     ELSE
112220     MOVE "LON"                     TO CASHIER-SYSTEM.
112230     PERFORM E300-UT0019.
112240 E390-END.
112250     MOVE WS-AMT                 TO WA-DUMMY-AMT.
112260     MOVE 0                      TO WA-CAST-LOCK-FLAG.
112270*
112280 E399-EXIT.
112290     EXIT.
112300 E310-NEW-ACCT-TOTS.
112310     IF  SA-CASH-TOTS(1) = "00"
112320         NEXT SENTENCE
112330     ELSE
112340         MOVE SA-CASH-TOTS(1) TO WA-I
SC5651         IF WA-CAST-GEN
SC5651            ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651         ELSE
112350         ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I).
112360     IF  SA-CASH-TOTS(2) = "00"
112370         NEXT SENTENCE
112380     ELSE
112390         MOVE SA-CASH-TOTS(2) TO WA-I
SC5651         IF WA-CAST-GEN
SC5651            ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651         ELSE
112400         ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I).
112410     IF  SA-CASH-TOTS(3) =  "00"
112420         NEXT SENTENCE
112430
112440     ELSE
112450         MOVE SA-CASH-TOTS(3) TO WA-I
SC5651         IF WA-CAST-GEN
SC5651            ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651         ELSE
112460         ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I).
112470     IF  SA-CASH-TOTS(4) = "00"
112480         NEXT SENTENCE
112490     ELSE
112500         MOVE SA-CASH-TOTS(4) TO WA-I
SC5651         IF WA-CAST-GEN
SC5651            ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651         ELSE
112510         ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I).
112520     IF  SA-CASH-TOTS(5) = "00"
112530         NEXT SENTENCE
112540     ELSE
112550         MOVE SA-CASH-TOTS(5) TO WA-I
SC5651         IF WA-CAST-GEN
SC5651            ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651         ELSE
112560         ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I).
112570 E319-EXIT.
112580     EXIT.
112590 E330-OLD-ACCT-TOTS.
112600     MOVE WA-DUMMY-AMT TO WA-DUMMY-AMT1
112610     IF  WA-INPUT-PARAM-TABLE(4) = 1 OR
112620         WA-INPUT-PARAM-TABLE(5) = 1 OR
112630         WA-INPUT-PARAM-TABLE(25) = 1 OR
112640         (STRT-AREA-TRN-NO = 13031 OR 13131 OR
112650                            13030 OR 13130 OR
112660                            13032 OR 13132 OR
112670                            13033 OR 13133 OR
112680                            13034 OR 13134 OR
112690                            13025 OR 13135 OR
112700                            13051 OR 13151 OR
112710                            13052 OR 13152 OR
112720                            13053 OR 13153 OR
112730                            13050 OR 13150 OR
112740                            13503 OR 13504 OR
112750                            10730 OR 10750 OR                            
112760                            10731 OR 10751)                              
112770          IF STRT-AREA-SIGN = "-"
112780             MOVE  WA-DUMMY-AMT  TO WA-DUMMY-AMT1
112790          ELSE
SC5612             MULTIPLY WA-DUMMY-AMT BY -1 GIVING WA-DUMMY-AMT1
SC5612          END-IF
SC5612* REVERSE SIGN IF GEN TXN BEFORE PASSING ON TO UT0019
SC5612          IF WA-CAST-GEN
SC5612             MULTIPLY -1 BY WA-DUMMY-AMT1
SC5612          END-IF.
SC6172     IF STRT-AREA-TRN-NO = 17467
SC6172        MOVE BR17467-INP-DEF-WAIVE-INT TO WA-WAIVE-AMOUNT
SC6172        SUBTRACT WA-WAIVE-AMOUNT FROM WA-DUMMY-AMT1
SC6172     END-IF
SC2383     MOVE STRT-AREA-TRN-NO   TO WA-DUMMY-USER-TCODE
SC2383     IF WA-DUMMY-CA-CUST
SC2383        COMPUTE WA-DUMMY-AMT1 = WA-INPUT-AMT - WA-MULTI-CURR-AMT
SC2383        IF  STRT-AREA-SIGN NOT = "-"
SC2383            MULTIPLY WA-DUMMY-AMT1 BY -1
SC2383                     GIVING WA-DUMMY-AMT1
SC2383        END-IF
SC2383     END-IF
112810     IF  SA-CASH-TOTS(1) = "00"
112820         GO TO E332.
112830     MOVE SA-CASH-TOTS(1) TO WA-I.
112840     IF (WA-INPUT-PARAM-TABLE(8) = 1) AND
112850        (WA-SUPERVISOR-OVERRIDE-USED = "1" OR "3") AND
112860        (WA-I < 13)
112870          IF WA-I < 7
112880            ADD 13 TO WA-I
112890          ELSE
112900            ADD 12 TO WA-I.
112910     MOVE WA-I TO SA-CASH-TOTS(1).
SC5624*ST0029     IF NOT STRT-ASYNC-TPS
SC5651     IF WA-CAST-GEN
SC5651        ADD WA-DUMMY-AMT1 TO CAST-GEN-LDGR-DETL-AMT-R(WA-I)
SC5651        ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651     ELSE
112920     ADD WA-DUMMY-AMT1 TO CAST-BORR-DETL-AMT-R(WA-I)
112930     ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I)
SC5624     END-IF.
112940 E332.
112950     IF  SA-CASH-TOTS(2) = "00"
112960         GO TO E333.
112970     MOVE SA-CASH-TOTS(2) TO WA-I.
112980     IF (WA-INPUT-PARAM-TABLE(8) = 1) AND
112990        (WA-SUPERVISOR-OVERRIDE-USED = "1" OR "3") AND
113000        (WA-I < 13)
113010          IF WA-I < 7
113020            ADD 13 TO WA-I
113030          ELSE
113040            ADD 12 TO WA-I.
113050     MOVE WA-I TO SA-CASH-TOTS(2).
113060     IF  WA-INPUT-PARAM-TABLE(25) = 1
113070         MULTIPLY WA-DUMMY-AMT1 BY -1 GIVING WA-DUMMY-AMT1
SC5651     END-IF
SC5651     IF WA-CAST-GEN
SC5651         ADD WA-DUMMY-AMT1 TO CAST-GEN-LDGR-DETL-AMT-R(WA-I)
SC5651         ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651     ELSE
113080         ADD WA-DUMMY-AMT1 TO CAST-BORR-DETL-AMT-R(WA-I)
SC5651*    ELSE
SC5651*        ADD WA-DUMMY-AMT1 TO CAST-BORR-DETL-AMT-R(WA-I).
S11004         IF STRT-AREA-TRN-NO NOT = 13011
113110            ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I)
S11004         END-IF.
113120 E333.
113130     IF  SA-CASH-TOTS(3) = "00"
113140         GO TO E334.
113150     MOVE SA-CASH-TOTS(3) TO WA-I.
113160     IF (WA-INPUT-PARAM-TABLE(8) = 1) AND
113170        (WA-SUPERVISOR-OVERRIDE-USED = "1" OR "3") AND
113180        (WA-I < 13)
113190          IF WA-I < 7
113200            ADD 13 TO WA-I
113210          ELSE
113220            ADD 12 TO WA-I.
113230     MOVE WA-I TO SA-CASH-TOTS(3).
SC5651     IF WA-CAST-GEN
SC5651        ADD WA-DUMMY-AMT1 TO CAST-GEN-LDGR-DETL-AMT-R(WA-I)
SC5651        ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651     ELSE
113240     ADD WA-DUMMY-AMT1 TO CAST-BORR-DETL-AMT-R(WA-I)
113250     ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I).
113260 E334.
113270     IF  SA-CASH-TOTS(4) = "00"
113280         GO TO E335.
113290     MOVE SA-CASH-TOTS(4) TO WA-I.
113300     IF (WA-INPUT-PARAM-TABLE(8) = 1) AND
113310        (WA-SUPERVISOR-OVERRIDE-USED = "1" OR "3") AND
113320        (WA-I < 13)
113330          IF WA-I < 7
113340            ADD 13 TO WA-I
113350          ELSE
113360            ADD 12 TO WA-I.
113370     MOVE WA-I TO SA-CASH-TOTS(4).
SC5651     IF WA-CAST-GEN
SC5651        ADD WA-DUMMY-AMT1 TO CAST-GEN-LDGR-DETL-AMT-R(WA-I)
SC5651        ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651     ELSE
113380     ADD WA-DUMMY-AMT1 TO CAST-BORR-DETL-AMT-R(WA-I)
113390     ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I).
113400 E335.
113410     IF  SA-CASH-TOTS(5) = "00"
113420         GO TO E339-EXIT.
113430     MOVE SA-CASH-TOTS(5) TO WA-I.
113440     IF (WA-INPUT-PARAM-TABLE(8) = 1) AND
113450        (WA-SUPERVISOR-OVERRIDE-USED = "1" OR "3") AND
113460        (WA-I < 13)
113470          IF WA-I < 7
113480            ADD 13 TO WA-I
113490          ELSE
113500            ADD 12 TO WA-I.
113510     MOVE WA-I TO SA-CASH-TOTS(5).
SC5651     IF WA-CAST-GEN
SC5651        ADD WA-DUMMY-AMT1 TO CAST-GEN-LDGR-DETL-AMT-R(WA-I)
SC5651        ADD 1 TO CAST-GEN-LDGR-COUN-R(WA-I)
SC5651     ELSE
113520     ADD WA-DUMMY-AMT1 TO CAST-BORR-DETL-AMT-R(WA-I)
113530     ADD 1 TO CAST-BORR-DETL-COUN-R(WA-I).
113540 E339-EXIT.
113550     EXIT.
TB0211 E400-NPL-JRNL.
SC9302     IF  BORP-YOUBE
SC9302     AND STRT-AREA-TRN-NO = 10832 OR 10872
SC9302         GO TO E409-EXIT
SC9302     END-IF.
TB0211     MOVE WA-INPUT-ACCT-NO          TO JNRST-CUSM-NO
TB0211     MOVE BORM-ACT-TYPE             TO JNRST-TYPE
TB0211     MOVE BORM-CAT                  TO JNRST-CAT
TB0211     MOVE BORM-GL-CLASSIFICATION-CODE TO JNRST-GL-CLASS-CODE
TB0211     MOVE "BOR"                      TO JNRST-SYST
SC8163     MOVE 0 TO WA-GL-INDX.
SC8163     PERFORM
SC8163         VARYING WA-GL-INDX FROM 1 BY 1
SC8163             UNTIL WA-GL-INDX > 15
SC8163         IF  UT0073CA-BUCKET-DUE(WA-GL-INDX)     <> WA-ZERO
SC8163         AND UT0073CA-BUCKET-TXN-CODE(WA-GL-INDX) <> WA-ZERO
SC8163             MOVE UT0073CA-BUCKET-DUE(WA-GL-INDX)
SC8163                                               TO JNRST-AMOUNT
SC8163             MOVE UT0073CA-BUCKET-TXN-CODE(WA-GL-INDX)
SC8163                                               TO JNRST-TRAN-CODE
SC8163                                                  LINK-IN-TXCODE
SC8163            PERFORM X700-CALL-UT0250 THRU X799-EXIT
SC8163            IF WA-MSG-ERR-FLAG = 0
SC8163                MOVE LINK-EDIT-TABLE    TO JNRST-EDIT-MASK
SC8163                MOVE UT0073CA-BUCKET-BAL (WA-GL-INDX)
SC8163                                        TO JNRST-BALANCE
SC8163                PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
SC8163            END-IF
SC8163        END-IF
SC8163     END-PERFORM.
TB0211     MOVE 0 TO WA-GL-INDX.
TB0211     PERFORM
TB0211         VARYING WA-GL-INDX FROM 1 BY 1
TB0211*SC3144      UNTIL WA-GL-INDX > 15
SC3144             UNTIL WA-GL-INDX > 5
SC3144         IF  UT0073CA-GL-BUCKET-DUE (WA-GL-INDX) <> WA-ZERO
SC3144         AND UT0073CA-GL-BUCKETS-TXN (WA-GL-INDX) <> WA-ZERO
SC3144             MOVE UT0073CA-GL-BUCKET-DUE (WA-GL-INDX)
SC3144                                               TO JNRST-AMOUNT
SC3144             MOVE UT0073CA-GL-BUCKETS-TXN(WA-GL-INDX)
TB0211                                               TO JNRST-TRAN-CODE
TB0211                                                  LINK-IN-TXCODE
TB0211            PERFORM X700-CALL-UT0250 THRU X799-EXIT
TB0211            IF WA-MSG-ERR-FLAG = 0
TB0211                MOVE LINK-EDIT-TABLE    TO JNRST-EDIT-MASK
TB0211                MOVE UT0073CA-BUCKET-BAL (WA-GL-INDX)
TB0211                                        TO JNRST-BALANCE
TB0211                PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
TB0211            END-IF
TB0211        END-IF
TB0211     END-PERFORM.
SC3173
SC3173     IF UT0073CA-MISC-INCOME NOT = 0
SC3173        MOVE UT0073CA-MISC-INCOME TO JNRST-AMOUNT
SC3173        MOVE UT0073CA-MISC-TRN-CODE TO JNRST-TRAN-CODE
SC3173                                     LINK-IN-TXCODE
S11736        MOVE BORM-ACT-TYPE         TO WA-BORM-ACT-TYPE
S11736        IF ( WA-ACT-TYPE-790 
S11736        AND  WA-BAD-DEBT-IND-2     >  2 )
S11736             MOVE "FB"             TO JNRST-BATCH-NO
S11736        END-IF
SC3173        PERFORM X700-CALL-UT0250 THRU X799-EXIT
SC3173        IF WA-MSG-ERR-FLAG = 0
SC3173           MOVE LINK-EDIT-TABLE    TO JNRST-EDIT-MASK
SC3173           PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
SC3173        END-IF
SC3173      END-IF.
S16997     IF WA-ACT-TYPE-790
S16997     OR PROD-CREDIT-SUN-AMC OR PROD-CREDIT-AMC
S16997        GO  TO  E409-EXIT.
S16997
S16997     IF UT0073CA-LATE-INT-INCR (1)  NOT   = 0
S16997        MOVE UT0073CA-LATE-INT-INCR(1)   TO JNRST-AMOUNT
S16997        COMPUTE JNRST-AMOUNT              = JNRST-AMOUNT * -1
S16997        IF  WA-INPUT-PARAM-TABLE(7)       = 0
S16997            MOVE 13530                   TO JNRST-TRAN-CODE
S16997        ELSE
S16997            MOVE 13630                   TO JNRST-TRAN-CODE
S16997        END-IF
S16997        MOVE JNRST-TRAN-CODE             TO LINK-IN-TXCODE
S16997        MOVE SPACE                       TO JNRST-BATCH-NO
S16997        PERFORM X700-CALL-UT0250 THRU X799-EXIT
S16997        IF WA-MSG-ERR-FLAG = 0
S16997           MOVE LINK-EDIT-TABLE    TO JNRST-EDIT-MASK
S16997           PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
S16997        END-IF
S16997     END-IF.
S16997     IF UT0073CA-LATE-INT-INCR (3)  NOT   = 0
S16997        MOVE UT0073CA-LATE-INT-INCR(3)   TO JNRST-AMOUNT
S16997        COMPUTE JNRST-AMOUNT              = JNRST-AMOUNT
S17144        MOVE BOIS-BAD-DEBT-TRF-DATE      TO WA-BIN-DATE
S17144        PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S17144        MOVE WA-DDMMCCYY-DATE            TO UT0030-DATE-DDMMCCYY
S17168*S17144        MOVE UT0073CA-TRN-DATE           TO WA-BIN-DATE
S17168        IF  WA-INPUT-PARAM-TABLE(8) = 1
S17168            IF WA-INPUT-PARAM-TABLE (25)  = 1
S17168               MOVE WA-DISCH-I-TRAN-DATE TO WA-DDMMCCYY-DATE
S17168            ELSE
S17168               MOVE WA-REPAY-TXN-DATE    TO WA-DDMMCCYY-DATE
S17168            END-IF
S17168        ELSE
S17168            MOVE STRT-AREA-POST-DT       TO WA-BIN-DATE
S17144            PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S17168        END-IF
S16997        IF  BOIS-BAD-DEBT-TRF-DATE        < WA-TAX-CUT-DT
S16997            MOVE 13533                   TO JNRST-TRAN-CODE
S16997        ELSE
S17144            IF UT0030-DATE-CCYY = WA-DDMMCCYY-DATE(5:4)
S16997               MOVE 13534                TO JNRST-TRAN-CODE
S17144            ELSE
S17144               MOVE 13535                TO JNRST-TRAN-CODE
S17144            END-IF
S16997        END-IF
S16997        IF  WA-INPUT-PARAM-TABLE(7)       = 1
S16997            ADD  100                     TO JNRST-TRAN-CODE
S16997            COMPUTE JNRST-AMOUNT          = JNRST-AMOUNT * -1
S16997        END-IF
S16997        MOVE JNRST-TRAN-CODE             TO LINK-IN-TXCODE
S16997        MOVE SPACE                       TO JNRST-BATCH-NO
S16997        PERFORM X700-CALL-UT0250 THRU X799-EXIT
S16997        IF WA-MSG-ERR-FLAG = 0
S16997           MOVE LINK-EDIT-TABLE    TO JNRST-EDIT-MASK
S16997           PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
S16997        END-IF
S16997     END-IF.
TB0211 E409-EXIT.
TB0211     EXIT.
TB0211/
MICAH *start here
TB0150 E410-JRNL-17047.
108170     IF BORM-INT-ACCR = 0
108180         GO TO E410-EXIT.
108100         MOVE 98903    TO LINK-IN-TXCODE
108200                      JNRST-TRAN-CODE.
108220     IF WA-MSG-ERR-FLAG = 1
108230       GO TO E410-EXIT
108240     ELSE
108210     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
113980     IF WA-MSG-ERR-FLAG = 1 GO TO E410-EXIT.
108250     MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK.
108260     MOVE 0 TO JNRST-LEDG-CODE.
108270     MOVE 0 TO JNRST-SUB-LEDG-CODE.
108280     MOVE BORM-INT-ACCR      TO JNRST-AMOUNT.
108290     MOVE 0                  TO JNRST-BALANCE
108300                                JNRST-ARR.
108310     MOVE BORM-GROUP TO JNRST-BOR-GROUP.
108320     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP.
108330     MOVE 0 TO WA-ST-ENQ-CODE.
108340     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
108350                               JNRST-TO-CURRENCY-CODE.
108360     MOVE  WA-MULTI-ACCT-CURR-CD
108370                                 TO JNRST-FROM-CURRENCY-CODE
108380     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT
108390     IF  WA-MSG-ERR-FLAG = 1
108400         GO TO E410-EXIT.
MICAH  E410-EXIT.
            EXIT.
113560/
113570*************************************************************
113580***  THIS ROUTINE READS THE TRANSACTIONS  ***
113590*************************************************************
113600*
NR2001*113610 F000-READ-BORV.
NR2001*113620     MOVE ZERO TO WA-TOTAL-REPAY.
NR2001*113630     MOVE 0    TO DBIO-CALL-REFER-AREA.
NR2001*NR0001     MOVE SPACES TO DBIO-CALL-PARAM.
NR2001*113640 F010-CONT.
NR2001*113650     MOVE 06 TO DBIO-CALL-FUNC.
NR2001*113660     MOVE "BORMBORV" TO DBIO-CALL-SYS-AREA.
NR2001*113670     MOVE BORM-SOC-NO TO WA-BORM-SOC-NO.
NR2001*113680     MOVE BORM-MEMB-CUST-AC TO WA-BORM-ACCT-NO.
NR2001*113690     MOVE WA-BORM-KEY TO DBIO-CALL-KEY-AREA.
NR2001*113700     MOVE SPACES TO DBIO-CALL-STATUS.
NR2001*113710     CALL "DBIO" USING
NR2001*
NR2001*113730                       DBIO-CALL-PARAM
NR2001*113740                       DBIO-CALL-SYS-AREA
NR2001*113750                       DBIO-CALL-KEY-AREA
NR2001*113760                       DBIO-CALL-STATUS
NR2001*113770                       BORV-RECORD-AREA
NR2001*113780                       DBIO-CALL-REFER-AREA.
NR2001*113790     IF  DBIO-CALL-STATUS = "XCOT"
NR2001*113800         GO TO F099-EXIT.
NR2001*113810     IF  DBIO-CALL-STATUS NOT = "****"
NR2001*113820         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*113830         MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*113840         STRING "BR0000 : (F000) STATUS = " DBIO-CALL-STATUS,
NR2001*113850                 " BAD READ ON BORV KEY = " DBIO-CALL-KEY-AREA
NR2001*113860             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*113870         CALL "UT8500" USING
NR2001*
NR2001*113890                             UT8500CA-AREA
NR2001*113900         MOVE 1 TO WA-MSG-ERR-FLAG
NR2001*113910         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
NR2001*113920         MOVE "BORV" TO WA-DBERR-DATA-SET
NR2001*113930         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
NR2001*113940         GO TO F099-EXIT.
NR2001*113950     IF  BORV-01-CODE NOT = 01 GO TO F010-CONT.
NR2001*113960     MOVE BORV-01-TRN-CODE TO LINK-IN-TXCODE.
NR2001*113970     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
NR2001*113980     IF WA-MSG-ERR-FLAG = 1 GO TO F099-EXIT.
NR2001*113990     MOVE LINK-EDIT-MASK TO FIELD-B.
NR2001*114000     CALL "UT0022" USING
NR2001*114010                   PUAREA.
NR2001*114020     MOVE FIELD-A TO WA-CORR-EDIT-MASK.
NR2001*114030     IF WA-CORR-PARAM-TABLE(4) NOT = 1
NR2001*114040        GO TO F010-CONT.
NR2001*114050     ADD BORV-01-AMOUNT TO WA-TOTAL-REPAY.
NR2001*114060     GO TO F010-CONT.
NR2001*114070 F099-EXIT.
NR2001*114080     EXIT.
NR2001 F000-READ-BOCT.
NR2001     MOVE ZERO TO WA-TOTAL-REPAY.
NR2001     INITIALIZE UTBOCTCA-CALL-AREA.
NR2001     MOVE STRT-AREA-SOC-NO    TO BOCT-INST-NO.
NR2001     MOVE BORM-MEMB-CUST-AC   TO BOCT-ACCT-NO.
NR2001     MOVE 0                   TO BOCT-REC-NO.
NR2001     MOVE 999999999           TO BOCT-TRN-DATE.
NR2001     MOVE 1                   TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT   TO TRUE.
NR2001 F010-CONT.
NR2001     MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO.
NR2001     MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO.
NR2001     MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO.
NR2001     MOVE BOCT-TRN-DATE       TO UTBOCTCA-CALL-DATE.
NR2001     MOVE 1                   TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT   TO TRUE.
NR2001     CALL "UTBOCT"         USING UTBOCTCA-CALL-AREA
NR2001                                 BOCT-RECORD-AREA.
NR2001     IF  UTBOCTCA-EOF
NR2001         GO TO F099-EXIT.
NR2001     IF  NOT UTBOCTCA-OK
NR2001         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001         MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001         STRING "BR0000 : (F000) BAD READ ON BOCT"
NR2001                ", CALLCODE=" UTBOCTCA-CALL-CODE
NR2001                ", STATUS="   UTBOCTCA-STATUS
NR2001                ", CALLKEY="  UTBOCTCA-CALL-KEY
NR2001             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001         CALL "UT8500" USING
NR2001                             UT8500CA-AREA
NR2001         MOVE 1 TO WA-MSG-ERR-FLAG
NR2001         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
NR2001         MOVE "BOCT" TO WA-DBERR-DATA-SET
NR2001         MOVE UTBOCTCA-STATUS TO WA-DB-ERROR
NR2001         GO TO F099-EXIT.
NR2001     IF  BOCT-TRAN-TYPE NOT = 01 GO TO F010-CONT.
NR2001     MOVE BOCT-TRN-CODE TO LINK-IN-TXCODE.
NR2001     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
NR2001     IF WA-MSG-ERR-FLAG = 1 GO TO F099-EXIT.
NR2001     MOVE LINK-EDIT-MASK TO FIELD-B.
NR2001     CALL "UT0022" USING
NR2001                   PUAREA.
NR2001     MOVE FIELD-A TO WA-CORR-EDIT-MASK.
NR2001     IF WA-CORR-PARAM-TABLE(4) NOT = 1
NR2001        GO TO F010-CONT.
NR2001     ADD BOCT-01-AMOUNT TO WA-TOTAL-REPAY.
NR2001     GO TO F010-CONT.
NR2001 F099-EXIT.
NR2001     EXIT.
114090/
114100 F100-PREP-LETTER.
114110      MOVE ZERO TO WA-TOTAL-CHRG.
114120      PERFORM VARYING GC-IDX FROM 1 BY 1
114130                   UNTIL GC-IDX = 30
114140      ADD CS0000RA-GROSS-CHR (GC-IDX)
114150                    TO WA-TOTAL-CHRG
114160      END-PERFORM
114170      IF STRT-AREA-TRN-NO = 32110
114180         MOVE BR0025-CALL-AREA TO WA-BR0025CA-DATA
114190         MOVE WA-TOTAL-REPAY   TO COR-DIS-TOTAL-REPAY
114200         MOVE WA-TOTAL-CHRG     TO COR-DIS-TOTAL-CHRG
114210         MOVE WA-DISCH-I-TRAN-DATE TO COR-DIS-EFFECTIVE-DATE
114220         MOVE WA-ACCEPT-DATE-U  TO COR-DIS-ENQUIRY-DATE
114230         MOVE "H0008"            TO CP0010CA-TRN-NO-5.
114240      IF STRT-AREA-TRN-NO = 10121
114250         MOVE "H0005"            TO CP0010CA-TRN-NO-5
114260         MOVE WA-TOTAL-CHRG      TO TRN10121-FEE-AMOUNT
NR2001*114270         MOVE BORV-01-AMOUNT     TO TRN10121-CHEQUE-AMOUNT.
NR2001         MOVE BOCT-01-AMOUNT     TO TRN10121-CHEQUE-AMOUNT.
114280      IF STRT-AREA-TRN-NO = 12410 AND WA-MSG-ERR-FLAG = 0
114290         MOVE "H0010"            TO CP0010CA-TRN-NO-5
114300         MOVE  BORM-RECORD-AREA   TO WA-BORM-DATA.
114310 F199-EXIT.
114320     EXIT.
114330/
114340 F200-RETRIEVE-CUSTOMER.
114350     MOVE STRT-AREA-SOC-NO     TO CUSM-SOC-NO.
114360     MOVE WA-TR-NA-CUSTOMER-NO TO CUSM-CUST-ACCT-NO.
114370     MOVE "CUSM" TO DBIO-CALL-SYS-AREA.
114380     MOVE CUSM-KEY TO DBIO-CALL-KEY-AREA.
114390     MOVE 71 TO DBIO-CALL-FUNC.
114400     CALL "DBIO" USING
114420
114430                                 DBIO-CALL-PARAM
114440                                 DBIO-CALL-SYS-AREA
114450                                 DBIO-CALL-KEY-AREA
114460                                 DBIO-CALL-STATUS
114470                                 CUSM-RECORD-AREA.
114480     IF  DBIO-CALL-STATUS NOT = "****"
114490       MOVE 282 TO WA-OUTPUT-ERR-MSG-NO
114500       MOVE 1 TO WA-MSG-ERR-FLAG.
114510*
114520 F209-EXIT.
114530     EXIT.
114540/
114550 F300-UPDATE-CUSTOMER.
114560     MOVE "CUSM" TO DBIO-CALL-SYS-AREA.
114570     MOVE CUSM-KEY TO DBIO-CALL-KEY-AREA.
114580     MOVE 74 TO DBIO-CALL-FUNC.
114590     CALL "DBIO" USING
114610
114620                                 DBIO-CALL-PARAM
114630                                 DBIO-CALL-SYS-AREA
114640                                 DBIO-CALL-KEY-AREA
114650                                 DBIO-CALL-STATUS
114660                                 CUSM-RECORD-AREA.
114670     IF  DBIO-CALL-STATUS NOT = "****"
114680       MOVE 1681 TO WA-OUTPUT-ERR-MSG-NO
114690       MOVE 1 TO WA-MSG-ERR-FLAG.
114700*
114710 F399-EXIT.
114720     EXIT.
TB0169/
TB0169***--start insert
       G0000-PREP-NEXT-SCRN.
           EVALUATE BORP-LOAN-CLASS
      ***----BORP-COMML (either " " or  "0")
             WHEN " "
                IF STRT-AREA-TRN-NO = 12000 OR 17000
                   PERFORM G0100-PREPARE-12007 THRU G0109-EXIT
                ELSE
S17908*            IF  (STRT-AREA-TRN-NO   = 12007 OR 17037)
S17908             IF   STRT-AREA-TRN-NO   = 12007
S16588*                   AND (BOIS-NEGO-RATE-IND = "2")
S16588               IF (BOIS-NEGO-RATE-IND = "2")
                       PERFORM G000-PREPARE-17026 THRU G999-EXIT
S16588               ELSE
S16588                 PERFORM G100-PREPARE-17085 THRU G100-EXIT
S16588               END-IF
                   END-IF
                END-IF
SC2676       WHEN "4"
             WHEN "0"
                IF STRT-AREA-TRN-NO = 12000 OR 17000
                   PERFORM G0100-PREPARE-12007 THRU G0109-EXIT
                ELSE
S17908*            IF  (STRT-AREA-TRN-NO   = 12007 OR 17037)
S17908             IF   STRT-AREA-TRN-NO   = 12007
S16588*                   AND (BOIS-NEGO-RATE-IND = "2")
S16588               IF (BOIS-NEGO-RATE-IND = "2")
                       PERFORM G000-PREPARE-17026 THRU G999-EXIT
S16588               ELSE
S16588                 PERFORM G100-PREPARE-17085 THRU G100-EXIT
S16588               END-IF
                   END-IF
                END-IF
      ***----BORP-CONSMR or BORP-CONSMR-MORT-COMBI
             WHEN "1" THRU "2"
                IF STRT-AREA-TRN-NO = 12000 OR 17000
                   PERFORM G0200-PREPARE-12006 THRU G0209-EXIT
                ELSE
                   IF  (STRT-AREA-TRN-NO   = 12006)
S16588*                   AND (BOIS-NEGO-RATE-IND = "2")
S16588               IF  (BOIS-NEGO-RATE-IND = "2")
SC2882                 MOVE STRT-AREA-TRN-NO TO WA-12000-SAVE-TRN-NO
                       PERFORM G000-PREPARE-17026 THRU G999-EXIT
S16588               ELSE
S16588                 PERFORM G100-PREPARE-17085 THRU G100-EXIT
S16588               END-IF
                   END-IF
                END-IF
      ***----BORP-YOUBE
             WHEN "3"
               IF STRT-AREA-TRN-NO = 12000 OR 17000
                   PERFORM G0300-PREPARE-12008 THRU G0309-EXIT
               ELSE
                  IF  (STRT-AREA-TRN-NO   = 12008)
S16588*                  AND (BOIS-NEGO-RATE-IND = "2")
S16588               IF  (BOIS-NEGO-RATE-IND = "2")
SC2882                 MOVE STRT-AREA-TRN-NO TO WA-12000-SAVE-TRN-NO
                      PERFORM G000-PREPARE-17026 THRU G999-EXIT
S16588               ELSE
S16588                 PERFORM G100-PREPARE-17085 THRU G100-EXIT
S16588               END-IF
                  END-IF
               END-IF
           END-EVALUATE.
       G0099-EXIT.
           EXIT.
      *
       G9100-GET-NAME-60CHARS.
           MOVE    1                  TO UT0500CA-CALL-CODE.
           MOVE    BORM-CUSTOMER-NO   TO UT0500CA-CUSM-NO.
           PERFORM V500-CALL-UT0500   THRU V599-EXIT.
S11927     MOVE WS-UT0500RA-CUSM-STATUS-SAVE TO WA-SAVE-CUST-STATUS.
S16182*S12520     MOVE UT0500RA-ACC-NO  TO UTCICECA-CUST-NO.
       G9109-EXIT.
           EXIT.
      *
       G9200-GET-ACCT-17.
           MOVE ZEROES             TO WA-17026-REFER.
      *
           MOVE WA-MEMB-CUST-AC    TO UT0151CA-ACCT-IN.
           MOVE 2                  TO UT0151CA-CALL-FUNC.
           MOVE SOC-ACCT-NO-FORMAT TO UT0151CA-FORMAT.
           MOVE SOC-CHK-DGT        TO UT0151CA-CHK-DGT-TYPE.
           CALL "UT0151" USING        UT0151CA-CALL-AREA.
           IF UT0151CA-STATUS    NOT = 0
              MOVE UT8500CA-FUNC-NORMAL-DISPLAY
                                   TO UT8500CA-CALL-CODE
              MOVE SPACES          TO UT8500CA-INPUT-MSG
              STRING "BR0000:(G9200) UT0151 CALL ERROR; A/C NO - "
                   UT0151CA-ACCT-IN "; STATUS - " UT0151CA-STATUS
                   DELIMITED  BY SIZE INTO UT8500CA-INPUT-MSG
              CALL "UT8500"   USING
                                      UT8500CA-AREA
              MOVE 1  TO WA-MSG-ERR-FLAG
              GO   TO G9209-EXIT
           END-IF.
       G9209-EXIT.
           EXIT.
      *
       G9300-REFORMAT-CUST-NO.
           MOVE 2                  TO UT0152CA-CALL-FUNC.
           MOVE SOC-CUST-NO-FORMAT TO UT0152CA-FORMAT.
           MOVE SOC-CHK-DGT        TO UT0152CA-CHK-DGT-TYPE.
           CALL "UT0152"        USING UT0152CA-CALL-AREA.
           IF  UT0152CA-STATUS  NOT = ZERO
               MOVE UT8500CA-FUNC-NORMAL-DISPLAY
                                   TO UT8500CA-CALL-CODE
               MOVE SPACES         TO UT8500CA-INPUT-MSG
               STRING "BR0000:(G9300) CHECK DIGIT CALC ERROR "
                      DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
               CALL "UT8500"    USING
                                      UT8500CA-AREA
               MOVE 1  TO WA-MSG-ERR-FLAG
               GO   TO G9399-EXIT.
       G9399-EXIT.
           EXIT.
      *
       G0100-PREPARE-12007.
           INITIALIZE WA-OUT-12007.
           MOVE BR0001CA-CHG-FAC-IND  TO WA-12007-CHG-FAC-IND.
           MOVE WA-TR-NA-FACILITY-NO  TO WA-12007-FACILITY-NO.
           MOVE BORM-MEMB-CUST-AC     TO WA-MEMB-CUST-AC.
           PERFORM G9200-GET-ACCT-17     THRU G9209-EXIT.
           IF WA-MSG-ERR-FLAG  <> 0
              MOVE 3575 TO WA-ERR-MSG-NO
              GO TO  G0109-EXIT
           END-IF.
           MOVE UT0151CA-ACCT-EX      TO WA-12007-ACCT-NO.
           MOVE WA-TR-NA-CUSTOMER-NO  TO UT0152CA-CUST-IN.
           PERFORM G9300-REFORMAT-CUST-NO THRU G9399-EXIT.
           MOVE UT0152CA-CUST-EX      TO WA-12007-CUST-NO.
           MOVE WA-TR-NA-INPUT-ID     TO WA-12007-ID-NO.
           MOVE WA-TR-NA-NAME-1       TO WA-12007-NAME.
           IF STRT-AREA-TRN-NO = 17000
              GO TO G0100-17037.
TB0169***-- ff. fields to be corrected by cif19/lon42
           MOVE BORM-APP-AMT          TO WA-12007-APPR-AMT.
           MOVE 0                     TO WA-12007-FSTDD-DATE.
           MOVE 0                     TO WA-12007-COST-EXP-DATE.
S16739     IF BOIS-COST-EXP-DATE NOT = ZEROES
S16739        MOVE BOIS-COST-EXP-DATE TO UT0020-BINARY-DATE
S16739        MOVE 1                  TO UT0020-FUNCTION
S16739        CALL "UT0020"  USING       UT0020-FUNCTION
S16739                                   UT0020-DATE-AREA
S16739                                   UT0020-BINARY-DATE
S16739        IF UT0020-BINARY-DATE   <> ZEROES
S16739           MOVE UT0020-DATE-DDMMCCYY
S16739                    TO WA-12007-COST-EXP-DATE
S16739        ELSE
S16739           MOVE ZEROES TO WA-12007-COST-EXP-DATE
S16739        END-IF
S16739     END-IF.
S16739*
           MOVE BOIS-RATE-EXP-DATE    TO WA-12007-RATE-EXP-DATE.
S16739     IF  BOIS-RATE-EXP-DATE > 0
S16739         MOVE BOIS-RATE-EXP-DATE TO UT0020-BINARY-DATE
S16739         MOVE 1                  TO UT0020-FUNCTION
S16739         CALL "UT0020"  USING       UT0020-FUNCTION
S16739                                    UT0020-DATE-AREA
S16739                                    UT0020-BINARY-DATE
S16739        IF UT0020-DATE-DDMMCCYY  = 99999999
S16739           MOVE 0               TO WA-12007-RATE-EXP-DATE
S16739        ELSE
S16739           MOVE UT0020-DATE-DDMMCCYY
S16739                             TO WA-12007-RATE-EXP-DATE
S16739        END-IF
S16739     END-IF.
           MOVE BORM-DUES-RECALC-IND  TO WA-12007-DUESRCLC-IND.
           MOVE BOIS-EFR-CHNG-IND     TO WA-12007-EFR-CHG-IND-N.
           MOVE BOIS-CTA-REFERENCE    TO WA-12007-CTA-REFER.
           MOVE BORP-CAPN-FREQ        TO WA-12007-INT-CAPN-FREQ.
TB0169***-- ff. field to be defaulted to product after addition
           MOVE BORP-INT-REPAY-NOTICE TO WA-12007-IREPAY-NOT.
           MOVE 0                     TO WA-12007-IREPAY-NOT-DAYS.
S10968     MOVE BOIS-SRCT-CODE        TO WA-12007-SOURCE-CDE.
S12474     MOVE BOIS-PROMO-TELLER     TO WA-12007-ACCT-OFFICER.
S16000     MOVE BOIS-BANK-RATE        TO WA-12007-BANK-RATE.
S16000     MOVE BOIS-CARLN-SUB-PROJ   TO WA-12007-SUB-PROJ.
           GO TO G0100-SEND-12007.
      *
       G0100-17037.
           MOVE BR0001CA-CHG-FAC-IND  TO WA-12007-CHG-FAC-IND.
           MOVE WA-TR-NA-FACILITY-NO  TO WA-12007-FACILITY-NO.
           MOVE WA-TR-NA-INPUT-ID     TO WA-12007-ID-NO.
           MOVE WA-TR-NA-NAME-1       TO WA-12007-NAME.
           MOVE BORM-APP-AMT          TO WA-12007-APPR-AMT.
           MOVE 0                     TO WA-12007-FSTDD-DATE.
TB0221     IF BOIS-COST-EXP-DATE NOT = ZEROES
TB0221        MOVE BOIS-COST-EXP-DATE TO UT0020-BINARY-DATE
TB0221        MOVE 1                  TO UT0020-FUNCTION
TB0221        CALL "UT0020"  USING       UT0020-FUNCTION
TB0221                                   UT0020-DATE-AREA
TB0221                                   UT0020-BINARY-DATE
TB0221        IF UT0020-BINARY-DATE   <> ZEROES
TB0221           MOVE UT0020-DATE-DDMMCCYY
TB0221                    TO WA-12007-COST-EXP-DATE
TB0169     ELSE
TB0169        MOVE ZEROES TO WA-12007-COST-EXP-DATE.
           MOVE BOIS-RATE-EXP-DATE TO UT0020-BINARY-DATE.
           MOVE 1                  TO UT0020-FUNCTION.
           CALL "UT0020"  USING       UT0020-FUNCTION
                                      UT0020-DATE-AREA
                                      UT0020-BINARY-DATE.
           IF UT0020-DATE-DDMMCCYY  = 99999999
              MOVE 0               TO WA-12007-RATE-EXP-DATE
           ELSE
              MOVE UT0020-DATE-DDMMCCYY
                                   TO WA-12007-RATE-EXP-DATE.
           MOVE BORM-DUES-RECALC-IND  TO WA-12007-DUESRCLC-IND.
           MOVE BOIS-EFR-CHNG-IND     TO WA-12007-EFR-CHG-IND-N.
TB0169***-- ff. fields to be corrected by lon21
TB0165     MOVE BOIS-CTA-REFERENCE    TO WA-MEMB-CUST-AC.
TB0165     MOVE SOC-ACCT-NO-FORMAT    TO UT0151CA-FORMAT.
TB0165     PERFORM G9200-GET-ACCT-17  THRU G9209-EXIT.
           IF WA-MSG-ERR-FLAG  <> 0
              MOVE 3575 TO WA-ERR-MSG-NO
              GO TO  G0109-EXIT
           END-IF.
TB0165     MOVE UT0151CA-ACCT-EX      TO WA-12007-CTA-REFER.
           MOVE BORP-CAPN-FREQ        TO WA-12007-INT-CAPN-FREQ.
           MOVE BOIS-INT-REPAY-NOTICE TO WA-12007-IREPAY-NOT.
           MOVE BOIS-INT-REPAY-NOTICE-DAYS
                                      TO WA-12007-IREPAY-NOT-DAYS.
TB0169     MOVE BR0001CA-CHG-FAC-IND  TO WA-12007-CHG-FAC-IND.
S10968     MOVE BOIS-SRCT-CODE        TO WA-12007-SOURCE-CDE.
S12474     MOVE BOIS-PROMO-TELLER     TO WA-12007-ACCT-OFFICER.
S16000     MOVE BOIS-BANK-RATE        TO WA-12007-BANK-RATE.
S16000     MOVE BOIS-CARLN-SUB-PROJ   TO WA-12007-SUB-PROJ.
TB0169     MOVE WA-TR-NA-FACILITY-NO  TO WA-12007-FAC-NO-16.
TB0016**--
           MOVE WA-TR-NA-CUSTOMER-NO  TO UT0152CA-CUST-IN.
           PERFORM G9300-REFORMAT-CUST-NO THRU G9399-EXIT.
           MOVE UT0152CA-CUST-EX      TO WA-12007-CUST-NO.
TB0016**--
      *
       G0100-SEND-12007.
           MOVE 800      TO WA-OUTPUT-MSG-LENGTH.
           IF STRT-AREA-TRN-NO = 12000
              MOVE 12007 TO STRT-AREA-TRN-NO
           ELSE
              MOVE 17037 TO STRT-AREA-TRN-NO
           END-IF.
           MOVE 998      TO WA-OUTPUT-ERR-MSG-NO.
           MOVE 6        TO STRT-AREA-IEXEC-CNTL.
           PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
      *
       G0109-EXIT.
           EXIT.
      *
       G0200-PREPARE-12006.
           INITIALIZE WA-OUTPUT-MSG.
           MOVE BR0001CA-CHG-FAC-IND  TO WA-12006-CHG-FAC-IND.
           MOVE WA-TR-NA-FACILITY-NO  TO WA-12006-FACILITY-NO.
           MOVE BORM-MEMB-CUST-AC     TO  WA-MEMB-CUST-AC.
           PERFORM G9200-GET-ACCT-17  THRU G9209-EXIT.
           IF WA-MSG-ERR-FLAG  <> 0
              MOVE 3575 TO WA-ERR-MSG-NO
              GO TO  G0209-EXIT
           END-IF.
           MOVE UT0151CA-ACCT-EX      TO WA-12006-ACCT-NO.
           MOVE WA-TR-NA-CUSTOMER-NO  TO UT0152CA-CUST-IN.
           PERFORM G9300-REFORMAT-CUST-NO THRU G9399-EXIT.
           MOVE UT0152CA-CUST-EX      TO WA-12006-CUST-NO.
           MOVE WA-TR-NA-INPUT-ID  TO WA-12006-ID-NO
TBN226                                WA-IDNO-KEY.
           MOVE WA-TR-NA-NAME-1    TO WA-12006-NAME.
           MOVE BORM-DUE-STRT-DATE TO UT0020-BINARY-DATE.
           MOVE 1                  TO UT0020-FUNCTION.
           CALL "UT0020"  USING       UT0020-FUNCTION
                                      UT0020-DATE-AREA
                                      UT0020-BINARY-DATE.
           IF UT0020-DATE-DDMMCCYY  = 99999999
              MOVE 0                     TO WA-12006-DUES-START-DATE
           ELSE
              MOVE UT0020-DATE-DDMMCCYY  TO WA-12006-DUES-START-DATE.
           IF STRT-AREA-TRN-NO = 17000
SC5976        AND BORP-LOAN-CLASS <> "2"
              GO TO G0200-17036
SC5976     ELSE
SC5976        IF STRT-AREA-TRN-NO = 17000 AND
SC5976           BORP-LOAN-CLASS = "2"
SC5976           GO TO G0200-MORTGAGE.
           MOVE SPACES   TO  WA-12006-CREDIT-INV.
           MOVE SPACES   TO  WA-12006-APPROVAL-OFFICER.
           MOVE SPACES   TO  WA-12006-EXEC-SUP.
           MOVE SPACES   TO  WA-12006-ACCT-OFFICER.
           MOVE SPACES   TO  WA-12006-OTHR-ACCT-OFFICER.
           MOVE "N"      TO  WA-12006-CSLD-STMT-PROS.
           MOVE 0        TO  WA-12006-SOURCE-CDE-N.
           MOVE SPACES   TO  WA-12006-PAYEE-ID-1.
           MOVE SPACES   TO  WA-12006-PAYEE-ID-2.
           MOVE SPACES   TO  WA-12006-PAYEE-ID-3.
           MOVE 0        TO  WA-12006-COMM-RATE-1.
           MOVE 0        TO  WA-12006-COMM-RATE-2.
           MOVE 0        TO  WA-12006-COMM-RATE-3.
TB0169***-- has credit insurance = WA-12006-INS-CDE
           MOVE 0        TO  WA-12006-INS-CDE.
           MOVE 0        TO  WA-12006-CREDIT-INS.
           MOVE SPACES   TO  WA-12006-CREDIT-COND.
           MOVE 0        TO  WA-12006-DET-FEE.
           MOVE 0        TO  WA-12006-RECEIV-FEE.
           MOVE SPACES   TO  WA-12006-921-FLAG.
           MOVE 0        TO  WA-12006-OD-ACCT-NO.
           MOVE SPACES   TO  WA-12006-LIQ-ASSET-PLEDG.
SC2078     MOVE BORP-BRKR-DEDUCT-COMM-AMT
SC2078       TO WA-12006-BUS-COMM.
SC2078**   MOVE 0        TO  WA-12006-BUS-COMM.
           MOVE "N"      TO  WA-12006-PAYMT-EXP.
TB0137     MOVE "N"      TO  WA-12006-CARLN-SUB-PROJ.
           MOVE 0        TO  WA-12006-MARK-OFNEW-ADDLN.
           MOVE 0        TO  WA-12006-ADDTL-APPR-AMT.
           MOVE "N"      TO  WA-12006-ACCT-OFF-FL.
           MOVE "N"      TO  WA-12006-OTHR-ACCT-OFF-FL.
TB0169     MOVE 0        TO  WA-12006-REFERRAL-FEE-TYP.
SC1551     MOVE WA-TR-NA-TYPE TO WA-12006-ACCT-TYPE.
SC1551     MOVE WA-TR-NA-INT-CAT TO WA-12006-INT-CAT.
TB0169    IF BORP-LOAN-CLASS = "2"
TB0169       GO TO G0200-MORTGAGE
TB0169    END-IF.
SC3120     MOVE BORM-STORE-RATE TO WA-12006-BANK-RATE.
SC3120*    MOVE 0        TO  WA-12006-BANK-RATE.
           MOVE 0        TO  WA-12006-GTEE-NO-1.
           MOVE 0        TO  WA-12006-GTEE-NO-2.
           MOVE 0        TO  WA-12006-GTEE-NO-3.
           MOVE 0        TO  WA-12006-PREV-ACCT-NO-1.
           MOVE 0        TO  WA-12006-PREV-ACCT-NO-2.
           GO TO G0200-SEND-12006.
TB0169 G0200-MORTGAGE.
S19484     IF   STRT-AREA-TRN-NO = 17000
S19484     AND  BORM-STAT      >= 7
S19484     AND  WA-MEMB-OD
S19484          GO  TO  G0200-17036
S19484     END-IF.
TB0219     INITIALIZE INOD-DATA-REC
SC7375     IF STRT-AREA-TRN-NO = 12000                                            
SC7615        OR BOIS-OD-ACCT-NUMBER = 0
TB0219*S10453 MOVE STRT-AREA-SOC-NO       TO INOD-ALT-SOC-NO              SC7375
TB0219*S10453 MOVE BOIS-SORD-AUTO-DBT-ACCT-NO TO WA-DEP-NO-W              SC7375
TB0219*S10453 MOVE WA-DEP-NO-W TO WA-DEP-NO-X                             SC7375
TB0219*S10453 MOVE WA-DEP-NO              TO INOD-ALT-DEP-NO              SC7375
TB0219*S10453                                INOD-DEP-NO                  SC7375
TB0219*S10453 MOVE 0                      TO INOD-ALT-EFF-RATE1           SC7375
TB0219*S10453                                INOD-ALT-OD-NO               SC7375
SC0377*S10453 MOVE 0                      TO INOD-ALT-COLLATERAL-NO1
SC0377*S10453 MOVE 99999999999999999      TO INOD-ALT-COLLATERAL-NO1      SC7375
TB0219*S10453 MOVE INOD-ALT-KEY           TO DBIOMOD-KEY                  SC7375
TB0219*S10453 MOVE 1                      TO DBIOMOD-KEY-NO               SC7375
TB0219*S10453 MOVE "READNEXT"             TO DBIOMOD-FUNCTION             SC7375
TB0219*S10453 MOVE "****" TO DBIOMOD-STAT                                 SC7375
TB0219*S10453 PERFORM UNTIL ((DBIOMOD-STAT <> "****") OR                  SC7375
TB0219*S10453                (INOD-ACCT-STATUS = "A") OR                  SC7375
TB0219*S10453                (WA-DEP-NO NOT =                             SC7375
TB0219*S10453                 INOD-DEP-NO))                               SC7375
TB0219*S10453   PERFORM H400-ACCESS-INOD THRU H499-EXIT                   SC7375
SC0377*S10453   MOVE INOD-SOC-NO   TO INOD-ALT-SOC-NO                     SC7375
SC0377*S10453   MOVE INOD-DEP-NO   TO INOD-ALT-DEP-NO                     SC7375
SC0377*S10453   MOVE INOD-EFF-RATE(1)                                     SC7375
SC0377*S10453                      TO INOD-ALT-EFF-RATE1                  SC7375
SC0377*S10453   MOVE INOD-COLLATERAL-NO(1)                                SC7375
SC0377*S10453                      TO INOD-ALT-COLLATERAL-NO1             SC7375
SC0377*S10453   MOVE INOD-OD-NO    TO INOD-ALT-OD-NO                      SC7375
SC0377*S10453   MOVE INOD-ALT-KEY  TO DBIOMOD-KEY                         SC7375
TB0219*S10453 END-PERFORM                                                 SC7375
S10453        MOVE BOIS-SORD-AUTO-DBT-ACCT-NO TO WA-DEP-NO-W
S10453        MOVE WA-DEP-NO-W   TO WA-DEP-NO-X
S10453        MOVE STRT-AREA-SOC-NO TO INOD-SOC-NO
S10453        MOVE WA-DEP-NO     TO INOD-DEP-NO
S10453        MOVE ZEROS         TO INOD-OD-NO
S16409        IF ( BORP-USAGE-LOAN )
S16409             MOVE WA-TR-NA-OD-NO TO INOD-OD-NO
S16409        END-IF
S10453        MOVE INOD-KEY      TO DBIOMOD-KEY
S10453        MOVE 0             TO DBIOMOD-KEY-NO
S10453        MOVE "READ"        TO DBIOMOD-FUNCTION
S10453        PERFORM H400-ACCESS-INOD THRU H499-EXIT
S10453        IF DBIOMOD-STAT NOT = "****"
S10453           IF DBIOMOD-STAT = "MRNF"
S10453              MOVE 3686    TO WA-OUTPUT-ERR-MSG-NO
S10453              MOVE 1       TO WA-MSG-ERR-FLAG
S10453              GO TO G0209-EXIT
S10453           ELSE
S10453              MOVE 4613    TO WA-OUTPUT-ERR-MSG-NO
S10453              MOVE 1       TO WA-MSG-ERR-FLAG
S10453              GO TO G0209-EXIT
S10453           END-IF
S10453        END-IF
S10453        INITIALIZE UTINOD-CALL-AREA
S10453        MOVE STRT-AREA-SOC-NO TO UTINODCA-SOC-NO
S10453        MOVE INOD-DEP-NO   TO UTINODCA-DEP-NO
S16409        IF ( BORP-USAGE-LOAN )
S16409             MOVE INOD-OD-NO TO UTINODCA-OD-NO
S16409        END-IF
S10453        MOVE 27            TO UTINODCA-CALL-CODE
S10453        MOVE INOD-DATA-REC TO UTINODCA-DATA-REC
S10453        MOVE BORM-MEMB-CUST-AC TO UTINODCA-LOAN-ACCT-NO
S10453        CALL "UTINOD" USING UTINOD-CALL-AREA
S10453                            STARTAREA
S10453                            WA-INVM-RECORD-AREA
S10453        EVALUATE UTINODCA-STATUS
S10453           WHEN 00
S10453              CONTINUE
S10453           WHEN 19
S10453              MOVE 3686    TO WA-OUTPUT-ERR-MSG-NO
S10453              MOVE 1       TO WA-MSG-ERR-FLAG
S10453              GO TO G0209-EXIT
S10453           WHEN 20
S10453              MOVE 1316    TO WA-OUTPUT-ERR-MSG-NO
S10453              MOVE 1       TO WA-MSG-ERR-FLAG
S10453              GO TO G0209-EXIT
S10453           WHEN 21
S10453              MOVE 4677    TO WA-OUTPUT-ERR-MSG-NO
S10453              MOVE 1       TO WA-MSG-ERR-FLAG
S10453              GO TO G0209-EXIT
S10453           WHEN OTHER
S10453              MOVE 4613    TO WA-OUTPUT-ERR-MSG-NO
S10453              MOVE 1       TO WA-MSG-ERR-FLAG
S10453              GO TO G0209-EXIT
S10453        END-EVALUATE
S10453        MOVE UTINODCA-DATA-REC TO INOD-RECORD-AREA
S10454        MOVE UTINODCA-THRESHOLD-AMT TO BOIS-THRESHOLD-AMT
S10454        MOVE INOD-OD-NO    TO BOIS-OD-ACCT-NUMBER
S10454        MOVE "REWRITE"     TO DBIOMOD-FUNCTION
S10454        PERFORM B5100-ACCESS-BOIS THRU B5199-EXIT
S10454        IF WA-MSG-ERR-FLAG NOT = 0
S10454              GO           TO G0209-EXIT
S10454        END-IF
SC7375     ELSE                                                                   
SC7375          MOVE STRT-AREA-SOC-NO       TO INOD-SOC-NO                        
SC7375          MOVE BOIS-SORD-AUTO-DBT-ACCT-NO TO WA-DEP-NO-W                    
SC7375          MOVE WA-DEP-NO-W TO WA-DEP-NO-X                                   
SC7375          MOVE WA-DEP-NO              TO INOD-DEP-NO                        
SC7375          MOVE BOIS-OD-ACCT-NUMBER    TO INOD-OD-NO                         
SC7375          MOVE INOD-KEY               TO DBIOMOD-KEY                        
SC7375          MOVE 0                      TO DBIOMOD-KEY-NO                     
SC7375          MOVE "READ"                 TO DBIOMOD-FUNCTION                   
SC7375          PERFORM H400-ACCESS-INOD THRU H499-EXIT                           
SC7375          IF DBIOMOD-STAT NOT = "****"                                      
SC7375             MOVE UT8500CA-FUNC-NORMAL-DISPLAY                              
SC7375                                      TO UT8500CA-CALL-CODE                 
SC7375             MOVE SPACES              TO UT8500CA-INPUT-MSG                 
SC7375             STRING "BROOOO:(G0200) ERROR ACCESSING INOD "                  
SC7375                    "DBIO-STAT = "        DBIOMOD-STAT                      
SC7375                    "DBIOMOD-KEY = "      DBIOMOD-KEY                       
SC7375                    "DBIOMOD-FUNCTION = " DBIOMOD-FUNCTION                  
SC7375                     DELIMITED BY SIZE    INTO UT8500CA-INPUT-MSG           
SC7375             CALL "UT8500"                USING UT8500CA-AREA               
SC7375             MOVE 1                       TO WA-MSG-ERR-FLAG                
SC7375             MOVE 2245                    TO WA-OUTPUT-ERR-MSG-NO           
SC7375             GO   TO  G0209-EXIT                                            
SC7375          END-IF                                                            
SC7375     END-IF.                                                                
S10453*    IF  INOD-ACCT-STATUS <> "A"
S10453     IF  INOD-ACCT-STATUS <> "A" AND "E"
TB0219        MOVE 3686              TO WA-OUTPUT-ERR-MSG-NO
TB0219        MOVE 1                 TO WA-MSG-ERR-FLAG
TB0219        GO TO G0209-EXIT
TB0219     END-IF.
SC5976     MOVE INOD-SOC-NO    TO INVM-SOC-NO
SC5976     MOVE INOD-ACCT-TYPE TO INVM-ACCT-TYPE
SC5976     MOVE INOD-SUB-TYPE  TO INVM-INT-CAT
SC5976     PERFORM M007-CALL-UT0200 THRU M007-EXIT.
SC5976     IF WA-MSG-ERR-FLAG = 1
SC5976        GO TO G0209-EXIT.
SC5976     IF NOT ACCT-PARM-MORTGAGE-OD
S16101     AND NOT BORP-USAGE-LOAN
SC5976        MOVE 1275              TO WA-OUTPUT-ERR-MSG-NO
SC5976        MOVE 1                 TO WA-MSG-ERR-FLAG
SC5976        GO TO G0209-EXIT
SC5976     END-IF.
SC6100*    PERFORM VARYING WA-EXP-IDX FROM 1 BY 1
SC6100*      UNTIL WA-EXP-IDX > 3
SC6100*        EVALUATE WA-EXP-IDX
SC6100*          WHEN 1
SC6100*            MOVE INOD-GUARANTOR-NO (WA-EXP-IDX)
SC6100*              TO WA-12006-GTEE-NO-1
SC6100*          WHEN 2
SC6100*            MOVE INOD-GUARANTOR-NO (WA-EXP-IDX)
SC6100*              TO WA-12006-GTEE-NO-2
SC6100*          WHEN 3
SC6100*            MOVE INOD-GUARANTOR-NO (WA-EXP-IDX)
SC6100*              TO WA-12006-GTEE-NO-3
SC6100*        END-EVALUATE
SC6100*     END-PERFORM.
SC6100     PERFORM VARYING WA-GTE-TO-LON-CTR FROM 1 BY 1
SC6100       UNTIL WA-GTE-TO-LON-CTR > 3
SC6100       MOVE INOD-GUARANTOR-NO (WA-GTE-TO-LON-CTR) TO
SC6100            RELM-ID-1-REL
SC6100       PERFORM DISPLAY-RELM-DATA THRU DISPLAY-RELM-DATA-EXIT
SC6100     END-PERFORM
TB0219    MOVE INOD-PREV-ACCT-NUM1 TO WA-12006-PREV-ACCT-NO-1.
TB0219    MOVE INOD-PREV-ACCT-NUM2 TO WA-12006-PREV-ACCT-NO-2.
TB0219    MOVE INOD-BANK-RATE TO WA-12006-BANK-RATE.
TB0219    MOVE INOD-OD-NO     TO WA-12006-OD-ACCT-NO.
SC9068    IF STRT-AREA-TRN-NO = 12000
SC9068       MOVE SPACES TO BOIS-CREDIT-INVSGTR,
SC9068                      BOIS-EXEC-SUPERVISOR,
SC9068                      BOIS-PROMO-TELLER,
SC9068                      BOIS-OTHER-PROMO-TELLER,
SC9068                      BORM-CSLD-STMT-PROS,
SC9068                      BOIS-INSU-COMPANY-CODE,
SC9068                      BOIS-CREDIT-CONDITION,
SC9068                      BOIS-LIQUID-ASSET-PLEDGE,
SC9068                      BOIS-CARLN-SUB-PROJ,
SC9068                      BOIS-APPROVAL-OFFICER,
SC9068                      BOIS-ACCT-OFCR-1-FLAG,
SC9068                      BOIS-ACCT-OFCR-2-FLAG
SC9068       MOVE ZEROES TO BOIS-SRCT-CODE,
SC9068                      BORM-INS-IND,
SC9068                      BOIS-DET-FEE,
SC9068                      BOIS-RECEIV-FEE,
SC9068                      BOIS-MARK-OF-NEW-ADDTL-LOANS,
SC9068                      BOIS-ACTL-ADDAPPRV-AMT
SC9068    END-IF.
SC9068    IF BOIS-CREDIT-INVSGTR = SPACES
SC0398       MOVE INOD-CREDIT-INVESTIGATOR TO WA-12006-CREDIT-INV
SC9068    ELSE
SC9068       MOVE BOIS-CREDIT-INVSGTR      TO WA-12006-CREDIT-INV.
SC9068    IF BOIS-EXEC-SUPERVISOR = SPACES
SC0398       MOVE INOD-EXEC-SUPERVISOR    TO WA-12006-EXEC-SUP
SC9068    ELSE
SC9068       MOVE BOIS-EXEC-SUPERVISOR    TO WA-12006-EXEC-SUP.
SC9068    IF BOIS-PROMO-TELLER = SPACES
SC0398       MOVE INOD-PROMO-TELLER        TO WA-12006-ACCT-OFFICER
SC9068    ELSE
SC9068       MOVE BOIS-PROMO-TELLER        TO WA-12006-ACCT-OFFICER.
SC9068    IF BOIS-OTHER-PROMO-TELLER = SPACES
SC0398       MOVE INOD-OTHER-PROMO-TELLER  TO WA-12006-OTHR-ACCT-OFFICER
SC9068    ELSE
SC9068       MOVE BOIS-OTHER-PROMO-TELLER  TO WA-12006-OTHR-ACCT-OFFICER.
SC9068    IF BORM-CSLD-STMT-PROS = SPACE
SC0398       MOVE INOD-CONSO-STATEMENT-PROC TO WA-12006-CSLD-STMT-PROS
SC9068    ELSE
SC9068       MOVE BORM-CSLD-STMT-PROS    TO WA-12006-CSLD-STMT-PROS.
SC9068    IF BOIS-SRCT-CODE = ZEROES
SC0398       MOVE INOD-SOURCE-TYPE          TO WA-12006-SOURCE-CDE-N
SC9068    ELSE
SC9068       MOVE BOIS-SRCT-CODE            TO WA-12006-SOURCE-CDE-N.
SC9068    IF BORM-INS-IND = 0
SC0398       MOVE INOD-INSU-IND             TO WA-12006-INS-CDE
SC9068    ELSE
SC9068       MOVE BORM-INS-IND              TO WA-12006-INS-CDE.
SC9068    IF BOIS-INSU-COMPANY-CODE = SPACES
SC0398       MOVE INOD-INSU-COMPANY         TO WA-12006-CREDIT-INS
SC9068    ELSE
SC9068       MOVE BOIS-INSU-COMPANY-CODE TO WA-12006-CREDIT-INS.
SC9068    IF BOIS-CREDIT-CONDITION  = SPACES
SC0398       MOVE INOD-CREDIT-CONDITION     TO WA-12006-CREDIT-COND
SC9068    ELSE
SC9068       MOVE BOIS-CREDIT-CONDITION     TO WA-12006-CREDIT-COND.
SC9068    IF BOIS-DET-FEE = ZEROES
SC0398       MOVE INOD-DETER-FEE          TO WA-12006-DET-FEE
SC9068    ELSE
SC9068       MOVE BOIS-DET-FEE            TO WA-12006-DET-FEE.
SC9068    IF BOIS-RECEIV-FEE = ZEROES
SC0398       MOVE INOD-RECEIV-FEE         TO WA-12006-RECEIV-FEE
SC9068    ELSE
SC9068       MOVE BOIS-RECEIV-FEE         TO WA-12006-RECEIV-FEE.
SC9068    IF BOIS-LIQUID-ASSET-PLEDGE = SPACE
SC0398       MOVE INOD-LIQUID-ASSET-PLEDGE  TO
SC9068            WA-12006-LIQ-ASSET-PLEDG
SC9068    ELSE
SC9068       MOVE BOIS-LIQUID-ASSET-PLEDGE TO WA-12006-LIQ-ASSET-PLEDG.
SC0398    MOVE INOD-PAYMENT-EXPENSE      TO WA-12006-PAYMT-EXP
SC9068    IF BOIS-CARLN-SUB-PROJ = SPACE
SC0398    MOVE INOD-CAR-LOAN-PROJ        TO WA-12006-CARLN-SUB-PROJ
SC9068    ELSE
SC9068       MOVE BOIS-CARLN-SUB-PROJ    TO WA-12006-CARLN-SUB-PROJ.
SC9068    IF BOIS-MARK-OF-NEW-ADDTL-LOANS = 0
SC0398    MOVE INOD-MARK-OF-NEW-ADDTL-LOANS TO WA-12006-MARK-OFNEW-ADDLN
SC9068    ELSE
SC9068       MOVE BOIS-MARK-OF-NEW-ADDTL-LOANS TO
SC9068            WA-12006-MARK-OFNEW-ADDLN.
SC9068    IF BOIS-ACTL-ADDAPPRV-AMT = ZEROES
SC0398    MOVE INOD-ACTUAL-ADDTL-APPROV-AMT TO WA-12006-ADDTL-APPR-AMT
SC9068    ELSE
SC9068      MOVE BOIS-ACTL-ADDAPPRV-AMT TO INOD-ACTUAL-ADDTL-APPROV-AMT.
SC9068    IF BOIS-APPROVAL-OFFICER = SPACES
SC0398    MOVE INOD-CREDIT-OFFICER          TO WA-12006-APPROVAL-OFFICER
SC9068    ELSE
SC9068      MOVE BOIS-APPROVAL-OFFICER      TO WA-12006-APPROVAL-OFFICER.
SC9068    IF BOIS-ACCT-OFCR-1-FLAG = SPACE
SC0398    MOVE INOD-ACCT-OFCR-1-FLAG TO WA-12006-ACCT-OFF-FL
SC9068    ELSE
SC9068      MOVE BOIS-ACCT-OFCR-1-FLAG TO WA-12006-ACCT-OFF-FL.
SC9068    IF BOIS-ACCT-OFCR-2-FLAG = SPACE
SC0398    MOVE INOD-ACCT-OFCR-2-FLAG TO WA-12006-OTHR-ACCT-OFF-FL
SC9068    ELSE
SC9068       MOVE BOIS-ACCT-OFCR-2-FLAG TO WA-12006-OTHR-ACCT-OFF-FL.
SC5976     IF STRT-AREA-TRN-NO <> 17000
           GO TO G0200-SEND-12006.
      *
       G0200-17036.
SC5976****** MOVE THESE LINES AFTER ACCESS OF CIEP TO
SC5976****** RETRIEVE MAPPED DATA FROM LOANS AND INOD FIRST
SC5976*    MOVE BOIS-CREDIT-INVSGTR   TO WA-12006-CREDIT-INV.
SC5976*    MOVE BOIS-APPROVAL-OFFICER TO WA-12006-APPROVAL-OFFICER.
SC5976*    MOVE BOIS-EXEC-SUPERVISOR  TO WA-12006-EXEC-SUP.
SC5976*    MOVE BOIS-PROMO-TELLER     TO WA-12006-ACCT-OFFICER.
SC5976*    MOVE BOIS-OTHER-PROMO-TELLER
SC5976*                             TO WA-12006-OTHR-ACCT-OFFICER.
SC5976*    MOVE BORM-CSLD-STMT-PROS TO WA-12006-CSLD-STMT-PROS.
SC5976*    MOVE BOIS-SRCT-CODE      TO WA-12006-SOURCE-CDE-N.
SC0375*    MOVE BOIS-PAYEE-ID (1)   TO WA-12006-PAYEE-ID-1.
SC0375*    MOVE BOIS-PAYEE-ID (2)   TO WA-12006-PAYEE-ID-2.
SC0375*    MOVE BOIS-PAYEE-ID (3)   TO WA-12006-PAYEE-ID-3.
SC0375*    MOVE BOIS-COMM-RATE (1)  TO WA-12006-COMM-RATE-1.
SC0375*    MOVE BOIS-COMM-RATE (2)  TO WA-12006-COMM-RATE-2.
SC0375*    MOVE BOIS-COMM-RATE (3)  TO WA-12006-COMM-RATE-3.
SC0375*    MOVE BOIS-PAYEE-ID (3)   TO WA-12006-PAYEE-ID-3.
SC0375*    MOVE BOIS-COMM-RATE (1)  TO WA-12006-COMM-RATE-1.
SC0375*    MOVE BOIS-COMM-RATE (2)  TO WA-12006-COMM-RATE-2.
SC0375*    MOVE BOIS-COMM-RATE (3)  TO WA-12006-COMM-RATE-3.
SC0375     MOVE SPACES           TO DBIOMOD-RECORD.
SC0375     MOVE "CIEP"           TO DBIOMOD-FILE
SC0375                              DBIOMOD-SUFFIX.
SC0375     MOVE "DBIO"           TO DBIOMOD-PREFIX.
SC0375     MOVE LOW-VALUES       TO DBIOMOD-KEY.
SC0375     MOVE SPACE            TO DBIOMOD-STATUS
SC0375                              DBIOMOD-RELEASE-LOCK
SC0375                              DBIOMOD-ACCESS-COMMAND
SC0375                              DBIOMOD-ACCESS-COND.
SC0375     MOVE 0                TO DBIOMOD-KEY-NO.
SC0375     MOVE "READNEXT"       TO DBIOMOD-FUNCTION.
SC0375     MOVE "N"              TO WA-ERROR-FLAG.
SC0375     PERFORM UNTIL CIEP-BROKERAGE-FEE OR WA-ERROR
SC0375        MOVE SPACES TO DBIOMOD-STAT
SC0375        CALL "DBIOCIEP" USING DBIOMOD-FILE
SC0375                              DBIOMOD-KEY
SC0375                              CIEP-RECORD
SC0375                              DBIOMOD-FUNCTION
SC0375                              DBIOMOD-KEY-NO
SC0375                              DBIOMOD-RELEASE-LOCK
SC0375                              DBIOMOD-ACCESS-COMMAND
SC0375                              DBIOMOD-ACCESS-COND
SC0375                              DBIOMOD-STATUS
SC0375        IF DBIOMOD-STAT = "****"
SC0375           MOVE CIEP-KEY TO DBIOMOD-KEY
SC0375        ELSE
SC0375           SET WA-ERROR TO TRUE
SC0375        END-IF
SC0375     END-PERFORM.
SC0375     IF CIEP-BROKERAGE-FEE
SC0375        INITIALIZE UTCIEACA-CALL-PARAM
SC0375        MOVE STRT-AREA-SOC-NO  TO UTCIEACA-SOC-NO
SC0375        MOVE "BOR"             TO UTCIEACA-SYSTEM
SC0375        MOVE BORM-MEMB-CUST-AC TO UTCIEACA-ACCT-NO
SC0375        MOVE CIEP-TYPE         TO UTCIEACA-TYPE
SC0375        SET  UTCIEACA-READ     TO TRUE
SC0375        MOVE ZEROES            TO UTCIEACA-CALL-STATUS
SC0375        CALL "UTCIEA" USING UTCIEACA-CALL-PARAM
SC8200                            BORM-RECORD-AREA
SC8200                            BOIS-RECORD
SC0375        IF UTCIEACA-CALL-STATUS = ZEROES
SC0375           MOVE UTCIEACA-PAYEE (1) TO WA-12006-PAYEE-ID-1
SC0375           MOVE UTCIEACA-PAYEE (2) TO WA-12006-PAYEE-ID-2
SC0375           MOVE UTCIEACA-PAYEE (3) TO WA-12006-PAYEE-ID-3
SC0375           MOVE UTCIEACA-RATE (1) TO WA-12006-COMM-RATE-1
SC0375           MOVE UTCIEACA-RATE (2) TO WA-12006-COMM-RATE-2
SC0375           MOVE UTCIEACA-RATE (3) TO WA-12006-COMM-RATE-3
SC1669           MOVE UTCIEACA-DEDUCT-COMM-AMT
SC1669                                  TO WA-12006-BUS-COMM
SC0375        END-IF
SC0375     END-IF.
SC5976     MOVE BOIS-921-FLAG     TO WA-12006-921-FLAG.
SC5976     IF BOIS-OD-ACCT-NUMBER <> WA-12006-OD-ACCT-NO
SC5976        AND BORP-LOAN-CLASS = 2
SC5976        GO TO G0200-SEND-12006
SC5976     END-IF
SC5976     MOVE BOIS-CREDIT-INVSGTR   TO WA-12006-CREDIT-INV.
SC5976     MOVE BOIS-APPROVAL-OFFICER TO WA-12006-APPROVAL-OFFICER.
SC5976     MOVE BOIS-EXEC-SUPERVISOR  TO WA-12006-EXEC-SUP.
SC5976     MOVE BOIS-PROMO-TELLER     TO WA-12006-ACCT-OFFICER.
SC5976     MOVE BOIS-OTHER-PROMO-TELLER
SC5976                              TO WA-12006-OTHR-ACCT-OFFICER.
SC5976     MOVE BORM-CSLD-STMT-PROS TO WA-12006-CSLD-STMT-PROS.
SC5976     MOVE BOIS-SRCT-CODE      TO WA-12006-SOURCE-CDE-N.
           MOVE BOIS-PREV-ACCT-NUM1 TO WA-12006-PREV-ACCT-NO-1.
           MOVE BOIS-PREV-ACCT-NUM2 TO WA-12006-PREV-ACCT-NO-2.
TB0169***-- has credit insurance = WA-12006-INS-CDE
           MOVE BORM-INS-IND           TO WA-12006-INS-CDE.
           MOVE BOIS-INSU-COMPANY-CODE TO WA-12006-CREDIT-INS.
           MOVE BOIS-CREDIT-CONDITION  TO WA-12006-CREDIT-COND.
           MOVE BOIS-DET-FEE      TO WA-12006-DET-FEE.
           MOVE BOIS-RECEIV-FEE   TO WA-12006-RECEIV-FEE.
SC5976*    MOVE BOIS-921-FLAG     TO WA-12006-921-FLAG.
           MOVE BOIS-OD-ACCT-NUMBER TO WA-12006-OD-ACCT-NO.
           MOVE BOIS-LIQUID-ASSET-PLEDGE
                                  TO WA-12006-LIQ-ASSET-PLEDG.
SC1669*    MOVE 0 TO WA-12006-BUS-COMM.
           MOVE BOIS-BANK-RATE    TO WA-12006-BANK-RATE.
           MOVE 0 TO WA-12006-PAYMT-EXP.
      *    MOVE SPACES            TO WA-12006-CARLN-SUB-PROJ.
TB0137     MOVE BOIS-CARLN-SUB-PROJ
                                  TO WA-12006-CARLN-SUB-PROJ.
           MOVE BOIS-MARK-OF-NEW-ADDTL-LOANS
                                  TO WA-12006-MARK-OFNEW-ADDLN.
SC0811*    MOVE BORM-ADD-LOAN-APP TO WA-12006-ADDTL-APPR-AMT.
SC0811     MOVE BOIS-ACTL-ADDAPPRV-AMT  TO WA-12006-ADDTL-APPR-AMT.
           MOVE BOIS-ACCT-OFCR-1-FLAG   TO WA-12006-ACCT-OFF-FL.
           MOVE BOIS-ACCT-OFCR-2-FLAG
                                  TO WA-12006-OTHR-ACCT-OFF-FL.
TB0169     MOVE 0                 TO WA-12006-REFERRAL-FEE-TYP.
TB0169     MOVE 0                 TO WA-12006-REFERRAL-FEE-TYP.
TB0169     MOVE BR0001CA-CHG-FAC-IND TO WA-12006-CHG-FAC-IND.
TB0169     MOVE WA-TR-NA-FACILITY-NO TO WA-12006-FAC-NO-16.
SC2200     MOVE BORM-ACT-TYPE     TO WA-12006-ACCT-TYPE.
SC2200     MOVE BORM-CAT          TO WA-12006-INT-CAT.
S15238     MOVE BORM-ADV-TOM-RATE TO WA-12006-INSU-RATE.
S15813*
S15813     IF ( BORM-REFERRAL-DATE = ZEROS )
S15813          MOVE ZEROS        TO WA-12006-SOURCE-ADV-DATE
S15813     ELSE
S15813          MOVE BORM-REFERRAL-DATE TO WA-BIN-DATE
S15813          PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S15813          MOVE WA-DDMMCCYY-DATE   TO WA-12006-SOURCE-ADV-DATE
S15813     END-IF.
S15813*
S16668     MOVE 1                       TO WA-SUB.
S16668     MOVE BORP-PRODUCT-GROUP(WA-SUB) TO WA-PRODUCT-GROUP.
S16668     IF   VALID-YOUTH-LOAN
S16813     OR   VALID-SUBS-LOAN
S17255     OR   VALID-POLICY-YUN
S16668          MOVE BOIS-GOV-SER-NO   TO WA-12006-GOV-SER-NO.
TB0016**--
SC7843     MOVE 0                 TO WA-12006-GTEE-NO-1.
SC7843     MOVE 0                 TO WA-12006-GTEE-NO-2.
SC7843     MOVE 0                 TO WA-12006-GTEE-NO-3.
           MOVE 0                 TO WA-GTE-TO-LON-CTR.
           MOVE "N"               TO WA-RCNF-RELM.
           INITIALIZE             UT0400-CALL-AREA.
SC7843*    MOVE 02                TO UT0400CA-CALL-CODE.
SC7843     MOVE 05                TO UT0400CA-CALL-CODE.
           MOVE STRT-AREA-SOC-NO  TO UT0400CA-RELM-INST-1
                                     UT0400CA-RELM-INST-1-REL.
           MOVE 1                 TO UT0400CA-KEY-NO.
           MOVE WA-12006-ACCT-NO  TO UT0400CA-RELM-ID-1
           MOVE 0                 TO UT0400CA-RELM-ID-1-REL.
           MOVE "LON"             TO UT0400CA-RELM-ENTITY-1
           MOVE "GTE"             TO UT0400CA-RELM-ENTITY-1-REL.
           SET GUARANTEE-TO-ACCOUNT  TO TRUE.
           MOVE RELATIONSHIP-VALUE TO UT0400CA-RELM-RELATIONSHIP-1.
           PERFORM D400-READ-RELM THRU D499-EXIT.
           IF WA-RCNF-RELM = "N"
              PERFORM 
                UNTIL UT0400CA-CALL-STATUS <>  "****"
SC7843             OR WA-RCNF-RELM          =  "Y"
                   OR WA-12006-ACCT-NO     <>  UT0400CA-RELM-ID-1
                   OR WA-GTE-TO-LON-CTR    >=  3
SC7843           IF RELM-ID-1-REL NOT       =  0
SC9090           AND RELM-STATUS            =  00
SC7843**--       AND RELM-STATUS         
                   ADD 1 TO WA-GTE-TO-LON-CTR
                   PERFORM MOVE-RELM-1 THRU MOVE-RELM-1-EXIT
                   PERFORM DISPLAY-RELM-DATA THRU DISPLAY-RELM-DATA-EXIT
SC784            END-IF
                 MOVE 1             TO UT0400CA-KEY-NO
                 MOVE 03            TO UT0400CA-CALL-CODE
                 PERFORM D400-READ-RELM THRU D499-EXIT
             END-PERFORM
          END-IF.
TB0016**--
      *
       G0200-SEND-12006.
           IF STRT-AREA-TRN-NO = 12000
              MOVE 12006 TO STRT-AREA-TRN-NO
           ELSE
              MOVE 17036 TO STRT-AREA-TRN-NO
           END-IF.
           MOVE 800      TO WA-OUTPUT-MSG-LENGTH.
           MOVE 998      TO WA-OUTPUT-ERR-MSG-NO.
           MOVE 6        TO STRT-AREA-IEXEC-CNTL.
           PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
      *
       G0209-EXIT.
           EXIT.
      *
       G0300-PREPARE-12008.
           INITIALIZE WA-OUTPUT-MSG.
           MOVE BORM-MEMB-CUST-AC     TO  WA-MEMB-CUST-AC.
           PERFORM G9200-GET-ACCT-17  THRU G9209-EXIT.
           IF WA-MSG-ERR-FLAG  <> 0
              MOVE 3575 TO WA-ERR-MSG-NO
              GO TO  G0309-EXIT
           END-IF.
           MOVE UT0151CA-ACCT-EX      TO WA-12008-ACCT-NO.
           MOVE WA-TR-NA-CUSTOMER-NO  TO UT0152CA-CUST-IN.
           PERFORM G9300-REFORMAT-CUST-NO THRU G9399-EXIT.
           MOVE UT0152CA-CUST-EX      TO WA-12008-CUST-NO.
           MOVE WA-TR-NA-INPUT-ID     TO WA-12008-ID-NO
SC4259                                   WA-IDNO-KEY.
           MOVE WA-TR-NA-NAME-1       TO WA-12008-NAME.
           MOVE BORM-DUE-STRT-DATE    TO UT0020-BINARY-DATE.
           MOVE 1                     TO UT0020-FUNCTION.
           CALL "UT0020"  USING          UT0020-FUNCTION
                                         UT0020-DATE-AREA
                                         UT0020-BINARY-DATE.
           IF UT0020-DATE-DDMMCCYY = 99999999
              MOVE 0                  TO WA-12008-DUES-START-DATE
           ELSE
              MOVE UT0020-DATE-DDMMCCYY  TO WA-12008-DUES-START-DATE.
           IF STRT-AREA-TRN-NO = 17000
              GO TO G0300-17038.
           MOVE SPACES  TO  WA-12008-CREDIT-INV.
           MOVE SPACES  TO  WA-12008-APPROVAL-OFFICER.
           MOVE SPACES  TO  WA-12008-EXEC-SUP.
           MOVE SPACES  TO  WA-12008-ACCT-OFFICER.
           MOVE SPACES  TO  WA-12008-OTHR-ACCT-OFFICER.
           MOVE "N"     TO  WA-12008-CSLD-STMT-PROS.
           MOVE 0       TO  WA-12008-SOURCE-CDE-N.
           MOVE 0       TO  WA-12008-ACCT-LIM.
TB0159     IF BORP-YOUBE
TB0159        MOVE BORP-HIGHER-INT-RATE TO BOIS-HIGH-INT-RATE
TB0159     END-IF.
           MOVE BOIS-CONTRACT-LIMIT  TO WA-12008-CNTRCT-LIM-AMT.
           MOVE BORM-INT-RATE        TO WA-12008-CNTRCT-RATE.
SC4691     IF BORP-YOUBE
SC4691        IF BORP-BASM-BASE-ID = SPACES
SC4691           OR BORP-BASM-RATE-ID = SPACES
SC4691           MOVE BORM-INT-RATE  TO WA-12008-CNTRCT-RATE
SC4691        ELSE
SC4691            PERFORM E290-SEARCH-RATE-TABLE THRU E299A-EXIT
SC4691            IF WA-MSG-ERR-FLAG = 0
SC4691               MOVE WA-INT-RATE-BASM TO WA-12008-CNTRCT-RATE
SC4691            ELSE
SC4691               MOVE BORM-INT-RATE  TO WA-12008-CNTRCT-RATE
SC4691            END-IF
SC4691        END-IF
SC4691     END-IF.
           MOVE 0       TO  WA-12008-SCORING-LIM.
           MOVE 0       TO  WA-12008-SUGGEST-RATE.
           MOVE 0       TO  WA-12008-PREF-INT-RATE.
           MOVE 0       TO  WA-12008-PREF-INT-PERIOD.
           MOVE SPACES  TO  WA-12008-ACCT-OFF-FL.
           MOVE SPACES  TO  WA-12008-OTHR-ACCT-OFF-FL.
TB0169     MOVE 0       TO  WA-12008-CARD-USED-DT.
SC0827*    MOVE SPACES  TO  WA-12008-START-METHOD.
SC0827     MOVE BORP-START-METH TO WA-12008-START-METHOD.
TB0169     MOVE 0       TO  WA-12008-REFERRAL-FEE-TYP.
TB0169     MOVE SPACES  TO  WA-12008-PROMO-CODE.
S10329     MOVE SPACES  TO  WA-12008-DIS-PROMO-CODE.
S10329     MOVE 0       TO  WA-12008-DIS-EXP-DATE.
TB0235     MOVE 0       TO  WA-12008-SVD-FXD-RATE.
S11173     MOVE SPACE   TO  WA-12008-LIQ-ASSET-PLEDGE.
S11173     MOVE SPACE   TO  WA-12008-CAR-REGIS-RET.
S11173     MOVE SPACES  TO  WA-12008-PRODUCT-CODE.
SC1551     MOVE WA-TR-NA-TYPE        TO WA-12008-ACCT-TYPE.
SC1551     MOVE WA-TR-NA-INT-CAT     TO WA-12008-INT-CAT.
S11173     MOVE SPACES               TO WA-PRODUCT-CODE.
S11173     MOVE WA-TR-NA-TYPE        TO WA-PRODUCT-1.
S11173     MOVE WA-TR-NA-INT-CAT     TO WA-PRODUCT-2.
S11173     MOVE WA-PRODUCT-CODE      TO WA-12008-PRODUCT-CODE.
SC3922     MOVE BORP-HIGH-INT        TO WA-12008-HIGH-INT-RATE.
S10056     IF BORP-YOUBE
S10056        MOVE BORP-HIGHER-INT-RATE TO WA-12008-HIGH-INT-RATE
S10056     END-IF.
S12513     MOVE SPACES  TO  WA-12008-SUP-TELLER.
           GO TO G0300-SEND-12008.
      *
       G0300-17038.
           MOVE BOIS-CREDIT-INVSGTR  TO WA-12008-CREDIT-INV.
           MOVE BOIS-APPROVAL-OFFICER
                TO WA-12008-APPROVAL-OFFICER.
           MOVE BOIS-EXEC-SUPERVISOR TO WA-12008-EXEC-SUP.
           MOVE BOIS-PROMO-TELLER    TO WA-12008-ACCT-OFFICER.
           MOVE BOIS-OTHER-PROMO-TELLER
                TO WA-12008-OTHR-ACCT-OFFICER.
           MOVE BORM-CSLD-STMT-PROS  TO WA-12008-CSLD-STMT-PROS.
           MOVE BOIS-SRCT-CODE       TO WA-12008-SOURCE-CDE-N.
           MOVE BOIS-ACCOUNT-LIMIT   TO WA-12008-ACCT-LIM.
           MOVE BOIS-HIGH-INT-RATE   TO WA-12008-HIGH-INT-RATE.
           MOVE BOIS-CONTRACT-LIMIT  TO WA-12008-CNTRCT-LIM-AMT.
           MOVE BOIS-CONTRACT-RATE   TO WA-12008-CNTRCT-RATE.
TB0235**** MOVE BORM-INT-RATE        TO WA-12008-CNTRCT-LIM-AMT.
           MOVE BOIS-SCORING-LIMIT   TO WA-12008-SCORING-LIM.
           MOVE BOIS-SUGGESTED-RATE  TO WA-12008-SUGGEST-RATE.
           MOVE BOIS-PREF-INT-RATE   TO WA-12008-PREF-INT-RATE.
           MOVE BOIS-PREF-INT-PERIOD TO WA-12008-PREF-INT-PERIOD.
           MOVE BOIS-ACCT-OFCR-1-FLAG TO WA-12008-ACCT-OFF-FL.
           MOVE BOIS-ACCT-OFCR-1-FLAG TO WA-12008-OTHR-ACCT-OFF-FL.
TB0169     MOVE BOIS-CARD-USED-DATE   TO UT0020-BINARY-DATE.
TB0169     MOVE 1                     TO UT0020-FUNCTION.
TB0169     CALL "UT0020"  USING          UT0020-FUNCTION
TB0169                                   UT0020-DATE-AREA
TB0169                                   UT0020-BINARY-DATE.
TB0169     IF UT0020-DATE-DDMMCCYY = 99999999
TB0169        MOVE 0                     TO WA-12008-CARD-USED-DT
TB0169     ELSE
TB0169        MOVE UT0020-DATE-DDMMCCYY  TO WA-12008-CARD-USED-DT.
TB0169     MOVE BOIS-START-METHOD        TO WA-12008-START-METHOD.
TB0169     MOVE 0          TO WA-12008-REFERRAL-FEE-TYP.
TB0169     MOVE BOIS-PROMO-CODE          TO WA-12008-PROMO-CODE.
S10329     MOVE BOIS-DIS-PROMO-CODE      TO WA-12008-DIS-PROMO-CODE.
S10329     MOVE BOIS-DIS-EXP-DATE     TO UT0020-BINARY-DATE.
S10329     MOVE 1                     TO UT0020-FUNCTION.
S10329     CALL "UT0020"  USING          UT0020-FUNCTION
S10329                                   UT0020-DATE-AREA
S10329                                   UT0020-BINARY-DATE.
S10329     IF UT0020-DATE-DDMMCCYY = 99999999
S10329        MOVE 0                     TO WA-12008-DIS-EXP-DATE
S10329     ELSE
S10329        MOVE UT0020-DATE-DDMMCCYY  TO WA-12008-DIS-EXP-DATE
S10329     END-IF.
S11173*
S11173     MOVE BOIS-LIQUID-ASSET-PLEDGE TO WA-12008-LIQ-ASSET-PLEDGE.
S11173*
S11173    MOVE  SPACES                   TO WA-PRODUCT-CODE.
S11173    MOVE  BORM-ACT-TYPE            TO WA-PRODUCT-1.
S11173    MOVE  BORM-CAT                 TO WA-PRODUCT-2.
S11173    MOVE  WA-PRODUCT-CODE          TO WA-12008-PRODUCT-CODE.
S11173*
S11173     IF ( BORP-YOUBE )
S11173        MOVE ZEROS                 TO XFAR-KEY
S11173        MOVE STRT-AREA-SOC-NO      TO XFAR-SOC-NO
S11173        MOVE "BOR"                 TO XFAR-SYSTEM
S11173        MOVE BORM-MEMB-CUST-AC     TO XFAR-ACCT-NO
S11173        MOVE 71                    TO DBIO-CALL-FUNC
S11173        MOVE "N"                   TO WS-NO-REC-FOUND
S11173        PERFORM G600-ACCESS-XFAR   THRU G699-EXIT
S11173        IF ( WS-NO-REC-FOUND       =  "Y" )
S11173             MOVE XFAR-CAR-RET-FLAG(1) TO WA-12008-CAR-REGIS-RET
S11173        ELSE
S11173             MOVE "0"              TO WA-12008-CAR-REGIS-RET
S11173        END-IF
S11173     END-IF.
S11173*
TB0235     IF BORP-YOUBE
TB0235        MOVE BOIS-NEXT-RATE        TO WA-12008-SVD-FXD-RATE.
S12513     MOVE SPACES  TO  WA-12008-SUP-TELLER.
      *
       G0300-SEND-12008.
           IF STRT-AREA-TRN-NO = 12000
              MOVE 12008 TO STRT-AREA-TRN-NO
           ELSE
              MOVE 17038 TO STRT-AREA-TRN-NO
           END-IF.
           MOVE 800      TO WA-OUTPUT-MSG-LENGTH.
           MOVE 998      TO WA-OUTPUT-ERR-MSG-NO.
           MOVE 6        TO STRT-AREA-IEXEC-CNTL.
           PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
      *
       G0309-EXIT.
           EXIT.
      *
TB0169***--end insert
TB0069/
TB0069 G000-PREPARE-17026.
TB0169*
TB0069     INITIALIZE WA-OUTPUT-NEGO-RATES.
TB0069***  MOVE 1                  TO UT0500CA-CALL-CODE.
TB0069***  MOVE BORM-CUSTOMER-NO   TO UT0500CA-CUSM-NO.
TB0069***  PERFORM V500-CALL-UT0500   THRU V599-EXIT.
TB0169     PERFORM G9100-GET-NAME-60CHARS THRU G9109-EXIT.
TB0069     MOVE UT0500RA-FULL-NAME TO WA-17026-NAME.
TB0069*
TB0069     MOVE ZEROES             TO WA-17026-REFER.
TB0069*
TB0169     MOVE BORM-MEMB-CUST-AC  TO WA-MEMB-CUST-AC.
TB0169     PERFORM G9200-GET-ACCT-17  THRU G9209-EXIT.
TB0169     IF WA-MSG-ERR-FLAG  <> 0
TB0169        MOVE 3575 TO WA-ERR-MSG-NO
TB0169        GO TO  G0109-EXIT
TB0169     END-IF.
TB0169*
TB0069***  MOVE BORM-MEMB-CUST-AC  TO UT0151CA-ACCT-IN.
TB0069***  MOVE 2                  TO UT0151CA-CALL-FUNC.
TB0069***  MOVE SOC-ACCT-NO-FORMAT TO UT0151CA-FORMAT.
TB0069***  MOVE SOC-CHK-DGT        TO UT0151CA-CHK-DGT-TYPE.
TB0069***  CALL "UT0151" USING        UT0151CA-CALL-AREA.
TB0069***  IF UT0151CA-STATUS    NOT = 0
TB0069***     MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
TB0069***     MOVE SPACES TO UT8500CA-INPUT-MSG
TB0069***     STRING "BR0000:(G000) UT0151 CALL ERROR; A/C NO - "
TB0069***            UT0151CA-ACCT-IN "; STATUS - " UT0151CA-STATUS
TB0069***        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0069***     CALL "UT8500"   USING
TB0069***                            UT8500CA-AREA
TB0069***     MOVE 1       TO WA-MSG-ERR-FLAG
TB0069***     GO TO G999-EXIT
TB0069***  END-IF.
TB0069*
TB0069     MOVE UT0151CA-ACCT-EX   TO WA-17026-ACCT-NO.
TB0069
TB0069     MOVE SPACES     TO WA-17026-ACTION.
TB0069     MOVE ZEROES     TO WA-17026-REFER.
TB0069     PERFORM VARYING WA-SUB FROM 1 BY 1
TB0069               UNTIL WA-SUB > 15
TB0069       MOVE ZEROES   TO WA-17026-CREAT-DT (WA-SUB)
TB0069                        WA-17026-START-DT (WA-SUB)
TB0069                        WA-17026-END-DATE (WA-SUB)
69IR32       MOVE 0        TO WA-17026-RATE (WA-SUB)
69IR32                        WA-17026-FLOAT (WA-SUB)
TB0069       MOVE SPACES   TO WA-17026-RATE-FLAG (WA-SUB)
TB0069                        WA-17026-POST-FLAG (WA-SUB)
TB0069     END-PERFORM.
TB0069*
S15813     MOVE 1                        TO WA-SUB.
S15813     MOVE BORM-REFERRAL-DATE       TO WA-SOURCE-ADV-DATE.
S15813     MOVE BORP-PRODUCT-GROUP(WA-SUB) TO WA-PRODUCT-GROUP.
S15813     MOVE 0                        TO WA-TEMP-MATURITY-DT.
S16426*
S16426     IF ( VALID-POLICY-LOAN2
S16426     AND  BORM-REFERRAL-DATE   NOT >  0 )
S16426          IF ( BORM-DUE-STRT-DATE  =  0 )
S16426               MOVE BORM-APPLIC-ISSUE-DATE TO WA-SOURCE-ADV-DATE
S16426          ELSE
S16426               MOVE BORM-DUE-STRT-DATE TO WA-SOURCE-ADV-DATE
S16426          END-IF
S16426          IF ( WA-SOURCE-ADV-DATE NOT > 0 )
S16426               MOVE STRT-AREA-POST-DT TO WA-SOURCE-ADV-DATE
S16426          END-IF
S16426     END-IF.
S15813*
S15813     IF ( VALID-POLICY-LOAN )
S16426     OR ( VALID-POLICY-LOAN2 )
S15813          MOVE WA-SOURCE-ADV-DATE  TO WA-BIN-DATE
S15813          PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S15813          MOVE WA-DDMMCCYY-DATE(1:2) TO WA-SOURCE-REPAY-DAY
S15813          IF ( BOIS-MATURITY-DATE  =  0 )
S15813               INITIALIZE UT0312CA-CALL-AREA
S15813               MOVE 17             TO UT0312CA-CALL-CODE
S15813               MOVE STRT-AREA-POST-DT
S15813                                   TO UT0312CA-EFF-DATE
S15813               IF ( BORM-DUE-STRT-DATE = 0 )
S15813                    MOVE STRT-AREA-POST-DT
S15813                                   TO UT0312CA-DUE-STRT-DT
S15813               ELSE
S15813                    MOVE BORM-DUE-STRT-DATE
S15813                                   TO UT0312CA-DUE-STRT-DT
S15813               END-IF
S15813               IF ( BORM-REPAY-FREQ > 0 )
S15813                    MOVE BORM-REPAY-FREQ
S15813                                   TO UT0312CA-REPAY-FREQ
S15813               ELSE
S15813                    MOVE BORP-REPAY-FREQ
S15813                                   TO UT0312CA-REPAY-FREQ
S15813               END-IF
S15813               IF ( BORM-REPAY-SCHED = SPACE )
S15813                    MOVE BORP-REPAY-SCHED
S15813                                   TO UT0312CA-REPAY-SCHED
S15813               ELSE
S15813                    MOVE BORM-REPAY-SCHED
S15813                                   TO UT0312CA-REPAY-SCHED
S15813               END-IF
S15813               MOVE BORM-CAPN-METHOD TO UT0312CA-CAPN-METHOD
S15813               MOVE BORM-LOAN-TRM  TO UT0312CA-LOAN-TERM
S15813               IF ( BORM-REPAY-DAY >  0 )
S15813                    MOVE BORM-REPAY-DAY TO UT0312CA-REPAY-DAY
S15813               ELSE
S15813                    MOVE UT0312CA-DUE-STRT-DT
S15813                                   TO WA-BIN-DATE
S15813                    PERFORM D410-CONVERT-BIN-DATE
S15813                                   THRU D419-EXIT
S15813                    MOVE WA-DDMMCCYY-DATE(1:2)
S15813                                   TO UT0312CA-REPAY-DAY
S15813               END-IF
S15813               MOVE BOIS-DUE-DTE-IND
S15813                                   TO UT0312CA-1ST-DUE-DTE-IND
S15813               SET  UT0312CA-HOLIDAY-DUE-PREV-WD TO TRUE
S15813               CALL "UT0312"       USING UT0312CA-CALL-AREA
S15813               IF ( UT0312CA-RET-STATUS NOT = 0 )
S15813                    MOVE 296       TO WA-ERR-MSG-NO
S15813                    MOVE 1         TO WA-MSG-ERR-FLAG
S15813                    GO             TO G999-EXIT
S15813               ELSE
S15813                    MOVE UT0312CA-MATURITY-DT
S15813                                   TO WA-TEMP-MATURITY-DT
S15813               END-IF
S15813          ELSE
S15813               MOVE BOIS-MATURITY-DATE TO WA-TEMP-MATURITY-DT
S15813          END-IF
S15813          INITIALIZE UT0312CA-CALL-AREA
S15813          MOVE 17                  TO UT0312CA-CALL-CODE
S15813          MOVE STRT-AREA-POST-DT   TO UT0312CA-EFF-DATE
S15813          MOVE WA-SOURCE-ADV-DATE  TO UT0312CA-DUE-STRT-DT
S15813          IF ( BORM-REPAY-FREQ     >  0 )
S15813               MOVE BORM-REPAY-FREQ TO UT0312CA-REPAY-FREQ
S15813          ELSE
S15813               MOVE BORP-REPAY-FREQ TO UT0312CA-REPAY-FREQ
S15813          END-IF
S15813          IF ( BORM-REPAY-SCHED    =  SPACE )
S15813               MOVE BORP-REPAY-SCHED TO UT0312CA-REPAY-SCHED
S15813          ELSE
S15813               MOVE BORM-REPAY-SCHED TO UT0312CA-REPAY-SCHED
S15813          END-IF
S15813          MOVE BORM-CAPN-METHOD    TO UT0312CA-CAPN-METHOD
S15813          MOVE 240                 TO UT0312CA-LOAN-TERM
S15813          MOVE WA-SOURCE-REPAY-DAY TO UT0312CA-REPAY-DAY
S15813          MOVE BOIS-DUE-DTE-IND    TO UT0312CA-1ST-DUE-DTE-IND
S15813          SET  UT0312CA-HOLIDAY-DUE-PREV-WD TO TRUE
S15813          CALL "UT0312"            USING UT0312CA-CALL-AREA
S15813          IF ( UT0312CA-RET-STATUS NOT = 0 )
S15813               MOVE 296            TO WA-ERR-MSG-NO
S15813               MOVE 1              TO WA-MSG-ERR-FLAG
S15813               GO                  TO G999-EXIT
S15813          END-IF
S15813          PERFORM VARYING WA-SUB FROM 1 BY 1
S15813                  UNTIL   WA-SUB > 2
S15813            IF ( WA-SUB = 1 )
S15813               MOVE STRT-AREA-POST-DT TO WA-BIN-DATE
S15813               PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S15813               MOVE WA-DDMMCCYY-DATE  TO
S15813                                   WA-17026-CREAT-DT(WA-SUB)
S15813               MOVE WA-DDMMCCYY-DATE  TO
S15813                                   WA-17026-START-DT(WA-SUB)
S15813               MOVE UT0312CA-MATURITY-DT TO WA-BIN-DATE
S15813               PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S15813               MOVE WA-DDMMCCYY-DATE  TO
S15813                                   WA-17026-END-DATE(WA-SUB)
S15813               MOVE 0              TO WA-17026-RATE (WA-SUB)
S15813               MOVE +0             TO WA-17026-FLOAT(WA-SUB)
S15813               MOVE 2              TO WA-17026-RATE-FLAG(WA-SUB)
S15813            ELSE
S15813               MOVE STRT-AREA-POST-DT TO WA-BIN-DATE
S15813               PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S15813               MOVE WA-DDMMCCYY-DATE  TO
S15813                                   WA-17026-CREAT-DT(WA-SUB)
S15813               MOVE UT0312CA-MATURITY-DT TO WA-BIN-DATE
S15813               PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S15813               MOVE WA-DDMMCCYY-DATE  TO
S15813                                   WA-17026-START-DT(WA-SUB)
S15813               MOVE WA-TEMP-MATURITY-DT  TO WA-BIN-DATE
S15813               PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S15813               MOVE WA-DDMMCCYY-DATE  TO
S15813                                   WA-17026-END-DATE(WA-SUB)
S15813               MOVE 0              TO WA-17026-RATE (WA-SUB)
S15813               MOVE +1             TO WA-FLOAT-RATE
S15813               IF ( BOIS-PROJECT-ID NOT = 0 )
S15813                    PERFORM X430-GET-MARGIN-RTN THRU X430-EXIT
S15813               END-IF
S15813               MOVE WA-FLOAT-RATE  TO WA-17026-FLOAT(WA-SUB)
S15813               MOVE 2              TO WA-17026-RATE-FLAG(WA-SUB)
S15813            END-IF
S15813          END-PERFORM
S15813     END-IF.
S15813*
TB0069*69IRMOVE 597        TO WA-OUTPUT-MSG-LENGTH.
69IR32     MOVE 747        TO WA-OUTPUT-MSG-LENGTH.
TB0069     MOVE 17026      TO STRT-AREA-TRN-NO.
TB0069     MOVE 998        TO WA-OUTPUT-ERR-MSG-NO.
TB0069     MOVE 6          TO STRT-AREA-IEXEC-CNTL.
TB0069     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
TB0069*
TB0069 G999-EXIT.
TB0069     EXIT.
TB0069/
S16588 G100-PREPARE-17085.
S16588     IF  NOT  STRT-BANCSLINK
S16588     OR  ( BORP-REPAY-PEN-IND  = 'N'
S16588       AND BORP-CLOSE-PEN-IND  = 'N')
S16588       GO                      TO G100-EXIT
S16588     END-IF.
S16588     INITIALIZE WA-OUTPUT-17085.
S16588     MOVE  'Y'                 TO WA-OUT-17085-AUTOLINK.
S16588     MOVE  'A'                 TO WA-OUT-17085-CLOSE-OPTION.
S16588     PERFORM G9100-GET-NAME-60CHARS THRU G9109-EXIT.
S16588     MOVE UT0500RA-FULL-NAME TO WA-OUT-17085-ACCT-NAME.
S16588     MOVE BOIS-MEMB-CUST-AC    TO WA-OUT-17085-ACCT-NO.
S16588     MOVE BOIS-REPAY-PEN-METH  TO WA-OUT-17085-PEN-METH.
S16588     MOVE BOIS-PEN-WEIGHT(01)  TO WA-OUT-17085-PEN-WEIGHT1.
S16588     MOVE BOIS-PEN-WEIGHT(02)  TO WA-OUT-17085-PEN-WEIGHT2.
S16588     MOVE BOIS-REPAY-RESET-PRIN-ACCU
S16588       TO WA-OUT-17085-RESET-PRIN.
S16588     MOVE BOIS-REPAY-CR-FIX-AMT
S16588       TO WA-OUT-17085-CR-FIX-AMT.
S16588     MOVE BOIS-CR-PERCENT      TO WA-OUT-17085-CR-PERCENT.
S16588     MOVE BOIS-ACCU-PRIN-AMT   TO WA-OUT-17085-ACCU-PRIN.
S16588     MOVE BOIS-THRESH-FLAG     TO WA-OUT-17085-THRESH-FLAG.
S16588     MOVE BOIS-CLOSE-PEN-METH  TO WA-OUT-17085-CLOSE-METH.
S16588     MOVE BOIS-CLOSE-PEN-TERM-FCTR(01)
S16588       TO WA-OUT-17085-CLOSE-FCTR1.
S16588     MOVE BOIS-CLOSE-PEN-TERM-FCTR(02)
S16588       TO WA-OUT-17085-CLOSE-FCTR2.
S17067     MOVE BOIS-CLOSE-PEN-TERM-FCTR3
S17067       TO WA-OUT-17085-CLOSE-FCTR3.
S19421     MOVE BORM-ADV-VAL          TO WA-OUT-17085-ADV-VAL.
S19421     MOVE BORM-LOAN-BAL         TO WA-OUT-17085-LOAN-BAL.
S19421
S19421     INITIALIZE UT0072CA-AREA.
S19421     MOVE 0                     TO UT0072CA-DISCHARGE-AMT.
S19421     MOVE 08                    TO UT0072CA-CALL-CODE.
S19421     MOVE BORM-ADD-ADV-DATE     TO UT0072CA-NEXT-WORK-DATE.
S19421     CALL "UT0072"  USING  UT0072CA-CALL-AREA
S19421                           BORM-RECORD-AREA
S19421                           BOIS-RECORD
S19421                           BORR-PARAMS.
S19421     MOVE UT0072CA-EARLY-PRINCIPAL-AMT  TO
S19421                                  WA-OUT-17085-CLOSE-PRIN.
S16588 G100-CONVERT-DATES.
S16588     MOVE SPACES               TO WA-OUT-17085-PEN-TERM1
S16588                                  WA-OUT-17085-PEN-TERM2
S16588                                  WA-OUT-17085-START-DATE
S16588                                  WA-OUT-17085-CLOSE-TERM1
S16588                                  WA-OUT-17085-CLOSE-TERM2.
S17067     MOVE SPACES               TO WA-OUT-17085-CLOSE-TERM3.
S19421     MOVE SPACES               TO WA-OUT-17085-FIRST-ADV-DATE
S19421                                  WA-OUT-17085-MATURITY-DATE
S19421                                  WA-OUT-17085-CLOSE-ADV-DATE.
S16588     IF   BOIS-PEN-TERM(01) > 0
S16588          MOVE BOIS-PEN-TERM(01)    TO UT0020-BINARY-DATE
S16588          MOVE 1  TO UT0020-FUNCTION
S16588          PERFORM X600-UT0020-PARA THRU X609-EXIT
S16588          MOVE UT0020-DATE-DDMMCCYY
S16588            TO WA-OUT-17085-PEN-TERM1.
S16588     IF   BOIS-PEN-TERM(02) > 0
S16588          MOVE BOIS-PEN-TERM(02)    TO UT0020-BINARY-DATE
S16588          MOVE 1  TO UT0020-FUNCTION
S16588          PERFORM X600-UT0020-PARA THRU X609-EXIT
S16588          MOVE UT0020-DATE-DDMMCCYY
S16588          TO WA-OUT-17085-PEN-TERM2.
S16588     IF   BOIS-REPAY-START-ACCU-DATE > 0
S16588          MOVE BOIS-REPAY-START-ACCU-DATE TO UT0020-BINARY-DATE
S16588          MOVE 1  TO UT0020-FUNCTION
S16588          PERFORM X600-UT0020-PARA THRU X609-EXIT
S16588          MOVE UT0020-DATE-DDMMCCYY
S16588          TO WA-OUT-17085-START-DATE
S16588     END-IF.
S16588     IF   BOIS-CLOSE-PEN-TERM(01) > 0
S16588          MOVE BOIS-CLOSE-PEN-TERM(01)    TO UT0020-BINARY-DATE
S16588          MOVE 1  TO UT0020-FUNCTION
S16588          PERFORM X600-UT0020-PARA THRU X609-EXIT
S16588          MOVE UT0020-DATE-DDMMCCYY
S16588          TO WA-OUT-17085-CLOSE-TERM1.
S16588     IF   BOIS-CLOSE-PEN-TERM(02) > 0
S16588          MOVE BOIS-CLOSE-PEN-TERM(02)    TO UT0020-BINARY-DATE
S16588          MOVE 1  TO UT0020-FUNCTION
S16588          PERFORM X600-UT0020-PARA THRU X609-EXIT
S16588          MOVE UT0020-DATE-DDMMCCYY
S16588          TO WA-OUT-17085-CLOSE-TERM2
S16588     ELSE
S16588          MOVE SPACES    TO WA-OUT-17085-CLOSE-TERM2
S16588     END-IF.
S17067     IF   BOIS-CLOSE-PEN-TERM3    > 0
S17067          MOVE BOIS-CLOSE-PEN-TERM3       TO UT0020-BINARY-DATE
S17067          MOVE 1  TO UT0020-FUNCTION
S17067          PERFORM X600-UT0020-PARA THRU X609-EXIT
S17067          MOVE UT0020-DATE-DDMMCCYY
S17067          TO WA-OUT-17085-CLOSE-TERM3
S17067     END-IF.
S19421     IF   BOIS-FIRST-ADV-DATE     > 0
S19421          MOVE BOIS-FIRST-ADV-DATE        TO UT0020-BINARY-DATE
S19421          MOVE 1  TO UT0020-FUNCTION
S19421          CALL "UT0020" USING
S19421                               UT0020-FUNCTION
S19421                               UT0020-DATE-AREA
S19421                               UT0020-BINARY-DATE
S19421          MOVE UT0020-DATE-DDMMCCYY
S19421          TO WA-OUT-17085-FIRST-ADV-DATE
S19421     END-IF.
S19421     IF   BOIS-MATURITY-DATE      > 0
S19421          MOVE BOIS-MATURITY-DATE         TO UT0020-BINARY-DATE
S19421          MOVE 1  TO UT0020-FUNCTION
S19421          CALL "UT0020" USING
S19421                               UT0020-FUNCTION
S19421                               UT0020-DATE-AREA
S19421                               UT0020-BINARY-DATE
S19421          MOVE UT0020-DATE-DDMMCCYY
S19421          TO WA-OUT-17085-MATURITY-DATE
S19421     END-IF.
S19421     IF   BORM-ADD-ADV-DATE       > 0
S19421          MOVE BORM-ADD-ADV-DATE          TO UT0020-BINARY-DATE
S19421          MOVE 1  TO UT0020-FUNCTION
S19421          CALL "UT0020" USING
S19421                               UT0020-FUNCTION
S19421                               UT0020-DATE-AREA
S19421                               UT0020-BINARY-DATE
S19421          MOVE UT0020-DATE-DDMMCCYY
S19421          TO WA-OUT-17085-CLOSE-ADV-DATE
S19421     ELSE
S19421        IF  BOIS-FIRST-ADV-DATE     > 0
S19421            MOVE BOIS-FIRST-ADV-DATE      TO UT0020-BINARY-DATE
S19421            MOVE 1  TO UT0020-FUNCTION
S19421            CALL "UT0020" USING
S19421                               UT0020-FUNCTION
S19421                               UT0020-DATE-AREA
S19421                               UT0020-BINARY-DATE
S19421            MOVE UT0020-DATE-DDMMCCYY
S19421            TO WA-OUT-17085-CLOSE-ADV-DATE
S19421        ELSE
S19421          IF  BORM-APPRV-DATE         > 0
S19421              MOVE BORM-APPRV-DATE          TO UT0020-BINARY-DATE
S19421              MOVE 1  TO UT0020-FUNCTION
S19421              CALL "UT0020" USING
S19421                               UT0020-FUNCTION
S19421                               UT0020-DATE-AREA
S19421                               UT0020-BINARY-DATE
S19421              MOVE UT0020-DATE-DDMMCCYY
S19421              TO WA-OUT-17085-CLOSE-ADV-DATE
S19421     END-IF.
S16588 G100-SEND-SCREEN.
S16588
S19421     MOVE 350        TO WA-OUTPUT-MSG-LENGTH.
S19421*S17067     MOVE 272        TO WA-OUTPUT-MSG-LENGTH.
S17067**S16588  MOVE 256        TO WA-OUTPUT-MSG-LENGTH.
S16588     MOVE 17085      TO STRT-AREA-TRN-NO.
S16588     MOVE 998        TO WA-OUTPUT-ERR-MSG-NO.
S16588     MOVE 6          TO STRT-AREA-IEXEC-CNTL.
S16588     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
S16588
S16588 G100-EXIT.
S16588     EXIT.
114730/
114740 H000-CALC-INT.
114750**************************************************************
114760*** CALCULATES A NEW INTEREST INCREMENT FOR DAILY INTEREST   *
114770*** COUNTS.                                                *
114780**************************************************************
SC0460*    IF BORP-PRIORITY-TERM-BY-TERM
SC0460*       GO TO H099-EXIT
SC0460*    END-IF.
S12384     IF WA-REPAY-PRN-RECALC-Y
S12384     AND BORP-RECEIVABLE-YES
S12384         GO TO H099-EXIT
S12384     END-IF.
ST0049     IF  BORP-YOUBE
ST0049     AND WA-INPUT-PARAM-TABLE(8) = 1
ST0049         GO TO H099-EXIT
ST0049     END-IF.
S11634* YOUBE TREM BY TERM DON'T NEED TO RE CALCULATE DUE AMOUNT
S11634     IF (NOT BORP-YOUBE)
S11634         AND BORP-FINE-METH    =  99
S11634         AND BORP-FINE-CONDT   =  99
S11634        COMPUTE WA-TEMP-INT-INCR = (BORM-LOAN-BAL *
S11634                         (BORM-STORE-RATE / 100)) /
S11634                          BORP-INT-DAYS-YR
S11634        MOVE WA-TEMP-INT-INCR TO BORM-INT-INCR
S11634     END-IF.
S11634     IF (NOT BORP-YOUBE)
S11634         AND BORP-FINE-METH    =  99
S11634         AND BORP-FINE-CONDT   =  99
S11634         GO TO H099-EXIT
S11634     END-IF.
SC4561     MOVE BORM-BAD-DEBT-IND  TO WA-BAD-DEBT-IND
SC4561     IF WA-BAD-DEBT-IND-2 > 1
SC8927     AND NOT BORP-YOUBE 
SC4561        COMPUTE WA-TEMP-INT-INCR = (BORM-LOAN-BAL *
SC4561                         (BORM-STORE-RATE / 100)) /
SC4561                          BORP-INT-DAYS-YR
SC4561        MOVE WA-TEMP-INT-INCR TO BORM-INT-INCR
SC4561        GO TO H099-EXIT
SC4561     END-IF.
SC0985**** Do not perform this transaction for backdated advance
SC0985**** and normal loans.
SC1740*     IF NOT BORP-YOUBE
SC1740*      AND (STRT-AREA-TRN-NO = 16055 OR 16060 OR 16057
SC1740*      OR  11110
SC1740*      OR  17467
SC1740*      OR  16044 OR 16048 OR 16144 OR 16148 OR 16030 OR 16130)
SC1740*      AND (STRT-AREA-TRN-NO = 16055 OR 16060 OR 16057)
SC1740*        GO TO H099-EXIT
SC1740*     END-IF.
SC0985
SC8330     MOVE STRT-AREA-POST-DT TO WA-DMY.
S10467     IF STRT-AREA-TRN-NO = 16055 OR 16060 OR 16057   
S12770     OR 16063
S10467      AND WA-FIRST-ADV                               
S10467       MOVE WA-ADV-DATE-BIN   TO WA-ADV-DATE-BIN-SAVE
S10467       MOVE STRT-AREA-POST-DT TO WA-ADV-DATE-BIN     
S10467     END-IF                                          
S10467                                                     
SC8330     PERFORM H010A-GET-RATE  THRU H019A-EXIT.
SC8330     IF WA-MSG-ERR-FLAG = 1
SC8330        GO TO H099-EXIT.
S10467     IF STRT-AREA-TRN-NO = 16055 OR 16060 OR 16057 
S12770     OR 16063
S10467      AND WA-FIRST-ADV                             
S10467       MOVE WA-ADV-DATE-BIN-SAVE TO WA-ADV-DATE-BIN
S10467     END-IF                                        
S10467                                                   
CS8758     MOVE 0                   TO WA-RECALC-IND
SC1794*    FOR REPAY SCHED="K", NEED TO GET THE PREVIOUS DUE AMOUNT
SC1794*    AND RECALC IND IN ORDER TO GET THE CORRECT NEXT DUE AMOUNT
SC1794     IF BORP-NO-CAPITALIZATION
SC2681*       IF NOT BORP-YOUBE AND BORM-REPAY-SCHED = "K"
SC2681*       AND STRT-AREA-TRN-NO = 11010 OR 11045 OR 11046
SC2681*                           OR 11110 OR 11145 OR 11146
SC2681        IF (NOT BORP-YOUBE) AND BORM-REPAY-SCHED = "K"
SC2681        AND (STRT-AREA-TRN-NO = 11010 OR 11045 OR 11046
SC2681                             OR 11110 OR 11145 OR 11146
SC9557                             OR 11020 OR 11120
S10982                             OR 11049 OR 11149
SC4890*                            OR 14010 OR 14110)
SC4458                             OR 14010 OR 14110 OR 13145
SC5862**SC9586                     OR 14011 OR 14111)
SC9586                             OR 14011 OR 14111              
SC9797                             OR 17046
SC9586                             OR (WA-INPUT-PARAM-TABLE(4) = 1
SC9586                             AND (STRT-FEP-ATM-TXN          
SC9586                             OR STRT-AREA-EFT-TXN)))        
CS8758** "K" Repay sched. Recompute should only happen when due amt being  
CS8758** recomputed is the term after the next reprice dt. If prev-due-date
CS8758** = next reprice date, then that is the time we recompute the       
CS8758** due amt. The problem is during correction you will never know     
CS8758** what the previous due amt is. This will be fixed in BR0023.       
SC1794*CS8758   MOVE UT0075CA-PREV-DUE-DATE TO WA-PREV-DUE-DTE
SC1794*CS8758
SC1794*CS8758   MOVE  02       TO UT0075CA-CALL-CODE
SC1794*         MOVE UT0094CA-BASED-DATE TO UT0075CA-SYS-DATE
SC8758* NEED TO DISCUSS WITH USER; THIS MEETS USER EXPECTATION.
SC8758* BUT EXPECTATION SEEMS TO BE WRONG.
SC8758*CS8758   IF BOIS-PREV-DUE-DATE NOT = 0
SC8758*CS8758      MOVE BOIS-PREV-DUE-DATE TO UT0075CA-SYS-DATE
SC1794*CS8758                                 UT0075CA-EFF-DATE
SC8758*CS8758   ELSE
SC8758*CS8758      MOVE BORM-DUE-STRT-DATE TO UT0075CA-SYS-DATE
SC8758*CS8758                                 UT0075CA-EFF-DATE
SC8758*CS8758   END-IF
SC1794*CS8758   MOVE BORM-STORE-RATE    TO UT0075CA-INT-RATE
SC1794*CS8758   MOVE UT0290CA-CURR-DECS TO UT0075CA-CURR-DECS
SC1794*CS8758   IF BORM-REPAY-SCHED = SPACE
SC1794*CS8758      MOVE BORP-REPAY-SCHED TO UT0075CA-REPAY-SCHED
SC1794*CS8758   ELSE
SC1794*CS8758      MOVE BORM-REPAY-SCHED TO UT0075CA-REPAY-SCHED
SC1794*CS8758   END-IF
SC1794*CS8758   CALL "UT0075" USING UT0075CA-CALL-AREA
SC1794*CS8758                        BORM-RECORD-AREA
SC1794*CS8758                        BOIS-RECORD
SC1794*CS8758                        BORR-PARAMS
SC1794*CS8758                        SOC-PARAMS
SC1794*CS8758   IF UT0075CA-RET-STATUS <> ZEROS
SC1794*CS8758        MOVE UT0075CA-RET-ERROR-MSG TO
SC1794*CS8758              WA-OUTPUT-ERR-MSG-NO
SC1794*CS8758        MOVE 1 TO WA-MSG-ERR-FLAG
SC1794*CS8758        GO TO H099-EXIT
SC1794*CS8758   END-IF
SC1794*CS8758   COMPUTE BORM-LOAN-REPAY = UT0075CA-REPAY-AMT
SC1794*CS8758       - UT0075CA-INTEREST-DUE
SC1794*CS8758   IF UT0075CA-RECALC-IND = 1
SC1794*CS8758      MOVE UT0075CA-RECALC-IND TO WA-RECALC-IND
SC1794*CS8758   ELSE
SC1794*CS8758      MOVE 0                   TO WA-RECALC-IND
SC1794*CS8758   END-IF
CS8758          IF WA-INPUT-PARAM-TABLE(7) = 0                         
CS8758             IF BOIS-ARREARS-CTR > 0                             
CS8758              OR BOIS-LAST-ADV-PYMT-DATE < STRT-AREA-POST-DT     
CS8758              OR BORM-REM-REPAYS = 0                             
CS8758              OR BORM-STAT       < 06                            
CS8758              OR BORM-STAT       > 08                            
CS8758                MOVE 0                   TO WA-RECALC-IND        
CS8758             ELSE                                                
CS8758** Get the reprice date by calling UT0312.                       
CS8758                INITIALIZE UT0312CA-CALL-PARAMETER               
CS8758                IF BOIS-PREV-DUE-DATE NOT = 0                    
CS8758                   COMPUTE UT0312CA-EFF-DATE = BOIS-PREV-DUE-DATE
CS8758                                               - 1               
CS8758                ELSE                                             
CS8758                   MOVE BORM-DUE-STRT-DATE TO UT0312CA-EFF-DATE  
CS8758                END-IF                                           
CS8758                MOVE 19                   TO UT0312CA-CALL-CODE  
CS8758                MOVE BORM-DUE-STRT-DATE   TO UT0312CA-DUE-STRT-DT
CS8758                MOVE BORM-REPAY-FREQ      TO UT0312CA-REPAY-FREQ 
CS8758                IF BORM-REPAY-SCHED = SPACE                      
CS8758                   MOVE BORP-REPAY-SCHED  TO UT0312CA-REPAY-SCHED
CS8758                ELSE                                             
CS8758                   MOVE BORM-REPAY-SCHED  TO UT0312CA-REPAY-SCHED
CS8758                END-IF                                            
CS8758                MOVE BORM-CAPN-METHOD    TO UT0312CA-CAPN-METHOD  
CS8758                MOVE BORP-ACCRUE-METHOD  TO UT0312CA-ACCRUE-METHOD
CS8758                MOVE BORM-LOAN-TRM       TO UT0312CA-LOAN-TERM    
CS8758                MOVE BORM-TERM-BASIS     TO UT0312CA-TERM-BASIS   
CS8758                MOVE BORM-REPAY-DAY      TO UT0312CA-REPAY-DAY    
CS8758                SET UT0312CA-HOLIDAY-DUE-PREV-WD TO TRUE          
CS8758                MOVE BORM-KEY            TO UT0312CA-ACCT-KEY     
CS8758                MOVE BORP-INT-DAYS-YR  TO UT0312CA-INT-NO-DAYS-YR 
CS8758                MOVE "N"               TO UT0312CA-1ST-DUE-DTE-IND
CS8758                CALL "UT0312" USING                               
CS8758                              UT0312CA-CALL-AREA                  
CS8758                                                                  
CS8758                IF UT0312CA-RET-STATUS NOT = ZERO                 
CS8758                   MOVE 3026             TO WA-OUTPUT-ERR-MSG-NO  
CS8758                   MOVE 1                TO WA-MSG-ERR-FLAG       
CS8758                   GO   TO  H099-EXIT                             
CS8758                END-IF                                            
CS8758                IF UT0312CA-NEXT-REPRICE-DT = BOIS-PREV-DUE-DATE  
CS8758                   MOVE 1                TO WA-RECALC-IND         
CS8758                ELSE                                              
CS8758                   MOVE 0                TO WA-RECALC-IND         
CS8758                END-IF                                
CS8758             END-IF                                   
CS8758          ELSE                                        
CS8758             MOVE 0                   TO WA-RECALC-IND
CS8758          END-IF                                      
CS8758        END-IF                                        
SC2681     END-IF.
SC1794
SC1740     IF BORP-NO-CAPITALIZATION
SC1740        IF NOT BORP-YOUBE
SC1742          IF BORM-REM-REPAYS = 0
SC0224          OR BORM-STAT       < 06
SC2459             IF BORM-LOAN-BAL <= 0
SC8711                 MOVE 0      TO               BORM-INT-INCR
SC2459*SC8458                                       BORM-BPI-INCR
SC2459*SC8458                                       BORM-CI-INCR
SC2459*SC8458                                       BORM-INT-ACCR
SC2459*SC8458                                       BORM-BPI-ACCR
SC2459*SC8458                                       BORM-CI-ACCR
SC2459*             END-IF
SC1742             GO TO H099-EXIT
SC4458             END-IF
SC1742          END-IF
SC5381          IF BORM-STAT = 50                                        
S10467***********NEED TO PUT ADDITIONAL VAL FOR SINGLE TERM ACCT   
S10467            OR (BORM-REM-REPAYS = 0 AND BOIS-ARREARS-CTR = 0)
SC8006            IF BORM-LOAN-BAL > 0
SC5381             MOVE BORM-LOAN-BAL    TO BORM-DUE-AMT                 
SC5381                                      BORM-LOAN-REPAY              
SC5381                                                                   
SC5381             INITIALIZE UT0078CA-CALL-AREA                         
SC5381             MOVE 9                TO UT0078CA-CALL-CODE           
SC5381             MOVE BORM-LOAN-BAL    TO UT0078CA-AMOUNT              
SC5381             MOVE BORM-STORE-RATE  TO UT0078CA-INT-RATE            
SC5381             MOVE BORP-INT-DAYS-YR TO UT0078CA-INT-DAYS-YR         
SC5381             CALL "UT0078" USING                                   
SC5381                           UT0078CA-CALL-AREA                      
SC5381             IF UT0078CA-RET-STATUS <> WA-ZERO                     
SC5381                 MOVE 767          TO WA-OUTPUT-ERR-MSG-NO         
SC5381                 MOVE 1            TO WA-MSG-ERR-FLAG              
SC5381                 MOVE UT8500CA-FUNC-NORMAL-DISPLAY                 
SC5381                                   TO UT8500CA-CALL-CODE           
SC5381                 MOVE SPACES TO UT8500CA-INPUT-MSG                 
SC5381                 STRING "BR0000(H000): DUES RECALC ERROR ..."      
SC5381                         BORM-KEY  " " UT0078CA-RET-STATUS         
SC5381                         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG 
SC5381                 CALL "UT8500" USING                               
SC5381                                     UT8500CA-AREA                 
SC5381             ELSE                                                  
SC5381                 MOVE UT0078CA-LI-INCR TO BORM-INT-INCR
SC5381             END-IF                                    
SC8006            ELSE
SC8006              MOVE 0     TO BORM-INT-INCR
SC8006            END-IF
SC5381             GO TO H099-EXIT                           
SC5381          END-IF                                       
SC1740          IF STRT-AREA-TRN-NO = 13131 OR 11144 OR 11148 OR
SC1740                                11010 OR 11045 OR 11046 OR
SC1740                                11110 OR 11145 OR 11146 OR
SC9557                                11020 OR 11120 OR
SC1740                                13031 OR 11044 OR 11048
SC2132                             OR 16044 OR 16048 OR
SC2132                                16144 OR 16148
S10982                             OR 16120 OR 11049 OR 11149
SC1667                             OR 16010 OR 16045 OR 16046
SC1667                             OR 16110 OR 16145 OR 16146
SC1961                             OR 16055 OR 16057 OR 16060
SC3970                             OR 16155 OR 16157 OR 16160
S12770                             OR 16063 OR 16163
S10982                             OR 17467 OR 16049 OR 16149
SC4890                             OR 14010 OR 14110
SC5862                             OR 14011 OR 14111
S10542                             OR 16111 OR 16130
S11617                             OR 16129
S17282                             OR 16102
S12394                             OR 16101
SC4458                             OR 13145 
SC5537                             OR 13110 OR 13146         
SC5537                             OR 15145 OR 15146 OR 15009
S12384                             OR 17046 OR 11030 OR 11130 OR 16030
SC9797*S12384                      OR 17046
SC9586                             OR (WA-INPUT-PARAM-TABLE(4) = 1
SC9586                             AND (STRT-FEP-ATM-TXN          
SC9586                             OR STRT-AREA-EFT-TXN))         
SC1605                             OR (STRT-AREA-TRN-NO = 17022
S15871                            AND BOIS-AGREE-FUNC-USE)
S15871*SC1605                            AND BOIS-AGREE-IND = 2)
SC5059                             OR (STRT-AREA-TRN-NO = 17033
SC5059                            AND BOIS-AGREE-IND = 0)
SC3865                             OR (STRT-AREA-TRN-NO = 17026
SC3865                            AND WA-UPDATE-INT-INCR = "Y")
SC1740           INITIALIZE UT0075CA-CALL-AREA
SC1740           MOVE  02       TO UT0075CA-CALL-CODE
SC1740           MOVE STRT-AREA-POST-DT  TO UT0075CA-SYS-DATE
SC1740                                      UT0075CA-EFF-DATE
SC1605           IF BOIS-LAST-UNPAID-DUE-DATE > UT0075CA-EFF-DATE
SC2000*             MOVE BOIS-LAST-UNPAID-DUE-DATE TO UT0075CA-EFF-DATE
SC2000              COMPUTE UT0075CA-EFF-DATE =
SC2000                   BOIS-LAST-UNPAID-DUE-DATE - 1
SC1605           END-IF
S16271           IF  STRT-AREA-TRN-NO = 17046
S16271           AND BOIS-PRINCIPAL-DUE > 0
S16271           AND BOIS-ARREARS-CTR   > 0
S16271               MOVE BOIS-PRINCIPAL-DUE TO UT0075CA-ADJ-PRINCIPAL
S16271           END-IF
SC1740*SC8330    MOVE BORM-STORE-RATE    TO UT0075CA-INT-RATE
SC8330           MOVE WA-INT-RATE-A      TO UT0075CA-INT-RATE
SC1740           MOVE UT0290CA-CURR-DECS TO UT0075CA-CURR-DECS
SC1740           IF BORM-REPAY-SCHED = SPACE
SC1740              MOVE BORP-REPAY-SCHED TO UT0075CA-REPAY-SCHED
SC1740           ELSE
SC1740              MOVE BORM-REPAY-SCHED TO UT0075CA-REPAY-SCHED
SC1740           END-IF
ST0170           IF BOIS-OFFSET-ACCT-IND = "2"
ST0170              MOVE BOIS-SORD-AUTO-DBT-ACCT-NO TO INVM-MEMB-CUST-AC
ST0170              PERFORM B1000-READ-INVM    THRU B1999-EXIT
ST0170              IF DBIO-CALL-STATUS = "****"
ST0170*** READ DEPP TABLE (KEY=INVM-ACCT-TYPE + INVM-INT-CAT)
ST0170                 MOVE INVM-SOC-NO    TO UT0200-CALL-SOC-NO
ST0170                 MOVE INVM-ACCT-TYPE TO UT0200-CALL-ACCT-TYPE-A
ST0170                 MOVE INVM-INT-CAT   TO UT0200-CALL-INT-CAT-A
ST0170                 MOVE 0              TO UT0200-CALL-INDEX
ST0170                                        UT0200-CALL-STATUS
ST0170                 MOVE 02             TO UT0200-CALL-CODE
ST0170                 CALL "UT0200"    USING UT0200-CALL-AREA
ST0170                 IF   UT0200-CALL-STATUS NOT = 0
ST0170                      DISPLAY "BR0000: (H000) ERROR IN READ DEPP"
ST0170                      ", KEY =" INVM-ACCT-TYPE " - " INVM-INT-CAT
ST0170                      ", STATUS =" UT0200-CALL-STATUS
ST0170                      MOVE 1   TO WA-MSG-ERR-FLAG
ST0170                      MOVE 108 TO WA-OUTPUT-ERR-MSG-NO
ST0170                      GO       TO H099-EXIT
ST0170                 END-IF
ST0170                 IF  INVM-CURR-BAL < ACCT-PARM-MIN-BAL
ST0170                 AND INVM-CURR-BAL > 0
ST0170                     COMPUTE UT0075CA-DEP-INT-INCR =
ST0170                             INVM-CURR-BAL *
ST0170                             INVM-CR-STORE-RATE /
ST0170                             100 /
ST0170                             ACCT-PARM-CR-INT-DAYS-YR
ST0170                 ELSE
ST0170                     MOVE INVM-INT-INCR  TO UT0075CA-DEP-INT-INCR
ST0170                 END-IF
ST0170*** CHECK CURR-BAL < ACCT-PARM-MIN-BAL RE-CALCULATE DEP-INT-INCR
ST0170*                IF STAT
ST0170                 MOVE INVM-CURR-BAL TO UT0075CA-DEP-CURR-AMT
ST0170*                MOVE INVM-INT-INCR TO UT0075CA-DEP-INT-INCR
ST0170                 MOVE INVM-CR-STORE-RATE TO UT0075CA-DEP-INT-RATE
ST0170*                END-IF
ST0170              ELSE
ST0170                 DISPLAY "BR0000: (H000) ERROR IN READING INVM"
ST0170                         ", KEY = " DBIO-CALL-KEY-AREA
ST0170                         ", STATUS = " DBIO-CALL-STATUS
ST0170                 MOVE 1   TO WA-MSG-ERR-FLAG
ST0170                 MOVE 108 TO WA-OUTPUT-ERR-MSG-NO
ST0170                 GO TO H099-EXIT
ST0170              END-IF
ST0170           END-IF
SC2285           IF (STRT-AREA-TRN-NO NOT =  13031 AND 11044 AND 11048
SC5059                                  AND  17033
SC2285                                  AND  13131 AND 11144 AND 11148
SC2285                                  AND  16044 AND 16144 AND 16048
S11009                                  AND  17026
S11617                                  AND  16129
S17282                                  AND  16102
SC2285                                  AND  16148 )
SC1864           IF BORM-REPAY-SCHED = "G"
SC1864              MOVE BORM-LOAN-REPAY  TO UT0075CA-CALC-EQUAL-PRIN
SC1864           END-IF
SC2285           END-IF
SC1794           IF BORM-REPAY-SCHED = "K"
SC8758* NEED TO DISCUSS THIS WITH USER; IT MEETS USER EXPECTATION.
SC8758* BUT EXPECTATION SEEMS TO BE WRONG.
SC8758              IF BOIS-PREV-DUE-DATE NOT = 0
SC8758                 MOVE BOIS-PREV-DUE-DATE TO UT0075CA-SYS-DATE
SC8758                                            UT0075CA-EFF-DATE
SC8758              ELSE
SC8758                 MOVE BORM-DUE-STRT-DATE TO UT0075CA-SYS-DATE
SC8758                                        UT0075CA-EFF-DATE
SC8758              END-IF
SC1794              IF WA-RECALC-IND = 1
SC1794                 MOVE BORM-LOAN-BAL    TO UT0075CA-REMAIN-BAL
SC1794                 MOVE BORM-REM-REPAYS  TO UT0075CA-REMAIN-TERM
SC1794              ELSE
SC1794                 MOVE 0                TO UT0075CA-REMAIN-BAL
SC1794                 MOVE BORM-DUE-AMT     TO
SC1794                                    UT0075CA-CALC-EQUAL-REPAY
SC1794              END-IF
SC1794           END-IF
SC6427           IF STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048
SC6427                               OR 13131 OR 11144 OR 11148
SC6427              MOVE 0    TO  WS-SAVE-BORM-STAT
SC6427              IF BORM-STAT = 08
SC6427                 MOVE BORM-STAT TO WS-SAVE-BORM-STAT
SC6427                 MOVE 07     TO BORM-STAT
SC6427              END-IF
SC6427           END-IF
SC7548           IF BORM-REM-REPAYS = 0  
SC7548           AND BORM-1-ADDL-BILLING  
SC7548           AND BOIS-PREV-DUE-DATE < BOIS-MATURITY-DATE  
SC7548              SET WA-RESTORE-REPAY TO TRUE  
SC7548              MOVE 1 TO BORM-REM-REPAYS  
SC7548           END-IF  
SC1740           CALL "UT0075" USING UT0075CA-CALL-AREA
SC1740                               BORM-RECORD-AREA
SC1740                               BOIS-RECORD
SC1740                               BORR-PARAMS
SC1740                               SOC-PARAMS
SC1740           IF UT0075CA-RET-STATUS <> ZEROS
SC1740               MOVE UT0075CA-RET-ERROR-MSG TO
SC1740                     WA-OUTPUT-ERR-MSG-NO
SC1740               MOVE 1 TO WA-MSG-ERR-FLAG
SC1740               GO TO H099-EXIT
SC1740           END-IF
S16271           IF  STRT-AREA-TRN-NO = 17046
S16271               COMPUTE UT0075CA-INTEREST-INCR ROUNDED
S16271                                    = (BORM-LOAN-BAL
S16271                                    * (WA-INT-RATE-A / 100))
S16271                                    / BORP-INT-DAYS-YR
S16271           END-IF
SC7548           IF WA-RESTORE-REPAY  
SC7548              MOVE 0 TO BORM-REM-REPAYS  
SC7548           END-IF  
SC6427           IF STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048
SC6427                               OR 13131 OR 11144 OR 11148
SC6427              IF WS-SAVE-BORM-STAT  = 08
SC6427                 MOVE WS-SAVE-BORM-STAT TO BORM-STAT
SC6427              END-IF
SC6427           END-IF
SC1740           IF STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048
SC3189                              OR 13131 OR 11144 OR 11148
SC5300                                       OR 16044 OR 16048
SC5300                                       OR 16144 OR 16148
S11617                                       OR 16129
S17282                                       OR 16102
SC2374             MOVE UT0075CA-INTEREST-INCR TO BORM-INT-INCR
SC1740             IF (WA-REPAY-PRIN-RECALC <> "1" AND
SC1740                 BORM-REPAY-SCHED =  "B")
SC1740             OR (WA-REPAY-PRIN-RECALC <> "0" AND "1" AND
SC1740                 BORM-REPAY-SCHED <> "B")
SC1740             MOVE UT0075CA-REPAY-AMT     TO BORM-DUE-AMT
ST0170             IF BOIS-OFFSET-ACCT-IND <> "2"
SC1740                COMPUTE BORM-LOAN-REPAY = UT0075CA-REPAY-AMT
SC1740                                     - UT0075CA-INTEREST-DUE
S18597                IF BORM-LOAN-REPAY < 0
S18597                   MOVE 0 TO BORM-LOAN-REPAY
S18597                END-IF
ST0170             ELSE
ST0170                MOVE ZERO TO BORM-LOAN-REPAY
ST0170             END-IF
SC2374**           MOVE UT0075CA-INTEREST-INCR TO
SC2374**                                  BORM-INT-INCR
SC1740**SC1605     MOVE UT0075CA-NEXT-DUE-DATE TO
SC1740**SC1605                            BOIS-NEXT-DUE-DATE
SC1740**SC1605                            BOIS-LAST-UNPAID-DUE-DATE
SC1740             END-IF
SC2144             IF BORM-REPAY-SCHED = "F" AND
SC2144                         WA-REPAY-PRIN-RECALC = "0"
ST0170                IF BOIS-OFFSET-ACCT-IND <> "2"
SC2144                   COMPUTE BORM-LOAN-REPAY = BORM-DUE-AMT
SC2144                                  - UT0075CA-INTEREST-DUE
ST0170                ELSE
ST0170                   MOVE ZERO   TO BORM-LOAN-REPAY
ST0170                END-IF
SC2374**              MOVE UT0075CA-INTEREST-INCR TO
SC2374**                                  BORM-INT-INCR
SC2144             END-IF
SC2406             IF BORM-REPAY-SCHED = "F" AND
SC2406                         WA-REPAY-PRIN-RECALC = "1"
ST0170                IF BOIS-OFFSET-ACCT-IND <> "2"
SC2406                   COMPUTE BORM-LOAN-REPAY = BORM-DUE-AMT
SC2406                                  - UT0075CA-INTEREST-DUE
ST0170                ELSE
ST0170                   MOVE ZERO   TO BORM-LOAN-REPAY
ST0170                END-IF
SC2406                MOVE UT0075CA-INTEREST-INCR TO
SC2406                                    BORM-INT-INCR
SC2406             END-IF
SC8336             IF (BORM-REPAY-SCHED = "F") AND
SC8336                (WA-REPAY-PRIN-RECALC = "0" OR "1") AND
SC8336                (BORM-LOAN-BAL NOT > BORM-LOAN-REPAY)
SC8336                 MOVE BORM-LOAN-BAL TO BORM-LOAN-REPAY
SC8336                 COMPUTE BORM-DUE-AMT =
SC8336                         BORM-LOAN-BAL + UT0075CA-INTEREST-DUE
SC8336             END-IF
SC1740           ELSE
SC1681             IF BORM-REPAY-SCHED NOT =  "F"
SC3158              OR (BORM-REPAY-SCHED =  "F"
SC3158              AND ((BOIS-GRACE-PERIOD = 0
SC3158              AND WA-PREV-BOIS-GRACE-PERIOD > 0)
SC3158              OR BOIS-GRACE-PERIOD > 0)
SC3158              AND WA-INPUT-PARAM-TABLE (4) = 1)
SC6967              OR (BORM-REPAY-SCHED = "F"
SC6967              AND BORM-REM-REPAYS = 1)
SC8046              OR (BORM-REPAY-SCHED = 'F'
SC8046              AND WA-INPUT-PARAM-TABLE (7) = 1
SC8046              AND WA-SV-REM-REPAYS = 1)
SC9797              OR STRT-AREA-TRN-NO = 17046
SC9859              OR (STRT-BATCH-TXN AND
SC9859                  BORP-CONSMR-MORT-COMBI AND
SC9859                  BOIS-OD-ACCT-NUMBER <> 0 AND
SC9859                  BORM-REPAY-SCHED = "F" AND
SC9859                  BOIS-NO-OF-RENEWAL > 0 AND
SC9859                  BORM-DUES-RECALC-IND = 0)
CS8758                IF BORM-REPAY-SCHED NOT = "K"
CS8768                 OR (BORM-REPAY-SCHED = "K"  
CS8758                 AND WA-RECALC-IND = 1)      
S17341*S17250         IF UT0075CA-REPAY-AMT NOT = BORM-DUE-AMT
S17341*S17250            MOVE 0                   TO BOIS-MISC-INC-DUE
S17341*S17250         END-IF
SC1681                MOVE UT0075CA-REPAY-AMT     TO BORM-DUE-AMT
S17250*S17064         MOVE 0                      TO BOIS-MISC-INC-DUE
CS8758                END-IF
SC1681             END-IF
SC4472* -- RECALC DUE-AMT WHEN PRIN DEFERRED EXPIRED (INCLUDE CORR)
SC4472             IF  BOIS-AGREE-IND           = 1
SC4472             AND BORM-REPAY-SCHED         = 'F'
SC4472             AND WA-INPUT-PARAM-TABLE (4) = 1
SC4472              IF WA-INPUT-PARAM-TABLE (7) = 0
SC4472              AND UT0075CA-NEXT-DUE-DATE  > BOIS-DEF-PRIN-END-DTE
SC4472              AND BORM-LOAN-REPAY         = 0
SC4472                MOVE UT0075CA-REPAY-AMT   TO BORM-DUE-AMT
SC4472              END-IF
SC4472              IF WA-INPUT-PARAM-TABLE (7) = 1
SC4472              AND UT0075CA-NEXT-DUE-DATE  = BOIS-DEF-PRIN-END-DTE
SC4472                MOVE UT0075CA-REPAY-AMT   TO BORM-DUE-AMT
SC4472              END-IF
SC4472             END-IF
SC3865             IF STRT-AREA-TRN-NO = 17026                      
SC4091**SC5059                        OR 17467
SC5059                                OR 17467 OR 17033
S16064               IF BORM-DUES-RECALC-IND = 1 OR 4
S16064*SC3865               IF BORM-DUES-RECALC-IND = 1
SC4091**SC5059        OR STRT-AREA-TRN-NO = 17467
SC5059                OR STRT-AREA-TRN-NO = 17467 OR 17033
SC3865                  COMPUTE BORM-LOAN-REPAY = UT0075CA-REPAY-AMT
SC3865                                       - UT0075CA-INTEREST-DUE
S17250                  IF UT0075CA-REPAY-AMT NOT = BORM-DUE-AMT
S17250                     MOVE 0               TO BOIS-MISC-INC-DUE
S17250                  END-IF
SC4091                  MOVE UT0075CA-REPAY-AMT TO BORM-DUE-AMT
S17250*S17064           MOVE 0                  TO BOIS-MISC-INC-DUE
SC3865               END-IF                                         
SC3865             ELSE                                             
ST0170               IF BOIS-OFFSET-ACCT-IND <> '2'
SC1740                  COMPUTE BORM-LOAN-REPAY = UT0075CA-REPAY-AMT
SC1740                                       - UT0075CA-INTEREST-DUE
ST0170               ELSE
ST0170                  MOVE 0                 TO BORM-LOAN-REPAY
ST0170               END-IF
SC3865             END-IF
SC1740             MOVE UT0075CA-INTEREST-INCR TO
SC1740                                    BORM-INT-INCR
SC1740*** SC2076   MOVE UT0075CA-NEXT-DUE-DATE TO
SC1740*** SC2076                          BOIS-NEXT-DUE-DATE
SC1740*** SC2076                          BOIS-LAST-UNPAID-DUE-DATE
SC1740           END-IF
SC8711           IF BORM-LOAN-BAL <= 0
SC8711              MOVE 0      TO               BORM-INT-INCR
SC1740*SC8458                                    BORM-BPI-INCR
SC1740*SC8458                                    BORM-CI-INCR
SC1740*SC8458                                    BORM-INT-ACCR
SC1740*SC8458                                    BORM-BPI-ACCR
SC1740*SC8458                                    BORM-CI-ACCR
SC8711           END-IF
SC1740           GO TO H099-EXIT
SC4127        ELSE
SC4127           IF STRT-AREA-TRN-NO = 17467
SC4127              GO TO H099-EXIT
SC4127           END-IF
SC1740        END-IF
SC1740      END-IF
SC9003      IF NOT BORP-YOUBE  
SC8939         GO TO H099-EXIT 
SC9003      END-IF             
SC1740     END-IF.
SC1740
114790     IF BORM-LOAN-BAL <= 0
114800        MOVE 0                   TO        BORM-INT-INCR
114810                                           BORM-BPI-INCR
114820                                           BORM-CI-INCR
114830                                           BORM-INT-ACCR
114840                                           BORM-BPI-ACCR
114850                                           BORM-CI-ACCR
114860        GO TO H099-EXIT.
TP0026*  INT CALC NOT REQUIRED FOR WA-CUST-INC-EXP-FEES
TP0026     IF WA-CUST-INC-EXP-FEES
TP0026        GO TO H099-EXIT.
114870     IF  BORP-ACCRUE-METHOD = "6"
114880         PERFORM H100-INT-ON-ADVANCE THRU H199-EXIT
114890         GO TO H099-EXIT.
114900     PERFORM X710-GET-RATE THRU X719-EXIT.
114910     IF WA-MSG-ERR-FLAG = 1
114920        GO TO H099-EXIT.
114930*
114940     MOVE 0             TO WA-MARG-INT-ACCR-BEFORE
114950                           WA-MARG-INT-ACCR-AFTER
114960                           WA-BASE-INT-ACCR-BEFORE
114970                           WA-BASE-INT-ACCR-AFTER.
114980*
114990     IF  WA-INPUT-PARAM-TABLE(8) = 1
TB0235*NR0017IF BORV-34-POST-DATE < WA-DMY
NR2001*NR0017       IF BORV-34-TRN-DATE < WA-DMY
NR2001       IF BOCT-TRN-DATE < WA-DMY
TB0235          COMPUTE WA-YOUBE-BKDT-DAYS = WA-DMY -
TB0235*NR0017                                BORV-34-POST-DATE
NR2001*NR0017                                       BORV-34-TRN-DATE
NR2001                                       BOCT-TRN-DATE
TB0235          IF WA-YOUBE-BKDT-DAYS > WA-YOUBE-ALLOW-BKDT-DAYS
TB0235             GO TO H099-EXIT
TB0235          END-IF
TB0235*NR0017   IF BORV-34-POST-DATE < BOIS-PREV-DUE-DATE
NR2001*NR0017          IF BORV-34-TRN-DATE < BOIS-PREV-DUE-DATE
NR2001          IF BOCT-TRN-DATE < BOIS-PREV-DUE-DATE
tb0235             GO TO H099-EXIT
TB0235          END-IF
TB0235       END-IF  
115000       IF SOC-LIMIT-PROCESS-IND = "1"
115010         COMPUTE WA-BASE-INT-ACCR-BEFORE =
115020                 BORM-INT-ACCR           +
115030                 BLDV-FC-LI-ADJ-ACCR     +                                
115040                 BORM-BPI-ACCR           +
115050                 BLDV-FC-BPI-ADJ-ACCR    +                                
115060                 BORM-CHR-VAL(2)
115070       ELSE
115080         COMPUTE WA-BASE-INT-ACCR-BEFORE =
115090                 BORM-INT-ACCR           +
115100                 BLDV-FC-LI-ADJ-ACCR     +                                
115110                 BORM-BPI-ACCR           +
115120                 BLDV-FC-BPI-ADJ-ACCR                                     
115130       END-IF
115140       COMPUTE WA-MARG-INT-ACCR-BEFORE =
115150                 BORM-CI-ACCR +
115160                 BLDV-FC-CI-ADJ-ACCR.                                     
115170*
S11476     SET  UT0069CA-TIER-CALC-YES TO        TRUE.
115180     MOVE 02                     TO        UT0069CA-CALL-CODE.
115190     MOVE 0                      TO        UT0069CA-RET-STATUS.
115200     MOVE 0                      TO        UT0069CA-FUN-CODE.
115210     MOVE BORM-SOC-NO            TO        UT0069CA-SOC-NO.
115220     MOVE BORM-MEMB-CUST-AC      TO        UT0069CA-ACCT-NO.
115230     MOVE BORM-ACT-TYPE          TO        UT0069CA-ACCT-TYPE.
115240     MOVE BORM-CAT               TO        UT0069CA-INT-CAT.
115250     MOVE BORM-STAT              TO        UT0069CA-LOAN-STATUS.
115260     MOVE BORM-BORR-TYPE         TO        UT0069CA-BORR-TYPE.
115270     MOVE BORM-PAY-DAY           TO        UT0069CA-PAY-DAY.
115280     MOVE BORM-CAPN-METHOD       TO        UT0069CA-INT-METHOD.
115290     MOVE 0                      TO        UT0069CA-RT-INCR.
115300     MOVE WA-INT-RATE-A          TO        UT0069CA-LI-RATE.
115310     MOVE WA-INT-DATE-A          TO        UT0069CA-LI-EFF-DATE.
115320     MOVE BORP-COMM-INT          TO        UT0069CA-CI-RATE.
115330     MOVE 0                      TO        UT0069CA-LOAN-BAL.
115340     IF  BORP-ACCRUE-METHOD = "1"
115350         COMPUTE UT0069CA-LOAN-BAL = BORM-ADV-VAL
115360                                   - BORM-PRINC-REDUCT-EFF
115370     ELSE
115380     IF  BORP-ACCRUE-METHOD = "2"
115390         COMPUTE UT0069CA-LOAN-BAL = BORM-EOM-BASIC-BAL
115400                                   - BORM-PRINC-REDUCT-EFF
115410     ELSE
115420     IF  BORP-ACCRUE-METHOD = "3"
115430         COMPUTE UT0069CA-LOAN-BAL = BORM-EOY-BASIC-BAL
115440                                   - BORM-PRINC-REDUCT-EFF
115450     ELSE
115460     IF  BORP-ACCRUE-METHOD = "4"
115470         COMPUTE UT0069CA-LOAN-BAL = BORM-LOAN-BAL
115480                                   - BORM-UNCL-NO-INT-VAL.
115490** if cofm acct and backdating
115500     IF BORP-COFM-METH = "Y"
115510     AND UT0069CA-CALL-CODE = 2
NR2001*115520     AND BORV-01-TRN-DATE NOT = STRT-AREA-POST-DT
NR2001     AND BOCT-TRN-DATE NOT = STRT-AREA-POST-DT
115530         PERFORM Z700-GET-ARR-VALS THRU Z799-EXIT
115540         MOVE ARRS-TOM-ARR-INT-INCR TO UT0069CA-TOM-ARR-INCR
115550         MOVE ARRS-TOM-ARR-INT-ACCR TO UT0069CA-TOM-ARR-ACRU
115560     ELSE
115570         MOVE 0                     TO UT0069CA-TOM-ARR-INCR
115580                                       UT0069CA-TOM-ARR-ACRU
115590     END-IF.
115610     COMPUTE UT0069CA-THEO-LOAN-BAL = BORM-THEO-LOAN-BAL
115620                                    - BORM-UNCL-NO-INT-VAL.
115630     MOVE 0 TO UT0069CA-DEBIT-ARREAR-FLAG.
115650     ADD  BORM-APP-AMT
115660          BORM-ADD-LOAN-APP      GIVING    UT0069CA-APP-AMT.
115670     ADD  BORM-ADV-VAL
115680          BORM-ADD-LOAN-ADV      GIVING    UT0069CA-ADV-AMT.
115690     MOVE BORM-PRINC-REDUCT-EFF  TO        UT0069CA-PRINC-REDUCT.
115700     MOVE BORM-LST-FIN-DATE      TO        UT0069CA-LST-FIN-DT.
115710     MOVE BORM-APPRV-DATE        TO        UT0069CA-APPRV-DT.
115720     MOVE BORM-ADV-DATE          TO        UT0069CA-ADV-DT.
115730     MOVE BORM-DUE-STRT-DATE     TO        UT0069CA-DUE-STRT-DATE.
115740     MOVE BORM-INT-START-DATE    TO        UT0069CA-INT-START-DT.  
NR2001*115750     MOVE BORM-LAST-BORV-46-DATE TO     UT0069CA-LAST-BORV46-DATE.
NR2001*115760     MOVE BORV-RECORD-AREA       TO        UT0069CA-TRANSACTION.
NR2001     MOVE BORM-LAST-BORV-46-DATE TO     UT0069CA-LAST-BOCT46-DATE.
NR2001     MOVE BOCT-RECORD-AREA       TO        UT0069CA-TRANSACTION.
115770     IF SOC-LIMIT-PROCESS-IND = "1"
115780*NBG003
115790*       IF BORM-IR-IND = 1
115800          PERFORM X2000-READ-BIRM
115810          IF WA-MSG-ERR-FLAG = 1
115820             GO TO H099-EXIT
115830          END-IF
115840          MOVE BIRM-IR-INT-CHARGED
115850*         MOVE BORM-IR-INT-CHARGED
115860                                 TO UT0069CA-PREPAY-DISCOUNT-RATE
115870*       END-IF
115880     ELSE
115890          MOVE 0                 TO UT0069CA-PREPAY-DISCOUNT-RATE.
115900     MOVE 1                      TO UT0069CA-NO-INCR-DAYS.                
115910     MOVE BORM-INT-ACCR          TO UT0069CA-LI-ACCR.                     
115920     MOVE BORM-BPI-ACCR          TO UT0069CA-BPI-ACCR.                    
115930     MOVE BORM-CI-ACCR           TO UT0069CA-CI-ACCR.                     
115940     MOVE BORM-ARR-INT-ACCR      TO UT0069CA-ARR-ACCR.                    
115950     MOVE ZEROS                  TO UT0069CA-ARR-CALC-BASE.               
115960     MOVE BORM-TOM-ACRU-AMT      TO UT0069CA-TOM-ACRU.                    
115970     IF BORM-TOM-RATE-TBL-ID     = SPACES                                 
115980          MOVE BORP-TOM-RATE-TBL-ID                                       
115990                                 TO UT0069CA-TOM-RATE-TBL-ID              
116000     ELSE                                                                 
116010          MOVE BORM-TOM-RATE-TBL-ID                                       
116020                                 TO UT0069CA-TOM-RATE-TBL-ID              
116030     END-IF.                                                              
116040     MOVE BORM-INT-ADJUSTMENT                                             
116050                                 TO UT0069CA-INT-ADJ-AMT.                 
116060     MOVE BORM-FCC-CLUS          TO UT0069CA-FCC-CLUS.                    
116070     MOVE BLDV-FC-NOM-CURR       TO UT0069CA-FCC-NOM-CURR.                
116080     IF BLDV-FC-DATE-LAST-CAP = 0                                        
116090         MOVE BORM-APPRV-DATE TO UT0069CA-FCC-SOP-DATE                   
116100     ELSE                                                                
116110         MOVE BLDV-FC-DATE-LAST-CAP  TO UT0069CA-FCC-SOP-DATE            
116120     END-IF.                                                             
S11476     IF BORP-YOUBE                                       
S11476        PERFORM Z200-GET-GRACE-DAYS THRU Z209-EXIT       
S11476        IF  ((WA-GRACE-DAYS > BORP-ARREARS-GRACE-PRD) AND
S11476             (BOIS-NEXT-DUE-DATE < STRT-AREA-POST-DT) AND
S11476             (BOIS-NEXT-DUE-DATE > 0))                   
S11476        OR  (WA-BAD-DEBT-IND-2 > 1)                      
S11476        OR  ((BOIS-RATE-EXP-DATE > STRT-AREA-POST-DT) AND
S11476             (BOIS-PREF-INT-PERIOD > 0))                 
S11476        OR  BOIS-ARREAR-FLAG = 'Y'                       
S11476            SET UT0069CA-TIER-CALC-NO    TO TRUE         
S11476        END-IF                                           
S11476     END-IF.                                             
116130                                                                         
116140     CALL "UT0069"               USING
116160                                           UT0069-LINKAGE.
116170     IF UT0069CA-RET-STATUS NOT = 0
116180         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
116190         MOVE SPACES TO UT8500CA-INPUT-MSG
116200         STRING "BR0000:(H000) INTEREST NOT CALCULATED FOR CT "
116210                 BORM-KEY
116220             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
116230         CALL "UT8500" USING
116250                             UT8500CA-AREA
116260         GO TO H099-EXIT.
116280     MOVE UT0069CA-LI-INCR       TO        BORM-INT-INCR.
116290     MOVE UT0069CA-BPI-INCR      TO        BORM-BPI-INCR.
116300     MOVE UT0069CA-CI-INCR       TO        BORM-CI-INCR.
116310     IF UT0069CA-FUN-CODE = 1
116320         GO TO H099-EXIT
116330     ELSE
116340     IF UT0069CA-FUN-CODE = 2
116350         MOVE UT0069CA-LI-ACCR   TO        BORM-INT-ACCR
116360         MOVE UT0069CA-BPI-ACCR  TO        BORM-BPI-ACCR
116370         MOVE UT0069CA-CI-ACCR   TO        BORM-CI-ACCR
116380         IF BORP-COFM-METH = "Y"
116390            MOVE UT0069CA-TOM-ACRU      TO BORM-TOM-ACRU-AMT
116400            IF UT0069CA-DEBIT-ARREAR
116410               MOVE UT0069CA-ARR-INCR     TO BORM-ARR-INT-INCR
116420               MOVE UT0069CA-ARR-ACCR     TO BORM-ARR-INT-ACCR
116430               MOVE UT0069CA-TOM-ARR-ACRU TO ARRS-TOM-ARR-INT-ACCR
116440               MOVE UT0069CA-TOM-ARR-INCR TO ARRS-TOM-ARR-INT-INCR
116450               PERFORM Z800-WRITE-ARRS   THRU Z899-EXIT
116460            END-IF
116470         END-IF
116480     ELSE
116490     IF UT0069CA-FUN-CODE = 3
116500         ADD UT0069CA-LI-ACCR    TO        BORM-INT-ACCR
116510         ADD UT0069CA-BPI-ACCR   TO        BORM-BPI-ACCR
116520         ADD UT0069CA-CI-ACCR    TO        BORM-CI-ACCR
116530     ELSE
116540     MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
116550     MOVE SPACES TO UT8500CA-INPUT-MSG
116560     STRING "BR0000:(H000) INVALID FUN CODE FORM UT0069 "
116570         UT0069CA-FUN-CODE
116580         " KEY " BORM-KEY
116590         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
116600     CALL "UT8500" USING
116620                         UT8500CA-AREA
116630     GO TO H099-EXIT.
116640*---------------------------------------------------------
116650*
116660     IF BORP-VAR-RT-HIST-IND = 1
NR2001*116670        AND   BORV-01-CODE   = 1
NR2001        AND   BOCT-TRAN-TYPE   = 1
116680        INITIALIZE                 UT0909CA-AREA
116690        MOVE  "L"                  TO UT0909CA-MODULE-TYPE
116700        MOVE  BORM-SOC-NO          TO UT0909CA-INST-NO
116710        MOVE  BORM-MEMB-CUST-AC    TO UT0909CA-MEMB-CUST-AC
116720        MOVE  BORM-ACT-TYPE        TO UT0909CA-ACCT-TYPE
116730        MOVE  BORM-CAT             TO UT0909CA-INT-CATEGORY
NR2001*116740        MOVE  BORV-01-TRN-DATE     TO UT0909CA-TRN-DATE
NR2001        MOVE  BOCT-TRN-DATE        TO UT0909CA-TRN-DATE
116750        MOVE  0                    TO UT0909CA-POST-DATE
116760        MOVE  0                    TO UT0909CA-POST-TIME
NR2001*116770        MOVE  BORV-01-AMOUNT       TO UT0909CA-AMOUNT
NR2001*116780        MOVE  BORV-01-BALANCE      TO UT0909CA-BALANCE
NR2001        MOVE  BOCT-01-AMOUNT       TO UT0909CA-AMOUNT
NR2001        MOVE  BOCT-01-BALANCE      TO UT0909CA-BALANCE
116800        IF BORM-RT-INCR         = 0
116810           MOVE 0                  TO UT0909CA-RATE
116820           IF UT0069CA-LI-INCR NOT = ZEROES
116830              MOVE UT0069CA-LI-INCR TO UT0909CA-VAR-DR-INT-INCR
116840           ELSE
116850              IF UT0069CA-BPI-INCR NOT = ZEROES
116860                 MOVE UT0069CA-BPI-INCR
116870                                      TO UT0909CA-VAR-DR-INT-INCR
116880              ELSE
116890                 MOVE UT0069CA-CI-INCR TO UT0909CA-VAR-DR-INT-INCR
116900        ELSE
116910           MOVE BORM-RT-INCR       TO  UT0909CA-RATE
116920           IF UT0069CA-LI-INCR NOT = ZEROES
116930              MOVE UT0069CA-LI-INCR TO UT0909CA-AC-DR-INT-INCR
116940           ELSE
116950              IF UT0069CA-BPI-INCR NOT = ZEROES
116960                 MOVE UT0069CA-BPI-INCR TO UT0909CA-AC-DR-INT-INCR
116970              ELSE
116980                 MOVE UT0069CA-CI-INCR TO UT0909CA-AC-DR-INT-INCR
116990              END-IF
117000           END-IF
117010        END-IF
117030        CALL  "UT0909"  USING UT0909CA-AREA UT0069-LINKAGE
117050        IF UT0909CA-DB-STATUS   NOT = "****"
117060              OR    UT0909CA-ERROR           = 1
117070           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
117080           MOVE SPACES TO UT8500CA-INPUT-MSG
117090           STRING "BR0000:(H000) CALCULATE (CLAWBACK) .ERROR..  "
117100                BORM-KEY
117110           DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
117120           CALL "UT8500" USING
117140                             UT8500CA-AREA
117150           MOVE  1    TO  WA-MSG-ERR-FLAG
117160           MOVE  1255 TO  WA-OUTPUT-ERR-MSG-NO.
117170*
117180*---------------------------------------------------------
117190*
117200     IF  WA-INPUT-PARAM-TABLE(8) = 1
117210       IF SOC-LIMIT-PROCESS-IND = "1"
117220         COMPUTE WA-BASE-INT-ACCR-AFTER  =
117230                 BORM-INT-ACCR           +
117240                 BLDV-FC-LI-ADJ-ACCR     +                                
117250                 BORM-BPI-ACCR           +
117260                 BLDV-FC-BPI-ADJ-ACCR    +                                
117270                 BORM-CHR-VAL(2)
117280       ELSE
117290         COMPUTE WA-BASE-INT-ACCR-AFTER  =
117300                 BORM-INT-ACCR           +
117310                 BLDV-FC-LI-ADJ-ACCR     +                                
117320                 BORM-BPI-ACCR           +
117330                 BLDV-FC-BPI-ADJ-ACCR                                     
117340       END-IF
117350       COMPUTE WA-MARG-INT-ACCR-AFTER  =
117360                 BORM-CI-ACCR            +
117370                 BLDV-FC-CI-ADJ-ACCR.                                     
117380*
117390*
117400 H099-EXIT.
117410     EXIT.
117420/
SC8330 H010A-GET-RATE.
           IF  SOC-SITE-TIB
             IF BORM-INT-RATE = 0
             AND (BOIS-NEGO-RATE-IND = "0"
                OR  (BOIS-NEGO-RATE-IND = "2"
                     AND BOIS-NEGO-RATE-FLAG = "2"))
               IF  (BOIS-EFR-CHNG-IND = "1")
               AND (BOIS-NEXT-DUE-DATE <> STRT-AREA-POST-DT)
                  MOVE BORM-STORE-RATE TO WA-INT-RATE-A
               ELSE
                  MOVE 0                  TO WA-TIER-LEVEL
                  MOVE BORM-LOAN-BAL      TO WA-REM-BAL
                  IF BORP-BASM-BASE-ID = SPACES
                  OR BORP-BASM-RATE-ID = SPACES
                     MOVE 0              TO WA-INT-RATE-A
                  ELSE
                     PERFORM E290-SEARCH-RATE-TABLE THRU E299A-EXIT
                     ADD BORM-RT-INCR    TO WA-INT-RATE-A
                  END-IF
               END-IF
             ELSE
               MOVE BORM-INT-RATE      TO WA-INT-RATE-A
               ADD BORM-RT-INCR    TO WA-INT-RATE-A
             END-IF
           ELSE
           IF BORM-INT-RATE = 0
               MOVE 0                  TO WA-TIER-LEVEL
               MOVE BORM-LOAN-BAL      TO WA-REM-BAL
               IF BORP-BASM-BASE-ID = SPACES
               OR BORP-BASM-RATE-ID = SPACES
                   MOVE 0              TO WA-INT-RATE-A
               ELSE
                   PERFORM E290-SEARCH-RATE-TABLE THRU E299A-EXIT
                   ADD BORM-RT-INCR TO WA-INT-RATE-A
           ELSE
               MOVE BORM-INT-RATE      TO WA-INT-RATE-A
               ADD BORM-RT-INCR TO WA-INT-RATE-A.
SC8330 H019A-EXIT.
SC8330     EXIT.
117430 H100-INT-ON-ADVANCE.
117440*
117450* INTEREST IS CALCULATED ON THE AMOUNT ADVANCED, REGARDLESS OF
117460* THE CURRENT BALANCE.  AS WE DO NOT ALLOW PARTIAL ADVANCES AT PRE    
117470* WE ONLY NEED TO CALCULATE IT ON THE FIRST ADVANCE TXN
117480*
117490      IF  WA-INPUT-PARAM-TABLE (7) = 1
117500          MOVE ZERO           TO BORM-INT-INCR
117510                                 BORM-INT-ACCR
117520          GO TO H199-EXIT.
117530      IF  WA-INPUT-PARAM-TABLE (5) NOT = 1
117540          GO TO H199-EXIT.
117550      IF  BORM-INT-INCR > 0
117560          GO TO H199-EXIT.
117580     MOVE 06                  TO UT4001CA-CALL-CODE
117590     MOVE BORM-REPAY-COUNT    TO UT4001CA-02-DRAWDOWN-NO
117600     MOVE BORM-MEMB-CUST-AC   TO UT4001CA-02-ACCT
117610     MOVE BORM-CUSTOMER-NO    TO UT4001CA-02-CUST-NO
117620     MOVE BORM-SOC-NO         TO UT4001CA-02-INST-NO
117630     MOVE "LON"               TO UT4001CA-02-SYS
117640     CALL "UT4001"   USING       SOC-PARAMS
117650                                 STARTAREA
117660                                 BORR-PARAMS
117670*                                DEPP-RECORD-AREA
SC0367                                 ACCT-PARM
117680                                 UT4001CA-CALL-AREA.
117690     IF UT4001RA-RET-STATUS NOT = "****"
117700        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
117710                              TO UT8500CA-CALL-CODE
117720        MOVE SPACES TO UT8500CA-INPUT-MSG
117730        STRING "BR0000:(H100) BAD STATUS FROM UT4001 STATUS = "
117740              UT4001RA-RET-STATUS "  /  " BORM-KEY
117750              DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
117760        CALL "UT8500" USING    UT8500CA-AREA
117770        MOVE 1                TO WA-MSG-ERR-FLAG
117780        MOVE 1887             TO WA-OUTPUT-ERR-MSG-NO
117790        GO TO H199-EXIT.
117810      SUBTRACT BORM-ADV-DATE FROM UT4001RA-06-HIGHEST-DUE-DATE
117820                               GIVING WA-30DL-FACTOR.
117830      IF  UT4001RA-06-PAID-DT-B4-TODAY = ZERO
117840          SUBTRACT BORM-ADV-DATE FROM STRT-AREA-POST-DT
117850                               GIVING WA-30DL-NO-DAYS
117860      ELSE
117870          SUBTRACT UT4001RA-06-PAID-DT-B4-TODAY
117880                               FROM STRT-AREA-POST-DT
117890                               GIVING WA-30DL-NO-DAYS.
117900      IF  WA-30DL-NO-DAYS < 0
117910          MOVE 0 TO WA-30DL-NO-DAYS.
117920      COMPUTE  BORM-INT-INCR ROUNDED =                 
117930                            (BORM-INT / WA-30DL-FACTOR)
117940      COMPUTE  BORM-INT-ACCR ROUNDED =                   
117950                            BORM-INT-INCR * WA-30DL-NO-DAYS.
117970 H199-EXIT.
117980     EXIT.
TB0125**************************************************************
TB0125* THIS ROUTINE IS CALLED BEFORE CALLS TO CS0007 IN ORDER TO
TB0125* "MERGE" CUST BASED FEE MASK (CSCP), WITH ACCT-PARM-FEE-MASK
TB0125* BY CALLING CS0012.  BY DEFAULT, CS0012RA-FEE-MASK IS SET
TB0125* TO ACCT-PARM-FEE-MASK.  THIS IS TO GET ADDITIONAL FEES BASED
TB0125* ON CUSTOMER TYPE.
TB0125**************************************************************
TB0125 H300-MERGE-CUST-BASED-FEE.
TB0125
TB0125     MOVE BORP-FEE-MASK         TO CS0012RA-FEE-MASK.
TB0125
TB0125     IF CUSM-CUST-ACCT-NO NOT = BORM-CUSTOMER-NO
TB0125        MOVE BORM-CUSTOMER-NO   TO CUSM-CUST-ACCT-NO
TB0125        MOVE BORM-SOC-NO        TO CUSM-SOC-NO
TB0125        MOVE "CUSM    "         TO DBIO-CALL-SYS-AREA
TB0125        MOVE CUSM-KEY           TO DBIO-CALL-KEY-AREA
TB0125        MOVE SPACES             TO DBIO-CALL-STATUS
TB0125        MOVE 71                 TO DBIO-CALL-FUNC
TB0125*
TB0125        CALL "DBIO" USING
TB0125                       DBIO-CALL-PARAM
TB0125                       DBIO-CALL-SYS-AREA
TB0125                       DBIO-CALL-KEY-AREA
TB0125                       DBIO-CALL-STATUS
TB0125                       CUSM-RECORD-AREA
TB0125        IF DBIO-CALL-STATUS NOT = "****"
TB0125           MOVE 00 TO  CUSM-VIP-CODE.
TB0125
TB0125     MOVE "****" TO DBIOMOD-STAT.
TB0125
S15848     MOVE SPACES                     TO UTVIPCCA-CALL-PARAM.
S15848     MOVE CUSM-VIP-CODE              TO UTVIPCCA-CODE.
S15848     MOVE INVM-SOC-NO                TO UTVIPCCA-INST-NO.
S15848     MOVE 02                         TO UTVIPCCA-CALL-CODE.
S15848     CALL "UTVIPC" USING
S15848                                     UTVIPCCA-CALL-PARAM.
S15848     IF UTVIPCCA-CALL-STATUS = 0
S15848        MOVE UTVIPCCA-CSCP-IND  TO WA-CSCP-IND
S15848     ELSE
S15848        MOVE 0                  TO WA-CSCP-IND
S15848     END-IF.
S15266     MOVE BORM-SOC-NO           TO UTBFTVCA-CALL-SOC-NO.
S15266     MOVE BORM-CUSTOMER-NO      TO UTBFTVCA-CALL-CUST-NO.
S15266     MOVE UT1999CA-CCYYMMDD     TO UTBFTVCA-CALL-DATE.
S15266     CALL "UTBFTV" USING UTBFTVCA-CALL-AREA.
S15266     IF UTBFTVCA-BFT-CODE NOT = "00"
S15848*S15266        MOVE UTBFTVCA-CSCP-IND  TO CUSM-VIP-CODE
S15848        MOVE UTBFTVCA-CSCP-IND  TO WA-CSCP-IND
S15266     END-IF.
S15266
TB0125     IF CUSM-SOC-NO NOT = CSCP-KEY-SOC
S15848          OR WA-CSCP-IND NOT = CSCP-VIP-TYPE
S15848*TB0125          OR CUSM-VIP-CODE NOT = CSCP-VIP-TYPE
TB0125        MOVE CUSM-SOC-NO        TO CSCP-KEY-SOC-ALT
TB0125        MOVE CUSM-VIP-CODE      TO CSCP-VIP-TYPE-ALT
S15848        MOVE WA-CSCP-IND        TO CSCP-VIP-TYPE-ALT
S15848*TB0125        MOVE CUSM-VIP-CODE      TO CSCP-VIP-TYPE-ALT
TB0125        MOVE 999999999          TO CSCP-EFTV-DTE-ALT
TB0125        MOVE CSCP-KEY-ALT       TO DBIOMOD-KEY
TB0125        MOVE 1                  TO DBIOMOD-KEY-NO
TB0125        SET  READ-CMD           TO TRUE
TB0125
TB0125        INITIALIZE DBIOMOD-RECORD
TB0125        MOVE "CSCP"         TO DBIOMOD-FILE
TB0125                               DBIOMOD-SUFFIX
TB0125        MOVE "DBIO"         TO DBIOMOD-PREFIX
TB0125        MOVE SPACES         TO DBIOMOD-RELEASE-LOCK
TB0125                               DBIOMOD-ACCESS-COMMAND
TB0125                               DBIOMOD-ACCESS-COND
TB0125                               DBIOMOD-STATUS
TB0125
TB0125        CALL DBIOMODNAME USING DBIOMOD-FILE
TB0125                               DBIOMOD-KEY
TB0125                               WS-CSCP-REC
TB0125                               DBIOMOD-FUNCTION
TB0125                               DBIOMOD-KEY-NO
TB0125                               DBIOMOD-RELEASE-LOCK
TB0125                               DBIOMOD-ACCESS-COMMAND
TB0125                               DBIOMOD-ACCESS-COND
TB0125                               DBIOMOD-STATUS.
TB0125
TB0125     IF DBIOMOD-STAT = "****"
TB0125        MOVE BORP-FEE-MASK      TO CS0012CA-ACCT-FEE-MASK
TB0125        MOVE CSCP-FEE-MASK      TO CS0012CA-CUST-FEE-MASK
TB0125        CALL "CS0012" USING WA-CS0012CA-CALL-AREA
TB0125                            WA-CS0012RA-RETURN-AREA.
TB0125
TB0125 H399-EXIT.
TB0125     EXIT.
TB0147 H400-SUPER-OVERRIDE.
SC4203***
SC4203*** NO SUPERVISOR OVERRIDE FOR TPS INITIATED TRXN
SC4203***
SC4203*ST0029     IF STRT-ASYNC-TPS
SC5286*ST0029        OR STRT-MORTGAGE-TXN
SC4203*ST0029        GO TO H400-EXIT
SC4203*ST0029     END-IF
S17474     MOVE STRT-AREA-TRN-NO TO WA-MESSAGE-TRN-NO.
S17474     IF WA-MSG-TRN-NO
S17474        GO TO H400-EXIT
S17474     END-IF.
TB0147     PERFORM H450-ACCESS-ED2P THRU H450-EXIT.
TB0147*    IF UT0251RA-SUPR-OVERRIDE-FLG NOT = "C" 
ST0083     IF UT0251RA-SUPR-OVERRIDE-FLG NOT = ("C" AND "A")
TB0147        GO TO H400-EXIT
TB0147     END-IF.
TB0147     INITIALIZE UTOVRDCA-AREA.
TB0249     IF STRT-AREA-TRN-NO = (17038 OR 17026 OR 63058 OR 17000)
SC1267           OR 12008
SC1743           OR 17036
S15320           OR 10872
S12474           OR 12007 OR 17037
S16588           OR 17085
TB0249        MOVE "Y" TO UTOVRDCA-CALL-TELR-FLAG.
TB0147     MOVE ZERO                 TO WA-MSG-ERR-FLAG.
TB0147     MOVE WA-EDIT-MASK         TO UTOVRDCA-CALL-PARAM.
TB0147     MOVE STRT-AREA-SOC-NO     TO UTOVRDCA-CALL-SOCIETY-NO.
TB0147     MOVE STRT-AREA-ABS-TERM   TO UTOVRDCA-CALL-TERM-NO.
TB0147     MOVE STRT-AREA-TELL-NO    TO UTOVRDCA-CALL-TELR-NO.
TB0147     MOVE STRT-AREA-TRN-NO     TO UTOVRDCA-CALL-TRAN-CODE.
TB0147     MOVE WA-INPUT-ACCT-NO     TO UTOVRDCA-CALL-ACC-NO.
TB0147     MOVE WA-INPUT-AMT         TO UTOVRDCA-CALL-INPUT-AMT.
S16482     MOVE WA-ACT-BAL-BEF-TXN   TO UTOVRDCA-ORIGINAL-LOAN-BAL.
S16579     MOVE WA-ORIGINAL-ARREARS-CTR
S16579                               TO UTOVRDCA-ORIGINAL-ARREARS-CTR.
SC7355     IF WA-TFR-FROM-DEP-ACCT
SC7355        MOVE ZERO TO UTOVRDCA-ORIGINAL-TRAN-CODE
SC7355     ELSE
SC7355        MOVE WS-VCHR-ORG-TRANCODE 
SC7355                  TO UTOVRDCA-ORIGINAL-TRAN-CODE
SC7355     END-IF.
SC4274     IF STRT-AREA-TRN-NO = 13031
SC4274        COMPUTE UTOVRDCA-CALL-INPUT-AMT
SC4274              = WA-REPAY-AMOUNT + BR0023-PENALTY-AMT
SC4274     END-IF.
SC4690     IF STRT-AREA-TRN-NO = 11060 OR 11055 OR 11057
SC4690                        OR 16060 OR 16055 OR 16057
SC4690                        OR 11160 OR 11155 OR 11157
SC4690                        OR 16160 OR 16155 OR 16157
S11455                        OR 11069 OR 11169
S11455                        OR 11068 OR 11168
S11455                        OR 16068 OR 16168
S11455                        OR 16069 OR 16169
S12770                        OR 11063 OR 16063
S12770                        OR 11163 OR 16163
SC4690        MOVE CUSM-REJECTED-STATUS TO UTOVRDCA-CALL-REASON
SC4690     END-IF.
SC4690     IF STRT-AREA-TRN-NO = 11057 OR 11157 OR 16057 OR 16157
S11455                        OR 11069 OR 11169
S11455                        OR 16069 OR 16169
SC4690        MOVE WA-SAVE-LOAN-ACCT-NO TO UTOVRDCA-CALL-ACC-NO
SC9409*                                    WA-UT0060-SAVE-ACC-NO
SC4690     END-IF.
TB0147     MOVE STRT-AREA-SIGN       TO UTOVRDCA-CALL-TRAN-SIGN.
TB0147     MOVE "LON"                TO UTOVRDCA-CALL-SYST.
TB0147     MOVE 0                    TO UTOVRDCA-CALL-STATUS
TB0147                                  UTOVRDCA-CALL-ERROR-CODE.
SC7178     MOVE UT0251RA-SUPR-OVERRIDE-FLG TO UTOVRDCA-ED2-SUP-FLAG.
B19902*SC6937     MOVE STARTAREA(1:150)    TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)    TO WA-SAV-STRT-AREA-DATA.
ST0029     IF STRT-BANCSLINK
TB0147         CALL "UTOVRD" USING
TB0147               UTOVRDCA-AREA
TB0147               WA-INPUT-MSG                                        SC5366
SC6937               WA-SAV-STRT-AREA-DATA
ST0083               W300-ERROR-AREA
ST0083               WA-PASSALONG 
ST0083               MULTI-OVERRIDE-AREA.
ST0083*              STARTAREA.
TB0147
TB0147     IF UTOVRDCA-CALL-STATUS  NOT = 0
TB0147        MOVE 1                        TO WA-MSG-ERR-FLAG
TB0147     END-IF.
TB0147
TB0147 H400-EXIT.
TB0147     EXIT.
TB0147
SC4656 H410-SUPER-OVERRIDE.
SC4656*ST0029     IF STRT-ASYNC-TPS
SC4656*ST0029        OR STRT-MORTGAGE-TXN
SC4656*ST0029        GO TO H410-EXIT
SC4656*ST0029     END-IF.
S16618*S12383     IF (STRT-AREA-TRN-NO = 11045 OR 13045)
S16618     IF (STRT-AREA-TRN-NO = 11045 OR 13045 OR 16045)
S12383     AND INVM-CUSTOMER-NO   = BORM-CUSTOMER-NO
S16663         MOVE "Y"              TO WA-FUND-GUAR
S12383        GO TO H410-EXIT
S12383     END-IF.
S17848     IF (STRT-AREA-TRN-NO = 13042)
S17848     AND INVM-CUSTOMER-NO   = BORM-CUSTOMER-NO
S17848     AND W41-IN-SYSTEM = "DEP"
S17848     AND W41-IN-TRF-SYSTEM = "LON"
S17848         MOVE W41-IN-EXP-TYPE  TO WA-FEE-TYPE
S17848         IF WA-FEE-TYPE-NO-SUP
S17848            GO TO H410-EXIT
S17848         END-IF
S17848     END-IF.
S16618
S16618     MOVE "N"                  TO WA-FUND-GUAR.
S16618     IF WA-RPYMT-VIA-DEP
S16618        PERFORM H415-FUND-GUAR-RTN THRU H415-EXIT
S16618        IF WA-FUND-GUAR = "Y"
S16618           GO TO H410-EXIT
S16618        END-IF
S16618     END-IF
SC4656     INITIALIZE UTOVRDCA-AREA.
SC4656     MOVE ZERO                 TO WA-MSG-ERR-FLAG.
SC4656     MOVE WA-EDIT-MASK         TO UTOVRDCA-CALL-PARAM.
SC4656     MOVE STRT-AREA-SOC-NO     TO UTOVRDCA-CALL-SOCIETY-NO.
SC4656     MOVE STRT-AREA-ABS-TERM   TO UTOVRDCA-CALL-TERM-NO.
SC4656     MOVE STRT-AREA-TELL-NO    TO UTOVRDCA-CALL-TELR-NO.
SC4656     MOVE STRT-AREA-TRN-NO     TO UTOVRDCA-CALL-TRAN-CODE.
SC4656     MOVE WA-INPUT-ACCT-NO     TO UTOVRDCA-CALL-ACC-NO.
SC4656     MOVE WA-INPUT-AMT         TO UTOVRDCA-CALL-INPUT-AMT.
SC4656     MOVE STRT-AREA-SIGN       TO UTOVRDCA-CALL-TRAN-SIGN.
SC4656     MOVE "DEP"                TO UTOVRDCA-CALL-SYST.
SC4656     MOVE 0                    TO UTOVRDCA-CALL-STATUS
SC4656                                  UTOVRDCA-CALL-ERROR-CODE.
SC7355     MOVE WS-VCHR-ORG-TRANCODE TO UTOVRDCA-ORIGINAL-TRAN-CODE.
SC4656
SC4656     IF  WA-TFR-FROM-DEP-ACCT
SC4656         MOVE W800-TO-ACCT     TO UTOVRDCA-CALL-ACC-NO
SC7072         IF WA-INPUT-PARAM-TABLE(8) = 1
SC7072            MOVE 6055          TO UTOVRDCA-CALL-TRAN-CODE
SC7072                                  LINK-IN-TXCODE
SC7072         ELSE
SC4656         MOVE 1055             TO UTOVRDCA-CALL-TRAN-CODE
SC4656                                   LINK-IN-TXCODE
SC7072         END-IF
SC4656         MOVE STRT-AREA-SOC-NO TO LINK-IN-SOC-NO
SC7016         MOVE 02 TO LINK-IN-CALL-CODE
SC4656         CALL "UT0250"     USING
SC4656                                       LINK-AREA
SC4656         MOVE LINK-EDIT-MASK   TO FIELD-B
SC4656         CALL "UT0022"     USING
SC4656                                       PUAREA
SC4656         MOVE FIELD-A          TO WA-EDIT-MASK
SC4656         MOVE WA-EDIT-MASK     TO UTOVRDCA-CALL-PARAM
SC4656     END-IF.
SC4656
SC7178     MOVE UT0251RA-SUPR-OVERRIDE-FLG TO UTOVRDCA-ED2-SUP-FLAG.
B19902*SC6937     MOVE STARTAREA(1:150)    TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)    TO WA-SAV-STRT-AREA-DATA.
ST0029     IF STRT-BANCSLINK
SC4656         CALL "UTOVRD" USING
SC4656               UTOVRDCA-AREA
SC4656               WA-INPUT-MSG
ST0083               STARTAREA
ST0083               W300-ERROR-AREA
ST0083               WA-PASSALONG 
ST0083               MULTI-OVERRIDE-AREA.
ST0083*              STARTAREA.
SC4656
SC4656     IF UTOVRDCA-CALL-STATUS  NOT = 0
SC4656        MOVE 1                        TO WA-MSG-ERR-FLAG
SC4656     END-IF.
SC4656
SC4656 H410-EXIT.
SC4656     EXIT.
S16482
S16482 H420-SUPER-OVERRIDE.
S16482     INITIALIZE UTOVRDCA-AREA.
S16482     MOVE ZERO                 TO WA-MSG-ERR-FLAG.
S16482     MOVE WA-EDIT-MASK         TO UTOVRDCA-CALL-PARAM.
S16482     MOVE STRT-AREA-SOC-NO     TO UTOVRDCA-CALL-SOCIETY-NO.
S16482     MOVE STRT-AREA-ABS-TERM   TO UTOVRDCA-CALL-TERM-NO.
S16482     MOVE STRT-AREA-TELL-NO    TO UTOVRDCA-CALL-TELR-NO.
S16482     MOVE STRT-AREA-TRN-NO     TO UTOVRDCA-CALL-TRAN-CODE.
S16482     MOVE WA-INPUT-ACCT-NO     TO UTOVRDCA-CALL-ACC-NO.
S16482     MOVE WA-INPUT-AMT         TO UTOVRDCA-CALL-INPUT-AMT.
S16482     MOVE WA-ACT-BAL-BEF-TXN   TO UTOVRDCA-ORIGINAL-LOAN-BAL.
S16482     MOVE WS-VCHR-ORG-TRANCODE TO UTOVRDCA-ORIGINAL-TRAN-CODE.
S16579     MOVE WA-ORIGINAL-ARREARS-CTR
S16579                               TO UTOVRDCA-ORIGINAL-ARREARS-CTR.
S16482     MOVE STRT-AREA-SIGN       TO UTOVRDCA-CALL-TRAN-SIGN.
S16482     MOVE "LON"                TO UTOVRDCA-CALL-SYST.
S16482     MOVE 0                    TO UTOVRDCA-CALL-STATUS
S16482                                  UTOVRDCA-CALL-ERROR-CODE.
S16482     MOVE UT0251RA-SUPR-OVERRIDE-FLG TO UTOVRDCA-ED2-SUP-FLAG.
B19902*S16482     MOVE STARTAREA(1:150)    TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)    TO WA-SAV-STRT-AREA-DATA.
S16482     IF STRT-BANCSLINK
S16482        CALL "UTOVRD" USING
S16482              UTOVRDCA-AREA
S16482              WA-INPUT-MSG
S16482              WA-SAV-STRT-AREA-DATA
S16482              W300-ERROR-AREA
S16482              WA-PASSALONG
S16482              MULTI-OVERRIDE-AREA.
S16482
S16482     IF UTOVRDCA-CALL-STATUS  NOT = 0
S16482        MOVE 1                TO WA-MSG-ERR-FLAG
S16482     END-IF.
S16482
S16482 H420-EXIT.
S16482     EXIT.
S16618 H415-FUND-GUAR-RTN.
S16618
S16618     MOVE 0                 TO WA-GTE-TO-LON-CTR.
S16618     MOVE "N"               TO WA-RCNF-RELM.
S16618     INITIALIZE             UT0400-CALL-AREA.
S16618     MOVE 05                TO UT0400CA-CALL-CODE.
S16618     MOVE STRT-AREA-SOC-NO  TO UT0400CA-RELM-INST-1
S16618                               UT0400CA-RELM-INST-1-REL.
S16618     MOVE 1                 TO UT0400CA-KEY-NO.
S16618     MOVE BORM-MEMB-CUST-AC TO UT0400CA-RELM-ID-1
S16618     MOVE 0                 TO UT0400CA-RELM-ID-1-REL.
S16618     MOVE "LON"             TO UT0400CA-RELM-ENTITY-1
S16618     MOVE "GTE"             TO UT0400CA-RELM-ENTITY-1-REL.
S16618     SET GUARANTEE-TO-ACCOUNT  TO TRUE.
S16618     MOVE RELATIONSHIP-VALUE TO UT0400CA-RELM-RELATIONSHIP-1.
S16618
S16618     PERFORM D400-READ-RELM THRU D499-EXIT.
S16618
S16618     IF WA-RCNF-RELM = "N"
S16618        PERFORM
S16618          UNTIL UT0400CA-CALL-STATUS <>  "****"
S16618             OR WA-RCNF-RELM          =  "Y"
S16618             OR BORM-MEMB-CUST-AC    <>  UT0400CA-RELM-ID-1
S16618           IF RELM-ID-1-REL NOT       =  0
S16618           AND RELM-STATUS            =  00
S16618             PERFORM MOVE-RELM-1 THRU MOVE-RELM-1-EXIT
S16618             PERFORM D410-GET-GUAR-ID THRU D410-EXIT
S16618             IF  DBIO-CALL-STATUS = "****"
S16618             AND INVM-CUSTOMER-NO = GTEM-GUARANTOR-CUST-NO
S16618                 MOVE "Y" TO WA-RCNF-RELM
S16618                 MOVE "Y" TO WA-FUND-GUAR
S16618             END-IF
S16618           END-IF
S16618           MOVE 1             TO UT0400CA-KEY-NO
S16618           MOVE 03            TO UT0400CA-CALL-CODE
S16618           PERFORM D400-READ-RELM THRU D499-EXIT
S16618       END-PERFORM
S16618    END-IF.
S16618
S16618 H415-EXIT.
S16618     EXIT.
S16618
TB0147 H450-ACCESS-ED2P.
TB0147     MOVE 2                        TO UT0251CA-CALL-CODE.
TB0147     MOVE STRT-AREA-SOC-NO         TO UT0251CA-SOC-NO.
TB0147     MOVE STRT-AREA-TRN-NO         TO UT0251CA-TRAN-CODE.
TB0147     CALL "UT0251" USING UT0251CA-CALL-AREA.
TB0147
TB0147     IF UT0251CA-CALL-STATUS = "****"
TB0147        IF UT0251RA-SUPR-OVERRIDE-FLG = "Y"
SC6248         IF STRT-AREA-BATCH-TANDEM = "B" OR
SC6248                STRT-ASYNC-TPS
S11833              OR (WA-17200-FUNC = "03" AND
S11833                  WA-17200-YOUBE-STOP = "Y")
SC1171              NEXT SENTENCE
SC1171         ELSE
I40871           MOVE 3742   TO  UTOVRDCA-CALL-ERROR-CODE
TB0147           MOVE 1      TO  WA-MSG-ERR-FLAG
ST0083           MOVE 0  TO WA-MSG-ERR-FLAG
ST0083           MOVE UTOVRDCA-CALL-ERROR-CODE TO
ST0083                UT0060CA-CALL-ERROR-CODE
ST0083           MOVE UTOVRDCA-CALL-PROMONO    TO WA-OVER-RIDE
ST0083           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
ST0083           IF WA-MSG-ERR-FLAG = 0
ST0083              MOVE UTOVRDCA-CALL-ERROR-CODE TO WA-ERR-MSG-NO
ST0083           ELSE 
ST0083              MOVE UTOVRDCA-CALL-ERROR-CODE TO 
ST0083                   WA-OUTPUT-ERR-MSG-NO
ST0083           END-IF
TB0147           GO TO H450-EXIT
SC1171        END-IF
TB0147        ELSE
TB0147           IF UT0251RA-SUPR-OVERRIDE-FLG NOT = "C"
TB0147              GO TO H450-EXIT
TB0147           END-IF
TB0147        END-IF
TB0147     ELSE
TB0147        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
TB0147        MOVE SPACES TO UT8500CA-INPUT-MSG
TB0147        STRING "BR0000:(H450) UT0251 ERROR TRAN CODE   - "
TB0147                 UT0251CA-TRAN-CODE
TB0147             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0147         CALL "UT8500" USING UT8500CA-AREA
TB0147     END-IF.
TB0147 H450-EXIT.
TB0147     EXIT.
TB0147
S15361 H500-SVIP-RTN.
S15877    IF  STRT-AREA-TRN-NO           =  10724
S15877    AND (INPUT-10724-ACCT-NO       =  SPACES
S15877      OR INPUT-10724-ACCT-NO       =  ZEROES)
S15877    AND  INPUT-10724-CUST-NO   NOT =  SPACES
S15877    AND  INPUT-10724-CUST-NO   NOT =  ZEROES
S15877      MOVE  INPUT-10724-CUST-NO   TO  WK5003-ID-NO
S15877      MOVE  INPUT-10724-ID-TYPE   TO  WK5003-ID-TYPE
S15877      MOVE  02                    TO  WK5003-CALL-CODE
S15877      PERFORM  G310-CALL-UT5003 THRU  G319-EXIT
S15877      IF  UT5003CA-CALL-STATUS NOT =  ZEROES
S15877        MOVE  0108                TO  WA-OUTPUT-ERR-MSG-NO
S15877        MOVE  1                   TO  WA-MSG-ERR-FLAG
S15877        GO                        TO  H500-EXIT
S15877      ELSE
S15877        MOVE  SPACES              TO  SEC-KEY-AREA
S15877        MOVE  UT5003CA-CIF-NO     TO  SEC-KEY-NO
S15877        GO                        TO  H500-NEXT
S15877      END-IF
S15877    END-IF.
S15361    MOVE 01                      TO DBIO-CALL-FUNC.
S15361    MOVE "BOR"                   TO DBIO-CALL-SYS-AREA.
S15361    MOVE STRT-AREA-SOC-NO        TO WA-BORM-SOC-NO.
S15361    MOVE WA-INPUT-ACCT-NO        TO WA-BORM-ACCT-NO.
S15361    MOVE WA-BORM-KEY             TO DBIO-CALL-KEY-AREA.
S15361    MOVE SPACES                  TO DBIO-CALL-STATUS.
S15361    CALL "DBIO" USING
S15361                                    DBIO-CALL-PARAM
S15361                                    DBIO-CALL-SYS-AREA
S15361                                    DBIO-CALL-KEY-AREA
S15361                                    DBIO-CALL-STATUS
S15361                                    BORM-RECORD-AREA.
S15361     IF  DBIO-CALL-STATUS NOT = "****"
S15361         MOVE 155                TO WA-OUTPUT-ERR-MSG-NO
S15361         MOVE "BORM"             TO WA-DBERR-DATA-SET
S15361         MOVE DBIO-CALL-STATUS   TO WA-DB-ERROR
S15361         MOVE 1                  TO WA-MSG-ERR-FLAG
S15361         GO TO H500-EXIT
S15361     END-IF.
S15361     MOVE SPACES                 TO SEC-KEY-AREA.
S15361     MOVE BORM-CUSTOMER-NO       TO SEC-KEY-NO.
S15877 H500-NEXT.
S15361     PERFORM Y100-CUSM-SECURITY THRU Y199-EXIT.
S15361     IF WA-MSG-ERR-FLAG = 1
S15361        GO TO H500-EXIT
S15361     END-IF.
S15361     IF UT0450-OVRD-FLAG = 1
S15361         MOVE 1010 TO UT0060CA-CALL-ERROR-CODE
S15361         PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
S15361         IF WA-MSG-ERR-FLAG NOT = 0
S15361            MOVE 1010  TO WA-OUTPUT-ERR-MSG-NO
S15361            MOVE 1     TO WA-MSG-ERR-FLAG
S15361            GO         TO H500-EXIT
S15361         END-IF
S15361     END-IF.
S15361 H500-EXIT.
S15361     EXIT.
B17951*
B17951 H600-ACCESS-DTEP.
B17951     MOVE DATE-KEY    OF    ONPARAM-REC
B17951                                  TO DBIOMOD-KEY
B17951     MOVE ZEROES                  TO DBIOMOD-KEY-NO
B17951     MOVE "DTEP"                  TO DBIOMOD-FILE
B17951                                     DBIOMOD-SUFFIX
B17951                                     WS-DISP-FILE.
B17951     MOVE "DBIO"                  TO DBIOMOD-PREFIX.
B17951     MOVE SPACES                  TO DBIOMOD-RELEASE-LOCK
B17951                                     DBIOMOD-STATUS
B17951                                     DBIOMOD-ACCESS-COMMAND
B17951                                     DBIOMOD-ACCESS-COND.
B17951*
B17951     CALL DBIOMODNAME          USING DBIOMOD-FILE
B17951                                     DBIOMOD-KEY
B17951                                     ONPARAM-REC
B17951                                     DBIOMOD-FUNCTION
B17951                                     DBIOMOD-KEY-NO
B17951                                     DBIOMOD-RELEASE-LOCK
B17951                                     DBIOMOD-ACCESS-COMMAND
B17951                                     DBIOMOD-ACCESS-COND
B17951                                     DBIOMOD-STATUS.
B17951 H600-EXIT.
B17951     EXIT.
B17951*
118000**************************************************************
118010*** HERE IT VALIDATES THE LEDGER CODES AND SUB LEDGER CODES **
118020*** FOR REPAYMENT  TRANSACTIONS.
118030*** ALSO CHECKS BORM-STAT FOR AUTO DUE TRAN (16032).
118040**************************************************************
118050 L000-VALIDATE-REPAYMENTS.
118060     MOVE SPACE TO WA-AUTO-DISCH-FLAG.
118070     MOVE 0     TO ST-CHQ-CLEAR-DAYS
118080                   WA-DEFER-DAYS.
SC8756
S16485     IF BORP-YOUBE
S16485        COMPUTE WA-REM-BAL = BORM-LOAN-BAL
S16485                           + BOIS-MISC-FEE1-DUE
S16485                           + BOIS-TEMP-PAYMENT-DUE
S16485     END-IF.
S16369     IF  BORP-YOUBE
S16485*S16369     AND BORM-LOAN-BAL <= 0
S16485     AND WA-REM-BAL <= 0
S16369     AND WA-INPUT-PARAM-TABLE(4)  = 1
S16369     AND NOT STRT-BANCSLINK
S16369     AND NOT STRT-MORTGAGE-TXN
S16369         MOVE 5314 TO WA-OUTPUT-ERR-MSG-NO
S16369         MOVE 1    TO WA-MSG-ERR-FLAG
S16369         GO TO L099-EXIT
S16369     END-IF.
S15456     MOVE BORM-ACT-TYPE    TO  WA-BORM-ACT-TYPE.
SC8756     IF BORM-BAD-DEBT-IND(2:1) >= 2
SC8756        AND NOT STRT-BANCSLINK
S11877        AND NOT STRT-BATCH-TRICKLE-TXN
S10649        AND NOT BORP-YOUBE
S15456*S12384        AND NOT (BORP-CONSMR AND BORP-NEGO-PROD)
S15456        AND NOT WA-ACT-TYPE-PERSONAL
SC8756        MOVE 4744 TO WA-OUTPUT-ERR-MSG-NO
SC8756        MOVE 1    TO WA-MSG-ERR-FLAG
SC8756        GO TO L099-EXIT
SC8756     END-IF.
SC8756
S16105*S16201     IF STRT-BANCSLINK
S16105     IF (STRT-BANCSLINK OR STRT-TRICKLE-TXN)
S16201        AND (STRT-AREA-TRN-NO = 11030 OR 16030)
S16201        AND  NOT BORP-RECEIVABLE-YES
S16201        MOVE 3417 TO WA-OUTPUT-ERR-MSG-NO
S16201        MOVE 1    TO WA-MSG-ERR-FLAG
S16201        GO TO L099-EXIT
S16201     END-IF.
S16201
S17197     IF STRT-BANCSLINK
S17197        AND (STRT-AREA-TRN-NO = 11030 OR 16030)
S17197        AND BORP-ALBPS
S17197        AND BORP-RECEIVABLE-YES
S17197        AND (STRT-AREA-POST-DT < BOIS-LAST-UNPAID-DUE-DATE)
S17197        MOVE 3417 TO WA-OUTPUT-ERR-MSG-NO
S17197        MOVE 1    TO WA-MSG-ERR-FLAG
S17197        GO TO L099-EXIT
S17197     END-IF.
S17197
118090     IF  WA-INPUT-PARAM-TABLE(30) = 1
118100*        MOVE 1                         TO WA-REPAY-SUB-LEDG-CODE
118110*                                          STRT-AREA-LEDG-CODE.
SC8772         IF BORM-BAD-DEBT-IND(2:1) >= 2
S10649         AND NOT BORP-YOUBE
S15228         AND WA-ATM-ALLOW = "N"
SC8772            MOVE 1928 TO WA-OUTPUT-ERR-MSG-NO
SC8772            MOVE 1    TO WA-MSG-ERR-FLAG
SC8772            GO TO L099-EXIT
SC8772         END-IF
118120         MOVE STRT-AREA-LEDG-CODE TO WA-REPAY-SUB-LEDG-CODE.
118130*    IF  STRT-AREA-LEDG-CODE NOT = 1
118140*        MOVE 1 TO WA-MSG-ERR-FLAG
118150*        MOVE 193 TO WA-OUTPUT-ERR-MSG-NO
118160*        GO TO L099-EXIT.
118170     IF  (WA-REPAY-SUB-LEDG-CODE < 1 OR
118180          WA-REPAY-SUB-LEDG-CODE > 30)
118190         MOVE 1 TO WA-MSG-ERR-FLAG
118200         MOVE 194 TO WA-OUTPUT-ERR-MSG-NO
118210         GO TO L099-EXIT.
118220     MOVE WA-REPAY-AMOUNT TO WA-VA-AMT.
118230     MOVE BORM-CURRENCY-IND TO WA-CURRENCY.                               
ST0096**   PERFORM BB630-FORMAT-AMT-DECIMAL THRU BB639-EXIT.                    
118250     PERFORM Q000-AMOUNT-VALIDATION THRU Q009-EXIT.
118260     IF WA-MSG-ERR-FLAG = 1
118270        GO TO L099-EXIT.
118280*
118290*
118300***  NEXT TWO 'IFS' ARE TO PREVENT THE BRANCHES
118310***  FROM ENTERING INVALID SUB-LEDGER CODES FOR
118320***  CASH OR CHEQUE REPAYMENTS ONLY.
118330*
118340*
118350*    IF WA-CASH-REPAY-TRCODE
118360*       IF WA-REPAY-SUB-LEDG-CODE NOT = 1
118370*          MOVE 1 TO WA-MSG-ERR-FLAG
118380*          MOVE 194 TO WA-OUTPUT-ERR-MSG-NO
118390*          GO TO L099-EXIT.
118400*    IF WA-CHQ-REPAY-TRCODE
118410*       IF WA-REPAY-SUB-LEDG-CODE NOT = 2
118420*          MOVE 1 TO WA-MSG-ERR-FLAG
118430*          MOVE 194 TO WA-OUTPUT-ERR-MSG-NO
118440*          GO TO L099-EXIT.
118450*
118460*
118470*4*  IF  WA-INPUT-PARAM-TABLE(19) = 1
118480     IF  STRT-BATCH-TXN
118490         PERFORM L900-BATCH-CHECK THRU L909-EXIT.
118500     IF  WA-MSG-ERR-FLAG = 1
118510         GO TO L099-EXIT.
118520     PERFORM L100-VALIDATE-INPUT THRU L199-EXIT.
118530     IF  WA-MSG-ERR-FLAG = 1
118540         GO TO L099-EXIT.
118560     IF  WA-CHQ-REPAY-TRCODE
118570         IF WA-REPAY-ITEMS < 1
118580            MOVE 2129 TO WA-OUTPUT-ERR-MSG-NO
118590            MOVE    1 TO WA-MSG-ERR-FLAG
118600            GO TO L099-EXIT.
SC3775     IF NOT STRT-BANCSLINK
SC3775**SC7091 AND STRT-AREA-TRN-NO = 14010 OR 14030 OR 14011
SC7091*S12384  AND (STRT-AREA-TRN-NO = 14010 OR 14030 OR 14011
S12384     AND (STRT-AREA-TRN-NO = 14010 OR 14030 OR 14011 OR 11030
S12384                          OR 16030
SC7091                          OR 19011 OR 19030)
SC3775     AND WA-REPAY-DEFER-DAYS NOT = 0
SC3775         MOVE 0  TO WA-REPAY-DEFER-DAYS
SC3775     END-IF.
118620     IF WA-INPUT-PARAM-TABLE(10) = 1
118630     OR WA-CREDIT-REPAY-TRCODE
118640     OR WA-CASH-REPAY-TRCODE
118650***     TRANSLATE DEFER-DAYS AND CLEAR-DAYS.
118660        PERFORM L200-TRANSLATE-DAYS THRU L299-EXIT
118670         IF BORM-BAD-DEBT-IND = 3 AND
118680               WA-REPAY-DEFER-DAYS NOT = 0
118690               MOVE 181 TO WA-OUTPUT-ERR-MSG-NO
118700               MOVE 1 TO WA-MSG-ERR-FLAG
118710            END-IF
118720     ELSE
118730        IF WA-DEBIT-REPAY-TRCODE
118740***        ONLY TRANSLATE DEFER-DAYS.
118750           MOVE WA-REPAY-DEFER-DAYS TO WA-CLRD-CODE-9
118760           PERFORM L220-TRANSLATE-DEFER-DAYS
118770           MOVE WA-TRANSLATED-DEFER-DAYS TO WA-DEFER-DAYS.
118790     IF  WA-MSG-ERR-FLAG = 1
118800         GO TO L099-EXIT.
118820*** TO CONVERT DEFERRED-INT DAYS FROM WORK DAYS TO ELAPSE DAYS.
118830*
118840     IF WA-DEFER-DAYS                 >  0
118850        IF SOC-CHQ-CLEAR-METH         =  1
118860           MOVE WA-DEFER-DAYS         TO UT0310CA-DAYS
118870           PERFORM L400-GET-ELAPSE-DAYS  THRU L499-EXIT
118880           MOVE UT0310CA-ELAPSE-DAYS  TO WA-DEFER-DAYS.
118900*** TO CONVERT UNCLEAR CHQ DAYS FROM WORK DAYS TO ELAPSE DAYS.
118910*
118920     IF ST-CHQ-CLEAR-DAYS             >  0
118930        IF SOC-CHQ-CLEAR-METH         =  1
118940           MOVE ST-CHQ-CLEAR-DAYS     TO UT0310CA-DAYS
118950           PERFORM L400-GET-ELAPSE-DAYS  THRU L499-EXIT
118960           MOVE UT0310CA-ELAPSE-DAYS  TO ST-CHQ-CLEAR-DAYS.
118980     IF  WA-INPUT-PARAM-TABLE(8) = 1
118990         PERFORM W200-FIND-DATE-FILE THRU W299-EXIT
119000         IF  WA-MSG-ERR-FLAG = 1
119010             GO TO L099-EXIT.
TB0198
TB0198**** VALIDATE AGREEMENT INSTALLMENT REPAYMENT
S15871*TB0198     IF BOIS-AGREE-IND = 2
S15871     IF BOIS-AGREE-FUNC-USE
TB0198       AND BORM-REPAY-SCHED = "N"
SC4095       AND WA-INPUT-PARAM-TABLE(7) = 0
TB0198        PERFORM AGREE-INSTALL-VALIDATION
TB0198           THRU AGREE-INSTALL-VALIDATION-EXIT
TB0198
TB0198         IF  WA-MSG-ERR-FLAG = 1
TB0198             GO TO L099-EXIT
TB0198         END-IF
TB0198     END-IF.
TB0198
SC8568*SC9389**** REPAYMENT FOR CTA ACCT WHERE MAT DT = ADVANCE DT 
SC8568*SC9389     IF BORM-DUE-STRT-DATE = BOIS-MATURITY-DATE       
SC8568*SC9389        AND BORM-LST-FIN-DATE = BOIS-MATURITY-DATE    
SC8568*SC9389        AND BORM-ADV-DATE = BOIS-MATURITY-DATE        
SC8568*SC9389        AND NOT BORP-YOUBE
SC8568*SC9389          MOVE 171 TO WA-OUTPUT-ERR-MSG-NO            
SC8568*SC9389          MOVE 1 TO WA-MSG-ERR-FLAG                   
SC8568*SC9389          GO TO L099-EXIT                             
SC8568*SC9389     END-IF.                                          
SC7033**** SAVE BOIS REPAYMENT FIELDS BEFORE CALL TO BR0023
SC7033     IF BORP-YOUBE
SC7033        MOVE BORM-LOAN-BAL           TO WA-BORM-LOAN-BAL
SC7033        MOVE BOIS-REV-RECEIVABLE-DUE TO WA-BOIS-REV-RECEIVABLE-DUE
SC7033        MOVE BOIS-PREV-DUE-DATE      TO WA-BOIS-PREV-DUE-DATE
SC7033        MOVE BOIS-NEXT-DUE-DATE      TO WA-BOIS-NEXT-DUE-DATE
SC7033     END-IF.
SC7033
119020 L099-EXIT.
119030     EXIT.
119040/
119050**************************************************************
119060*** IT VALIDATES THE BACK DATE, PACKS THE BRCH-NO,TERM-NO*****
119070*** AND TELLER NO AND CHECK FOR CORRECTION TRX.
119080**************************************************************
119090 L100-VALIDATE-INPUT.
119100     IF  WA-INPUT-PARAM-TABLE(8) = 1
119110         MOVE WA-BOR-BFY TO UT0030-DATE-DDMMCCYY
119120         PERFORM X610-UT0030-PARA THRU X619-EXIT
119130         MOVE UT0030-BINARY-DATE TO WA-BOR-BFY-BIN
119140*** 760167 BEGIN ***
119150* MOVE ATM TXN DATE ONLY IF THE TXN CAME FROM THE ATM.
119160*        MOVE WA-REPAY-TXN-DATE TO UT0030-DATE-DDMMCCYY
119170         IF STRT-AREA-OTHER-OVERRIDE = "7"
119180            MOVE TPATM-TXN-DATE TO UT0030-DATE-DDMMCCYY
119190         ELSE
119200            MOVE WA-REPAY-TXN-DATE TO UT0030-DATE-DDMMCCYY
119210         END-IF
119220*** 760167 END ***
119230         PERFORM X610-UT0030-PARA THRU X619-EXIT
119240         MOVE UT0030-BINARY-DATE     TO WA-STORE-TXN-DT.
119250     IF  WA-INPUT-PARAM-TABLE (8) = 1
119260         IF  WA-STORE-TXN-DT = ZEROES
119270             MOVE 126                TO WA-OUTPUT-ERR-MSG-NO
119280             MOVE 1                  TO WA-MSG-ERR-FLAG
119290             GO TO L199-EXIT
119300         END-IF
119310         IF  WA-STORE-TXN-DT < BORM-LAST-ACCT-TYPE-CHANGE
119320             MOVE 2168               TO WA-OUTPUT-ERR-MSG-NO
119330             MOVE 1                  TO WA-MSG-ERR-FLAG
119340             GO TO L199-EXIT
119350         END-IF
S17830         IF  WA-INPUT-PARAM-TABLE(7) = 1
S17830         AND STRT-AREA-TRN-NO        = 16145
S17830         AND WA-STORE-TXN-DT         = STRT-AREA-POST-DT
S17830             NEXT SENTENCE
S17830         END-IF
S20657         IF  WA-INPUT-PARAM-TABLE(7) = 1
S20657         AND STRT-AREA-TRN-NO        = 16101
S20657         AND WA-STORE-TXN-DT         = STRT-AREA-POST-DT
S20657             NEXT SENTENCE
S20657         END-IF
SC3572*        IF  WA-STORE-TXN-DT > STRT-AREA-POST-DT
SC3572*          MOVE 190 TO UT0060CA-CALL-ERROR-CODE
SC3572         IF  WA-STORE-TXN-DT >= STRT-AREA-POST-DT
SC3366             AND STRT-AREA-BATCH-TANDEM NOT = "B"
SC3572           MOVE 4150 TO UT0060CA-CALL-ERROR-CODE
119380           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
119390           IF WA-MSG-ERR-FLAG = 0
SC3572*            MOVE 190 TO WA-ERR-MSG-NO
SC3572             MOVE 4150 TO WA-ERR-MSG-NO
119410           ELSE
SC3572*            MOVE 190                TO WA-OUTPUT-ERR-MSG-NO
SC3572             MOVE 4150               TO WA-OUTPUT-ERR-MSG-NO
119430             MOVE 1                  TO WA-MSG-ERR-FLAG
119440             GO TO L199-EXIT.
ST0099     IF   BORP-YOUBE                                          
ST0099     AND  WA-INPUT-PARAM-TABLE (8) = 1                        
SC7982*    AND (WA-STORE-TXN-DT NOT > BORM-LAST-ACCT-TYPE-CHANGE)
SC7982     AND (WA-STORE-TXN-DT     < BORM-LAST-ACCT-TYPE-CHANGE)
ST0099             MOVE 4781               TO WA-OUTPUT-ERR-MSG-NO  
ST0099             MOVE 1                  TO WA-MSG-ERR-FLAG       
ST0099             GO TO L199-EXIT                                  
ST0099     END-IF.                                                  
119450***** SPR 760338 / HGC *****
119460      IF WA-INPUT-PARAM-TABLE(8) = 1
TB0232       AND WA-INPUT-PARAM-TABLE(4) = 0
ST0049       AND NOT BORP-YOUBE
119470*         PERFORM W200-FIND-DATE-FILE THRU W299-EXIT
119480*         MOVE ZEROS                  TO W100-CAPT-DAY
119490*                                        W100-PROC-DDMMCCYY
119500*         IF BORM-PAY-DAY > 0
119510*             MOVE BORM-PAY-DAY           TO W100-CAPT-DAY
119520*         ELSE
119530*             MOVE BORP-CAPN-DAY          TO W100-CAPT-DAY
119540*         END-IF
119550*         IF W100-CAPT-DAY NOT = 31
119560*             MOVE WA-WORK-FIELD          TO UT0020-BINARY-DATE
119570*             MOVE 1                      TO UT0020-FUNCTION
119580*             CALL "UT0020" USING UT0020-FUNCTION
119590*                                 UT0020-DATE-AREA
119600*                                 UT0020-BINARY-DATE
119610*             MOVE UT0020-DATE-AREA       TO W100-PROC-DDMMCCYY
119620*             IF W100-CAPT-DAY > 0
119630*                 MOVE W100-CAPT-DAY      TO W100-PROC-DD
119640*             END-IF
119650*             MOVE 1                      TO UT0030-FUNCTION
119660*             MOVE W100-PROC-DDMMCCYY     TO UT0030-DATE-DDMMCCYY
119670*             CALL "UT0030" USING  UT0030-FUNCTION
119680*                                  UT0030-DATE-AREA
119690*                                  UT0030-BINARY-DATE
119700*         ELSE
119710*             MOVE ZEROS                  TO UT0030-BINARY-DATE
119720*             MOVE WA-WORK-FIELD          TO UT0030-BINARY-DATE
119730*         END-IF
119740*         IF WA-STORE-TXN-DT < UT0030-BINARY-DATE
119750          PERFORM L150-GET-PREV-SOP THRU L159-EXIT
119760          IF WA-STORE-TXN-DT  <  WA-PREV-SOP-DATE
SC4631          AND WA-INPUT-PARAM-TABLE(7) = 0
119770             MOVE 191              TO UT0060CA-CALL-ERROR-CODE
119780             PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU
119790                     Y090-EXIT
119800             IF WA-MSG-ERR-FLAG = 0
119810                 MOVE 191                TO WA-ERR-MSG-NO
119820             ELSE
119830                 MOVE 191                TO WA-OUTPUT-ERR-MSG-NO
119840                 MOVE 1                  TO WA-MSG-ERR-FLAG
119850             END-IF
119860          END-IF
119870          IF WA-MSG-ERR-FLAG = 1
119880              GO TO L199-EXIT.
119890*
119900     IF  WA-INPUT-PARAM-TABLE(8) = 1
ST0049     AND NOT BORP-YOUBE
119910         IF  WA-STORE-TXN-DT < WA-BOR-BFY-BIN
119920*----760330-----START------------------------------------------
119930*            MOVE 192 TO WA-OUTPUT-ERR-MSG-NO
119940             MOVE 126 TO WA-OUTPUT-ERR-MSG-NO
119950*----760330-----END--------------------------------------------
119960             MOVE 1 TO WA-MSG-ERR-FLAG
119970             GO TO L199-EXIT.
S15787*** MOVE FOLLOWING STATMENT AFTER L500-VERIFY-OLD-TRN
S15787*** START
S15787*TB0082**--
S15787*      **-- for correction of backdated drawdown, move the last drawdown date
S15787*      **-- in the BORM-ADV-DATE and not use the corrected drawdown date.
S15787*           IF WA-INPUT-PARAM-TABLE(5) = 1 AND
S15787*              WA-INPUT-PARAM-TABLE(7) = 1 AND
S15787*              WA-INPUT-PARAM-TABLE(8) = 1
NR2001*       PERFORM FIND-MATCH-BORV
NR2001*          THRU FIND-MATCH-BORV-EXIT
S15787*NR2001        PERFORM FIND-MATCH-BOCT
S15787*NR2001           THRU FIND-MATCH-BOCT-EXIT
S15787*           END-IF
TB0082**--
119980     IF  WA-INPUT-PARAM-TABLE(8) = 1
S19747*ST0049     AND NOT BORP-YOUBE
S19747     AND NOT (BORP-YOUBE OR PROD-RICHART)
119990         IF  UT0030-BINARY-DATE < BORM-ADV-DATE
120000             MOVE 126 TO WA-OUTPUT-ERR-MSG-NO
120010             MOVE 1 TO WA-MSG-ERR-FLAG
120020             GO TO L199-EXIT.
120030     PERFORM U100-PK-BRANCH-TERM-TELL THRU U199-EXIT.
120040*** 760167 BEGIN ***
120050*    IF  STRT-AREA-SIGN = "-"
120060*        MULTIPLY WA-REPAY-AMOUNT BY -1 GIVING
120070*                 WA-DUMMY-AMT
120080*    ELSE
120090*        MOVE WA-REPAY-AMOUNT      TO WA-DUMMY-AMT.
120100*
120110     IF  STRT-AREA-SIGN = "-"
120120         IF STRT-AREA-OTHER-OVERRIDE = "7"
120130            MULTIPLY TPATM-AMOUNT    BY -1 GIVING
120140                     WA-DUMMY-AMT
120150         ELSE
120160            MULTIPLY WA-REPAY-AMOUNT BY -1 GIVING
120170                    WA-DUMMY-AMT
120180         END-IF
120190     ELSE
120200         IF STRT-AREA-OTHER-OVERRIDE = "7"
120210            MOVE TPATM-AMOUNT      TO WA-DUMMY-AMT
120220         ELSE
120230            MOVE WA-REPAY-AMOUNT   TO WA-DUMMY-AMT
120240         END-IF
120250     END-IF.
120260*** 760167 END ***
120270     MOVE STRT-AREA-TRN-NO TO WA-DUMMY-TRN-NO.
120280     IF  WA-INPUT-PARAM-TABLE(4) NOT = 1
120290         IF  WA-INPUT-PARAM-TABLE(7) = 1
120300             PERFORM L500-VERIFY-OLD-TRN
120310                THRU L599-EXIT
TB0099         END-IF
120320         IF  WA-MSG-ERR-FLAG = 1
120330             GO TO L199-EXIT.
S15787*** START
S15787**-- for correction of backdated drawdown, move the last drawdown date
S15787**-- in the BORM-ADV-DATE and not use the corrected drawdown date.
S15787     IF WA-INPUT-PARAM-TABLE(5) = 1 AND
S15787        WA-INPUT-PARAM-TABLE(7) = 1
S15787        PERFORM FIND-MATCH-BOCT
S15787           THRU FIND-MATCH-BOCT-EXIT
S15787     END-IF.
S15787*** END
120350* SPR 730232  S------S
120370     IF STRT-BATCH-TXN
120380        GO TO L111
120390     END-IF.
120410     IF WA-DUMMY-LST-TWO = 80
120420        IF WA-ADV-1ST-BYTE = "#" OR CPO-BATCH-ONLY OR
120430           (CPO-INTELLIGENT-ONLY AND STRT-AREA-TERM-TYPE = "1")
120440           IF WA-ADV-CHQ-NO NOT = ZERO
120450              MOVE 1 TO WA-MSG-ERR-FLAG
120460              MOVE 327 TO WA-OUTPUT-ERR-MSG-NO
120470              GO TO L199-EXIT
120480           END-IF
120490        ELSE
120500           IF WA-ADV-CHQ-NO = ZERO
120510              MOVE 1 TO WA-MSG-ERR-FLAG
120520              MOVE 416 TO WA-OUTPUT-ERR-MSG-NO
120530              GO TO L199-EXIT
120540           END-IF
120550        END-IF
120560     END-IF.
120580 L111.
120600     IF WA-DUMMY-LST-TWO = 80
120610        MOVE WA-ADV-NAME-1 TO WA-SAVE-NAME-1
120620        MOVE WA-ADV-NAME-2 TO WA-SAVE-NAME-2.
120650* SPR 730232  E------E
120670 L199-EXIT.
120680     EXIT.
120700***** SPR 760338 / HGC *****
120710 L150-GET-PREV-SOP.
NR2001*NR0001     MOVE SPACES                 TO DBIO-CALL-PARAM.
NR2001*120720     MOVE 0                      TO DBIO-CALL-REFER-AREA.
NR2001*120730     MOVE 01                     TO DBIO-CALL-TXN-TYPE.
NR2001*120740     MOVE "BOR"                  TO DBIO-CALL-SYS-AREA.
NR2001*120750     MOVE STRT-AREA-SOC-NO       TO WA-BORM-SOC-NO.
NR2001*120760     MOVE BORM-MEMB-CUST-AC      TO WA-BORM-ACCT-NO.
NR2001*120770     MOVE WA-BORM-KEY            TO DBIO-CALL-KEY-AREA.
NR2001*120780     MOVE 07                     TO DBIO-CALL-FUNC.
NR2001*120790     MOVE "N"    TO WA-13500-FOUND-SW  WA-END-OF-SEARCH-SW.
NR2001*120800     PERFORM  L155-DBIO-READ-BORV-13500  THRU  L1559-EXIT
NR2003*NR2001     INITIALIZE UTBOCTCA-CALL-AREA.
NR2003*NR2001     MOVE STRT-AREA-SOC-NO  TO BOCT-INST-NO.
NR2003*NR2001     MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO.
NR2003*NR2001     MOVE 0                 TO BOCT-REC-NO.
NR2003*NR2001     MOVE 999999999         TO BOCT-TRN-DATE.
NR2003*NR2001     MOVE 1                 TO UTBOCTCA-KEY-NO.
NR2003*NR2001     SET  UTBOCTCA-READNEXT TO TRUE.
NR2003*NR2001     MOVE 01                TO WS-BOCT-TRAN-TYPE.
NR2003*NR2001     MOVE "N"    TO WA-13500-FOUND-SW  WA-END-OF-SEARCH-SW.
NR2003*NR2001     PERFORM  L155-DBIO-READ-BOCT-13500  THRU  L1559-EXIT.
TB0082**--
           IF BORP-PRIORITY-TERM-BY-TERM
              PERFORM GET-PREV-DUE-DATE
                 THRU GET-PREV-DUE-DATE-EXIT
      **-- in the future BOIS-PREV-DUE-DATE will be used
              IF BORM-STAT        > 05 AND
                 WA-PREV-DUE-DATE > ZEROES
S17755        AND (NOT BORP-ILOAN-R)
                 MOVE WA-PREV-DUE-DATE       TO WA-PREV-SOP-DATE
              ELSE
                 MOVE BORM-APPLIC-ISSUE-DATE TO WA-PREV-SOP-DATE
              END-IF
           ELSE
TB0082**-- base version
NR2003        INITIALIZE UTBOCTCA-CALL-AREA
NR2003        MOVE STRT-AREA-SOC-NO  TO BOCT-INST-NO
NR2003        MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO
NR2003        MOVE 0                 TO BOCT-REC-NO
NR2003        MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE
NR2003        MOVE 1                 TO UTBOCTCA-KEY-NO
NR2003        SET  UTBOCTCA-READNEXT TO TRUE
NR2003        MOVE 01                TO WS-BOCT-TRAN-TYPE
NR2003        MOVE "N"    TO WA-13500-FOUND-SW  WA-END-OF-SEARCH-SW
NR2003        PERFORM  L155-DBIO-READ-BOCT-13500  THRU  L1559-EXIT
120820        IF WA-88-13500-FOUND
NR2001*120830           MOVE BORV-01-TRN-DATE   TO WA-PREV-SOP-DATE
NR2001           MOVE BOCT-TRN-DATE       TO WA-PREV-SOP-DATE
120840        ELSE
120850           MOVE BORM-INT-START-DATE TO WA-PREV-SOP-DATE
TB0082        END-IF
120860     END-IF.
120870 L159-EXIT.
120880     EXIT.
120900***** SPR 760338 / HGC *****
NR2001*120910 L155-DBIO-READ-BORV-13500.
NR2001*120920     MOVE SPACES              TO DBIO-CALL-STATUS.
NR2001*120930     CALL "DBIO"   USING         DBIO-CALL-PARAM
NR2001*120940                                 DBIO-CALL-SYS-AREA
NR2001*120950                                 DBIO-CALL-KEY-AREA
NR2001*120960                                 DBIO-CALL-STATUS
NR2001*120970                                 BORV-RECORD-AREA
NR2001*120980                                 DBIO-CALL-REFER-AREA
NR2001*120990                                 DBIO-CALL-TXN-TYPE-AREA.
NR2001*121000     IF  DBIO-CALL-STATUS NOT = "****"
NR2001*121010         IF DBIO-CALL-STATUS  =  "XCOT"
NR2001*121020           MOVE  "Y"  TO  WA-END-OF-SEARCH-SW
NR2001*121030         ELSE
NR2001*121040           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*121050           MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*121060           STRING "BR0000:(W100) PROBLEM WHILE READING BORV "
NR2001*121070                   WA-INPUT-KEY
NR2001*121080               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*121090           CALL "UT8500" USING
NR2001*121100                            UT8500CA-AREA
NR2001*121110           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*121120           MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*121130           STRING DBIO-CALL-STATUS
NR2001*121140               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*121150           CALL "UT8500" USING
NR2001*121160                            UT8500CA-AREA
NR2001*121170         END-IF
NR2001*121180     ELSE
NR2001*121190         IF BORV-01-TRN-CODE  =  13500 OR
NR2001*121200            BORV-01-TRN-CODE  =  13501
NR2001*121210            MOVE "Y"  TO  WA-13500-FOUND-SW
NR2001*121220            MOVE "Y"  TO  WA-END-OF-SEARCH-SW
NR2001*121230         END-IF
NR2001*121240     END-IF.
NR2001*121250 L1559-EXIT.
NR2001*121260     EXIT.
NR2001 L155-DBIO-READ-BOCT-13500.
NR2001     MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO.
NR2001     MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO.
NR2001     MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO.
NR2001     MOVE BOCT-TRN-DATE       TO UTBOCTCA-CALL-DATE.
NR2001     MOVE 1                   TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT   TO TRUE.
NR2001     CALL "UTBOCT"         USING UTBOCTCA-CALL-AREA
NR2001                                 BOCT-RECORD-AREA.
NR2001     IF NOT UTBOCTCA-OK
NR2001        IF UTBOCTCA-EOF
NR2001           MOVE  "Y"  TO  WA-END-OF-SEARCH-SW
NR2001        ELSE
NR2001           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001           MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001           STRING "BR0000:(L155) PROBLEM WHILE READING BOCT "
NR2001                  ", CALLCODE=" UTBOCTCA-CALL-CODE
NR2001                  ", STATUS="   UTBOCTCA-STATUS
NR2001                  ", CALLKEY="  UTBOCTCA-CALL-KEY
NR2001               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001           CALL "UT8500" USING
NR2001                            UT8500CA-AREA
NR2001           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001           MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001           STRING DBIO-CALL-STATUS
NR2001               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001           CALL "UT8500" USING
NR2001                           UT8500CA-AREA
NR2001           MOVE  "Y"  TO  WA-END-OF-SEARCH-SW
NR2001        END-IF
NR2001     ELSE
NR2001        IF BOCT-TRAN-TYPE NOT = WS-BOCT-TRAN-TYPE
NR2001           GO TO L155-DBIO-READ-BOCT-13500
NR2001        ELSE
NR2001           IF BOCT-TRN-CODE  =  13500 OR
NR2001              BOCT-TRN-CODE  =  13501
NR2001              MOVE "Y"  TO  WA-13500-FOUND-SW
NR2001              MOVE "Y"  TO  WA-END-OF-SEARCH-SW
NR2001           END-IF
NR2001        END-IF
NR2001     END-IF.
NR2001 L1559-EXIT.
NR2001     EXIT.
121270*************************************************************
121280***   HERE IT CHECKS THE CHEQUE CLEARANCE CODE AND
121290***   TRANSLATES IT INTO EQUIVALENT DAYS
121300*************************************************************
121310 L200-TRANSLATE-DAYS.
121330     MOVE WA-REPAY-CLEAR-CODE TO WA-CLRD-CODE.
121340     MOVE 0 TO WA-TRANSLATED-CLEAR-DAYS
121350     IF NOT WA-CASH-REPAY-TRCODE
121360        AND NOT WA-CREDIT-REPAY-TRCODE                                    *800028
121370     PERFORM L210-TRANSLATE-CLEAR-DAYS.
121380     IF WA-OUTPUT-ERR-MSG-NO = ZERO
121390        MOVE WA-CLRD-CODE  TO WA-OUTPUT-CLEAR-CODE
121400                              WA-REPAY-CLEAR-CODE
121410        MOVE WA-TRANSLATED-CLEAR-DAYS TO ST-CHQ-CLEAR-DAYS
121420        MOVE WA-REPAY-DEFER-DAYS TO WA-CLRD-CODE-9
121430        PERFORM L220-TRANSLATE-DEFER-DAYS
121440        MOVE WA-TRANSLATED-DEFER-DAYS TO WA-DEFER-DAYS
121450     END-IF.
121470 L299-EXIT.
121480     EXIT.
121510 L210-TRANSLATE-CLEAR-DAYS.
121520*******************************************
121530*** INPUT PARAMETER IS WA-CLRD-CODE.
121540*** RETURNS WA-TRANSLATED-CLEAR-DAYS
121550***   AND EDITED WA-CLRD-CLRD.
121560*******************************************
121580     PERFORM L280-EDIT-VALIDATE-CODE
121590     IF WA-OUTPUT-ERR-MSG-NO = ZERO
121600        MOVE STRT-AREA-SOC-NO   TO UTCLRDCA-INST-NO
121610        MOVE WA-CLRD-CODE       TO UTCLRDCA-CODE
121620        SET UTCLRDCA-CLR-IND  TO TRUE
121630        PERFORM L290-READ-CLRD-RECORD
121640        MOVE UTCLRDCA-NUMBER-DAYS TO WA-TRANSLATED-CLEAR-DAYS
121650     END-IF
121660 .
121690 L220-TRANSLATE-DEFER-DAYS.
121700*******************************************
121710*** INPUT PARAMETER IS WA-CLRD-CODE.
121720*** RETURNS WA-TRANSLATED-DEFER-DAYS.
121730*******************************************
121740     IF WA-CLRD-CODE-9 NUMERIC
121750        MOVE STRT-AREA-SOC-NO  TO UTCLRDCA-INST-NO
121760        MOVE WA-CLRD-CODE-9    TO UTCLRDCA-CODE-9
121770        SET  UTCLRDCA-DFR-IND    TO TRUE
121780        PERFORM L290-READ-CLRD-RECORD
121790        MOVE UTCLRDCA-NUMBER-DAYS TO WA-TRANSLATED-DEFER-DAYS
121800     ELSE
121810        MOVE 1 TO WA-MSG-ERR-FLAG
121820        MOVE 181 TO WA-OUTPUT-ERR-MSG-NO
121830     END-IF
121840 .
121870 L280-EDIT-VALIDATE-CODE.
121880***************************************************
121890***  IF CODE IS SPACES RETURN ERROR, OTHERWISE
121900***  FORMAT THE CODE IN PREPARATION FOR READ.
121910***************************************************
121920     IF WA-CLRD-CODE = SPACES
121930        MOVE 181 TO WA-OUTPUT-ERR-MSG-NO
121940        MOVE 1 TO WA-MSG-ERR-FLAG
121950     ELSE
121960        IF  WA-CLRD-CODE-2 = SPACE
121970            MOVE WA-CLRD-CODE-1 TO WA-CLRD-CODE-2
121980            MOVE SPACE          TO WA-CLRD-CODE-1
121990        END-IF
122000        IF  WA-CLRD-CODE-2 IS NUMERIC
122010        AND WA-CLRD-CODE-1  = SPACE
122020            MOVE ZERO  TO WA-CLRD-CODE-1
122030        END-IF
122040     END-IF
122050 .
122080 L290-READ-CLRD-RECORD.
122090***************************************************
122100***  SET UP CLRD-KEY PRIOR TO CALL.  INTERROGATE
122110***  CLRD-AREA AFTER CALL.
122120***************************************************
122140     SET UTCLRDCA-SEARCH TO TRUE.
122150     CALL "UTCLRD" USING
122160                   UTCLRDCA-CALL-AREA.
122180     IF UTCLRDCA-STATUS NOT = 0
122190        MOVE 181 TO WA-OUTPUT-ERR-MSG-NO
122200        MOVE 1 TO WA-MSG-ERR-FLAG.
122230/
122240 L300-SET-ATM-FLAG.
122250* 760167 REPLACE EFT INTERFACE:
122260*      IF  STRT-AREA-TRN-NO = 12121 OR 12131
122270*          GO TO L310-SET.
122280*    IF  STRT-AREA-TRN-NO = 12120
122290*        IF  BORM-ATM-FLAG = "9"
122300*            NEXT SENTENCE
122310*        ELSE
122320*            MOVE "1"                TO BORM-ATM-FLAG
122330*    ELSE
122340*        MOVE SPACE              TO BORM-ATM-FLAG.
122350*L310-SET.
122360*
122370     IF STRT-AREA-TRN-NO = 12120
122380        PERFORM L230-CREATE-CROSS-REF THRU L239-EXIT
122390        IF WA-MSG-ERR-FLAG NOT = 0
122400           GO TO L399-EXIT.
122410*S10745 IF STRT-AREA-TRN-NO = 12130 OR 12131
122420*S10745 IF STRT-AREA-TRN-NO = 12130
122430*S10745    MOVE " " TO BORM-ATM-FLAG
122440*S10745 ELSE
122450*S10745    IF BORM-ATM-FLAG = "9"
122460*S10745       NEXT SENTENCE
122470*S10745    ELSE
122480*S10745       MOVE "1" TO BORM-ATM-FLAG.
122490     IF WA-MSG-ERR-FLAG = 0
122500        PERFORM M030-WRITE-MASTER-RECORD
122510        IF WA-MSG-ERR-FLAG NOT = 0
122520           GO TO L399-EXIT.
122530**    MOVE 1 TO EI0085CA-BYPASS-ATM-CHK.
TB0226     MOVE 1 TO MI0095CA-BYPASS-ATM-CHK.
122540     PERFORM M1200-CAP-BAL-DTLS THRU M1299-EXIT.
122550     IF WA-MSG-ERR-FLAG NOT = 0
122560        GO TO L399-EXIT.
122570     IF NOT STRT-AREA-EFT-TXN
122580        MOVE 0 TO WA-OUTPUT-ERR-MSG-NO
122590        PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
122600 L399-EXIT.
122610     EXIT.
122620/
122630 L400-GET-ELAPSE-DAYS.
122640     IF WA-INPUT-PARAM-TABLE(8)    =  1
122650        MOVE WA-STORE-TXN-DT        TO UT0020-BINARY-DATE
122660     ELSE
122670        MOVE STRT-AREA-POST-DT      TO UT0020-BINARY-DATE.
122680     MOVE 2                        TO UT0020-FUNCTION.
122690     PERFORM X600-UT0020-PARA THRU X609-EXIT.
122700     MOVE 2                        TO UT0310CA-CALL-FUNC.
122710     MOVE SOC-CHQ-CLEAR-METH       TO UT0310CA-CALENDAR-METHOD.
122720****ANZ061
122730     MOVE ZERO                     TO UT0310CA-CALENDAR-CODE.
122740****ANZ061
122750*    MOVE ACCT-PARM-CALENDAR-CODE  TO UT0310CA-CALENDAR-CODE.
122760     MOVE UT0020-DATE-CCYYMMDD TO UT0310CA-CALENDAR-IN-CCYYMMDD.
122770*----MIC001-----START--------------------------------------------
122780     MOVE STRT-AREA-SOC-NO     TO UT0310CA-SOC-NO
122790*----MIC001-----END----------------------------------------------
122800     CALL "UT0310"  USING
122820                                      UT0310CA-REC.
122830     IF UT0310CA-CALL-STATUS  NOT    =  0
122840        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
122850        MOVE SPACES TO UT8500CA-INPUT-MSG
122860        STRING "BR0000:(L400) INVALID DATE FOR UT0310 CALL ON "
122870                 UT0020-DATE-CCYYMMDD
122880            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
122890        CALL "UT8500" USING
122910                            UT8500CA-AREA
122920        MOVE UT0310CA-DAYS           TO UT0310CA-ELAPSE-DAYS.
122930*
122940 L499-EXIT.
122950     EXIT.
122960*
122970/
122980*************************************************************
122990*** FOR CORRECTION ,HERE IT VERIFIES THIS TRX WITH OLD*****
123000*** TRX ,SENDS ERROR IF IT IS NOT FOUND                 *****
123010*************************************************************
123020 L500-VERIFY-OLD-TRN.
123030*
123040******730033****
123050     MOVE "N"                    TO WA-TRN-MATCH-FOUND.
123060*&&&*PERFORM B900-CHECK-IF-TO-APPLY-CHARGES THRU B999-EXIT
123070*&&&*IF WA-MSG-ERR-FLAG = 1
123080*&&&*    GO TO L599-EXIT.
123090*    COMPUTE   WA-CORR-AMT-2  =  WA-DUMMY-AMT
123100*                             +  CS0000RA-TOT-HOW-APPLY-3
123110****730033****AT THE MOMENT THERE IS NO WAY TO KNOW THE
123120*CHARGE/REBATE CALCUATED WITH HOW=3. SO INPUT AMOUNT IS
123130* TO BE COMPARE DIRECTLY WITH THE TXN HISTORY RECORD
123140*&&&*   THE ABOVE COMMENTS BECOME NULL AND VOID WITH SPR733420
NR2001*123160     MOVE 0                      TO DBIO-CALL-REFER-AREA.
NR2001*NR0001     MOVE SPACES                 TO DBIO-CALL-SAVE-REFER.
NR2001*123170     MOVE 01                     TO DBIO-CALL-TXN-TYPE.
NR2001*123180     MOVE "BOR"                  TO DBIO-CALL-SYS-AREA.
NR2001*123190     MOVE STRT-AREA-SOC-NO       TO WA-BORM-SOC-NO.
NR2001*123200     MOVE BORM-MEMB-CUST-AC      TO WA-BORM-ACCT-NO.
NR2001*123210     MOVE WA-BORM-KEY            TO DBIO-CALL-KEY-AREA.
NR2001*123220     MOVE 07                     TO DBIO-CALL-FUNC.
NR2001     INITIALIZE UTBOCTCA-CALL-AREA.
NR2001     MOVE STRT-AREA-SOC-NO       TO BOCT-INST-NO.
NR2001     MOVE BORM-MEMB-CUST-AC      TO BOCT-ACCT-NO.
NR2001     MOVE 0                      TO BOCT-REC-NO.
NR2003*NR2001     MOVE 999999999              TO BOCT-TRN-DATE.
S17770*NR2003     IF  WA-INPUT-PARAM-TABLE(8)  =  1
S17770*NR2003         MOVE WA-STORE-TXN-DT    TO BOCT-TRN-DATE
S17770*NR2003     ELSE
NR2003         MOVE STRT-AREA-POST-DT  TO BOCT-TRN-DATE
S17770*NR2003     END-IF.
NR2001     MOVE 1                      TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT      TO TRUE.
NR2001     MOVE 01                     TO WS-BOCT-TRAN-TYPE.
123230     MOVE SPACES                 TO WA-TRN-MATCH-FOUND.
123240     PERFORM L600-MATCH-TRN-PARA
123250        THRU L699-EXIT.
TB0099     IF STRT-AREA-TRN-NO = 13131
SC2345        MOVE BUCV-REPAY-PRN-RECALC TO WA-REPAY-PRIN-RECALC
TB0099        IF WA-REPAY-PRIN-RECALC = "1"
TB0099           MOVE 0 TO WA-ADV-CHQ-NO
TB0099                     WA-PAID-TERM-CORR
TB0099                     WA-REPAY-AMT-TMP-CORR
TB0099                     WA-REPAY-AMT-TMP1-CORR
TB0099                     WA-REM-TERM-CORR
TB0099                     WA-NEXT-TERM-CORR
TB0099           MOVE WA-TMP-REM-REPAYS TO BORM-REM-REPAYS
TB0099           COMPUTE WA-PAID-TERM-CORR = BORM-LOAN-TRM -
TB0099                                  BORM-REM-REPAYS
TB0099           COMPUTE WA-REPAY-AMT-TMP-CORR = (WA-REPAY-AMOUNT /
TB0099                                       BORM-DUE-AMT)
TB0099           COMPUTE WA-REPAY-AMT-TMP1-CORR ROUNDED =
TB0099                           WA-REPAY-AMT-TMP-CORR * 1
TB0099           COMPUTE WA-REM-TERM-CORR ROUNDED =
TB0099              (WA-REPAY-AMT-TMP1-CORR + BORM-REM-REPAYS)
TB0099           COMPUTE WA-NEXT-TERM-CORR = BORM-LOAN-TRM -
TB0099                                 WA-REM-TERM-CORR
TB0099           MOVE WA-REM-TERM-CORR TO BORM-REM-REPAYS
TB0099           MOVE WA-NEXT-TERM-CORR TO BOIS-LAST-TERM-PAID
TB0099        ELSE
TB0099           IF WA-REPAY-PRIN-RECALC = "2"
TB0099              MOVE 0 TO WA-DUE-AMT
TB0099                        WA-REM-TERM
TB0099                        WA-DUE-DAYS
TB0099                        WA-DUE-DAYS-P
TB0099                        WA-DUE-DAYS-R
TB0099                        WA-DUE-DAYS-TMP
TB0099                        WA-DUE-DAYS-TMP1
TB0099                        WA-DUE-DAYS-TMP2
TB0099              MOVE 1 TO WA-REM-TERM-TMP
TB0099              MOVE WA-TMP-REM-REPAYS TO BORM-REM-REPAYS
TB0099              MOVE WA-TMP-LST-TERM-PAID TO BOIS-LAST-TERM-PAID
TB0099              MOVE WA-BOIS-LST-ADV-DTE TO BOIS-LAST-ADV-PYMT-DATE
TB0099              MOVE BORM-REM-REPAYS TO WA-REM-TERM
TB0099              MOVE BORM-INT-RATE TO WA-INT-RATE-TMP
TB0099              COMPUTE WA-INT-RATE-TMP = WA-INT-RATE-TMP * .01
TB0099              COMPUTE WA-DUE-DAYS  = (WA-INT-RATE-TMP * 30) /
TB0099                          BORP-INT-DAYS-YR
TB0099              COMPUTE WA-DUE-DAYS-P ROUNDED = WA-DUE-DAYS  * 1
TB0099              COMPUTE WA-DUE-DAYS-R ROUNDED = WA-DUE-DAYS-P  * 1
TB0099              COMPUTE WA-DUE-DAYS-TMP = 1 / (1 + WA-DUE-DAYS-R)
TB0099              MOVE WA-DUE-DAYS-TMP TO WA-DUE-DAYS-TMP1
TB0099              PERFORM S550E-LOAN-REPAY-COMP THRU S550E-EXIT
TB0099                   UNTIL WA-REM-TERM = WA-REM-TERM-TMP
TB0099  
TB0099              COMPUTE WA-DUE-DAYS-TMP2 = ((1 - WA-DUE-DAYS-TMP1)
TB0099                                  /  WA-DUE-DAYS-R)
TB0099              MOVE BORM-LOAN-BAL TO WA-LOAN-BAL
TB0099              ADD WA-REPAY-AMOUNT TO WA-LOAN-BAL
TB0099              COMPUTE WA-DUE-AMT-TEMP = WA-LOAN-BAL /
TB0099                                WA-DUE-DAYS-TMP2
TB0099              MOVE WA-DUE-AMT-TEMP TO BORM-DUE-AMT
TB0099           END-IF
TB0099        END-IF
TB0099     END-IF.
123260     IF  WA-TRN-MATCH-FOUND = "Y"
123270         GO TO L599-EXIT.
123280     IF  WA-TRN-MATCH-FOUND = "C"
123290         MOVE 598                TO WA-OUTPUT-ERR-MSG-NO
123300         MOVE 1                  TO WA-MSG-ERR-FLAG
123310         GO TO L599-EXIT.
SC7018     IF  WA-TRN-MATCH-FOUND = "E"                            
SC7018         MOVE 4764               TO WA-OUTPUT-ERR-MSG-NO     
SC7018         MOVE 1                  TO WA-MSG-ERR-FLAG          
SC7018         GO TO L599-EXIT                                     
SC7018     END-IF.                                                 
123320     MOVE 132                    TO WA-OUTPUT-ERR-MSG-NO.
123330     MOVE 1                      TO WA-MSG-ERR-FLAG.
123340 L599-EXIT.
123350     EXIT.
NR2001*123360 L600-MATCH-TRN-PARA.
NR2001*123370     IF  STRT-AREA-OTHER-OVERRIDE = "7"
NR2001*123380         GO TO L699-EXIT.
NR2001*123390     MOVE SPACES                 TO DBIO-CALL-STATUS.
NR2001*123400     CALL "DBIO" USING
NR2001*
NR2001*123420
NR2001*123430                                 DBIO-CALL-PARAM
NR2001*123440                                 DBIO-CALL-SYS-AREA
NR2001*123450                                 DBIO-CALL-KEY-AREA
NR2001*123460                                 DBIO-CALL-STATUS
NR2001*123470                                 BORV-RECORD-AREA
NR2001*123480                                 DBIO-CALL-REFER-AREA
NR2001*123490                                 DBIO-CALL-TXN-TYPE-AREA.
NR2001*123500     IF  DBIO-CALL-STATUS NOT = "****"
NR2001*123510       IF WA-TRN-MATCH-FOUND = SPACES
NR2001*123520         MOVE "N"                TO WA-TRN-MATCH-FOUND
NR2001*123530         GO TO L699-EXIT
NR2001*123540       ELSE
NR2001*123550         GO TO L699-EXIT.
NR2001*TB0099     MOVE 0 TO WA-ADV-CHQ-NO.
NR2001*123560     MOVE BORV-01-TRN-CODE       TO WA-DUMMY-TRN-NO-1.
NR2001*123570     IF WA-DUMMY-TRN-NO-41 = 1
NR2001*123580         GO TO L600-MATCH-TRN-PARA.
NR2001*123590     MOVE STRT-AREA-TRN-NO    TO WA-DUMMY-TRN-NO-2.
NR2001*123600     MOVE BORV-01-AMOUNT TO WA-STORE-AMOUNT.
NR2001*123610     IF  WA-INPUT-PARAM-TABLE(8) = 1
NR2001*S10780*        IF  BORV-01-TRN-DATE = WA-STORE-TXN-DT  
NR2001*S10780*        AND WA-TRE-ACNO = BORV-01-JRNL-NO       
NR2001*S10780         IF  ( NOT BORP-YOUBE                    
NR2001*S10780         AND   BORV-01-TRN-DATE = WA-STORE-TXN-DT
NR2001*S10780         AND   WA-TRE-ACNO = BORV-01-JRNL-NO)    
NR2001*S10780         OR  ( BORP-YOUBE                        
NR2001*S10780         AND   BORV-01-TRN-DATE = WA-STORE-TXN-DT
NR2001*S10780         AND   WA-TRE-ACNO = BORV-01-JRNL-NO     
NR2001*S10780         AND   BORV-01-PROMO-NO = WA-INPUT-PROMO)
NR2001*123630             NEXT SENTENCE
NR2001*123640         ELSE
NR2001*123650             GO TO L600-MATCH-TRN-PARA
NR2001*123660     ELSE  IF  BORV-01-TRN-DATE = STRT-AREA-POST-DT
NR2001*123670               NEXT SENTENCE
NR2001*123680           ELSE GO TO L600-MATCH-TRN-PARA.
NR2001*SC7018     IF (BORV-01-CODE = 01 OR 25)                                                
NR2001*SC7018     AND BORV-01-TRN-DATE = STRT-AREA-POST-DT                             
NR2001*SC7018     AND WA-TRE-ACNO NOT  = BORV-01-JRNL-NO                               
NR2001*SC7018     AND NOT (((BORV-01-STATUS > 19) AND (BORV-01-STATUS < 40))           
NR2001*SC7018         OR   ((BORV-01-STATUS > 69) AND (BORV-01-STATUS < 90)))          
NR2001*SC7018           MOVE BORV-01-TRN-CODE      TO LINK-IN-TXCODE                   
NR2001*SC7018           PERFORM X700-CALL-UT0250 THRU X799-EXIT                        
NR2001*SC7018           IF WA-MSG-ERR-FLAG = 0                                         
NR2001*SC7018              MOVE LINK-EDIT-MASK     TO FIELD-B                          
NR2001*SC7018              CALL "UT0022"        USING PUAREA                           
NR2001*SC7018              MOVE FIELD-A            TO WA-BIT-MASK                      
NR2001*SC7018              IF WA-BIT(7) NOT = 1                                        
NR2001*SC7018                 MOVE "E"             TO WA-TRN-MATCH-FOUND               
NR2001*SC7018                 GO TO L699-EXIT                                          
NR2001*SC7018              END-IF                                                      
NR2001*SC7018           END-IF                                                         
NR2001*SC7018     END-IF.                                                              
NR2001*123690     IF  WA-STORE-AMOUNT = WA-REPAY-AMOUNT
NR2001*123700*MATCH ALL EXCEPT FOURTH BYTE
NR2001*123710         AND WA-DUMMY-TRN-NO-11 = WA-DUMMY-TRN-NO-12
NR2001*123720         AND WA-DUMMY-TRN-NO-21 = WA-DUMMY-TRN-NO-22
NR2001*123730         AND WA-DUMMY-TRN-NO-31 = WA-DUMMY-TRN-NO-32
NR2001*123740         AND WA-DUMMY-TRN-NO-51 = WA-DUMMY-TRN-NO-52
NR2001*123750         AND WA-DUMMY-TRN-NO-61 = WA-DUMMY-TRN-NO-62
NR2001*123760         NEXT SENTENCE
NR2001*123770     ELSE
NR2001*ST0049       IF  WA-STORE-AMOUNT = WA-REPAY-AMOUNT
NR2001*ST0049       AND BORP-YOUBE
NR2001*ST0049       AND WA-DUMMY-TRN-NO-11 = WA-DUMMY-TRN-NO-12
NR2001*ST0049       AND WA-DUMMY-TRN-NO-21 = WA-DUMMY-TRN-NO-22
NR2001*ST0049       AND WA-DUMMY-TRN-NO-51 = WA-DUMMY-TRN-NO-52
NR2001*ST0049       AND WA-DUMMY-TRN-NO-61 = WA-DUMMY-TRN-NO-62
NR2001*ST0049           NEXT SENTENCE
NR2001*ST0049       ELSE
NR2001*123780*
NR2001*123790         IF (BORM-CAPN-METHOD = "B" OR
NR2001*123800                  (BORM-CAPN-METHOD = " " AND
NR2001*123810                   BORP-CAPN-METHOD = "B"))   AND
NR2001*123820            BORM-REPAY-FREQ = 98 AND
NR2001*123830            BORP-CAPN-FREQ  = 98 AND
NR2001*123840            BORP-ACCRUE-METHOD = "D" AND
NR2001*123850*MATCH ALL EXCEPT FOURTH BYTE
NR2001*123860            WA-DUMMY-TRN-NO-11 = WA-DUMMY-TRN-NO-12 AND
NR2001*123870            WA-DUMMY-TRN-NO-21 = WA-DUMMY-TRN-NO-22 AND
NR2001*123880            WA-DUMMY-TRN-NO-31 = WA-DUMMY-TRN-NO-32 AND
NR2001*123890            WA-DUMMY-TRN-NO-51 = WA-DUMMY-TRN-NO-52 AND
NR2001*123900            WA-DUMMY-TRN-NO-61 = WA-DUMMY-TRN-NO-62
NR2001*123910               NEXT SENTENCE
NR2001*123920     ELSE
NR2001*123930** TXN CODE 12422 IS CHANGED TO 11055 IF LOAN IS TO BE ADVANCED SO
NR2001*123940** WHEN CORRECTING WE NEED TO SEARCH FOR THIS
NR2001*123950       IF  STRT-AREA-TRN-NO = 12522
NR2001*123960*       AND BORV-01-TRN-CODE = 11055                                  TB0267
NR2001*TB0267**     AND (BORV-01-TRN-CODE = 11055 OR 14055)
NR2001*SC7091**     AND (BORV-01-TRN-CODE = 11055 OR 19055)
NR2001*CS7091       AND (BORV-01-TRN-CODE = 11055 OR 19055 OR 14055)
NR2001*123970           NEXT SENTENCE
NR2001*123980     ELSE
NR2001*123990         GO TO L600-MATCH-TRN-PARA.
NR2001*
NR2001*124010*    IF  WA-REPAY-PROMO = BORV-01-PROMO-NO
NR2001*124020*        NEXT SENTENCE
NR2001*124030*    ELSE GO TO L600-MATCH-TRN-PARA.
NR2001*124040*
NR2001*124050* IF OFFLINE CORRECTION AND TRACER NUMBER = 0 OR IF ATM
NR2001*124060* CORRECTION THEN NO MATCH ON JOURNAL NUMBER PERFORMED
NR2001*124070*
NR2001*124080     IF  WA-TRE-ACNO  = BORV-01-JRNL-NO OR
NR2001*124090       ( WA-TRE-ACNO  = 0 AND
NR2001*124100       ( WA-INPUT-PARAM-TABLE(4) = 1 OR
NR2001*124110         WA-INPUT-PARAM-TABLE(5) = 1 ) AND
NR2001*124120         WA-INPUT-PARAM-TABLE(7) = 1   AND
NR2001*124130         STRT-AREA-ADVICE )
NR2001*124140*RET*    WA-INPUT-PARAM-TABLE(8) = 1 )
NR2001*124150      OR STRT-AREA-BATCH-TANDEM = "2"
NR2001*124160      OR STRT-AREA-EFT-TXN
NR2001*124170         NEXT SENTENCE
NR2001*124180     ELSE 
NR2001*SC1214**--Comment out these lines of code so that the procesing of correction
NR2001*SC1214**--will push thru 
NR2001*SC1214        GO TO L600-MATCH-TRN-PARA.
NR2001*TB0099**      MOVE 132 TO WA-OUTPUT-ERR-MSG-NO
NR2001*TB0099**      MOVE 1 TO WA-MSG-ERR-FLAG
NR2001*TB0099**      IF WA-MSG-ERR-FLAG = 1
NR2001*TB0099**         GO TO L699-EXIT.
NR2001*TB0099*       GO TO L600-MATCH-TRN-PARA.
NR2001*124190*ABV--------------------------------------------------------------      
NR2001*124200*    RTN TO SEE THAT ENTERED CHECK NO MATCHES THAT ON THE
NR2001*124210*       EXISTING BORV RECORD
NR2001*124220*
NR2001*124230     IF  WA-INPUT-PARAM-TABLE(17) = 1
NR2001*124240         OR STRT-AREA-TRN-NO = 12440 OR 12441
NR2001*124250         NEXT SENTENCE
NR2001*124260     ELSE
NR2001*124270     IF WA-ADV-CHQ-NO NOT = BORV-01-CHQ-DAYS
NR2001*124280        GO TO L600-MATCH-TRN-PARA.
NR2001*124290*ABV--------------------------------------------------------------      
NR2001*S11455     IF  BORP-YOUBE                                   
NR2001*S11455     AND WA-INPUT-PARAM-TABLE(5) = 1                  
NR2001*S11455     AND WA-ADV-AMORT-FLAG = "F"                      
NR2001*S11455         IF BORV-01-DAYFILE NOT = "F"                 
NR2001*S11455            MOVE "E"             TO WA-TRN-MATCH-FOUND
NR2001*S11455            GO TO L699-EXIT                           
NR2001*S11455         END-IF                                       
NR2001*S11455     END-IF.                                          
NR2001*S11455                                                      
NR2001*124300     IF ((BORV-01-STATUS > 19) AND (BORV-01-STATUS < 40)) OR
NR2001*124310        ((BORV-01-STATUS > 69) AND (BORV-01-STATUS < 90))
NR2001*124320         MOVE "C"            TO WA-TRN-MATCH-FOUND
NR2001*124330         GO TO L600-MATCH-TRN-PARA
NR2001*124340     ELSE
NR2001*124350         MOVE BORV-01-JRNL-NO TO WA-ORIG-JRNL-NO
NR2001*124360         MOVE BORV-01-TRN-CODE TO WA-ORIG-TXN-EVT
NR2001*124370         MOVE BORV-01-POST-DATE TO WA-ORIG-POST-DATE
NR2001*124380         MOVE BORV-01-POST-TIME TO WA-ORIG-POST-TIME
NR2001*124390         MOVE "Y"            TO WA-TRN-MATCH-FOUND
NR2001*124400         ADD 20              TO BORV-01-STATUS
NR2001*124410         MOVE 13             TO DBIO-CALL-FUNC
NR2001*124420         MOVE SPACES         TO DBIO-CALL-STATUS
NR2001*124430         CALL "DBIO"      USING
NR2001*
NR2001*124450                                DBIO-CALL-PARAM
NR2001*124460                                DBIO-CALL-SYS-AREA
NR2001*124470                                DBIO-CALL-KEY-AREA
NR2001*124480                                DBIO-CALL-STATUS
NR2001*124490                                BORV-RECORD-AREA
NR2001*124500                                DBIO-CALL-REFER-AREA
NR2001*124510         IF DBIO-CALL-STATUS NOT = "****"
NR2001*124520           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*124530             MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*124540             STRING "BR0000:(L600) -BORV WRITE ERROR "
NR2001*124550                     "RETURN STATUS = " DBIO-CALL-STATUS
NR2001*124560                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*124570             CALL "UT8500" USING
NR2001*
NR2001*124590                                 UT8500CA-AREA
NR2001*124600             MOVE 1          TO WA-MSG-ERR-FLAG
NR2001*124610             MOVE 155        TO WA-OUTPUT-ERR-MSG-NO
NR2001*124620             MOVE "BORV"     TO WA-DBERR-DATA-SET
NR2001*124630             MOVE DBIO-CALL-STATUS
NR2001*124640                             TO WA-DB-ERROR
NR2001*124650             GO TO L699-EXIT.
NR2001*124660     IF ((WA-INPUT-PARAM-TABLE (5) = 1)
NR2001*124670     AND (BORP-CAPN-METHOD NOT = " ")
NR2001*124680     AND (BORP-CAPN-METHOD IS ALPHABETIC))
NR2001*124690        PERFORM L700-CORRECT-COMMISSION THRU L799-EXIT.
NR2001*124700 L699-EXIT.
NR2001*124710     EXIT.
NR2001 L600-MATCH-TRN-PARA.
NR2001     IF  STRT-AREA-OTHER-OVERRIDE = "7"
NR2001         GO TO L699-EXIT.
NR2001     MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO.
NR2001     MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO.
NR2001     MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO.
NR2001     MOVE BOCT-TRN-DATE       TO UTBOCTCA-CALL-DATE.
NR2001     MOVE 1                   TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT   TO TRUE.
NR2001     CALL "UTBOCT"         USING UTBOCTCA-CALL-AREA
NR2001                                 BOCT-RECORD-AREA.
NR2001     IF NOT UTBOCTCA-OK
NR2001       IF WA-TRN-MATCH-FOUND = SPACES
NR2001         MOVE "N"                TO WA-TRN-MATCH-FOUND
NR2001         GO TO L699-EXIT
NR2001       ELSE
NR2001         GO TO L699-EXIT.
NR2003*EXIT SEARCH BOCT WHEN > WA-STORE-TXN-DT
NR2003     IF (WA-INPUT-PARAM-TABLE(8)  =  1
NR2003     AND BOCT-TRN-DATE < WA-STORE-TXN-DT)
NR2003     OR (WA-INPUT-PARAM-TABLE(8)  =  0
NR2003     AND BOCT-TRN-DATE < STRT-AREA-POST-DT)
NR2003       IF WA-TRN-MATCH-FOUND = SPACES
NR2003         MOVE "N"                TO WA-TRN-MATCH-FOUND
NR2003         GO TO L699-EXIT
NR2003       ELSE
NR2003         GO TO L699-EXIT.
S12770
S12770     IF  (STRT-AREA-TRN-NO = 11157 OR 16157)
S12770     AND BOCT-TRAN-TYPE = 20
S12770     AND BORP-CONSMR
S12770     AND BORP-REORG-CREDIT-PROD
S12770     AND BOCT-20-RISK-LEVEL = "VIR"
S12770       MOVE BOCT-20-ACCT-NO-TRF-IN TO WA-VIR-AC-FOR-REORG-AC
S12770     END-IF.
S12770
NR2001     IF BOCT-TRAN-TYPE NOT = WS-BOCT-TRAN-TYPE
NR2001        GO TO L600-MATCH-TRN-PARA
NR2001     END-IF.
NR2001     MOVE 0 TO WA-ADV-CHQ-NO.
NR2001     MOVE BOCT-TRN-CODE       TO WA-DUMMY-TRN-NO-1.
NR2001     IF WA-DUMMY-TRN-NO-41 = 1
NR2001         GO TO L600-MATCH-TRN-PARA.
NR2001     MOVE STRT-AREA-TRN-NO    TO WA-DUMMY-TRN-NO-2.
NR2001*123600     MOVE BORV-01-AMOUNT TO WA-STORE-AMOUNT.
NR2001     MOVE BOCT-01-AMOUNT TO WA-STORE-AMOUNT.
S17770*
S17770     IF (BOCT-TRAN-TYPE = 01 OR 25)
S17770     AND WA-INPUT-PARAM-TABLE(8)  =  1
S17770     AND BOCT-TRN-DATE >= WA-STORE-TXN-DT
S17770     AND BOCT-TRN-CODE    NOT = 10243
S17770     AND BOCT-TRN-CODE    NOT = 10732
S17770     AND WA-TRE-ACNO NOT  = BOCT-JRNL-NO
S17848     AND NOT BORP-YOUBE
S17770     AND NOT (((BOCT-STAT > 19) AND (BOCT-STAT < 40))
S17770         OR   ((BOCT-STAT > 69) AND (BOCT-STAT < 90)))
S17770           MOVE BOCT-TRN-CODE      TO LINK-IN-TXCODE
S17770           PERFORM X700-CALL-UT0250 THRU X799-EXIT
S17770           IF WA-MSG-ERR-FLAG = 0
S17770              MOVE LINK-EDIT-MASK     TO FIELD-B
S17770              CALL "UT0022"        USING PUAREA
S17770              MOVE FIELD-A            TO WA-BIT-MASK
S17770              IF WA-BIT(7) NOT = 1
S17770                 MOVE "E"             TO WA-TRN-MATCH-FOUND
S17770                 GO TO L699-EXIT
S17770              END-IF
S17770           END-IF
S17770     END-IF.
S17770*
NR2001     IF  WA-INPUT-PARAM-TABLE(8) = 1
NR2001*        IF  BORV-01-TRN-DATE = WA-STORE-TXN-DT  
NR2001*        AND WA-TRE-ACNO = BORV-01-JRNL-NO       
NR2001         IF  ( NOT BORP-YOUBE                    
NR2001         AND   BOCT-TRN-DATE = WA-STORE-TXN-DT
NR2001         AND   WA-TRE-ACNO = BOCT-JRNL-NO)    
NR2001         OR  ( BORP-YOUBE                        
NR2001         AND   BOCT-TRN-DATE = WA-STORE-TXN-DT
NR2001         AND   WA-TRE-ACNO = BOCT-JRNL-NO     
NR2001         AND   BOCT-01-PROMO-NO = WA-INPUT-PROMO)
NR2001             NEXT SENTENCE
NR2001         ELSE
NR2001             GO TO L600-MATCH-TRN-PARA
NR2001     ELSE  IF  BOCT-TRN-DATE = STRT-AREA-POST-DT
NR2001               NEXT SENTENCE
NR2001           ELSE GO TO L600-MATCH-TRN-PARA.
NR2001     IF (BOCT-TRAN-TYPE = 01 OR 25)                                                
NR2001     AND BOCT-TRN-DATE = STRT-AREA-POST-DT                             
NR2001     AND WA-TRE-ACNO NOT  = BOCT-JRNL-NO
NR2001     AND NOT (((BOCT-STAT > 19) AND (BOCT-STAT < 40))           
NR2001         OR   ((BOCT-STAT > 69) AND (BOCT-STAT < 90)))          
NR2001           MOVE BOCT-TRN-CODE      TO LINK-IN-TXCODE                   
NR2001           PERFORM X700-CALL-UT0250 THRU X799-EXIT                        
NR2001           IF WA-MSG-ERR-FLAG = 0                                         
NR2001              MOVE LINK-EDIT-MASK     TO FIELD-B                          
NR2001              CALL "UT0022"        USING PUAREA                           
NR2001              MOVE FIELD-A            TO WA-BIT-MASK                      
NR2001              IF WA-BIT(7) NOT = 1                                        
NR2001                 MOVE "E"             TO WA-TRN-MATCH-FOUND               
NR2001                 GO TO L699-EXIT                                          
NR2001              END-IF                                                      
NR2001           END-IF                                                         
NR2001     END-IF.                                                              
NR2001     IF  WA-STORE-AMOUNT = WA-REPAY-AMOUNT
NR2001*MATCH ALL EXCEPT FOURTH BYTE
NR2001         AND WA-DUMMY-TRN-NO-11 = WA-DUMMY-TRN-NO-12
NR2001         AND WA-DUMMY-TRN-NO-21 = WA-DUMMY-TRN-NO-22
NR2001         AND WA-DUMMY-TRN-NO-31 = WA-DUMMY-TRN-NO-32
NR2001         AND WA-DUMMY-TRN-NO-51 = WA-DUMMY-TRN-NO-52
NR2001         AND WA-DUMMY-TRN-NO-61 = WA-DUMMY-TRN-NO-62
NR2001         NEXT SENTENCE
NR2001     ELSE
NR2001       IF  WA-STORE-AMOUNT = WA-REPAY-AMOUNT
NR2001       AND BORP-YOUBE
NR2001       AND WA-DUMMY-TRN-NO-11 = WA-DUMMY-TRN-NO-12
NR2001       AND WA-DUMMY-TRN-NO-21 = WA-DUMMY-TRN-NO-22
NR2001       AND WA-DUMMY-TRN-NO-51 = WA-DUMMY-TRN-NO-52
NR2001       AND WA-DUMMY-TRN-NO-61 = WA-DUMMY-TRN-NO-62
NR2001           NEXT SENTENCE
NR2001       ELSE
S17770        IF  WA-STORE-AMOUNT = WA-REPAY-AMOUNT
S17770            AND BOIS-ARREARS-CTR = 0
S17770            AND BOIS-LAST-TERM-PAID = 0
S17770            AND (BORM-ADV-DATE = BOIS-FIRST-ADV-DATE)
S17770            AND WA-DUMMY-TRN-NO-11 = WA-DUMMY-TRN-NO-12
S17770            AND WA-DUMMY-TRN-NO-21 = WA-DUMMY-TRN-NO-22
S17770            AND WA-DUMMY-TRN-NO-51 = WA-DUMMY-TRN-NO-52
S17770            AND WA-DUMMY-TRN-NO-61 = WA-DUMMY-TRN-NO-62
S17770            NEXT SENTENCE
S17770        ELSE
NR2001*
NR2001         IF (BORM-CAPN-METHOD = "B" OR
NR2001                  (BORM-CAPN-METHOD = " " AND
NR2001                   BORP-CAPN-METHOD = "B"))   AND
NR2001            BORM-REPAY-FREQ = 98 AND
NR2001            BORP-CAPN-FREQ  = 98 AND
NR2001            BORP-ACCRUE-METHOD = "D" AND
NR2001*MATCH ALL EXCEPT FOURTH BYTE
NR2001            WA-DUMMY-TRN-NO-11 = WA-DUMMY-TRN-NO-12 AND
NR2001            WA-DUMMY-TRN-NO-21 = WA-DUMMY-TRN-NO-22 AND
NR2001            WA-DUMMY-TRN-NO-31 = WA-DUMMY-TRN-NO-32 AND
NR2001            WA-DUMMY-TRN-NO-51 = WA-DUMMY-TRN-NO-52 AND
NR2001            WA-DUMMY-TRN-NO-61 = WA-DUMMY-TRN-NO-62
NR2001               NEXT SENTENCE
NR2001     ELSE
NR2001** TXN CODE 12422 IS CHANGED TO 11055 IF LOAN IS TO BE ADVANCED SO
NR2001** WHEN CORRECTING WE NEED TO SEARCH FOR THIS
NR2001       IF  STRT-AREA-TRN-NO = 12522
NR2001*       AND BORV-01-TRN-CODE = 11055                                  TB0267
NR2001**     AND (BORV-01-TRN-CODE = 11055 OR 14055)
NR2001**     AND (BORV-01-TRN-CODE = 11055 OR 19055)
NR2001       AND (BOCT-TRN-CODE = 11055 OR 19055 OR 14055)
NR2001           NEXT SENTENCE
NR2001     ELSE
NR2001         GO TO L600-MATCH-TRN-PARA.
NR2001
NR2001*    IF  WA-REPAY-PROMO = BORV-01-PROMO-NO
NR2001*        NEXT SENTENCE
NR2001*    ELSE GO TO L600-MATCH-TRN-PARA.
NR2001*
NR2001* IF OFFLINE CORRECTION AND TRACER NUMBER = 0 OR IF ATM
NR2001* CORRECTION THEN NO MATCH ON JOURNAL NUMBER PERFORMED
NR2001*
NR2001     IF  WA-TRE-ACNO  = BOCT-JRNL-NO OR
NR2001       ( WA-TRE-ACNO  = 0 AND
NR2001       ( WA-INPUT-PARAM-TABLE(4) = 1 OR
NR2001         WA-INPUT-PARAM-TABLE(5) = 1 ) AND
NR2001         WA-INPUT-PARAM-TABLE(7) = 1   AND
NR2001         STRT-AREA-ADVICE )
NR2001*RET*    WA-INPUT-PARAM-TABLE(8) = 1 )
NR2001      OR STRT-AREA-BATCH-TANDEM = "2"
NR2001      OR STRT-AREA-EFT-TXN
NR2001         NEXT SENTENCE
NR2001     ELSE 
NR2001**--Comment out these lines of code so that the procesing of correction
NR2001**--will push thru 
NR2001        GO TO L600-MATCH-TRN-PARA.
NR2001**      MOVE 132 TO WA-OUTPUT-ERR-MSG-NO
NR2001**      MOVE 1 TO WA-MSG-ERR-FLAG
NR2001**      IF WA-MSG-ERR-FLAG = 1
NR2001**         GO TO L699-EXIT.
NR2001*       GO TO L600-MATCH-TRN-PARA.
NR2001*ABV--------------------------------------------------------------      
NR2001*    RTN TO SEE THAT ENTERED CHECK NO MATCHES THAT ON THE
NR2001*       EXISTING BORV RECORD
NR2001*
NR2001     IF  WA-INPUT-PARAM-TABLE(17) = 1
NR2001         OR STRT-AREA-TRN-NO = 12440 OR 12441
NR2001         NEXT SENTENCE
NR2001     ELSE
NR2001     IF WA-ADV-CHQ-NO NOT = BOCT-01-CHQ-DAYS
NR2001        GO TO L600-MATCH-TRN-PARA.
NR2001*ABV--------------------------------------------------------------      
NR2001     IF  BORP-YOUBE                                   
NR2001     AND WA-INPUT-PARAM-TABLE(5) = 1                  
NR2001     AND WA-ADV-AMORT-FLAG = "F"                      
NR2001         IF BOCT-01-DAYFILE NOT = "F"                 
NR2001            MOVE "E"             TO WA-TRN-MATCH-FOUND
NR2001            GO TO L699-EXIT                           
NR2001         END-IF                                       
NR2001     END-IF.                                          
NR2001                                                      
NR2001     IF ((BOCT-STAT > 19) AND (BOCT-STAT < 40)) OR
NR2001        ((BOCT-STAT > 69) AND (BOCT-STAT < 90))
NR2001         MOVE "C"            TO WA-TRN-MATCH-FOUND
NR2001         GO TO L600-MATCH-TRN-PARA
NR2001     ELSE
S12770         IF (STRT-AREA-TRN-NO = 11157 OR 16157)
S12770         AND STRT-BANCSLINK
S12770         AND BORP-CONSMR AND BORP-REORG-CREDIT-PROD
S12770             IF STRT-AREA-POST-DT NOT = BOCT-POST-DATE
S12770                MOVE "N"          TO WA-TRN-MATCH-FOUND
S12770                GO TO L699-EXIT
S12770             ELSE
S12770                MOVE WA-VIR-AC-FOR-REORG-AC
S12770                  TO VIR-AC-FOR-REORG-PROD
S12770             END-IF
S12770         END-IF
NR2001         MOVE BOCT-JRNL-NO        TO WA-ORIG-JRNL-NO
NR2001         MOVE BOCT-TRN-CODE       TO WA-ORIG-TXN-EVT
NR2001         MOVE BOCT-POST-DATE      TO WA-ORIG-POST-DATE
NR2001         MOVE BOCT-01-REPOST-TIME TO WA-ORIG-POST-TIME
NR2001         MOVE "Y"                 TO WA-TRN-MATCH-FOUND
NR2001         ADD 20                   TO BOCT-STAT
NR2001         MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO
NR2001         MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO
NR2001         MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO
NR2001         MOVE BOCT-POST-DATE      TO UTBOCTCA-CALL-DATE
NR2001         SET  UTBOCTCA-REWRITE    TO TRUE    
NR2001         CALL "UTBOCT" USING UTBOCTCA-CALL-AREA
NR2001                             BOCT-RECORD-AREA
NR2001         IF NOT UTBOCTCA-OK
NR2001           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001             MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001             STRING "BR0000:(L600) -BOCT WRITE ERROR "
NR2001                    ", CALLCODE=" UTBOCTCA-CALL-CODE
NR2001                    ", STATUS="   UTBOCTCA-STATUS
NR2001                    ", CALLKEY="  UTBOCTCA-CALL-KEY
NR2001                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001             CALL "UT8500" USING
NR2001
NR2001                                 UT8500CA-AREA
NR2001             MOVE 1          TO WA-MSG-ERR-FLAG
NR2001             MOVE 155        TO WA-OUTPUT-ERR-MSG-NO
NR2001             MOVE "BOCT"     TO WA-DBERR-DATA-SET
NR2001             MOVE UTBOCTCA-STATUS
NR2001                             TO WA-DB-ERROR
NR2001             GO TO L699-EXIT.
NR2003*TIB UNUSED
NR2003*NR2001     IF ((WA-INPUT-PARAM-TABLE (5) = 1)
NR2003*NR2001     AND (BORP-CAPN-METHOD NOT = " ")
NR2003*NR2001     AND (BORP-CAPN-METHOD IS ALPHABETIC))
NR2003*NR2001        PERFORM L700-CORRECT-COMMISSION THRU L799-EXIT.
NR2001 L699-EXIT.
NR2001     EXIT.
124720/
124730 L700-CORRECT-COMMISSION.
124740*SPR:760080:ANZ-RTFT:START------------------------------------
124750     MOVE 0                      TO WA-COMM-CORR-AMOUNT
124760*SPR:760080:ANZ-RTFT:END--------------------------------------
NR2001*124770     MOVE 0                      TO DBIO-CALL-REFER-AREA.
NR2001*NR0001     MOVE SPACES                 TO DBIO-CALL-SAVE-REFER.
NR2001*124780     MOVE 01                     TO DBIO-CALL-TXN-TYPE.
NR2001*124790     MOVE "BOR"                  TO DBIO-CALL-SYS-AREA.
NR2001*124800     MOVE STRT-AREA-SOC-NO       TO WA-BORM-SOC-NO.
NR2001*124810     MOVE BORM-MEMB-CUST-AC      TO WA-BORM-ACCT-NO.
NR2001*124820     MOVE WA-BORM-KEY            TO DBIO-CALL-KEY-AREA.
NR2001*124830*SPR:760080:ANZ-RTFT:START------------------------------------
NR2001*124840*****MOVE 06                     TO DBIO-CALL-FUNC.
NR2001*124850     MOVE 07                     TO DBIO-CALL-FUNC.
NR2001*124860*SPR:760080:ANZ-RTFT:END--------------------------------------
NR2001     INITIALIZE UTBOCTCA-CALL-AREA.
NR2001     MOVE STRT-AREA-SOC-NO  TO BOCT-INST-NO.
NR2001     MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO.
NR2001     MOVE 0                 TO BOCT-REC-NO.
NR2001     MOVE 999999999         TO BOCT-TRN-DATE.
NR2001     MOVE 1                 TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT TO TRUE.
NR2001     MOVE 01                TO WS-BOCT-TRAN-TYPE.
124870     PERFORM L710-MATCH-TRA-PARA THRU L719-EXIT.
124880 L799-EXIT.
124890      EXIT.
124900*
NR2001*124910 L710-MATCH-TRA-PARA.
NR2001*124920     MOVE SPACES                 TO DBIO-CALL-STATUS.
NR2001*124930     CALL "DBIO" USING
NR2001*
NR2001*124950                                 DBIO-CALL-PARAM
NR2001*124960                                 DBIO-CALL-SYS-AREA
NR2001*124970                                 DBIO-CALL-KEY-AREA
NR2001*124980                                 DBIO-CALL-STATUS
NR2001*124990                                 BORV-RECORD-AREA
NR2001*125000                                 DBIO-CALL-REFER-AREA
NR2001*125010                                 DBIO-CALL-TXN-TYPE.
NR2001*125020     IF  DBIO-CALL-STATUS NOT = "****"
NR2001*125030       IF WA-TRN-MATCH-FOUND = SPACES
NR2001*125040         MOVE "N"                TO WA-TRN-MATCH-FOUND
NR2001*125050         GO TO L719-EXIT
NR2001*125060       ELSE
NR2001*125070         GO TO L719-EXIT.
NR2001*125080     MOVE BORV-01-TRN-CODE       TO WA-DUMMY-TRN-NO-1.
NR2001*125090     IF WA-DUMMY-TRN-NO-41 = 1
NR2001*125100         GO TO L710-MATCH-TRA-PARA.
NR2001*125110*
NR2001*125120*SPR:760080:ANZ-RTFT:START------------------------------------
NR2001*125130*****MULTIPLY BORV-01-AMOUNT BY -1 GIVING
NR2001*125140*****         WA-COMM-CORR-AMOUNT.
NR2001*125150*SPR:760080:ANZ-RTFT:END--------------------------------------
NR2001*125160     IF  WA-INPUT-PARAM-TABLE(8) = 1
NR2001*125170         IF  BORV-01-TRN-DATE = WA-STORE-TXN-DT
NR2001*125180             NEXT SENTENCE
NR2001*125190         ELSE
NR2001*125200             GO TO L710-MATCH-TRA-PARA
NR2001*125210     ELSE  IF  BORV-01-TRN-DATE = STRT-AREA-POST-DT
NR2001*125220               NEXT SENTENCE
NR2001*125230           ELSE GO TO L710-MATCH-TRA-PARA.
NR2001*125240*    IF  WA-REPAY-PROMO = BORV-01-PROMO-NO
NR2001*125250*        NEXT SENTENCE
NR2001*125260*    ELSE GO TO L710-MATCH-TRA-PARA.
NR2001*125270*SPR:760080:ANZ-RTFT:START------------------------------------
NR2001*125280     IF BORV-01-TRN-CODE = 13509
NR2001*125290         MULTIPLY BORV-01-AMOUNT BY -1 GIVING
NR2001*125300                               WA-COMM-CORR-AMOUNT
NR2001*125310     ELSE
NR2001*125320         GO TO L710-MATCH-TRA-PARA.
NR2001*125330*SPR:760080:ANZ-RTFT:END--------------------------------------
NR2001*125340*
NR2001*125350* IF OFFLINE CORRECTION AND TRACER NUMBER = 0 OR IF ATM
NR2001*125360* CORRECTION THEN NO MATCH ON JOURNAL NUMBER PERFORMED
NR2001*125370*
NR2001*125380*RET*IF  WA-TRE-ACNO  = BORV-01-JRNL-NO
NR2001*125390*RET* OR STRT-AREA-BATCH-TANDEM = "2"
NR2001*125400*RET* OR STRT-AREA-EFT-TXN
NR2001*125410*
NR2001*125420     IF  WA-TRE-ACNO  = BORV-01-JRNL-NO OR
NR2001*125430       ( WA-TRE-ACNO  = 0 AND
NR2001*125440       ( WA-INPUT-PARAM-TABLE(4) = 1
NR2001*125450      OR WA-INPUT-PARAM-TABLE(5) = 1 )
NR2001*125460     AND WA-INPUT-PARAM-TABLE(7) = 1
NR2001*125470     AND STRT-AREA-ADVICE )
NR2001*125480      OR STRT-AREA-BATCH-TANDEM = "2"
NR2001*125490      OR STRT-AREA-EFT-TXN
NR2001*125500         NEXT SENTENCE
NR2001*125510     ELSE
NR2001*125520         GO TO L710-MATCH-TRA-PARA.
NR2001*
NR2001*125540     IF ((BORV-01-STATUS > 19) AND (BORV-01-STATUS < 40)) OR
NR2001*125550        ((BORV-01-STATUS > 69) AND (BORV-01-STATUS < 90))
NR2001*125560         MOVE "C"            TO WA-TRN-MATCH-FOUND
NR2001*125570         GO TO L710-MATCH-TRA-PARA
NR2001*125580     ELSE
NR2001*125590         MOVE BORV-01-JRNL-NO TO WA-ORIG-JRNL-NO
NR2001*125600         MOVE BORV-01-TRN-CODE TO WA-ORIG-TXN-EVT
NR2001*125610         MOVE BORV-01-POST-DATE TO WA-ORIG-POST-DATE
NR2001*125620         MOVE BORV-01-POST-TIME TO WA-ORIG-POST-TIME
NR2001*125630         MOVE "Y"            TO WA-TRN-MATCH-FOUND
NR2001*125640         ADD 20              TO BORV-01-STATUS
NR2001*125650         MOVE 13             TO DBIO-CALL-FUNC
NR2001*125660         MOVE SPACES         TO DBIO-CALL-STATUS
NR2001*125670         CALL "DBIO"      USING
NR2001*
NR2001*125690                                DBIO-CALL-PARAM
NR2001*125700                                DBIO-CALL-SYS-AREA
NR2001*125710                                DBIO-CALL-KEY-AREA
NR2001*125720                                DBIO-CALL-STATUS
NR2001*125730                                BORV-RECORD-AREA
NR2001*125740                                DBIO-CALL-REFER-AREA
NR2001*125750         IF  DBIO-CALL-STATUS NOT = "****"
NR2001*125760             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
NR2001*125770                             TO UT8500CA-CALL-CODE
NR2001*125780             MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*125790             STRING "BR0000:(L710) -BORV WRITE ERROR "
NR2001*125800                     "RETURN STATUS = " DBIO-CALL-STATUS
NR2001*125810                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*125820             CALL "UT8500" USING
NR2001*
NR2001*125840                                 UT8500CA-AREA
NR2001*125850             MOVE 1          TO WA-MSG-ERR-FLAG
NR2001*125860             MOVE 155        TO WA-OUTPUT-ERR-MSG-NO
NR2001*125870             MOVE "BORV"     TO WA-DBERR-DATA-SET
NR2001*125880             MOVE DBIO-CALL-STATUS
NR2001*125890                             TO WA-DB-ERROR.
NR2001*125900*
NR2001*125910 L719-EXIT.
NR2001*125920      EXIT.
NR2001 L710-MATCH-TRA-PARA.
NR2001     MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO.
NR2001     MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO.
NR2001     MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO.
NR2001     MOVE BOCT-TRN-DATE       TO UTBOCTCA-CALL-DATE.
NR2001     MOVE 1                   TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT   TO TRUE.
NR2001     CALL "UTBOCT"         USING UTBOCTCA-CALL-AREA
NR2001                                 BOCT-RECORD-AREA.
NR2001     IF NOT UTBOCTCA-OK
NR2001       IF WA-TRN-MATCH-FOUND = SPACES
NR2001         MOVE "N"                TO WA-TRN-MATCH-FOUND
NR2001         GO TO L719-EXIT
NR2001       ELSE
NR2001         GO TO L719-EXIT.
NR2001     IF BOCT-TRAN-TYPE NOT = WS-BOCT-TRAN-TYPE
NR2001        GO TO L710-MATCH-TRA-PARA
NR2001     END-IF.
NR2001     MOVE BOCT-TRN-CODE       TO WA-DUMMY-TRN-NO-1.
NR2001     IF WA-DUMMY-TRN-NO-41 = 1
NR2001         GO TO L710-MATCH-TRA-PARA.
NR2001*
NR2001*SPR:760080:ANZ-RTFT:START------------------------------------
NR2001*****MULTIPLY BORV-01-AMOUNT BY -1 GIVING
NR2001*****         WA-COMM-CORR-AMOUNT.
NR2001*SPR:760080:ANZ-RTFT:END--------------------------------------
NR2001     IF  WA-INPUT-PARAM-TABLE(8) = 1
NR2001         IF  BOCT-TRN-DATE = WA-STORE-TXN-DT
NR2001             NEXT SENTENCE
NR2001         ELSE
NR2001             GO TO L710-MATCH-TRA-PARA
NR2001     ELSE  IF  BOCT-TRN-DATE = STRT-AREA-POST-DT
NR2001               NEXT SENTENCE
NR2001           ELSE GO TO L710-MATCH-TRA-PARA.
NR2001*    IF  WA-REPAY-PROMO = BORV-01-PROMO-NO
NR2001*        NEXT SENTENCE
NR2001*    ELSE GO TO L710-MATCH-TRA-PARA.
NR2001*SPR:760080:ANZ-RTFT:START------------------------------------
S16081*NR2001     IF BOCT-TRN-CODE = 13509
S16081     IF BOCT-TRN-CODE = 13509  OR  13730
NR2001         MULTIPLY BOCT-01-AMOUNT BY -1 GIVING
NR2001                               WA-COMM-CORR-AMOUNT
NR2001     ELSE
NR2001         GO TO L710-MATCH-TRA-PARA.
NR2001*SPR:760080:ANZ-RTFT:END--------------------------------------
NR2001*
NR2001* IF OFFLINE CORRECTION AND TRACER NUMBER = 0 OR IF ATM
NR2001* CORRECTION THEN NO MATCH ON JOURNAL NUMBER PERFORMED
NR2001*
NR2001*RET*IF  WA-TRE-ACNO  = BORV-01-JRNL-NO
NR2001*RET* OR STRT-AREA-BATCH-TANDEM = "2"
NR2001*RET* OR STRT-AREA-EFT-TXN
NR2001*
NR2001     IF  WA-TRE-ACNO  = BOCT-JRNL-NO OR
NR2001       ( WA-TRE-ACNO  = 0 AND
NR2001       ( WA-INPUT-PARAM-TABLE(4) = 1
NR2001      OR WA-INPUT-PARAM-TABLE(5) = 1 )
NR2001     AND WA-INPUT-PARAM-TABLE(7) = 1
NR2001     AND STRT-AREA-ADVICE )
NR2001      OR STRT-AREA-BATCH-TANDEM = "2"
NR2001      OR STRT-AREA-EFT-TXN
NR2001         NEXT SENTENCE
NR2001     ELSE
NR2001         GO TO L710-MATCH-TRA-PARA.
NR2001
NR2001     IF ((BOCT-STAT > 19) AND (BOCT-STAT < 40)) OR
NR2001        ((BOCT-STAT > 69) AND (BOCT-STAT < 90))
NR2001         MOVE "C"            TO WA-TRN-MATCH-FOUND
NR2001         GO TO L710-MATCH-TRA-PARA
NR2001     ELSE
NR2001         MOVE BOCT-JRNL-NO        TO WA-ORIG-JRNL-NO
NR2001         MOVE BOCT-TRN-CODE       TO WA-ORIG-TXN-EVT
NR2001         MOVE BOCT-POST-DATE      TO WA-ORIG-POST-DATE
NR2001         MOVE BOCT-01-REPOST-TIME TO WA-ORIG-POST-TIME
NR2001         MOVE "Y"                 TO WA-TRN-MATCH-FOUND
NR2001         ADD 20                   TO BOCT-STAT
NR2001         MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO
NR2001         MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO
NR2001         MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO
NR2001         MOVE BOCT-POST-DATE      TO UTBOCTCA-CALL-DATE
NR2001         SET  UTBOCTCA-REWRITE    TO TRUE    
NR2001         CALL "UTBOCT" USING UTBOCTCA-CALL-AREA
NR2001                             BOCT-RECORD-AREA
NR2001         IF NOT UTBOCTCA-OK
NR2001             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
NR2001                             TO UT8500CA-CALL-CODE
NR2001             MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001             STRING "BR0000:(L710) -BOCT WRITE ERROR "
NR2001                    ", CALLCODE=" UTBOCTCA-CALL-CODE
NR2001                    ", STATUS="   UTBOCTCA-STATUS
NR2001                    ", CALLKEY="  UTBOCTCA-CALL-KEY
NR2001                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001             CALL "UT8500" USING
NR2001
NR2001                                 UT8500CA-AREA
NR2001             MOVE 1          TO WA-MSG-ERR-FLAG
NR2001             MOVE 155        TO WA-OUTPUT-ERR-MSG-NO
NR2001             MOVE "BOCT"     TO WA-DBERR-DATA-SET
NR2001             MOVE UTBOCTCA-STATUS
NR2001                             TO WA-DB-ERROR.
NR2001*
NR2001 L719-EXIT.
NR2001      EXIT.
125930/
125940 L800-VALIDATE-BANK-REGION.
125950*
125960* IF A CHEQUE DEPOSTI TRANSACTION, VALIDATE THE BANK AND REGION ID
125970*
125980* DEPENDING ON THE SOC-CHQ-DEP-CLEAR-TYPE FLAG VALIDATE BANK NUMBE 
125990* AND REGION ID FIELDS ON THE CHEQUE DEPOSIT SCREEN
126000* NOTE : SCO-CHQ-DEP-CLEAR-TYPE = "N" - NO VALIDATION (IGNORE)
126010*                                 "C" - CENTRAL CLEARING (IGNORE)
126020*                                 "I" - USE VALUES
126040     IF WA-MSG-ERR-FLAG = 1
126050         GO TO L899-EXIT
126060     END-IF.
126080     IF WA-INPUT-PARAM-TABLE (10) NOT = 1
126090         MOVE ZEROES              TO WA-BANK-NUMBER
126100         MOVE ZEROES              TO WA-REGION-ID
126110         GO TO L899-EXIT
126120     END-IF.
126140     IF  WS-SAVE-TXN-CURRENCY = SPACES OR SOC-NATIVE-CURRENCY
126150         MOVE SOC-NATIVE-CURRENCY  TO WA-SUSP-TYPE-CURRENCY
126160     ELSE
126170         MOVE WS-SAVE-TXN-CURRENCY TO WA-SUSP-TYPE-CURRENCY
126180     END-IF.
126200     IF SOC-CHQ-DEP-CLEAR-TYPE = "N"
126210         MOVE ZEROES              TO WA-BANK-NUMBER
126220         MOVE ZEROES              TO WA-REGION-ID
126230     ELSE
126240         IF SOC-CHQ-DEP-CLEAR-TYPE = "C"
126250             MOVE ZEROES          TO WA-SUSP-BRANCH
126260             MOVE WA-SUSP-KEY-CENTRAL TO WA-SUSP-TYPE-ID
126270             PERFORM V910-READ-SUSPENSE-MASTER THRU V919-EXIT
126280             IF WA-MSG-ERR-FLAG = 0
126290                 MOVE ZEROES      TO WA-BANK-NUMBER
126300                 MOVE ZEROES      TO WA-REGION-ID
126310             END-IF
126320         ELSE
126330             IF SOC-CHQ-DEP-CLEAR-TYPE = "I"
126340                 MOVE ZEROES             TO WA-SUSP-BRANCH
126350                 MOVE WA-REPAY-BANK-NUMBER TO WA-SUSP-BANK-NUMBER
126360                 MOVE WA-REPAY-REGION-ID TO WA-SUSP-REGION-ID
126370                 MOVE WA-SUSP-KEY-INTERP TO WA-SUSP-TYPE-ID
126380                 PERFORM V910-READ-SUSPENSE-MASTER THRU V919-EXIT
126390                 IF WA-MSG-ERR-FLAG = 0
126400                     MOVE WA-REPAY-BANK-NUMBER TO WA-BANK-NUMBER
126410                     MOVE WA-REPAY-REGION-ID TO WA-REGION-ID
126420                 END-IF
126430             ELSE
126440                 MOVE 1 TO WA-MSG-ERR-FLAG
126450                 MOVE 2105 TO WA-OUTPUT-ERR-MSG-NO
126460             END-IF
126470         END-IF
126480     END-IF.
126490 L899-EXIT.
126500     EXIT.
126510/
126520 L900-BATCH-CHECK.
126530* ADDED BY A. SERHAN FROM 3 TO 6.
126540     IF  BORM-STAT < 6
126550         MOVE 355 TO UT0060CA-CALL-ERROR-CODE
126560         PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
126570         IF WA-MSG-ERR-FLAG = 0
126580             MOVE 355 TO WA-ERR-MSG-NO
126590         ELSE
126600             MOVE 1 TO WA-MSG-ERR-FLAG
126610             MOVE 355 TO WA-OUTPUT-ERR-MSG-NO
126620         END-IF
126630         GO TO L909-EXIT
126640     END-IF.
KEY008**
KEY008***  KEYMATRIX 30 DAY LOANS - DO NOT PROCESS DISCHARGE IF FULL          
KEY008***  AMOUNT REPAID - LOANS CAN REVOLVE
KEY008**
126690     IF BORP-REPAY-SCHED = "C"
126700        GO TO L909-EXIT.
126710** 
SC1171     IF STRT-AREA-BATCH-TANDEM = "B" AND
SC8040*       STRT-AREA-TRN-NO = 16044
S11877*SC8040       (STRT-AREA-TRN-NO = 16044 OR 16045)
S11877       (STRT-AREA-TRN-NO = 16044 OR 16045 OR 11045)
SC1171        NEXT SENTENCE
SC1171     ELSE
S10464     IF STRT-AREA-BATCH-TANDEM = "B" AND
S10464        BORP-YOUBE                   AND
S10464       (BORM-STAT = 07 OR 08)
S10464        NEXT SENTENCE
S10464     ELSE
S17599     IF STRT-AREA-BATCH-TANDEM = "B" AND
S17599        BORP-YOUBE                   AND
S17599       (STRT-AREA-TRN-NO = 11030 OR 16030)
S17599        NEXT SENTENCE
S17599     ELSE
126720     IF WA-REPAY-AMOUNT NOT < BORM-LOAN-BAL
S17599     AND NOT BORP-PUBLIC-CONFER-DC
S17599     AND NOT BORP-PUBLIC-CONFER-CDC
126730         MOVE WA-REPAY-TXN-DATE TO WA-TEMP-DATE
S15418*126740  MOVE "N"     TO BORM-DISCH-FEE-CODE
126750         MOVE "N"     TO WA-DISCH-I-WAIVE-PENALTY-FLAG
126760         MOVE 0       TO WA-DISCH-I-INT-REBATE-PERC
126770         MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE
126780         MOVE 1                 TO UT0020-FUNCTION
126790         CALL "UT0020" USING
126800                                  UT0020-FUNCTION
126810                                  UT0020-DATE-AREA
126820                                  UT0020-BINARY-DATE
126830         MOVE UT0020-DATE-DDMMCCYY TO WA-DISCH-I-TRAN-DATE
126840         MOVE WA-REPAY-PROMO TO WA-DISCH-I-PROMO-CODE
126850         PERFORM N500-PROCESS-DISCHARGES THRU N599-EXIT
126860         PERFORM B3000-CHECK-LIMITS THRU B3099-EXIT
126870*
126880*  UPDATE WA-EDIT-MAST BECAUSE TRANSACTION MAY BE CHANGED FROM
126890*          BR0025
126900*
126910         MOVE STRT-AREA-PROCESS-BITS TO FIELD-B
126920         CALL "UT0022" USING PUAREA
126930         MOVE FIELD-A TO WA-EDIT-MASK
126940         IF WA-MSG-ERR-FLAG NOT = 1 AND
126950            WA-OUTPUT-ERR-MSG-NO = 0
126960             MOVE "Y"     TO WA-AUTO-DISCH-FLAG
126970             GO TO L909-EXIT
126980         END-IF
126990         MOVE WA-TEMP-DATE TO WA-REPAY-TXN-DATE
127000     END-IF.
127020 L909-EXIT.
127030     EXIT.
127040/
127050 M000-VALIDATE-ADVANCES.
S10730     IF  BORP-YOUBE                                      
S10730     AND WA-ADV-PROMO = "F9"                             
S10730     AND BORM-ACT-TYPE NOT = 7501                        
S10730         MOVE 138                 TO WA-OUTPUT-ERR-MSG-NO
S10730         MOVE 1                   TO WA-MSG-ERR-FLAG     
S10730         GO TO M000-ERR                                  
S10730     END-IF.                                             
TB0069     IF WA-INPUT-PARAM-TABLE (8) NOT = 1
TB0069        MOVE STRT-AREA-POST-DT    TO WA-ADV-DATE-BIN
TB0069     ELSE
TB0069        MOVE WA-ADV-TXN-DATE      TO UT0030-DATE-DDMMCCYY
TB0069        PERFORM X610-UT0030-PARA THRU X619-EXIT
TB0069        IF  UT0030-BINARY-DATE = ZEROES
TB0069          MOVE 126                TO WA-OUTPUT-ERR-MSG-NO
TB0069          MOVE 1                  TO WA-MSG-ERR-FLAG
TB0069          GO TO M000-ERR
TB0069        ELSE
TB0069          MOVE UT0030-BINARY-DATE TO WA-ADV-DATE-BIN.
TB0069
TB0069     MOVE "N" TO WA-NEGO-RATE-FOUND-FLAG.
TB0069     IF BORM-STAT < 6
S19771     OR (PROD-RICHART AND BOIS-FIRST-ADV-DATE = 0)
TB0069        MOVE "Y" TO WA-FIRST-ADV-FLAG
TB0069     ELSE
TB0069        MOVE "N" TO WA-FIRST-ADV-FLAG.
TB0069
TB0159
TB0159     IF BORP-YOUBE
TB0159        IF  WA-FIRST-ADV-FLAG = "Y"
SC8395        AND BOIS-START-METHOD NOT = "07"
TB0159           MOVE WA-ADV-DATE-BIN TO  UT0020-BINARY-DATE
TB0159                                    BORM-INT-START-DATE
TB0159           MOVE 1               TO  UT0020-FUNCTION
TB0159           IF UT0020-BINARY-DATE = ZEROES
TB0159              MOVE 126          TO  WA-OUTPUT-ERR-MSG-NO
TB0159              MOVE 1            TO  WA-MSG-ERR-FLAG
TB0159              GO TO M000-ERR
TB0159           ELSE
TB0159              PERFORM X600-UT0020-PARA THRU X609-EXIT
TB0159              MOVE UT0020-DATE-DDMMCCYY TO WA-ADV-DATE
TB0159           END-IF
TB0159           ADD BOIS-PREF-INT-PERIOD TO  WA-ADV-DATER-MM
TB0159           IF WA-ADV-DATER-MM > 12
TB0159              SUBTRACT 12       FROM WA-ADV-DATER-MM
TB0159              ADD      1        TO   WA-ADV-DATER-YY
TB0159           END-IF
SC1231           PERFORM B3200-PROC-DT THRU B3200-PROC-EXIT
TB0159           MOVE WA-ADV-DATE     TO  UT0030-DATE-MMDDCCYY
TB0159*          MOVE 1               TO  UT0030-FUNCTION
TB0159*          PERFORM X610-UT0030-PARA THRU X619-EXIT
SC1231           PERFORM B3100-CONV-DATE-TO-BINARY THRU B3100-CONV-EXIT
TB0159           IF UT0030-BINARY-DATE = ZEROES
TB0159              MOVE 126          TO  WA-OUTPUT-ERR-MSG-NO
TB0159              MOVE 1            TO  WA-MSG-ERR-FLAG
TB0159              GO TO M000-ERR
TB0159           ELSE
TB0159              MOVE UT0030-BINARY-DATE TO BOIS-RATE-EXP-DATE
TB0159           END-IF
TB0159        END-IF
TB0159     END-IF.
TB0159
S16668     MOVE 1                        TO WA-SUB.
S16668     MOVE BORP-PRODUCT-GROUP(WA-SUB) TO WA-PRODUCT-GROUP.
S16668     IF VALID-YOUTH-LOAN
S17255     OR VALID-POLICY-YUN
S16668        IF WA-INPUT-PARAM-TABLE (7) = 0
S16668           MOVE "2" TO BOIS-NEGO-RATE-IND
S16668        END-IF
S16668     END-IF.
TB0069     IF (BOIS-NEGO-RATE-IND = "2"
TB0069         AND  BORM-STAT < 6)
TB0069        MOVE 61                 TO DBIO-CALL-FUNC
TB0069        MOVE "NI"               TO BLDV-NI-TRAN-TYPE
TB0069        MOVE STRT-AREA-SOC-NO   TO DBIO-01-SOC-NO
TB0069        MOVE WA-INPUT-ACCT-NO   TO DBIO-01-ACCT-NO
TB0069        MOVE DBIO-01-KEY        TO DBIO-CALL-KEY-AREA
TB0069        MOVE "BORM"             TO DBIO-CALL-N-SYS
TB0069        MOVE "BLDV"             TO DBIO-CALL-SYST-VAR
TB0069        MOVE "NI"               TO DBIO-CALL-CODE-B
TB0069        MOVE 0                  TO DBIO-CALL-REFER-AREA
TB0069        MOVE SPACES             TO DBIO-CALL-STATUS
TB0069        CALL "DBIO" USING DBIO-CALL-PARAM
TB0069                          DBIO-CALL-SYS-AREA
TB0069                          DBIO-CALL-KEY-AREA
TB0069                          DBIO-CALL-STATUS
TB0069                          WA-BLDV-AREA-NI
TB0069                          DBIO-CALL-REFER-AREA
TB0069                          DBIO-CALL-TXN-TYPE-AREA
TB0069        IF DBIO-CALL-SAVE-REFER = "END."
S16668           IF VALID-YOUTH-LOAN
S17255           OR VALID-POLICY-YUN
S16668              PERFORM X800-YOUTH-LOAN-PROCESS THRU X800-EXIT
S16668              IF WA-MSG-ERR-FLAG = 1
S16668                 GO TO M000-ERR
S16668              END-IF
S16668           ELSE
TB0069              MOVE 3799             TO WA-OUTPUT-ERR-MSG-NO
TB0069              MOVE 1                TO WA-MSG-ERR-FLAG
TB0069              GO TO M000-ERR
S16668           END-IF
TB0069        ELSE
TB0069          IF DBIO-CALL-STATUS NOT = "****"
TB0069             MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
TB0069             MOVE 1                TO WA-MSG-ERR-FLAG
TB0069             MOVE "BLDV"           TO WA-OUTPUT-DATA-SET
TB0069             MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
TB0069             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0069                                   TO UT8500CA-CALL-CODE
TB0069             MOVE SPACES           TO UT8500CA-INPUT-MSG
TB0069             STRING "BR0000:(M000) READ BLDVNI ERROR"
TB0069                    ", SAVE-REFER = " DBIO-CALL-SAVE-REFER
TB0069                    ", DBIO-STAT  = " DBIO-CALL-STATUS
TB0069                    ", KEY = " DBIO-CALL-KEY-AREA
TB0069                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0069             CALL "UT8500" USING UT8500CA-AREA
TB0069             GO TO M000-ERR
TB0069          END-IF
TB0069        END-IF
TB0069
TB0069        MOVE DBIO-CALL-SAVE-REFER TO WA-REFER-X
TB0069        MOVE 1 TO WA-SUB
TB0235        IF WA-ADV-DATE-BIN < BLDV-NI-START-DATE (WA-SUB)
S17327        AND BOIS-NEGO-RATE-IND = "2"
S17755        AND NOT BORP-ILOAN-R
TB0235           MOVE 4257            TO WA-OUTPUT-ERR-MSG-NO
TB0235           MOVE 1               TO WA-MSG-ERR-FLAG
TB0235           GO TO M000-ERR
TB0235        ELSE
TB0069        IF BLDV-NI-START-DATE (WA-SUB) NOT = WA-ADV-DATE-BIN
S17327        AND BOIS-NEGO-RATE-IND = "2"
S17755        AND NOT BORP-ILOAN-R
TB0069           MOVE 3783            TO WA-OUTPUT-ERR-MSG-NO
TB0069           MOVE 1               TO WA-MSG-ERR-FLAG
TB0069           GO TO M000-ERR
TB0069        ELSE
S17327         IF BOIS-NEGO-RATE-IND = "2"
TB0069           MOVE "Y"    TO WA-NEGO-RATE-FOUND-FLAG
TB0069           MOVE WA-SUB TO WA-SUB-BLDVNI
S17327         END-IF
TB0235        END-IF
TB0069        END-IF
TB0069     END-IF.
TB0069*
TB0020**-- Multiple Drawdown will be validated before going to BR0024
           IF BORP-CONSMR
SC8128        OR BORP-CONSMR-MORT-COMBI
              IF BORP-PARTIAL-ADV-ALLOWED = "N"
SC0221*          IF BOIS-CREDIT-TYPE = "F" OR "M"
SC0221           IF BOIS-CREDIT-TYPE = "F"
                    IF BORM-ADV-VAL NOT EQUAL ZEROES
                    AND WA-ADV-AMOUNT > ZEROES
TB0020***-- 040803
TB0020              AND WA-INPUT-PARAM-TABLE (7) EQUAL ZEROES
                       MOVE 3488 TO WA-OUTPUT-ERR-MSG-NO
                       MOVE 1    TO WA-MSG-ERR-FLAG
                       GO        TO M000-ERR
                    END-IF
                 ELSE
SC0221            IF BOIS-CREDIT-TYPE NOT = "M"
S10219               IF NOT BORP-CONSMR AND 
S10219                  BOIS-CREDIT-TYPE NOT = "R"
                        MOVE 3240 TO WA-OUTPUT-ERR-MSG-NO
                        MOVE 1    TO WA-MSG-ERR-FLAG
                        GO        TO M000-ERR
S10219               END-IF
SC0221            END-IF
                 END-IF
              ELSE
                 IF BORP-PARTIAL-ADV-ALLOWED = "Y"
                    IF BOIS-CREDIT-TYPE = "F" 
                       IF BORM-ADV-VAL NOT EQUAL ZEROES
                       AND WA-ADV-AMOUNT > ZEROES
TB0020***-- 040803
TB0020                 AND WA-INPUT-PARAM-TABLE (7) EQUAL ZEROES
                          MOVE 3488 TO WA-OUTPUT-ERR-MSG-NO
                          MOVE 1    TO WA-MSG-ERR-FLAG
                          GO        TO M000-ERR
                       END-IF
                    END-IF
                 END-IF
              END-IF
           END-IF.
TB0020**--
127060     MOVE 0          TO WA-COMM-CORR-AMOUNT.
127070     MOVE WA-ADV-AMOUNT TO WA-VA-AMT.
127080     PERFORM Q000-AMOUNT-VALIDATION THRU Q009-EXIT.
127090     IF WA-MSG-ERR-FLAG = 1
127100        GO TO M000-ERR.
127110     PERFORM L100-VALIDATE-INPUT THRU L199-EXIT.
127120     IF WA-MSG-ERR-FLAG = 1
127130        GO TO M000-ERR.
127140     PERFORM N1500-CALC-INT-DUE-DT THRU N1599-EXIT.
SC8921     IF WA-STORE-TFR-SYST = "CGL"
SC8921        MOVE BORM-BR-NO TO UTVTACCA-TRANSFER-BRANCH
SC8921     END-IF.
SC9610     IF ST-LOAN-BACKDATED-CORR-YES
S11455     AND WA-ADV-AMORT-FLAG NOT = "S"
SC9610        IF WA-INPUT-PARAM-TABLE(14) = 1
SC9610           PERFORM E300-TELLER-TOT-PARA
SC9610                   THRU E399-EXIT
SC9610           IF  WA-MSG-ERR-FLAG = 1
SC9610               GO TO M000-ERR
SC9610           END-IF
SC9610        END-IF
SC9610     END-IF.
SC9759     IF STRT-AREA-TRN-NO = 11155 OR 16155
SC9759      IF (BORM-INS-IND = 2)
SC9759        AND (WA-INPUT-PARAM-TABLE(29) = 1)
SC9759        PERFORM V100-INSURANCE-PREMUIM THRU V199-EXIT
SC9759      END-IF
SC9759     END-IF
S11542     IF  BORP-YOUBE                              
S11542     AND BR0000-SYSTEM-IN-NIGHT                  
S11542     AND WA-INPUT-PARAM-TABLE(8) = 0             
S11542     AND WA-INPUT-PARAM-TABLE(7) = 0             
S11542     AND BOIS-LST-FIN-POST-DT < STRT-AREA-POST-DT
S11542         PERFORM Q300-CALC-INT-DIFF              
S11542            THRU Q300-EXIT                       
S11542     END-IF.                                     
S15988*
S15988     MOVE BORM-ACT-TYPE            TO WA-BORM-ACT-TYPE.
S15988     IF   WA-INPUT-PARAM-TABLE(5)  =  1
S15988     AND  WA-INPUT-PARAM-TABLE(7)  =  0
S15988     AND  WA-INPUT-PARAM-TABLE(25) =  0
S15988     AND  WA-ACT-TYPE-PERSONAL
S15988     AND  BORM-LOAN-OFFICER        =  STRT-AREA-TELL-NO
S16945     AND  STRT-BANCSLINK
S19269     AND NOT BORP-PB
S20771     AND NOT BORP-FBOND
S15988          MOVE 5290                TO WA-OUTPUT-ERR-MSG-NO
S15988          MOVE 1                   TO WA-MSG-ERR-FLAG
S15988          GO                       TO M000-ERR
S15988     END-IF.
S15988*
S20486     IF   WA-INPUT-PARAM-TABLE(5)  =  1
S20498     AND  WA-INPUT-PARAM-TABLE(7)  =  0
S20486     AND  WA-INPUT-PARAM-TABLE(25) =  0
S20647     AND  NOT STRT-BANCSLINK
S20486          INITIALIZE UTMLWM-CALL-PARAM
S20486          MOVE "LON"       TO UTMLWM-FUN
S20486          MOVE BORM-SOC-NO       TO UTMLWM-SOC-NO
S20486          MOVE BORM-MEMB-CUST-AC TO UTMLWM-MEMB-CUST-AC
S20486          CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20486          IF UTMLWM-CALL-STATUS = "00"
S20486             IF UTMLWM-MLWFLAG = "Y"
S20486                MOVE 1249        TO WA-OUTPUT-ERR-MSG-NO
S20486                MOVE 1           TO WA-MSG-ERR-FLAG
S20486                GO               TO M000-ERR
S20486             END-IF
S20486          END-IF
S20647          INITIALIZE UTMLWM-CALL-PARAM
S20647          MOVE "GTE"       TO UTMLWM-FUN
S20647          MOVE BORM-SOC-NO       TO UTMLWM-SOC-NO
S20647          MOVE BORM-MEMB-CUST-AC TO UTMLWM-MEMB-CUST-AC
S20647          CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20647          IF UTMLWM-CALL-STATUS = "00"
S20647             IF UTMLWM-MLWFLAG = "Y"
S20647                MOVE 1249        TO WA-OUTPUT-ERR-MSG-NO
S20647                MOVE 1           TO WA-MSG-ERR-FLAG
S20647                GO               TO M000-ERR
S20647             END-IF
S20647          END-IF
S20486     END-IF.
S20486*
127150     CALL "BR0024" USING
127160                         STARTAREA
127170                         SOC-PARAMS
127180                         BORR-PARAMS
NR2001*127190                         BORV-RECORD-AREA
NR2001                         BOCT-RECORD-AREA
127200                         WA-INT-ST-DATE
127210                         WA-COMMISSION-PASSALONG
127220                         WA-PASSALONG
127230                         WA-CS0000CA-CALL-AREA
127240                         WA-CS0000RA-RETURN-AREA
127250                         UT0270CA-AREA
127260                         W300-ERROR-AREA
127270                         CHECK-RESPONSE-AREA
127280                         MULTI-OVERRIDE-AREA
127290                         PBOOKCA-LINE-AREA
SC8085                         UTVTACCA-CALL-PARAM
TB0027                         BR0024CA-AREA 
TB0027                         BOIS-RECORD.
127300*                        BR0024CA-AREA.                            ***TB0027
S16668     IF VALID-YOUTH-LOAN
S17255     OR VALID-POLICY-YUN
S16668        IF WA-INPUT-PARAM-TABLE (7) = 1
S17327        AND BOIS-NEGO-RATE-IND = "2"
S16668           MOVE "0"             TO BOIS-NEGO-RATE-IND
S16668           MOVE 0               TO BOIS-NEGO-NEXT-RATE-DATE
S16668           MOVE 61              TO DBIO-CALL-FUNC
S16668           MOVE "NI"            TO DBIO-CALL-CODE-B
S16668           MOVE 0               TO DBIO-CALL-REFER-AREA
S16668           MOVE SPACES          TO DBIO-CALL-STATUS
S16668           PERFORM X830-RW-BLDV THRU X830-EXIT
S16668           IF  WA-MSG-ERR-FLAG = 1
S16668               GO TO M000-ERR
S16668           END-IF
S16668*          DELETE BLDVNI
S16668           PERFORM X820-ADD-AMEND-BLDV THRU X820-EXIT
S16668           IF  WA-MSG-ERR-FLAG = 1
S16668               GO TO M000-ERR
S16668           END-IF
S16668        END-IF
S16668     END-IF.
S20647     IF  STRT-BANCSLINK
S20647     AND WA-INPUT-PARAM-TABLE(5)  =  1
S20647     AND WA-INPUT-PARAM-TABLE(7)  =  0
S20647     AND WA-INPUT-PARAM-TABLE(25) =  0
S20647     AND WA-MSG-ERR-FLAG = 0
S20647        INITIALIZE UTMLWM-CALL-PARAM
S20647        MOVE "LON"       TO UTMLWM-FUN
S20647        MOVE BORM-SOC-NO       TO UTMLWM-SOC-NO
S20647        MOVE BORM-MEMB-CUST-AC TO UTMLWM-MEMB-CUST-AC
S20647        CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20647        IF UTMLWM-CALL-STATUS = "00"
S20647           IF UTMLWM-MLWFLAG = "Y"
S20647              IF BOIS-MARK-OF-NEW-ADDTL-LOANS = 1
S20647                 MOVE 1249        TO WA-OUTPUT-ERR-MSG-NO
S20647                 MOVE 1           TO WA-MSG-ERR-FLAG
S20647                 GO               TO M000-ERR
S20647              END-IF
S20647              MOVE 1248 TO UT0060CA-CALL-ERROR-CODE
S20647              PERFORM Y000-OVERRIDABLE-ERROR-CHECK
S20647              THRU Y090-EXIT
S20647              IF   WA-MSG-ERR-FLAG = 0
S20647                   MOVE 1248 TO WA-ERR-MSG-NO
S20647              ELSE
S20647                   MOVE 1248 TO WA-OUTPUT-ERR-MSG-NO
S20647                   MOVE 1    TO WA-MSG-ERR-FLAG
S20647              END-IF
S20647           END-IF
S20647        END-IF
S20647        INITIALIZE UTMLWM-CALL-PARAM
S20647        MOVE "GTE"       TO UTMLWM-FUN
S20647        MOVE BORM-SOC-NO       TO UTMLWM-SOC-NO
S20647        MOVE BORM-MEMB-CUST-AC TO UTMLWM-MEMB-CUST-AC
S20647        CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20647        IF UTMLWM-CALL-STATUS = "00"
S20647           IF UTMLWM-MLWFLAG = "Y"
S20647              IF BOIS-MARK-OF-NEW-ADDTL-LOANS = 1
S20647                 MOVE 1249        TO WA-OUTPUT-ERR-MSG-NO
S20647                 MOVE 1           TO WA-MSG-ERR-FLAG
S20647                 GO               TO M000-ERR
S20647              END-IF
S20647              MOVE 1248 TO UT0060CA-CALL-ERROR-CODE
S20647              PERFORM Y000-OVERRIDABLE-ERROR-CHECK
S20647              THRU Y090-EXIT
S20647              IF   WA-MSG-ERR-FLAG = 0
S20647                   MOVE 1248 TO WA-ERR-MSG-NO
S20647              ELSE
S20647                   MOVE 1248 TO WA-OUTPUT-ERR-MSG-NO
S20647                   MOVE 1    TO WA-MSG-ERR-FLAG
S20647              END-IF
S20647           END-IF
S20647        END-IF
S20647     END-IF.
S16100     MOVE  BOIS-PROJ-CODE         TO  WS-PROJ-CODE.
S16100     IF  BOIS-NEGO-RATE-IND        =  "2"
S16275*S16100     AND WS-SOLDIER-LOAN
S16275     AND (WS-SOLDIER-LOAN  OR  WS-CHINA-LOAN)
S16100       PERFORM VARYING WA-SUB FROM 2 BY 1
S16100         UNTIL WA-SUB > 15
S16100            OR BLDV-NI-START-DATE (WA-SUB) = 0
S16100         IF  BLDV-NI-START-DATE (WA-SUB) < BOIS-NEXT-DUE-DATE
S16100           MOVE  3783             TO  WA-OUTPUT-ERR-MSG-NO
S16100           MOVE  1                TO  WA-MSG-ERR-FLAG
S16100           GO                     TO  M000-ERR
S16100         END-IF
S16100       END-PERFORM
S16100     END-IF.
S16976*S12770     IF  STRT-AREA-TRN-NO = 11057 OR 16057 OR 11157 OR 16157
S16976     IF (STRT-AREA-TRN-NO = 11057 OR 16057 OR 11157 OR 16157)
S12770     AND STRT-BANCSLINK
S12770         IF BORP-CONSMR AND BORP-REORG-CREDIT-PROD
S12770            MOVE VIR-AC-FOR-REORG-PROD TO
S12770                 WA-VIR-AC-FOR-REORG-AC
S12770            IF NOT VALID-VIR-AC
S15672               MOVE STRT-AREA-SOC-NO TO CUSM-SOC-NO
S15672               MOVE WA-VIR-AC-FOR-REORG-AC TO CUSM-CUST-ACCT-NO
S15672               MOVE "CUSM"           TO DBIO-CALL-SYS-AREA
S15672               MOVE SPACES           TO DBIO-CALL-STATUS
S15672               MOVE ZEROES           TO DBIOMOD-KEY-NO
S15672               MOVE CUSM-KEY TO DBIO-CALL-KEY-AREA
S15672               MOVE 71 TO DBIO-CALL-FUNC
S15672               CALL "DBIO" USING DBIO-CALL-PARAM
S15672                                 DBIO-CALL-SYS-AREA
S15672                                 DBIO-CALL-KEY-AREA
S15672                                 DBIO-CALL-STATUS
S15672                                 CUSM-RECORD-AREA
S15672               IF  BORM-CUSTOMER-NO = CUSM-PRIM-ACCT
S15672               AND CUSM-ACCOUNT-SYSTEM = "LON"
S15672                   MOVE "Y" TO WA-LOAN-ACCT
S15672               ELSE
S12770                   MOVE 1             TO WA-MSG-ERR-FLAG
S12770                   MOVE 5054 TO WA-OUTPUT-ERR-MSG-NO
S12770                   GO TO M000-ERR
S15672               END-IF
S12770            END-IF
S12770         ELSE
S12770            IF  VIR-AC-FOR-REORG-PROD NOT = ZEROS
S12770            AND VIR-AC-FOR-REORG-PROD NOT = SPACES
S12770                MOVE 1            TO WA-MSG-ERR-FLAG
S12770                MOVE 2026         TO WA-OUTPUT-ERR-MSG-NO
S12770                GO TO M000-ERR
S12770            END-IF
S12770         END-IF
S12770     END-IF.
S15787*S12055     IF  BOIS-TIB-ACCT-IND = "2"
S15787*S12055     AND BOIS-CREDIT-TYPE = "R"
S15787     IF (BOIS-CREDIT-TYPE = "R" OR "M")
S12055     AND BOIS-ARREARS-CTR = 0
S12055     AND BOIS-PREV-DUE-DATE > 0
S12055     AND WA-INPUT-PARAM-TABLE(7) = 0
S12055     AND ((WA-INPUT-PARAM-TABLE(8) = 1 AND
S12055           BOIS-PREV-DUE-DATE > WA-STORE-TXN-DT)
S12055       OR (WA-INPUT-PARAM-TABLE(8) = 0 AND
S12055           BOIS-PREV-DUE-DATE > STRT-AREA-POST-DT))
S19747*S17755 IF  BORP-ILOAN-R
S19747        IF  (BORP-ILOAN-R OR PROD-RICHART)
S17755        AND WA-INPUT-PARAM-TABLE(8) = 1
S19747*S17755 AND (STRT-AREA-BATCH-TANDEM = "N" OR "V")
S19747        AND (STRT-AREA-BATCH-TANDEM = "N" OR "V" OR "Y")
S17755            NEXT SENTENCE
S17755        ELSE
S12055         MOVE 1      TO WA-MSG-ERR-FLAG
S12055         MOVE 127    TO WA-OUTPUT-ERR-MSG-NO
S12055         GO TO M000-ERR
S17755        END-IF
S12055     END-IF.
127310     IF  WA-DUMMY-TRN-NO = 11064 or 11164
127320         MOVE  WA-ADV-AMOUNT TO WA-DUMMY-AMT.
TB0095     IF WA-FIRST-ADV-FLAG = "Y"
TB0095        PERFORM J100-UPDATE-BOIS THRU J199-EXIT.
ST0054     IF WS-REQD-VCHR
ST0054        PERFORM E030-FILL-FORM THRU E039-EXIT.
127330*
S11911*S11757*   // SAVE MSG TYPE 53
S11911*S11757     IF STRT-BANCSLINK  AND
S11911*S11757        WA-MSG-ERR-FLAG = 0 AND
S11911*S11757        WA-INPUT-PARAM-TABLE(5) = 1 AND
S11911*S11757        WA-INPUT-PARAM-TABLE(7) = 0 AND
S11911*S11757        BOIS-CARLN-SUB-PROJ = "Y"
S11911*S11757         MOVE 7                 TO UT9000-CALL-CODE
S11911*S11757         MOVE ZEROS             TO UT9000-SOURCE-LENGTH
S11911*S11757         MOVE SPACES            TO UT9000-CALL-STATUS
S11911*S11757         MOVE 3                 TO UT9000-INST-NO
S11911*S11757         MOVE "BR0011"          TO UT9000-CALLING-ID
S11911*S11757         MOVE 12                TO UT9000-LANGUAGE-CODE
S11911*S11757         MOVE 1                 TO UT9000-REPORT-NO
S11911*S11757         MOVE 54                TO UT9000-SEQUENCE-NO
S11911*S11757         PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT
S11911*S11757         IF (UT9000-CALL-STATUS = "0") AND
S11911*S11757            (UT9000RA-LINE1 NOT = SPACES)
S11911*S11757              MOVE  "02"  TO  UT0082-CALL-CODE
S11911*S11757              MOVE  "N"   TO  UT0082-NEW-LINE-FLAG
S11911*S11757              MOVE  UT9000-SOURCE-LENGTH  TO  UT0082-MSG-LENGTH
S11911*S11757              MOVE  UT9000RA-LINE1        TO  UT0082-MSG-TEXT
S11911*S11757              CALL  "UT0082"  USING  UT0082-CALL-AREA
S11911*S11757                                     STARTAREA
S11911*S11757         END-IF
S11911*S11757     END-IF.
SC5458     IF SOC-SITE-TIB
SC5458        GO TO M100-CONTINUE.
127340* EVALUATE THE FREQUENCY OF THIS LOAN ACCT AGAINST THE OTHER ACCOU   
127350* OWNED BY THE CUSTOMER.  LOAN ACCOUNT HAS BEEN ADVANCED. 
NLB115     IF (BORM-CSLD-STMT-PROS = "Y")   OR
NLB115        (BORM-CSLD-STMT-PROS = " "
NLB115                    AND BORP-CSLD-STMT-PROS = "Y")   OR
NLB115        (BORM-CSLD-STMT-PROS = " "
NLB115                      AND BORP-CSLD-STMT-PROS = " "
NLB115                      AND SOC-CSLD-STMT-PROS = "Y" )
NLB115        NEXT SENTENCE
NLB115     ELSE
NLB115        GO TO M100-CONTINUE
NLB115     END-IF.
NLB115     MOVE ZEROS                    TO UT9998CA-ERR-STATUS.
NLB115     MOVE BORM-CUSTOMER-NO         TO UT9998CA-CUSTOMER-NO.   
NLB115     MOVE SOC-NO-1                 TO UT9998CA-INST-NO.      
NLB115     MOVE 01                       TO UT9998CA-CALL-CODE.   
NLB115     MOVE BORM-STATEMENT-DAY       TO UT9998CA-DAY.              
NLB115     MOVE BORM-STATEMENT-CYCLE     TO UT9998CA-CYCLE.           
NLB115     MOVE BORM-STATEMENT-FREQUENCY TO UT9998CA-ACCT-FREQ.      
NLB115     CALL "UT9998" USING UT9998-CALL-AREA.                    
127580     IF UT9998CA-ERR-STATUS NOT = ZERO
127590        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
127600                                 TO UT8500CA-CALL-CODE
127610        MOVE SPACES TO UT8500CA-INPUT-MSG
127620        STRING "BR0000:(M000) UT9998 CALL ERROR - "
127630                UT9998CA-ERR-STATUS
127640            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
127650        CALL "UT8500" USING
127670                             UT8500CA-AREA
127680        MOVE 1                    TO WA-MSG-ERR-FLAG
NLB115        MOVE UT9998CA-ERR-STATUS  TO WA-OUTPUT-ERR-MSG-NO
NLB115        MOVE UT9998CA-CALL-SYS    TO WA-DBERR-DATA-SET
NLB115        MOVE UT9998CA-CALL-STATUS TO WA-DB-ERROR
NLB115     END-IF.
127730*
NLB115 M100-CONTINUE.
127750*
127760     IF WA-MSG-ERR-FLAG = 1
127770        GO TO M000-ERR.
TB0069*
TB0069******************************
TB0069*** start of TB0069 insert ***
TB0069******************************
SC7653*    IF WA-FIRST-ADV
SC7653*       MOVE BORM-INT-START-DATE TO BOIS-LAST-BPI-INT-DATE
SC7653*    END-IF.
           IF WA-NEGO-RATE-FOUND-FLAG NOT = "Y"
             IF (BOIS-NEGO-RATE-IND NOT = "2")
             AND WA-FIRST-ADV
               PERFORM X710-GET-RATE  THRU X719-EXIT
               IF WA-MSG-ERR-FLAG = 1
                  GO TO M000-ERR
               END-IF
SC6594         IF  BORP-YOUBE
SC6594         AND BOIS-PREF-INT-RATE = 0
SC6594         AND BOIS-PREF-INT-PERIOD > 0
SC6594         AND STRT-AREA-POST-DT < BOIS-RATE-EXP-DATE
SC9814         AND NOT WA-FIRST-ADV     
SC6594             GO TO M100-CONTINUE-A
SC6594         END-IF
SC8733         IF BORP-YOUBE                                            
S11550            IF  WA-FIRST-ADV                                
S11550                MOVE "N"             TO WA-TRAN-NO-MORE-FLAG
S11550                MOVE WA-ADV-DATE-BIN TO WA-TEMP-PREF-DATE   
S11550                MOVE ZEROES          TO WA-INT-RATE-A       
S11550                                        WA-ADV-DATE-BIN     
S11550                PERFORM M700-DELETE-ALL-BRTH                
S11550                   THRU M700-EXIT                           
S11550                  UNTIL WA-TRAN-NO-MORE                     
S11550                MOVE WA-TEMP-PREF-DATE TO WA-ADV-DATE-BIN   
S11550            END-IF                                          
SC8733            IF  BORP-TIER-GROUP-ID NOT = SPACES                   
SC8733            AND BOIS-PREF-INT-PERIOD NOT = 0                      
SC8733            AND BOIS-START-METHOD NOT = "07"                      
SC8733            AND WA-FIRST-ADV                                      
SC8733                MOVE BOIS-PREF-INT-RATE    TO WA-INT-RATE-A       
SC8733                PERFORM M500-MAINTAIN-RATE-HISTORY                
SC8733                   THRU M500-EXIT                                 
SC8733                MOVE WA-ADV-DATE-BIN       TO WA-TEMP-PREF-DATE   
SC8733                MOVE BOIS-RATE-EXP-DATE    TO WA-ADV-DATE-BIN     
SC8733                IF BOIS-NEXT-RATE NOT = 0                         
SC8733                   MOVE BOIS-NEXT-RATE     TO WA-INT-RATE-A       
SC8733                ELSE                                              
SC8733                   MOVE 0                  TO WA-INT-RATE-A       
SC8733                END-IF                                            
SC8733                PERFORM M500-MAINTAIN-RATE-HISTORY                
SC8733                   THRU M500-EXIT                                 
SC8733                MOVE WA-TEMP-PREF-DATE     TO WA-ADV-DATE-BIN     
SC8733            ELSE                                                  
SC8733                IF WA-FIRST-ADV                                   
SC8733                AND BOIS-START-METHOD NOT = "07"                  
SC8733                  IF  BOIS-PREF-INT-PERIOD NOT = 0                
SC8733                     MOVE BOIS-PREF-INT-RATE  TO WA-INT-RATE-A    
SC8733                     PERFORM M500-MAINTAIN-RATE-HISTORY           
SC8733                        THRU M500-EXIT                            
SC8733                     MOVE WA-ADV-DATE-BIN     TO WA-TEMP-PREF-DATE
SC8733                     MOVE BOIS-RATE-EXP-DATE  TO WA-ADV-DATE-BIN  
SC8733                     IF BOIS-NEXT-RATE NOT = 0                    
SC8733                        MOVE BOIS-NEXT-RATE   TO WA-INT-RATE-A    
SC8733                     ELSE                                         
SC8733                        PERFORM E290-SEARCH-RATE-TABLE            
SC8733                        THRU E299A-EXIT                           
SC8733                     END-IF                                       
SC8733                     PERFORM M500-MAINTAIN-RATE-HISTORY           
SC8733                        THRU M500-EXIT                            
SC8733                     MOVE WA-TEMP-PREF-DATE     TO WA-ADV-DATE-BIN
SC8733                   ELSE                                           
SC9001                     IF BORM-INT-RATE NOT = 0                           
SC9001                        MOVE BORM-INT-RATE      TO WA-INT-RATE-A        
SC9001                     ELSE                                               
SC8733                        PERFORM E290-SEARCH-RATE-TABLE                  
SC8733                           THRU E299A-EXIT                              
SC9001                     END-IF                                             
SC8733                     PERFORM M500-MAINTAIN-RATE-HISTORY                 
SC8733                        THRU M500-EXIT                                  
SC8733                   END-IF                                         
SC8733                END-IF                                            
SC8733                IF BOIS-START-METHOD = "07"                       
S15449*S12198                AND (BOIS-PREF-INT-PERIOD = 0
S15449*S12198                OR  (BOIS-PREF-INT-PERIOD > 0 AND
S15449*S12198                     STRT-AREA-POST-DT > BOIS-RATE-EXP-DATE))
SC8733*S12198         AND BOIS-PREF-INT-PERIOD = 0
SC8891                AND WA-FIRST-ADV                                  
S15562*SC9001             IF BORM-INT-RATE NOT = 0
S15562*SC9001                MOVE BORM-INT-RATE       TO WA-INT-RATE-A
S15562                    IF BOIS-NEXT-RATE NOT = 0
S15562                       MOVE BOIS-NEXT-RATE      TO WA-INT-RATE-A
SC9001                    ELSE                                         
SC8733                       PERFORM E290-SEARCH-RATE-TABLE            
SC8733                          THRU E299A-EXIT                        
SC9001                    END-IF                                       
S15562                    IF BOIS-PREF-INT-PERIOD NOT = 0
S15562                    AND WA-ADV-DATE-BIN     <  BOIS-RATE-EXP-DATE
S15562                      MOVE BOIS-PREF-INT-RATE  TO WA-INT-RATE-A
S15562                    END-IF
SC8733                    PERFORM M500-MAINTAIN-RATE-HISTORY           
SC8733                       THRU M500-EXIT                            
S15562                    IF BOIS-PREF-INT-PERIOD NOT = 0
S15562                    AND WA-ADV-DATE-BIN     <  BOIS-RATE-EXP-DATE
S15562                      MOVE WA-ADV-DATE-BIN  TO WA-TEMP-PREF-DATE
S15562                      MOVE BOIS-RATE-EXP-DATE  TO WA-ADV-DATE-BIN
S15562                      IF BOIS-NEXT-RATE NOT = 0
S15562                         MOVE BOIS-NEXT-RATE   TO WA-INT-RATE-A
S15562                      ELSE
S15562                         MOVE 0                TO WA-INT-RATE-A
S15562                      END-IF
S15562                      PERFORM M500-MAINTAIN-RATE-HISTORY
S15562                         THRU M500-EXIT
S15562                      MOVE WA-TEMP-PREF-DATE   TO WA-ADV-DATE-BIN
S15700                    ELSE
S15700                      MOVE BOIS-NEXT-RATE      TO BORM-INT-RATE
S15562                    END-IF
SC8733                END-IF                                            
SC8733            END-IF
SC8733         ELSE                                                     
                  PERFORM M500-MAINTAIN-RATE-HISTORY                    
                     THRU M500-EXIT                                     
SC8733         END-IF                                                   
               IF WA-MSG-ERR-FLAG = 1
                  GO TO M000-ERR
               END-IF
SC2192
SC2192         IF NOT BORP-YOUBE
SC2192          AND BORM-INT-RATE = 0
SC2192          AND (BOIS-NEGO-RATE-IND = "0"
SC2192               OR  (BOIS-NEGO-RATE-IND = "2"
SC2192                    AND BOIS-NEGO-RATE-FLAG = "2"))
SC2192          AND BORP-BASM-BASE-ID NOT = SPACES
SC2192          AND BORP-BASM-RATE-ID NOT = SPACES
SC2192            MOVE "N"                 TO WA-LOADED-ALL
SC2192            MOVE WA-ADV-DATE-BIN     TO WA-SAVE-ADV-DATE-BIN
SC2192            COMPUTE WA-ADV-DATE-BIN = WA-INT-DATE-A + 1
SC2192
SC5098            MOVE WA-INT-RATE-A TO WA-SAVE-INT-RATE
SC5098            MOVE "N" TO WA-BACK-LOADED-RATE
SC2192            PERFORM XLOAD-ALL-RATES
SC2192               THRU XLOAD-ALL-RATES-EXIT
SC2192              UNTIL WA-LOADED-ALL = "Y"
SC2192                 OR WA-MSG-ERR-FLAG = 1
SC2192
SC2192            MOVE WA-SAVE-ADV-DATE-BIN TO WA-ADV-DATE-BIN
SC2192
SC2192            IF WA-MSG-ERR-FLAG = 1
SC2192               GO TO M000-ERR
SC2192            END-IF
SC5098** Move this code in XLOAD-ALL-RATES
SC3071**SC5098    ADD BORM-RT-INCR TO WA-INT-RATE-A
SC5098            IF WA-BACK-LOADED-RATE = "N"
SC5098               ADD BORM-RT-INCR TO WA-INT-RATE-A
SC5098            END-IF
SC2192         END-IF
SC2192
               MOVE WA-INT-RATE-A  TO BORM-STORE-RATE
             END-IF
             GO TO M100-CONTINUE-A
           END-IF.
           MOVE 61                 TO DBIO-CALL-FUNC
           MOVE STRT-AREA-SOC-NO   TO DBIO-01-SOC-NO
           MOVE WA-INPUT-ACCT-NO   TO DBIO-01-ACCT-NO
           MOVE DBIO-01-KEY        TO DBIO-CALL-KEY-AREA
           MOVE "BORM"             TO DBIO-CALL-N-SYS
           MOVE "BLDV"             TO DBIO-CALL-SYST-VAR
           MOVE "NI"               TO BLDV-NI-TRAN-TYPE
           MOVE "NI"               TO DBIO-CALL-CODE-B
           MOVE 0                  TO DBIO-CALL-REFER-AREA
           MOVE SPACES             TO DBIO-CALL-STATUS
           CALL "DBIO" USING DBIO-CALL-PARAM
                                      DBIO-CALL-SYS-AREA
                                      DBIO-CALL-KEY-AREA
                                      DBIO-CALL-STATUS
                                      WA-BLDV-AREA-NI
                                      DBIO-CALL-REFER-AREA
                                      DBIO-CALL-TXN-TYPE-AREA.
           IF DBIO-CALL-STATUS NOT = "****"
           OR DBIO-CALL-SAVE-REFER = "END."
              MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
              MOVE 1                TO WA-MSG-ERR-FLAG
              MOVE "BLDV"           TO WA-OUTPUT-DATA-SET
              MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
              MOVE UT8500CA-FUNC-NORMAL-DISPLAY
                                    TO UT8500CA-CALL-CODE
              MOVE SPACES           TO UT8500CA-INPUT-MSG
              STRING "BR0000:(M100) READ BLDVNI ERROR"
                     ", SAVE-REFER = " DBIO-CALL-SAVE-REFER
                     ", DBIO-STAT  = " DBIO-CALL-STATUS
                     ", KEY = " DBIO-CALL-KEY-AREA
                   DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
              CALL "UT8500" USING UT8500CA-AREA
              GO TO M000-ERR.
           MOVE WA-SUB-BLDVNI TO WA-SUB.
S17464     IF   WA-SUB < 15
S17464     AND  BLDV-NI-START-DATE (WA-SUB + 1) = ZEROS
S17464          MOVE BOIS-MATURITY-DATE TO BOIS-RATE-EXP-DATE
S17464     ELSE
           MOVE BLDV-NI-END-DATE (WA-SUB)
                              TO BOIS-RATE-EXP-DATE.
69IR32     MOVE BLDV-NI-RATE-FLAG (WA-SUB)
69IR32                        TO BOIS-NEGO-RATE-FLAG.
69IR32     IF WA-SUB < 15
69IR32        IF BLDV-NI-START-DATE (WA-SUB) NOT = ZEROES 
                 MOVE BOIS-RATE-EXP-DATE
                              TO BOIS-NEGO-NEXT-RATE-DATE
TB0069***-- 02/13/03
TB0069                           BOIS-NEXT-EXP-DATE
TB0069***-- end 02/13/03
69IR32        END-IF
69IR32     END-IF.
S16668*    IF BLDV-NI-RATE-FLAG (WA-SUB) = "2"
S16668     IF BLDV-NI-RATE-FLAG (WA-SUB) = "2" OR "3"
              MOVE BLDV-NI-RATE (WA-SUB) TO BORM-RT-INCR
              MOVE ZEROES  TO BORM-INT-RATE
S16064      IF  BOIS-EFR-CHNG-IND  NOT =  "1"
S11337        MOVE "0"     TO BOIS-EFR-CHNG-IND
S16064      END-IF
           ELSE
              MOVE ZEROES  TO BORM-RT-INCR
              MOVE BLDV-NI-RATE (WA-SUB) TO BORM-INT-RATE
S16064      IF  BOIS-EFR-CHNG-IND  NOT =  "1"
S11337        MOVE SPACES  TO BOIS-EFR-CHNG-IND
S16064      END-IF
           END-IF.
      ***---- store rate in rate history
           PERFORM X710-GET-RATE  THRU X719-EXIT.
           IF WA-MSG-ERR-FLAG = 1
              GO TO M000-ERR
           END-IF.
TB0069***---save the rate history maintenance in a common routine
           PERFORM M500-MAINTAIN-RATE-HISTORY THRU M500-EXIT.
           IF WA-MSG-ERR-FLAG = 1
              GO TO M000-ERR
           END-IF.
           MOVE WA-INT-RATE-A  TO BORM-STORE-RATE.
           MOVE "1"     TO BLDV-NI-POSTED-FLAG (WA-SUB).
           ADD 1 TO WA-ADV-DATE-BIN.
           PERFORM UNTIL WA-ADV-DATE-BIN > STRT-AREA-POST-DT
                      OR WA-SUB > 15
              MOVE "N"   TO WA-NEGO-RATE-FOUND-FLAG
              MOVE WA-SUB-BLDVNI TO WA-SUB
              PERFORM VARYING WA-SUB FROM WA-SUB BY 1
                UNTIL WA-SUB > 15
                   OR WA-NEGO-RATE-FOUND-FLAG = "Y"
                IF (BLDV-NI-START-DATE (WA-SUB)    < WA-ADV-DATE-BIN
                    OR BLDV-NI-START-DATE (WA-SUB) = WA-ADV-DATE-BIN)
                AND (BLDV-NI-END-DATE (WA-SUB)     > WA-ADV-DATE-BIN
                     OR BLDV-NI-END-DATE (WA-SUB)  = WA-ADV-DATE-BIN)
                AND BLDV-NI-START-DATE (WA-SUB)  NOT = ZEROES
                  IF WA-SUB NOT = WA-SUB-BLDVNI
      ****--------start of routine to recompute if change rate
                     MOVE WA-SUB     TO WA-SUB-BLDVNI
                     MOVE "1"        TO BLDV-NI-POSTED-FLAG (WA-SUB)
                     MOVE BLDV-NI-END-DATE (WA-SUB)
                                     TO BOIS-RATE-EXP-DATE
                     COMPUTE BOIS-NEGO-NEXT-RATE-DATE
                               = BOIS-RATE-EXP-DATE + 1
                     IF BLDV-NI-RATE-FLAG (WA-SUB) = "2"
                        MOVE BLDV-NI-RATE (WA-SUB) TO BORM-RT-INCR
                        MOVE ZEROES  TO BORM-INT-RATE
S16064                IF  BOIS-EFR-CHNG-IND  NOT =  "1"
S11337                  MOVE "0"     TO BOIS-EFR-CHNG-IND
S16064                END-IF
                     ELSE
                        MOVE ZEROES  TO BORM-RT-INCR
                        MOVE BLDV-NI-RATE (WA-SUB) TO BORM-INT-RATE
S16064                IF  BOIS-EFR-CHNG-IND  NOT =  "1"
S11337                  MOVE SPACES  TO BOIS-EFR-CHNG-IND
S16064                END-IF
                     END-IF
                     IF BLDV-NI-RATE-FLAG (WA-SUB) = "2"
                        PERFORM X710-GET-RATE  THRU  X719-EXIT
                        IF WA-MSG-ERR-FLAG = 1
                           GO TO M000-ERR
                        END-IF
                        MOVE WA-INT-RATE-BASM  TO WA-INT-RATE-A
                     ELSE
                        MOVE BORM-INT-RATE  TO WA-INT-RATE-A
                     END-IF
      ***-----save the rate history maintenance in a common routine
                     PERFORM M500-MAINTAIN-RATE-HISTORY
                                           THRU M500-EXIT
                     IF WA-MSG-ERR-FLAG = 1
                        GO   TO M000-ERR
                     END-IF
                     MOVE WA-INT-RATE-A     TO BORM-STORE-RATE
                     MOVE "1" TO BLDV-NI-POSTED-FLAG (WA-SUB)
                     MOVE WA-SUB TO WA-SUB-BLDVNI
                  END-IF
      ****--------end of routine to recompute if change rate
        
                  MOVE "Y"       TO WA-NEGO-RATE-FOUND-FLAG
                END-IF
              END-PERFORM
      ****----set the ctr to limit to stop loop if no more recs
              IF BLDV-NI-START-DATE (WA-SUB) = ZEROES
                 MOVE 15 TO WA-SUB
              END-IF
      ****----if no change of rate recorded for that date
              IF WA-NEGO-RATE-FOUND-FLAG NOT = "Y"
                 MOVE WA-SUB-BLDVNI TO WA-SUB
              END-IF
      ****----adjust adv date for chking against strt-area-post-dt
              ADD 1 TO WA-ADV-DATE-BIN
           END-PERFORM.
      ****-adjust adv date for chking against strt-area-post-dt
           PERFORM M400-BLDVNI-UPDATE THRU M400-EXIT.
           IF WA-MSG-ERR-FLAG = 1
              GO TO M000-ERR
           END-IF.
       M100-CONTINUE-A.
TB0069
TB0069******************************
TB0069***  end of TB0069 insert  ***
TB0069******************************
TRE937*START
127790***
127800***  TEMPORARY CODES TO CAL UTRSEC
127810***
TRE932     IF SOC-RETAIL-SEC-POS-NOT-REQD
TRE932        GO TO M100-CHECK-LIMIT.
TRE932*
TRE937     MOVE 0                       TO UTRSECCA-ERR-MSG-NO.
127860     MOVE BORM-CUSTOMER-NO        TO UTRSECCA-CUSTOMER-NO                
127870     MOVE BORM-MEMB-CUST-AC       TO UTRSECCA-ACCOUNT-NO                 
127880     MOVE BORM-CURRENCY-IND       TO UTRSECCA-CURRENCY                   
127890     SET UNSECURED-LOAN           TO TRUE                                
127900     MOVE BORM-INT-RATE           TO UTRSECCA-INTEREST-RATE              
127910     MOVE BORM-LOAN-TRM           TO WA-TEMP-TERM.                       
127920     MOVE WA-TEMP-TERM-R          TO UTRSECCA-TERM.                      
127930     MOVE BORM-LOAN-BAL           TO UTRSECCA-PRINCIPAL-AMOUNT           
TRE937     MOVE SPACES                  TO UTRSECCA-OVERRIDE-CODE.
TRE937*
127960     CALL "UTRSEC" USING                                                 
127970                   UTRSECCA-CALL-PARAM                                   
127980                   STARTAREA                                             
127990                   SOC-PARAMS.                                           
TRE937*START
128020     IF UTRSECCA-ERR-MSG-NO NOT =  0
128030        IF UTRSECCA-ERR-MSG-NO = 3933
128040           MOVE 3933 TO UT0060CA-CALL-ERROR-CODE
128050           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
128060           IF WA-MSG-ERR-FLAG = 0
128070              MOVE 3933 TO WA-ERR-MSG-NO
128080              MOVE 0 TO UTRSECCA-ERR-MSG-NO
128090           ELSE
128100              MOVE UTRSECCA-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
128110              MOVE 1 TO WA-MSG-ERR-FLAG
128120              GO TO M000-ERR
128130           END-IF
128140        ELSE
128150           MOVE UTRSECCA-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
128160           MOVE 1 TO WA-MSG-ERR-FLAG
128170           GO TO M000-ERR
128180        END-IF
128190     ELSE
128200        GO TO M100-CHECK-LIMIT
128210     END-IF.
128220*
128230***  ONLY COME HERE IF RETAIL HAS OVERRIDE THE TRANSACTION
128240***  PASS IT AGAIN TO TREASURY WITH OVERRIDE CODE FOR ERROR 3933
128250*
128260     MOVE "55" TO UTRSECCA-OVERRIDE-CODE-COL(1).
128270*
128280     CALL "UTRSEC" USING
128290                   UTRSECCA-CALL-PARAM
128300                   STARTAREA
128310                   SOC-PARAMS.
128330     IF UTRSECCA-ERR-MSG-NO NOT =  0
128340        MOVE UTRSECCA-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
128350        MOVE 1 TO WA-MSG-ERR-FLAG
128360        GO TO M000-ERR
128370     END-IF.
128380*
TRE932 M100-CHECK-LIMIT.
SC3569**** For backdated advance CALL UT0076 to recompute the due amt
SC3569**** This will consider the interest rate changes and balance
SC3569**** changes for the backdated period.
SC3569     IF WA-INPUT-PARAM-TABLE(8) = 1
SC3569      AND WA-INPUT-PARAM-TABLE(5) = 1
SC6478      AND NOT (BORM-STAT < 07 AND WA-INPUT-PARAM-TABLE(7) = 1)
SC3569      AND NOT BORP-YOUBE
S17755      AND NOT BORP-ILOAN-R
sC3569        MOVE BORM-INT-ACCR       TO WA-SAVE-INT-ACCR
SC3569        INITIALIZE UT0076CA-AREA
SC3569        MOVE 06                  TO UT0076CA-CALL-CODE
SC3569
SC3569        PERFORM D203-CALL-UT0076
SC3569           THRU D203-EXIT
SC3569
SC3569        IF WA-MSG-ERR-FLAG NOT = 0
SC3569           GO TO M000-ERR
SC3569        END-IF
SC3569
ST0097** INT ADJUSTMENT will be on int accrual.
SC3569**      IF WA-FIRST-ADV
SC3569**         MOVE BORM-INT-ACCR         TO BORM-INT-ADJUSTMENT
SC3569**         MOVE 0                     TO BORM-INT-ACCR
SC3569**      ELSE
SC3569**         MOVE BORM-INT-ACCR         TO BORM-INT-ADJUSTMENT
SC3569**         COMPUTE BORM-INT-ADJUSTMENT = BORM-INT-ADJUSTMENT
SC3569**                                     - WA-SAVE-INT-ACCR
SC3569**         MOVE WA-SAVE-INT-ACCR      TO BORM-INT-ACCR
SC3569**      END-IF
SC3569     END-IF.
SC3569
S17755     IF  BORP-ILOAN-R
S17755     AND WA-INPUT-PARAM-TABLE(8) = 1
S17755       INITIALIZE UT0076CA-AREA
S17755       MOVE 0                     TO UT0076CA-INT-ADJ-AMT
S17755       IF WA-ADV-DATE-BIN         >= BOIS-LAST-UNPAID-DUE-DATE
S17755       OR BOIS-ARREARS-CTR         = 0
S17755          MOVE 06                 TO UT0076CA-CALL-CODE
S17755          MOVE "E"                TO UT0076CA-CALL-TYPE
S17755       ELSE
S17755          MOVE 02                 TO UT0076CA-CALL-CODE
S17755          MOVE "U"                TO UT0076CA-CALL-TYPE
S17755       END-IF
S17755
S17755       MOVE WA-ADV-DATE-BIN       TO UT0076CA-TRAN-DATE
S17755       CALL "UT0076" USING UT0076CA-CALL-PARAM
S17755                           BORM-RECORD-AREA
S17755                           BOCT-RECORD-AREA
S17755                           BOIS-RECORD
S17755                           BORR-PARAMS
S17755       IF UT0076CA-RET-STATUS      NOT =  0
S17755          MOVE 1                      TO  WA-MSG-ERR-FLAG
S17755          MOVE UT0076CA-ERROR-MSG-NO  TO  WA-OUTPUT-ERR-MSG-NO
S17755          GO TO M000-ERR
S17755       END-IF
S17755       IF WA-ADV-DATE-BIN         <  BOIS-LAST-UNPAID-DUE-DATE
S17755       AND BOIS-ARREARS-CTR       >  0
S17755         PERFORM VARYING WA-SUB1 FROM 1 BY 1 UNTIL WA-SUB1 > 15
S17755           IF BR0024CA-TXN-CODE(WA-SUB1) = 0
S17755             MOVE 18503         TO BR0024CA-TXN-CODE(WA-SUB1)
S17755             MOVE UT0076CA-INT-ADJ-AMT TO BR0024CA-AMOUNT(WA-SUB1)
S17755             MOVE BORM-LOAN-BAL TO BR0024CA-BALANCE(WA-SUB1)
S17755             MOVE 15            TO WA-SUB1
S17755           END-IF
S17755         END-PERFORM
S17755       END-IF
S17755     END-IF.
TRE932*
TRE937*END
128420*
128430     PERFORM B3000-CHECK-LIMITS THRU B3099-EXIT.
128440*
128450     PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
128460     IF WA-MSG-ERR-FLAG = 1
128470        GO TO M099-EXIT.
128480*
128490*  UPDATE GLDM AND CHQM IF CASHIER CHEQUE.
128500*
128510     IF WA-DUMMY-LST-TWO NOT = 90 AND
128520        (WA-INPUT-PARAM-TABLE(10) = 1)
128530        MOVE "0" TO GL-DONT-WRITE-GLDM-IND
128540        MOVE   STRT-AREA-TRN-NO   TO   WA-SAVE-TRN-NO
128550        MOVE   STRT-AREA-EDIT-MASK TO  WA-SAVE-EDIT-MASK
128560        PERFORM M100-CHEQUE-ISSUANCE THRU M199-EXIT
128570        PERFORM E000-COMPLETION-PARA THRU E099-EXIT
128580        MOVE   WA-SAVE-TRN-NO  TO  STRT-AREA-TRN-NO
128590        MOVE   WA-SAVE-EDIT-MASK TO  STRT-AREA-EDIT-MASK
128600        MOVE STORE-BORM-AREA TO BORM-RECORD-AREA
TB0082**--
           ELSE
              IF STRT-AREA-TRN-NO = 11057 OR 11157 OR 16057 OR 16157
S11455        OR 11069 OR 11169 OR 16069 OR 16169
SC4522        OR (FEDI-FROM-TO-GL AND 
SC4522            (STRT-AREA-TRN-NO = 11055 OR 11155))
SC7091        OR (FEDI-FROM-TO-GL AND
SC7091            (STRT-AREA-TRN-NO = 16055 OR 16155))
                 MOVE BORM-RECORD-AREA    TO STORE-BORM-AREA
                 MOVE STRT-AREA-TRN-NO    TO WA-SAVE-TRN-NO
                 MOVE STRT-AREA-EDIT-MASK TO WA-SAVE-EDIT-MASK
                 MOVE STRT-AREA-BRANCH    TO WA-SAVE-FROM-BRANCH
                 MOVE BORM-CURRENCY-IND   TO WA-SUSP-TYPE-CURRENCY
                 PERFORM H200-POST-TO-GL-ACCT
                    THRU H200-EXIT
SC5612           MOVE "1" TO WA-CAST-GL-FLAG
                 PERFORM E000-COMPLETION-PARA
                    THRU E099-EXIT
SC5612           MOVE "0" TO WA-CAST-GL-FLAG
                 MOVE STORE-BORM-AREA   TO BORM-RECORD-AREA
                 MOVE WA-SAVE-TRN-NO    TO STRT-AREA-TRN-NO
                 MOVE WA-SAVE-EDIT-MASK TO STRT-AREA-EDIT-MASK
              END-IF
TB0082**--
128610     END-IF.
128620     PERFORM M1200-CAP-BAL-DTLS THRU M1299-EXIT.
128630     GO TO M099-EXIT.
128640*
128650 M000-ERR.
128660      PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
128670 M099-EXIT.
128680      EXIT.
128690/
SC0367 M003-ACCESS-INVE.
SC0367     MOVE "INVE"   TO DBIOMOD-FILE
SC0367                      DBIOMOD-SUFFIX.
SC0367     MOVE "DBIO"   TO DBIOMOD-PREFIX.
SC0367     MOVE INVM-KEY TO DBIOMOD-KEY
SC0367                      INVE-KEY.
SC0367     MOVE ZEROES   TO DBIOMOD-KEY-NO.
SC0367     MOVE SPACES   TO DBIOMOD-STATUS
SC0367                      DBIOMOD-RELEASE-LOCK
SC0367                      DBIOMOD-ACCESS-COMMAND
SC0367                      DBIOMOD-ACCESS-COND.
SC0367     CALL DBIOMODNAME USING
SC0367                            DBIOMOD-FILE
SC0367                            DBIOMOD-KEY
SC0367                            INVE-RECORD-AREA
SC0367                            DBIOMOD-FUNCTION
SC0367                            DBIOMOD-KEY-NO
SC0367                            DBIOMOD-RELEASE-LOCK
SC0367                            DBIOMOD-ACCESS-COMMAND
SC0367                            DBIOMOD-ACCESS-COND
SC0367                            DBIOMOD-STATUS.
SC0367
SC0367     IF  DBIOMOD-STAT NOT = "****"
SC0367        MOVE 223 TO WA-OUTPUT-ERR-MSG-NO
SC0367        MOVE 1 TO WA-MSG-ERR-FLAG
SC0367     END-IF.
SC0367 M003-EXIT.
SC0367     EXIT.
SC0367/
SC0367 M007-CALL-UT0200.
SC0367     MOVE INVM-SOC-NO            TO UT0200-CALL-SOC-NO.
SC0367     MOVE INVM-ACCT-TYPE         TO UT0200-CALL-ACCT-TYPE-A.
SC0367     MOVE INVM-INT-CAT           TO UT0200-CALL-INT-CAT-A.
SC0367     MOVE 0                      TO UT0200-CALL-INDEX.
SC0367     MOVE 02                     TO UT0200-CALL-CODE.
SC0367     CALL "UT0200"   USING   UT0200-CALL-AREA.
SC0367     IF UT0200-CALL-STATUS NOT = 0
SC0367        MOVE 201 TO WA-OUTPUT-ERR-MSG-NO
SC0367        MOVE 1   TO WA-MSG-ERR-FLAG
SC0367     END-IF.
SC0367 M007-EXIT.
SC0367     EXIT.
SC0367/
NR2001*128700 M070-GET-BORV-REASON.
NR2001*128710*
NR2001*128720     MOVE SPACES   TO DBIO-CALL-PARAM
NR2001*128730                      DBIO-CALL-SYS-AREA
NR2001*128740                      DBIO-CALL-KEY-AREA
NR2001*128750                      DBIO-CALL-STATUS
NR2001*128760     MOVE ZERO     TO DBIO-CALL-REFER-AREA
NR2001*128770     MOVE 07       TO DBIO-CALL-FUNC
NR2001*128780     MOVE "BOR"    TO DBIO-CALL-SYS
NR2001*128790     MOVE BORM-KEY TO DBIO-CALL-KEY
NR2001*128800     MOVE 30       TO DBIO-CALL-TXN-TYPE
NR2001*128810     PERFORM WITH TEST AFTER
NR2001*128820             UNTIL BORV-30-TRN-CODE = 17043
NR2001*128830                   OR DBIO-CALL-STATUS NOT = "****"
NR2001*128840        CALL "DBIO" USING
NR2001*
NR2001*128860                         DBIO-CALL-PARAM
NR2001*128870                         DBIO-CALL-SYS-AREA
NR2001*128880                         DBIO-CALL-KEY-AREA
NR2001*128890                         DBIO-CALL-STATUS
NR2001*128900                         BORV-RECORD-AREA
NR2001*128910                         DBIO-CALL-REFER-AREA
NR2001*128920                         DBIO-CALL-TXN-TYPE
NR2001*128930     END-PERFORM.
NR2001*128940     IF  DBIO-CALL-STATUS = "****"
NR2001*128950        MOVE BORV-30-STOP-REASON TO WA-OUTPUT-REASON
NR2001*128960     ELSE
NR2001*128970        IF  DBIO-CALL-STATUS = "XCOT"
NR2001*128980           MOVE SPACES TO WA-OUTPUT-REASON
NR2001*128990        ELSE
NR2001*129000           MOVE 1             TO WA-MSG-ERR-FLAG
NR2001*129010           MOVE 155           TO WA-OUTPUT-ERR-MSG-NO
NR2001*129020           MOVE "BORV"        TO WA-DBERR-DATA-SET
NR2001*129030           MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
NR2001*129040           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
NR2001*129050                UT8500CA-CALL-CODE
NR2001*129060           MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*129070           STRING "BR0000:(M070) 'BORV' ERROR, STAT- "
NR2001*129080                  DBIO-CALL-STATUS ", KEY- " BORM-KEY
NR2001*129090                  ", FUNC- " DBIO-CALL-FUNC
NR2001*129100                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*129110           CALL "UT8500" USING
NR2001*
NR2001*129130                       UT8500CA-AREA
NR2001*129140        END-IF
NR2001*129150     END-IF.
NR2001*129160*
NR2001*129170 M079-EXIT.
NR2001*129180     EXIT.
NR2001 M070-GET-BOCT-REASON.
NR2001*
NR2001     INITIALIZE UTBOCTCA-CALL-AREA.
NR2001     MOVE BORM-SOC-NO       TO BOCT-INST-NO.
NR2001     MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO.
NR2001     MOVE 0                 TO BOCT-REC-NO.
NR2001     MOVE 999999999         TO BOCT-TRN-DATE.
NR2001     MOVE 1                 TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT TO TRUE.
NR2001     PERFORM WITH TEST AFTER
NR2001             UNTIL (BOCT-TRN-CODE = 17043 AND
NR2001                    BOCT-TRAN-TYPE = 30) 
NR2001                   OR NOT UTBOCTCA-OK
NR2001     MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO
NR2001     MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO
NR2001     MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO
NR2001     MOVE BOCT-TRN-DATE       TO UTBOCTCA-CALL-DATE
NR2001     MOVE 1                   TO UTBOCTCA-KEY-NO
NR2001     SET  UTBOCTCA-READNEXT   TO TRUE
NR2001     CALL "UTBOCT"         USING UTBOCTCA-CALL-AREA
NR2001                                 BOCT-RECORD-AREA
NR2001     END-PERFORM.
NR2001     IF  UTBOCTCA-OK
NR2001         MOVE BOCT-30-STOP-REASON TO WA-OUTPUT-REASON
NR2001     ELSE
NR2001        IF UTBOCTCA-EOF
NR2001           MOVE SPACES TO WA-OUTPUT-REASON
NR2001        ELSE
NR2001           MOVE 1             TO WA-MSG-ERR-FLAG
NR2001           MOVE 155           TO WA-OUTPUT-ERR-MSG-NO
NR2001           MOVE "BOCT"        TO WA-DBERR-DATA-SET
NR2001           MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
NR2001           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
NR2001                UT8500CA-CALL-CODE
NR2001           MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001           STRING "BR0000:(M070) 'BOCT' ERROR "
NR2001                  ", CALLCODE=" UTBOCTCA-CALL-CODE
NR2001                  ", STATUS="   UTBOCTCA-STATUS
NR2001                  ", CALLKEY="  UTBOCTCA-CALL-KEY
NR2001                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001           CALL "UT8500" USING
NR2001                         UT8500CA-AREA
NR2001        END-IF
NR2001     END-IF.
NR2001*
NR2001 M079-EXIT.
NR2001     EXIT.
129190/
129200 M100-CHEQUE-ISSUANCE.
129210     IF WA-DUMMY-LST-TWO = 70
129220        MOVE BORM-MEMB-CUST-AC TO UT0500CA-CUSM-NO
129230        MOVE 1                 TO UT0500CA-CALL-CODE
129240        PERFORM V500-CALL-UT0500 THRU V599-EXIT
129250        IF UT0500RA-CALL-STATUS NOT = 0
129260           GO TO M120
129270        ELSE
129280            MOVE UT0500RA-NAME-1 TO WA-GL-NAME-1 WA-ADV-NAME-1
129290            MOVE UT0500RA-NAME-2 TO WA-GL-NAME-2 WA-ADV-NAME-2
129300        END-IF
129310     ELSE
129320         MOVE WA-ADV-NAME-1 TO WA-GL-NAME-1
129330         MOVE WA-ADV-NAME-2 TO WA-GL-NAME-2
129340     END-IF.
129350     IF WA-INPUT-PARAM-TABLE (8) NOT = 1
129360        MOVE 0 TO WA-ADV-TXN-DATE
129370     END-IF.
129390     IF WA-DUMMY-LST-TWO = 80                                           
129400        MOVE WA-SAVE-NAME-1 TO WA-ADV-NAME-1                            
129410        MOVE WA-SAVE-NAME-2 TO WA-ADV-NAME-2.                           
129420     IF WA-POST-1ST-PASS
129430        MOVE 1 TO WA-POST-2ND-PASS-IND
129440        MOVE BORM-RECORD-AREA TO STORE-BORM-AREA
129450        MOVE BORM-BR-NO       TO WA-SAVE-FROM-BRANCH
129460        MOVE 0                TO WA-DUP-COUNT
129470        MOVE SUSP-ACCT-NO     TO DBIO-01-ACCT-NO
129480        PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT
129490        IF WA-MSG-ERR-FLAG = 1
129500           GO TO M120
129510        ELSE
129520           MOVE 2                 TO UT0120CA-CALL-CODE
129530           MOVE STRT-AREA-SOC-NO  TO UT0120CA-CALL-INST
129540           MOVE GLDM-PRODUCT-TYPE TO
129550                            UT0120CA-CALL-PRODUCT-TYPE
129560           MOVE GLDM-PRODUCT-CATEGORY TO
129570                            UT0120CA-CALL-PRODUCT-CAT
129580           MOVE 0                 TO UT0120CA-CALL-STATUS
129590           CALL "UT0120" USING
129610                         UT0120CA-CALL-AREA
129620           IF UT0120CA-CALL-STATUS NOT = 0
129630              MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
129640                   UT8500CA-CALL-CODE
129650              MOVE SPACES TO UT8500CA-INPUT-MSG
129660              STRING "BR0000(M100): ERROR IN GLPPARAM READ "
129670                      UT0120CA-CALL-STATUS
129680                      " KEY :" UT0120CA-CALL-KEY
129690                  DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
129700              CALL "UT8500" USING
129720                             UT8500CA-AREA
129730              MOVE 1092             TO WA-OUTPUT-ERR-MSG-NO
129740              MOVE 1                TO WA-MSG-ERR-FLAG
129750              GO TO M120
129760           ELSE
129770              PERFORM V800-CHECK-SECURITY THRU V899-EXIT
129780              IF WA-MSG-ERR-FLAG = 0
129790                 MOVE GLDM-BRANCH TO WA-SAVE-TO-BRANCH
129800              ELSE
129810                 GO TO M120.
129830     IF  (WA-ADV-1ST-BYTE = "#" AND WA-DUMMY-LST-TWO = 80) OR
129840         (STRT-BATCH-TXN AND
129850         (WA-DUMMY-LST-TWO = 80 OR 81))
129860          MOVE 04 TO CH0000-CALL-CODE
129870     ELSE
129880          MOVE 02 TO CH0000-CALL-CODE.
129890     MOVE "BOR" TO CH0000-CALL-SYSTEM.
129900     CALL "CH0023" USING
129920                         STARTAREA
129930                         CH0000-CALL-AREA.
129940     IF ST-STATUS-LEVEL-1 = 1
129950        MOVE 1 TO WA-MSG-ERR-FLAG
129960     ELSE
129970        PERFORM M200-POST-TO-GL-ACCT THRU M200-EXIT
129980     END-IF.
129990 M120.
130000     IF WA-MSG-ERR-FLAG = 0
130010        IF WS-SAVE-TXN-CURRENCY NOT = CASHIER-CURRENCY
130020           MOVE WS-SAVE-TXN-CURRENCY TO CASHIER-CURRENCY
130030           PERFORM C000-CASHIER-CHK2 THRU C099-EXIT
130040        END-IF
130050     END-IF.
130070 M199-EXIT.
130080     EXIT.
130090*
130100 M200-POST-TO-GL-ACCT.
130110     MOVE WA-DUMMY-GL-TRN-NO   TO STRT-AREA-TRN-NO
130120                                  LINK-IN-TXCODE
130130                                  WA-DUMMY-TRN-NO.
130140     PERFORM X700-CALL-UT0250   THRU X799-EXIT.
130150     IF WA-MSG-ERR-FLAG = 1
130160         GO TO M200-EXIT
130170     END-IF.
130180     MOVE LINK-EDIT-TABLE TO STRT-AREA-EDIT-MASK.
130190     MOVE 3                   TO GL-TRANS-IND.
130200     MOVE GLDM-LEDGER-NO      TO WA-GL-ACCT-NO.
130210     MOVE WA-SAVE-TXN-AMT     TO WA-GL-AMOUNT.
130220     MOVE SPACES              TO WA-GL-DESC.
130230     MOVE WA-ADV-CHQ-NO       TO WA-GL-CHQ-NO.
130240     MOVE WA-GL-CHQ-NO        TO WA-GL-DESC.
130250     MOVE 1                   TO WA-GL-CHQ-TYPE.
130260     MOVE WA-ADV-TXN-DATE     TO WA-GL-TXN-DATE.
130270     MOVE WA-INPUT-PROMO      TO WA-GL-PROMO-NO.
130280     MOVE GLDM-CURRENCY       TO WA-GL-CURRENCY.
SC2302     SET WA-POST-TO-GL        TO TRUE.
SC2302     MOVE GLDM-BRANCH         TO WA-GLDM-BRANCH.
130290     IF WA-INPUT-PARAM-TABLE (7) = 1
130300         MOVE WA-TRE-ACNO     TO WA-GL-CORR-JRNL-NO
130310     ELSE
130320         MOVE 0               TO WA-GL-CORR-JRNL-NO
130330     END-IF.
130340     MOVE WA-INPUT-MSG TO WA-SAVE-INPUT-MSG.
130350     MOVE WA-GL-TXN-AREA      TO WA-INPUT-MSG.
130360     CALL "GL0023" USING
130380                         STARTAREA
130390                         GL-PASSALONG
130400                         MULTI-OVERRIDE-AREA
130410                         W300-ERROR-AREA
130420                         CHECK-RESPONSE-AREA
TB0137                         UTVTACCA-CALL-PARAM.
130430     MOVE WA-SAVE-INPUT-MSG  TO WA-INPUT-MSG.
130440     IF ST-STATUS-LEVEL-1 NOT = 0
130450         MOVE 1 TO WA-MSG-ERR-FLAG
130460     END-IF.
130470 M200-EXIT.
130480       EXIT.
NR2001*TB0099/  
NR2001*TB0099 M201-ADD-NEW-TXN.
NR2001*TB0099     MOVE 12                     TO ST-DBIO-CALL-CODE.
NR2001*TB0099     MOVE "GEN"                  TO DBIO-12-SYSTEM.
NR2001*TB0099     MOVE STRT-AREA-SOC-NO       TO DBIO-12-SOC-NO.
NR2001*TB0099     MOVE WA-DEP-TRF-ACCT-NO     TO DBIO-12-ACCT-NO.
NR2001*TB0099     MOVE SPACES                 TO DBIO-12-RETURN-STATUS.
NR2001*TB0099     MOVE 0                      TO DBIO-12-TRN-POINTER.
NR2001*TB0099     CALL "DBIO" USING
NR2001*
NR2001*TB0099
NR2001*TB0099                                 ST-DBIO-CALL-CODE
NR2001*TB0099                                 DBIO-12-SYSTEM-AREA
NR2001*TB0099                                 DBIO-12-KEY
NR2001*TB0099                                 DBIO-12-RETURN-STATUS
NR2001*TB0099                                 GLDV-RECORD-AREA
NR2001*TB0099                                 DBIO-12-TRN-POINTER.
NR2001*TB0099     IF  DBIO-12-RETURN-STATUS NOT = "****"
NR2001*TB0099         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*TB0099         MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*TB0099         STRING "BR0000(M201) GLDV-ADD ERROR FOR " DBIO-12-KEY
NR2001*TB0099             " STATUS IS " DBIO-12-RETURN-STATUS
NR2001*TB0099             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*TB0099         CALL "UT8500" USING
NR2001*
NR2001*TB0099                             UT8500CA-AREA
NR2001*TB0099         MOVE 1                  TO WA-MSG-ERR-FLAG
NR2001*TB0099         MOVE 155                TO WA-OUTPUT-ERR-MSG-NO
NR2001*TB0099         MOVE "GLDV"             TO WA-OUTPUT-DATA-SET
NR2001*TB0099         MOVE DBIO-12-RETURN-STATUS TO WA-OUTPUT-STATUS.
NR2001*TB0099 M201-EXIT.
NR2001*TB0099     EXIT.
TB0069*
TB0069******************************
TB0069*** start of TB0069 insert ***
TB0069******************************
       M300-STORE-RATE-HISTORY.
           INITIALIZE BRTH-DATA-REC-RD.
           MOVE WA-ADV-DATE-BIN     TO BRTH-EFFECTIVE-DATE.
           MOVE WA-INT-RATE-A       TO BRTH-NEW-EFF-RATE.
      ****  reversing the date to make the latest date come first
      ****   DO THIS UNTIL DBIO IS CHANGED TO HANDLE THIS
           COMPUTE BRTH-EFFECTIVE-DATE
                      = 999999999 - BRTH-EFFECTIVE-DATE.
           MOVE BORM-KEY            TO BRTH-ACCT.
           MOVE BORM-RT-INCR        TO BRTH-RT-INCR.
           MOVE 0                   TO BRTH-MARGIN.
           MOVE SPACES              TO DBIO-CALL-STATUS.
69IR32***  MOVE 72                  TO DBIO-CALL-FUNC.
           MOVE "BRTH"              TO DBIO-CALL-N-SYS.
           MOVE BRTH-KEY            TO DBIO-CALL-KEY-AREA.
           CALL "DBIO"     USING
                                    DBIO-CALL-PARAM
                                    DBIO-CALL-SYS-AREA
                                    DBIO-CALL-KEY-AREA
                                    DBIO-CALL-STATUS
                                    BRTH-RECORD-AREA.
      *
       M300-EXIT.
           EXIT.
      *
       M400-BLDVNI-UPDATE.
           MOVE STRT-AREA-SOC-NO    TO DBIO-01-SOC-NO.
           MOVE WA-INPUT-ACCT-NO    TO DBIO-01-ACCT-NO.
           MOVE DBIO-01-KEY         TO DBIO-CALL-KEY-AREA.
           MOVE 64                  TO DBIO-CALL-FUNC.
           MOVE WA-REFER-X          TO DBIO-CALL-SAVE-REFER.
           MOVE 9999                TO DBIO-CALL-REFER-AREA.
           MOVE "BORM"              TO DBIO-CALL-N-SYS
           MOVE "BLDV"              TO DBIO-CALL-SYST-VAR
           MOVE "NI"                TO BLDV-NI-TRAN-TYPE
           MOVE "NI"                TO DBIO-CALL-CODE-B
           MOVE SPACES              TO DBIO-CALL-STATUS.
           MOVE STRT-AREA-POST-DT   TO BLDV-NI-POST-DATE.
           CALL "DBIO" USING DBIO-CALL-PARAM
                                  DBIO-CALL-SYS-AREA
                                  DBIO-CALL-KEY-AREA
                                  DBIO-CALL-STATUS
                                  WA-BLDV-AREA-NI
                                  DBIO-CALL-REFER-AREA
                                  DBIO-CALL-TXN-TYPE-AREA.
           IF DBIO-CALL-STATUS NOT = "****"
           OR DBIO-CALL-SAVE-REFER = "END."
              MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
              MOVE 1                TO WA-MSG-ERR-FLAG
              MOVE "BLDV"           TO WA-OUTPUT-DATA-SET
              MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
              MOVE UT8500CA-FUNC-NORMAL-DISPLAY
                                    TO UT8500CA-CALL-CODE
              MOVE SPACES           TO UT8500CA-INPUT-MSG
              STRING "BR0000:(M400) REWRITE BLDVNI ERROR"
                     ", SAVE-REFER = " DBIO-CALL-SAVE-REFER
                     ", DBIO-STAT  = " DBIO-CALL-STATUS
                     ", KEY = " DBIO-CALL-KEY-AREA
                  DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
              CALL "UT8500" USING UT8500CA-AREA
           END-IF.
       M400-EXIT.
           EXIT.
      *
       M500-MAINTAIN-RATE-HISTORY.
           MOVE 71  TO DBIO-CALL-FUNC.
           PERFORM  M300-STORE-RATE-HISTORY THRU M300-EXIT.
           IF DBIO-CALL-STATUS = "****"
              MOVE SPACES TO DBIO-CALL-STATUS
              MOVE 74 TO DBIO-CALL-FUNC
              PERFORM M300-STORE-RATE-HISTORY THRU M300-EXIT
TB0069        IF WA-MSG-ERR-FLAG <> 1
TB0069           MOVE SPACES TO DBIO-CALL-STATUS
NR2001*TB0069           PERFORM M600-STORE-BORV-34 THRU M699-EXIT
NR2001           PERFORM M600-STORE-BOCT-34 THRU M699-EXIT
TB0069           GO TO M500-EXIT
TB0069        END-IF
           ELSE
              IF DBIO-CALL-STATUS = "MRNF" OR "RCNF"
                 MOVE SPACES TO DBIO-CALL-STATUS
                 MOVE 72 TO DBIO-CALL-FUNC
                 PERFORM M300-STORE-RATE-HISTORY THRU M300-EXIT
              END-IF
TB0069        IF WA-MSG-ERR-FLAG <> 1
TB0069           MOVE SPACES TO DBIO-CALL-STATUS
NR2001*TB0069           PERFORM M600-STORE-BORV-34 THRU M699-EXIT
NR2001           PERFORM M600-STORE-BOCT-34 THRU M699-EXIT
TB0069           GO TO M500-EXIT
TB0069        END-IF
           END-IF.
           IF DBIO-CALL-STATUS NOT = "****"
              SET UT8500CA-NORMAL-DISPLAY TO TRUE
              MOVE SPACES           TO UT8500CA-INPUT-MSG
              STRING "BR0000:(M500) BRTH ACCESS ERROR "
                     DBIO-CALL-STATUS " FOR " BRTH-KEY
                     " FUNC=" DBIO-CALL-FUNC
                 DELIMITED   BY SIZE INTO UT8500CA-INPUT-MSG
              MOVE "N"       TO UT8500CA-RESPONSE-REQD-FLAG
              CALL "UT8500"  USING
                                    UT8500CA-AREA
              MOVE "BRTH"           TO WA-OUTPUT-DATA-SET
              MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
              MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
              MOVE 1                TO WA-MSG-ERR-FLAG
              GO   TO M500-EXIT
           END-IF.
           MOVE WA-INT-RATE-A        TO BORM-STORE-RATE.
TB0069 M500-EXIT.
TB0069     EXIT.
TB0069/
NR2001*TB0069 M600-STORE-BORV-34.
NR2001 M600-STORE-BOCT-34.
           IF BORP-INT-TRANS NOT = "Y"
              GO TO   M699-EXIT.
NR2001*           INITIALIZE BORV-34-DETAIL.
NR2001*           MOVE ZERO  TO BORV-34-TO-RATE.
NR2001*NR0017*    MOVE WA-ADV-DATE-BIN        TO BORV-34-POST-DATE.
NR2001*NR0017     MOVE WA-ADV-DATE-BIN        TO BORV-34-TRN-DATE.
NR2001*NR0017     MOVE STRT-AREA-POST-DT      TO BORV-34-POST-DATE.
NR2001*           MOVE 34 TO BORV-34-CODE.
NR2001*S10839     MOVE STRT-AREA-BRANCH      TO UPTELLCA-BRCH
NR2001*S10839     MOVE STRT-AREA-TELL-NO     TO UPTELLCA-TELR
NR2001*S10839     CALL "UT0031"           USING UPTELLCA-PARAM-1
NR2001*S10839                                   UPTELLCA-PARAM-2
NR2001*           MOVE UPTELLCA-TELLER-BRANCH TO BORV-34-TELL-AND-BR.
NR2001*           MOVE 13507 TO BORV-34-TRN-CODE.
NR2001*           MOVE 10    TO BORV-34-STATUS.
NR2001*SC0781*    IF BORM-STORE-RATE = ZERO
NR2001*SC0781     IF BORM-STORE-RATE = ZERO OR WA-FIRST-ADV
NR2001*              MOVE "EFFECTIVE RATE"  TO BORV-34-MESSAGE1
NR2001*              MOVE WA-INT-RATE-A     TO BORV-34-FROM-RATE
NR2001*              MOVE "%    "           TO BORV-34-MESSAGE2
NR2001*           ELSE
NR2001*              MOVE "RATE CHANGED FM" TO BORV-34-MESSAGE1
NR2001*SC6418        IF STRT-AREA-TRN-NO = 17026                   
NR2001*SC6418           MOVE WA-SAVE-INT-RATE  TO BORV-34-FROM-RATE
NR2001*SC6418        ELSE                                          
NR2001*                 MOVE BORM-STORE-RATE   TO BORV-34-FROM-RATE
NR2001*SC6418        END-IF
NR2001*              MOVE "% TO "           TO BORV-34-MESSAGE2
NR2001*              MOVE WA-INT-RATE-A     TO BORV-34-TO-RATE
NR2001*              MOVE "%"               TO BORV-34-PERCENT.
NR2001*
NR2001*S10839*    MOVE 1 TO BORV-34-BRTERM.
NR2001*S10839     MOVE STRT-AREA-TERM-NO TO BORV-34-BRTERM.
NR2001     INITIALIZE BOCT-TRAN-34.
NR2001     MOVE 34                     TO BOCT-TRAN-TYPE.
NR2001     MOVE 10                     TO BOCT-STAT.
NR2001     MOVE WA-ADV-DATE-BIN        TO BOCT-TRN-DATE.
NR2001     MOVE 13507                  TO BOCT-TRN-CODE.
NR2001     MOVE ZERO                   TO BOCT-34-TO-RATE.
NR2001     IF BORM-STORE-RATE = ZERO OR WA-FIRST-ADV
NR2001        MOVE "EFFECTIVE RATE"    TO BOCT-34-MESSAGE1
NR2001        MOVE WA-INT-RATE-A       TO BOCT-34-FROM-RATE
NR2001        MOVE "%    "             TO BOCT-34-MESSAGE2
NR2001     ELSE
NR2001        MOVE "RATE CHANGED FM"   TO BOCT-34-MESSAGE1
NR2001        IF STRT-AREA-TRN-NO = 17026                   
NR2001           MOVE WA-SAVE-INT-RATE TO BOCT-34-FROM-RATE
NR2001        ELSE                                          
NR2001           MOVE BORM-STORE-RATE  TO BOCT-34-FROM-RATE
NR2001        END-IF
NR2001        MOVE "% TO "             TO BOCT-34-MESSAGE2
NR2001        MOVE WA-INT-RATE-A       TO BOCT-34-TO-RATE
NR2001        MOVE "%"                 TO BOCT-34-PERCENT.
           ADD  1 TO BORM-NO-NPB.
           MOVE 0 TO DBIO-CALL-REFER-AREA.
           PERFORM W500-ADD-TXN THRU W599-EXIT.
           IF WA-MSG-ERR-FLAG = 1
              SUBTRACT 1 FROM BORM-NO-NPB
              GO  TO  M699-EXIT
           END-IF.
TB0069 M699-EXIT.
TB0069     EXIT.
TB0069*
TB0069******************************
TB0069***  end of TB0069 insert  ***
TB0069****************************** 
S11550 M700-DELETE-ALL-BRTH.                               
S11550*--------------------                                
S11550*                                                    
S11550     INITIALIZE BRTH-KEY.                            
S11550     MOVE ZEROES              TO BRTH-EFFECTIVE-DATE.
S11550     MOVE BORM-KEY            TO BRTH-ACCT.          
S11550     MOVE 78                  TO DBIO-CALL-FUNC.     
S12198     MOVE "BEGN"              TO DBIO-CALL-SAVE-REFER.
S11550     PERFORM M710-ACCESS-BRTH                        
S11550        THRU M710-EXIT.                              
S11550     IF  DBIO-CALL-STATUS = "****"                   
S12198     AND DBIO-CALL-SAVE-REFER <> "END."
S11550     AND BORM-MEMB-CUST-AC = BRTH-MEMB-CUST-AC       
S11550        MOVE SPACES           TO DBIO-CALL-STATUS    
S11550        MOVE 73               TO DBIO-CALL-FUNC      
S11550        PERFORM M710-ACCESS-BRTH                     
S11550           THRU M710-EXIT                            
S11550        IF DBIO-CALL-STATUS NOT = "****"             
S11550           SET WA-TRAN-NO-MORE TO TRUE               
S11550           GO TO M700-EXIT                           
S11550        END-IF                                       
S11550     ELSE                                            
S11550        SET WA-TRAN-NO-MORE   TO TRUE                
S11550        GO TO M700-EXIT                              
S11550     END-IF.                                         
S11550*                                                    
S11550 M700-EXIT.                                          
S11550*---------                                           
S11550     EXIT.                                           
S11550 M710-ACCESS-BRTH.                                  
S11550*----------------                                   
S11550*                                                   
S11550     MOVE SPACES              TO DBIO-CALL-STATUS.  
S11550     MOVE "BRTH"              TO DBIO-CALL-N-SYS.   
S11550     MOVE BRTH-KEY            TO DBIO-CALL-KEY-AREA.
S11550                                                    
S11550     CALL "DBIO"     USING                          
S11550                              DBIO-CALL-PARAM       
S11550                              DBIO-CALL-SYS-AREA    
S11550                              DBIO-CALL-KEY-AREA    
S11550                              DBIO-CALL-STATUS      
S11550                              BRTH-RECORD-AREA.     
S11550*                                                   
S11550 M710-EXIT.                                         
S11550*---------                                          
S11550     EXIT.                                          
S19100
S19100 M800-ACCESS-STRA.
S19100     MOVE SPACES                   TO DBIOMOD-STAT.
S19100     MOVE "STRA"                   TO DBIOMOD-FILE
S19100                                      DBIOMOD-SUFFIX.
S19100     MOVE "DBIO"                   TO DBIOMOD-PREFIX.
S19100     MOVE ZEROES                   TO DBIOMOD-KEY-NO.
S19100     MOVE SPACES                   TO DBIOMOD-RELEASE-LOCK
S19100                                      DBIOMOD-ACCESS-COMMAND
S19100                                      DBIOMOD-ACCESS-COND
S19100                                      DBIOMOD-STATUS.
S19100
S19100     CALL DBIOMODNAME USING           DBIOMOD-FILE
S19100                                      DBIOMOD-KEY
S19100                                      STRA-RECORD-AREA
S19100                                      DBIOMOD-FUNCTION
S19100                                      DBIOMOD-KEY-NO
S19100                                      DBIOMOD-RELEASE-LOCK
S19100                                      DBIOMOD-ACCESS-COMMAND
S19100                                      DBIOMOD-ACCESS-COND
S19100                                      DBIOMOD-STATUS.
S19100 M800-EXIT.
S19100     EXIT.
130490/
130500 N000-PROCESS-LOAN-APPROVALS.
130510     IF WA-APP-TXN-DATE = ZEROS
130520        MOVE WA-ACCEPT-DATE-U  TO WA-APP-TXN-DATE.
130530     MOVE WA-APP-TXN-DATE      TO UT0030-DATE-DDMMCCYY.
130540     PERFORM X610-UT0030-PARA THRU X619-EXIT.
130550     MOVE UT0030-BINARY-DATE   TO WA-STORE-TXN-DT.
130560*****730033***
130570     IF STRT-AREA-TRN-NO = 12440 OR 12441
130580        MOVE ZERO TO WA-APP-AMOUNT
130590     ELSE
130600        MOVE WA-APP-AMOUNT TO WA-VA-AMT
130610        PERFORM Q000-AMOUNT-VALIDATION THRU Q009-EXIT
130620        IF WA-MSG-ERR-FLAG = 1
130630           GO TO N099-EXIT.
130640****730033****
130650     IF WA-INPUT-PARAM-TABLE (7) = 1
130660        AND STRT-AREA-TRN-NO NOT = 12441
130670        PERFORM L500-VERIFY-OLD-TRN THRU L599-EXIT.
130680     IF WA-MSG-ERR-FLAG = 1
130690        GO TO N099-EXIT.
130700     CALL "BR0017"  USING
130720                          STARTAREA
                                BOIS-RECORD
130730                          BORR-PARAMS
NR2001*130740                          BORV-RECORD-AREA
NR2001                          BOCT-RECORD-AREA
130750                          SOC-PARAMS
130760                          WA-PASSALONG
130770*----760345-----START---------------------------------------
130780                          UT0290CA-CALL-AREA
130790*----760345-----END-----------------------------------------
130800                          MULTI-OVERRIDE-AREA.
130810      IF WA-MSG-ERR-FLAG = 0
130820         PERFORM M1200-CAP-BAL-DTLS THRU M1299-EXIT.
130830 N099-EXIT.
130840      EXIT.
130850/
130860*  CHANGE LOAN BALANCE
130870      COPY CHANGEBAL IN LIBRYBOR.
130880/
130890*  CHANGE LOAN BALANCE FOR NO PRIORITATION
130900*
130910 N100-ADD-TO-LOAN-BAL.
130920*
130930     IF ADD-TO-BOTH-BALANCES
130940        ADD WA-AMOUNT-TO-ADD TO CPY-BORM-LOAN-BAL
130950                                CPY-BORM-THEO-LOAN-BAL
130960     ELSE
130970     IF ADD-TO-LOAN-BALANCE-ONLY
130980        ADD WA-AMOUNT-TO-ADD TO CPY-BORM-LOAN-BAL
130990     ELSE
131000     IF ADD-TO-THEORITICAL-ONLY
131010        ADD WA-AMOUNT-TO-ADD TO CPY-BORM-THEO-LOAN-BAL.
131020*
131030 N199-EXIT.
131040*
131050 N500-PROCESS-DISCHARGES.
S11226     MOVE BORM-ACT-TYPE TO WA-BORM-ACT-TYPE.
S11226     IF  WA-ACT-TYPE-790
S11226     AND WA-INPUT-PARAM-TABLE(8) = 1
S11226        MOVE  1         TO WA-MSG-ERR-FLAG
S11226        MOVE 307        TO WA-OUTPUT-ERR-MSG-NO
S11226        GO TO N599-EXIT
S11226     END-IF.
SC8756
SC8756     IF BORM-BAD-DEBT-IND(2:1) >= 2
SC8756     AND NOT STRT-BANCSLINK
S15112     AND NOT STRT-BATCH-TRICKLE-TXN
SC8756        MOVE 4744 TO WA-OUTPUT-ERR-MSG-NO
SC8756        MOVE 1    TO WA-MSG-ERR-FLAG
SC8756        GO TO N599-EXIT
SC8756     END-IF.
SC9454     IF (BORM-BAD-DEBT-IND(2:1) > 1)
S16235*SC9454     AND (STRT-AREA-TRN-NO = 015045 OR 015046)
S16235     AND (STRT-AREA-TRN-NO = 015045 OR 015046 OR 015047)
SC9454        MOVE 127  TO WA-OUTPUT-ERR-MSG-NO
SC9454        MOVE 1    TO WA-MSG-ERR-FLAG
SC9454        GO TO N599-EXIT
SC9454     END-IF.
SC8756
S17816     IF  BORP-YOUBE
S17816     AND (STRT-AREA-TRN-NO = 013010 OR 013045 OR 013046)
S17816     AND NOT (STRT-AREA-USER-TYPE = '67' OR '39')
S17816        MOVE  1         TO WA-MSG-ERR-FLAG
S17816        MOVE 307        TO WA-OUTPUT-ERR-MSG-NO
S17816        GO TO N599-EXIT
S17816     END-IF.
131060     IF STRT-AREA-TRN-NO NOT = 13000
131070         PERFORM O500-CHECK-SPEC-CONDS THRU O599-EXIT
131080         IF WA-MSG-ERR-FLAG = 1
131090             GO TO N599-EXIT
131100         ELSE
131110             MOVE WA-DISCH-I-AMOUNT TO WA-VA-AMT
131120             MOVE BORM-CURRENCY-IND  TO WA-CURRENCY
131130             PERFORM BB630-FORMAT-AMT-DECIMAL  THRU BB639-EXIT
131140             PERFORM Q000-AMOUNT-VALIDATION THRU Q009-EXIT
131150             IF WA-MSG-ERR-FLAG = 1
131160                 GO TO N599-EXIT.
131170     PERFORM X710-GET-RATE THRU X719-EXIT.
TB0069     IF WA-MSG-ERR-FLAG = 1
TB0069        GO TO N599-EXIT
TB0069     END-IF.
131180     MOVE WA-INT-RATE-A    TO BR0025CA-INT-RATE.
131190***
131200****  KEYMATRIX 30 DAY LOANS - DO NOT CALCULATE DUE DATE                 
131210****  SALARY DATES ARE USED FOR DUE DATES                                
131220***
131230     IF  BORP-REPAY-SCHED = "C"
131240         MOVE BORM-DUE-STRT-DATE TO WA-INT-DUE-DT
131250     ELSE
131260         PERFORM N1500-CALC-INT-DUE-DT THRU N1599-EXIT.
131270     MOVE WA-INT-DUE-DT    TO BR0025CA-INT-DUE-DT.
SC5037** SAVE THE LOAN BALANCE FOR UPDATING UT0683      
NR2003     IF WA-INPUT-PARAM-TABLE(8)  =  1
NR2003        MOVE WA-DISCH-I-TRAN-DATE TO UT0030-DATE-DDMMCCYY
NR2003        PERFORM X610-UT0030-PARA THRU X619-EXIT
NR2003        MOVE UT0030-BINARY-DATE TO WA-STORE-TXN-DT
NR2003     ELSE
NR2003        MOVE STRT-AREA-POST-DT  TO WA-STORE-TXN-DT
NR2003     END-IF
SC5037     MOVE BORM-LOAN-BAL    TO WA-SAVE-EXP-BORM-BAL
new        MOVE BORM-LOAN-TRM TO WA-SAVE-BORM-LOAN-TERM.
new        COMPUTE WA-SAVE-BORM-LOAN-TERM =
SC6548*            (BORM-LOAN-TRM - BORM-REM-REPAYS)
SC6548             ( 1 + BOIS-LAST-TERM-PAID )
SC7697*    MOVE BORM-INT-RATE TO WA-SAVE-BORM-INT-RATE
SC7697     MOVE BORM-STORE-RATE TO WA-SAVE-BORM-INT-RATE.
SC6096*    MOVE BORM-ADV-DATE TO WA-SAVE-BORM-ADV-DATE
SC6096*    IF BORM-ADV-DATE > BORM-ADD-ADV-DATE
SC6096*       MOVE BORM-ADV-DATE TO WA-SAVE-BORM-ADV-DATE
SC6096*    ELSE
SC6096*       MOVE BORM-ADD-ADV-DATE TO WA-SAVE-BORM-ADV-DATE
SC6096*    END-IF.
           MOVE BORM-LOAN-BAL TO WA-PRINCIPAL-AMT1.
S17197
S17197* // ALBPS DCHARGE TXN ONLY ALLOW ACCOUNT SERVICE CENTER
S17197     MOVE STRT-AREA-BRANCH    TO WA-BR-NO.
S17197     IF BORP-ALBPS
S17197     AND (NOT WA-ACCOUNT-SERVICE-CENTER)
S17197         MOVE 1    TO WA-MSG-ERR-FLAG
S17197         MOVE 5449 TO WA-OUTPUT-ERR-MSG-NO
S17197         GO TO N599-EXIT
S17197     END-IF.
S17197
S10542* BACKDATE CORRECTION PERFORMS THIS FOR CASHIER TOTALS OF THE ORIG TXN
S10542     IF ST-LOAN-BACKDATED-CORR-YES                                    
S10542        IF WA-INPUT-PARAM-TABLE(14) = 1                               
S10542           PERFORM E300-TELLER-TOT-PARA                               
S10542              THRU E399-EXIT                                          
S10542           IF  WA-MSG-ERR-FLAG = 1                                    
S10542               GO TO N599-EXIT                                        
S10542           END-IF                                                     
S10542        END-IF                                                        
S10542     END-IF                                                           
S18788     IF WA-MSG-ERR-FLAG = 1
S18788     AND (WA-OUTPUT-ERR-MSG-NO = 0
S18788      OR  WA-OUTPUT-ERR-MSG-NO < 100
S18788      OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
S18788        DISPLAY "!!BR0000, BEF BR25, ERR-"
S18788                WA-OUTPUT-ERR-MSG-NO
S18788     END-IF
131280     CALL "BR0025"       USING
131300                               STARTAREA
131310                               BORR-PARAMS
NR2001*131320                               BORV-RECORD-AREA
NR2001                               BOCT-RECORD-AREA
131330                               SOC-PARAMS
131340                               UT0290CA-CALL-AREA
131350                               BR0025-CALL-AREA
131360                               W100-DATE-FILE
131370                               WA-PASSALONG
131380                               MULTI-OVERRIDE-AREA
131390                               PBOOKCA-LINE-AREA 
TB0084                               BOIS-RECORD
SC1959                               UT0073CA-CALL-AREA.
S18788     IF WA-MSG-ERR-FLAG = 1
S18788     AND (WA-OUTPUT-ERR-MSG-NO = 0
S18788      OR  WA-OUTPUT-ERR-MSG-NO < 100
S18788      OR  WA-OUTPUT-ERR-MSG-NO > 899 AND < 1000)
S18788        DISPLAY "!!BR0000, AFT BR25, ERR-"
S18788                WA-OUTPUT-ERR-MSG-NO
S18788     END-IF.
S11402     IF WA-MSG-ERR-FLAG = 0 AND WS-DCHARGE-REFRESH
S18413        AND (NOT WS-ATM-DISCH)
S11402        PERFORM F200-DO-NEW-REFRESH THRU F299-EXIT
S11402     END-IF.
S20520*S20486 IF WA-MLWM-TXN AND STRT-BANCSLINK
S20520     IF (WA-MLWM-TXN AND STRT-BANCSLINK)
S20520     AND (WA-MSG-ERR-FLAG = 0)
S20486        INITIALIZE UTMLWM-CALL-PARAM
S20486        MOVE "LON"       TO UTMLWM-FUN
S20486        MOVE BORM-SOC-NO       TO UTMLWM-SOC-NO
S20486        MOVE BORM-MEMB-CUST-AC TO UTMLWM-MEMB-CUST-AC
S20486        CALL "UTMLWM" USING UTMLWM-CALL-PARAM
S20486        IF UTMLWM-CALL-STATUS = "00"
S20486           IF UTMLWM-MLWFLAG = "Y"
S20486              MOVE 1248 TO UT0060CA-CALL-ERROR-CODE
S20486              PERFORM Y000-OVERRIDABLE-ERROR-CHECK
S20486              THRU Y090-EXIT
S20486              IF   WA-MSG-ERR-FLAG = 0
S20486                   MOVE 1248 TO WA-ERR-MSG-NO
S20486              ELSE
S20486                   MOVE 1248 TO WA-OUTPUT-ERR-MSG-NO
S20486                   MOVE 1    TO WA-MSG-ERR-FLAG
S20486              END-IF
S20486           END-IF
S20486        END-IF
S20486     END-IF.
SC6096**   IF WS-DCHARGE
SC6542**      OR WS-DCHARGE-BACKD-COR
S16458*SC8690     IF (WS-DCHARGE OR WS-DCHARGE-BACKD-COR)
S16458     IF (WS-DCHARGE OR WS-DCHARGE-BACKD-COR OR WS-DCHARGE-COR)
SC8690      AND WA-MSG-ERR-FLAG = 0
CS6906      IF STRT-BANCSLINK
S16871      OR STRT-DSS-BUNCH-TXN
SC6895        IF BORM-BAD-DEBT-IND = 02 OR 03 OR 04
SC6895                            OR 52 OR 53 OR 54
SC6895                            OR 59
SC6895           PERFORM D700-NPL-VOUCHER-PRT THRU
SC6895                               D709-EXIT
SC6895
SC6895        ELSE
NR2001*                PERFORM N600-SEARCH-BORV-VCRH THRU N699-EXIT
NR2001          PERFORM N600-SEARCH-BOCT-VCRH THRU N699-EXIT
                PERFORM U300-FILL-FORM77 THRU U399-FORM77-EXIT
SC6895        END-IF
S15519        MOVE BORM-MORTGAGE-INSU           TO VCHR077-DESC(1:1)
S15519*S11303 MOVE BOIS-LOANER-CLOSE-IND        TO VCHR077-DESC
S15519        MOVE BOIS-LOANER-CLOSE-IND        TO VCHR077-DESC(3:1)
SC7304        IF NOT BORP-YOUBE
SC6383           PERFORM N550-PDCM-RTN THRU N559-EXIT
SC7304        END-IF
CS6906      END-IF
           END-IF.
S16997     IF BOIS-LATE-INT-INCR (3)        > 0
S16997     AND (BORM-BAD-DEBT-IND (2:1)     = 3 OR 4)
S16997        MOVE BOIS-LATE-INT-INCR(3)   TO UT0073CA-LATE-INT-INCR(3)
S16997     END-IF.
SC7091     IF WA-INPUT-PARAM-TABLE (10) = 1
SC7091        AND WA-MSG-ERR-FLAG = 0
SC7091            PERFORM Q200-POST-SUSP-ACC
SC7091                     THRU Q299-EXIT-PARA
SC7091        IF WA-MSG-ERR-FLAG = 1
SC7091            PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC7091            GO TO N599-EXIT
SC7091        END-IF
SC7091     END-IF.
SC3739                                                   
SC3739     IF WA-INPUT-PARAM-TABLE (25) = 1              
SC3739        IF WA-INPUT-PARAM-TABLE (7) = 0            
SC3739**         COMPUTE WA-DUMMY-AMT = BORM-ADV-VAL * -1
SC5037           COMPUTE WA-DUMMY-AMT = WA-SAVE-EXP-BORM-BAL * -1  
SC3739        ELSE                                       
SC3739**         MOVE BORM-ADV-VAL TO WA-DUMMY-AMT       
SC5037           COMPUTE WA-DUMMY-AMT = BORM-LOAN-BAL 
SC3739        END-IF                                     
SC3739     END-IF.                                       
SC3739                                                   
SC3719     IF WA-MSG-ERR-FLAG = 1
SC3719        GO TO N599-EXIT
SC3719     END-IF.
S10534     IF BOIS-PROJECT-ID = ZEROS OR SPACES
SC3719        GO TO N599-EXIT
SC3719     END-IF.
SC3719     MOVE STRT-AREA-SOC-NO  TO SUBS-SOC-NO.
SC3719     MOVE BORM-MEMB-CUST-AC TO SUBS-ACCT-NO.
SC3719     MOVE SUBS-KEY TO DBIOMOD-KEY.
SC3719     SET  READ-CMD TO TRUE.
SC3719     PERFORM X420-ACCESS-SUBS THRU X420-EXIT.
SC3719     IF DBIOMOD-STAT NOT = "****"
SC3719        MOVE 2285 TO WA-OUTPUT-ERR-MSG-NO
SC3719        MOVE 1    TO WA-MSG-ERR-FLAG
SC3719        GO TO N599-EXIT
SC3719     END-IF.
S17727*SC3719     MOVE STRT-AREA-POST-DT TO SUBS-STOP-DATE.
S17870*S17727     IF SUBS-STOP-DATE = 0
S17870     IF (SUBS-STOP-DATE = 0
S17870      OR SUBS-STOP-DATE > WA-STORE-TXN-DT)
S17727     AND WA-INPUT-PARAM-TABLE(7) = 0
S17727         MOVE WA-STORE-TXN-DT   TO SUBS-STOP-DATE
S17727     END-IF.
SC4036*    MOVE "DISCHARGE"       TO SUBS-STOP-REASON.
SC4036     MOVE 7                 TO UT9000-CALL-CODE.
SC4036     MOVE ZEROS             TO UT9000-SOURCE-LENGTH.
SC4036     MOVE SPACES            TO UT9000-CALL-STATUS.
SC4036     MOVE 3                 TO UT9000-INST-NO.
SC4036     MOVE "BR0011"          TO UT9000-CALLING-ID.
SC4036     MOVE 12                TO UT9000-LANGUAGE-CODE.
SC4036     MOVE 1                 TO UT9000-REPORT-NO.
SC4036     MOVE 11                TO UT9000-SEQUENCE-NO.
SC4036     PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT
SC4036     IF (UT9000-CALL-STATUS = "0") AND
SC4036        (UT9000RA-LINE1 NOT = SPACES)
SC4036        MOVE UT9000RA-LINE1 TO SUBS-STOP-REASON
SC4036     ELSE
SC4036        MOVE "DISCHARGE"    TO SUBS-STOP-REASON
SC4036     END-IF.
SC5707     IF WA-INPUT-PARAM-TABLE(7) = 1
SC5707        MOVE ZEROES         TO SUBS-LOAN-STAT
SC5707        MOVE ZEROES         TO SUBS-SUBSIDY-STAT
S17727*SC8804        MOVE ZEROES         TO SUBS-STOP-DATE
S17727        IF SUBS-STOP-DATE = WA-STORE-TXN-DT
S17727           MOVE ZEROES      TO SUBS-STOP-DATE
S17870           MOVE 1           TO WA-SUB
S17870           MOVE BORP-PRODUCT-GROUP(WA-SUB) TO WA-PRODUCT-GROUP
S17870           IF VALID-POLICY-YUN
S17870              PERFORM X840-CHK-YUN3-RTN THRU X840-EXIT
S17870              IF WA-BIN-DATE > WA-STORE-TXN-DT
S17870                 MOVE WA-BIN-DATE TO SUBS-STOP-DATE
S17870              END-IF
S17870           END-IF
S17727        END-IF
SC8804        MOVE SPACES         TO SUBS-STOP-REASON
SC5707     ELSE
SC5707        SET SUBS-DISCHARGED TO TRUE
SC5707        SET SUBS-STOPPED    TO TRUE
SC5707     END-IF.
SC3719
SC3719     SET  REWRITE-CMD TO TRUE.
SC3719     PERFORM X420-ACCESS-SUBS THRU X420-EXIT.
SC3719     IF DBIOMOD-STAT NOT = "****"
SC3719        MOVE 2285 TO WA-OUTPUT-ERR-MSG-NO
SC3719        MOVE 1    TO WA-MSG-ERR-FLAG
SC3719        GO TO N599-EXIT
SC3719     END-IF.
131400 N599-EXIT.
131410     EXIT.
131420/
SC6383*-----------------------------------------------
SC6383 N550-PDCM-RTN.
SC6383*-----------------------------------------------
SC6383     INITIALIZE  PDCM-RECORD-AREA.
SC6383     MOVE  STRT-AREA-SOC-NO   TO  PDCM-SOC-NO.
SC6383     MOVE  BORM-CUSTOMER-NO   TO  PDCM-CIF-NO.
SC6383     MOVE  BORM-MEMB-CUST-AC  TO  PDCM-DEPOSITED-ACCTNO.
SC6383     MOVE  0                  TO  DBIOMOD-KEY-NO.
SC6383     MOVE  "READ"             TO  DBIOMOD-FUNCTION.
SC6383     MOVE  PDCM-MST-KEY       TO  DBIOMOD-KEY.
SC6383     MOVE  "PDCM"             TO  DBIOMOD-FILE
SC6383                                  DBIOMOD-SUFFIX.
SC6383     MOVE  "DBIO"             TO  DBIOMOD-PREFIX.
SC6383     MOVE  SPACES             TO  DBIOMOD-RELEASE-LOCK
SC6383                                  DBIOMOD-ACCESS-COMMAND
SC6383                                  DBIOMOD-ACCESS-COND
SC6383                                  DBIOMOD-STATUS.
SC6383     CALL DBIOMODNAME USING DBIOMOD-FILE
SC6383                            DBIOMOD-KEY
SC6383                            PDCM-RECORD-AREA
SC6383                            DBIOMOD-FUNCTION
SC6383                            DBIOMOD-KEY-NO
SC6383                            DBIOMOD-RELEASE-LOCK
SC6383                            DBIOMOD-ACCESS-COMMAND
SC6383                            DBIOMOD-ACCESS-COND
SC6383                            DBIOMOD-STATUS.
SC6383*
SC6383     IF   DBIOMOD-STAT  =  "****"
SC6383          COMPUTE VCHR077-PDC-TOWN-COUNT
SC6383                = PDCM-HTOWN-COUNT + PDCM-OTOWN-COUNT
SC6383          COMPUTE VCHR077-PDC-TRAN-COUNT
SC6383                = PDCM-ITRAN-COUNT + PDCM-PRSNT-COUNT
SC6383          COMPUTE VCHR077-PDC-TOWN-AMT
SC6383                = PDCM-HTOWN-AMT   + PDCM-OTOWN-AMT
SC6383          COMPUTE VCHR077-PDC-TRAN-AMT
SC6383                = PDCM-ITRAN-AMT   + PDCM-PRSNT-AMT
SC6383     ELSE
SC6383           MOVE ZEROS TO VCHR077-PDC-TOWN-COUNT
SC6383                         VCHR077-PDC-TRAN-COUNT
SC6383                         VCHR077-PDC-TOWN-AMT
SC6383                         VCHR077-PDC-TRAN-AMT
SC6383     END-IF.
SC6383
SC6383     MOVE 7                 TO UT9000-CALL-CODE.
SC6383     MOVE ZEROS             TO UT9000-SOURCE-LENGTH.
SC6383     MOVE SPACES            TO UT9000-CALL-STATUS.
SC6383     MOVE 3                 TO UT9000-INST-NO.
SC6383     MOVE "BR0011"          TO UT9000-CALLING-ID.
SC6383     MOVE 12                TO UT9000-LANGUAGE-CODE.
SC6383     MOVE 1                 TO UT9000-REPORT-NO.
S10012*    MOVE 42                TO UT9000-SEQUENCE-NO.
S10012     MOVE 44                TO UT9000-SEQUENCE-NO.
SC6383     PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT
SC6383     IF (UT9000-CALL-STATUS = "0") AND
SC6383        (UT9000RA-LINE1 NOT = SPACES)
SC6383        MOVE UT9000RA-LINE1 TO WA-PDC-DESC
SC6383     ELSE
SC6383        MOVE "TOWN COUNT: TRAN COUNT: TOTAL:" TO WA-PDC-DESC
SC6383     END-IF.
SC6383     MOVE WA-PDC-DESC-1     TO VCHR077-PDC-DESC-1.
SC6383     MOVE WA-PDC-DESC-3     TO VCHR077-PDC-DESC-2.
SC6383     MOVE WA-PDC-DESC-2     TO VCHR077-PDC-DESC-3.
SC6383     MOVE WA-PDC-DESC-3     TO VCHR077-PDC-DESC-4.
SC6383
SC6383 N559-EXIT.
SC6383     EXIT.
SC6383/
131430 N1500-CALC-INT-DUE-DT.
131440*
131450* SETS WA-INT-ST-DATE TO THE NEXT CAP DATE
131460*
131470     IF BORM-INT-START-DATE = ZEROES OR
131480        ( BORP-CAPN-FREQ = 0 AND BORM-INT-REST = 0)
131490        MOVE ZEROES TO WA-INT-ST-DATE
131500                       WA-INT-DUE-DT
131510         GO TO N1599-EXIT
131520     ELSE
131530         MOVE BORM-INT-START-DATE TO       WA-PROC-DT-BINARY.
131540     MOVE WA-PROC-DT-BINARY      TO        WA-INT-ST-DATE
131550                                           UT0020-BINARY-DATE.
131560     MOVE 1                      TO        UT0020-FUNCTION.
131570     PERFORM X600-UT0020-PARA THRU X609-EXIT.
131580     MOVE UT0020-DATE-DDMMCCYY   TO        WA-PROC-DDMMCCYY.
131590     MOVE WA-DMY-1               TO        UT0020-BINARY-DATE.
131600     MOVE 1                      TO        UT0020-FUNCTION.
131610     PERFORM X600-UT0020-PARA THRU X609-EXIT.
131620     MOVE UT0020-DATE-DDMMCCYY   TO        WA-WORK-DDMMCCYY.
131630     SUBTRACT 1 FROM WA-WORK-CCYY-R.
131640 N1501.
131650     IF WA-PROC-CCYY-R < WA-WORK-CCYY-R
131660        ADD 1                    TO        WA-PROC-CCYY-R
131670        GO TO N1501.
131680     IF BORM-PAY-DAY         > 0
131690         MOVE BORM-PAY-DAY
131700                                 TO        WA-WORK-DD
131710     ELSE
131720     IF BORP-CAPN-DAY         > 0
131730         MOVE BORP-CAPN-DAY      TO        WA-WORK-DD.
131750     IF BORM-INT-REST         > 0
131760         MOVE BORM-INT-REST
131770                                 TO        WA-INT-FREQ
131780     ELSE
131790         MOVE BORP-CAPN-FREQ     TO        WA-INT-FREQ.
131800     IF WA-INT-FREQ = 98 AND BORM-TERM-BASIS = "M"                        
131810         MOVE BORM-LOAN-TRM      TO        WA-INT-FREQ.                   
131830     IF WA-INT-FREQ = 98 AND BORM-TERM-BASIS = "D"                        
131840        ADD BORM-LOAN-TRM TO WA-PROC-DT-BINARY                            
131850        GO TO N1530.                                                      
131860     IF WA-WORK-DD = WA-PROC-DD
131870         ADD WA-INT-FREQ         TO        WA-PROC-MM
131880     ELSE
131890     IF WA-WORK-DD > WA-PROC-DD
131900         MOVE WA-WORK-DD         TO        WA-PROC-DD
131910     ELSE
131920         ADD 1                   TO        WA-PROC-MM
131930         MOVE WA-WORK-DD         TO        WA-PROC-DD.
131940 N1520.
131950     IF WA-PROC-YY = 0
131960         DIVIDE WA-PROC-CC BY 4 GIVING W100-DUD
131970                            REMAINDER W100-REMAINDER
131980     ELSE
131990         DIVIDE WA-PROC-YY BY 4 GIVING W100-DUD
132000                            REMAINDER W100-REMAINDER.
132010     IF WA-PROC-MM  > 12
132020         SUBTRACT 12             FROM      WA-PROC-MM
132030         ADD 1                   TO        WA-PROC-CCYY-R.
132040     MOVE WA-PROC-DD             TO        WA-WORK-DD.
132050     IF WA-PROC-MM = 2
132060         IF WA-PROC-DD > 28
132070             IF W100-REMAINDER NOT = 0
132080*****            MOVE 28         TO        WA-PROC-DD.
132090                 MOVE 28         TO        WA-PROC-DD
132100             ELSE
132110                 MOVE 29         TO        WA-PROC-DD.
132120     IF WA-PROC-MM = 4 OR 6 OR 9 OR 11
132130         IF WA-PROC-DD > 30
132140           MOVE 30               TO        WA-PROC-DD.
132150     IF WA-PROC-DD > 31
132160         MOVE 31                 TO        WA-PROC-DD.
132170     MOVE WA-PROC-DDMMCCYY       TO        UT0030-DATE-DDMMCCYY.
132180     PERFORM X610-UT0030-PARA THRU X619-EXIT.
132190     MOVE UT0030-BINARY-DATE     TO        WA-PROC-DT-BINARY.
132200     IF WA-PROC-DT-BINARY < WA-DMY
132210         MOVE WA-PROC-DT-BINARY  TO        WA-INT-ST-DATE
132220         MOVE WA-WORK-DD         TO        WA-PROC-DD
132230         ADD WA-INT-FREQ         TO        WA-PROC-MM
132240         GO TO N1520.
132250     MOVE WA-PROC-DT-BINARY      TO        WA-INT-DUE-DT.
132260 N1530.
132270     ADD 1                       TO        WA-INT-ST-DATE.
132280     IF WA-INT-ST-DATE < BORM-INT-START-DATE
132290        MOVE BORM-INT-START-DATE  TO        WA-INT-ST-DATE.
132300 N1599-EXIT.
132310     EXIT.
132320/
B20175 O000-DEBIT-FEE-RTN.
132340*
132350* DEBIT FEE BEARING A/C WITH DETAILS FROM PASALONG
132360*
132370     ADD 1                         TO WA-FEE-CNT.
132390     MOVE WA-INPUT-MSG             TO WA-INPUT-MESSAGE-AREA.
132400     MOVE WA-OUTPUT-MSG            TO WA-SAVE-OUTPUT-MSG.
132410     MOVE STRT-AREA-TRN-NO         TO WA-TRAN-CODE
132420                                      WA-PASS-TRN-NO.
132440     IF WA-GENR-TX-TYPE(WA-FEE-CNT) = 1
132450        IF WA-TRAN-CODE-4 = 5 OR 6
132460           MOVE 6055                  TO WA-TRAN-CODE
132470        ELSE
132480           MOVE 1055                  TO WA-TRAN-CODE
132490        END-IF.
132500     IF WA-GENR-TX-TYPE(WA-FEE-CNT) = 2
132510        IF WA-TRAN-CODE-4 = 5 OR 6
132520           MOVE 6045                  TO WA-TRAN-CODE
132530        ELSE
132540           MOVE 1045                  TO WA-TRAN-CODE
132550        END-IF.
132560     IF WA-CORR-IND(WA-FEE-CNT) = 1
132570        ADD 100                    TO WA-TRAN-CODE
132580     END-IF.
132590*
132600* FEE BEAR A/C TXNS MUST BE POSTED AS NPB
132610*
132620     MOVE WA-TRAN-CODE             TO STRT-AREA-TRN-NO.
132630     MOVE STRT-AREA-EDIT-MASK      TO WA-FEE-BEAR-EDIT-MASK-AREA.
132640     MOVE WA-EDIT-MASK             TO WA-FEE-BEAR-MASK.
132650     MOVE STRT-AREA-TRN-NO         TO LINK-IN-TXCODE
132660                                      WA-SAVE-ACCT-TRAN.
132670     PERFORM X700-CALL-UT0250 THRU
132680             X799-EXIT.
132690     IF WA-MSG-ERR-FLAG = 1
132700        GO TO O099-EXIT
132710     END-IF.
132720     MOVE LINK-EDIT-TABLE          TO STRT-AREA-EDIT-MASK.
132730     MOVE LINK-POSTING-LEVEL       TO STRT-AREA-POSTING-LEVEL.
132740     MOVE STRT-AREA-PROCESS-BITS   TO FIELD-B.
132750     CALL "UT0022" USING
132760                                 PUAREA.
132770     MOVE FIELD-A                  TO WA-EDIT-MASK.
132780*     MOVE GLDM-RECORD-AREA         TO WA-SAVE-GLDM-RECORD.
132790*
132800* IF CURR OF FEE BEAR A/C NOT EQUAL CURR OF TRANSACTING A/C,
132810* CONVERT USING MID-RATE
132820*
132830     IF WA-FEE-BEAR-ACCT-CCY(WA-FEE-CNT) NOT =
132840        WA-SRC-ACCT-CCY(WA-FEE-CNT)
132850        MOVE 12                     TO UT0296CA-CALL-CODE
132860        MOVE WA-SRC-ACCT-CCY(WA-FEE-CNT)
132870                                    TO UT0296CA-TO-CURRENCY
132880        MOVE WA-TRF-AMT(WA-FEE-CNT) TO UT0296CA-FROM-AMOUNT
132890        MOVE WA-FEE-BEAR-ACCT-CCY(WA-FEE-CNT)
132900                                    TO UT0296CA-FROM-CURRENCY
132920        MOVE "GEN"                TO UT0296CA-SYSTEM
132930        MOVE 0                    TO UT0296CA-MULT-FROM-AMOUNT (1)
132940                                     UT0296CA-MULT-FROM-AMOUNT (2)
132950                                     UT0296CA-MULT-FROM-AMOUNT (3)
132960                                     UT0296CA-MULT-FROM-AMOUNT (4)
132970        MOVE WA-MULTI-BASE-CURR-AMT
132980             TO UT0296CA-FROM-BASE-EQUIVALENT
132990        MOVE WA-MULTI-RATE-TYPE       TO UT0296CA-RATE-TYPE
133000        MOVE WA-MULTI-CURR-VERSION    TO UT0296CA-RATE-VERSION
133010        MOVE WA-MULTI-COMMISSION      TO UT0296CA-COMMISSION
133020        MOVE WA-MULTI-CHANGE          TO UT0296CA-CHANGE
133030        IF WA-INPUT-PARAM-TABLE (8) = 1
133040           MOVE WA-STORE-TXN-DT
133050                                 TO UT0296CA-BACKDATED-DATE
133060        ELSE
133070           MOVE ZEROES           TO UT0296CA-BACKDATED-DATE
133080        END-IF
133090        CALL "UT0296" USING
133100                         UT0296-CALL-AREA
133110                         STARTAREA
133120                         SOC-PARAMS
133130        IF UT0296CA-CALL-STATUS = 0
133140           MOVE UT0296RA-COMPUTED-FROM-AMOUNT TO
133150                                      W800-TRF-AMOUNT
133160           MOVE UT0296RA-EQUIV-BASE-AMOUNT TO
133170                                      WA-MULTI-BASE-CURR-AMT
133180                                      WA-SAVE-BASE-TO-AMOUNT
133190        END-IF
133200        IF WA-MSG-ERR-FLAG = 1
133210           GO TO O099-EXIT
133220        END-IF
133230     ELSE
133240        MOVE WA-TRF-AMT(WA-FEE-CNT)    TO W800-TRF-AMOUNT
133250                                          WA-MULTI-BASE-CURR-AMT
133260                                          WA-SAVE-BASE-TO-AMOUNT
133270     END-IF.
133280     MOVE W800-TRF-AMOUNT              TO WA-MULTI-CURR-AMT.
133300     MOVE WA-FEE-BEAR-ACCT(WA-FEE-CNT) TO W800-FROM-ACCT.
133310     MOVE WA-FEE-BEAR-ACCT-CCY(WA-FEE-CNT)
133320                               TO WA-MULTI-ACCT-CURR-CD
133330                                  WA-MULTI-CURR-AMT-CURR-CD.
S12649     MOVE INVM-BRANCH-NO       TO WA-SAVE-GLDM-BRANCH.
133340     MOVE " " TO  W800-CHQ-DAYS.
133350     MOVE 0 TO  W800-DEF-INT-DAYS
133360                W800-DEB-DEF-INT-DAYS.
133370     MOVE SPACES                   TO WA-IN-NARR-TEXT.
133380*
133390* RETRIEVE NARR TEXT "TFRFRM" FROM TXTM
133400*
133410     IF WA-TFRFRM-FLAG = "N"
133420        MOVE 2                        TO UT9000-CALL-CODE
133430        MOVE SPACES                   TO UT9000-CALL-STATUS
133440        MOVE STRT-AREA-SOC-NO         TO UT9000-INST-NO
133450        MOVE "TFRFRM"                 TO UT9000-CALLING-ID
133460        MOVE SOC-LANGUAGE-CODE        TO UT9000-LANGUAGE-CODE
133470        MOVE 0                        TO UT9000-REPORT-NO
133480        MOVE 1                        TO UT9000-SEQUENCE-NO
133490        CALL "UT9000"   USING            UT9000-CALL-AREA
133500        IF  UT9000-CALL-STATUS NOT = 0
133510            MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
133520                                 UT8500CA-CALL-CODE
133530            MOVE SPACES TO UT8500CA-INPUT-MSG
133540            STRING "BR0000:(O000) UT9000 CALL ERROR, STAT- "
133550            UT9000-CALL-STATUS ", KEY- " UT9000-RECORD-KEY
133560            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
133570            CALL "UT8500" USING        UT8500CA-AREA
133580            MOVE "TRFD FRM" TO UT9000RA-LINE1
133590        END-IF
133600        MOVE UT9000RA-LINE1           TO WA-20-TRF-FROM-TXT
133610        MOVE "Y"                      TO WA-TFRFRM-FLAG
133620     END-IF.
133630*
133640* SETUP NARRATIVE FOR FEE BEAR TXN
133650*
133660     MOVE WA-FEE-SHRT-DESC(WA-FEE-CNT) TO WA-20-FEE-TXT.
133670* RETRIEVE CHECK DIGIT ON SOURCE-ACCT FOR SETTING UP OF NARR
133680     MOVE WA-SRC-ACCT(WA-FEE-CNT)  TO UT0151CA-ACCT-IN.
133690     MOVE 2                        TO UT0151CA-CALL-FUNC.
133700     MOVE SOC-ACCT-NO-FORMAT       TO UT0151CA-FORMAT.
133710     MOVE SOC-CHK-DGT              TO UT0151CA-CHK-DGT-TYPE.
133720     CALL "UT0151" USING              UT0151CA-CALL-AREA.
133730     IF UT0151CA-STATUS NOT = 0
133740        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
133750        MOVE SPACES TO UT8500CA-INPUT-MSG
133760        STRING "BR0000:(O000) UT0151 CALL ERROR; A/C NO - "
133770        UT0151CA-ACCT-IN "; STATUS - " UT0151CA-STATUS
133780        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
133790        CALL "UT8500" USING         UT8500CA-AREA
133800     END-IF.
133810*    IF   WA-INPUT-PARAM-TABLE(29) = 1
133820*         IF  WA-INPUT-PARAM-TABLE(30) NOT = 1
133830*             MOVE WA-REPAY-TXN-DATE TO W800-TRF-DATE.
133840     MOVE UT0151CA-ACCT-EX         TO WA-20-FROM-ACCT-NO.
133850     MOVE WA-20-FEE-NARR           TO WA-IN-NARR-TEXT.
133870*
133880* SET FLAG FOR FEE BEARING TXN AND TO SKIP FEE CALCULATION
133890*
133900     MOVE 1                        TO WA-FEE-TRF-TXN.
133910     MOVE 1                        TO WA-SKIP-FEE-CALC.
133920     CALL "UT0800" USING
133940                         STARTAREA
133950                         W300-ERROR-AREA
133960                         WA-JRNL-CALL-AREA
133970                         WA-PASSALONG
133980                         MULTI-OVERRIDE-AREA
133990                         CHECK-RESPONSE-AREA
134000                         WA-OTHER-SAVE-AREAS
134010                         PBOOKCA-LINE-AREA
SC9608                         UTVTACCA-CALL-PARAM.
SC5612     IF WA-MSG-ERR-FLAG = 0
SC5612        PERFORM C000-PRE-IMAGE-LOG THRU C099-EXIT
SC5612     END-IF
134020     MOVE WA-PASS-TRN-NO             TO STRT-AREA-TRN-NO.
134030     MOVE WA-FEE-BEAR-EDIT-MASK-AREA TO STRT-AREA-EDIT-MASK.
134040     MOVE WA-FEE-BEAR-MASK           TO WA-EDIT-MASK.
134050     MOVE WA-INPUT-MESSAGE-AREA      TO WA-INPUT-MSG.
134060     MOVE WA-SAVE-OUTPUT-MSG         TO WA-OUTPUT-MSG.
134070 O099-EXIT.
134080     EXIT.
134090*
134100/
134110***  THIS ROUTINE IS USED TO CANCEL LOAN.
134120***  TRAN CODE 12410                         ***
134130 O100-CANCEL-LOAN.
S11773     IF  BORP-YOUBE
S11773         MOVE WA-CANC-REAS-CODE TO WA-DISCH-REASON-CD
S15519         MOVE WA-CANC-REPAY-SOURCE TO BORM-MORTGAGE-INSU
S11773         IF WA-CANCEL-CD
S11773            IF WA-CANC-CLOSE-IND = SPACES
S11773            AND BORM-STAT = 01
S11773               NEXT SENTENCE
S11773            ELSE
S11773               MOVE 4846 TO WA-OUTPUT-ERR-MSG-NO
S11773               MOVE 1    TO WA-MSG-ERR-FLAG
S11773               GO TO O199-EXIT
S11773            END-IF
S11773         ELSE
S11773              IF WA-CANC-REASON NOT = SPACES OR
S11773                 WA-CANC-CLOSE-IND  = SPACES OR
S11773                 BORM-STAT = 01
S11773                 MOVE 4846 TO WA-OUTPUT-ERR-MSG-NO
S11773                 MOVE 1    TO WA-MSG-ERR-FLAG
S11773                 GO TO O199-EXIT
S11773              END-IF
S11773              PERFORM O150-GET-REASON-CODE
S11773              THRU O150-EXIT
S11773              IF WA-MSG-ERR-FLAG <> 0
S11773                 GO TO O199-EXIT
S11773              END-IF
S11773         END-IF
S11773     ELSE
134140     IF WA-CANC-REAS-CODE > 0 AND < 10
134150         NEXT SENTENCE
134160     ELSE
134170         MOVE 353 TO WA-OUTPUT-ERR-MSG-NO
134180         MOVE 1   TO WA-MSG-ERR-FLAG
134190         GO TO O199-EXIT.
S11773*    IF BORM-LOAN-BAL > ZERO OR < ZERO
S11773     IF BORM-LOAN-BAL > ZERO
134210        MOVE 352 TO WA-OUTPUT-ERR-MSG-NO
134220        MOVE 1 TO WA-MSG-ERR-FLAG
134230        GO TO O199-EXIT.
S11773     IF BORM-LOAN-BAL < ZERO
S11773        MOVE 3356 TO WA-OUTPUT-ERR-MSG-NO
S11773        MOVE 1 TO WA-MSG-ERR-FLAG
S11773        GO TO O199-EXIT.
S10330     IF  BORP-YOUBE                                         
S10330*S11455     AND BOIS-TEMP-PAYMENT-DUE NOT = 0                      
S11455         IF BOIS-TEMP-PAYMENT-DUE NOT = 0
S10330            MOVE 4743                   TO WA-OUTPUT-ERR-MSG-NO
S10330            MOVE 1                      TO WA-MSG-ERR-FLAG     
S10330            GO TO O199-EXIT                                    
S11455         END-IF                                                
S12332         IF BOIS-HOLD-AMT        NOT = 0
S12332            MOVE 210                    TO WA-OUTPUT-ERR-MSG-NO
S12332            MOVE 1                      TO WA-MSG-ERR-FLAG
S12332            GO TO O199-EXIT
S12332         END-IF
S11455         IF BOIS-UNAMORTIZED-DUE NOT = 0                       
S11455            MOVE 352                    TO WA-OUTPUT-ERR-MSG-NO
S11455            MOVE 1                      TO WA-MSG-ERR-FLAG     
S11455            GO TO O199-EXIT                                    
S11455         END-IF                                                
S11773         IF BOIS-MISC-FEE1-DUE NOT = 0
S11773            MOVE 1638         TO WA-OUTPUT-ERR-MSG-NO
S11773            MOVE 1                      TO WA-MSG-ERR-FLAG
S11773            GO TO O199-EXIT
S11773         END-IF
S16480         IF BOIS-MISC-FEE2-DUE NOT = 0
S16480         OR BOIS-LEGAL-FEE1-DUE NOT = 0
S16480         OR BOIS-LEGAL-FEE2-DUE NOT = 0
S16480            MOVE 1638 TO WA-OUTPUT-ERR-MSG-NO
S16480            MOVE 1    TO WA-MSG-ERR-FLAG
S16480            GO        TO O199-EXIT
S16480         END-IF
S11773         COMPUTE WA-BORM-INT-TOTAL  ROUNDED = BORM-INT-ACCR +
S11773                                    BORM-INT-ADJUSTMENT
S11773         IF BOIS-REV-RECEIVABLE-DUE NOT = 0
S11773         OR WA-BORM-INT-TOTAL NOT = 0
S11773         OR BOIS-INTEREST-DUE NOT = 0
S17743**S11773 OR BOIS-YET-COLLECT-INT NOT = 0
S11773            MOVE 352          TO WA-OUTPUT-ERR-MSG-NO
S11773            MOVE 1    TO WA-MSG-ERR-FLAG
S11773            GO TO O199-EXIT
S11773         END-IF
S12142         IF  BOIS-DEBATABLE-AMT NOT = 0
S12142             MOVE 5036         TO WA-OUTPUT-ERR-MSG-NO
S12142             MOVE 1            TO WA-MSG-ERR-FLAG
S12142             GO TO O199-EXIT
S12142         END-IF
S12062         IF  BORM-LOAN-BAL = ZERO
S12062         AND BOIS-GL-BUCKET-DUE(2) > ZERO
S12062            MOVE 352          TO WA-OUTPUT-ERR-MSG-NO
S12062            MOVE 1    TO WA-MSG-ERR-FLAG
S12062            GO TO O199-EXIT
S12062         END-IF
S10330     END-IF.                                                
S10646     IF BORP-CONSMR-MORT-COMBI
S10646     AND BOIS-SORD-AUTO-DBT-ACCT-NO > ZEROS
S10646     AND BOIS-OD-ACCT-NUMBER > ZEROS
S10646        MOVE BOIS-SORD-AUTO-DBT-ACCT-NO TO WA-DEP-NO-W
S10646        MOVE WA-DEP-NO-W             TO WA-DEP-NO-X
S10646        MOVE STRT-AREA-SOC-NO        TO INOD-SOC-NO
S10646        MOVE WA-DEP-NO               TO INOD-DEP-NO
S10646        MOVE BOIS-OD-ACCT-NUMBER     TO INOD-OD-NO
S10646        MOVE INOD-KEY                TO DBIOMOD-KEY
S10646        MOVE 0                       TO DBIOMOD-KEY-NO
S10646        MOVE "READ"                  TO DBIOMOD-FUNCTION
S10646        PERFORM H400-ACCESS-INOD THRU H499-EXIT
S10646        IF DBIOMOD-STAT NOT = "****"
S10646           IF DBIOMOD-STAT = "MRNF"
S10646              MOVE 3686              TO WA-OUTPUT-ERR-MSG-NO
S10646              MOVE 1                 TO WA-MSG-ERR-FLAG
S10646              GO                     TO O199-EXIT
S10646           ELSE
S10646              MOVE 4613              TO WA-OUTPUT-ERR-MSG-NO
S10646              MOVE 1                 TO WA-MSG-ERR-FLAG
S10646              GO                     TO O199-EXIT
S10646           END-IF
S10646        END-IF
S10646        IF INOD-ACCT-STATUS NOT = "C" AND "H"
S16378         IF NOT (BORP-USAGE-LOAN)
S10646           MOVE 2822                 TO WA-OUTPUT-ERR-MSG-NO
S10646           MOVE 1                    TO WA-MSG-ERR-FLAG
S10646           GO                        TO O199-EXIT
S16378         END-IF
S10646        END-IF
S10646        IF BOIS-OD-ACCT-NUMBER > ZEROS
S16378         IF NOT (BORP-USAGE-LOAN)
S10646           MOVE INOD-SOC-NO          TO UTINODCA-SOC-NO
S10646           MOVE INOD-DEP-NO          TO UTINODCA-DEP-NO
S10646           MOVE INOD-OD-NO           TO UTINODCA-OD-NO
S10646           MOVE INOD-DATA-REC        TO UTINODCA-DATA-REC
S10646           MOVE 26                   TO UTINODCA-CALL-CODE
S10646           CALL "UTINOD" USING UTINOD-CALL-AREA
S10646                               STARTAREA
S10646                               WA-INVM-RECORD-AREA
S10646           IF UTINODCA-STATUS NOT = 0
S10646              MOVE 4613              TO WA-OUTPUT-ERR-MSG-NO
S10646              MOVE 1                 TO WA-MSG-ERR-FLAG
S10646              GO                     TO O199-EXIT
S10646           END-IF
S16378         END-IF
S10646        END-IF
S10646     END-IF.
134240     MOVE BORM-APP-AMT TO WA-WORK-AMT.
134250     MULTIPLY WA-WORK-AMT BY -1 GIVING WA-DUMMY-AMT.
134260     MOVE WA-DUMMY-AMT TO WA-DUMMY-BAL.
134270     ADD WA-DUMMY-AMT TO BORM-APP-AMT.
S11773     IF BORP-YOUBE AND
S11773        NOT WA-CANCEL-CD
S11773        MOVE WA-CANC-REAS-CODE TO BOIS-DISCHARGE-REASON-CODE
S11773        MOVE WA-CANC-CLOSE-IND TO BOIS-LOANER-CLOSE-IND
S11773                                  WA-LOANER-CLOSE-IND
S15519*S11773                           VCHR077-DESC
S15519                                  VCHR077-DESC(3:1)
S15519        MOVE WA-CANC-REPAY-SOURCE TO BORM-MORTGAGE-INSU
S15519        MOVE BORM-MORTGAGE-INSU   TO VCHR077-DESC(1:1)
S11773        IF WA-LOANER-TRANSFER OR WA-LOANER-SECURITY
S15519           OR WA-LOANER-RECLAIM
S11773           MOVE WA-CANC-NEW-ID-TYPE TO  WA-LOANER-NEW-ID-TYPE
S11773           IF NOT WA-VALID-ID-TYPE
S11773              MOVE  1               TO WA-MSG-ERR-FLAG
S11773              MOVE  1040            TO WA-OUTPUT-ERR-MSG-NO
S11773              GO TO O199-EXIT
S11773           END-IF
S11773           INITIALIZE                   UT0159CA-CALL-AREA
S11773           MOVE 01                  TO  UT0159CA-CALL-CODE
S11773           MOVE STRT-AREA-SOC-NO OF STARTAREA TO UT0159CA-INST-NO
S11773           MOVE WA-CANC-NEW-ID-TYPE TO  UT0159CA-ID-TYPE
S11773           MOVE WA-CANC-NEW-ID      TO  UT0159CA-ID-NUMBER
S11773           MOVE    0                TO  UT0159CA-CALL-STATUS
S11773           CALL    "UT0159"         USING UT0159CA-CALL-AREA
S11773           IF UT0159CA-CALL-STATUS  NOT = ZERO
S11773              MOVE  1                    TO WA-MSG-ERR-FLAG
S11773              MOVE  UT0159CA-CALL-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
S11773              GO TO O199-EXIT
S11773           END-IF
S11773           IF WA-ID-TYPE-CORP
S11773              MOVE WA-CANC-NEW-ID(1:8) TO BOIS-LOANER-NEW-ID
S11773           ELSE
S11773              MOVE WA-CANC-NEW-ID      TO BOIS-LOANER-NEW-ID
S11773           END-IF
S15519           PERFORM O1A0-CHECK-PROC-NO  THRU O1A9-EXIT
S15519           IF WA-MSG-ERR-FLAG NOT = 0
S15519              GO TO O199-EXIT
S15519           END-IF
S11773           MOVE WA-CANC-PROC-NO        TO BOIS-LOANER-PROC-NO
S11773        END-IF
S11773     END-IF.
134280     IF  BORM-ADV-VAL > BORM-APP-AMT
S10203     AND NOT BORP-YOUBE
134290        MOVE 135 TO WA-OUTPUT-ERR-MSG-NO
134300        MOVE 1 TO WA-MSG-ERR-FLAG
134310        GO TO O199-EXIT.
134320     IF  WA-CANC-SUB-LEDG-CODE < 1 OR
134330         WA-CANC-SUB-LEDG-CODE > 30
134340         MOVE 1 TO WA-MSG-ERR-FLAG
134350         MOVE 194 TO WA-OUTPUT-ERR-MSG-NO
134360         GO TO O199-EXIT.
134370     MOVE STRT-AREA-POST-DT TO BORM-LST-FIN-DATE.
S11773     IF BORP-YOUBE
S11773        MOVE STRT-AREA-POST-DT TO BORM-LST-MNT-DATE.
NR2001*134380     PERFORM U100-PK-BRANCH-TERM-TELL THRU U199-EXIT.
NR2001*134390     INITIALIZE BORV-01-DETAIL.
NR2001*134400     MOVE 01 TO BORV-01-CODE.
NR2001*134410     MOVE ZERO TO BORV-01-STATUS BORV-01-CHQ-DAYS BORV-01-ARREARS.
NR2001*134420     MOVE STRT-AREA-POST-DT TO BORV-01-TRN-DATE BORV-01-POST-DATE.
NR2001*134430     MOVE UPTELLCA-TELLER-BRANCH TO BORV-01-TELL-AND-BR.
NR2001*134440     MOVE STRT-AREA-TERM-NO TO BORV-01-BRTERM.
NR2001*134450     MOVE STRT-AREA-TRN-NO TO BORV-01-TRN-CODE.
NR2001*134460     MOVE STRT-AREA-JRNL-NO TO BORV-01-JRNL-NO.
NR2001*134470     MOVE WA-CANC-SUB-LEDG-CODE TO BORV-01-SUB-LEDG-CODE.
NR2001*134480     MOVE WA-DUMMY-AMT TO BORV-01-AMOUNT.
NR2001*134490     MOVE BORM-LOAN-BAL TO BORV-01-BALANCE.
NR2001     INITIALIZE BOCT-TRAN-01.
NR2001     MOVE 01                    TO BOCT-TRAN-TYPE.
NR2001     MOVE ZERO                  TO BOCT-STAT.
NR2001     MOVE STRT-AREA-POST-DT     TO BOCT-TRN-DATE.
NR2001     MOVE STRT-AREA-TRN-NO      TO BOCT-TRN-CODE.
NR2001     MOVE ZERO                  TO BOCT-01-CHQ-DAYS.
NR2001     MOVE ZERO                  TO BOCT-01-ARREARS.
NR2001     MOVE WA-CANC-SUB-LEDG-CODE TO BOCT-01-SUB-LEDG-CODE.
S15609*NR2001     MOVE WA-DUMMY-AMT          TO BOCT-01-AMOUNT.
S15609     MOVE 0                     TO BOCT-01-AMOUNT.
NR2001     MOVE BORM-LOAN-BAL         TO BOCT-01-BALANCE.
134500     IF  BORM-REPAY-TYPE = 9
134510       IF  BORM-REPAY-IN-AFFECT NOT = "Y"
SC3511           MOVE BORM-RECORD-AREA TO WA-SAVE-BORM-AREA
134520           PERFORM X200-FORMAT-SDCV-DELETE THRU X299-EXIT
SC3511           MOVE WA-SAVE-BORM-AREA TO BORM-RECORD-AREA
134530           IF  WA-MSG-ERR-FLAG NOT = 0
134540               GO TO O199-EXIT.
NR2001*134550     MOVE STRT-AREA-MSG-TIME TO BORV-01-POST-TIME.
NR2001     MOVE STRT-AREA-MSG-TIME TO BOCT-01-REPOST-TIME.
134560     PERFORM W500-ADD-TXN THRU W599-EXIT.
134570     IF WA-MSG-ERR-FLAG = 1
134580        GO TO O199-EXIT.
134590*
134600     MOVE 0 TO WA-STORE-ACCR-INT.
134610*AXS
134620     IF BORM-SHRE-CAP-IND = 1
134630       PERFORM Z3100-RETRIEVE-BSHR THRU Z3199-EXIT
134640       IF WA-MSG-ERR-FLAG = 1
134650          GO TO O199-EXIT
134660       END-IF
134670     ELSE
134680     IF BORM-SHRE-CAP-IND = 0
134690        MOVE ZEROS                   TO BSHR-CAP-VAL
134700                                        BSHR-INT-ACCR
134710                                        BSHR-INT-INCR
134720     END-IF.
134730*    IF BORM-SHRE-CAP-VAL = 0
134740*       IF BORM-ACCR-SHRE-INT = 0
134750     MOVE 0 TO WA-BSHR-INT-ACCR
134760               WA-BSHR-CAP-VAL.
134770     IF BSHR-CAP-VAL = 0
134780        IF BSHR-INT-ACCR = 0
134790           GO TO O105.
134800     MOVE 12411 TO LINK-IN-TXCODE.
134810     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
134820     IF WA-MSG-ERR-FLAG = 1
134830        GO TO O199-EXIT.
NR2001*134840     MOVE WA-CANC-SUB-LEDG-CODE TO BORV-01-SUB-LEDG-CODE.
NR2001     MOVE WA-CANC-SUB-LEDG-CODE TO BOCT-01-SUB-LEDG-CODE.
134850     MULTIPLY BSHR-INT-ACCR BY -1
134860              GIVING WA-STORE-ACCR-INT ROUNDED.
134870     MOVE BSHR-INT-ACCR TO WA-BSHR-INT-ACCR.
134880     MOVE BSHR-CAP-VAL  TO WA-BSHR-CAP-VAL.
134890     MOVE 0 TO BSHR-INT-ACCR
134900               BSHR-INT-INCR.
134910*    MOVE 0 TO BORM-ACCR-SHRE-INT
134920*              BORM-SHRE-INT-INCR.
134930*    MOVE BORM-SHRE-CAP-VAL TO WA-WORK-AMT.
134940     MOVE BSHR-CAP-VAL TO WA-WORK-AMT.
134950     MULTIPLY WA-WORK-AMT BY -1 GIVING WA-DUMMY-AMT.
134960     ADD WA-DUMMY-AMT TO BSHR-CAP-VAL.
134970*    ADD WA-DUMMY-AMT TO BORM-SHRE-CAP-VAL.
NR2001*134980     COMPUTE BORV-01-AMOUNT = WA-DUMMY-AMT +
NR2001*134990                              WA-STORE-ACCR-SHRE-INT.
NR2001*135000     MOVE BORM-LOAN-BAL TO BORV-01-BALANCE.
NR2001*135010     MOVE WA-DUMMY-AMT TO BORV-01-AMOUNT.
NR2001*135020     MOVE 12411            TO BORV-01-TRN-CODE.
NR2001*135030     MOVE STRT-AREA-MSG-TIME   TO BORV-01-POST-TIME.
NR2001     MOVE 12411              TO BOCT-TRN-CODE.
NR2001     COMPUTE BOCT-01-AMOUNT = WA-DUMMY-AMT +
NR2001                              WA-STORE-ACCR-SHRE-INT.
NR2001     MOVE BORM-LOAN-BAL      TO BOCT-01-BALANCE.
NR2001     MOVE WA-DUMMY-AMT       TO BOCT-01-AMOUNT.
NR2001     MOVE STRT-AREA-MSG-TIME TO BOCT-01-REPOST-TIME.
135040     PERFORM W500-ADD-TXN THRU W599-EXIT.
135050     IF WA-MSG-ERR-FLAG = 1
135060        GO TO O199-EXIT.
135070*
135080*  SET UP TYPE 20 TXN.
135090*
135100     MOVE STRT-AREA-TRN-NO TO LINK-IN-TXCODE.
135110     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
135120     IF WA-MSG-ERR-FLAG = 1
135130         GO TO O199-EXIT.
135140     IF (LINK-NARR-TXN-TYPE = 20) OR
135150        (WA-IN-NARR-TEXT NOT = SPACES)
135160         PERFORM O200-ADD-TYPE-20 THRU O299-EXIT
135170         IF WA-MSG-ERR-FLAG = 1
135180             GO TO O199-EXIT.
135190*
135200 O105.
135210     IF WA-CANC-REAS-CODE = 0
135220        GO TO O110-CONT.
135230***  MOVE SPACES TO WA-CANCEL-REASON.
NR2001*135240     INITIALIZE BORV-33-DETAIL.
NR2001*135250     MOVE 33 TO BORV-33-CODE.
NR2001*135260     MOVE ZERO TO BORV-33-STATUS.
NR2001*135270     MOVE STRT-AREA-POST-DT TO BORV-33-POST-DATE
NR2001*135280                              BORV-33-AMEND-DATE.
NR2001*135290     MOVE UPTELLCA-TELLER-BRANCH TO BORV-33-TELL-AND-BR.
NR2001*135300     MOVE STRT-AREA-TERM-NO TO BORV-33-BRTERM.
NR2001*135310     MOVE STRT-AREA-TRN-NO TO BORV-33-TRN-CODE.
NR2001*135320     MOVE STRT-AREA-JRNL-NO TO BORV-33-JRNL-NO.
NR2001*135330     MOVE WA-CANC-REAS-CODE TO WA-CANCEL-CODE.
NR2001*135340     MOVE WA-CANC-REASON TO WA-CANCEL-MSG.
NR2001*135350     MOVE WA-CANCEL-REASON TO BORV-33-FREE-MSG.
NR2001     INITIALIZE BOCT-TRAN-33.
NR2001     MOVE 33                TO BOCT-TRAN-TYPE.
NR2001     MOVE ZERO              TO BOCT-STAT.
NR2001     MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE
NR2001     MOVE STRT-AREA-TRN-NO  TO BOCT-TRN-CODE.
NR2001     MOVE STRT-AREA-POST-DT TO BOCT-33-AMEND-DATE.
NR2001     MOVE WA-CANC-REAS-CODE TO WA-CANCEL-CODE.
NR2001     MOVE WA-CANC-REASON    TO WA-CANCEL-MSG.
NR2001     MOVE WA-CANCEL-REASON  TO BOCT-33-FREE-MSG.
135360     PERFORM W500-ADD-TXN THRU W599-EXIT.
135370     IF WA-MSG-ERR-FLAG = 1
135380        GO TO O199-EXIT.
135390 O110-CONT.
135400     IF  WA-MSG-ERR-FLAG = 1
135410         GO TO O199-EXIT.
135420     PERFORM O500-CHECK-SPEC-CONDS THRU O599-EXIT.
135430     IF WA-MSG-ERR-FLAG = 1
135440        GO TO O199-EXIT.
135450     IF BORM-SHRE-CAP-IND = 1
135460        PERFORM Z4200-AMEND-BSHR THRU Z4299-EXIT
135470        IF WA-MSG-ERR-FLAG = 1
135480           GO TO O199-EXIT.
SC5203     MOVE SPACES TO WS-NO-REC-FOUND.
SC5203     PERFORM O143-CHECK-XFAR
SC5203        THRU O143-EXIT.
SC6376**--
SC6376     PERFORM O144-CHECK-ACFR
SC6376        THRU O144-EXIT.
SC6376**--
135490     PERFORM V300-RESET-CUSM THRU V399-EXIT.
135500     MOVE SPACES TO WA-OUTPUT-MESSAGE.
135510     MOVE STRT-AREA-JRNL-NO TO WA-OUTPUT-JRNL-NO.
135520     MOVE 4 TO WA-INPUT-MSG-CODE.
135530     MOVE 999 TO WA-OUTPUT-ERR-MSG-NO.
135540     MOVE 87 TO WA-OUTPUT-MSG-LENGTH.
135550     PERFORM E1000-PRE-FMT-SEND-PARA
135560        THRU E1999-EXIT.
135570 O199-EXIT.
135580     EXIT.
S15519 O1A0-CHECK-PROC-NO.
S15519     IF  WA-LOANER-PROC-SIGN-DAY NOT NUMERIC OR
S15519         WA-LOANER-PROC-DATE     NOT NUMERIC OR
S15519         WA-LOANER-PROC-TRF-DATE NOT NUMERIC
S15519         MOVE 1    TO WA-MSG-ERR-FLAG
S15519         MOVE 793  TO WA-OUTPUT-ERR-MSG-NO
S15519         GO TO O1A9-EXIT
S15519     END-IF.
S15519*
S15519     MOVE WA-LOANER-PROC-SIGN-YYY TO WA-PROC-SIGN-CCYY.
S15519     MOVE WA-LOANER-PROC-SIGN-MM  TO WA-PROC-SIGN-MM.
S15519     MOVE WA-LOANER-PROC-SIGN-DD  TO WA-PROC-SIGN-DD.
S15519     COMPUTE WA-PROC-SIGN-CCYY =
S15519             WA-LOANER-PROC-SIGN-YYY + 1911.
S15519     IF WA-PROC-SIGN-CCYY > 1992 AND
S15519        WA-PROC-SIGN-MM-OK
S15519        NEXT SENTENCE
S15519     ELSE
S15519         MOVE 1    TO WA-MSG-ERR-FLAG
S15519         MOVE 793  TO WA-OUTPUT-ERR-MSG-NO
S15519         GO TO O1A9-EXIT
S15519     END-IF.
S15519
S15519     IF WA-PROC-SIGN-YY = 0
S15519         DIVIDE WA-PROC-SIGN-CC BY 4 GIVING WA-LEAP-REM
S15519                                  REMAINDER WA-REMAINDER
S15519     ELSE
S15519         DIVIDE WA-PROC-SIGN-YY BY 4 GIVING WA-LEAP-REM
S15519                                  REMAINDER WA-REMAINDER.
S15519     MOVE 28                     TO   WA-FEB-DAYS.
S15519     IF WA-REMAINDER = 0
S15519         MOVE 29                 TO   WA-FEB-DAYS
S15519     END-IF.
S15519*
S15519     IF WA-PROC-SIGN-MM = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12
S15519        IF WA-PROC-SIGN-DD > 31
S15519           MOVE 1    TO WA-MSG-ERR-FLAG
S15519           MOVE 793  TO WA-OUTPUT-ERR-MSG-NO
S15519           GO TO O1A9-EXIT
S15519        END-IF
S15519     ELSE IF WA-PROC-SIGN-MM = 4 OR 6 OR 9 OR 11
S15519             IF WA-PROC-SIGN-DD > 30
S15519                MOVE 1    TO WA-MSG-ERR-FLAG
S15519                MOVE 793  TO WA-OUTPUT-ERR-MSG-NO
S15519                GO TO O1A9-EXIT
S15519             END-IF
S15519          ELSE IF WA-PROC-SIGN-MM = 2
S15519                  IF WA-PROC-SIGN-DD > WA-FEB-DAYS
S15519                     MOVE 1    TO WA-MSG-ERR-FLAG
S15519                     MOVE 793  TO WA-OUTPUT-ERR-MSG-NO
S15519                     GO TO O1A9-EXIT
S15519                  END-IF
S15519               END-IF
S15519          END-IF
S15519     END-IF.
S15519*
S15519     MOVE WA-LOANER-PROC-DATE-YYY TO WA-PROC-SIGN-CCYY.
S15519     MOVE WA-LOANER-PROC-DATE-MM  TO WA-PROC-SIGN-MM.
S15519     COMPUTE WA-PROC-SIGN-CCYY =
S15519             WA-LOANER-PROC-SIGN-YYY + 1911.
S15519     IF WA-PROC-SIGN-CCYY > 1992 AND
S15519        WA-PROC-SIGN-MM-OK
S15519        NEXT SENTENCE
S15519     ELSE
S15519         MOVE 1    TO WA-MSG-ERR-FLAG
S15519         MOVE 793  TO WA-OUTPUT-ERR-MSG-NO
S15519         GO TO O1A9-EXIT
S15519     END-IF.
S15519*
S15519         MOVE WA-LOANER-PROC-TRF-YYY TO WA-PROC-SIGN-CCYY
S15519         MOVE WA-LOANER-PROC-TRF-MM  TO WA-PROC-SIGN-MM
S15519         COMPUTE WA-PROC-SIGN-CCYY =
S15519                 WA-LOANER-PROC-SIGN-YYY + 1911
S15519         IF WA-PROC-SIGN-CCYY > 1992 AND
S15519            WA-PROC-SIGN-MM-OK
S15519            NEXT SENTENCE
S15519         ELSE
S15519            MOVE 1    TO WA-MSG-ERR-FLAG
S15519            MOVE 793  TO WA-OUTPUT-ERR-MSG-NO
S15519            GO TO O1A9-EXIT
S15519         END-IF.
S15519 O1A9-EXIT.
S15519     EXIT.
135590/
135600 O200-ADD-TYPE-20.
135610*
135620*  SAVE 01 AREA FOR LATER USE IN WRITING RECIEPT OR PASSBOOK ENTRY 
135630*
NR2001*135640     MOVE BORV-01-DETAIL TO WA-BORV-RECIEPT-AREA.
NR2001     MOVE BOCT-RECORD-AREA TO WA-BOCT-RECIEPT-AREA.
135650*
135660* DETERMINE WHICH METHOD IS TO BE USED FOR THE NARRATION:
135670*    1) USING THE AREA PASSED IN THE WA-NARR-TEXT INPUT MESSAGE
135680*    2) USING THE ED2/TXTM PARAMETER METHOD
135690*
135700     MOVE "FALSE" TO WA-TEXT-AVAIL-FLAG.
135710*
135720     IF WA-IN-NARR-TEXT = SPACES
135730*    (2)
135740         IF LINK-TCNARR-SEQ-NO NOT = 0
135750             MOVE 2 TO UT9000-CALL-CODE
135760             MOVE " "                   TO UT9000-CALL-STATUS
135770             MOVE STRT-AREA-SOC-NO      TO UT9000-INST-NO
135780             MOVE "TCNARR"              TO UT9000-CALLING-ID
135790             MOVE STRT-AREA-TELLER-LANG TO UT9000-LANGUAGE-CODE
135800             MOVE 1                     TO UT9000-REPORT-NO
135810             MOVE LINK-TCNARR-SEQ-NO    TO UT9000-SEQUENCE-NO
135820             PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT
135830             IF (UT9000-CALL-STATUS = "0") AND
135840                        (UT9000RA-LINE1 NOT = SPACES)
NR2001*135850                 MOVE UT9000RA-LINE1 TO BORV-20-CHQ-PAYEE
NR2001                 MOVE UT9000RA-LINE1 TO BOCT-20-CHQ-PAYEE
135860                 MOVE "TRUE" TO WA-TEXT-AVAIL-FLAG
135870             END-IF
135880         END-IF
135890     ELSE
135900*    (1)
NR2001*135910         MOVE WA-IN-NARR-TEXT TO BORV-20-CHQ-PAYEE
NR2001         MOVE WA-IN-NARR-TEXT TO BOCT-20-CHQ-PAYEE
135920         MOVE "TRUE" TO WA-TEXT-AVAIL-FLAG
135930     END-IF.
135940*
135950     IF WA-TEXT-AVAIL
NR2001*135960         MOVE 20                TO BORV-20-CODE
NR2001*135970         MOVE STRT-AREA-POST-DT TO BORV-20-POST-DATE
NR2001*135980         MOVE 0                 TO BORV-20-STATUS
NR2001*135990         MOVE STRT-AREA-JRNL-NO TO BORV-20-JRNL-NO
NR2001         MOVE 20                TO BOCT-TRAN-TYPE
NR2001         MOVE 0                 TO BOCT-STAT
NR2001         MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE
136000*
136010***      CALL  DBIO AND POST THE TRANSACTION ****
136020*
136030         PERFORM W500-ADD-TXN THRU W599-EXIT
136040     END-IF.
136050 O299-EXIT.
136060     EXIT.
136070*
136080 O500-CHECK-SPEC-CONDS.
136090*
136100*    WHEN A LOAN IS DISCHARGED OR CANCELLED, CHECK IF LOAN
136110*    HAS ANY SPECIAL CONDITIONS LINKED TO IT -IF IT DOES
136120*    DECREASE NO. OF COUNTS IN MASTER BCOV BY 1
136130*
136140     MOVE "UU" TO DBIO-CALL-TXN-TYPE-AREA.
136150*  SPR# 760328
136160     MOVE 0 TO DBIO-CALL-REFER-AREA.
136170     PERFORM W750-READ-BLDVUU THRU W759-EXIT.
136180     IF WA-MSG-ERR-FLAG = 1
136190         GO TO O599-EXIT.
136200     PERFORM O600-PROCESS-SP-CONDS THRU O699-EXIT
136210         UNTIL DBIO-CALL-STATUS = "XCOT"
136220         OR    DBIO-CALL-SAVE-REFER = "END."
136230               OR WA-MSG-ERR-FLAG = 1.
136240 O599-EXIT.
136250     EXIT.
136260/
136270 O600-PROCESS-SP-CONDS.
136280     IF BLDV-UU-CANCEL-FLAG = 1
136290         GO TO O690-READ-NEXT-BLDV.
136300*
136310     MOVE DBIO-CALL-SAVE-REFER TO WA-STORE-SAVE-REFER.
136320     MOVE DBIO-CALL-REFER-AREA TO WA-STORE-REFER-AREA.
136330*
136340     MOVE 0 TO BCOV-VERSION.
136350     MOVE BLDV-UU-CONDITION-NO TO BCOV-CONDITION-NO.
136360     MOVE 81 TO DBIO-CALL-FUNC.
136370     MOVE "BEGN" TO DBIO-CALL-SAVE-REFER.
136380     PERFORM W950-BCOV THRU W959-EXIT
136390         UNTIL BCOV-VERSION = BLDV-UU-VERSION-NO
136400             OR DBIO-CALL-SAVE-REFER = "END."
136410                 OR DBIO-CALL-STATUS = "MRNF"
136420                     OR WA-MSG-ERR-FLAG = 1.
136430     IF WA-MSG-ERR-FLAG = 1
136440         GO TO O699-EXIT
136450     ELSE
136460****     IF DBIO-CALL-SAVE-REFER = "END."
136470         IF DBIO-CALL-STATUS = "MRNF"
136480            PERFORM W960-BCOV-ERROR THRU W969-EXIT
136490            GO TO O699-EXIT.
136500     SUBTRACT 1 FROM BCOV-ACCOUNT-COUNT.
136510     MOVE 84 TO DBIO-CALL-FUNC.
136520     MOVE BLDV-UU-CONDITION-NO TO BCOV-CONDITION-NO.
136530     PERFORM W950-BCOV THRU W959-EXIT.
136540     IF WA-MSG-ERR-FLAG = 1
136550         GO TO O699-EXIT.
136560 O690-READ-NEXT-BLDV.
136570*
136580     MOVE WA-STORE-SAVE-REFER TO DBIO-CALL-SAVE-REFER.
136590     MOVE WA-STORE-REFER-AREA TO DBIO-CALL-REFER-AREA.
136600*
136610     ADD 1 TO DBIO-CALL-REFER-AREA.
136620     PERFORM W750-READ-BLDVUU THRU W759-EXIT.
136630 O699-EXIT.
136640     EXIT.
136650/
136660 O700-SP-COND-COMPLY-CHK.
136670     MOVE "UU" TO DBIO-CALL-TXN-TYPE-AREA.
136680     MOVE 0 TO DBIO-CALL-REFER-AREA.
136690 O700-CALL.
136700     PERFORM W750-READ-BLDVUU THRU W759-EXIT.
136710     IF DBIO-CALL-STATUS NOT = "****"
136720        GO TO O799-EXIT.
136730     IF DBIO-CALL-SAVE-REFER = "END."
136740        GO TO O799-EXIT.
136750     IF BLDV-UU-CANCEL-FLAG = 1
136760        GO TO O700-CALL.
136770     IF BLDV-UU-COMPLY-FLAG = 0
136780        MOVE 1 TO WA-MSG-ERR-FLAG
136790        MOVE 856 TO WA-OUTPUT-ERR-MSG-NO
136800        GO TO O799-EXIT.
136810     GO TO O700-CALL.
136820 O799-EXIT.
136830     EXIT.
136840/
136850 P000-GET-SUSP-ACCT.
136870***  STORE DETAILS OF ORIGINAL TRANSACTION AND SET ERROR
136880***  MESSAGE AND FLAG TO 0. IF POSTING TO SUSPENSE FAILS THEN
136890***  THESE DETAILS ARE RESTORED AT THE END OF THIS PARAGRAPH.
136900***  THE CHECK-RESPONSE FIELDS WILL PASS THE ORIGINAL ERROR
136910***  AND THE SUSPENSE FLAG BACK TO ININTER/SYSSTART/DJ0010
136930     MOVE WA-OUTPUT-ERR-MSG-NO       TO CHECK-RESPONSE-ERR-NO.
136940     IF   WA-OUTPUT-ERR-MSG-NO = 108
136950          MOVE "I"                   TO CHECK-RESPONSE-SUSP-FLAG
136960     ELSE
136970          MOVE "S"                   TO CHECK-RESPONSE-SUSP-FLAG.
136990     MOVE 0                          TO WA-MSG-ERR-FLAG
137000                                        WA-OUTPUT-ERR-MSG-NO.
137010     MOVE STRT-AREA-TRN-NO           TO WA-SUSP-TRAN-CODE.
137020     MOVE STRT-AREA-EDIT-MASK        TO WA-SUSP-EDIT-MASK.
137030     MOVE STARTAREA                  TO WA-SUSP-STARTAREA.
137040     MOVE WA-INPUT-MSG               TO WA-SUSP-INPUT-MESSAGE.
137050     MOVE WA-INPUT-ACCT-NO           TO WA-SUSP-ACCT-NO.
137060     MOVE BORM-RECORD-AREA           TO WA-SUSP-MAST.
137080***  SET UP KEY TO ACCESS SUSPMAST IN ORDER TO GET SUSP ACCT
137100     IF  CHECK-RESPONSE-SUSP-FLAG = "I"
137110         MOVE 0                      TO WA-SUSP-CUST-NO
137120         MOVE SOC-INTERNAL-BRANCH    TO WA-SUSP-HOME-BR
137130         IF  WA-MULTI-CURR-AMT-CURR-CD = SPACES OR
137140                                       SOC-NATIVE-CURRENCY
137150             MOVE SOC-NATIVE-CURRENCY   TO WA-SUSP-TYPE-CURRENCY
137160         ELSE
137170         MOVE WA-MULTI-CURR-AMT-CURR-CD TO WA-SUSP-TYPE-CURRENCY
137180     ELSE
137190         MOVE BORM-CUSTOMER-NO       TO WA-SUSP-CUST-NO
137200         MOVE BORM-BR-NO             TO WA-SUSP-HOME-BR
137210         MOVE BORM-CURRENCY-IND TO WA-SUSP-TYPE-CURRENCY.
137230     MOVE WA-SUSP-HOME-BR            TO WA-SUSP-BRANCH.
137240     MOVE  EPIP-SUSP-TYPE            TO WA-SUSP-TYPE-ID.
137260     PERFORM V910-READ-SUSPENSE-MASTER THRU V919-EXIT.
137280     IF  WA-MSG-ERR-FLAG = 1
137290         GO TO P190-RESTORE-ORIGINAL.
137310     MOVE SUSP-ACCT-NO               TO WA-INPUT-ACCT-NO.
137330     PERFORM W000-PROCESS-SUSP THRU W099-EXIT.
137340*
137350 P190-RESTORE-ORIGINAL.
137370     IF  WA-MSG-ERR-FLAG = 1
137380         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
137390         MOVE SPACES TO UT8500CA-INPUT-MSG
137400         STRING "BR0000 (P190): POSTING TO SUSPENSE FAILED,"
137410                " ERR " WA-OUTPUT-ERR-MSG-NO " SUSP AC "
137420                WA-INPUT-ACCT-NO " LON ACCT " WA-SUSP-ACCT-NO
137430                " ORIG TRN " WA-SUSP-TRAN-CODE
137440             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
137450         CALL "UT8500" USING
137470                             UT8500CA-AREA
137480         MOVE WA-SUSP-TRAN-CODE      TO STRT-AREA-TRN-NO
137490         MOVE WA-SUSP-EDIT-MASK      TO STRT-AREA-EDIT-MASK
137500         MOVE WA-SUSP-INPUT-MESSAGE  TO WA-INPUT-MSG
137510         MOVE WA-SUSP-ACCT-NO        TO WA-INPUT-ACCT-NO
137520         MOVE WA-SUSP-MAST           TO BORM-RECORD-AREA
137530         MOVE CHECK-RESPONSE-ERR-NO  TO WA-OUTPUT-ERR-MSG-NO
137540         MOVE 0                      TO CHECK-RESPONSE-ERR-NO
137550         MOVE SPACE                  TO CHECK-RESPONSE-SUSP-FLAG.
137560*
137570 P099-EXIT.
137580     EXIT.
137590/
137600 P100-AMD-CHR-FIELDS.
137610     MOVE TXN775-IN-GROUP TO TXN775-OUT-GROUP.
137620     MOVE 1 TO WA-SUB.
137630     MOVE BORM-RECORD-AREA TO WA-AUDT-OLD-IMAGE.
137640 P110-VALIDATE-TXN775.
137650     IF TXN775-CTR-ADJM(WA-SUB) NOT NUMERIC
137660        MOVE 407 TO WA-OUTPUT-ERR-MSG-NO
137670        MOVE 1 TO WA-MSG-ERR-FLAG
137680        GO TO P190-ERROR.
137690     IF TXN775-AMT-ADJM(WA-SUB) NOT NUMERIC
137700        MOVE 407 TO WA-OUTPUT-ERR-MSG-NO
137710        MOVE 1 TO WA-MSG-ERR-FLAG
137720        GO TO P190-ERROR.
137730 P120-INCRM-SUB.
137740     ADD 1 TO WA-SUB.
137750     IF WA-SUB > 10
137760        MOVE 1 TO WA-SUB
137770        GO TO P130-UPD-BORM
137780     ELSE
137790        GO TO P110-VALIDATE-TXN775.
137800 P130-UPD-BORM.
137810     IF TXN775-CTR-ADJM(WA-SUB) IS NUMERIC
137820        IF TXN775-CTR-ADJM(WA-SUB) NOT = 0
137830           MOVE 1 TO WA-TXN775-CTR-AMT
NR2001*137840           PERFORM P200-WRT-BORV THRU P299-EXIT
NR2001           PERFORM P200-WRT-BOCT THRU P299-EXIT
137850           IF WA-MSG-ERR-FLAG = 1
137860              GO TO P190-ERROR
137870           ELSE
137880              ADD TXN775-CTR-ADJM(WA-SUB) TO BORM-CHR-CNT(WA-SUB)
137890              PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
137900     IF WA-MSG-ERR-FLAG = 1
137910        GO TO P190-ERROR.
137920     IF TXN775-AMT-ADJM(WA-SUB) IS NUMERIC
137930        IF TXN775-AMT-ADJM(WA-SUB) NOT = 0
137940           MOVE TXN775-AMT-ADJM (WA-SUB)   TO WA-VA-AMT
137950           MOVE SOC-NATIVE-CURRENCY        TO WA-CURRENCY
137960           PERFORM BB630-FORMAT-AMT-DECIMAL THRU BB639-EXIT
137970           IF WA-MSG-ERR-FLAG = 1
137980              GO TO P190-ERROR
137990           END-IF
138000           MOVE WA-VA-AMT TO TXN775-AMT-ADJM (WA-SUB)
138010           MOVE 2 TO WA-TXN775-CTR-AMT
NR2001*138020           PERFORM P200-WRT-BORV THRU P299-EXIT
NR2001           PERFORM P200-WRT-BOCT THRU P299-EXIT
138030           IF WA-MSG-ERR-FLAG = 1
138040              GO TO P190-ERROR
138050           ELSE
138060              ADD TXN775-AMT-ADJM(WA-SUB) TO BORM-CHR-VAL(WA-SUB)
138070              PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
138080     IF WA-MSG-ERR-FLAG = 1
138090        GO TO P190-ERROR.
138100     ADD 1 TO WA-SUB.
138110     IF WA-SUB > 10
138120        GO TO P140-WRT-AUDT-LOG
138130     ELSE
138140        GO TO P130-UPD-BORM.
138150 P140-WRT-AUDT-LOG.
138160     MOVE STRT-AREA-CNTL-INFO TO WA-AUDT-CNTL-INFO.
138170     MOVE "B"                 TO WA-AUDT-SYS.
138180     MOVE BORM-BR-NO          TO WA-AUDT-HOME-BR.
138190     MOVE "BORM"              TO WA-AUDT-DATASET.
138200     MOVE BORM-RECORD-AREA    TO WA-AUDT-NEW-IMAGE.
138210     CALL "SY70SEND" USING
138230                           STARTAREA
138240                           WA-AUDT-AREA.
138250     GO TO P198-END.
138260 P190-ERROR.
138270     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
138280     GO TO P199-EXIT.
138290 P198-END.
138300     MOVE 0 TO WA-OUTPUT-ERR-MSG-NO.
138310     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
138320 P199-EXIT.
138330     EXIT.
138340/
NR2001*138350 P200-WRT-BORV.
NR2001*138360     INITIALIZE                  BORV-33-DETAIL.
NR2001*138370     MOVE 33                  TO BORV-33-CODE.
NR2001*138380     MOVE 04                  TO BORV-33-STATUS.
NR2001*138390     MOVE UPTELLCA-PARAM-2    TO BORV-33-TELL-AND-BR.
NR2001*138400     MOVE STRT-AREA-POST-DT   TO BORV-33-POST-DATE.
NR2001*138410     MOVE STRT-AREA-TRN-NO    TO BORV-33-TRN-CODE.
NR2001*138420     MOVE STRT-AREA-JRNL-NO   TO BORV-33-JRNL-NO.
NR2001*138430     MOVE WA-SUB TO BORV-33-MESSAGE-NO.
NR2001 P200-WRT-BOCT.
NR2001     INITIALIZE                  BOCT-TRAN-33.
NR2001     MOVE 33                  TO BOCT-TRAN-TYPE.
NR2001     MOVE 04                  TO BOCT-STAT.
NR2001     MOVE STRT-AREA-POST-DT   TO BOCT-TRN-DATE.
NR2001     MOVE STRT-AREA-TRN-NO    TO BOCT-TRN-CODE.
NR2001     MOVE WA-SUB              TO BOCT-33-MESSAGE-NO.
138440     IF WA-TXN775-CTR-AMT = 1
138450        MOVE "C" TO WA-TXN775-CTR-AMT
138460        MOVE TXN775-CTR-ADJM(WA-SUB) TO WA-TXN775-ADJM
138470     ELSE
138480        MOVE "A" TO WA-TXN775-CTR-AMT
138490        MOVE TXN775-AMT-ADJM(WA-SUB) TO WA-TXN775-ADJM.
NR2001*138500     MOVE WA-TXN775-MSG-TEXT TO BORV-33-FREE-MSG.
NR2001     MOVE WA-TXN775-MSG-TEXT  TO BOCT-33-FREE-MSG.
138510*
138520**** POST THE TRANSACTION *****
138530*
138540     PERFORM W500-ADD-TXN THRU W599-EXIT.
138550     IF  WA-MSG-ERR-FLAG = "Y"
138560         GO TO P299-EXIT.
138570*
138580 P299-EXIT.
138590     EXIT.
138600/
138610 P300-FMT-TXN775.
138620     MOVE WA-INPUT-KEY TO UT0151CA-ACCT-IN.
138630     MOVE 2 TO UT0151CA-CALL-FUNC.
138640     MOVE SOC-ACCT-NO-FORMAT  TO UT0151CA-FORMAT.
138650     MOVE SOC-CHK-DGT            TO
138660                                 UT0151CA-CHK-DGT-TYPE.
138670     CALL "UT0151" USING
138690                       UT0151CA-CALL-AREA.
138700     IF WA-MSG-ERR-FLAG = 1
138710        PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
138720        GO TO P399-EXIT.
138730     MOVE UT0151CA-ACCT-EX TO TXN775-CUS-ACC-NO.
138740     PERFORM P400-MOVE-CHR-ACCUMS THRU P409-EXIT
138750             VARYING WA-SUB FROM 1 BY 1
138760             UNTIL WA-SUB > 10.
138770     MOVE 10775 TO STRT-AREA-TRN-NO.
138780     MOVE  6 TO STRT-AREA-IEXEC-CNTL.
138790     MOVE 998                         TO WA-OUTPUT-ERR-MSG-NO.
138800     MOVE 565                         TO WA-OUTPUT-MSG-LENGTH.
138810     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
138820 P399-EXIT.
138830     EXIT.
138840/
138850 P400-MOVE-CHR-ACCUMS.
138860*
138870     MOVE BORM-CHR-CNT(WA-SUB) TO TXN775-CTR(WA-SUB).
138880     MOVE BORM-CHR-VAL(WA-SUB) TO TXN775-AMT(WA-SUB).
138890     MOVE 0 TO TXN775-CTR-ADJM(WA-SUB)
138900               TXN775-AMT-ADJM(WA-SUB).
138910 P409-EXIT.
138920     EXIT.
138930/
138940 Q000-AMOUNT-VALIDATION.
138950*
138960************************************************************
138970*
138980*SPR 760172 - ADD IN CURRENCY VALIDATION CODE AND
138990* RETRIEVE CURRENCY DETAILS. AS PER CTCB IR NO 58.
139000*
139010***START****************************************************
139030     MOVE BORM-CURRENCY-IND TO WA-CURRENCY.
139040     PERFORM Q910-RETRIEVE-CURRENCY-DETAILS THRU Q919-EXIT.
139050     IF WA-MSG-ERR-FLAG = 1
139060        GO TO Q009-EXIT.
139080***END******************************************************
139100     IF (UT0290CA-CURR-DECS = 0 AND WA-DECS-0 > 0) OR
139110        (UT0290CA-CURR-DECS = 1 AND WA-DECS-1 > 0) OR
139120        (UT0290CA-CURR-DECS = 2 AND WA-DECS-2 > 0)
139130        MOVE 1 TO WA-MSG-ERR-FLAG
139140        MOVE 850 TO WA-OUTPUT-ERR-MSG-NO.
139150 Q009-EXIT.
139160     EXIT.
139170/
NR2001*139180 Q100-ADD-BORV-46.
NR2001*139190*
NR2001*139200     IF WA-17029-BORV46 = "N"
NR2001*139210        GO TO Q199-EXIT.
NR2001*139220*
NR2001*139230     INITIALIZE BORV-46-DETAIL.
NR2001*139240     MOVE 46                       TO BORV-46-CODE.
NR2001*139250     MOVE ZERO                     TO BORV-46-STATUS.
NR2001*139260     MOVE STRT-AREA-POST-DT        TO BORV-46-POST-DATE.
NR2001*139270     MOVE UPTELLCA-TELLER-BRANCH   TO BORV-46-TELL-AND-BR.
NR2001*139280     MOVE STRT-AREA-TERM-NO        TO BORV-46-BRTERM.
NR2001*139290     MOVE STRT-AREA-TRN-NO         TO BORV-46-TRN-CODE.
NR2001*139300     MOVE STRT-AREA-JRNL-NO        TO BORV-46-JRNL-NO.
NR2001*139310*
NR2001*139320     MOVE BORM-ACT-TYPE            TO BORV-46-CHANGED-FROM-PROD.
NR2001*139330     MOVE BORM-CAT                 TO BORV-46-CHANGED-FROM-CAT.
NR2001*139340     MOVE WA-17029-CAT             TO BORV-46-CHANGED-TO-CAT.
NR2001*139350     MOVE WA-17029-TYPE            TO BORV-46-CHANGED-TO-PROD.
NR2001*139360     MOVE WA-17029-RATE            TO BORV-46-NEW-RATE.
NR2001*139370     MOVE WA-17029-AMOUNT          TO BORV-46-BALANCE.
NR2001*139380     MOVE BORM-INT-ACCR            TO BORV-46-INTEREST.
NR2001 Q100-ADD-BOCT-46.
NR2001*
NR2001     IF WA-17029-BOCT46 = "N"
NR2001        GO TO Q199-EXIT.
NR2001*
NR2001     INITIALIZE BOCT-TRAN-46.
NR2001     MOVE 46                TO BOCT-TRAN-TYPE.
NR2001     MOVE ZERO              TO BOCT-STAT.
NR2001     MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE.
NR2001     MOVE STRT-AREA-TRN-NO  TO BOCT-TRN-CODE.
NR2001     MOVE BORM-ACT-TYPE     TO BOCT-46-CHANGED-FROM-PROD.
NR2001     MOVE BORM-CAT          TO BOCT-46-CHANGED-FROM-CAT.
NR2001     MOVE WA-17029-CAT      TO BOCT-46-CHANGED-TO-CAT.
NR2001     MOVE WA-17029-TYPE     TO BOCT-46-CHANGED-TO-PROD.
NR2001     MOVE WA-17029-RATE     TO BOCT-46-NEW-RATE.
NR2001     MOVE WA-17029-AMOUNT   TO BOCT-46-BALANCE.
NR2001     MOVE BORM-INT-ACCR     TO BOCT-46-INTEREST.
139390*
139400     PERFORM W500-ADD-TXN THRU W599-EXIT.
139410     IF WA-MSG-ERR-FLAG = 1
139420        GO TO Q199-EXIT.
139430*
139440 Q199-EXIT.
139450     EXIT.
139460 Q200-POST-SUSP-ACC.
139470      MOVE BORM-RECORD-AREA     TO  WA-SAVE-BORM-AREA
139480      MOVE SUSP-RECORD-AREA  TO  WA-SAVE-SUSP-RECORD-AREA
139490      MOVE STRT-AREA-TRN-NO    TO WA-SAVE-TRAN-CODE.
139500      MOVE STRT-AREA-EDIT-MASK TO WA-SAVE-EDIT-MASK.
139510      MOVE WA-EDIT-MASK        TO WA-SAVE-PROC-BITS.
SC0796      IF  WA-INPUT-PARAM-TABLE (10) = 1
139520          PERFORM Q210-GET-SUSP-ACC THRU Q239-EXIT
139530          IF WA-MSG-ERR-FLAG = 1
139540             GO TO Q229-EXIT
SC0796          END-IF
SC0796      END-IF.
139550      PERFORM Q240-WRITE-GL THRU Q289-EXIT.
139560      IF WA-MSG-ERR-FLAG = 1
139570         GO TO Q229-EXIT.
139580 Q229-EXIT.
139590     MOVE WA-SAVE-BORM-AREA    TO  BORM-RECORD-AREA
139600     MOVE WA-SAVE-SUSP-RECORD-AREA TO SUSP-RECORD-AREA
139610     MOVE WA-SAVE-TRAN-CODE  TO STRT-AREA-TRN-NO
139620                                WA-DUMMY-TRN-NO.
139630     MOVE WA-SAVE-PROC-BITS  TO WA-EDIT-MASK.
139640     MOVE WA-SAVE-EDIT-MASK  TO STRT-AREA-EDIT-MASK.
139650 Q299-EXIT-PARA.
139660     EXIT.
139670 Q210-GET-SUSP-ACC.
139680     MOVE  WS-SAVE-TXN-CURRENCY TO  WA-SUSP-TYPE-CURRENCY.
SC6233     IF    STRT-TRICKLE-TXN
S11671        IF BORM-ACT-TYPE(1:1) = 8
S11671           MOVE WA-SUSP-PDCPOST-ERR-SMB TO WA-SUSP-TYPE-ID
S11671        ELSE
SC6233           MOVE WA-SUSP-PDCPOST-ERR TO WA-SUSP-TYPE-ID
S11671        END-IF
SC6233     ELSE
139690     MOVE  WA-SUSP-KEY-OTWCLR   TO  WA-SUSP-TYPE-ID.
S11454     IF STRT-AREA-TRN-NO = 16120
S11454        MOVE  BORM-BR-NO        TO  WA-SUSP-BRANCH
S11454     ELSE
139700     MOVE STRT-AREA-BRANCH      TO  WA-SUSP-BRANCH.
139710     MOVE STRT-AREA-SOC-NO      TO  WA-SUSP-INST.
139720     PERFORM V910-READ-SUSPENSE-MASTER THRU V919-EXIT.
139730 Q239-EXIT.
139740     EXIT.
139750 Q240-WRITE-GL.
SC0796*    MOVE  SUSP-ACCT-NO       TO  DBIO-01-ACCT-NO.
SC0796     IF  WA-INPUT-PARAM-TABLE (10) = 1
SC0796         MOVE  SUSP-ACCT-NO       TO  DBIO-01-ACCT-NO
SC0796     ELSE
SC0796         MOVE  WA-DEP-ACCT-NO     TO  DBIO-01-ACCT-NO
SC0796     END-IF.
S10971** IF THIS IS A CHECK CORRECTION WE NEED TO GET THE ORIGINAL SUSP     
S10971** ACCOUNT USED IN THE NORMAL TRAN. WE NEED TO ACCESS TYPE 36 OF BORV.
S10971     IF STRT-AREA-TRN-NO = 16120                                      
NR2001*S10971        MOVE SPACES   TO DBIO-CALL-PARAM                              
NR2001*S10971                         DBIO-CALL-SYS-AREA                           
NR2001*S10971                         DBIO-CALL-KEY-AREA                           
NR2001*S10971                         DBIO-CALL-STATUS                             
NR2001*S10971        MOVE ZERO     TO DBIO-CALL-REFER-AREA                         
NR2001*S10971        MOVE 07       TO DBIO-CALL-FUNC                               
NR2001*S10971        MOVE "BOR"    TO DBIO-CALL-SYS                                
NR2001*S10971        MOVE BORM-KEY TO DBIO-CALL-KEY                                
NR2001*S10971        MOVE 36       TO DBIO-CALL-TXN-TYPE                           
NR2001*S10971*NR0001 MOVE ZEROES   TO DBIO-CALL-SAVE-REFER
NR2001*S10971*NR0001                  WA-FIND-ACCT-NO
NR2001*NR0001        MOVE SPACES   TO DBIO-CALL-SAVE-REFER
NR2001        INITIALIZE UTBOCTCA-CALL-AREA
NR2001        MOVE STRT-AREA-SOC-NO  TO BOCT-INST-NO
NR2001        MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO
NR2001        MOVE 0                 TO BOCT-REC-NO
NR2003*NR2001 MOVE 999999999         TO BOCT-TRN-DATE
NR2003        MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE
NR2001        MOVE 1                 TO UTBOCTCA-KEY-NO
NR2001        SET  UTBOCTCA-READNEXT TO TRUE
NR2001        MOVE 36                TO WS-BOCT-TRAN-TYPE
NR0001        MOVE ZEROES   TO WA-FIND-ACCT-NO
S10971        MOVE "N"      TO WA-TRAN-NO-MORE-FLAG                         
S10971        MOVE WA-REPAY-TXN-DATE     TO  UT0030-DATE-MMDDCCYY           
S10971        PERFORM B3100-CONV-DATE-TO-BINARY THRU B3100-CONV-EXIT        
S10971        MOVE UT0030-BINARY-DATE    TO WA-FIND-TRN-DATE                
S10971        MOVE WA-REPAY-TRACER-NO TO WA-FIND-JRNL-NO                    
S10971                                                                      
NR2001*S10971        PERFORM FIND-BORV-TYPE-36                                     
NR2001*S10971           THRU FIND-BORV-TYPE-36-EXIT
NR2001        PERFORM FIND-BOCT-TYPE-36                                     
NR2001           THRU FIND-BOCT-TYPE-36-EXIT                                
S10971          UNTIL WA-TRAN-NO-MORE-FLAG = "Y"                            
S10971                                                  
S10971        IF WA-FIND-ACCT-NO > ZEROES               
S10971           MOVE WA-FIND-ACCT-NO TO DBIO-01-ACCT-NO
S10971        END-IF                                    
S10971     END-IF.                                      
S10971                                                  
139770     PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT.
S10971                                                  
S10971     IF STRT-AREA-TRN-NO = 16120                  
S10971        MOVE GLDM-BRANCH      TO WA-SAVE-BRCH-NO  
S10971     END-IF.                                      
S10971                                                  
139780     IF WA-MSG-ERR-FLAG = 1
139790        GO TO Q289-EXIT.
139800     PERFORM Q260-POST-TO-GL-ACCT  THRU Q269-EXIT
139810     IF WA-MSG-ERR-FLAG = 1
139820        GO TO Q289-EXIT.
139830 Q289-EXIT.
139840     EXIT.
139860 Q260-POST-TO-GL-ACCT.
139870     MOVE WA-INPUT-MSG TO WA-SAVE-INPUT-MSG.
139880     MOVE STRT-AREA-EDIT-MASK TO WA-STORE-INPUT-EDIT-MASK.
139890     MOVE STRT-AREA-TRN-NO    TO WA-SAVE-ORIG-TRAN.
139900     MOVE BORM-BR-NO          TO WA-SAVE-FROM-BRANCH.
139910     MOVE WA-INPUT-ACCT-NO    TO WA-SAVE-FROM-ACCT.
S10445     MOVE SPACES              TO WA-GL-TXN-AREA.
S10445     MOVE WA-INPUT-ACCT-NO    TO WA-NARR-TRF-ACCT.
SC9582*S10445     IF  WA-INPUT-PARAM-TABLE (10) = 1
SC9582*S10445         MOVE  WA-INPUT-ACCT-NO  TO  WA-NARR-TRF-ACCT
SC9582*S10445     END-IF.
SC3833     SET WA-POST-TO-GL        TO TRUE.
SC3833     MOVE GLDM-BRANCH         TO WA-GLDM-BRANCH.
S10535**CHECK GLDM STATUS                         
S10535     IF GLDM-STATUS NOT = 01                
S10535        IF GLDM-STATUS = 99                 
S10535            MOVE 110 TO WA-OUTPUT-ERR-MSG-NO
S10535        ELSE                                
S10535            MOVE 114 TO WA-OUTPUT-ERR-MSG-NO
S10535        END-IF                              
S10535        MOVE 1    TO WA-MSG-ERR-FLAG        
S10535        GO        TO Q269-EXIT              
S10535     END-IF.                                
139920     IF WA-INPUT-PARAM-TABLE(7) = 1
SC2760        IF WA-INPUT-PARAM-TABLE(8) = 1             
SC2760*          MOVE 026155        TO STRT-AREA-TRN-NO
S10971*S11281    IF STRT-AREA-TRN-NO = 16120
S10971*S11281       MOVE 020045        TO STRT-AREA-TRN-NO
S10971*S11281    ELSE
S10982               IF  STRT-AREA-TRN-NO = 16149
S10982                   MOVE 021153   TO STRT-AREA-TRN-NO
S10982                   MOVE WA-REPAY-TXN-DATE TO WA-GL-TXN-DATE
S10982               ELSE
SC3842                   MOVE 025155        TO STRT-AREA-TRN-NO
SC2760                   MOVE WA-REPAY-TXN-DATE TO WA-GL-TXN-DATE
S10982               END-IF
S10971*S11281    END-IF
SC2760        ELSE                                       
S10982           IF  STRT-AREA-TRN-NO = 11149
S10982               MOVE 021153    TO STRT-AREA-TRN-NO
S10982           ELSE
139930*              MOVE 020150           TO STRT-AREA-TRN-NO
SC3833               MOVE 020155           TO STRT-AREA-TRN-NO
S10982           END-IF
SC2760        END-IF
139940        MOVE WA-TRE-ACNO      TO WA-GL-CORR-JRNL-NO
139950     ELSE
SC2760        IF WA-INPUT-PARAM-TABLE(8) = 1             
S10982           IF  STRT-AREA-TRN-NO = 16049
S10982               MOVE 21053     TO STRT-AREA-TRN-NO
S10982               MOVE WA-REPAY-TXN-DATE TO WA-GL-TXN-DATE
S10982           ELSE
SC2760*              MOVE 026055        TO STRT-AREA-TRN-NO
SC3842               MOVE 025055        TO STRT-AREA-TRN-NO
SC2760               MOVE WA-REPAY-TXN-DATE TO WA-GL-TXN-DATE
S10982           END-IF
SC2760        ELSE                                       
S10982           IF  STRT-AREA-TRN-NO = 11049
S10982               MOVE 21053    TO STRT-AREA-TRN-NO
S10982           ELSE
139960*              MOVE 020050           TO STRT-AREA-TRN-NO.
SC3833               MOVE 020055           TO STRT-AREA-TRN-NO
S10982           END-IF
S10982        END-IF
S10982     END-IF.
139970     MOVE STRT-AREA-TRN-NO    TO LINK-IN-TXCODE
139980                                 WA-DUMMY-TRN-NO.
139990     PERFORM X700-CALL-UT0250   THRU X799-EXIT.
140000     IF WA-MSG-ERR-FLAG = 1
140010         GO TO Q269-EXIT.
140020     MOVE LINK-EDIT-MASK TO FIELD-B.
140030     MOVE LINK-EDIT-TABLE TO STRT-AREA-EDIT-MASK.
140040     CALL "UT0022" USING PUAREA.
140050     MOVE FIELD-A                TO WA-EDIT-MASK.
SC7628***  VALIDATE GLPARAM AND OBTAIN CGL POSINT IND FOR GL ACCT.
SC7628     MOVE 2                     TO UT0120CA-CALL-CODE.
SC7628     MOVE STRT-AREA-SOC-NO      TO UT0120CA-CALL-INST.
SC7628     MOVE GLDM-PRODUCT-TYPE     TO UT0120CA-CALL-PRODUCT-TYPE.
SC7628     MOVE GLDM-PRODUCT-CATEGORY TO UT0120CA-CALL-PRODUCT-CAT.
SC7628     MOVE 0                     TO UT0120CA-CALL-STATUS.
SC7628     CALL "UT0120" USING
SC7628                   UT0120CA-CALL-AREA.
SC7628     IF UT0120CA-CALL-STATUS  NOT = 0
SC7628        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
SC7628        MOVE SPACES TO UT8500CA-INPUT-MSG
SC7628        STRING "BR0000(Q260): ERROR IN GLPPARAM READ "
SC7628               UT0120CA-CALL-STATUS " KEY :" UT0120CA-CALL-KEY
SC7628               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC7628        CALL "UT8500" USING
SC7628                      UT8500CA-AREA
SC7628        MOVE 1092 TO WA-OUTPUT-ERR-MSG-NO
SC7628        MOVE 1    TO WA-MSG-ERR-FLAG
SC7628        GO        TO Q269-EXIT
SC7628     END-IF.
140060*
140070* SET EDIT MASK BIT 14 TO '0' SO THAT THE GENERATED TXN IN NOT
140080* ADDED INTO TELLER TOTALS
140090*
SC5651* RETAIN VALUE OF EDIT MASK BIT 14
SC5651*    MOVE '0' TO WA-INPUT-PARAM-TABLE(14).
140110
140120     MOVE 0                   TO GL-TRANS-IND
140130                                 WA-GL-CHQ-NO
140140                                 CH0000RA-UPD-CHQ-DUP-NO
140150                                 WA-MARG-INT-ACCR-BEFORE
140160                                 WA-MARG-INT-ACCR-AFTER
140170                                 WA-BASE-INT-ACCR-BEFORE
140180                                 WA-BASE-INT-ACCR-AFTER.
140190     MOVE "0"                 TO GL-DONT-WRITE-GLDM-IND.
140200     MOVE 00                  TO WA-GL-NON-VALUE-DAYS.
140210     MOVE 00                  TO WA-GL-DEFER-DAYS.
140220     MOVE 00                  TO WA-GL-DEBIT-DEFER-DAYS.
140230     MOVE GLDM-LEDGER-NO      TO WA-GL-ACCT-NO.
140240     MOVE WA-INPUT-AMT        TO WA-GL-AMOUNT.
140250     MOVE SPACES              TO WA-GL-DESC.
140260     MOVE GLDM-CURRENCY       TO WA-GL-CURRENCY.
S10982     IF   WS-VCHR-ORG-TRANCODE = 11049 OR 11149 OR 16049 OR 16149
S10982          MOVE WA-11049-SRN-NO      TO WA-GL-IN-SRN
S10982          MOVE WA-11049-ACCTNOCHQNO TO WA-GL-IN-ACCTNO-CHQNO
S10982          MOVE WA-11049-NAME-1      TO WA-GL-NAME-1
S10982          MOVE WA-11049-NARR        TO WA-NARR-TEXT
S10982     END-IF.
140270     MOVE WA-GL-TXN-AREA      TO WA-INPUT-MSG.
140280     MOVE WA-INPUT-PROMO      TO WA-GL-PROMO-NO.
140290     CALL "GL0024" USING
140310                         STARTAREA
140320                         GL-PASSALONG
140330                         MULTI-OVERRIDE-AREA
SC0796                         W300-ERROR-AREA
SC0796                         CHECK-RESPONSE-AREA.
140340     IF ST-STATUS-LEVEL-1 NOT = 0
140350         MOVE 1 TO WA-MSG-ERR-FLAG
140360     ELSE
140370         MOVE WA-GL-AMOUNT TO WA-INPUT-AMT
SC5651         MOVE "1"          TO WA-CAST-GL-FLAG
SC5651         PERFORM E000-COMPLETION-PARA THRU E099-EXIT
SC5651         MOVE "0"          TO WA-CAST-GL-FLAG.
SC5651*        PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
140390     MOVE WA-STORE-INPUT-EDIT-MASK TO STRT-AREA-EDIT-MASK.
140400     MOVE WA-SAVE-INPUT-MSG TO WA-INPUT-MSG.
140420 Q269-EXIT.
140430     EXIT.
140440/
140450/
140460 Q910-RETRIEVE-CURRENCY-DETAILS.
140470     IF  WA-CURRENCY = UT0290CA-CALL-CURRENCY
140480         GO TO Q919-EXIT.
140490     MOVE WA-CURRENCY TO UT0290CA-CALL-CURRENCY.
140500     MOVE 0 TO UT0290CA-CALL-STATUS
140510               UT0290CA-CALL-MSG-NO.
140520     MOVE 2 TO UT0290CA-CALL-CODE.
140530     CALL "UT0290" USING
140550                         UT0290CA-CALL-AREA.
140560     IF  UT0290CA-CALL-STATUS NOT = 0
140570         MOVE HIGH-VALUES TO UT0290CA-CALL-CURRENCY
140580         MOVE 1 TO WA-MSG-ERR-FLAG
140590         MOVE UT0290CA-CALL-MSG-NO TO WA-OUTPUT-ERR-MSG-NO.
140600 Q919-EXIT.
140610     EXIT.
140620/
140630***********************************************************
140640***********************************************************
140650***    1. VALIDATES THE LEDGER AND SUB LEDGER CODES.
140660***    2. ADD TRX-AMT TO EOM-BASIC-BAL.
140670***    3. ADDS TRX TO MASTER.
140680***********************************************************
140690***********************************************************
140700 S100-ADJ-BASIC-BAL.
140710*    IF  STRT-AREA-LEDG-CODE NOT = 5
140720*        MOVE 1 TO WA-MSG-ERR-FLAG
140730*        MOVE 193 TO WA-OUTPUT-ERR-MSG-NO
140740*        GO TO S199-EXIT.
140750     IF  WA-ADJ-SUB-LEDG-CODE < 1 OR
140760         WA-ADJ-SUB-LEDG-CODE > 30
140770         MOVE 1 TO WA-MSG-ERR-FLAG
140780         MOVE 194 TO WA-OUTPUT-ERR-MSG-NO
140790         GO TO S199-EXIT.
140800     MOVE WA-ADJ-AMT TO WA-VA-AMT.
140810     PERFORM Q000-AMOUNT-VALIDATION THRU Q009-EXIT.
140820     IF  WA-MSG-ERR-FLAG = 1
140830         GO TO S199-EXIT.
140840     PERFORM L100-VALIDATE-INPUT THRU L199-EXIT.
140850     IF  WA-MSG-ERR-FLAG = 1
140860         GO TO S199-EXIT.
140870     ADD WA-DUMMY-AMT TO BORM-EOM-BASIC-BAL
140880                         BORM-EOY-BASIC-BAL.
140890     MOVE WA-ADJ-TXN-DATE        TO UT0030-DATE-DDMMCCYY.
140900     PERFORM X610-UT0030-PARA THRU X619-EXIT.
140910     MOVE UT0030-BINARY-DATE TO WA-STORE-TXN-DT.
140920     IF  UT0030-BINARY-DATE = ZEROES
140930         MOVE 126                TO WA-OUTPUT-ERR-MSG-NO
140940         MOVE 1                  TO WA-MSG-ERR-FLAG
140950         GO TO S199-EXIT.
140960     IF  UT0030-BINARY-DATE > STRT-AREA-POST-DT
140970         MOVE 190                TO WA-OUTPUT-ERR-MSG-NO
140980         MOVE 1                  TO WA-MSG-ERR-FLAG
140990         GO TO S199-EXIT.
141000*NBG003
141010     PERFORM X2000-READ-BIRM THRU X2999-EXIT.
141020     IF WA-MSG-ERR-FLAG = 1
141030        GO TO S199-EXIT
141040     END-IF.
141050     IF DBIOMOD-STAT = "MRNF"
141060        MOVE "WRITE" TO DBIOMOD-FUNCTION
141070     ELSE
141080        MOVE "REWRITE" TO DBIOMOD-FUNCTION
141090     END-IF.
141100     MOVE WA-STORE-TXN-DT      TO BIRM-IR-ACTIVITY.
141110*    MOVE WA-STORE-TXN-DT      TO BORM-IR-ACTIVITY.
141120     PERFORM X3000-WRITE-REWRITE-BIRM THRU X3999-EXIT.
141130     IF WA-MSG-ERR-FLAG = 1
141140        GO TO S199-EXIT.
141150*
NR2001*141160     INITIALIZE BORV-01-DETAIL.
NR2001*141170     MOVE 01 TO BORV-01-CODE.
NR2001*141180     MOVE 0 TO BORV-01-STATUS.
NR2001*141190     MOVE WA-STORE-TXN-DT    TO BORV-01-TRN-DATE.
NR2001*141200     MOVE UPTELLCA-TELLER-BRANCH  TO BORV-01-TELL-AND-BR.
NR2001*141210     MOVE STRT-AREA-TERM-NO   TO BORV-01-BRTERM.
NR2001*141220     MOVE STRT-AREA-TRN-NO    TO BORV-01-TRN-CODE.
NR2001*141230     MOVE STRT-AREA-POST-DT   TO BORV-01-POST-DATE.
NR2001*141240     MOVE STRT-AREA-JRNL-NO   TO BORV-01-JRNL-NO.
NR2001*141250     MOVE BORM-LOAN-BAL TO BORV-01-BALANCE.
NR2001*141260     MOVE WA-DUMMY-AMT TO BORV-01-AMOUNT.
NR2001*141270     COMPUTE BORV-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001*141280     MOVE WA-ADJ-SUB-LEDG-CODE TO BORV-01-SUB-LEDG-CODE.
NR2001*141290     MOVE STRT-AREA-MSG-TIME   TO BORV-01-POST-TIME.
NR2001     INITIALIZE BOCT-TRAN-01.
NR2001     MOVE 01                   TO BOCT-TRAN-TYPE.
NR2001     MOVE 0                    TO BOCT-STAT.
NR2001     MOVE WA-STORE-TXN-DT      TO BOCT-TRN-DATE.
NR2001     MOVE STRT-AREA-TRN-NO     TO BOCT-TRN-CODE.
NR2001     MOVE BORM-LOAN-BAL        TO BOCT-01-BALANCE.
NR2001     MOVE WA-DUMMY-AMT         TO BOCT-01-AMOUNT.
NR2001     COMPUTE BOCT-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001     MOVE WA-ADJ-SUB-LEDG-CODE TO BOCT-01-SUB-LEDG-CODE.
NR2001     MOVE STRT-AREA-MSG-TIME   TO BOCT-01-REPOST-TIME.
141300     PERFORM W500-ADD-TXN THRU W599-EXIT.
141310     IF  WA-MSG-ERR-FLAG = 1
141320         GO TO S199-EXIT.
141330*
141340*  SET UP TYPE 20 TXN.
141350*
141360     MOVE STRT-AREA-TRN-NO TO LINK-IN-TXCODE.
141370     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
141380     IF WA-MSG-ERR-FLAG = 1
141390         GO TO S199-EXIT.
141400     IF (LINK-NARR-TXN-TYPE = 20) OR
141410        (WA-IN-NARR-TEXT NOT = SPACES)
141420         PERFORM O200-ADD-TYPE-20 THRU O299-EXIT
141430         IF WA-MSG-ERR-FLAG = 1
141440             GO TO S199-EXIT.
141450*
NR2001*141460     MOVE BORV-01-TRN-DATE TO BORM-LST-FIN-DATE.
NR2001     MOVE BOCT-TRN-DATE     TO BORM-LST-FIN-DATE.
141470     MOVE SPACES                 TO WA-OUTPUT-MESSAGE.
141480     MOVE STRT-AREA-JRNL-NO TO WA-OUTPUT-JRNL-NO.
141490     MOVE 4 TO WA-INPUT-MSG-CODE.
141500     MOVE 999 TO WA-OUTPUT-ERR-MSG-NO.
141510     MOVE 7  TO  WA-OUTPUT-MSG-LENGTH.                                  
141520     PERFORM E1000-PRE-FMT-SEND-PARA
141530        THRU E1999-EXIT.
141540 S199-EXIT.
141550     EXIT.
141560/
SC7443 S100-CALL-ATM.                                                  
SC7443     IF STRT-AREA-TRN-NO NOT = 13000                             
SC7443        IF WA-MSG-ERR-FLAG = 0                                   
SC7443       AND (WS-DCHARGE OR STRT-AREA-TRN-NO = 12410)              
SC7443*S10745    IF (BOIS-ATM-CARD-STATUS NOT = 3 AND 0)
SC7443*S10745    AND WA-INPUT-PARAM-TABLE(7)  = 0
S18577           PERFORM X9000-CHK-YB-RTN    THRU X9000-EXIT
S10745           IF WA-INPUT-PARAM-TABLE(7)  = 0
S18577           AND WA-YOUBE-PROD
SC7443              MOVE "LON" TO ST-SYSTEM                            
SC7443              PERFORM S100-ATM-CLOSURE THRU S199-ATM-CLOSURE-EXIT
SC7443              IF NOT WA-OUTPUT-ERR-MSG-NO = 0                    
SC7443                 MOVE 1 TO WA-MSG-ERR-FLAG                       
SC7443*S10745       ELSE
SC7443*S10745          MOVE 0 TO BORM-ATM-FLAG
SC7443*S10745          MOVE 3 TO BOIS-ATM-CARD-STATUS
SC7443              END-IF                                             
SC7443           END-IF                                                
SC7443        END-IF                                                   
SC7443     END-IF.                                                     
SC7443 S100-CALL-ATM-EXIT.                                             
SC7443      EXIT.                                                      
SC7443                                                                 
SC7443**** This module is came from BR0025.COB for ATM Closure         
SC7443**** need to pass through all override before sending to TPS     
SC7443 S100-ATM-CLOSURE.                                       
SC7443      MOVE STRT-AREA-TRN-NO    TO WA-SV-STRT-AREA-TRN-NO.
SC7443      MOVE STRT-AREA-DATA      TO WA-SV-STRT-AREA-DATA.  
SC7443      MOVE WA-INPUT-MSG        TO WA-SV-INPUT-MESSAGE.   
SC7443      MOVE WA-OUTPUT-MESSAGE   TO WA-SV-OUTPUT-MESSAGE.  
SC7443                                                         
SC7443      MOVE SPACES              TO WA-INPUT-MSG(17:965)   
SC7443      MOVE 0                   TO ATM-I-CARD-NO          
SC7443      MOVE SPACE               TO ATM-I-EMB-CARD         
SC7443*S10745 MOVE 1                   TO ATM-I-FUNC-CODE
S10745      MOVE 3                   TO ATM-I-FUNC-CODE
SC7443      MOVE BORM-BR-NO          TO ATM-I-HOME-BRANCH      
SC7443      MOVE 084002              TO STRT-AREA-TRN-NO.      
SC7443      CALL "UT0802"  USING STARTAREA.                    
SC7443                                                         
SC7443      MOVE WA-SV-STRT-AREA-TRN-NO  TO STRT-AREA-TRN-NO.  
SC7443      MOVE WA-SV-STRT-AREA-DATA    TO STRT-AREA-DATA.    
SC7443      MOVE WA-SV-INPUT-MESSAGE     TO WA-INPUT-MSG.      
SC7443      IF WA-OUTPUT-ERR-MSG-NO = 0000                     
SC7443         MOVE WA-SV-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE  
SC7443      END-IF.                                            
SC7443 S199-ATM-CLOSURE-EXIT.                                  
SC7443      EXIT.                                              
SC7443/
S16871 S200-WBS-RTN.
S16871* CORPORATION ADVANCE TXN PROCESS IN WBS
S16871* CORPORATION CHECK LIMIT FROM BANCS TO WBS
S16871      MOVE STRT-AREA-TRN-NO        TO WA-SV-STRT-AREA-TRN-NO.
S16871      MOVE STRT-AREA-DATA          TO WA-SV-STRT-AREA-DATA.
S16871      MOVE WA-INPUT-MSG            TO WA-SV-INPUT-MESSAGE.
S16871      MOVE WA-OUTPUT-MESSAGE       TO WA-SV-OUTPUT-MESSAGE.
S16871
S16671      MOVE SPACES                  TO WA-INPUT-MSG.
S16871      MOVE '87000'                 TO WA-IN-87000-TRNCODE.
S16871      MOVE STRT-AREA-JRNL-NO       TO WA-IN-87000-SEQNO.
S16871      MOVE 'BANCS'                 TO WA-IN-87000-SYSTEM.
S16871      MOVE STRT-AREA-TELL-NO       TO WA-IN-87000-IUSER.
S17726      MOVE STRT-AREA-JRNL-NO       TO WA-IN-87000-SEQNO-REL.
S17726      MOVE "BANCS"                 TO WA-IN-87000-SYSTEM-REL.
S17726      MOVE STRT-AREA-TELL-NO       TO WA-IN-87000-IUSER-REL.
S17726      IF (UT9002CA-ACTION = "BANUTL" OR "BANCORUTL")
S17726      AND UT9002CA-AMOUNT > 0
S17726         MOVE "TWD"                TO WA-IN-87000-CCY
S17726         MOVE UT9002CA-ACTION      TO WA-IN-87000-ACTION
S17726         MOVE UT9002CA-ACTNO       TO WA-IN-87000-ACTNO
S17726         MOVE UT9002CA-ODNO        TO WA-IN-87000-ODNO
S17726         MOVE UT9002CA-AMOUNT      TO WA-IN-87000-AMOUNT
S17726      END-IF.
S17726      IF (UT9002CA-ACTION-REL = "BANREL" OR "BANCORREL")
S17726      AND UT9002CA-AMOUNT-REL > 0
S17726         MOVE 'TWD'                TO WA-IN-87000-CCY-REL
S17726         MOVE UT9002CA-ACTION-REL  TO WA-IN-87000-ACTION-REL
S17726         MOVE UT9002CA-ACTNO-REL   TO WA-IN-87000-ACTNO-REL
S17726         MOVE UT9002CA-ODNO-REL    TO WA-IN-87000-ODNO-REL
S17726         MOVE UT9002CA-AMOUNT-REL  TO WA-IN-87000-AMOUNT-REL
S17726      END-IF.
S17726
S16871      IF WA-INPUT-PARAM-TABLE(7)  = 0
S16871         IF UT7400CA-COMPUTATION-TYPE = 'I'
S17726*S16871     MOVE 'BANUTL'          TO WA-IN-87000-ACTION
S17726            MOVE "BANUTL"          TO WA-87000-ACTION
S16871         ELSE
S17726*S16871     MOVE 'BANREL'          TO WA-IN-87000-ACTION
S17726            MOVE "BANREL"          TO WA-87000-ACTION
S16871         END-IF
S16871      ELSE
S16871         IF UT7400CA-COMPUTATION-TYPE = 'I'
S17726*S16871     MOVE 'BANCORREL'       TO WA-IN-87000-ACTION
S17726            MOVE "BANCORREL"       TO WA-87000-ACTION
S16871         ELSE
S17726*S16871     MOVE 'BANCORUTL'       TO WA-IN-87000-ACTION
S17726            MOVE "BANCORUTL"       TO WA-87000-ACTION
S16871         END-IF
S16871      END-IF.
S17726*S16871      MOVE 'TWD'                   TO WA-IN-87000-CCY.
S17726*S16871      MOVE BORM-MEMB-CUST-AC       TO WA-IN-87000-ACTNO.
S17726*S16871      MOVE SPACES                  TO WA-IN-87000-ODNO.
S17726*S16871      MOVE WA-LIMIT-AMT            TO WA-IN-87000-AMOUNT.
S17726      IF (WA-87000-ACTION        = "BANUTL" OR "BANCORUTL")
S17726      AND WA-LIMIT-AMT > 0
S17726         MOVE "TWD"                TO WA-IN-87000-CCY
S17726         MOVE BORM-MEMB-CUST-AC    TO WA-IN-87000-ACTNO
S17726         MOVE SPACES               TO WA-IN-87000-ODNO
S17726         MOVE WA-87000-ACTION      TO WA-IN-87000-ACTION
S17726         MOVE WA-LIMIT-AMT         TO WA-IN-87000-AMOUNT
S17726      END-IF.
S17726      IF (WA-87000-ACTION        = "BANREL" OR "BANCORREL")
S17726      AND WA-LIMIT-AMT > 0
S17726         MOVE "TWD"                TO WA-IN-87000-CCY-REL
S17726         MOVE BORM-MEMB-CUST-AC    TO WA-IN-87000-ACTNO-REL
S17726         MOVE SPACES               TO WA-IN-87000-ODNO-REL
S17726         MOVE WA-87000-ACTION      TO WA-IN-87000-ACTION-REL
S17726         MOVE WA-LIMIT-AMT         TO WA-IN-87000-AMOUNT-REL
S17726      END-IF.
S16871      MOVE 87000                   TO STRT-AREA-TRN-NO.
S16871      CALL "UT0802"  USING STARTAREA.
S16871
S16871      MOVE WA-SV-STRT-AREA-TRN-NO  TO STRT-AREA-TRN-NO.
S16871      MOVE WA-SV-STRT-AREA-DATA    TO STRT-AREA-DATA.
S16871      MOVE WA-SV-INPUT-MESSAGE     TO WA-INPUT-MSG.
S16871      IF WA-OUTPUT-ERR-MSG-NO = 0000
S16871         MOVE WA-SV-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE
S16871      ELSE
S16871         MOVE 1 TO WA-MSG-ERR-FLAG
S16871      END-IF.
S16871
S16871 S200-EXIT.
S16871      EXIT.
S16871/
141570************************************************************
141580************************************************************
141590***     1. VALIDATES LEDGER AND SUB LEDGER CODES.
141600***     2. COMPUTE ARREARS AND ADD TRX-AMT TO ARREARS.
141610***     3. SUBTRACTS ARREARS FROM LOAN-BAL GIVING
141620***        THEO-LOAN-BAL.
141630***     4. POST THE TRX TO BORM.
141640*************************************************************
141650*************************************************************
141660 S300-ADJ-ARR-ADV.
141670*    IF  STRT-AREA-LEDG-CODE NOT = 6
141680*        MOVE 1 TO WA-MSG-ERR-FLAG
141690*        MOVE 193 TO WA-OUTPUT-ERR-MSG-NO
141700*        GO TO S399-EXIT.
141710     IF  WA-ADJ-SUB-LEDG-CODE < 1 OR
141720         WA-ADJ-SUB-LEDG-CODE > 30
141730         MOVE 1 TO WA-MSG-ERR-FLAG
141740         MOVE 194 TO WA-OUTPUT-ERR-MSG-NO
141750         GO TO S399-EXIT.
141760     PERFORM L100-VALIDATE-INPUT THRU L199-EXIT.
141770     IF  WA-MSG-ERR-FLAG = 1
141780         GO TO S399-EXIT.
NR2001*141790     COMPUTE BORV-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001*141800     ADD WA-DUMMY-AMT TO BORV-01-ARREARS.
NR2001*141810     SUBTRACT BORV-01-ARREARS FROM BORM-LOAN-BAL GIVING
NR2001     COMPUTE BOCT-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001     ADD WA-DUMMY-AMT TO BOCT-01-ARREARS.
NR2001     SUBTRACT BOCT-01-ARREARS FROM BORM-LOAN-BAL GIVING
141820                                             BORM-THEO-LOAN-BAL.
141830     IF STRT-AREA-PRIORITY-CODE = "I"
NR2001*141840        SUBTRACT BORV-01-ARREARS FROM BORM-CAP-UNPAID-INT
NR2001        SUBTRACT BOCT-01-ARREARS FROM BORM-CAP-UNPAID-INT
141850                               GIVING BORM-CAP-THEO-UNPAID-INT
141860     END-IF.
141870     IF STRT-AREA-PRIORITY-CODE = "A"
NR2001*141880        SUBTRACT BORV-01-ARREARS FROM BORM-UNPAID-ARRS-INT-BAL
NR2001        SUBTRACT BOCT-01-ARREARS FROM BORM-UNPAID-ARRS-INT-BAL
141890                             GIVING BORM-THEO-UNPAID-ARRS-INT-BAL
141900     END-IF.
141910     IF STRT-AREA-PRIORITY-CODE = "C"
NR2001*141920        SUBTRACT BORV-01-ARREARS FROM BORM-UNPAID-CHRG-BAL
NR2001        SUBTRACT BOCT-01-ARREARS FROM BORM-UNPAID-CHRG-BAL
141930                               GIVING BORM-THEO-UNPAID-CHRG-BAL
141940     END-IF.
141950     IF STRT-AREA-PRIORITY-CODE = "P"
NR2001*141960        SUBTRACT BORV-01-ARREARS FROM BORM-UNPAID-PRINCIPAL-BAL
NR2001        SUBTRACT BOCT-01-ARREARS FROM BORM-UNPAID-PRINCIPAL-BAL
141970                             GIVING BORM-THEO-UNPAID-PRINCIPAL-BAL
141980     END-IF.
141990     MOVE WA-ADJ-TXN-DATE        TO UT0030-DATE-DDMMCCYY.
142000     PERFORM X610-UT0030-PARA THRU X619-EXIT.
142010     MOVE UT0030-BINARY-DATE TO WA-STORE-TXN-DT.
142020     IF  UT0030-BINARY-DATE = ZEROES
142030         MOVE 126                TO WA-OUTPUT-ERR-MSG-NO
142040         MOVE 1                  TO WA-MSG-ERR-FLAG
142050         GO TO S399-EXIT.
142060     IF  UT0030-BINARY-DATE > STRT-AREA-POST-DT
142070         MOVE 190                TO WA-OUTPUT-ERR-MSG-NO
142080         MOVE 1                  TO WA-MSG-ERR-FLAG
142090         GO TO S399-EXIT.
142100*
142110*  AUTHORISATION FOR 12477 & 12577
142120*
142130     MOVE 2185 TO UT0060CA-CALL-ERROR-CODE
142140     PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT.
142150     IF WA-MSG-ERR-FLAG = 0
142160        MOVE 2185 TO WA-ERR-MSG-NO
142170     ELSE
142180        MOVE 2185 TO WA-OUTPUT-ERR-MSG-NO
142190        MOVE 1 TO WA-MSG-ERR-FLAG
142200        GO TO S399-EXIT.
142210*
NR2001*142220     INITIALIZE BORV-01-DETAIL.
NR2001*142230     MOVE 01 TO BORV-01-CODE.
NR2001*142240     MOVE 0 TO BORV-01-STATUS.
NR2001*142250     MOVE WA-STORE-TXN-DT    TO BORV-01-TRN-DATE.
NR2001*142260     MOVE UPTELLCA-TELLER-BRANCH  TO BORV-01-TELL-AND-BR.
NR2001*142270     MOVE STRT-AREA-TERM-NO   TO BORV-01-BRTERM.
NR2001*142280     MOVE STRT-AREA-TRN-NO    TO BORV-01-TRN-CODE.
NR2001*142290     MOVE STRT-AREA-POST-DT   TO BORV-01-POST-DATE.
NR2001*142300     MOVE STRT-AREA-JRNL-NO   TO BORV-01-JRNL-NO.
NR2001*142310     MOVE BORM-LOAN-BAL TO BORV-01-BALANCE.
NR2001*142320     MOVE WA-DUMMY-AMT TO BORV-01-AMOUNT.
NR2001*142330     COMPUTE BORV-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001*142340     MOVE WA-ADJ-SUB-LEDG-CODE TO BORV-01-SUB-LEDG-CODE.
NR2001*142350     MOVE STRT-AREA-MSG-TIME   TO BORV-01-POST-TIME.
NR2001     INITIALIZE BOCT-TRAN-01.
NR2001     MOVE 01                   TO BOCT-TRAN-TYPE.
NR2001     MOVE 0                    TO BOCT-STAT.
NR2001     MOVE WA-STORE-TXN-DT      TO BOCT-TRN-DATE.
NR2001     MOVE STRT-AREA-TRN-NO     TO BOCT-TRN-CODE.
NR2001     MOVE BORM-LOAN-BAL        TO BOCT-01-BALANCE.
NR2001     MOVE WA-DUMMY-AMT         TO BOCT-01-AMOUNT.
NR2001     COMPUTE BOCT-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001     MOVE WA-ADJ-SUB-LEDG-CODE TO BOCT-01-SUB-LEDG-CODE.
NR2001     MOVE STRT-AREA-MSG-TIME   TO BOCT-01-REPOST-TIME.
142360     PERFORM W500-ADD-TXN THRU W599-EXIT.
142370     IF  WA-MSG-ERR-FLAG = 1
142380         GO TO S399-EXIT.
142390*
142400*  SET UP TYPE 20 TXN.
142410*
142420     MOVE STRT-AREA-TRN-NO TO LINK-IN-TXCODE.
142430     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
142440     IF WA-MSG-ERR-FLAG = 1
142450         GO TO S399-EXIT.
142460     IF (LINK-NARR-TXN-TYPE = 20) OR
142470        (WA-IN-NARR-TEXT NOT = SPACES)
142480         PERFORM O200-ADD-TYPE-20 THRU O299-EXIT
142490         IF WA-MSG-ERR-FLAG = 1
142500             GO TO S399-EXIT.
142510*
NR2001*142520     MOVE BORV-01-TRN-DATE TO BORM-LST-FIN-DATE.
NR2001     MOVE BOCT-TRN-DATE TO BORM-LST-FIN-DATE.
142530     MOVE SPACES                 TO WA-OUTPUT-MESSAGE.
142540     MOVE STRT-AREA-JRNL-NO TO WA-OUTPUT-JRNL-NO.
142550     MOVE 4 TO WA-INPUT-MSG-CODE.
142560     MOVE 999 TO WA-OUTPUT-ERR-MSG-NO.
142570     MOVE 7  TO  WA-OUTPUT-MSG-LENGTH.                                  
142580     PERFORM E1000-PRE-FMT-SEND-PARA
142590        THRU E1999-EXIT.
142600 S399-EXIT.
142610     EXIT.
142620/
142630 S500-PRINCIPAL-DEBIT-CREDIT.
142640*    IF  NOT (STRT-AREA-LEDG-CODE = 1 OR 2)
142650*        MOVE 1 TO WA-MSG-ERR-FLAG
142660*        MOVE 193 TO WA-OUTPUT-ERR-MSG-NO
142670*        GO TO S599-EXIT.
TB0099     IF STRT-AREA-TRN-NO = 13131
SC2345        MOVE BUCV-REPAY-PRN-RECALC TO WA-REPAY-PRIN-RECALC
TB0099        IF WA-REPAY-PRIN-RECALC = "1"
TB0099           MOVE 0 TO WA-PAID-TERM-CORR
TB0099                     WA-REPAY-AMT-TMP-CORR
TB0099                     WA-REPAY-AMT-TMP1-CORR
TB0099                     WA-REM-TERM-CORR
TB0099                     WA-NEXT-TERM-CORR
TB0099           COMPUTE WA-REM-REPAYS-TMP = BORM-LOAN-TRM -
TB0099                        BORM-REM-REPAYS
TB0099           SUBTRACT WA-REM-REPAYS-TMP FROM BOIS-LAST-TERM-PAID
TB0099           COMPUTE WA-REPAY-AMT-TMP-CORR = (WA-REPAY-AMOUNT /
TB0099                                BORM-DUE-AMT)
TB0099           COMPUTE WA-REPAY-AMT-TMP1-CORR ROUNDED =
TB0099                         WA-REPAY-AMT-TMP-CORR * 1
TB0099           COMPUTE WA-REM-TERM-CORR ROUNDED =
TB0099             (WA-REPAY-AMT-TMP1-CORR + BORM-REM-REPAYS)
TB0099           MOVE WA-REM-TERM-CORR TO BORM-REM-REPAYS
TB0099        ELSE
TB0099           IF WA-REPAY-PRIN-RECALC = "2"
TB0099              MOVE 0 TO WA-DUE-AMT
TB0099                        WA-REM-TERM
TB0099                        WA-DUE-DAYS
TB0099                        WA-DUE-DAYS-P
TB0099                        WA-DUE-DAYS-R
TB0099                        WA-DUE-DAYS-TMP
TB0099                        WA-DUE-DAYS-TMP1
TB0099                        WA-DUE-DAYS-TMP2
TB0099                        WA-LOAN-BAL
TB0099              MOVE 1 TO WA-REM-TERM-TMP
TB0099              MOVE WA-TMP-REM-REPAYS TO BORM-REM-REPAYS
TB0099              MOVE WA-TMP-LST-TERM-PAID TO BOIS-LAST-TERM-PAID
TB0099              MOVE WA-BOIS-LST-ADV-DTE TO BOIS-LAST-ADV-PYMT-DATE
TB0099              MOVE BORM-REM-REPAYS TO WA-REM-TERM
TB0099              MOVE BORM-INT-RATE TO WA-INT-RATE-TMP
TB0099              COMPUTE WA-INT-RATE-TMP = WA-INT-RATE-TMP * .01
TB0099              COMPUTE WA-DUE-DAYS  = (WA-INT-RATE-TMP * 30) /
TB0099                      BORP-INT-DAYS-YR
TB0099              COMPUTE WA-DUE-DAYS-P ROUNDED = WA-DUE-DAYS  * 1
TB0099              COMPUTE WA-DUE-DAYS-R ROUNDED = WA-DUE-DAYS-P  * 1
TB0099              COMPUTE WA-DUE-DAYS-TMP = 1 / (1 + WA-DUE-DAYS-R)
TB0099              MOVE WA-DUE-DAYS-TMP TO WA-DUE-DAYS-TMP1
TB0099              PERFORM S550E-LOAN-REPAY-COMP THRU S550E-EXIT
TB0099                     UNTIL WA-REM-TERM = WA-REM-TERM-TMP
TB0099
TB0099              COMPUTE WA-DUE-DAYS-TMP2 = ((1 - WA-DUE-DAYS-TMP1)
TB0099                                  / WA-DUE-DAYS-R)
TB0099              MOVE BORM-LOAN-BAL TO WA-LOAN-BAL
TB0099              ADD WA-REPAY-AMOUNT TO WA-LOAN-BAL
TB0099              COMPUTE WA-DUE-AMT-TEMP = WA-LOAN-BAL /
TB0099                      WA-DUE-DAYS-TMP2
TB0099              MOVE WA-DUE-AMT-TEMP TO BORM-DUE-AMT
TB0099           END-IF
TB0099        END-IF
TB0095     IF STRT-AREA-TRN-NO = 13031
TB0095         MOVE WA-INPUT-AMT    TO UT0072CA-TRAN-AMT
TB0095         MOVE 03              TO UT0072CA-CALL-CODE
TB0095         CALL "UT0072"        USING  UT0072CA-CALL-AREA
TB0095                                     BORM-RECORD-AREA
TB0095                                     BOIS-RECORD
TB0095                                     BORR-PARAMS.
TB0095     IF      UT0072CA-RET-STATUS     <>      0
TB0095       DISPLAY   "BR0000:(E6170) ERROR CALLING UT0072 "
TB0095                ", KEY=" BORM-KEY
TB0095                ", RETURN CODE=" UT0072CA-RET-STATUS
TB0095                ", ERROR=" UT0072CA-ERROR-MSG-NO.
TB0095*
TB0096     IF  WA-ADJ-WAIVE NOT = "N" AND "Y" AND SPACE
TB0096         MOVE 1 TO WA-MSG-ERR-FLAG
TB0096         MOVE 4267 TO WA-OUTPUT-ERR-MSG-NO
TB0096         GO TO S599-EXIT
TB0096     ELSE
TB0096        IF WA-ADJ-WAIVE = SPACE
TB0096           MOVE "N" TO WA-ADJ-WAIVE
TB0096        END-IF
TB0096     END-IF.
TB0096
142680     IF  WA-ADJ-SUB-LEDG-CODE < 1 OR
142690         WA-ADJ-SUB-LEDG-CODE > 30
142700         MOVE 1 TO WA-MSG-ERR-FLAG
142710         MOVE 194 TO WA-OUTPUT-ERR-MSG-NO
142720         GO TO S599-EXIT.
142730     PERFORM L100-VALIDATE-INPUT THRU L199-EXIT.
142740     IF  WA-MSG-ERR-FLAG = 1
142750         GO TO S599-EXIT.
142760     IF WA-INPUT-PARAM-TABLE(10) = 1
142770         PERFORM L200-TRANSLATE-DAYS THRU L299-EXIT
142780         IF WA-MSG-ERR-FLAG = 1
142790           GO TO S599-EXIT.
142800     IF  STRT-AREA-TRN-NO = 13503 OR 13504
142810*        ADD WA-DUMMY-AMT TO BORM-LOAN-BAL BORM-IR-INT-CHARGED
142820*NBG003
142830         PERFORM X2000-READ-BIRM THRU X2999-EXIT
142840         IF WA-MSG-ERR-FLAG = 1
142850             GO TO S599-EXIT
142860         END-IF
142870         IF DBIOMOD-STAT = "MRNF"
142880            MOVE "WRITE" TO DBIOMOD-FUNCTION
142890         ELSE
142900            MOVE "REWRITE" TO DBIOMOD-FUNCTION
142910         END-IF
142920         ADD WA-DUMMY-AMT TO BIRM-IR-INT-CHARGED
142930         PERFORM X3000-WRITE-REWRITE-BIRM THRU X3999-EXIT
142940         IF WA-MSG-ERR-FLAG = 1
142950             GO TO S599-EXIT
142960         END-IF
142970         MOVE STRT-AREA-LEDG-CODE    TO  WA-LEDGER-CODE
142980         MOVE STRT-AREA-PRIORITY-CODE TO  WA-PRIORITY-CODE
142990         MOVE WA-DUMMY-AMT           TO  WA-AMOUNT-TO-ADD
NR2001*143000                                         BORV-01-AMOUNT                 
NR2001                                         BOCT-01-AMOUNT
143010         MOVE BORM-LOAN-BAL          TO  CPY-BORM-LOAN-BAL
143020         MOVE BORM-THEO-LOAN-BAL     TO  CPY-BORM-THEO-LOAN-BAL
143030*
143040         IF BORP-PRIORITY-CODE-ON AND (STRT-AREA-TRN-NO = 13504)
143050            IF WA-PRIORITY-CODE = SPACES
143060               INITIALIZE UT0095CA-AREA
143070               MOVE 03                  TO UT0095CA-CALL-CODE
143080               MOVE "BOR"               TO UT0095CA-SYSTEM
143090               MOVE STRT-AREA-LEDG-CODE TO UT0095CA-LEDG-CODE
NR2001*143100               MOVE STRT-AREA-POST-DT   TO BORV-01-TRN-DATE
NR2001*143110               MOVE BORV-01-DETAIL      TO
NR2001*143120                     UT0095CA-BORV-RECORD-AREA
NR2001               MOVE STRT-AREA-POST-DT   TO BOCT-TRN-DATE
NR2001               MOVE BOCT-RECORD-AREA    TO
NR2001                     UT0095CA-BOCT-RECORD-AREA
143130               MOVE BORM-RECORD-AREA    TO
143140                     UT0095CA-BORM-RECORD-AREA
143150               MOVE BORM-LOAN-BAL       TO
143160                     UT0095CA-LOAN-BAL
143170               MOVE BORM-THEO-LOAN-BAL  TO
143180                     UT0095CA-THEO-LOAN-BAL
143190               MOVE STRT-AREA-RECOVERY  TO UT0095CA-RECOVERY-FLAG
143200               CALL "UT0095" USING UT0095CA-CALL-PARAM
143210               IF UT0095CA-RET-STATUS = ZEROS
143220                  MOVE UT0095CA-LOAN-BAL TO CPY-BORM-LOAN-BAL
143230                                            BORM-LOAN-BAL
143240                  MOVE UT0095CA-THEO-LOAN-BAL TO
143250                        CPY-BORM-THEO-LOAN-BAL
143260                        BORM-THEO-LOAN-BAL
143270                  MOVE UT0095CA-PRINCIPAL-BAL TO
143280                        BORM-UNPAID-PRINCIPAL-BAL
143290                  MOVE UT0095CA-THEO-PRINCIPAL-BAL TO
143300                        BORM-THEO-UNPAID-PRINCIPAL-BAL
143310                  MOVE UT0095CA-INTEREST-BAL TO
143320                        BORM-CAP-UNPAID-INT
143330                  MOVE UT0095CA-THEO-INTEREST-BAL TO
143340                        BORM-CAP-THEO-UNPAID-INT
143350                  MOVE UT0095CA-ARREARS-BAL TO
143360                        BORM-UNPAID-ARRS-INT-BAL
143370                  MOVE UT0095CA-THEO-ARREARS-BAL TO
143380                        BORM-THEO-UNPAID-ARRS-INT-BAL
143390                  MOVE UT0095CA-CHARGES-BAL TO
143400                        BORM-UNPAID-CHRG-BAL
143410                  MOVE UT0095CA-THEO-CHARGES-BAL TO
143420                        BORM-THEO-UNPAID-CHRG-BAL
143430                  MOVE UT0095CA-TOM-BAL TO                              
143440                        BORM-UNPAID-TOM-INT                             
143450                  MOVE UT0095CA-THEO-TOM-BAL TO                         
143460                        BORM-THEO-UNPAID-TOM-INT                        
143470               END-IF
143480            ELSE
143490               PERFORM N000-ADD-TO-LOAN-BAL THRU NADD-EXIT
143500         ELSE
143510            PERFORM N100-ADD-TO-LOAN-BAL THRU N199-EXIT
143520         END-IF
143530*
143540         MOVE CPY-BORM-LOAN-BAL      TO  BORM-LOAN-BAL
143550         MOVE CPY-BORM-THEO-LOAN-BAL TO  BORM-THEO-LOAN-BAL
143560         GO TO S510-CONTINUE
143570     END-IF.
143580*    IF  BORM-REM-REPAYS > 0                                            
143590*        MOVE 2                      TO  WA-LEDGER-CODE                 
143600*    ELSE                                                               
143610*        MOVE 1                      TO  WA-LEDGER-CODE                 
143620*    END-IF.                                                            
143630     MOVE STRT-AREA-LEDG-CODE        TO  WA-LEDGER-CODE.                
143640     MOVE STRT-AREA-PRIORITY-CODE    TO  WA-PRIORITY-CODE.
143650     MOVE WA-DUMMY-AMT               TO  WA-AMOUNT-TO-ADD               
NR2001*143660                                         BORV-01-AMOUNT.                
143660                                         BOCT-01-AMOUNT.
143670     MOVE BORM-LOAN-BAL              TO  CPY-BORM-LOAN-BAL.
143680     MOVE BORM-THEO-LOAN-BAL         TO  CPY-BORM-THEO-LOAN-BAL.
143690*
143700     IF BORP-PRIORITY-CODE-ON AND (STRT-AREA-SIGN = "-")
TB0099        AND STRT-AREA-TRN-NO NOT = 13031 AND 11044 AND 11048
TB0099        AND 16044 AND 16048 AND 13131 AND 11144 AND 11148
TB0099        AND 16144 AND 16148
S11617        AND 16129
S17282        AND 16102
143710        IF WA-PRIORITY-CODE = SPACES
143720           INITIALIZE UT0095CA-AREA
143730           MOVE 03                  TO UT0095CA-CALL-CODE
143740           MOVE "BOR"               TO UT0095CA-SYSTEM
143750           MOVE STRT-AREA-LEDG-CODE TO UT0095CA-LEDG-CODE
NR2001*143760           MOVE STRT-AREA-POST-DT   TO BORV-01-TRN-DATE
NR2001*143770           MOVE BORV-01-DETAIL      TO UT0095CA-BORV-RECORD-AREA
NR2001           MOVE STRT-AREA-POST-DT   TO BOCT-TRN-DATE
NR2001           MOVE BOCT-RECORD-AREA    TO UT0095CA-BOCT-RECORD-AREA
143780           MOVE BORM-RECORD-AREA    TO UT0095CA-BORM-RECORD-AREA
143790           MOVE BORM-LOAN-BAL       TO UT0095CA-LOAN-BAL
143800           MOVE BORM-THEO-LOAN-BAL  TO UT0095CA-THEO-LOAN-BAL
143810           MOVE STRT-AREA-RECOVERY  TO UT0095CA-RECOVERY-FLAG
143820           CALL "UT0095" USING UT0095CA-CALL-PARAM
143830           IF UT0095CA-RET-STATUS = ZEROS
143840              MOVE UT0095CA-LOAN-BAL  TO CPY-BORM-LOAN-BAL
143850                                         BORM-LOAN-BAL
143860              MOVE UT0095CA-THEO-LOAN-BAL TO
143870                    CPY-BORM-THEO-LOAN-BAL
143880                    BORM-THEO-LOAN-BAL
143890              MOVE UT0095CA-PRINCIPAL-BAL TO
143900                    BORM-UNPAID-PRINCIPAL-BAL
143910              MOVE UT0095CA-THEO-PRINCIPAL-BAL TO
143920                    BORM-THEO-UNPAID-PRINCIPAL-BAL
143930              MOVE UT0095CA-INTEREST-BAL TO
143940                    BORM-CAP-UNPAID-INT
143950              MOVE UT0095CA-THEO-INTEREST-BAL TO
143960                    BORM-CAP-THEO-UNPAID-INT
143970              MOVE UT0095CA-ARREARS-BAL TO
143980                    BORM-UNPAID-ARRS-INT-BAL
143990              MOVE UT0095CA-THEO-ARREARS-BAL TO
144000                    BORM-THEO-UNPAID-ARRS-INT-BAL
144010              MOVE UT0095CA-CHARGES-BAL TO
144020                    BORM-UNPAID-CHRG-BAL
144030              MOVE UT0095CA-THEO-CHARGES-BAL TO
144040                    BORM-THEO-UNPAID-CHRG-BAL
144050              MOVE UT0095CA-TOM-BAL TO                                  
144060                    BORM-UNPAID-TOM-INT                                 
144070              MOVE UT0095CA-THEO-TOM-BAL TO                             
144080                    BORM-THEO-UNPAID-TOM-INT                            
144090           END-IF
144100        ELSE
144110           PERFORM N000-ADD-TO-LOAN-BAL THRU NADD-EXIT
144120     ELSE
144130        PERFORM N100-ADD-TO-LOAN-BAL THRU N199-EXIT
144140     END-IF
144150*
144160     MOVE CPY-BORM-LOAN-BAL          TO  BORM-LOAN-BAL.
144170     MOVE CPY-BORM-THEO-LOAN-BAL     TO  BORM-THEO-LOAN-BAL.
144180     IF ((BORP-CAPN-METHOD NOT = " ")
144190     AND (BORP-CAPN-METHOD IS ALPHABETIC))
144200        GO TO S510-CONTINUE.
144210     IF STRT-AREA-TRN-NO = 13033 OR 13133 OR 13051 OR 13151 OR
144220                          13052 OR 13152 OR 13053 OR 13153 OR
144230                          13032 OR 13132 OR 13034 OR 13134 OR
144240                          13035 OR 13135
144250        IF BORP-ACCRUE-FREQ = 99
144260           SUBTRACT WA-DUMMY-AMT FROM BORM-PRINC-REDUCT-PEND
144270        ELSE
144280           SUBTRACT WA-DUMMY-AMT FROM BORM-PRINC-REDUCT-EFF.
144290*                                                                         
144300     IF  (STRT-AREA-TRN-NO = 10731)                                       
144310     AND (BORP-TOM-RATE-TBL-ID   NOT = SPACE AND "0")                     
144320          ADD WA-DUMMY-AMT       TO   BORM-TOM-ACRU-AMT                   
144330     END-IF.                                                              
144340     IF  (STRT-AREA-TRN-NO = 10751)                                       
144350     AND (BORP-TOM-RATE-TBL-ID   NOT = SPACE AND "0")                     
144360          SUBTRACT WA-DUMMY-AMT  FROM BORM-TOM-ACRU-AMT                   
144370     END-IF.                                                              
144380*                                                                         
144390******************************************************************
144400* LIMIT FACILITY PROCESSING (LM0000) REQ'S THE ABILITY TO REDUCE
144410* LOAN BALANCE TO 0 USING A 13033 TXN (IE NO PENALTY INT TO APPLY)
144420******************************************************************
144430* ADDED BY A. SERHAN FROM 5 TO 8.
144440     IF  BORM-STAT = 8
144450         IF  BORM-LOAN-BAL < 11
144460             IF NOT (STRT-TRICKLE-TXN
144470              AND STRT-AREA-TRN-NO = 13033)
TB0099              AND BORP-CONSMR
144480             MOVE 1 TO WA-MSG-ERR-FLAG
144490             MOVE 142 TO WA-OUTPUT-ERR-MSG-NO
144500             GO TO S599-EXIT.
144510 S510-CONTINUE.
144520     IF WA-INPUT-PARAM-TABLE(10) = 1 AND
144530        ST-CHQ-CLEAR-DAYS > 0
144540         MOVE 0                       TO WA-CALC-DATE
144550         IF WA-INPUT-PARAM-TABLE(8)   =  1
144560            MOVE WA-STORE-TXN-DT      TO WA-CALC-DATE
144570            GO                        TO S520
144580         ELSE
144590            MOVE STRT-AREA-POST-DT     TO WA-CALC-DATE
144600            GO                        TO S520
144610     ELSE
144620         GO                           TO S530.
144630 S520.
144640     ADD ST-CHQ-CLEAR-DAYS            TO WA-CALC-DATE
144650     IF  WA-CALC-DATE                 >  WA-DMY
144660         MOVE WA-DUMMY-AMT            TO BORM-UNC-VAL
144670         ADD 1                        TO BORM-NO-UNC.
144680 S530.
144690     IF  BORM-STAT = 20 AND BORM-LOAN-BAL = 0
144700         MOVE 0 TO BORM-APP-AMT BORM-ADV-VAL
144710         MOVE 40 TO BORM-STAT.
144720     MOVE WA-ADJ-TXN-DATE        TO UT0030-DATE-DDMMCCYY.
144730     PERFORM X610-UT0030-PARA THRU X619-EXIT.
144740     MOVE UT0030-BINARY-DATE TO WA-STORE-TXN-DT.
144750     IF  UT0030-BINARY-DATE = ZEROES
144760         MOVE 126                TO WA-OUTPUT-ERR-MSG-NO
144770         MOVE 1                  TO WA-MSG-ERR-FLAG
144780         GO TO S599-EXIT.
144790     IF  UT0030-BINARY-DATE > STRT-AREA-POST-DT
144800         MOVE 190                TO WA-OUTPUT-ERR-MSG-NO
144810         MOVE 1                  TO WA-MSG-ERR-FLAG
144820         GO TO S599-EXIT.
NR2001*144830     INITIALIZE BORV-01-DETAIL.
NR2001*144840     MOVE 01 TO BORV-01-CODE.
NR2001     INITIALIZE BOCT-TRAN-01.
NR2001     MOVE 01 TO BOCT-TRAN-TYPE.
144850     IF WA-INPUT-PARAM-TABLE(8) = 1
144860         PERFORM N1500-CALC-INT-DUE-DT THRU N1599-EXIT
144870         IF  WA-STORE-TXN-DT < WA-INT-ST-DATE
144880             MOVE 1              TO WA-BKD-STAT
144890             MOVE 1              TO BORM-BACK-DT-IND
144900         ELSE
144910             MOVE 0              TO WA-BKD-STAT
144920     ELSE
144930         MOVE 0                  TO WA-BKD-STAT.
144940     IF WA-INPUT-PARAM-TABLE(6) = 1
144950         MOVE 1                  TO WA-NPB-STAT
144960         ADD WA-DUMMY-AMT        TO BORM-NPB-VAL
144970         ADD 1                   TO BORM-NO-NPB
144980     ELSE
144990         MOVE 0                  TO WA-NPB-STAT.
145000     IF  WA-INPUT-PARAM-TABLE(8) = 1
145010         IF  BORM-LST-FIN-DATE < WA-STORE-TXN-DT
145020             MOVE WA-STORE-TXN-DT TO BORM-LST-FIN-DATE
145030         ELSE NEXT SENTENCE
145040     ELSE
145050         MOVE STRT-AREA-POST-DT TO BORM-LST-FIN-DATE.
145060*    IF (STRT-AREA-TRN-NO = 10730 OR 10750) AND
145070*       (BORM-IR-STATUS-CODE > 0)
145080*       ADD WA-DUMMY-AMT TO BORM-IR-INT-CHARGED
145090*       IF WA-INPUT-PARAM-TABLE(8) = 1
145100*         MOVE WA-STORE-TXN-DT TO BORM-IR-ACTIVITY
145110*       ELSE
145120*         MOVE STRT-AREA-POST-DT TO BORM-IR-ACTIVITY.
NR2001*            MOVE WA-TXN-STAT            TO BORV-01-STATUS. 
NR2001*            MOVE WA-STORE-TXN-DT        TO BORV-01-TRN-DATE.
NR2001*            MOVE UPTELLCA-TELLER-BRANCH    TO BORV-01-TELL-AND-BR.
NR2001*            MOVE STRT-AREA-TERM-NO   TO BORV-01-BRTERM.
NR2001*            MOVE STRT-AREA-TRN-NO    TO BORV-01-TRN-CODE.
NR2001*            MOVE STRT-AREA-POST-DT   TO BORV-01-POST-DATE.
NR2001*            MOVE STRT-AREA-JRNL-NO   TO BORV-01-JRNL-NO.
NR2001*            MOVE BORM-LOAN-BAL TO BORV-01-BALANCE.
NR2001*            MOVE WA-DUMMY-AMT TO BORV-01-AMOUNT.
NR2001*            IF WA-INPUT-PARAM-TABLE(10) = 1
NR2001*               MOVE ST-CHQ-CLEAR-DAYS TO BORV-01-CHQ-DAYS
NR2001*            ELSE
NR2001*               MOVE 0              TO BORV-01-CHQ-DAYS.
NR2001*            COMPUTE BORV-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001*            MOVE WA-ADJ-SUB-LEDG-CODE TO BORV-01-SUB-LEDG-CODE.
NR2001*            MOVE STRT-AREA-MSG-TIME   TO BORV-01-POST-TIME.
NR2001      MOVE WA-TXN-STAT          TO BOCT-STAT. 
NR2001      MOVE WA-STORE-TXN-DT      TO BOCT-TRN-DATE.
NR2001      MOVE STRT-AREA-TRN-NO     TO BOCT-TRN-CODE.
NR2001      MOVE BORM-LOAN-BAL        TO BOCT-01-BALANCE.
NR2001      MOVE WA-DUMMY-AMT         TO BOCT-01-AMOUNT.
NR2001      IF WA-INPUT-PARAM-TABLE(10) = 1
NR2001         MOVE ST-CHQ-CLEAR-DAYS TO BOCT-01-CHQ-DAYS
NR2001      ELSE
NR2001         MOVE 0                 TO BOCT-01-CHQ-DAYS.
NR2001      COMPUTE BOCT-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001      MOVE WA-ADJ-SUB-LEDG-CODE TO BOCT-01-SUB-LEDG-CODE.
NR2001      MOVE STRT-AREA-MSG-TIME   TO BOCT-01-REPOST-TIME.
            PERFORM W500-ADD-TXN THRU W599-EXIT.
            IF  WA-MSG-ERR-FLAG = 1
                GO TO S599-EXIT.
145320*
145330*  SET UP TYPE 20 TXN.
145340***  760290
145350***  REINSTATE BORV-RECORD-AREA WITH THE TYPE 01, THIS AREA WILL
145360***  BE PASSED TO UT0069 FOR INTEREST RECALCULATION
145370*
           MOVE STRT-AREA-TRN-NO TO LINK-IN-TXCODE.
           PERFORM X700-CALL-UT0250 THRU X799-EXIT.
           IF WA-MSG-ERR-FLAG = 1
              GO TO S599-EXIT.
           IF (LINK-NARR-TXN-TYPE = 20) OR
              (WA-IN-NARR-TEXT NOT = SPACES)
               PERFORM O200-ADD-TYPE-20 THRU O299-EXIT
               IF WA-MSG-ERR-FLAG = 1
                  GO TO S599-EXIT
           ELSE
NR2001*              MOVE WA-BORV-RECIEPT-AREA TO BORV-01-DETAIL.
NR2001        MOVE WA-BOCT-RECIEPT-AREA TO BOCT-RECORD-AREA.
145490*
145500     MOVE SPACES                 TO WA-OUTPUT-MESSAGE.
145510*
145520     MOVE WA-INPUT-KEY       TO WA-ADV-OUTPUT-MSG-KEY.
145530* SWIFT CHANGE HERE
145540     IF  WA-INPUT-PARAM-TABLE(6) = 1
145550       IF SOC-DISPLAY-NAME  = "Y"
145560         MOVE BORM-CUSTOMER-NO TO UT0500CA-CUSM-NO
145570         MOVE 1                TO UT0500CA-CALL-CODE
145580         PERFORM V500-CALL-UT0500 THRU V599-EXIT
145590         IF  UT0500RA-CALL-STATUS NOT = 0
145600             GO TO S599-EXIT
145610         ELSE
145620             MOVE UT0500RA-NAME-1   TO WA-ADV-OUTPUT-NAME1
145630             MOVE UT0500RA-NAME-2   TO WA-ADV-OUTPUT-NAME2
S11927             MOVE WS-UT0500RA-CUSM-STATUS-SAVE
S11927                                    TO WA-SAVE-CUST-STATUS
S16182*S12520             MOVE UT0500RA-ACC-NO   TO UTCICECA-CUST-NO
145640         END-IF
145650       END-IF
NR2001*145660       MOVE WA-BORV-RECIEPT-AREA    TO WA-ADV-OUTPUT-TRAN
NR2001       MOVE WA-BOCT-RECIEPT-AREA    TO WA-ADV-OUTPUT-TRAN
145670       MOVE SPACES                  TO WA-ADV-OUTPUT-SW-REF-NO
145680       MOVE 002                     TO WA-OUTPUT-ERR-MSG-NO
145690       SET PBOOKCA-RCPT-PRINT TO TRUE
NR2001*145700       MOVE 178                     TO WA-OUTPUT-MSG-LENGTH
NR2001       MOVE 297                     TO WA-OUTPUT-MSG-LENGTH
145710     ELSE
145720         MOVE STRT-AREA-JRNL-NO     TO WA-OUTPUT-JRNL-NO
145730         MOVE 4                     TO WA-INPUT-MSG-CODE
145740         MOVE 0                     TO STRT-AREA-IEXEC-CNTL
145750         MOVE 999                   TO WA-OUTPUT-ERR-MSG-NO
145760         MOVE 7                     TO  WA-OUTPUT-MSG-LENGTH            
145770         PERFORM E1000-PRE-FMT-SEND-PARA
145780             THRU E1999-EXIT
145790         GO TO S599-EXIT
145800     END-IF.
145810*
145820     PERFORM E100-FMT-SEND-PARA     THRU E199-EXIT.
145830     MOVE SPACES                    TO WA-OUTPUT-MESSAGE.
145840     PERFORM M1200-CAP-BAL-DTLS THRU M1299-EXIT.
145850     MOVE SPACES                    TO WA-OUTPUT-MESSAGE.
145860     MOVE 0                         TO WA-OUTPUT-ERR-MSG-NO.
145870     PERFORM E1000-PRE-FMT-SEND-PARA
145880             THRU E1999-EXIT.
145890 S599-EXIT.
145900     EXIT.
145910/
TB0099 S550-CHK-ACCT-STATUS.
TB0099     COMPUTE WA-BORM-DUE-AMT ROUNDED = BORM-DUE-AMT * 1
tb0099     MOVE WA-REPAY-TXN-DATE TO UT0030-DATE-DDMMCCYY.
TB0099     PERFORM X610-UT0030-PARA THRU X619-EXIT.
TB0099     MOVE UT0030-BINARY-DATE TO WA-TMP-TXN-DTE.
TB0172     IF BOIS-LEGAL-FEE1-DUE NOT = 0
TB0172         OR BOIS-LEGAL-FEE2-DUE NOT = 0
TB0172        MOVE 3307   TO  WA-OUTPUT-ERR-MSG-NO
TB0172        MOVE 1      TO WA-MSG-ERR-FLAG
SC5266        PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
SC5266*       CALL "FT0000" USING STARTAREA
TB0172        GO TO S550-EXIT
TB0172     END-IF.
TB0099     IF BORP-CONSMR OR BORP-COMML
SC2981        IF (WA-TMP-TXN-DTE < BOIS-MATURITY-DATE) OR
SC2981           (WA-TMP-TXN-DTE >= BOIS-MATURITY-DATE AND BORP-COMML)
TB0099           IF BORP-PRN-REPAY-IND = "Y"
TB0099              IF (BOIS-ARREARS-CTR > 0) OR
TB0099                 (BORM-BAD-DEBT-IND > 0) OR
TB0099                 (WA-REPAY-AMOUNT > BORM-LOAN-BAL) OR
TB0099                  (BOIS-LEGAL-FEE1-DUE > 0) OR
TB0099                  (BOIS-LEGAL-FEE2-DUE > 0)
TB0099                  MOVE 4261   TO WA-OUTPUT-ERR-MSG-NO
SC2269                  IF (WA-REPAY-AMOUNT > BORM-LOAN-BAL)
SC2269                      MOVE 4997 TO WA-OUTPUT-ERR-MSG-NO
SC2269                  END-IF
TB0099                  MOVE 1      TO WA-MSG-ERR-FLAG
SC5266                  PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
SC5266*                 CALL "FT0000" USING
SC5266*                                STARTAREA
TB0099              ELSE
SC2292**               IF BORM-REPAY-SCHED = "F"
SC2292                 IF BORM-REPAY-SCHED = "F" OR "G"
TB0099                    IF NOT WA-VALID-PRIN-RECALC
TB0099                       MOVE 1501   TO  WA-OUTPUT-ERR-MSG-NO
TB0099                       MOVE 1      TO WA-MSG-ERR-FLAG
SC5266                       PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
SC5266*                      CALL "FT0000" USING STARTAREA
TB0099                    ELSE
TB0099                       PERFORM ZZ002-CALL-UT0312
TB0099                                THRU  ZZ002-EXIT
TB0099                       IF WA-MSG-ERR-FLAG = 1
TB0099                          GO TO S550-EXIT
TB0099                       END-IF
TB0099                       PERFORM ZZ001-CALL-UT0075
TB0099                               THRU ZZ001-EXIT
TB0099                       IF WA-MSG-ERR-FLAG = 1
TB0099                          GO TO S550-EXIT
TB0099                       END-IF
TB0099                       IF WA-REPAY-PRIN-RECALC = "1"
TB0099                        IF (((WA-REPAY-AMOUNT < WA-BORM-DUE-AMT
TB0099                            OR WA-REPAY-AMOUNT > BORM-LOAN-BAL)
SC1740                             AND BORM-REPAY-SCHED <> "B")
SC1740                             OR (WA-REPAY-AMOUNT <
SC1740                               (BORM-DUE-AMT - BORM-LOAN-REPAY)
SC1740                             OR WA-REPAY-AMOUNT > BORM-LOAN-BAL
SC1740                             AND BORM-REPAY-SCHED = "B"
SC1740                             AND (BORM-LOAN-TRM -
SC1740                                BOIS-LAST-TERM-PAID = 1)))
SC8017                             AND (NOT STRT-BATCH-TXN
SC8017                             AND STRT-AREA-TRN-NO NOT = 16044)
S12000                             AND BOIS-MISC-INC-DUE = 0
TB0099                             MOVE 3766 TO WA-OUTPUT-ERR-MSG-NO
TB0099                             MOVE 1 TO WA-MSG-ERR-FLAG
TB0099                             GO TO S550-EXIT
TB0099                          ELSE
TB0099                             PERFORM S550B-CMPTRM
TB0099                                   THRU S550B-EXIT
TB0099                          END-IF
TB0099                       ELSE
TB0099                          PERFORM S550F-LON-CAL THRU S550F-EXIT
TB0099                       END-IF
TB0099                    END-IF
TB0099                 END-IF
SC1650                 IF BORM-REPAY-SCHED = 'B'
SC1740                    IF WA-REPAY-PRIN-RECALC <> "1"
SC1740                       PERFORM S550D-COMP-LON-REP
SC1740                                      THRU S550D-EXIT
SC1740                    ELSE
SC1740                       PERFORM S550B-CMPTRM
SC1740                                      THRU S550B-EXIT
SC1740                    END-IF
SC1650                 END-IF 
TB0099              END-IF
TB0099           ELSE
TB0099              IF BORP-PRN-REPAY-IND = "N"
S12000                 AND BOIS-MISC-INC-DUE = 0
TB0099                 MOVE 1502   TO WA-OUTPUT-ERR-MSG-NO
TB0099                 MOVE 1      TO WA-MSG-ERR-FLAG
SC5266                 PERFORM E100-FMT-SEND-PARA THRU E199-EXIT
SC5266*                CALL "FT0000" USING
SC5266*                              STARTAREA
TB0099              END-IF
TB0099           END-IF
TB0099        END-IF
TB0099     END-IF.
TB0099
TB0099 S550-EXIT.
TB0099     EXIT.
TB0099
TB0099 S550F-LON-CAL.
TB0099     IF WA-REPAY-PRIN-RECALC = "2"
TB0099        IF WA-REPAY-AMOUNT < WA-BORM-DUE-AMT
TB0099           OR WA-REPAY-AMOUNT > BORM-LOAN-BAL
TB0099           MOVE 1 TO WA-MSG-ERR-FLAG
TB0099           GO TO S550F-EXIT
TB0099        ELSE
TB0099           PERFORM S550D-COMP-LON-REP THRU S550D-EXIT
TB0099        END-IF
TB0099     ELSE
tb0099        IF WA-REPAY-PRIN-RECALC = "0"
TB0099           CONTINUE
TB0099        END-IF
TB0099     END-IF.
TB0099
TB0099 S550F-EXIT.
TB0099      EXIT.
SC2159 S560-REPAY-PRIN-RECALC.
SC2159     INITIALIZE BUCV-KEY.
           MOVE BORM-SOC-NO           TO BUCV-INST-NO.
           MOVE BORM-MEMB-CUST-AC     TO BUCV-ACCT-NO.
           MOVE BOIS-CYCLE-NO         TO BUCV-CYCLE-NO.
           MOVE "P"                   TO BUCV-BUCKET-CODE.
           MOVE BOIS-LAST-TERM-PAID   TO WA-BUCV-TERM-NO.
           IF   BOIS-LAST-TERM-PAID   <  BORM-LOAN-TRM
                ADD 1                 TO WA-BUCV-TERM-NO
           END-IF.
           MOVE WA-BUCV-TERM-NO       TO BUCV-TERM-NO.
           MOVE 0                     TO BUCV-SEQUENCE-NO.
           SET  WA-SEARCH-BUCV-START  TO TRUE.
           MOVE 78                    TO DBIO-CALL-FUNC.
           MOVE "BEGN"                TO DBIO-CALL-SAVE-REFER.
           PERFORM S570-ACCESS-BUCV THRU S570-EXIT.
           PERFORM UNTIL (NOT WA-SEARCH-BUCV-START)
                          OR WA-MSG-ERR-FLAG = 1
              IF DBIO-CALL-STATUS     <> "****"
              OR DBIO-CALL-SAVE-REFER  = "END."
              OR BORM-SOC-NO          <> BUCV-INST-NO
              OR BORM-MEMB-CUST-AC    <> BUCV-ACCT-NO
              OR BOIS-CYCLE-NO        <> BUCV-CYCLE-NO
              OR BUCV-TERM-NO         <> WA-BUCV-TERM-NO
              OR BUCV-BUCKET-CODE     <> "P"
                 SET WA-SEARCH-BUCV-END TO TRUE
              ELSE
SC3658*          IF  WA-REPAY-TRACER-NO = BUCV-JRNL-NO
SC3658*          AND WA-REPAY-AMOUNT    = BUCV-TXN-AMT * -1
SC3658           IF  (WA-REPAY-TRACER-NO = BUCV-JRNL-NO
SC4246            AND WA-REPAY-AMOUNT    = BUCV-TXN-AMT)
SC4246*           AND WA-REPAY-AMOUNT    = BUCV-TXN-AMT * -1)
SC3658            OR (WA-REPAY-TRACER-NO = BUCV-JRNL-NO
SC3658            AND WA-REPAY-AMOUNT    = BUCV-TXN-AMT
SC3658*S10542     AND (STRT-AREA-TRN-NO = 16144 OR 16148 OR 16130))
S11617*S10542            AND (STRT-AREA-TRN-NO = 16144 OR 16148))
S17282*S11617     AND (STRT-AREA-TRN-NO = 16144 OR 16148 OR 16129))
S17282            AND (STRT-AREA-TRN-NO = 16144 OR 16148 OR 16129
S17282                                 OR 16102))
                     SET WA-SEARCH-BUCV-FOUND   TO TRUE
                     MOVE BUCV-REPAY-PRN-RECALC TO WA-REPAY-PRIN-RECALC
                 ELSE
                     PERFORM S570-ACCESS-BUCV THRU S570-EXIT
                 END-IF
              END-IF
           END-PERFORM.
           IF WA-SEARCH-BUCV-END
              MOVE 188  TO WA-OUTPUT-ERR-MSG-NO
              MOVE 1    TO WA-MSG-ERR-FLAG
           END-IF.
SC2159 S560-EXIT.
SC2159     EXIT.
SC2159 S570-ACCESS-BUCV.
SC2159     INITIALIZE          DBIO-CALL-KEY-AREA.
           MOVE BUCV-KEY    TO DBIO-CALL-KEY-AREA.
           MOVE "BUCV"      TO DBIO-CALL-N-SYS.
           MOVE 0           TO DBIO-CALL-ALT-KEY.
           CALL "DBIO" USING   DBIO-CALL-PARAM
                               DBIO-CALL-SYS-AREA
                               DBIO-CALL-KEY-AREA
                               DBIO-CALL-STATUS
                               WA-BUCV-AREA.
           IF DBIO-CALL-STATUS   NOT = "****"
              SET UT8500CA-NORMAL-DISPLAY TO TRUE
              MOVE SPACES TO UT8500CA-INPUT-MSG
              MOVE STRT-AREA-TRN-NO TO WA-DISP-TRAN-CODE
              STRING "BR0000:(S570) ERROR WHILE READING BUCV"
                     ", STATUS=" DBIO-CALL-STATUS
                     ", KEY="    DBIO-CALL-KEY-AREA
                     ", TRAN: " WA-DISP-TRAN-CODE
                     DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
              MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
              CALL "UT8500" USING    UT8500CA-AREA
              MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
              MOVE 1 TO WA-MSG-ERR-FLAG
           END-IF.
SC2159 S570-EXIT.
SC2159      EXIT.
S11604 S580-TIF-TFR-FROM-DEP.
S11604     MOVE WA-DEP-ACC-NO        TO INVM-MEMB-CUST-AC.
S11604     PERFORM B1000-READ-INVM THRU B1999-EXIT.
S11604     IF WA-MSG-ERR-FLAG = 1
S11604        GO TO S580-EXIT
S11604     END-IF.
S11604     IF   INVM-ACCT-TYPE        = 1004
S11604      AND INVM-INT-CAT          = 0004
S11604      AND INVM-CUSTOMER-NO  NOT = BORM-CUSTOMER-NO
S11604          MOVE 4154            TO WA-OUTPUT-ERR-MSG-NO
S11604          MOVE 1               TO WA-MSG-ERR-FLAG
S11604     END-IF.
S11604 S580-EXIT.
S11604     EXIT.
TB0099
TB0099 ZZ001-CALL-UT0075.
TB0099     INITIALIZE UT0075CA-CALL-PARAMETER
SC3673*    MOVE 02    TO UT0075CA-CALL-CODE
SC3673     MOVE 05    TO UT0075CA-CALL-CODE
TB0099
TB0099     IF BOIS-LAST-ADV-PYMT-DATE > STRT-AREA-POST-DT
TB0099        MOVE BOIS-LAST-ADV-PYMT-DATE  TO UT0075CA-SYS-DATE
TB0099                                         UT0075CA-EFF-DATE
TB0099     ELSE
TB0099        MOVE STRT-AREA-POST-DT TO  UT0075CA-SYS-DATE
TB0099                                   UT0075CA-EFF-DATE
tb0099     END-IF
SC3673
SC3673     COMPUTE UT0075CA-EFF-DATE = BOIS-LAST-UNPAID-DUE-DATE - 1
SC3673     MOVE STRT-AREA-POST-DT    TO UT0075CA-SYS-DATE
SC3673
SC3673     MOVE BORM-STORE-RATE       TO UT0075CA-INT-RATE
SC3673**   ADD BORM-INT-RATE, BORM-RT-INCR
SC3673**                      GIVING UT0075CA-INT-RATE
TB0099     IF BORM-REPAY-SCHED = SPACE
TB0099        MOVE BORP-REPAY-SCHED TO UT0075CA-REPAY-SCHED
TB0099     ELSE
TB0099        MOVE BORM-REPAY-SCHED TO UT0075CA-REPAY-SCHED
TB0099     END-IF.
TB0099
TB0099     MOVE UT0290CA-CURR-DECS             TO UT0075CA-CURR-DECS
TB0099
TB0099     CALL "UT0075" USING UT0075CA-CALL-AREA
TB0099                         BORM-RECORD-AREA
TB0099                         BOIS-RECORD
TB0099                         BORR-PARAMS
TB0099                         SOC-PARAMS
TB0099     IF UT0075CA-RET-STATUS <> ZERO
TB0099        MOVE 1 TO WA-MSG-ERR-FLAG
TB0099        MOVE UT0075CA-RET-ERROR-MSG TO WA-OUTPUT-ERR-MSG-NO
TB0099        GO TO ZZ001-EXIT
TB0099     END-IF.
TB0099
TB0099 ZZ001-EXIT.
TB0099      EXIT.
TB0099
TB0099 ZZ002-CALL-UT0312.
TB0099      INITIALIZE UT0312CA-CALL-AREA
TB0099      MOVE 03 TO UT0312CA-CALL-CODE
TB0099
TB0099      IF BOIS-LAST-ADV-PYMT-DATE > STRT-AREA-POST-DT
TB0099         MOVE BOIS-LAST-ADV-PYMT-DATE TO UT0312CA-PREV-DUE-DT
TB0099                                         UT0312CA-EFF-DATE
TB0099                                         UT0312CA-DUE-STRT-DT
TB0099      ELSE
TB0099         MOVE STRT-AREA-POST-DT       TO UT0312CA-PREV-DUE-DT
TB0099                                         UT0312CA-EFF-DATE
TB0099                                         UT0312CA-DUE-STRT-DT
tb0099      END-IF
TB0099      MOVE BORM-REPAY-FREQ   TO UT0312CA-REPAY-FREQ
TB0099      IF BORM-REPAY-SCHED = SPACE
TB0099         MOVE BORP-REPAY-SCHED TO UT0312CA-REPAY-SCHED
TB0099      ELSE
TB0099         MOVE BORM-REPAY-SCHED TO UT0312CA-REPAY-SCHED
TB0099      END-IF
TB0099      MOVE BORM-CAPN-METHOD        TO UT0312CA-CAPN-METHOD
TB0099      MOVE BORM-LOAN-TRM           TO UT0312CA-LOAN-TERM
TB0099      MOVE BORM-TERM-BASIS         TO UT0312CA-TERM-BASIS
TB0099      MOVE BORM-REPAY-DAY          TO UT0312CA-REPAY-DAY
TB0099      SET  UT0312CA-HOLIDAY-DUE-PREV-WD TO TRUE
TB0099      MOVE BORP-INT-DAYS-YR  TO UT0312CA-INT-NO-DAYS-YR
TB0099      MOVE UT0312CA-NEXT-DUE-DT TO WA-TMP-NXT-DUE-DTE
DUEIND      MOVE BOIS-DUE-DTE-IND     TO UT0312CA-1ST-DUE-DTE-IND
TB0099      CALL "UT0312" USING UT0312CA-CALL-AREA
TB0099      IF UT0312CA-RET-STATUS <> ZERO
TB0099         MOVE 3026 TO WA-OUTPUT-ERR-MSG-NO
TB0099         MOVE 1    TO WA-MSG-ERR-FLAG
TB0099         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
TB0099         MOVE SPACES TO UT8500CA-INPUT-MSG
TB0099         STRING "BR0000:(ZZ002) ERROR CALLING UT0312"
TB0099                   ", STATUS=" UT0312CA-RET-STATUS
TB0099         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0099         CALL "UT8500" USING
TB0099                               UT8500CA-AREA
TB0099         GO TO ZZ002-EXIT.
TB0099      IF BOIS-MATURITY-DATE <> 0
TB0099         IF UT0312CA-NEXT-DUE-DT = UT0312CA-MATURITY-DT
TB0099            MOVE BOIS-MATURITY-DATE TO UT0312CA-NEXT-DUE-DT
TB0099         END-IF
TB0099         MOVE BOIS-MATURITY-DATE TO UT0312CA-MATURITY-DT.
TB0099
TB0099 ZZ002-EXIT.
TB0099     EXIT.
TB0099
TB0099 S550B-CMPTRM.
tb0099     MOVE 0 TO WA-PAID-TERM
TB0099               WA-REM-TERM
TB0099               WA-NEXT-TERM
TB0099               WA-DUE-AMT
TB0099               WA-LOAN-BAL
TB0099               WA-REPAY-AMT-TMP
TB0099               WA-REPAY-AMT-TMP1
TB0099     COMPUTE WA-PAID-TERM = (BORM-LOAN-TRM - BORM-REM-REPAYS)
SC2292     IF  BORM-REPAY-SCHED = 'G'
SC2292     COMPUTE WA-REPAY-AMT-TMP  =
SC2292              (WA-REPAY-AMOUNT / BORM-LOAN-REPAY)
SC2292     ELSE
TB0099     COMPUTE WA-REPAY-AMT-TMP  =
TB0099              (WA-REPAY-AMOUNT / BORM-DUE-AMT)
SC2292     END-IF
TB0099     COMPUTE WA-REPAY-AMT-TMP1 ROUNDED = WA-REPAY-AMT-TMP * 1
TB0099     COMPUTE WA-REM-TERM ROUNDED = (BORM-LOAN-TRM -
TB0099            (WA-REPAY-AMT-TMP1 + WA-PAID-TERM))
SC0553     MOVE WA-REM-TERM TO BORM-REM-REPAYS
TB0099     COMPUTE WA-NEXT-TERM = (BORM-LOAN-TRM - WA-REM-TERM)
TB0099*    MOVE WA-REM-TERM TO BORM-REM-REPAYS
TB0099     MOVE WA-NEXT-TERM TO BOIS-LAST-TERM-PAID.
TB0099
TB0099 S550B-EXIT.
TB0099      EXIT.
TB0099
TB0099
TB0099 S550D-COMP-LON-REP.
TB0099     MOVE 0 TO WA-DUE-AMT
TB0099               WA-REM-TERM
TB0099               WA-DUE-DAYS
TB0099               WA-DUE-DAYS-P
TB0099               WA-DUE-DAYS-R
TB0099               WA-DUE-DAYS-TMP
TB0099               WA-DUE-DAYS-TMP1
TB0099               WA-DUE-DAYS-TMP2
TB0099               WA-LOAN-BAL.
TB0099     MOVE 1 TO WA-REM-TERM-TMP
TB0099     MOVE WA-TMP-REM-REPAYS TO BORM-REM-REPAYS
TB0099     MOVE WA-TMP-LST-TERM-PAID TO BOIS-LAST-TERM-PAID
TB0099     MOVE WA-BOIS-LST-ADV-DTE TO BOIS-LAST-ADV-PYMT-DATE
TB0099     MOVE BORM-REM-REPAYS TO WA-REM-TERM
tb0099     MOVE BORM-INT-RATE TO WA-INT-RATE-TMP
TB0099     COMPUTE WA-INT-RATE-TMP = WA-INT-RATE-TMP * .01
TB0099     COMPUTE WA-DUE-DAYS  = (WA-INT-RATE-TMP * 30) / 
TB0099              BORP-INT-DAYS-YR
TB0099     COMPUTE WA-DUE-DAYS-P ROUNDED = WA-DUE-DAYS  * 1
TB0099     COMPUTE WA-DUE-DAYS-R ROUNDED = WA-DUE-DAYS-P  * 1
TB0099     COMPUTE WA-DUE-DAYS-TMP = 1 / (1 + WA-DUE-DAYS-R)
TB0099     MOVE WA-DUE-DAYS-TMP TO WA-DUE-DAYS-TMP1
TB0099*    PERFORM S550E-LOAN-REPAY-COMP THRU S550E-EXIT
TB0099*          UNTIL WA-REM-TERM = WA-REM-TERM-TMP
TB0099
TB0099*    COMPUTE WA-DUE-DAYS-TMP2 = ((1 - WA-DUE-DAYS-TMP1)
TB0099*                                 / WA-DUE-DAYS-R)
TB0099     COMPUTE WA-LOAN-BAL = BORM-LOAN-BAL - WA-REPAY-AMOUNT
TB0099*    COMPUTE WA-DUE-AMT-TEMP = WA-LOAN-BAL / WA-DUE-DAYS-TMP2
TB0099*    MOVE WA-DUE-AMT-TEMP TO BORM-DUE-AMT.
TB0099
SC0553     INITIALIZE UT0075CA-CALL-PARAMETER.
SC0553     MOVE WA-LOAN-BAL       TO BORM-LOAN-BAL.
SC0553     MOVE 05    TO UT0075CA-CALL-CODE.
SC0553     IF BOIS-LAST-ADV-PYMT-DATE > STRT-AREA-POST-DT
SC0553        MOVE BOIS-LAST-ADV-PYMT-DATE TO UT0075CA-SYS-DATE
SC0553                                        UT0075CA-EFF-DATE
SC0553     ELSE
SC0553        MOVE STRT-AREA-POST-DT       TO UT0075CA-SYS-DATE
SC0553                                        UT0075CA-EFF-DATE
SC0553     END-IF.
SC0553     ADD BORM-INT-RATE, BORM-RT-INCR GIVING UT0075CA-INT-RATE.
SC0553     MOVE UT0290CA-CURR-DECS TO UT0075CA-CURR-DECS.
SC0553     IF BORM-REPAY-SCHED = SPACE
SC0553        MOVE BORP-REPAY-SCHED TO UT0075CA-REPAY-SCHED
SC0553     ELSE
SC0553        MOVE BORM-REPAY-SCHED TO UT0075CA-REPAY-SCHED
SC0553     END-IF.
SC0553     CALL "UT0075" USING UT0075CA-CALL-AREA
SC0553                         BORM-RECORD-AREA
SC0553                         BOIS-RECORD
SC0553                         BORR-PARAMS
SC0553                         SOC-PARAMS.
SC0553     IF UT0075CA-RET-STATUS <> ZERO
SC0553        MOVE 1 TO WA-MSG-ERR-FLAG
SC0553        MOVE UT0075CA-RET-ERROR-MSG TO WA-OUTPUT-ERR-MSG-NO
SC0553        GO TO S550D-EXIT
SC0553     END-IF.
SC0553     COMPUTE BORM-LOAN-BAL = WA-LOAN-BAL + WA-REPAY-AMOUNT.
SC0553     MOVE UT0075CA-REPAY-AMT TO BORM-DUE-AMT.
SC0553
TB0099 S550D-EXIT.
TB0099     EXIT.
TB0099 S550E-LOAN-REPAY-COMP.
tb0099      COMPUTE WA-DUE-DAYS-TMP1 = WA-DUE-DAYS-TMP1 *
TB0099                      WA-DUE-DAYS-TMP
TB0099      IF WA-REM-TERM NOT = WA-REM-TERM-TMP
TB0099         ADD 1 TO WA-REM-TERM-TMP
TB0099      END-IF.
TB0099 S550E-EXIT.
TB0099     EXIT.
145920 S600-SHARE-DEP.
145930     PERFORM L100-VALIDATE-INPUT THRU L199-EXIT.
145940     IF  WA-MSG-ERR-FLAG = 1
145950         GO TO S699-EXIT.
145960     IF BORM-SHRE-CAP-IND = 1
145970       PERFORM Z3100-RETRIEVE-BSHR THRU Z3199-EXIT
145980       IF WA-MSG-ERR-FLAG = 1
145990          GO TO S699-EXIT
146000       END-IF
146010     ELSE
146020     IF BORM-SHRE-CAP-IND = 0
146030        MOVE ZEROS                   TO BSHR-CAP-VAL
146040                                        BSHR-INT-ACCR
146050                                        BSHR-INT-INCR
146060     END-IF.
146070*    ADD WA-DUMMY-AMT TO BORM-SHRE-CAP-VAL.
146080     ADD WA-DUMMY-AMT TO BSHR-CAP-VAL.
146090     IF WA-INPUT-PARAM-TABLE (7) = 0
146100*       IF BORM-SHRE-CAP-VAL NOT =
146110        IF BSHR-CAP-VAL NOT =
146120                                BORP-SHARE-VAL
146130           MOVE 170 TO WA-OUTPUT-ERR-MSG-NO
146140           MOVE 1 TO WA-MSG-ERR-FLAG
146150           GO TO S699-EXIT.
146160*     IF BORM-SHRE-CAP-VAL = ZERO
146170      IF BSHR-CAP-VAL = ZERO
146180         NEXT SENTENCE
146190      ELSE
146200*        IF BORM-SHRE-CAP-VAL <    BORP-SHARE-VAL
146210         IF BSHR-CAP-VAL <    BORP-SHARE-VAL
146220            MOVE 170 TO WA-OUTPUT-ERR-MSG-NO
146230            MOVE 1 TO WA-MSG-ERR-FLAG
146240            GO TO S699-EXIT.
146250     MOVE WA-ADJ-TXN-DATE        TO UT0030-DATE-DDMMCCYY.
146260     PERFORM X610-UT0030-PARA THRU X619-EXIT.
146270     MOVE UT0030-BINARY-DATE TO WA-STORE-TXN-DT.
146280     IF  UT0030-BINARY-DATE = ZEROES
146290         MOVE 126                TO WA-OUTPUT-ERR-MSG-NO
146300         MOVE 1                  TO WA-MSG-ERR-FLAG
146310         GO TO S699-EXIT.
146320     IF  UT0030-BINARY-DATE > STRT-AREA-POST-DT
146330         MOVE 190                TO WA-OUTPUT-ERR-MSG-NO
146340         MOVE 1                  TO WA-MSG-ERR-FLAG
146350         GO TO S699-EXIT.
146360     IF STRT-AREA-TRN-NO = 10210
146370        MOVE 1 TO BORM-SHRE-CAP-IND
146380        PERFORM Z4100-CREATE-BSHR THRU Z4199-EXIT
146390        IF WA-MSG-ERR-FLAG = 1
146400           GO TO S699-EXIT
146410        END-IF
146420     ELSE
146430     IF STRT-AREA-TRN-NO = 10310
146440        PERFORM Z4200-AMEND-BSHR THRU Z4299-EXIT
146450        IF WA-MSG-ERR-FLAG = 1
146460           GO TO S699-EXIT.
NR2001*146480     INITIALIZE BORV-01-DETAIL.
NR2001*146490     MOVE 01 TO BORV-01-CODE.
NR2001*146500     MOVE 0 TO BORV-01-STATUS.
NR2001*146510     MOVE WA-STORE-TXN-DT        TO BORV-01-TRN-DATE.
NR2001*146520     MOVE UPTELLCA-TELLER-BRANCH      TO BORV-01-TELL-AND-BR.
NR2001*146530     MOVE STRT-AREA-TERM-NO   TO BORV-01-BRTERM.
NR2001*146540     MOVE STRT-AREA-TRN-NO    TO BORV-01-TRN-CODE.
NR2001*146550     MOVE STRT-AREA-POST-DT   TO BORV-01-POST-DATE.
NR2001*146560     MOVE STRT-AREA-JRNL-NO   TO BORV-01-JRNL-NO.
NR2001*146570     MOVE BORM-LOAN-BAL TO BORV-01-BALANCE.
NR2001*146580     MOVE WA-DUMMY-AMT TO BORV-01-AMOUNT.
NR2001*146590     COMPUTE BORV-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001*146600     MOVE WA-ADJ-SUB-LEDG-CODE TO BORV-01-SUB-LEDG-CODE.
NR2001*146610     MOVE STRT-AREA-MSG-TIME   TO BORV-01-POST-TIME.
NR2001     INITIALIZE BOCT-TRAN-01.
NR2001     MOVE 01                   TO BOCT-TRAN-TYPE.
NR2001     MOVE 0                    TO BOCT-STAT.
NR2001     MOVE WA-STORE-TXN-DT      TO BOCT-TRN-DATE.
NR2001     MOVE STRT-AREA-TRN-NO     TO BOCT-TRN-CODE.
NR2001     MOVE BORM-LOAN-BAL        TO BOCT-01-BALANCE.
NR2001     MOVE WA-DUMMY-AMT         TO BOCT-01-AMOUNT.
NR2001     COMPUTE BOCT-01-ARREARS = BORM-LOAN-BAL - BORM-THEO-LOAN-BAL.
NR2001     MOVE WA-ADJ-SUB-LEDG-CODE TO BOCT-01-SUB-LEDG-CODE.
NR2001     MOVE STRT-AREA-MSG-TIME   TO BOCT-01-REPOST-TIME.
146620     PERFORM W500-ADD-TXN THRU W599-EXIT.
146630     IF  WA-MSG-ERR-FLAG = 1
146640         GO TO S699-EXIT.
146650*
146660*  SET UP TYPE 20 TXN.
146670*
146680     MOVE STRT-AREA-TRN-NO TO LINK-IN-TXCODE.
146690     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
146700     IF WA-MSG-ERR-FLAG = 1
146710         GO TO S699-EXIT.
146720     IF (LINK-NARR-TXN-TYPE = 20) OR
146730        (WA-IN-NARR-TEXT NOT = SPACES)
146740         PERFORM O200-ADD-TYPE-20 THRU O299-EXIT
146750         IF WA-MSG-ERR-FLAG = 1
146760             GO TO S699-EXIT.
146770*
146780     MOVE SPACES                 TO WA-OUTPUT-MESSAGE.
146790     MOVE STRT-AREA-JRNL-NO TO WA-OUTPUT-JRNL-NO.
146800     MOVE 4 TO WA-INPUT-MSG-CODE.
146810     MOVE 999 TO WA-OUTPUT-ERR-MSG-NO.
146820     MOVE 7  TO  WA-OUTPUT-MSG-LENGTH.                                  
146830     PERFORM E1000-PRE-FMT-SEND-PARA
146840             THRU E1999-EXIT.
146850 S699-EXIT.
146860     EXIT.
146870/
146880 S700-CARRY-FORWARD-PB.
146890     MOVE BORM-MEMB-CUST-AC   TO UT0500CA-CUSM-NO.
146900     MOVE 1                   TO UT0500CA-CALL-CODE.
146910     PERFORM V500-CALL-UT0500 THRU V599-EXIT.
146920     IF UT0500RA-CALL-STATUS NOT = 0
146930         GO TO S799-EXIT.
146940     MOVE BORM-KEY            TO WA-OUTPUT-ACCT-NO.
146950     MOVE BORM-ACT-TYPE       TO WA-OUTPUT-ACCT-TYPE.
146960     MOVE BORM-PAY-DAY        TO WA-OUTPUT-BRANCH.
146970     MOVE UT0500RA-POST-CODE  TO WA-OUTPUT-POST-CODE.
146980     MOVE UT0500RA-NAME-1     TO WA-OUTPUT-NAME-1.
146990     MOVE UT0500RA-NAME-2     TO WA-OUTPUT-NAME-2.
147000     MOVE UT0500RA-ADD-1      TO WA-OUTPUT-ADD-1.
147010     MOVE UT0500RA-ADD-2      TO WA-OUTPUT-ADD-2.
147020     MOVE UT0500RA-ADD-3      TO WA-OUTPUT-ADD-3.
147030     MOVE 006                 TO WA-OUTPUT-ERR-MSG-NO.
147040     MOVE 272                 TO WA-OUTPUT-MSG-LENGTH.
147050     PERFORM E100-FMT-SEND-PARA  THRU E199-EXIT.
147060     MOVE SPACES              TO WA-OUTPUT-MSG.
147070     IF WA-IN-PRINT-COVER-ONLY
147080        NEXT SENTENCE
147090     ELSE
147100        MOVE STRT-AREA-POST-DT   TO WA-OUTPUT-PB-TRN-DT
147110        PERFORM U100-PK-BRANCH-TERM-TELL THRU U199-EXIT
147120        MOVE WA-INPUT-KEY        TO WA-OUTPUT-PB-ACCT-NO
147130        MOVE UPTELLCA-TELLER-BRANCH TO WA-OUTPUT-PB-TELR-BRCH
147140        MOVE STRT-AREA-TRN-NO    TO WA-OUTPUT-TRN-CODE
147150        MOVE STRT-AREA-JRNL-NO   TO WA-OUTPUT-JRNL-NO-2
147160        MOVE 0                   TO WA-OUTPUT-AMOUNT
147170*       MOVE 0                   TO WA-OUTPUT-BALANCE
147180        COMPUTE WA-OUTPUT-BALANCE ROUNDED =
147190                      BORM-LOAN-BAL - BORM-NPB-VAL
147200        MOVE 129                 TO WA-OUTPUT-MSG-LENGTH
147210        MOVE 001                 TO WA-OUTPUT-ERR-MSG-NO
147220        PERFORM E100-FMT-SEND-PARA  THRU E199-EXIT
147230        MOVE SPACES              TO WA-OUTPUT-MESSAGE.
147240     MOVE 0                   TO WA-OUTPUT-ERR-MSG-NO.
147250     PERFORM E1000-PRE-FMT-SEND-PARA THRU E1999-EXIT.
147260 S799-EXIT.
147270     EXIT.
147290 S800-INTEREST-ADJUSTMENT.
ST0102     IF BORP-YOUBE                              
SC9302*    AND BOIS-NEXT-DUE-DATE NOT > STRT-AREA-POST-DT
ST0102        MOVE 1    TO WA-MSG-ERR-FLAG           
ST0102        MOVE 4797 TO WA-OUTPUT-ERR-MSG-NO       
ST0102        GO TO S809-EXIT                         
ST0102     END-IF.                                    
S17306     MOVE WA-REASON-CODE       TO WA-10732-RSN-CD.
SC7171     IF NOT STRT-TRICKLE-TXN
S10457        IF WA-10732-INT-ADJ = ZEROES
S10457           MOVE 1    TO WA-MSG-ERR-FLAG
S10457           MOVE 2830 TO WA-OUTPUT-ERR-MSG-NO
S10457           GO TO S809-EXIT
S10457        END-IF
SC6939        INITIALIZE RSNC-DATA-KEY
SC6939        MOVE STRT-AREA-SOC-NO  TO RSNC-INST-NO
SC6939        MOVE WA-REASON-CODE    TO RSNC-REASON-CODE
SC6939        PERFORM GET-REASON-CODE THRU GET-REASON-CODE-EXIT
SC6939        IF WA-MSG-ERR-FLAG NOT = 0
SC6939           GO TO S809-EXIT
SC6939        END-IF
SC6939        IF NOT BORP-COMML
SC6939           PERFORM S820-VAL-AUTHOR-ID THRU S829-EXIT
SC6939           IF WA-MSG-ERR-FLAG NOT = 0
SC6939             GO TO S809-EXIT
SC6939           END-IF
SC6939        END-IF
SC7171     END-IF
SC8740     IF  STRT-TRICKLE-TXN
SC8740     AND BOIS-OFFSET-ACCT-IND =  1
SC8740     AND BORM-INT-ADJUSTMENT  >  0
SC8740         ADD  BORM-INT-ADJUSTMENT TO BORM-INT-ACCR
SC8740         MOVE 0                   TO BORM-INT-ADJUSTMENT
SC8740     END-IF.
SC2790     MOVE BORM-INT-ACCR      TO WA-SAVE-INT-ACCR.
SC2790     ADD BORM-INT-ADJUSTMENT TO BORM-INT-ACCR.
SC2790     COMPUTE WA-REPAY-AMT-TMP1-CORR ROUNDED = BORM-INT-ACCR
SC2790     MOVE WA-REPAY-AMT-TMP1-CORR TO BORM-INT-ACCR.
SC6871     MOVE WA-10732-INT-ADJ TO WA-VA-AMT.
SC6871     PERFORM Q000-AMOUNT-VALIDATION THRU Q009-EXIT.
SC6871     IF WA-MSG-ERR-FLAG NOT = 0
SC6871        GO TO S809-EXIT
SC6871     END-IF.
147300     COMPUTE WA-INT-AVAILABLE = BORM-INT-ACCR +
SC3992**                              BLDV-FC-LI-ADJ-ACCR +
SC3992**                              BORM-BPI-ACCR +
SC3992**                              BLDV-FC-BPI-ADJ-ACCR +
147340**SC2790                        BORM-INT-ADJUSTMENT +
147350                                WA-10732-INT-ADJ.
147360     IF  WA-INT-AVAILABLE < 0
SC6499     AND NOT STRT-TRICKLE-TXN
S17306     AND NOT WA-BONUS-EXCHANGE
147370         MOVE 1 TO  WA-MSG-ERR-FLAG
147380         MOVE 308 TO WA-OUTPUT-ERR-MSG-NO
147390         GO TO S809-EXIT
147400     END-IF.
S17306     IF  STRT-TRICKLE-TXN
S17306     AND WA-BONUS-EXCHANGE
S17306       IF BOIS-ARREARS-CTR       >  0
S17306         MOVE 1 TO  WA-MSG-ERR-FLAG
S17306         MOVE 312 TO WA-OUTPUT-ERR-MSG-NO
S17306         GO TO S809-EXIT
S17306       END-IF
S17306       IF BOIS-LAST-TERM-PAID    <> BOIS-LAST-TERM-UNPAID
S17306          MOVE BOIS-LAST-TERM-PAID  TO BOIS-LAST-TERM-UNPAID
S17306          MOVE WA-10732-INT-ADJ  TO BORM-MAN-APP-CREDIT
S17306       ELSE
S17306          ADD  WA-10732-INT-ADJ  TO BORM-MAN-APP-CREDIT
S17306       END-IF
S17306     END-IF.
147410     ADD WA-10732-INT-ADJ        TO BORM-INT-ADJUSTMENT.
SC2790     MOVE WA-SAVE-INT-ACCR       TO BORM-INT-ACCR.
S15544     MOVE STRT-AREA-POST-DT      TO BORM-LST-MNT-DATE.
NR2001*147420     INITIALIZE BORV-33-DETAIL.
NR2001*147430     MOVE "INTADJ"               TO WA-33-MSG-TEXT.
NR2001*147440     MOVE WA-10732-INT-ADJ       TO WA-33-MSG-AMT.
NR2001*147450     MOVE WA-33-MSG-AREA         TO BORV-33-FREE-MSG.
NR2001*147460     MOVE 33                     TO BORV-33-CODE.
NR2001*147470     MOVE ZERO                   TO BORV-33-STATUS.
NR2001*147480     MOVE STRT-AREA-POST-DT      TO BORV-33-POST-DATE
NR2001*147490                                    BORV-33-AMEND-DATE.
NR2001*147500     PERFORM U100-PK-BRANCH-TERM-TELL THRU U199-EXIT.
NR2001*147510     MOVE UPTELLCA-TELLER-BRANCH TO BORV-33-TELL-AND-BR.
NR2001*147520     MOVE STRT-AREA-TERM-NO      TO BORV-33-BRTERM.
NR2001*147530     MOVE STRT-AREA-TRN-NO       TO BORV-33-TRN-CODE.
NR2001*147540     MOVE STRT-AREA-JRNL-NO      TO BORV-33-JRNL-NO.
NR2001     INITIALIZE BOCT-TRAN-33.
NR2001     MOVE 33                     TO BOCT-TRAN-TYPE.
NR2001     MOVE ZERO                   TO BOCT-STAT.
NR2001     MOVE STRT-AREA-POST-DT      TO BOCT-TRN-DATE.
NR2001     MOVE STRT-AREA-TRN-NO       TO BOCT-TRN-CODE.
NR2001     MOVE "INTADJ"               TO WA-33-MSG-TEXT.
NR2001     MOVE WA-10732-INT-ADJ       TO WA-33-MSG-AMT.
NR2001     MOVE WA-33-MSG-AREA         TO BOCT-33-FREE-MSG.
S15788     MOVE 'Y'                    TO BOCT-33-PCC-FLAG.
S15788     MOVE WA-10732-PCC-CODE      TO BOCT-33-PCC-CODE.
NR2001     MOVE STRT-AREA-POST-DT      TO BOCT-33-AMEND-DATE.
147550     PERFORM W500-ADD-TXN THRU W599-EXIT.
S17306     IF  STRT-TRICKLE-TXN
S17306     AND WA-BONUS-EXCHANGE
S17306       MOVE  20                  TO UT9000-REPORT-NO
S17306       PERFORM X930-ADD-EXTRA-LOG   THRU X930-EXIT
S17306     END-IF.
147560     MOVE SPACES                 TO WA-OUTPUT-MESSAGE.
147570     MOVE 0                      TO WA-OUTPUT-ERR-MSG-NO.
147580     PERFORM E100-FMT-SEND-PARA  THRU E199-EXIT.
147590 S809-EXIT.
147600     EXIT.
147610/                                                                        
SC6939 S820-VAL-AUTHOR-ID.
            INITIALIZE UT5003CA-CALL-AREA.
            MOVE WA-AUTH-ID-NO       TO UT5003CA-ID-NO.
            MOVE WA-AUHT-ID-TYPE     TO UT5003CA-ID-TYPE
            MOVE UT5003CA-ID-NO           TO WS-UT5003CA-ID-NO.
            MOVE 02                       TO UT5003CA-CALL-CODE.
            MOVE SPACE                    TO UT5003CA-CIF-NO-G.
            MOVE STRT-AREA-SOC-NO   TO UT5003CA-SOC-NO.
            MOVE SOC-CUST-NO-FORMAT TO UT5003CA-CUST-NO-FORMAT.
            MOVE SOC-CHK-DGT        TO UT5003CA-CHK-DGT.
            CALL "UT5003" USING UT5003CA-CALL-AREA.
SC8333      IF UT5003CA-ID-TYPE = '11'
SC8333         AND WS-UT5003CA-ID-NO(1:10) = UT5003CA-ID-NO(1:10)
SC8333         CONTINUE
SC8833      ELSE
            IF WS-UT5003CA-ID-NO NOT = UT5003CA-ID-NO
               MOVE 1 TO UT5003CA-CALL-STATUS
            END-IF.
            IF UT5003CA-CALL-STATUS NOT EQUAL ZERO
               MOVE UT8500CA-FUNC-NORMAL-DISPLAY
                                    TO  UT8500CA-CALL-CODE
               MOVE SPACES           TO  UT8500CA-INPUT-MSG
               STRING "BR0000:(S820-VAL-AUTHOR-ID) UT5003 CALL ERROR"
                      "; ID-"   UT5003CA-ID-NO-G
                      "; CIF-"  UT5003CA-CIF-NO-G
                      DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
               CALL "UT8500" USING UT8500CA-AREA
               MOVE 1039             TO WA-OUTPUT-ERR-MSG-NO
               MOVE 1                TO WA-MSG-ERR-FLAG
            END-IF.
SC6939 S829-EXIT.
            EXIT.
147620***                                                                       
147630*** ADJUST TOM ACCRUAL (TXN 10733)                                        
147640***                                                                       
147650 S900-TOM-ACRU-ADJUSTMENT.                                                
147660     COMPUTE WA-TOM-AVAILABLE = BORM-TOM-ACRU-AMT                         
147670                              + WA-10733-TOM-ADJ.                         
147680     IF  WA-TOM-AVAILABLE < 0                                             
147690         MOVE 1 TO  WA-MSG-ERR-FLAG                                       
147700         MOVE 308 TO WA-OUTPUT-ERR-MSG-NO                                 
147710         GO TO S909-EXIT                                                  
147720     END-IF.                                                              
147730     ADD WA-10733-TOM-ADJ        TO BORM-TOM-ACRU-AMT.                    
NR2001*147740     INITIALIZE BORV-33-DETAIL.                                           
NR2001*147750     MOVE "TOMADJ"               TO WA-33-MSG-TEXT                        
NR2001*147760     MOVE WA-10733-TOM-ADJ       TO WA-33-MSG-AMT.                        
NR2001*147770     MOVE WA-33-MSG-AREA         TO BORV-33-FREE-MSG.                     
NR2001*147780     MOVE 33                     TO BORV-33-CODE.                         
NR2001*147790     MOVE ZERO                   TO BORV-33-STATUS.                       
NR2001*147800     MOVE STRT-AREA-POST-DT      TO BORV-33-POST-DATE                     
NR2001*147810                                    BORV-33-AMEND-DATE.                   
NR2001*147820     PERFORM U100-PK-BRANCH-TERM-TELL THRU U199-EXIT.                     
NR2001*147830     MOVE UPTELLCA-TELLER-BRANCH TO BORV-33-TELL-AND-BR.                  
NR2001*147840     MOVE STRT-AREA-TERM-NO      TO BORV-33-BRTERM.                       
NR2001*147850     MOVE STRT-AREA-TRN-NO       TO BORV-33-TRN-CODE.                     
NR2001*147860     MOVE STRT-AREA-JRNL-NO      TO BORV-33-JRNL-NO.                      
NR2001     INITIALIZE BOCT-TRAN-33.
NR2001     MOVE 33                     TO BOCT-TRAN-TYPE.
NR2001     MOVE ZERO                   TO BOCT-STAT.
NR2001     MOVE STRT-AREA-POST-DT      TO BOCT-TRN-DATE.
NR2001     MOVE STRT-AREA-TRN-NO       TO BOCT-TRN-CODE.
NR2001     MOVE "TOMADJ"               TO WA-33-MSG-TEXT.
NR2001     MOVE WA-10733-TOM-ADJ       TO WA-33-MSG-AMT.
NR2001     MOVE WA-33-MSG-AREA         TO BOCT-33-FREE-MSG.
NR2001     MOVE STRT-AREA-POST-DT      TO BOCT-33-AMEND-DATE.
147870     PERFORM W500-ADD-TXN THRU W599-EXIT.                                 
147880     MOVE SPACES                 TO WA-OUTPUT-MESSAGE.                    
147890     MOVE 0                      TO WA-OUTPUT-ERR-MSG-NO.                 
147900     PERFORM E100-FMT-SEND-PARA  THRU E199-EXIT.                          
147910 S909-EXIT.                                                               
147920     EXIT.                                                                
147930/
147940***************************************************************
147950***************************************************************
147960***     IT PERFORMS THE FOLLOWING FUNCTIONS -
147970***     1. CREATES A INTEREST-RATE AND THE CORRESPONDING
147980***        TOTAL LOAN FUNDS ALLOCATED RECORD IN A INDEXED
147990***        FILE WITH INT-RATE AS ACCESS KEY.
148000***     2. COMMITTMENT TRX IS USED TO TAKE MONEY OUT OF
148010***        A PARTICULAR INT-RATE
148020***     3. GENERATES ERROR MSG IF A INT-RATE IS NOT FOUND
148030***        OR ENOUGH FUNDS ARE NOT AVAILABLE IN THAT CATEGORY.
148040***     4. DOES POSITIVE AND NEGATIVE ADJUSTMENTS TO TOTAL
148050***        FUNDS AND FUNDS USED.
148060***     5. PROVIDES ON-LINE ENQUIRY SHOWING DATE AND TIME
148070***        ALL THE INT-RATES , THEIR CORRESPONDING LOAN
148080***        FUNDS USED AND AVERAGE YIELD OF THE WHOLE FILE.
148090***     6. IT DELETES A PARTICULAR INT-RATE ALSO.
148100***********************************************************
148110***********************************************************
148120 T000-PROCESS-LOAN.
148130*****NCR-LOCK WA-LNF-FLAG FOR UPDATE.
148140     IF  STRT-AREA-TRN-NO = 19540
148150         MOVE STRT-AREA-SOC-NO TO BLNF-SOC-NO
148160         MOVE WA-DEL-INT-RATE TO BLNF-INT-RATE
148170         PERFORM T600-DELETE-REC THRU T699-EXIT
148180         IF  WA-MSG-ERR-FLAG = 1
148190             GO TO T099-EXIT
148200         ELSE
148210             MOVE SPACES TO WA-OUTPUT-MESSAGE
148220             MOVE 0 TO WA-OUTPUT-ERR-MSG-NO
148230             PERFORM E1000-PRE-FMT-SEND-PARA
148240                 THRU E1999-EXIT
148250             GO TO T099-EXIT.
148260     IF  STRT-AREA-TRN-NO = 10476
148270         PERFORM T100-SEND-ENQUIRY THRU T199-EXIT
148280         GO TO T099-EXIT.
148290     IF  STRT-AREA-SIGN = "-"
148300         MULTIPLY WA-LOAN-AMOUNT BY -1 GIVING WA-DUMMY-AMT
148310     ELSE MOVE WA-LOAN-AMOUNT TO WA-DUMMY-AMT.
148320*****MOVE STRT-AREA-SOC-NO TO BLNF-SOC-NO
148330*****MOVE WA-INT-RATE TO BLNF-INT-RATE.
148340*****READ LNFUND INVALID KEY PERFORM T500-ADD-RECORD THRU
148350*****                                    T599-EXIT
148360*****        GO TO T050.
148370     MOVE 71 TO DBIO-CALL-FUNC.
148380     MOVE STRT-AREA-SOC-NO TO DB-LNF-SOC-NO.
148390     MOVE WA-INT-RATE     TO DB-LNF-INT-RATE.
148400     MOVE DB-LNF-KEY      TO DBIO-CALL-KEY-AREA.
148410     MOVE ZERO            TO DBIO-CALL-REFER-AREA.
148420     PERFORM X500-ACCESS-BLNF THRU X599-EXIT.
148430     IF DBIO-CALL-STATUS = "MRNF"
148440         PERFORM T500-ADD-RECORD THRU T599-EXIT
148450         GO TO T099-EXIT
148460     ELSE
148470     IF DBIO-CALL-STATUS NOT = "****"
148480         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
148490         MOVE 1 TO WA-MSG-ERR-FLAG
148500         MOVE "BLNF" TO WA-DBERR-DATA-SET
148510         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
148520         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
148530         MOVE SPACES TO UT8500CA-INPUT-MSG
148540         STRING "BR0000:(T000) BAD BLNF IO "
148550                 DBIO-CALL-STATUS
148560             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
148570         CALL "UT8500" USING
148590                             UT8500CA-AREA
148600         GO TO T099-EXIT.
148610*
148620     IF  STRT-AREA-TRN-NO = 19500 OR 19510
148630         ADD WA-DUMMY-AMT TO BLNF-TOTAL-AMT
148640     ELSE
148650         IF  STRT-AREA-TRN-NO = 19520 OR 19530
148660             ADD WA-DUMMY-AMT TO BLNF-AMT-USED
148670             SUBTRACT WA-DUMMY-AMT FROM BLNF-TOTAL-AMT
148680          ELSE IF  STRT-AREA-TRN-NO = 10300
148690              IF  WA-DUMMY-AMT > BLNF-TOTAL-AMT
148700                  MOVE 266 TO WA-OUTPUT-ERR-MSG-NO
148710                  MOVE 1 TO WA-MSG-ERR-FLAG
148720                  GO TO T099-EXIT
148730              ELSE
148740                  ADD WA-DUMMY-AMT TO BLNF-AMT-USED
148750                  SUBTRACT WA-DUMMY-AMT FROM BLNF-TOTAL-AMT.
148760*    IF  STRT-AREA-SOC-NO NOT = 002
148770******   REWRITE LNFUND-REC INVALID KEY
148780******                  MOVE 267 TO WA-OUTPUT-ERR-MSG-NO
148790******                  MOVE 1 TO WA-MSG-ERR-FLAG
148800******                  GO TO T050.
148810         MOVE 74 TO DBIO-CALL-FUNC
148820         MOVE BLNF-SOC-NO TO DB-LNF-SOC-NO
148830         MOVE BLNF-INT-RATE TO DB-LNF-INT-RATE
148840         MOVE DB-LNF-KEY TO DBIO-CALL-KEY-AREA
148850         PERFORM X500-ACCESS-BLNF THRU X599-EXIT
148860         IF DBIO-CALL-STATUS NOT = "****"
148870           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
148880             MOVE SPACES TO UT8500CA-INPUT-MSG
148890             STRING "BR0000:(T000) BAD BLNF REWRITE "
148900                     DBIO-CALL-STATUS
148910                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
148920             CALL "UT8500" USING
148940                                 UT8500CA-AREA
148950             MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
148960             MOVE 1 TO WA-MSG-ERR-FLAG
148970             MOVE "BLNF" TO WA-DBERR-DATA-SET
148980             MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
148990             GO TO T099-EXIT.
149000*
149010     MOVE SPACES TO WA-OUTPUT-MESSAGE.
149020     MOVE 0 TO WA-OUTPUT-ERR-MSG-NO.
149030     PERFORM E1000-PRE-FMT-SEND-PARA
149040                 THRU E1999-EXIT.
149050*T050.
149060*****MOVE HIGH-VALUES TO LN-SOC-INTEREST.
149070*****START LNFUND KEY > LN-SOC-INTEREST
149080*****  INVALID KEY
149090*****GO TO T099-EXIT.
149100*****DISPLAY "BR0000:(T050) LNFUND NOT LOCKED".
149110 T099-EXIT.
149120     EXIT.
149130 T100-SEND-ENQUIRY.
149140     MOVE 32150 TO STRT-AREA-TRN-NO.
149150     ADD 4 TO STRT-AREA-IEXEC-CNTL.
149160     MOVE UT1999CA-DD TO WA-TODAY-DD-R.
149170     MOVE UT1999CA-MM TO WA-TODAY-MM-R.
149180     MOVE UT1999CA-CC TO WA-TODAY-CC-R.
149190     MOVE UT1999CA-YY TO WA-TODAY-YY-R.
149200     MOVE STRT-AREA-MSG-TIME TO WA-TIME.
149210     MOVE WA-HH TO WA-DISPLAY-HH.
149220     MOVE WA-MM TO WA-DISPLAY-MM.
149230     MOVE WA-DISPLAY-TIME TO WA-LNF-TIME.
149240     MOVE WA-TODAYS-DATE-R TO WA-LNF-DATE.
149250     MOVE WA-LNFUND-DATA1 TO WA-OUTPUT-MSG.
149260     MOVE 998 TO WA-OUTPUT-ERR-MSG-NO.
149270     MOVE 15 TO WA-OUTPUT-MSG-LENGTH.
149280     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
149290     MOVE 0 TO STRT-AREA-IEXEC-CNTL.
149300     MOVE "BEGN" TO DBIO-CALL-SAVE-REFER.
149310     MOVE 0 TO WA-ACT-CUM-YIELD WA-CUM-YIELD
149320                WA-CUM-TOT-AMT WA-CUM-TOT-USED.
149330     MOVE 0 TO WA-TXN-COUNT WA-LNFUND-EOF.
149340     IF WA-START-TRAN > 0
149350        SUBTRACT 1 FROM WA-START-TRAN.
149360     PERFORM T700-CUMULATE-YIELD THRU T799-EXIT
149370             UNTIL WA-TXN-COUNT = WA-START-TRAN
149380                OR WA-LNFUND-EOF = 1.
149390     IF WA-LNFUND-EOF = 1
149400        MOVE 314 TO WA-OUTPUT-ERR-MSG-NO
149410        MOVE 1 TO WA-MSG-ERR-FLAG
149420        GO TO T199-EXIT.
149430     MOVE 0 TO WA-TXN-COUNT WA-LNFUND-EOF.
149440     PERFORM T200-SEND-INFO THRU T299-EXIT
149450             UNTIL WA-TXN-COUNT = 17 OR WA-LNFUND-EOF = 1.
149460     IF WA-TXN-COUNT = 17
149470        PERFORM T700-CUMULATE-YIELD THRU T799-EXIT
149480                UNTIL WA-LNFUND-EOF = 1.
149490     MOVE SPACES TO WA-LNFUND-DATA.
149500     IF  WA-CUM-TOT-AMT = 0
149510         MOVE 0 TO WA-LNF-YIELD
149520         GO TO T170.
149530     COMPUTE WA-LNF-YIELD = (WA-ACT-CUM-YIELD * 100) /
149540                                 WA-CUM-TOT-AMT.
149550 T170.
149560     MOVE WA-LNFUND-DATA TO WA-OUTPUT-MSG.
149570     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
149580     MOVE SPACES TO WA-LNFUND-DATA.
149590     IF  WA-CUM-TOT-USED = 0
149600         MOVE 0 TO WA-LNF-YIELD
149610         GO TO T175.
149620     COMPUTE WA-LNF-YIELD = (WA-CUM-YIELD * 100) /
149630                            WA-CUM-TOT-USED.
149640 T175.
149650     MOVE WA-LNFUND-DATA TO WA-OUTPUT-MSG.
149660     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
149670     IF  WA-MSG-ERR-FLAG = 1
149680         GO TO T199-EXIT.
149690     MOVE SPACES TO WA-OUTPUT-MESSAGE.
149700     MOVE 0 TO WA-OUTPUT-ERR-MSG-NO.
149710     PERFORM E1000-PRE-FMT-SEND-PARA
149720                 THRU E1999-EXIT.
149730 T199-EXIT.
149740     EXIT.
149750 T200-SEND-INFO.
149760     MOVE SPACES TO WA-LNFUND-DATA.
149770     MOVE 75 TO DBIO-CALL-FUNC.
149780     PERFORM X500-ACCESS-BLNF THRU X599-EXIT.
149790     IF DBIO-CALL-SAVE-REFER = "END."
149800         MOVE 1 TO WA-LNFUND-EOF
149810         GO TO T299-EXIT
149820     ELSE
149830     IF DBIO-CALL-STATUS NOT = "****"
149840         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
149850         MOVE 1 TO WA-MSG-ERR-FLAG
149860         MOVE "BLNF" TO WA-DBERR-DATA-SET
149870         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
149880         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
149890         MOVE SPACES TO UT8500CA-INPUT-MSG
149900         STRING "BR0000:(T200) BAD BLNF DELETE "
149910                 DBIO-CALL-STATUS
149920             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
149930         CALL "UT8500" USING
149950                             UT8500CA-AREA
149960         GO TO T299-EXIT.
149970*
149980     MOVE BLNF-INT-RATE TO WA-LNF-INT-RATE.
149990     MOVE BLNF-TOTAL-AMT TO WA-WORK-AMOUNT.
150000     PERFORM C100-MOVE-DATA THRU C109-EXIT.
150010     MOVE WA-EDIT-BAL-AMT TO WA-LNF-TOT-AMT.
150020     MOVE BLNF-AMT-USED TO WA-WORK-AMOUNT.
150030     PERFORM C100-MOVE-DATA THRU C109-EXIT.
150040     MOVE WA-EDIT-BAL-AMT TO WA-LNF-AMT-USED.
150050     COMPUTE WA-ACTUAL-YIELD = (BLNF-TOTAL-AMT  *
150060                                BLNF-INT-RATE) / 100.
150070     ADD WA-ACTUAL-YIELD TO WA-ACT-CUM-YIELD.
150080     ADD BLNF-TOTAL-AMT TO WA-CUM-TOT-AMT.
150090     COMPUTE WA-YIELD = (BLNF-INT-RATE * BLNF-AMT-USED) / 100.
150100     ADD WA-YIELD TO WA-CUM-YIELD.
150110     ADD BLNF-AMT-USED TO WA-CUM-TOT-USED.
150120     MOVE WA-LNFUND-DATA TO WA-OUTPUT-MSG.
150130     MOVE 998 TO WA-OUTPUT-ERR-MSG-NO.
150140     MOVE 127 TO WA-OUTPUT-MSG-LENGTH.
150150     PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
150160     ADD 1 TO WA-TXN-COUNT.
150170 T299-EXIT.
150180     EXIT.
150190 T500-ADD-RECORD.
150200     IF  STRT-AREA-TRN-NO = 19510 OR 19520 OR 19530
150210                           OR 10300
150220         MOVE 267 TO WA-OUTPUT-ERR-MSG-NO
150230         MOVE 1 TO WA-MSG-ERR-FLAG
150240         GO TO T599-EXIT.
150250     MOVE STRT-AREA-SOC-NO TO BLNF-SOC-NO.
150260     MOVE WA-INT-RATE TO BLNF-INT-RATE.
150270     MOVE WA-DUMMY-AMT TO BLNF-TOTAL-AMT.
150280     MOVE ZEROS TO BLNF-AMT-USED BLNF-YIELD.
150290*****WRITE LNFUND-REC INVALID KEY
150300*****                 MOVE 267 TO WA-OUTPUT-ERR-MSG-NO
150310*****                 MOVE 1 TO WA-MSG-ERR-FLAG
150320*****                 GO TO T599-EXIT.
150330     MOVE 72 TO DBIO-CALL-FUNC.
150340     MOVE BLNF-SOC-NO TO DB-LNF-SOC-NO.
150350     MOVE BLNF-INT-RATE TO DB-LNF-INT-RATE.
150360     MOVE DB-LNF-KEY TO DBIO-CALL-KEY-AREA.
150370     PERFORM X500-ACCESS-BLNF THRU X599-EXIT.
150380     IF DBIO-CALL-STATUS NOT = "****"
150390           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
150400             MOVE SPACES TO UT8500CA-INPUT-MSG
150410             STRING "BR0000:(T500) BAD BLNF WRITE "
150420                     DBIO-CALL-STATUS
150430                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
150440             CALL "UT8500" USING
150460                                 UT8500CA-AREA
150470             MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
150480             MOVE 1 TO WA-MSG-ERR-FLAG
150490             MOVE "BLNF" TO WA-DBERR-DATA-SET
150500             MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
150510             GO TO T599-EXIT.
150520     MOVE SPACES TO WA-OUTPUT-MESSAGE.
150530     MOVE 0 TO WA-OUTPUT-ERR-MSG-NO.
150540     PERFORM E1000-PRE-FMT-SEND-PARA
150550                 THRU E1999-EXIT.
150560 T599-EXIT.
150570     EXIT.
150580 T600-DELETE-REC.
150590*********DELETE LNFUND INVALID KEY
150600*********              MOVE 267 TO WA-OUTPUT-ERR-MSG-NO
150610*********              MOVE 1 TO WA-MSG-ERR-FLAG.
150620     MOVE 73 TO DBIO-CALL-FUNC.
150630     MOVE BLNF-SOC-NO     TO DB-LNF-SOC-NO.
150640     MOVE BLNF-INT-RATE   TO DB-LNF-INT-RATE.
150650     MOVE DB-LNF-KEY      TO DBIO-CALL-KEY-AREA.
150660     PERFORM X500-ACCESS-BLNF THRU X599-EXIT.
150670     IF DBIO-CALL-STATUS NOT = "****"
150680         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
150690         MOVE SPACES TO UT8500CA-INPUT-MSG
150700         STRING "BR0000:(T600) BAD BLNF DELETE "
150710                 DBIO-CALL-STATUS
150720             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
150730         CALL "UT8500" USING
150750                             UT8500CA-AREA
150760         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
150770         MOVE 1 TO WA-MSG-ERR-FLAG
150780         MOVE "BLNF" TO WA-DBERR-DATA-SET
150790         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR.
150800*
150810 T699-EXIT.
150820     EXIT.
150830 T700-CUMULATE-YIELD.
150840*****READ LNFUND NEXT RECORD
150850*****     AT END MOVE 1 TO WA-LNFUND-EOF
150860*****            GO TO T799-EXIT.
150870     MOVE 75 TO DBIO-CALL-FUNC.
150880     PERFORM X500-ACCESS-BLNF THRU X599-EXIT.
150890     IF DBIO-CALL-SAVE-REFER = "END."
150900         MOVE 1 TO WA-LNFUND-EOF
150910         GO TO T799-EXIT
150920     ELSE
150930     IF DBIO-CALL-STATUS NOT = "****"
150940         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
150950         MOVE SPACES TO UT8500CA-INPUT-MSG
150960         STRING "BR0000:(T700) BAD BLNF READ "
150970                 DBIO-CALL-STATUS
150980             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
150990         CALL "UT8500" USING
151010                             UT8500CA-AREA
151020         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
151030         MOVE 1 TO WA-MSG-ERR-FLAG
151040         MOVE "BLNF" TO WA-DBERR-DATA-SET
151050         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
151060         GO TO T799-EXIT.
151070*
151080     COMPUTE WA-ACTUAL-YIELD =
151090             (BLNF-TOTAL-AMT * BLNF-INT-RATE) / 100.
151100     ADD WA-ACTUAL-YIELD TO WA-ACT-CUM-YIELD.
151110     ADD BLNF-TOTAL-AMT TO WA-CUM-TOT-AMT.
151120     COMPUTE WA-YIELD =
151130             (BLNF-INT-RATE * BLNF-AMT-USED) / 100.
151140     ADD WA-YIELD TO WA-CUM-YIELD.
151150     ADD BLNF-AMT-USED TO WA-CUM-TOT-USED.
151160     ADD 1 TO WA-TXN-COUNT.
151170 T799-EXIT.
151180     EXIT.
151190/
151200 U000-CHECK-ZERO.
151210     IF  UT0290CA-CURR-DECS = 0
151220         COMPUTE WA-WORK-INT-0 ROUNDED = WA-WORK-INT * 1
151230         MOVE WA-WORK-INT-0 TO WA-WORK-INT
151240     ELSE
151250     IF  UT0290CA-CURR-DECS = 1
151260         COMPUTE WA-WORK-INT-1 ROUNDED = WA-WORK-INT * 1
151270         MOVE WA-WORK-INT-1 TO WA-WORK-INT
151280     ELSE
151290     IF  UT0290CA-CURR-DECS = 2
151300         COMPUTE WA-WORK-INT-2 ROUNDED = WA-WORK-INT * 1
151310         MOVE WA-WORK-INT-2 TO WA-WORK-INT.
151320 U009-EXIT.
151330     EXIT.
151340/
151350***  THIS ROUTINE PKS THE BRANCH, TERMINAL AND TELLER  ***
151360**
151370*
151380 U100-PK-BRANCH-TERM-TELL.
151390     MOVE STRT-AREA-BRANCH TO UPTELLCA-BRCH.
151400*    MOVE STRT-AREA-TERM-NO TO WA-UT0110-TERMINAL.
151410     MOVE STRT-AREA-TELL-NO TO UPTELLCA-TELR.
151420     CALL "UT0031" USING UPTELLCA-PARAM-1
151430                         UPTELLCA-PARAM-2.
151440 U199-EXIT.
151450     EXIT.
151460/
151480 U9000-RETRIEVE-TXTM-RECORDS.
151490     MOVE 1 TO UT9000-CALL-CODE.
151500     PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT.
151510     IF UT9000-CALL-STATUS = "0"
151520         IF UT9000-SEQUENCE-NO > 20
151530             MOVE "E" TO UT9000-CALL-STATUS
151540             MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
151550                  UT8500CA-CALL-CODE
151560             MOVE SPACES TO UT8500CA-INPUT-MSG
151570             STRING "BR0000:(U9000) - BYPASSING TXTM SEQ NO > 20"
151580                    "/CHECK TXTM RECORDS FOR THIS PROGRAM "
151590                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
151600             CALL "UT8500" USING
151620                                 UT8500CA-AREA
151630         ELSE
151640             PERFORM U9050-CHECK-TXT-INDEX THRU U9059-EXIT
151650             IF TXT-1 > 2
151660             OR TXT-2 > 2
151670                 MOVE "E" TO UT9000-CALL-STATUS
151680             ELSE
151690                 SET TXT-3 TO UT9000-SEQUENCE-NO
151700                 MOVE UT9000RA-LINE1 TO TXTM-LINE
151710                                       (TXT-1, TXT-2, TXT-3)
151720     ELSE
151730         IF UT9000-CALL-STATUS NOT = "E"
151740             MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
151750                  UT8500CA-CALL-CODE
151760             MOVE SPACES TO UT8500CA-INPUT-MSG
151770             STRING "BR0000:(U9000) - INVALID CALL TO UT9000, "
151780                    "KEY:"      UT9000-RECORD-KEY
151790                    ", STATUS:" UT9000-CALL-STATUS
151800                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
151810             CALL "UT8500" USING
151830                                 UT8500CA-AREA
151840             MOVE "E" TO UT9000-CALL-STATUS.
151850 U9009-EXIT.
151860     EXIT.
151870*
151880*
151890 U9050-CHECK-TXT-INDEX.
151900     IF TXT-1 = 0
151910         SET TXT-1 TO 1
151920         SET TXT-2 TO 1
151930         MOVE UT9000-INST-NO       TO TXTM-INST (TXT-1)
151940         MOVE UT9000-LANGUAGE-CODE TO TXTM-LANG (TXT-1, TXT-2).
151950     IF UT9000-INST-NO = TXTM-INST (TXT-1)
151960         IF UT9000-LANGUAGE-CODE = TXTM-LANG (TXT-1, TXT-2)
151970             NEXT SENTENCE
151980         ELSE
151990             SET TXT-2 UP BY 1
152000             IF TXT-2 > 2
152010                 MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
152020                      UT8500CA-CALL-CODE
152030                 MOVE SPACES TO UT8500CA-INPUT-MSG
152040                 STRING "BR0000:(U9050) - MAXIMUM LANGUAGE IS 2"
152050                        ", INST-NO:" UT9000-INST-NO
152060                        ", LANG:"    UT9000-LANGUAGE-CODE
152070                        ", BYPASS LOADING FOR THIS LANG CODE"
152080                      DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
152090                 CALL "UT8500" USING
152110                                     UT8500CA-AREA
152120             ELSE
152130                 MOVE UT9000-LANGUAGE-CODE TO TXTM-LANG
152140                                             (TXT-1, TXT-2)
152150     ELSE
152160         SET TXT-1 UP BY 1
152170         IF TXT-1 > 2
152180             MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
152190                  UT8500CA-CALL-CODE
152200             MOVE SPACES TO UT8500CA-INPUT-MSG
152210             STRING "BR0000:(U9050) - MAXIMUM INSTITUTION IS 2"
152220                    ", INST-NO:" UT9000-INST-NO
152230                    ", BYPASS LOADING OF REMAINING TXTM"
152240                 DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
152250             CALL "UT8500" USING
152270                                 UT8500CA-AREA
152280             MOVE "END." TO DBIO-CALL-SAVE-REFER
152290         ELSE
152300             MOVE UT9000-INST-NO TO TXTM-INST (TXT-1)
152310             SET TXT-2 TO 1
152320             MOVE UT9000-LANGUAGE-CODE TO TXTM-LANG (TXT-1 TXT-2).
152330 U9059-EXIT.
152340     EXIT.
152350/
152360 U9100-RETRIEVE-TEXT.
152370
152380     CALL "UT9000" USING
152400                         UT9000-AREA.
152410*
152420 U9199-EXIT.
152430     EXIT.
S15187
S15187 U9200-GET-VDEFEE.
S15187     INITIALIZE                WA-VDEFEE-AREA.
S15187     MOVE 2                 TO UT9000-CALL-CODE.
S15187     MOVE SPACE             TO UT9000-CALL-STATUS.
S15187     MOVE STRT-AREA-SOC-NO  TO UT9000-INST-NO.
S15187     MOVE "VDEFEE"          TO UT9000-CALLING-ID.
S15187     MOVE 12                TO UT9000-LANGUAGE-CODE.
S15187     MOVE 1                 TO UT9000-REPORT-NO.
S15187     MOVE 1                 TO UT9000-SEQUENCE-NO.
S15187     PERFORM  U9100-RETRIEVE-TEXT THRU U9199-EXIT.
S15187     IF UT9000-CALL-STATUS = "0"
S15187        MOVE UT9000CA-SOURCE-DATA TO WA-VDEFEE-AREA
S15187     END-IF.
S15187
S15187 U9299-EXIT.
S15187     EXIT.
S19775 U9300-POPUP-ACNO-AMT.
S19775             INITIALIZE  UT0082-CALL-AREA.
S19775             MOVE  "02"  TO  UT0082-CALL-CODE.
S19775             MOVE  "Y"   TO  UT0082-NEW-LINE-FLAG.
S19775             MOVE  42                TO  UT0082-MSG-LENGTH.
S19775             MOVE  WA-INPUT-KEY      TO  UT0082-MSG-TEXT(1:16).
S19775             MOVE  STRT-AREA-TRN-NO  TO  UT0082-MSG-TEXT(18:6).
S19775             MOVE  WA-INPUT-AMT      TO  UT0082-MSG-TEXT(25:42).
S19775             CALL  "UT0082"  USING  UT0082-CALL-AREA
S19775                                STARTAREA.
S19775 U9399-EXIT.
S19775     EXIT.
152440/
TB0157 V100-INSURANCE-PREMUIM.
TB0157     IF MONTHLY-TERM
TB0157        MOVE BORM-LOAN-TRM  TO UTINSPCA-LON-TRM
TB0157     ELSE
TB0157        MOVE 1     TO WA-MSG-ERR-FLAG
TB0157        MOVE 4346  TO WA-OUTPUT-ERR-MSG-NO
TB0157         GO TO V199-EXIT
TB0157     END-IF.
TB0157     IF BOIS-INSU-COMPANY-CODE = SPACES
TB0157        MOVE 1577 TO WA-OUTPUT-ERR-MSG-NO
TB0157        MOVE 1    TO WA-MSG-ERR-FLAG
TB0157        GO TO V199-EXIT
TB0157     ELSE
TB0157        MOVE BOIS-INSU-COMPANY-CODE TO UTINSPCA-COMPANY
TB0157     END-IF.
TB0157     MOVE BORM-SOC-NO       TO UTINSPCA-SOC-NO.
TB0157     MOVE BORM-ACT-TYPE     TO UTINSPCA-ACCT-TYPE.
TB0157     MOVE BORM-CURRENCY-IND TO UTINSPCA-CURRENCY.
TB0157     MOVE WA-INPUT-AMT       TO UTINSPCA-AMT.
TB0157     MOVE "L" TO UTINSPCA-PREMUIM-IND.
TB0157     CALL "UTINSP" USING WA-UTINSPCA-AREA.
TB0157     IF UTINSPCA-RATE-NOT-FOUND
TB0157*       MOVE 3985 TO WA-OUTPUT-ERR-MSG-NO
SC7829        MOVE 4760 TO WA-OUTPUT-ERR-MSG-NO
TB0157        MOVE 1    TO WA-MSG-ERR-FLAG
TB0157        GO TO V199-EXIT
TB0157     ELSE
TB0157        PERFORM V105-TRANSFER-INSU-PREMIUM
TB0157           THRU V105-EXIT
TB0157     END-IF.
TB0157 V199-EXIT.
TB0157     EXIT.
TB0157
TB0157 V105-TRANSFER-INSU-PREMIUM.
S12056     INITIALIZE WA-SAVE-INV-BR.
S12056     IF STRT-AREA-TRN-NO = (11055 OR 11155 OR 16055 OR 16155)
S12056     AND NOT FEDI-FROM-TO-GL
S12056        MOVE WA-DEP-ACCT-NO  TO INVM-MEMB-CUST-AC
S12056        PERFORM B1000-READ-INVM THRU B1999-EXIT
S12056        IF DBIO-CALL-STATUS NOT = "****"
S12056           DISPLAY "BR0000: (V105) ERROR IN READING INVM"
S12056                   ", KEY = " DBIO-CALL-KEY-AREA
S12056                   ", STATUS = " DBIO-CALL-STATUS
S12056           MOVE 1   TO WA-MSG-ERR-FLAG
S12056           MOVE 108 TO WA-OUTPUT-ERR-MSG-NO
S12056           GO TO V105-EXIT
S12056        END-IF
S12056        MOVE INVM-BRANCH-NO    TO WA-SAVE-INV-BR
S12056     END-IF.
S15238     MOVE      0            TO WA-INSU-AMT
S15238     IF BORM-INS-IND = 2 AND BORM-ADV-TOM-RATE > 0
S15238        COMPUTE WA-INSU-AMT ROUNDED =
S15238                WA-INPUT-AMT * (BORM-ADV-TOM-RATE / 100)
S15238        MOVE WA-INSU-AMT  TO UTINSPCA-PREMUIM-DUE
S15238     END-IF.
SC6058     MOVE UTINSPCA-INSU-ACCT-NO  TO INVM-MEMB-CUST-AC.
SC6058     PERFORM B1000-READ-INVM THRU B1999-EXIT.
SC6058     IF DBIO-CALL-STATUS NOT = "****"
SC8001        DISPLAY "BR0000: (V105) ERROR IN READING INVM"
SC8001                ", KEY = " DBIO-CALL-KEY-AREA
SC8001                ", STATUS = " DBIO-CALL-STATUS
SC6058        MOVE 1   TO WA-MSG-ERR-FLAG
SC6058        MOVE 108 TO WA-OUTPUT-ERR-MSG-NO
SC6058        GO TO V105-EXIT
SC6058     END-IF.
S12056     MOVE 'N'              TO WA-INS-FLAG-2.
S12056     INITIALIZE WA-INS-INC-BGL.
S12056     MOVE "007"                    TO WA-INS-INC-BGL-1.
S12056     MOVE BORM-BR-NO(2:3)          TO WA-INS-INC-BGL-2.
S12056     MOVE UTINSPCA-EXPOSURE-INC-GL TO WA-INS-INC-BGL-3.
S12056     INITIALIZE WA-INS-EXP-BGL.
S12056     MOVE "007"                    TO WA-INS-EXP-BGL-1.
S12056     MOVE BORM-BR-NO(2:3)          TO WA-INS-EXP-BGL-2.
S12056     MOVE UTINSPCA-PREMIUM-EXP-GL  TO WA-INS-EXP-BGL-3.
S12056     MOVE BORM-MEMB-CUST-AC        TO WA-SAV-BOR-ACCT.
SC7091*    IF STRT-AREA-TRN-NO = 11055 OR 11155
S11455*    IF STRT-AREA-TRN-NO = (11055 OR 11155 OR 16055 OR 16155)  
S11455     IF STRT-AREA-TRN-NO = (11055 OR 11155 OR 16055 OR 16155 OR
S11455                            16068 OR 16168)                    
SC4522     AND NOT FEDI-FROM-TO-GL
TB0157        PERFORM V110-PROCESS-DEBIT  THRU V119-EXIT
TB0157        IF WA-MSG-ERR-FLAG = 1
TB0157           GO TO V105-EXIT
TB0157        END-IF
S12056        PERFORM V150-PROCESS-CREDIT-INGL THRU V159-EXIT
S12056        IF WA-MSG-ERR-FLAG = 1
S12056           GO TO V105-EXIT
S12056        END-IF
S15942       IF (UTINSPCA-EXP-GL)
S12056        PERFORM V160-PROCESS-DEBIT-EXGL THRU V169-EXIT
S12056        IF WA-MSG-ERR-FLAG = 1
S12056           GO TO V105-EXIT
S12056        END-IF
TB0157        PERFORM V120-PROCESS-CREDIT THRU V129-EXIT
S15942       END-IF
TB0157     END-IF.
TB0157
TB0157     IF STRT-AREA-TRN-NO = 11057 OR 11157
S11455                        OR 11069 OR 11169
S11455                        OR 16069 OR 16169
S15238                        OR 16057 OR 16157
SC4522     OR (FEDI-FROM-TO-GL AND (STRT-AREA-TRN-NO = 11055 OR 11155))
SC7091     OR (FEDI-FROM-TO-GL AND (STRT-AREA-TRN-NO = 16055 OR 16155))
TB0157        PERFORM V130-PROCESS-DEBIT-GL THRU V139-EXIT
TB0157        IF WA-MSG-ERR-FLAG = 1
TB0157           GO TO V105-EXIT
TB0157        END-IF
S12056        PERFORM V150-PROCESS-CREDIT-INGL THRU V159-EXIT
S12056        IF WA-MSG-ERR-FLAG = 1
S12056           GO TO V105-EXIT
S12056        END-IF
S15942       IF (UTINSPCA-EXP-GL)
S12056        PERFORM V160-PROCESS-DEBIT-EXGL THRU V169-EXIT
S12056        IF WA-MSG-ERR-FLAG = 1
S12056           GO TO V105-EXIT
S12056        END-IF
TB0157*       PERFORM V140-PROCESS-CREDIT-GL THRU V149-EXIT
SC0923        PERFORM V120-PROCESS-CREDIT THRU V129-EXIT
S15942       END-IF
TB0157     END-IF.
TB0157 V105-EXIT.
TB0157     EXIT.
TB0157
TB0157 V110-PROCESS-DEBIT.
TB0157     MOVE WA-DEP-ACCT-NO    TO WA-SAVE-FROM-ACCT.
TB0157     MOVE STRT-AREA-TRN-NO  TO WA-SAV-STRT-AREA-TRN-NO.
SC6937*    MOVE STRT-AREA-DATA    TO WA-SAV-STRT-AREA-DATA.
B19902*SC6937     MOVE STARTAREA(1:150)  TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)  TO WA-SAV-STRT-AREA-DATA.
TB0157     MOVE WA-INPUT-MSG      TO WA-SAV-INPUT-MSG.
SC9959     MOVE WA-EDIT-MASK      TO WA-SAVE-PROC-BITS.
TB0157     MOVE BORM-RECORD-AREA  TO WA-SAV-BORM-RECORD-AREA.
S12056*SC6058     MOVE INVM-BRANCH-NO    TO WA-SAVE-GLDM-BRANCH.
S12056     MOVE WA-INS-INC-BGL-2  TO WA-SAVE-GLDM-BRANCH.
TB0157     INITIALIZE WA-INPUT-MSG.
S12056*TB0157     MOVE UTINSPCA-INSU-ACCT-NO  TO W800-TO-ACCT
S12056     MOVE WA-INS-INC-BGL         TO W800-TO-ACCT
TB0157                                    W800-TO-IN24-ACCT.
TB0157     MOVE WA-SAVE-FROM-ACCT      TO W800-FROM-ACCT.
TB0157     COMPUTE WA-PREMUIM-ROUNDED ROUNDED = UTINSPCA-PREMUIM-DUE.
TB0157     MOVE WA-PREMUIM-ROUNDED     TO W800-TRF-AMOUNT
TB0157                                    W800-CURR-AMT.
TB0157     MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE.
TB0157     MOVE 1 TO UT0020-FUNCTION.
TB0157     PERFORM X600-UT0020-PARA THRU X609-EXIT.
TB0157     MOVE UT0020-DATE-DDMMCCYY TO W800-TRF-DATE.
TB0157     MOVE SPACES                 TO W800-CHQ-DAYS.
TB0157     MOVE ZEROES                 TO W800-COMMISSION
TB0157                                    W800-DEB-DEF-INT-DAYS
TB0157                                    W800-DEF-INT-DAYS
TB0157                                    W800-CORR-JRNL-NO.
S12056     MOVE WA-SAVE-INV-BR         TO WA-SAVE-SOURCE-BRANCH.
TB0157     IF (WA-INPUT-PARAM-TABLE (7) = 0)
TB0157        MOVE 1055                 TO STRT-AREA-TRN-NO
TB0157        MOVE ZEROES               TO WA-GL-CORR-JRNL-NO
TB0157     ELSE
TB0157        MOVE 1155                 TO STRT-AREA-TRN-NO
TB0157*       MOVE WA-SAV-IN-TRACER-NO  TO WA-GL-CORR-JRNL-NO.
SC0923        MOVE WA-ORIG-JRNL-NO      TO W800-CORR-JRNL-NO.
TB0157
TB0157     IF W800-ACCT-CURR-CD = SPACES
TB0157        MOVE BORM-CURRENCY-IND   TO W800-ACCT-CURR-CD.
TB0157
TB0157     MOVE STRT-AREA-TRN-NO       TO LINK-IN-TXCODE.
TB0157     PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
TB0157     IF WA-MSG-ERR-FLAG NOT = ZERO
TB0157        GO TO V119-SAVE.
TB0157
TB0157     MOVE LINK-EDIT-TABLE      TO STRT-AREA-EDIT-MASK.
TB0157     MOVE LINK-POSTING-LEVEL   TO STRT-AREA-POSTING-LEVEL.
TB0157     CALL "UT0800" USING  STARTAREA
TB0157                          W300-ERROR-AREA
TB0157                          WA-JRNL-CALL-AREA
TB0157                          WA-PASSALONG
TB0157                          MULTI-OVERRIDE-AREA
TB0157                          CHECK-RESPONSE-AREA
TB0157                          WA-OTHER-SAVE-AREAS
TB0157                          PBOOKCA-LINE-AREA
SC9608                          UTVTACCA-CALL-PARAM.
SC5612     IF WA-MSG-ERR-FLAG = 0
SC5612        PERFORM C000-PRE-IMAGE-LOG THRU C099-EXIT
SC5612     END-IF.
TB0157 V119-SAVE.
TB0157     MOVE WA-SAV-STRT-AREA-TRN-NO TO STRT-AREA-TRN-NO.
SC6937*    MOVE WA-SAV-STRT-AREA-DATA   TO STRT-AREA-DATA.
B19902*SC6937     MOVE WA-SAV-STRT-AREA-DATA   TO STARTAREA(1:150).
B19902     MOVE WA-SAV-STRT-AREA-DATA   TO STARTAREA(1:200).
TB0157     MOVE WA-SAV-INPUT-MSG        TO WA-INPUT-MSG.
SC9959     MOVE WA-SAVE-PROC-BITS       TO WA-EDIT-MASK.
TB0157     MOVE WA-SAV-BORM-RECORD-AREA TO BORM-RECORD-AREA.
SC6058     MOVE WA-SAVE-ACCT-BRANCH     TO WA-SAVE-GLDM-BRANCH.
TB0157 V119-EXIT.
TB0157     EXIT.
TB0157
TB0157 V120-PROCESS-CREDIT.
TB0157     MOVE STRT-AREA-TRN-NO  TO WA-SAV-STRT-AREA-TRN-NO.
SC6937*    MOVE STRT-AREA-DATA    TO WA-SAV-STRT-AREA-DATA.
B19902*SC6937     MOVE STARTAREA(1:150)  TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)  TO WA-SAV-STRT-AREA-DATA.
TB0157     MOVE WA-INPUT-MSG      TO WA-SAV-INPUT-MSG.
SC9959     MOVE WA-EDIT-MASK      TO WA-SAVE-PROC-BITS.
TB0157     MOVE BORM-RECORD-AREA  TO WA-SAV-BORM-RECORD-AREA.
TB0157
TB0157     INITIALIZE WA-INPUT-MSG.
SC5138**   MOVE WA-INPUT-ACCT-NO       TO W800-TO-ACCT
SC5138     MOVE WA-SAVE-FROM-ACCT      TO W800-TO-ACCT
TB0157                                    W800-TO-IN24-ACCT.
SC4624     IF STRT-AREA-TRN-NO = 11055 OR 11155
S15238                        OR 16055 OR 16155
SC4624        MOVE "DEP"               TO W800-TO-IN24-SYS.
SC4624     IF STRT-AREA-TRN-NO = 11057 OR 11157
S11455                        OR 11069 OR 11169
S15238                        OR 16057 OR 16157
SC4624        MOVE "GEN"               TO W800-TO-IN24-SYS
SC4624        MOVE WA-GL-ACCT-NO       TO W800-TO-ACCT
SC4624                                    W800-TO-IN24-ACCT.
SC4624     MOVE "LON"                  TO W800-TO-IN23-SYS.
SC4624     MOVE WA-CUSV-ACCT-NO        TO W800-TO-IN23-ACCT.
TB0157     MOVE UTINSPCA-INSU-ACCT-NO  TO W800-FROM-ACCT.
TB0157     COMPUTE WA-PREMUIM-ROUNDED ROUNDED = UTINSPCA-PREMUIM-DUE.
TB0157     MOVE WA-PREMUIM-ROUNDED     TO W800-TRF-AMOUNT 
TB0157                                    W800-CURR-AMT.
TB0157     MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE.
TB0157     MOVE 1 TO UT0020-FUNCTION.
TB0157     PERFORM X600-UT0020-PARA THRU X609-EXIT.
TB0157     MOVE UT0020-DATE-DDMMCCYY TO W800-TRF-DATE.
TB0157     MOVE SPACES                 TO W800-CHQ-DAYS.
TB0157     MOVE ZEROES                 TO W800-COMMISSION
TB0157                                    W800-DEB-DEF-INT-DAYS
TB0157                                    W800-DEF-INT-DAYS
TB0157                                    W800-CORR-JRNL-NO.
S12056     MOVE WA-INS-EXP-BGL-2       TO WA-SAVE-GLDM-BRANCH.
TB0157     IF (WA-INPUT-PARAM-TABLE (7) = 0)
TB0157        MOVE 1045                 TO STRT-AREA-TRN-NO
TB0157        MOVE ZEROES               TO WA-GL-CORR-JRNL-NO
TB0157     ELSE
TB0157        MOVE 1145                 TO STRT-AREA-TRN-NO
TB0157*       MOVE WA-SAV-IN-TRACER-NO  TO WA-GL-CORR-JRNL-NO.
SC0923        MOVE WA-ORIG-JRNL-NO      TO W800-CORR-JRNL-NO.
TB0157
TB0157     IF W800-ACCT-CURR-CD = SPACES
TB0157        MOVE BORM-CURRENCY-IND   TO W800-ACCT-CURR-CD.
TB0157
TB0157     MOVE STRT-AREA-TRN-NO       TO LINK-IN-TXCODE.
TB0157     PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
TB0157     IF WA-MSG-ERR-FLAG NOT = ZERO
TB0157        GO TO V129-SAVE.
TB0157
TB0157     MOVE LINK-EDIT-TABLE      TO STRT-AREA-EDIT-MASK.
TB0157     MOVE LINK-POSTING-LEVEL   TO STRT-AREA-POSTING-LEVEL.
TB0157     CALL "UT0800" USING  STARTAREA
TB0157                          W300-ERROR-AREA
TB0157                          WA-JRNL-CALL-AREA
TB0157                          WA-PASSALONG
TB0157                          MULTI-OVERRIDE-AREA
TB0157                          CHECK-RESPONSE-AREA
TB0157                          WA-OTHER-SAVE-AREAS
TB0157                          PBOOKCA-LINE-AREA
SC9608                          UTVTACCA-CALL-PARAM.
SC5612     IF WA-MSG-ERR-FLAG = 0
SC5612        PERFORM C000-PRE-IMAGE-LOG THRU C099-EXIT
SC5612     END-IF.
TB0157 V129-SAVE.
SC6828     MOVE 'Y'                     TO WA-INS-FLAG.
SC6828     MOVE W800-FROM-ACCT          TO WA-INS-FROM-ACCT.
SC6828     MOVE W800-TO-ACCT            TO WA-INS-TO-ACCT.
SC6828     MOVE W800-TRF-DATE           TO WA-INS-TRF-DATE.
SC6828     MOVE W800-TRF-AMOUNT         TO WA-INS-TXN-AMT.
SC6828     MOVE STRT-AREA-DATA          TO WA-INS-STRT-AREA-DATA.
TB0157     MOVE WA-SAV-STRT-AREA-TRN-NO TO STRT-AREA-TRN-NO.
SC6937*    MOVE WA-SAV-STRT-AREA-DATA   TO STRT-AREA-DATA.
B19902*SC6937     MOVE WA-SAV-STRT-AREA-DATA   TO STARTAREA(1:150).
B19902     MOVE WA-SAV-STRT-AREA-DATA   TO STARTAREA(1:200).
TB0157     MOVE WA-SAV-INPUT-MSG        TO WA-INPUT-MSG.
SC9959     MOVE WA-SAVE-PROC-BITS       TO WA-EDIT-MASK.
TB0157     MOVE WA-SAV-BORM-RECORD-AREA TO BORM-RECORD-AREA.
TB0157 V129-EXIT.
TB0157     EXIT.
TB0157
TB0157 V130-PROCESS-DEBIT-GL.
SC5138**   MOVE WA-DEP-ACCT-NO      TO WA-SAVE-FROM-ACCT.
TB0157     MOVE STRT-AREA-TRN-NO    TO WA-SAV-STRT-AREA-TRN-NO.
SC6937*    MOVE STRT-AREA-DATA      TO WA-SAV-STRT-AREA-DATA.
B19902*SC6937     MOVE STARTAREA(1:150)    TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)    TO WA-SAV-STRT-AREA-DATA.
SC9959     MOVE WA-EDIT-MASK        TO WA-SAVE-PROC-BITS.
TB0157     MOVE GLDM-RECORD-AREA    TO WA-SAV-GLDM-RECORD-AREA.
TB0157     MOVE WA-INPUT-MSG        TO WA-SAV-INPUT-MSG.
TB0157
TB0157     MOVE STRT-AREA-SOC-NO          TO GLDM-INST-NO
TB0157     MOVE WA-INPUT-ACCT-NO       TO GLDM-LEDGER-NO
SC5138                                    WA-SAVE-FROM-ACCT.
TB0157     PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT
TB0157        IF WA-MSG-ERR-FLAG NOT = 0
S12056*TB0157           GO TO V199-EXIT.
S12056           GO TO V139-EXIT.
TB0157
TB0157     INITIALIZE WA-INPUT-MSG.
TB0157
TB0157     MOVE 3                TO GL-TRANS-IND.
TB0157     MOVE SPACES           TO GL-DONT-WRITE-GLDM-IND.
TB0157     MOVE WA-ADV-TXN-DATE  TO WA-GL-TXN-DATE.
TB0157     MOVE SPACES           TO WA-GL-DESC-AREA.
TB0157     MOVE ZEROES           TO WA-GL-CHQ-NO
TB0157                              WA-GL-CHQ-TYPE
TB0157                              WA-GL-VALUE-DATE
TB0157                              WA-GL-MSG-TYPE.
TB0157
TB0157     MOVE WA-ADV-PROMO           TO WA-GL-PROMO-NO
TB0157     COMPUTE WA-PREMUIM-ROUNDED ROUNDED = UTINSPCA-PREMUIM-DUE.
TB0157     MOVE WA-PREMUIM-ROUNDED     TO WA-GL-AMOUNT.
TB0157     MOVE GLDM-LEDGER-NO         TO WA-GL-ACCT-NO.
S12056*TB0157     MOVE UTINSPCA-INSU-ACCT-NO  TO WA-NARR-TRF-ACCT.
S12056     MOVE WA-INS-INC-BGL         TO WA-NARR-TRF-ACCT.
S12056*SC6058     MOVE INVM-BRANCH-NO         TO WA-SAVE-DEST-BRANCH.
S12056     MOVE WA-INS-INC-BGL-2       TO WA-SAVE-DEST-BRANCH.
S12056     MOVE GLDM-BRANCH            TO WA-SAVE-SOURCE-BRANCH.
TB0157
TB0157     IF WA-INPUT-PARAM-TABLE(7) = 0
TB0157        MOVE 20055                TO STRT-AREA-TRN-NO
TB0157        MOVE ZEROES               TO WA-GL-CORR-JRNL-NO
TB0157     ELSE
TB0157        MOVE 20155                TO STRT-AREA-TRN-NO
TB0157        MOVE WA-ORIG-JRNL-NO       TO WA-GL-CORR-JRNL-NO.
TB0157
TB0157      MOVE STRT-AREA-TRN-NO        TO LINK-IN-TXCODE.
TB0157      PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
TB0157      IF WA-MSG-ERR-FLAG NOT = ZERO
S12056*TB0157         GO TO V199-EXIT.
S12056         GO TO V139-EXIT.
TB0157      MOVE WA-GL-TXN-AREA          TO WA-INPUT-MSG.
TB0157
TB0157      CALL "UT0820" USING  STARTAREA
SC1574                          W300-ERROR-AREA
TB0157                          GL-PASSALONG
SC1574                          WA-OTHER-SAVE-AREAS
TB0157                          MULTI-OVERRIDE-AREA
TB0157                          CHECK-RESPONSE-AREA
SC7181                          UTVTACCA-CALL-PARAM.
TB0157
TB0157      IF ST-STATUS-LEVEL-1 NOT = ZERO
TB0157         MOVE 1         TO WA-MSG-ERR-FLAG 
SC5612      ELSE
SC5612         PERFORM C000-PRE-IMAGE-LOG THRU C099-EXIT
SC5612      END-IF.
TB0157
TB0157
TB0157     MOVE WA-SAV-STRT-AREA-TRN-NO    TO STRT-AREA-TRN-NO.
SC6937*    MOVE WA-SAV-STRT-AREA-DATA      TO STRT-AREA-DATA.
B19902*SC6937     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:150).
B19902     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:200).
TB0157     MOVE WA-SAV-GLDM-RECORD-AREA    TO GLDM-RECORD-AREA.
TB0157     MOVE WA-SAV-INPUT-MSG           TO WA-INPUT-MSG.
SC9959     MOVE WA-SAVE-PROC-BITS          TO WA-EDIT-MASK.
SC6058     MOVE WA-SAVE-ACCT-BRANCH        TO WA-SAVE-GLDM-BRANCH.
TB0157 V139-EXIT.
TB0157     EXIT.
TB0157
TB0157 v140-process-credit-GL.
TB0157     MOVE WA-DEP-ACCT-NO      TO WA-SAVE-FROM-ACCT.
TB0157     MOVE STRT-AREA-TRN-NO    TO WA-SAV-STRT-AREA-TRN-NO.
SC6937*    MOVE STRT-AREA-DATA      TO WA-SAV-STRT-AREA-DATA.
B19902*SC6937     MOVE STARTAREA(1:150)    TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)    TO WA-SAV-STRT-AREA-DATA.
SC9959     MOVE WA-EDIT-MASK        TO WA-SAVE-PROC-BITS.
TB0157     MOVE GLDM-RECORD-AREA    TO WA-SAV-GLDM-RECORD-AREA.
TB0157     MOVE WA-INPUT-MSG        TO WA-SAV-INPUT-MSG.
TB0157
TB0157     MOVE STRT-AREA-SOC-NO    TO GLDM-INST-NO
TB0157     MOVE WA-INPUT-ACCT-NO    TO GLDM-LEDGER-NO
TB0157     PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT
TB0157        IF WA-MSG-ERR-FLAG NOT = 0
TB0157           GO TO V199-EXIT.
TB0157
TB0157     INITIALIZE WA-INPUT-MSG.
TB0157     MOVE 3                TO GL-TRANS-IND.
TB0157     MOVE "0"              TO GL-DONT-WRITE-GLDM-IND.
TB0157     MOVE WA-ADV-TXN-DATE  TO WA-GL-TXN-DATE.
TB0157     MOVE SPACES           TO WA-GL-DESC-AREA
TB0157                                 WA-GL-NAME-1
TB0157                                 WA-GL-NAME-2.
TB0157     MOVE 00                  TO WA-GL-NON-VALUE-DAYS.
TB0157     MOVE 00                  TO WA-GL-DEFER-DAYS.
TB0157     MOVE 00                  TO WA-GL-DEBIT-DEFER-DAYS.
TB0157     MOVE ZEROES           TO WA-GL-CHQ-NO
TB0157                              WA-GL-CHQ-TYPE
TB0157                              WA-GL-VALUE-DATE
TB0157                              WA-GL-MSG-TYPE.
TB0157
TB0157     MOVE GLDM-CURRENCY       TO WA-GL-CURRENCY.
TB0157     MOVE WA-ADV-PROMO           TO WA-GL-PROMO-NO.
TB0157     COMPUTE WA-PREMUIM-ROUNDED ROUNDED = UTINSPCA-PREMUIM-DUE.
TB0157     MOVE WA-PREMUIM-ROUNDED     TO WA-GL-AMOUNT
TB0157     MOVE GLDM-LEDGER-NO         TO WA-GL-ACCT-NO
TB0157     MOVE UTINSPCA-INSU-ACCT-NO  TO WA-NARR-TRF-ACCT.
TB0157
TB0157     IF WA-INPUT-PARAM-TABLE(7) = 0
TB0157        MOVE 20055               TO STRT-AREA-TRN-NO
TB0157        MOVE ZEROES               TO WA-GL-CORR-JRNL-NO
TB0157     ELSE
TB0157        MOVE 20155                TO STRT-AREA-TRN-NO
TB0157        MOVE WA-ORIG-JRNL-NO       TO WA-GL-CORR-JRNL-NO.
TB0157      MOVE STRT-AREA-TRN-NO        TO LINK-IN-TXCODE.
TB0157      PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
TB0157      IF WA-MSG-ERR-FLAG NOT = ZERO
TB0157         GO TO V199-EXIT.
TB0157      MOVE WA-GL-TXN-AREA          TO WA-INPUT-MSG.
TB0157
TB0157      CALL "UT0820" USING  STARTAREA
SC1574                          W300-ERROR-AREA
TB0157                          GL-PASSALONG
SC1574                          WA-OTHER-SAVE-AREAS
TB0157                          MULTI-OVERRIDE-AREA
TB0157                          CHECK-RESPONSE-AREA
SC7181                          UTVTACCA-CALL-PARAM.
TB0157
TB0157     IF ST-STATUS-LEVEL-1 NOT = ZERO
TB0157        MOVE 1         TO WA-MSG-ERR-FLAG 
SC5612     ELSE
SC5612        PERFORM C000-PRE-IMAGE-LOG THRU C099-EXIT
SC5612     END-IF.
TB0157
TB0157     MOVE WA-SAV-STRT-AREA-TRN-NO    TO STRT-AREA-TRN-NO.
SC6937*    MOVE WA-SAV-STRT-AREA-DATA      TO STRT-AREA-DATA.
B19902*SC6937     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:150).
B19902     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:200).
SC9959     MOVE WA-SAVE-PROC-BITS          TO WA-EDIT-MASK.
TB0157     MOVE WA-SAV-GLDM-RECORD-AREA    TO GLDM-RECORD-AREA.
TB0157     MOVE WA-SAV-INPUT-MSG           TO WA-INPUT-MSG.
TB0157 V149-EXIT.
TB0157     EXIT.
S12056 V150-PROCESS-CREDIT-INGL.
S12056     MOVE STRT-AREA-TRN-NO    TO WA-SAV-STRT-AREA-TRN-NO.
B19902*S12056     MOVE STARTAREA(1:150)    TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)    TO WA-SAV-STRT-AREA-DATA.
S12056     MOVE WA-EDIT-MASK        TO WA-SAVE-PROC-BITS.
S12056     MOVE GLDM-RECORD-AREA    TO WA-SAV-GLDM-RECORD-AREA.
S12056     MOVE WA-INPUT-MSG        TO WA-SAV-INPUT-MSG.
S12056
S12056     MOVE STRT-AREA-SOC-NO    TO GLDM-INST-NO.
S12056     MOVE WA-INS-INC-BGL      TO GLDM-LEDGER-NO
S12056                                 DBIO-01-ACCT-NO.
S12056     PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT
S12056        IF WA-MSG-ERR-FLAG NOT = 0
S12056           GO TO V159-EXIT.
S12056
S12056     INITIALIZE WA-INPUT-MSG.
S12056
S12056     MOVE 3                TO GL-TRANS-IND.
S12056     MOVE SPACES           TO GL-DONT-WRITE-GLDM-IND.
S12056     MOVE WA-ADV-TXN-DATE  TO WA-GL-TXN-DATE.
S12056     MOVE SPACES           TO WA-GL-DESC-AREA.
S12056     MOVE ZEROES           TO WA-GL-CHQ-NO
S12056                              WA-GL-CHQ-TYPE
S12056                              WA-GL-VALUE-DATE
S12056                              WA-GL-MSG-TYPE.
S12056
S12056     MOVE WA-ADV-PROMO           TO WA-GL-PROMO-NO
S12056     COMPUTE WA-PREMUIM-ROUNDED ROUNDED = UTINSPCA-PREMUIM-DUE.
S12056     MOVE WA-PREMUIM-ROUNDED     TO WA-GL-AMOUNT.
S12056     MOVE GLDM-LEDGER-NO         TO WA-GL-ACCT-NO.
S12056     MOVE WA-SAVE-FROM-ACCT      TO WA-NARR-TRF-ACCT.
S12056     INITIALIZE WA-NARR-TEXT.
S12056     MOVE "LN"                    TO WA-NARR-TEXT(1:2).
S12056     MOVE WA-SAV-BOR-ACCT-R(3:14) TO WA-NARR-TEXT(3:14).
S12056     MOVE "LN"                    TO WA-NARR-TEXT(26:2).
S12056     MOVE WA-SAV-BOR-ACCT-R(3:14) TO WA-NARR-TEXT(28:14).
S12056
S12056     MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE.
S12056     MOVE 1 TO UT0020-FUNCTION.
S12056     PERFORM X600-UT0020-PARA THRU X609-EXIT.
S12056
S12056     IF WA-INPUT-PARAM-TABLE(7) = 0
S12056        MOVE 20045                TO STRT-AREA-TRN-NO
S12056        MOVE ZEROES               TO WA-GL-CORR-JRNL-NO
S12056     ELSE
S12056        MOVE 20145                TO STRT-AREA-TRN-NO
S12056        MOVE WA-ORIG-JRNL-NO       TO WA-GL-CORR-JRNL-NO.
S12056
S12056      MOVE STRT-AREA-TRN-NO        TO LINK-IN-TXCODE.
S12056      PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
S12056      IF WA-MSG-ERR-FLAG NOT = ZERO
S12056         GO TO V159-EXIT.
S12056      MOVE WA-GL-TXN-AREA          TO WA-INPUT-MSG.
S12056
S12056      CALL "UT0820" USING  STARTAREA
S12056                          W300-ERROR-AREA
S12056                          GL-PASSALONG
S12056                          WA-OTHER-SAVE-AREAS
S12056                          MULTI-OVERRIDE-AREA
S12056                          CHECK-RESPONSE-AREA
S12056                          UTVTACCA-CALL-PARAM.
S12056
S12056      IF ST-STATUS-LEVEL-1 NOT = ZERO
S12056         MOVE 1         TO WA-MSG-ERR-FLAG
S12056      ELSE
S12056         PERFORM C000-PRE-IMAGE-LOG THRU C099-EXIT
S12056      END-IF.
S12056
S12056 V159-SAVE.
S12056     MOVE 'Y'                        TO WA-INS-FLAG-2.
S12056     MOVE WA-NARR-TRF-ACCT           TO WA-INS-FROM-ACCT-2.
S12056     MOVE WA-GL-ACCT-NO              TO WA-INS-TO-ACCT-2.
S12056     MOVE UT0020-DATE-DDMMCCYY       TO WA-INS-TRF-DATE-2.
S12056     MOVE WA-PREMUIM-ROUNDED         TO WA-INS-TXN-AMT-2.
S12056     MOVE STRT-AREA-DATA             TO WA-INS-STRT-AREA-DATA-2.
S12056     MOVE WA-SAV-STRT-AREA-TRN-NO    TO STRT-AREA-TRN-NO.
B19902*S12056     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:150).
B19902     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:200).
S12056     MOVE WA-SAV-GLDM-RECORD-AREA    TO GLDM-RECORD-AREA.
S12056     MOVE WA-SAV-INPUT-MSG           TO WA-INPUT-MSG.
S12056     MOVE WA-SAVE-PROC-BITS          TO WA-EDIT-MASK.
S12056 V159-EXIT.
S12056     EXIT.
S12056
S12056 V160-PROCESS-DEBIT-EXGL.
S12056     MOVE STRT-AREA-TRN-NO    TO WA-SAV-STRT-AREA-TRN-NO.
B19902*S12056     MOVE STARTAREA(1:150)    TO WA-SAV-STRT-AREA-DATA.
B19902     MOVE STARTAREA(1:200)    TO WA-SAV-STRT-AREA-DATA.
S12056     MOVE WA-EDIT-MASK        TO WA-SAVE-PROC-BITS.
S12056     MOVE GLDM-RECORD-AREA    TO WA-SAV-GLDM-RECORD-AREA.
S12056     MOVE WA-INPUT-MSG        TO WA-SAV-INPUT-MSG.
S12056
S12056     MOVE STRT-AREA-SOC-NO    TO GLDM-INST-NO.
S12056     MOVE WA-INS-EXP-BGL      TO GLDM-LEDGER-NO
S12056                                 WA-SAVE-FROM-ACCT
S12056                                 DBIO-01-ACCT-NO.
S12056     PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT
S12056        IF WA-MSG-ERR-FLAG NOT = 0
S12056           GO TO V169-EXIT.
S12056
S12056     INITIALIZE WA-INPUT-MSG.
S12056
S12056     MOVE 3                TO GL-TRANS-IND.
S12056     MOVE SPACES           TO GL-DONT-WRITE-GLDM-IND.
S12056     MOVE WA-ADV-TXN-DATE  TO WA-GL-TXN-DATE.
S12056     MOVE SPACES           TO WA-GL-DESC-AREA.
S12056     MOVE ZEROES           TO WA-GL-CHQ-NO
S12056                              WA-GL-CHQ-TYPE
S12056                              WA-GL-VALUE-DATE
S12056                              WA-GL-MSG-TYPE.
S12056     MOVE ZEROES           TO WA-GL-DEBIT-DEFER-DAYS.
S12056
S12056     MOVE WA-ADV-PROMO           TO WA-GL-PROMO-NO
S12056     COMPUTE WA-PREMUIM-ROUNDED ROUNDED = UTINSPCA-PREMUIM-DUE.
S12056     MOVE WA-PREMUIM-ROUNDED     TO WA-GL-AMOUNT.
S12056     MOVE GLDM-LEDGER-NO         TO WA-GL-ACCT-NO.
S12056     MOVE UTINSPCA-INSU-ACCT-NO  TO WA-NARR-TRF-ACCT.
S12056     MOVE INVM-BRANCH-NO         TO WA-SAVE-DEST-BRANCH.
S12056     INITIALIZE WA-NARR-TEXT.
S12056     MOVE "LN"                    TO WA-NARR-TEXT(1:2).
S12056     MOVE WA-SAV-BOR-ACCT-R(3:14) TO WA-NARR-TEXT(3:14).
S12056     MOVE "LN"                    TO WA-NARR-TEXT(26:2).
S12056     MOVE WA-SAV-BOR-ACCT-R(3:14) TO WA-NARR-TEXT(28:14).
S12056
S12056     IF WA-INPUT-PARAM-TABLE(7) = 0
S12056        MOVE 20055                TO STRT-AREA-TRN-NO
S12056        MOVE ZEROES               TO WA-GL-CORR-JRNL-NO
S12056     ELSE
S12056        MOVE 20155                TO STRT-AREA-TRN-NO
S12056        MOVE WA-ORIG-JRNL-NO       TO WA-GL-CORR-JRNL-NO.
S12056
S12056      MOVE STRT-AREA-TRN-NO        TO LINK-IN-TXCODE.
S12056      PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
S12056      IF WA-MSG-ERR-FLAG NOT = ZERO
S12056         GO TO V169-EXIT.
S12056      MOVE WA-GL-TXN-AREA          TO WA-INPUT-MSG.
S12056
S12056      CALL "UT0820" USING  STARTAREA
S12056                          W300-ERROR-AREA
S12056                          GL-PASSALONG
S12056                          WA-OTHER-SAVE-AREAS
S12056                          MULTI-OVERRIDE-AREA
S12056                          CHECK-RESPONSE-AREA
S12056                          UTVTACCA-CALL-PARAM.
S12056
S12056      IF ST-STATUS-LEVEL-1 NOT = ZERO
S12056         MOVE 1         TO WA-MSG-ERR-FLAG
S12056      ELSE
S12056         PERFORM C000-PRE-IMAGE-LOG THRU C099-EXIT
S12056      END-IF.
S12056
S12056
S12056     MOVE WA-SAV-STRT-AREA-TRN-NO    TO STRT-AREA-TRN-NO.
B19902*S12056     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:150).
B19902     MOVE WA-SAV-STRT-AREA-DATA      TO STARTAREA(1:200).
S12056     MOVE WA-SAV-GLDM-RECORD-AREA    TO GLDM-RECORD-AREA.
S12056     MOVE WA-SAV-INPUT-MSG           TO WA-INPUT-MSG.
S12056     MOVE WA-SAVE-PROC-BITS          TO WA-EDIT-MASK.
S12056 V169-EXIT.
S12056     EXIT.
152450*
152460 V300-RESET-CUSM.
152470*
152480     PERFORM V400-RESET-IDENTITY THRU V499-EXIT.
152490     IF WA-MSG-ERR-FLAG = 1
152500         GO TO V399-EXIT.
152510*
152520     MOVE 61 TO DBIO-CALL-FUNC.
152530     MOVE "CC" TO DBIO-CALL-TXN-TYPE-AREA.
152540     MOVE STRT-AREA-SOC-NO TO WA-CUSV-SOC-NO.
152550     MOVE BORM-CUSTOMER-NO TO WA-CUSV-ACCT-NO
152560                              STORE-CUST-ACCT-NO.
S15779     IF BORP-DISCH-ENQ-REQD = "N"
S15779        MOVE WA-INPUT-ACCT-NO TO STORE-CUST-ACCT-NO
S15779     END-IF.
S15779
152570     MOVE 0 TO DBIO-CALL-REFER-AREA.
152580     MOVE WA-CUSV-KEY TO DBIO-CALL-KEY-AREA.
152590     MOVE "CUSM" TO DBIO-CALL-N-SYS.
152600     MOVE "CUSV" TO DBIO-CALL-SYST-VAR.
152610*
152620 V310-CUSV-LOOP.
152630     CALL "DBIO" USING
152650                       DBIO-CALL-PARAM
152660                       DBIO-CALL-SYS-AREA
152670                       DBIO-CALL-KEY-AREA
152680                       DBIO-CALL-STATUS
152690                       WA-CUSV-AREA-CC
152700                       DBIO-CALL-REFER-AREA
152710                       DBIO-CALL-TXN-TYPE-AREA.
152720     IF  DBIO-CALL-SAVE-REFER = "END."
152730     OR  DBIO-CALL-STATUS NOT = "****"
152740         GO TO V399-EXIT.
152750     MOVE 0 TO W100-I.
152760*
152770 V320-LOOP.
152780     IF  W100-I < 8
152790         ADD 1 TO W100-I
152800     ELSE
152810         GO TO V310-CUSV-LOOP.
152820     IF  CUSV-CC-STATUS(W100-I) = 0
152830         GO TO V399-EXIT.
152840     IF  CUSV-CC-STATUS(W100-I) NOT = 01
S17464     AND STRT-AREA-TRN-NO       NOT = 17200
152850         GO TO V320-LOOP.
152860     IF  CUSV-CC-RELAT(W100-I) NOT = 01
152870         GO TO V320-LOOP.
152880     IF  CUSV-CC-ACCT-NO(W100-I) NOT = STORE-CUST-ACCT-NO
152890         GO TO V320-LOOP.
S17464     IF  STRT-AREA-TRN-NO = 17200
S17464         MOVE 01 TO CUSV-CC-STATUS(W100-I)
S17464     ELSE
S17464         MOVE 02 TO CUSV-CC-STATUS(W100-I)
S17464*152900  MOVE 02 TO CUSV-CC-STATUS(W100-I).
S17464     END-IF
152910     MOVE STRT-AREA-POST-DT TO CUSV-CC-MOD-CLS-DATE(W100-I).
152920     MOVE 64 TO DBIO-CALL-FUNC.
152930     CALL "DBIO" USING
152950                       DBIO-CALL-PARAM
152960                       DBIO-CALL-SYS-AREA
152970                       DBIO-CALL-KEY-AREA
152980                       DBIO-CALL-STATUS
152990                       WA-CUSV-AREA-CC
153000                       DBIO-CALL-REFER-AREA
153010                       DBIO-CALL-TXN-TYPE-AREA.
153020*
153030 V399-EXIT.
153040     EXIT.
153050/
153060 V400-RESET-IDENTITY.
153070*
153080     CALL "CI0051" USING
153100                         STARTAREA
153110                         WA-CUSV-AREA-A3
153120                         WA-CUSV-AREA-AA
153130                         WA-CUSV-AREA-CC
153140                         WA-CUSV-AREA-DD
153150                         WA-CUSV-AREA-D1
153160                         WA-CUSV-AREA-EE
153170                         WA-CUSV-AREA-ZZ
153180                         WA-JNRST-SAVE-DATA.
153190     IF  ST-STATUS-LEVEL-1 NOT = 0
153200         MOVE 0 TO ST-STATUS-LEVEL-1
153210         MOVE 1 TO WA-MSG-ERR-FLAG.
153220*
153230 V499-EXIT.
153240     EXIT.
153250/
153260 V500-CALL-UT0500.
153270*    MOVE 1                TO UT0500CA-CALL-CODE.
153280     MOVE STRT-AREA-SOC-NO TO UT0500CA-INST-NO.
153290     MOVE STRT-AREA-BRANCH TO UT0500CA-BRHM-NO.
153300     MOVE STRT-AREA-TELLER-LANG TO UT0500RA-LANGUAGE-CODE.
153310     MOVE 0                TO UT0500CA-INST-LANGUAGE-CODE.
153320     IF (WS-UT0500-SAVE-CUSM-NO = UT0500CA-CUSM-NO) AND
153330        (WS-UT0500-SAVE-INST-NO = UT0500CA-INST-NO)
153340        MOVE 0 TO UT0500RA-CALL-STATUS
153350        GO TO V599-EXIT.
153360     CALL "UT0500"      USING
153380                              UT0500-CALL-PARAM.
153390     IF UT0500RA-CALL-STATUS NOT = 0
153400        MOVE UT0500RA-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
153410        MOVE 1 TO WA-MSG-ERR-FLAG
153420        GO TO V599-EXIT.
153430     MOVE UT0500CA-INST-NO TO WS-UT0500-SAVE-CUSM-NO.
153440     MOVE UT0500CA-CUSM-NO TO WS-UT0500-SAVE-CUSM-NO.
TB0015     MOVE UT0500RA-CUSM-STATUS
TB0015                          TO WS-UT0500RA-CUSM-STATUS-SAVE.
153450 V599-EXIT.
153460     EXIT.
153470/
153480*
153490 V700-READ-GLDM-RECORD.
153500*    MOVE 1 TO ST-DBIO-CALL-CODE.
153510*    MOVE "1" TO ST-DBIO-LOCK-FLAG.
153520     MOVE 1 TO DBIO-CALL-FUNC.                                           
153530     MOVE "1" TO DBIO-CALL-LOCK-FLAG.                                    
153540     MOVE "GEN" TO DBIO-01-SYSTEM.
153550     MOVE STRT-AREA-SOC-NO TO DBIO-01-SOC-NO.
153560     MOVE SPACES TO DBIO-CALL-STATUS.
153570     CALL "DBIO" USING
153590                       DBIO-CALL-PARAM
153600                       DBIO-01-SYSTEM
153610                       DBIO-01-KEY
153620                       DBIO-01-RETURN-STATUS
153630                       GLDM-RECORD-AREA.
153640     IF  DBIO-01-RETURN-STATUS = "****"
153650         GO TO V799-EXIT.
153660     IF  DBIO-01-RETURN-STATUS = "MRNF"
153670         MOVE 1 TO WA-MSG-ERR-FLAG
SC0796         IF  WA-INPUT-PARAM-TABLE (10) = 1
SC0796             MOVE 552 TO WA-OUTPUT-ERR-MSG-NO
SC0796         ELSE
SC0796             MOVE 223 TO WA-OUTPUT-ERR-MSG-NO
SC0796         END-IF
SC0796*        MOVE 552 TO WA-OUTPUT-ERR-MSG-NO
153690         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
153700         MOVE SPACES TO UT8500CA-INPUT-MSG
153710         STRING "BR0000:(V700) SUSPENSE CT NOT FOUND, "
153720                 "KEY-AC" DBIO-01-KEY
153730         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
153740         CALL "UT8500" USING
153760                             UT8500CA-AREA
153770         GO TO V799-EXIT.
153780     IF  DBIO-01-RETURN-STATUS NOT = "HELD"
153790         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
153800         MOVE SPACES TO UT8500CA-INPUT-MSG
153810         STRING "BR0000:(V700) INVALID GLDM READ, STAT-AC"
153820                 DBIO-01-RETURN-STATUS ", KEY-AC" DBIO-01-KEY
153830         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
153840         CALL "UT8500" USING
153860                             UT8500CA-AREA
153870         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
153880         MOVE 1 TO WA-MSG-ERR-FLAG
153890         MOVE "GLDM" TO IN0014-OUTPUT-DATA-SET
153900         MOVE DBIO-01-RETURN-STATUS TO IN0014-OUTPUT-STATUS
153910         GO TO V799-EXIT.
B19392*    IF  WA-DUP-COUNT < 5
B19392     IF  WA-DUP-COUNT < DLAYHERECA-RETRIES-50
153930         ADD 1 TO WA-DUP-COUNT
153940         CALL "DLAYHERE" USING
B19392*                              WA-DELAY-1SECS
B19392                               DLAYHERECA-TIME-10
153970         GO TO V700-READ-GLDM-RECORD.
153980     MOVE 112 TO WA-OUTPUT-ERR-MSG-NO.
153990     MOVE 1 TO WA-MSG-ERR-FLAG.
154000 V799-EXIT.
154010      EXIT.
154020/
154030 V800-CHECK-SECURITY.
154040     IF  SOC-ACCESS-SECURITY-IND = "N"
154050         GO TO V899-EXIT.
154060     IF  WA-INPUT-PARAM-TABLE(2) NOT = 1
154070         GO TO V899-EXIT.
154080     IF  WA-INPUT-PARAM-TABLE(24) = 1
154090         GO TO V899-EXIT.
154100     IF  STRT-AREA-EFT-TXN
154110     OR  STRT-BATCH-TRICKLE-TXN
154120         GO TO V899-EXIT.
154130     PERFORM V810-GLDM-SECURITY THRU V819-EXIT.
154140 V899-EXIT.
154150     EXIT.
154160/
154170 V810-GLDM-SECURITY.
154180     MOVE 1 TO UT0450-FUNCTION.
154190     MOVE "GLDM" TO UT0450-DETAILS-TYPE.
154200     CALL "UT0450" USING
154220                         UT0450-CALL-AREA
154230                         STARTAREA
154240                         GLDM-RECORD-AREA.
154250     IF  UT0450-STATUS NOT = 0
154260         MOVE UT0450-STATUS TO WA-OUTPUT-ERR-MSG-NO
154270         MOVE 1 TO WA-MSG-ERR-FLAG.
154280 V819-EXIT.
154290     EXIT.
154300*
154310 V900-GET-SUSPENSE.
154320     MOVE STRT-AREA-TRN-NO TO WA-DUMMY-GL-TRN-NO
154330                              WA-SAVE-ORIG-TRAN.
154340     MOVE WA-INPUT-ACCT-NO TO WA-SAVE-FROM-ACCT.
154350     MOVE 2  TO WA-DUMMY-GL-TRN-NO-2
154360     IF WA-INPUT-PARAM-TABLE (8) = 0
154370         MOVE 0  TO WA-DUMMY-GL-TRN-NO-3
154380     ELSE
154390         MOVE 5  TO WA-DUMMY-GL-TRN-NO-3.
154400     MOVE 23 TO WA-DUMMY-GL-LST-TWO.
154420     MOVE STRT-AREA-BRANCH     TO WA-SUSP-BRANCH.
154430     MOVE WS-SAVE-TXN-CURRENCY TO WA-SUSP-TYPE-CURRENCY.
154440*
154450     IF  (WA-ADV-1ST-BYTE = "#" AND WA-DUMMY-LST-TWO = 80)
154460         MOVE WA-SUSP-KEY-BULKCHQ TO WA-SUSP-TYPE-ID
154470     ELSE
154480     IF  (STRT-AREA-BATCH-TANDEM = "B") AND
154490         (WA-DUMMY-LST-TWO = 80 OR 81)
154500         MOVE WA-SUSP-KEY-BILLCHQ TO WA-SUSP-TYPE-ID
154510     ELSE
154520         MOVE WA-SUSP-KEY-CASHIER TO WA-SUSP-TYPE-ID.
154530     IF WA-SUSP-KEY NOT = SUSP-KEY
154540         PERFORM V910-READ-SUSPENSE-MASTER THRU V919-EXIT
154550         IF WA-MSG-ERR-FLAG = 1
154560             MOVE LOW-VALUES TO SUSP-KEY.
154570 V999-EXIT.
154580     EXIT.
154590*
154600 V910-READ-SUSPENSE-MASTER.
154610     MOVE STRT-AREA-SOC-NO TO WA-SUSP-INST.
154620     MOVE SPACE TO WA-SUSP-TYPE-FILLER.
154630*    MOVE 71 TO ST-DBIO-CALL-CODE.
154640     MOVE 71 TO DBIO-CALL-FUNC.                                          
154650     CALL "DBIO" USING
154670                       DBIO-CALL-PARAM
154680                       WA-SUSP-SYSTEM
154690                       WA-SUSP-KEY
154700                       WA-SUSP-STATUS
154710                       SUSP-RECORD-AREA.
154720     IF  WA-SUSP-STATUS NOT = "****"
154730         MOVE 551 TO WA-OUTPUT-ERR-MSG-NO
154740         MOVE 1 TO WA-MSG-ERR-FLAG
154750         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
154760         MOVE SPACES TO UT8500CA-INPUT-MSG
154770         STRING "BR0000:(V910) READ ERROR 'SUSP', KEY-AC"
154780                 WA-SUSP-KEY ", STAT-AC" WA-SUSP-STATUS
154790         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
154800         CALL "UT8500" USING
154820                             UT8500CA-AREA.
154830 V919-EXIT.
154840      EXIT.
154860 W000-PROCESS-SUSP.
154880     MOVE 0                           TO WA-DUP-COUNT
154890                                         ST-STATUS-LEVEL-1.
154900     MOVE SPACES                      TO DBIO-01-KEY
154910     MOVE WA-INPUT-ACCT-NO            TO DBIO-01-ACCT-NO.
154930     PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT.
154950     IF  WA-MSG-ERR-FLAG = 1
154960         GO TO W099-EXIT.
154970*
154980 W010-SET-INPUT-MESSAGE.
155000     MOVE SPACES                      TO WA-GL-TXN-AREA.
155010     MOVE WA-INPUT-KEY-R              TO WA-GL-ACCT-NO.
155030     IF STRT-AREA-EFT-TXN
155040*       ADD 20000                     TO STRT-AREA-TRN-NO
155050        ADD 10000                     TO STRT-AREA-TRN-NO
155060        GO TO W010-CONTINUE.
155080     IF WA-INPUT-PARAM-TABLE(4) = 1
155090        IF WA-INPUT-PARAM-TABLE(7) NOT = 1
155100           MOVE 26030                 TO STRT-AREA-TRN-NO
155110        ELSE
155120           MOVE 26050                 TO STRT-AREA-TRN-NO.
155140     IF WA-INPUT-PARAM-TABLE(5) = 1
155150        IF WA-INPUT-PARAM-TABLE(7) NOT = 1
155160           MOVE 26050                 TO STRT-AREA-TRN-NO
155170        ELSE
155180           MOVE 26030                 TO STRT-AREA-TRN-NO.
155200     IF WA-INPUT-PARAM-TABLE(7) = 1
155210           MOVE WA-MULTI-CORR-JRNL-NO TO WA-GL-CORR-JRNL-NO.
155230     IF WA-INPUT-PARAM-TABLE(8) = 1
155240        IF WA-INPUT-PARAM-TABLE(4) = 1
155250           MOVE WA-REPAY-TXN-DATE     TO WA-GL-TXN-DATE
155260        ELSE
155270           MOVE WA-ADV-TXN-DATE       TO WA-GL-TXN-DATE
155280     ELSE
155290        MOVE STRT-AREA-POST-DT        TO UT0020-BINARY-DATE
155300        MOVE 1                        TO UT0020-FUNCTION
155320        CALL "UT0020" USING
155340                                         UT0020-FUNCTION
155350                                         UT0020-DATE-AREA
155360                                         UT0020-BINARY-DATE
155380        MOVE UT0020-DATE-DDMMCCYY     TO WA-GL-TXN-DATE.
155400 W010-CONTINUE.
155420     MOVE STRT-AREA-TRN-NO            TO LINK-IN-TXCODE.
155440     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
155460     IF  WA-MSG-ERR-FLAG = 1
155470         GO TO W099-EXIT.
155490     MOVE 3                           TO GL-TRANS-IND.
155500     MOVE "0"                         TO GL-DONT-WRITE-GLDM-IND.
155510     MOVE SPACES                      TO WA-GL-DESC
155520                                         WA-GL-NAME-1
155530                                         WA-GL-NAME-2
155540                                         WA-GL-PROMO-NO.
155550     MOVE 0                           TO WA-GL-CHQ-NO
155560                                         WA-GL-CHQ-TYPE
155570                                         WA-GL-VALUE-DATE
155580                                         WA-GL-MSG-TYPE.
155600     IF CHECK-RESPONSE-SUSP-FLAG = "I"
155610         MOVE WA-MULTI-CURR-AMT       TO WA-GL-AMOUNT
155620         MOVE WA-INPUT-AMT            TO WA-GL-SUSP-DESC-CURR-AMT
155630         IF  WA-MULTI-ACCT-CURR-CD = SPACES OR SOC-NATIVE-CURRENCY
155640             MOVE SOC-NATIVE-CURRENCY TO WA-GL-SUSP-DESC-CURRENCY
155650         ELSE
155660       MOVE WA-MULTI-ACCT-CURR-CD     TO WA-GL-SUSP-DESC-CURRENCY
155670     ELSE
155680         MOVE WA-INPUT-AMT            TO WA-GL-AMOUNT
155690         MOVE WA-MULTI-CURR-AMT       TO WA-GL-SUSP-DESC-CURR-AMT
155700         IF  WA-MULTI-CURR-AMT-CURR-CD = SPACES OR
155710                                       SOC-NATIVE-CURRENCY
155720             MOVE SOC-NATIVE-CURRENCY TO WA-GL-SUSP-DESC-CURRENCY
155730         ELSE
155740             MOVE WA-MULTI-CURR-AMT-CURR-CD TO
155750                  WA-GL-SUSP-DESC-CURRENCY.
155770     MOVE WA-SUSP-TYPE-CURRENCY       TO WA-GL-CURRENCY.
155780     MOVE WA-SUSP-ACCT-NO             TO UT0151CA-ACCT-IN.
155790     MOVE 2                           TO UT0151CA-CALL-FUNC.
155800     MOVE SOC-ACCT-NO-FORMAT          TO UT0151CA-FORMAT.
155810     MOVE SOC-CHK-DGT            TO
155820                                 UT0151CA-CHK-DGT-TYPE.
155840     CALL "UT0151" USING
155850                                         UT0151CA-CALL-AREA.
155870     IF UT0151CA-STATUS NOT = 0
155880        MOVE 1                        TO WA-MSG-ERR-FLAG
155890        GO TO W099-EXIT.
155910     MOVE UT0151CA-ACCT-EX            TO WA-GL-SUSP-DESC-ACCT-NO.
155920     MOVE CHECK-RESPONSE-ERR-NO       TO WA-GL-SUSP-DESC-ERR-NO.
155940     IF  WA-INPUT-PARAM-TABLE(4) = "1"
155950         MOVE WA-REPAY-CLEAR-CODE     TO WA-GL-NON-VALUE-DAYS
155960         MOVE 0                       TO WA-GL-DEBIT-DEFER-DAYS
155970         IF WA-REPAY-DEFER-DAYS NUMERIC
155980            MOVE WA-REPAY-DEFER-DAYS  TO WA-GL-DEFER-DAYS
155990         ELSE
156000            MOVE 0                    TO WA-GL-DEFER-DAYS.
156020     IF  WA-INPUT-PARAM-TABLE(5) = "1"
156030         MOVE SPACES                  TO WA-GL-NON-VALUE-DAYS
156040         MOVE 0                       TO WA-GL-DEBIT-DEFER-DAYS
156050                                         WA-GL-DEFER-DAYS.
156070     IF STRT-AREA-ADVICE
156080         MOVE 1                       TO WA-GL-RJCT-IND.
156100     MOVE WA-IN-NARR-TEXT             TO WA-NARR-TEXT.
156110     MOVE WA-IN-SOURCE-APPLN          TO WA-SOURCE-APPLN.
156120     MOVE WA-GL-TXN-AREA              TO WA-INPUT-MSG.
156130*
156140     IF  WA-INPUT-PARAM-TABLE(4) = "1"
156150         CALL "GL0023" USING
156170                                         STARTAREA
156180                                         GL-PASSALONG
156190                                         MULTI-OVERRIDE-AREA
156200                                         W300-ERROR-AREA
156210                                         CHECK-RESPONSE-AREA
TB0137                                         UTVTACCA-CALL-PARAM
156220     ELSE
156230         IF WA-INPUT-PARAM-TABLE(5) = "1"
156240             CALL "GL0024" USING
156260                                         STARTAREA
156270                                         GL-PASSALONG
156280                                         MULTI-OVERRIDE-AREA
156290                                         W300-ERROR-AREA
156300                                         CHECK-RESPONSE-AREA.
156320     IF (ST-STATUS-LEVEL-1 = ZERO) AND STRT-AREA-ADVICE
156330         MOVE 994                     TO WA-OUTPUT-ERR-MSG-NO
156340         MOVE WA-REJECT-MSG           TO WA-OUTPUT-LIMIT-MSG
156350         MOVE 40                      TO WA-OUTPUT-MSG-LENGTH
156360         PERFORM E100-FMT-SEND-PARA THRU E199-EXIT.
156380     IF ST-STATUS-LEVEL-1 NOT = ZERO
156390        MOVE 1                        TO WA-MSG-ERR-FLAG.
156400*
156410*** GLDM REWRITE IS DONE WITHIN GL0023/24 PRIOR TO EXIT PROGRAM
156420*
156430 W099-EXIT.
156440     EXIT.
156450/
NR2001*156460 W100-READ-STOP-HOLD-TRAN.
NR2001*156470     MOVE 0 TO DBIO-CALL-REFER-AREA.
NR2001*NR0050     MOVE SPACES TO DBIO-CALL-SAVE-REFER.
NR2001*156480     MOVE "BOR" TO DBIO-CALL-SYS-AREA.
NR2001*156490     MOVE STRT-AREA-SOC-NO TO WA-BORM-SOC-NO.
NR2001*156500     MOVE WA-INPUT-KEY TO WA-BORM-ACCT-NO.
NR2001*156510     MOVE WA-BORM-KEY TO DBIO-CALL-KEY-AREA.
NR2001*156520     MOVE 07 TO DBIO-CALL-FUNC.
NR2001*156530 W170-READ-AGAIN.
NR2001*156540     CALL "DBIO" USING
NR2001*
NR2001*156560                       DBIO-CALL-PARAM
NR2001*156570                       DBIO-CALL-SYS-AREA
NR2001*156580                       DBIO-CALL-KEY-AREA
NR2001*156590                       DBIO-CALL-STATUS
NR2001*156600                       BORV-RECORD-AREA
NR2001*156610                       DBIO-CALL-REFER-AREA
NR2001*156620                       DBIO-CALL-TXN-TYPE-AREA.
NR2001*156630     IF DBIO-CALL-STATUS = "****"
NR2001*156640         GO TO W180-CHECK.
NR2001*156650     IF DBIO-CALL-STATUS NOT = "XCOT"
NR2001*156660        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*156670        MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*156680        STRING "BR0000:(W100) PROBLEM WHILE READING BORV "
NR2001*156690                WA-INPUT-KEY
NR2001*156700            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*156710        CALL "UT8500" USING
NR2001*
NR2001*156730                            UT8500CA-AREA
NR2001*156740        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*156750        MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*156760        STRING DBIO-CALL-STATUS
NR2001*156770            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*156780        CALL "UT8500" USING
NR2001*
NR2001*156800                            UT8500CA-AREA.
NR2001*156810     MOVE DBIO-CALL-STATUS TO WA-DB-ERROR.
NR2001*156820     MOVE "BORV" TO WA-DBERR-DATA-SET.
NR2001*156830     MOVE 155 TO WA-OUTPUT-ERR-MSG-NO.
NR2001*156840     MOVE 1 TO WA-MSG-ERR-FLAG.
NR2001*156850     GO TO W199-EXIT.
NR2001*156860 W180-CHECK.
NR2001*156870     IF  DBIO-CALL-TXN-TYPE = 33
NR2001*156880*        IF  BORV-33-STATUS = 0
NR2001*156890         IF  BORV-33-TRN-CODE NOT = 19096
NR2001*156900             GO TO W170-READ-AGAIN.
NR2001*156910 W199-EXIT.
NR2001*156920     EXIT.
NR2001 W100-READ-STOP-HOLD-TRAN.
NR2001     INITIALIZE UTBOCTCA-CALL-AREA.
NR2001     MOVE STRT-AREA-SOC-NO  TO BOCT-INST-NO.
NR2001     MOVE WA-INPUT-KEY      TO BOCT-ACCT-NO.
NR2001     MOVE 0                 TO BOCT-REC-NO.
NR2001     MOVE 999999999         TO BOCT-TRN-DATE.
NR2001     MOVE 1                 TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT TO TRUE.
NR2001 W170-READ-AGAIN.
NR2001     MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO.
NR2001     MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO.
NR2001     MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO.
NR2001     MOVE BOCT-TRN-DATE       TO UTBOCTCA-CALL-DATE.
NR2001     MOVE 1                   TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT   TO TRUE.
NR2001     CALL "UTBOCT"         USING UTBOCTCA-CALL-AREA
NR2001                                 BOCT-RECORD-AREA.
NR2001     IF UTBOCTCA-OK
NR2001        IF BOCT-TRAN-TYPE NOT = WS-BOCT-TRAN-TYPE
NR2001           GO TO W170-READ-AGAIN
NR2001        ELSE
NR2001           GO TO W180-CHECK.
NR2001     IF NOT UTBOCTCA-EOF
NR2001        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001        MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001        STRING "BR0000:(W100) PROBLEM WHILE READING BOCT "
NR2001               ", CALLCODE=" UTBOCTCA-CALL-CODE
NR2001               ", STATUS="   UTBOCTCA-STATUS
NR2001               ", CALLKEY="  UTBOCTCA-CALL-KEY
NR2001            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001        CALL "UT8500" USING
NR2001                            UT8500CA-AREA
NR2001        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001        MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001        STRING UTBOCTCA-STATUS
NR2001            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001        CALL "UT8500" USING
NR2001                            UT8500CA-AREA.
NR2001     MOVE UTBOCTCA-STATUS TO WA-DB-ERROR.
NR2001     MOVE "BOCT" TO WA-DBERR-DATA-SET.
NR2001     MOVE 155 TO WA-OUTPUT-ERR-MSG-NO.
NR2001     MOVE 1 TO WA-MSG-ERR-FLAG.
NR2001     GO TO W199-EXIT.
NR2001 W180-CHECK.
NR2001     IF  BOCT-TRAN-TYPE = 33
NR2001         IF  BOCT-TRN-CODE NOT = 19096
NR2001             GO TO W170-READ-AGAIN.
NR2001 W199-EXIT.
NR2001     EXIT.
156930/
156940***  THIS ROUTINE FINDS THE CURRENT MONTH'S DATE  ***
156950**
156960*
156970 W200-FIND-DATE-FILE.
156980     SET DATE-1 TO 1.
156990     SEARCH W100-DATE-TAB AT END
157000            MOVE 1 TO WA-MSG-ERR-FLAG
157010            MOVE 126 TO WA-OUTPUT-ERR-MSG-NO
157020            GO TO W299-EXIT
157030     WHEN (W100-DATE-MMYYYY (DATE-1) = WA-DATE-FILE-KEY)
157040          MOVE W100-DATE-BOM (DATE-1) TO WA-WORK-FIELD
157050          MOVE W100-NO-DAYS-MTH(DATE-1) TO WA-DAYS-IN-MNTH
157060     END-SEARCH.
157070 W299-EXIT.
157080     EXIT.
157090/
157100 W300-READ-BRHM.
157110     MOVE 2 TO UTBRHMCA-CALL-CODE.
157120     MOVE STRT-AREA-SOC-NO TO UTBRHMCA-SOC-NO.
157130     MOVE STRT-AREA-BRANCH TO UTBRHMCA-BRCH-NO.
157140     IF WA-HOME-BR = "Y"
157150        MOVE WA-STORE-HME-BRH TO UTBRHMCA-BRCH-NO.
157160     CALL "UTBRHM" USING
157170                        UTBRHMCA-CALL-AREA
157180                        UTBRHMRA-CALL-AREA.
157190     IF UTBRHMCA-STATUS NOT = 0
157200        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
157210        MOVE SPACES TO UT8500CA-INPUT-MSG
157220        STRING "BR0000:(W300) UTBRHM SEARCH ERROR"
157230            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
157240        CALL "UT8500" USING
157260                            UT8500CA-AREA
157270        MOVE 1 TO WA-MSG-ERR-FLAG
157280        MOVE 206 TO WA-OUTPUT-ERR-MSG-NO.
157290 W399-EXIT.
157300     EXIT.
S12060 W400-BRHM-BSB.
S12060     MOVE SPACES                 TO WA-BRHM-BSB.
S12060     MOVE "Y"                    TO WA-HOME-BR.
S12060     MOVE STRT-AREA-BRANCH       TO WA-STORE-HME-BRH.
S12060     PERFORM W300-READ-BRHM      THRU W399-EXIT.
S12060     MOVE "N"                    TO WA-HOME-BR
S12060     IF  WA-MSG-ERR-FLAG  =  1
S12060             MOVE 526  TO WA-OUTPUT-ERR-MSG-NO
S12060             MOVE 01   TO WA-MSG-ERR-FLAG
S12060     ELSE
S12060         MOVE UTBRHMRA-BSB  TO WA-BRHM-BSB
S12060     END-IF.
S12060 W499-EXIT.
S12060     EXIT.
157310/
157320**********************************************************
157330***   CALL "DBIO" TO ADD THE TRANSACTION              ****
157340**********************************************************
NR2001*157350 W500-ADD-TXN.
NR2001*157360     MOVE 12                     TO DBIO-CALL-FUNC.
NR2001*157370     MOVE "BOR"                  TO DBIO-CALL-SYS-AREA.
NR2001*157380     MOVE STRT-AREA-SOC-NO       TO WA-BORM-SOC-NO.
NR2001*157390     MOVE BORM-MEMB-CUST-AC      TO WA-BORM-ACCT-NO.
NR2001*157400     MOVE WA-BORM-KEY            TO DBIO-CALL-KEY-AREA.
NR2001*157410     MOVE SPACES                 TO DBIO-CALL-STATUS.
NR2001*157420     MOVE 0                      TO DBIO-CALL-REFER-AREA.
NR2001*157430     CALL "DBIO" USING
NR2001*
NR2001*157450
NR2001*157460                                 DBIO-CALL-PARAM
NR2001*157470                                 DBIO-CALL-SYS-AREA
NR2001*157480                                 DBIO-CALL-KEY-AREA
NR2001*157490                                 DBIO-CALL-STATUS
NR2001*157500                                 BORV-RECORD-AREA
NR2001*157510                                 DBIO-CALL-REFER-AREA.
NR2001*157520     IF  DBIO-CALL-STATUS NOT = "****"
NR2001*157530         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*157540         MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*157550         STRING "BR0000:(W500) PROBLEM WHILE ADDING TXN"
NR2001*157560                 DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
NR2001*157570             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*157580         CALL "UT8500" USING
NR2001*
NR2001*157600                             UT8500CA-AREA
NR2001*157610         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
NR2001*157620         MOVE "BORM" TO WA-DBERR-DATA-SET
NR2001*157630         MOVE 155                 TO WA-OUTPUT-ERR-MSG-NO
NR2001*157640         MOVE 1 TO WA-MSG-ERR-FLAG
NR2001*157650         GO TO W599-EXIT.
NR2001*157660*
NR2001*157670*** IF A FINANCIAL TXN CHANGED ACCOUNT BALANCE, THEN CALL MI0095 T 
NR2001*157680*** POPULATE REFRESH TXN TABLE.
NR2001*157690*
NR2001*157700         IF WA-INPUT-PARAM-TABLE (23) = 1                                
NR2001*157710         OR NOT BORV-FINANCIAL-TRANSACTION
NR2001*157720         OR STRT-AREA-TRN-NO = 10029
NR2001*157730            GO TO W599-EXIT.
NR2001*157740         PERFORM M1100-CAP-TXN-DTLS THRU M1199-EXIT.
NR2001*157750*
NR2001*157760 W599-EXIT.
NR2001*157770     EXIT.
NR2001 W500-ADD-TXN.
NR2001     INITIALIZE UTBOCTCA-CALL-AREA.
NR2001     MOVE STRT-AREA-SOC-NO     TO UTBOCTCA-INST-NO.
NR2001     MOVE BORM-MEMB-CUST-AC    TO UTBOCTCA-ACCT-NO.
NR2001     SET  UTBOCTCA-WRITE       TO TRUE.
NR2001     CALL "UTBOCT" USING UTBOCTCA-CALL-AREA
NR2001                         BOCT-RECORD-AREA.
NR2001     IF  NOT UTBOCTCA-OK
NR2001         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001         MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001         STRING "BR0000:(W500) PROBLEM WHILE ADDING TXN"
NR2001                ", CALLCODE=" UTBOCTCA-CALL-CODE
NR2001                ", STATUS="   UTBOCTCA-STATUS
NR2001                ", CALLKEY="  UTBOCTCA-CALL-KEY
NR2001             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001         CALL "UT8500" USING
NR2001                             UT8500CA-AREA
NR2001         MOVE UTBOCTCA-STATUS TO WA-DB-ERROR
NR2001         MOVE "BORM" TO WA-DBERR-DATA-SET
NR2001         MOVE 155                 TO WA-OUTPUT-ERR-MSG-NO
NR2001         MOVE 1 TO WA-MSG-ERR-FLAG
NR2001         GO TO W599-EXIT.
NR2001*
NR2001*** IF A FINANCIAL TXN CHANGED ACCOUNT BALANCE, THEN CALL MI0095 T 
NR2001*** POPULATE REFRESH TXN TABLE.
NR2001*
NR2001         IF WA-INPUT-PARAM-TABLE (23) = 1                                
NR2001         OR NOT BOCT-FINANCIAL-TRANSACTION
NR2001         OR STRT-AREA-TRN-NO = 10029
NR2001            GO TO W599-EXIT.
NR2001         PERFORM M1100-CAP-TXN-DTLS THRU M1199-EXIT.
NR2001*
NR2001 W599-EXIT.
NR2001     EXIT.
157780/
157790**********************************************************
157800*** CALL "DBIO" TO WRITE THE MASTER HEADER     ***********
157810**********************************************************
157820 W600-REWRITE-MASTER.
SC8912*    IF BORP-YOUBE
SC8912*       IF WA-ACCT-BAL-BEF-TXN < 0 AND
SC8912*          BORM-LOAN-BAL < 0
SC8912*          MOVE WA-SOUR-GL-CLASS-CODE TO
SC8912*                        BORM-GL-CLASSIFICATION-CODE
SC8912*       END-IF
SC8912*    END-IF.
S11409     MOVE BORM-ACT-TYPE TO WA-BORM-ACT-TYPE.
SC9872     IF  BORP-YOUBE                                            
S11301*SC9872     AND WA-INPUT-PARAM-TABLE(5) = 1
S11301     AND (WA-INPUT-PARAM-TABLE(5) = 1
S16661      OR (BOIS-REC-MIN-DUE-IND = "T" OR "Y")
S11301      OR (WA-INPUT-PARAM-TABLE(4) = 1
S11409*S11301     AND  BORP-FINE-METH = 14
S11409     AND (BORP-FINE-METH = 14 OR WA-ACT-TYPE-B-YB)
S11301     AND  BOIS-ACCOUNT-LIMIT > 0)
S11351      OR (STRT-AREA-TRN-NO = 17038
S11409*S11351     AND  BORP-FINE-METH = 14
S11409     AND (BORP-FINE-METH = 14 OR WA-ACT-TYPE-B-YB)
S11351     AND  BOIS-ACCOUNT-LIMIT > 0))
SC9872        PERFORM Z100-CALCULATE-MIN-DUE-AMT THRU Z109-EXIT      
SC9872        MOVE WA-MIN-DUE-AMT TO BOIS-MIN-DUE-AMOUNT             
S16661        IF BOIS-REC-MIN-DUE-IND = "T"
S16661           MOVE " "         TO BOIS-REC-MIN-DUE-IND
S16661        END-IF
SC9872     END-IF.                                                   
S17755     IF  BORP-ILOAN-R
S17755     AND BORM-BAD-DEBT-IND(2:1)   < 1
S17755     AND (WA-INPUT-PARAM-TABLE(5) = 1
S17755      OR  WA-INPUT-PARAM-TABLE(4) = 1)
S17755        MOVE 0              TO WA-MIN-DUE-AMT
S17755        PERFORM Z100-CALCULATE-MIN-DUE-AMT THRU Z109-EXIT
S17755        MOVE WA-MIN-DUE-AMT TO BOIS-MIN-DUE-AMOUNT
S17755                               BORM-DUE-AMT
S17755     END-IF.
S16661     MOVE 0 TO WA-INT-ACCR-R WA-INT-TOTAL.
S16661     IF  BORP-YOUBE
S16661     AND BOIS-REC-MIN-DUE-IND = "Y"
S16661         IF BOIS-LAST-UNPAID-DUE-DATE >  STRT-AREA-POST-DT
S16661            COMPUTE WA-INT-ACCR-R = (BORM-LOAN-BAL *
S16661            (BORM-INT-RATE / 100) / BORP-INT-DAYS-YR) *
S16661            (BOIS-LAST-UNPAID-DUE-DATE - STRT-AREA-POST-DT)
S16661         END-IF
S16661         COMPUTE WA-INT-TOTAL ROUNDED = BORM-INT-ACCR
S16661                                      + BORM-INT-ADJUSTMENT
S16661                                      + WA-INT-ACCR-R
S16661         IF WA-INT-TOTAL > BOIS-MIN-DUE-AMOUNT
S16661            MOVE WA-INT-TOTAL TO BOIS-MIN-DUE-AMOUNT
S16661         END-IF
S16661     END-IF.
S16661     IF  BOIS-REC-MIN-DUE-IND = "T" OR "Y"
S16661         NEXT SENTENCE
S16661     ELSE
157830     IF  STRT-AREA-TRN-NO = 17451 OR
157840*SC2263                    17003 OR 17029 OR
SC2263                           17029 OR
157850                           17004 OR 17005 OR 17006 OR 17007 OR
157860                           17008 OR 17009 OR 17010 OR 12000 OR
157870                           12001 OR 12002 OR 17000 OR 17001 OR
157880                           17002 OR 10490 OR 17013 OR 17014 OR
157890                           17016 OR 17017 OR 17027 OR
157900                           17018 OR 17019 OR 17020 OR 17021 OR
SC1605*                          17022 OR 17023 OR 17024 OR 17025
SC1605                                    17023 OR 17024 OR 17025
TB0069** SC3865                        OR 17026
TB0169                        OR 12006 OR 12007 OR 12008
S11351*TB0169                 OR 17036 OR 17037 OR 17038
S11351                        OR 17036 OR 17037
S11351                        OR (STRT-AREA-TRN-NO = 17038
S11417*S11351                 AND BORP-FINE-METH  <> 14)
S11417                        AND (BORP-FINE-METH <> 14 
A11417                        AND NOT WA-ACT-TYPE-B-YB))
S11351                        OR (STRT-AREA-TRN-NO = 17038
S11417*S11351                 AND BORP-FINE-METH   = 14
S11417                        AND (BORP-FINE-METH = 14 
S11417                        OR  WA-ACT-TYPE-B-YB)
S11351                        AND BOIS-ACCOUNT-LIMIT = 0)
SC1605                        OR (STRT-AREA-TRN-NO = 17022
S15871                        AND (NOT BOIS-AGREE-FUNC-USE))
S15871*SC1605                        AND BOIS-AGREE-IND NOT = 2)
SC3865                        OR (STRT-AREA-TRN-NO = 17026
SC3865                        AND (BOIS-NEGO-RATE-IND NOT = 2
SC3865                        OR WA-UPDATE-INT-INCR = "N"))  
SC5708                        OR ((STRT-AREA-TRN-NO = 17000 OR 17036)
SC5708                        AND BORM-STAT = 40)
157920         GO TO W699-EXIT.
157930     MOVE 32                     TO DBIO-CALL-FUNC.
157940     MOVE "BOR"                  TO DBIO-CALL-SYS-AREA.
157950     MOVE STRT-AREA-SOC-NO       TO WA-BORM-SOC-NO.
157960     MOVE BORM-MEMB-CUST-AC      TO WA-BORM-ACCT-NO.
157970     MOVE WA-BORM-KEY            TO DBIO-CALL-KEY-AREA.
157980     MOVE SPACES                 TO DBIO-CALL-STATUS.
157990     CALL "DBIO" USING
158010
158020                                 DBIO-CALL-PARAM
158030                                 DBIO-CALL-SYS-AREA
158040                                 DBIO-CALL-KEY-AREA
158050                                 DBIO-CALL-STATUS
158060                                 BORM-RECORD-AREA.
158070     IF  DBIO-CALL-STATUS NOT = "****"
158080         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
158090         MOVE SPACES TO UT8500CA-INPUT-MSG
158100         STRING "BR0000:(W600) PROBLEM WHILE REWRITING BORM "
158110                  DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
158120             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
158130         CALL "UT8500" USING
158150                             UT8500CA-AREA
158160         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
158170         MOVE "BORM" TO WA-DBERR-DATA-SET
158180         MOVE 155                 TO WA-OUTPUT-ERR-MSG-NO
158190         MOVE 1 TO WA-MSG-ERR-FLAG
158200         GO TO W699-EXIT.
SC2272*--------------------------------------------------
SC2272* First draw down update bois first advance date *
SC2272*-------------------------------------------------
S11577*SC2272    IF  STRT-AREA-TRN-NO = 11060 OR 16060 OR 11055 OR 11057
S11577*SC2272                         OR 16060 OR 16055 OR 16057
S11577*CS7091                         OR 14060
S11577*SC7091                         OR 19060
S11577*S10003                         OR 14050 OR 14055 OR 14062    
S11577*S10003                         OR 19050 OR 19055 OR 19062    
S11577*S11542                         OR 11068 OR 16068 OR 11069
S11577*S11542                         OR 16069
S11577     IF (WA-INPUT-PARAM-TABLE(5) = 1
S11577     AND WA-INPUT-PARAM-TABLE(7) = 0)
SC2272         IF BOIS-FIRST-ADV-DATE = 0
SC2272            MOVE BORM-ADV-DATE    TO BOIS-FIRST-ADV-DATE
SC2272         END-IF
SC2272     END-IF
TB0027 
S10614*
S10614*S15187 IF (STRT-AREA-TRN-NO = 19093 OR 19095 OR 11740 OR 11741)
S15187     IF STRT-AREA-TRN-NO = 19093 OR 19095 OR 11740 OR 11741
S15187                        OR 11742
S10614         GO TO W699-EXIT
S10614     END-IF.
S10614*
TB0027     MOVE "REWRITE" TO DBIOMOD-FUNCTION.
TB0027     PERFORM B5100-ACCESS-BOIS THRU B5199-EXIT.
TB0027     IF  DBIOMOD-STAT NOT = "****"
TB0027         GO TO W699-EXIT.
TB0027 
158210*        IF BORM-LOC-IND = 1                                       ***TB0027
TB0027     IF BORM-LOC-IND = 1
158220            PERFORM Z3000-RETRIEVE-BBLC THRU Z3099-EXIT
158230            IF WA-MSG-ERR-FLAG = 1
158240               GO TO W699-EXIT
158250            END-IF
158260         ELSE
158270         IF BORM-LOC-IND = 0
158280            MOVE ZEROS                   TO BBLC-LOC-ACCT-NO
158290                                            BBLC-LOC-DT
158300            MOVE SPACES                  TO BBLC-LOC-ID-DOC
158310                                            BBLC-LOC-ID-NO
158320         END-IF
158330     IF (WA-INPUT-PARAM-TABLE(25) = 1)
158340*    AND (BORM-LOC-DATE NOT = ZEROES)
158350*    AND (BORM-LOC-ACC NOT = 0)
158360     AND (BBLC-LOC-DT NOT = ZEROES)
158370     AND (BBLC-LOC-ACCT-NO NOT = 0)
158380         PERFORM W970-SET-PRIM-LOC-ACC THRU W979-EXIT.
158390 W699-EXIT.
158400     EXIT.
158410/
158420*
158430***  760503
158440*
158450**********************************************************
158460*** CALL "DBIO" TO WRITE THE MASTER HEADER     ***********
158470**********************************************************
158480*
158490 W700-REWRITE-MASTER.
158500*
158510     MOVE 32                     TO DBIO-CALL-FUNC.
158520     MOVE "BOR"                  TO DBIO-CALL-SYS-AREA.
158530     MOVE STRT-AREA-SOC-NO       TO WA-BORM-SOC-NO.
158540     MOVE BORM-MEMB-CUST-AC      TO WA-BORM-ACCT-NO.
158550     MOVE WA-BORM-KEY            TO DBIO-CALL-KEY-AREA.
158560     MOVE SPACES                 TO DBIO-CALL-STATUS.
158570*
158580     CALL "DBIO" USING           DBIO-CALL-PARAM
158590                                 DBIO-CALL-SYS-AREA
158600                                 DBIO-CALL-KEY-AREA
158610                                 DBIO-CALL-STATUS
158620                                 BORM-RECORD-AREA.
158630*
158640     IF  DBIO-CALL-STATUS NOT = "****"
158650         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
158660         MOVE SPACES TO UT8500CA-INPUT-MSG
158670         STRING "BR0000:(W700) PROBLEM WHILE REWRITING BORM "
158680                  DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
158690             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
158700         CALL "UT8500" USING UT8500CA-AREA
158710         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
158720         MOVE "BORM" TO WA-DBERR-DATA-SET
158730         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
158740         MOVE 1 TO WA-MSG-ERR-FLAG
158750         GO TO W799-EXIT.
158760*
158770     IF BORM-LOC-IND = 1
158780        PERFORM Z3000-RETRIEVE-BBLC THRU Z3099-EXIT
158790        IF WA-MSG-ERR-FLAG = 1
158800           GO TO W799-EXIT
158810        END-IF
158820     ELSE
158830        IF BORM-LOC-IND = 0
158840           MOVE ZEROS TO BBLC-LOC-ACCT-NO
158850                         BBLC-LOC-DT
158860           MOVE SPACES TO BBLC-LOC-ID-DOC
158870                          BBLC-LOC-ID-NO
158880        END-IF
158890        IF (WA-INPUT-PARAM-TABLE(25) = 1)
158900        AND (BBLC-LOC-DT NOT = ZEROES)
158910        AND (BBLC-LOC-ACCT-NO NOT = 0)
158920            PERFORM W970-SET-PRIM-LOC-ACC THRU W979-EXIT.
158930*
158940 W799-EXIT.
158950     EXIT.
158960/
158970 W750-READ-BLDVUU.
158980     MOVE 61 TO DBIO-CALL-FUNC.
158990     MOVE "BORM" TO DBIO-CALL-N-SYS.
159000     MOVE "BLDV" TO DBIO-CALL-SYST-VAR.
159010     MOVE WA-INPUT-ACCT-NO TO WA-BORM-ACCT-NO.
159020     MOVE STRT-AREA-SOC-NO TO WA-BORM-SOC-NO.
159030     MOVE WA-BORM-KEY TO DBIO-CALL-KEY-AREA.
159040     MOVE SPACES TO DBIO-CALL-STATUS.
159050     CALL "DBIO" USING
159070                       DBIO-CALL-PARAM
159080                       DBIO-CALL-SYS-AREA
159090                       DBIO-CALL-KEY-AREA
159100                       DBIO-CALL-STATUS
159110                       WA-BLDV-AREA-UU
159120                       DBIO-CALL-REFER-AREA
159130                       DBIO-CALL-TXN-TYPE-AREA.
159140     IF  DBIO-CALL-STATUS  NOT = "****"
159150         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
159160         MOVE SPACES TO UT8500CA-INPUT-MSG
159170         STRING "BR0000:(W750) PROBLEM WHILE READING BLDV UU "
159180                  DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
159190             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
159200         CALL "UT8500" USING
159220                             UT8500CA-AREA
159230         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
159240         MOVE "BLDV" TO WA-DBERR-DATA-SET
159250         MOVE 155                 TO WA-OUTPUT-ERR-MSG-NO
159260         MOVE 1 TO WA-MSG-ERR-FLAG.
159270 W759-EXIT.
159280     EXIT.
159290/
159300 W800-READ-ACFR.
159310     MOVE SPACE TO WA-NO-FACILITY-FLAG.
159320     INITIALIZE ACFR-KEY.
159330     MOVE STRT-AREA-SOC-NO  TO ACFR-SOC-NO.
159340     MOVE "BOR"             TO ACFR-SYSTEM.
159350     MOVE BORM-MEMB-CUST-AC TO ACFR-ACCT-NO.
159360     MOVE 71                TO DBIO-CALL-FUNC.
159370     MOVE ACFR-KEY          TO DBIO-CALL-KEY-AREA.
159380     MOVE "ACFR    "        TO DBIO-CALL-SYS-AREA.
159390     MOVE SPACES            TO DBIO-CALL-STATUS.
159400     CALL "DBIO" USING
159420                       DBIO-CALL-PARAM
159430                       DBIO-CALL-SYS-AREA
159440                       DBIO-CALL-KEY-AREA
159450                       DBIO-CALL-STATUS
159460                       ACFR-AREA
159470                       DBIO-CALL-REFER-AREA.
159480     IF DBIO-CALL-STATUS  = "MRNF"
159490        MOVE "Y" TO WA-NO-FACILITY-FLAG
159500        GO TO W899-EXIT.
159510     IF DBIO-CALL-STATUS NOT = "****"
159520        MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
159530        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
159540        MOVE SPACES TO UT8500CA-INPUT-MSG
159550        STRING "BR0000:(W800) 'ACFR' READ ERROR, STAT- "
159560                DBIO-CALL-STATUS ", KEY- "
159570                DBIO-CALL-KEY-AREA
159580            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
159590        CALL "UT8500" USING
159600                            UT8500CA-AREA
159610        MOVE 1 TO WA-MSG-ERR-FLAG
159620        GO TO W899-EXIT
159630     END-IF.
159640 W899-EXIT.
159650     EXIT.
159670 W940-AMEND-BLDVMM.
159680     MOVE "BORM" TO DBIO-CALL-N-SYS.
159690     MOVE "BLDV" TO DBIO-CALL-SYST-VAR.
159700     MOVE WA-INPUT-ACCT-NO TO WA-BORM-ACCT-NO.
159710     MOVE STRT-AREA-SOC-NO TO WA-BORM-SOC-NO.
159720     MOVE WA-BORM-KEY TO DBIO-CALL-KEY-AREA.
159730     MOVE SPACES TO DBIO-CALL-STATUS.
159740     CALL "DBIO" USING
159760                       DBIO-CALL-PARAM
159770                       DBIO-CALL-SYS-AREA
159780                       DBIO-CALL-KEY-AREA
159790                       DBIO-CALL-STATUS
159800                       WA-BLDV-AREA-MM
159810                       DBIO-CALL-REFER-AREA
159820                       DBIO-CALL-TXN-TYPE-AREA.
159830     IF  DBIO-CALL-STATUS NOT = "****"
159840         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
159850         MOVE SPACES TO UT8500CA-INPUT-MSG
159860         STRING "BR0000:(W940) PROBLEM WHILE REWRITING BLDV MM "
159870                  DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
159880             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
159890         CALL "UT8500" USING
159910                             UT8500CA-AREA
159920         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
159930         MOVE "BLDV" TO WA-DBERR-DATA-SET
159940         MOVE 155                 TO WA-OUTPUT-ERR-MSG-NO
159950         MOVE 1 TO WA-MSG-ERR-FLAG.
159960 W949-EXIT.
159970     EXIT.
159980/
159990 W950-BCOV.
160000     MOVE SPACES TO DBIO-CALL-STATUS.
160010     MOVE STRT-AREA-SOC-NO TO BCOV-SOCIETY.
160020     MOVE BCOV-KEY TO DBIO-CALL-KEY-AREA.
160030     MOVE "BCON" TO DBIO-CALL-N-SYS.
160040     MOVE "BCOV" TO DBIO-CALL-SYST-VAR.
160050     CALL "DBIO"              USING
160070                                    DBIO-CALL-PARAM
160080                                    DBIO-CALL-SYS-AREA
160090                                    DBIO-CALL-KEY-AREA
160100                                    DBIO-CALL-STATUS
160110                                    BCOV-RECORD-AREA.
160120     IF DBIO-CALL-SAVE-REFER = "END."
160130         GO TO W959-EXIT.
160140     IF NOT (DBIO-CALL-STATUS = "****" OR "MRNF")
160150         MOVE BCOV-SOCIETY         TO WA-BCOV-SOCIETY
160160         MOVE BCOV-CONDITION-NO    TO WA-BCOV-CONDITION-NO
160170         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
160180         MOVE SPACES TO UT8500CA-INPUT-MSG
160190         STRING "BR0000:(W950) ERROR ON CALL CODE "
160200                                      DBIO-CALL-FUNC
160210             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
160220         CALL "UT8500" USING
160240                             UT8500CA-AREA
160250         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
160260         MOVE SPACES TO UT8500CA-INPUT-MSG
160270         STRING  " KEY = " WA-BCOV-KEY " : " DBIO-CALL-STATUS
160280             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
160290         CALL "UT8500" USING
160310                             UT8500CA-AREA
160320         MOVE DBIO-CALL-STATUS          TO WA-DB-ERROR
160330         MOVE "BCOV"               TO WA-DBERR-DATA-SET
160340         MOVE 155                  TO WA-OUTPUT-ERR-MSG-NO
160350         MOVE 1                    TO WA-MSG-ERR-FLAG.
160360 W959-EXIT.
160370     EXIT.
160380/
160390 W960-BCOV-ERROR.
160400     MOVE BCOV-SOCIETY            TO WA-BCOV-SOCIETY.
160410     MOVE BCOV-CONDITION-NO       TO WA-BCOV-CONDITION-NO.
160420     MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
160430     MOVE SPACES TO UT8500CA-INPUT-MSG
160440     STRING "BR0000:(W960) BAD BCOV READ "
160450         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
160460     CALL "UT8500" USING
160480                         UT8500CA-AREA.
160490     MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
160500     MOVE SPACES TO UT8500CA-INPUT-MSG
160510     STRING WA-BCOV-KEY " : " DBIO-CALL-STATUS
160520         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
160530     CALL "UT8500" USING
160550                         UT8500CA-AREA.
160560     MOVE DBIO-CALL-STATUS             TO WA-DB-ERROR.
160570     MOVE "BCOV"                  TO WA-DBERR-DATA-SET.
160580     MOVE 155                     TO WA-OUTPUT-ERR-MSG-NO.
160590     MOVE 1                       TO WA-MSG-ERR-FLAG.
160600 W969-EXIT.
160610     EXIT.
160620/
160630 W970-SET-PRIM-LOC-ACC.
160640     MOVE 01 TO DBIO-CALL-FUNC.
160650     MOVE "BOR" TO DBIO-CALL-SYS-AREA.
160660     MOVE STRT-AREA-SOC-NO TO WA-BORM-SOC-NO.
160670*    MOVE BORM-LOC-ACC TO WA-BORM-ACCT-NO.
160680     MOVE BBLC-LOC-ACCT-NO TO WA-BORM-ACCT-NO.
160690     MOVE WA-BORM-KEY TO DBIO-CALL-KEY-AREA.
160700     CALL "DBIO" USING
160720                       DBIO-CALL-PARAM
160730                       DBIO-CALL-SYS-AREA
160740                       DBIO-CALL-KEY-AREA
160750                       DBIO-CALL-STATUS
160760                       BORM-RECORD-AREA.
160770     IF DBIO-CALL-STATUS NOT = "****"
160780         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
160790         MOVE SPACES TO UT8500CA-INPUT-MSG
160800         STRING "BR0000 (W970): ERROR READING BORM "
160810                 DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
160820             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
160830         CALL "UT8500" USING
160850                             UT8500CA-AREA
160860         MOVE 01 TO WA-MSG-ERR-FLAG
160870         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
160880         MOVE "BORM" TO WA-DBERR-DATA-SET
160890         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
160900         GO TO W979-EXIT.
160910     MOVE 40 TO BORM-STAT.
160920     MOVE 32 TO DBIO-CALL-FUNC.
160930     MOVE "BOR" TO DBIO-CALL-SYS-AREA.
160940     MOVE STRT-AREA-SOC-NO TO WA-BORM-SOC-NO.
160950     MOVE BORM-MEMB-CUST-AC TO WA-BORM-ACCT-NO.
160960     MOVE WA-BORM-KEY TO DBIO-CALL-KEY-AREA.
160970     MOVE SPACES TO DBIO-CALL-STATUS.
160980     CALL "DBIO" USING
161000                       DBIO-CALL-PARAM
161010                       DBIO-CALL-SYS-AREA
161020                       DBIO-CALL-KEY-AREA
161030                       DBIO-CALL-STATUS
161040                       BORM-RECORD-AREA.
161050     IF DBIO-CALL-STATUS NOT = "****"
161060         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
161070         MOVE SPACES TO UT8500CA-INPUT-MSG
161080         STRING "BR0000 (W940): PROBLEM REWRITING BORM "
161090                 DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
161100             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
161110         CALL "UT8500" USING
161130                             UT8500CA-AREA
161140         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
161150         MOVE "BORM" TO WA-DBERR-DATA-SET
161160         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
161170         MOVE 1 TO WA-MSG-ERR-FLAG
161180         GO TO W979-EXIT.
161190     MOVE 01 TO DBIO-CALL-FUNC.
161200*    MOVE BORM-LOC-ACC TO WA-BORM-ACCT-NO.
161210     MOVE BBLC-LOC-ACCT-NO TO WA-BORM-ACCT-NO.
161220     MOVE WA-BORM-KEY TO DBIO-CALL-KEY-AREA.
161230     MOVE SPACES TO DBIO-CALL-STATUS.
161240     CALL "DBIO" USING
161260                       DBIO-CALL-PARAM
161270                       DBIO-CALL-SYS-AREA
161280                       DBIO-CALL-KEY-AREA
161290                       DBIO-CALL-STATUS
161300                       BORM-RECORD-AREA.
161310     IF DBIO-CALL-STATUS NOT = "****"
161320         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
161330         MOVE SPACES TO UT8500CA-INPUT-MSG
161340         STRING "BR0000 (W970): PROBLEM READING BORM "
161350                 DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
161360             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
161370         CALL "UT8500" USING
161390                             UT8500CA-AREA
161400         MOVE 01 TO WA-MSG-ERR-FLAG
161410         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
161420         MOVE "BORM" TO WA-DBERR-DATA-SET
161430         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR.
161440*
161450 W979-EXIT.
161460     EXIT.
161470/
SC0367 X000-VAL-ALL-BR-PSWD.
SC0367*--------------------
SC0367     MOVE STRT-AREA-SOC-NO     TO CUSM-SOC-NO.
SC0367     MOVE WA-DEP-ACCT-NO       TO CUSM-CUST-ACCT-NO.
SC0367     MOVE "CUSM"               TO DBIO-CALL-SYS-AREA.
SC0367     MOVE CUSM-KEY             TO DBIO-CALL-KEY-AREA.
SC0367     MOVE 71 TO DBIO-CALL-FUNC.
SC0367     CALL "DBIO" USING
SC0367                                 DBIO-CALL-PARAM
SC0367                                 DBIO-CALL-SYS-AREA
SC0367                                 DBIO-CALL-KEY-AREA
SC0367                                 DBIO-CALL-STATUS
SC0367                                 CUSM-RECORD-AREA.
SC0367     IF  DBIO-CALL-STATUS NOT = "****"
SC0367         MOVE 282 TO WA-OUTPUT-ERR-MSG-NO
SC0367         MOVE 1 TO WA-MSG-ERR-FLAG
SC0367         GO TO X099-EXIT.
SC0367*
SC4030**   IF BR17467-INP-DEF-SYSTEM = "INV"
SC4030**      MOVE "DEP" TO BR17467-INP-DEF-SYSTEM.
SC0367/
SC0367     IF CUSM-ACCOUNT-SYSTEM NOT = "DEP"
SC0367        GO TO X099-EXIT.
SC0367
SC4030**   IF (STRT-AREA-TRN-NO = 17467 OR 13042)
SC4030**   AND BR17467-INP-DEF-SYSTEM NOT = CUSM-ACCOUNT-SYSTEM
SC4030**   OR (STRT-AREA-TRN-NO = 11045 OR 16045 OR 11044 OR 16044 OR
SC4030**                          13043 OR 15045)
SC4030**   AND CUSM-ACCOUNT-SYSTEM NOT = "DEP"
SC4030**       MOVE 222 TO WA-OUTPUT-ERR-MSG-NO
SC4030**       MOVE 1 TO WA-MSG-ERR-FLAG
SC4030**       GO TO X099-EXIT.
SC0367*
SC0367     MOVE WA-DEP-ACCT-NO  TO INVM-MEMB-CUST-AC.
SC0367     PERFORM B1000-READ-INVM THRU B1999-EXIT.
SC0367     IF WA-MSG-ERR-FLAG = 1
SC0367        GO TO X099-EXIT
SC0367     END-IF
SC0367     MOVE STRT-AREA-SOC-NO TO INVE-SOC-NO.
SC0367     MOVE "READ"          TO DBIOMOD-FUNCTION.
SC0367     PERFORM M003-ACCESS-INVE  THRU M003-EXIT.
SC0367     IF WA-MSG-ERR-FLAG = 1
SC0367        GO TO X099-EXIT.
SC0367
S20175*   CHECK MIMA
SC0367    PERFORM  M007-CALL-UT0200 THRU M007-EXIT.
SC0367    IF WA-MSG-ERR-FLAG = 1
SC0367       GO TO X099-EXIT.
SC0367    PERFORM X720-CALL-UT0251 THRU X729-EXIT.
SC0367    IF  UT0251CA-CALL-STATUS NOT = "****"
SC0367        MOVE 511 TO WA-OUTPUT-ERR-MSG-NO
SC0367        MOVE 1 TO WA-MSG-ERR-FLAG
SC0367        GO TO X099-EXIT.
SC0367/
SC0367    IF UT0251RA-IB-ALLOWED-FLG = "N"
SC0367    AND STRT-AREA-BRANCH NOT = INVM-BRANCH-NO
SC0367        MOVE 1   TO WA-MSG-ERR-FLAG
SC0367        MOVE 749 TO WA-OUTPUT-ERR-MSG-NO
SC0367        GO TO X099-EXIT.
SC0367/
S12383    IF (STRT-AREA-TRN-NO = 11045 OR 13045)
S12383         MOVE 00                 TO UTINODCA-CALL-CODE
S12383         MOVE INVM-SOC-NO        TO UTINODCA-SOC-NO
S12383         MOVE INVM-MEMB-CUST-AC  TO UTINODCA-DEP-NO
S12383         CALL "UTINOD" USING UTINOD-CALL-AREA
S12383                             STARTAREA
S12383                             WA-INVM-RECORD-AREA
S12383         IF UTINODCA-STATUS = 0 OR 1
S12383            MOVE UTINODCA-DATA-REC TO INOD-RECORD-AREA
S12383            IF UTINODCA-STATUS = 0
S12383               MOVE INOD-TOTAL-LIMIT TO WA-OD-LINE-AMT
S12383            ELSE
S12383               MOVE 0 TO WA-OD-LINE-AMT
S12383            END-IF
S12383         END-IF
S12383         COMPUTE WA-DEP-AVAIL-BAL =
S12383                 WA-OD-LINE-AMT +
S12383                 INVM-CURR-BAL    -
S12383                 INVM-HOLD-VAL    -
S12383                 INVM-UNCL-CHQ-VAL
S12383         IF WA-INPUT-AMT > WA-DEP-AVAIL-BAL
S12383              MOVE 266    TO WA-OUTPUT-ERR-MSG-NO
S12383              MOVE 1      TO WA-MSG-ERR-FLAG
S12383              GO TO X099-EXIT
S12383         END-IF
S12383    END-IF.
SC0367    EVALUATE TRUE
SC0367         WHEN ACCT-PARM-BRNH-ACCT-IND = "N"
SC0367              IF STRT-AREA-BRANCH NOT = INVM-BRANCH-NO
SC0367                  MOVE 3583   TO WA-OUTPUT-ERR-MSG-NO
SC0367                  MOVE 1      TO WA-MSG-ERR-FLAG
SC0367                  GO TO X099-EXIT
SC0367               ELSE
SC0367                  IF  INVE-ALL-BR-PSWD-REQ = "Y"
SC0367                      PERFORM X050-VALIDATE-PSWD THRU X050-EXIT
SC0367                  END-IF
SC0367               END-IF
SC0367         WHEN ACCT-PARM-BRNH-ACCT-IND = "Y"
SC0367              IF  INVE-ALL-BR-PSWD-REQ = "Y"
SC0367                  PERFORM X050-VALIDATE-PSWD THRU X050-EXIT
SC0367              END-IF
SC0367     END-EVALUATE.
SC0367*
SC0367 X099-EXIT.
SC0367     EXIT.
SC0367/
SC0367 X050-VALIDATE-PSWD.
SC0367*-------------------
SC0367     IF INVE-ALL-BR-PSWD = SPACES
SC0367        MOVE 3594   TO WA-OUTPUT-ERR-MSG-NO
SC0367        MOVE 1      TO WA-MSG-ERR-FLAG
SC0367        GO TO X050-EXIT.
SC0367
SC0367     MOVE INVE-ALL-BR-CTR TO WA-PSWD-CTR.
SC0367     PERFORM X070-CHK-PSWD-RETRY THRU X070-EXIT.
SC0367     IF WA-MSG-ERR-FLAG = 0
S17003        IF (STRT-AREA-TRN-NO = 11045 )
S17003        AND INVM-CUSTOMER-NO   = BORM-CUSTOMER-NO
S17003        AND STRT-AREA-USER-TYPE = "67"
S17003        AND WA-PSWD-CTR <  SOC-BRNH-PSWD-RET
S17003           GO TO X050-EXIT
S17003        END-IF
S12383        IF (STRT-AREA-TRN-NO = 11045 OR 13045)
S12383        AND INVM-CUSTOMER-NO   = BORM-CUSTOMER-NO
S17003        AND NOT ( STRT-AREA-USER-TYPE = "67")
S17003        AND NOT ( STRT-AREA-USER-TYPE = "02" OR "03"
S17003                                     OR "04" OR "05")
S12383           GO TO X050-EXIT
S12383        END-IF
SC7091*       IF STRT-AREA-TRN-NO = 11045
SC7091        IF STRT-AREA-TRN-NO = 11045 OR 16045
S19927           MOVE DEP-ACCT-PSWD-11045 TO WA-PSWD
SC0367        ELSE
S19927           MOVE WA-DEP-ACCT-PSWD TO WA-PSWD
SC0367        END-IF
S19927        IF WA-PSWD NOT = SPACES
SC0367           CALL "ED0011"   USING
S19927                        WA-PSWD
SC0367           MOVE WA-PSWD-2 TO WS-PSWD-2
SC0367           MOVE WA-PSWD-3 TO WS-PSWD-3
SC0367           MOVE WA-PSWD-1 TO WS-PSWD-1
SC0367           MOVE WA-PSWD-4 TO WS-PSWD-4
SC0367           IF WS-PSWD  = INVE-ALL-BR-PSWD
SC0367              MOVE 0                  TO INVE-ALL-BR-CTR
SC0367              MOVE "REWRITE"          TO DBIOMOD-FUNCTION
SC0367              PERFORM M003-ACCESS-INVE THRU M003-EXIT
SC0367              GO TO                   X050-EXIT
SC0367           END-IF
SC0367        END-IF
SC0367        MOVE INVE-MEMB-CUST-AC  TO UT0060CA-CALL-ACC-NO
SC0367        MOVE 0                  TO WA-MSG-ERR-FLAG
S19927        IF WA-PSWD = SPACES
S17003           AND NOT ( STRT-AREA-USER-TYPE = "67"
S17003                     AND  STRT-AREA-TRN-NO = 11045
S17003                     AND WA-PSWD-CTR >= SOC-BRNH-PSWD-RET)
SC0367           MOVE 1518            TO UT0060CA-CALL-ERROR-CODE
S12532           IF  STRT-AREA-BRANCH = 628
S12532             MOVE 5055          TO UT0060CA-CALL-ERROR-CODE
S12532           END-IF
SC0367        ELSE
S17003           IF  STRT-AREA-USER-TYPE = "67"
S17003               AND  STRT-AREA-TRN-NO = 11045
S17003               AND WA-PSWD-CTR >= SOC-BRNH-PSWD-RET
S17003               MOVE 5340       TO UT0060CA-CALL-ERROR-CODE
S17003           ELSE
S17003               MOVE 3592       TO UT0060CA-CALL-ERROR-CODE
S17003           END-IF
S17003*SC0367    MOVE 3592            TO UT0060CA-CALL-ERROR-CODE
SC0367        END-IF
SC0367        PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
SC0367        IF  WA-MSG-ERR-FLAG = 0
S19927            IF WA-PSWD NOT = SPACES
SC0367               COMPUTE WA-PSWD-CTR = WA-PSWD-CTR - 1
SC0367               MOVE WA-PSWD-CTR      TO INVE-ALL-BR-CTR
SC0367               MOVE "REWRITE"        TO DBIOMOD-FUNCTION
SC0367               PERFORM M003-ACCESS-INVE THRU M003-EXIT
SC0367            END-IF
SC0367        ELSE
SC0367            MOVE 1                   TO WA-MSG-ERR-FLAG
S19927            IF WA-PSWD = SPACES
S17003               AND NOT ( STRT-AREA-USER-TYPE = "67"
S17003                     AND  STRT-AREA-TRN-NO = 11045
S17003                     AND WA-PSWD-CTR >= SOC-BRNH-PSWD-RET)
SC0367               MOVE 1518             TO WA-OUTPUT-ERR-MSG-NO
S12532               IF  STRT-AREA-BRANCH = 628
S12532                 MOVE 5055      TO WA-OUTPUT-ERR-MSG-NO
S12532               END-IF
SC0367            ELSE
S17003             IF  STRT-AREA-USER-TYPE = "67"
S17003                 AND  STRT-AREA-TRN-NO = 11045
S17003                 AND WA-PSWD-CTR >= SOC-BRNH-PSWD-RET
S17003                 MOVE 5340       TO UT0060CA-CALL-ERROR-CODE
S17003             ELSE
SC0367               MOVE 3592             TO WA-OUTPUT-ERR-MSG-NO
S17003             END-IF
SC0367               ADD  1                TO WA-PSWD-CTR
SC0367               MOVE WA-PSWD-CTR      TO INVE-ALL-BR-CTR
SC0367               MOVE "REWRITE"        TO DBIOMOD-FUNCTION
SC0367               PERFORM M003-ACCESS-INVE THRU M003-EXIT
SC0367            END-IF
SC0367            PERFORM X070-CHK-PSWD-RETRY THRU X070-EXIT
SC0367            GO TO X050-EXIT
SC0367         END-IF
SC0367      END-IF.
SC0367*
SC0367 X050-EXIT.
SC0367     EXIT.
SC0367*
SC0367 X070-CHK-PSWD-RETRY.
SC0367*--------------------
S17003     IF  STRT-AREA-USER-TYPE = "67"
S17003         AND  STRT-AREA-TRN-NO = 11045
S17003         AND WA-PSWD-CTR >= SOC-BRNH-PSWD-RET
S17003         GO TO X070-EXIT
S17003     END-IF.
SC0367     IF WA-PSWD-CTR >= SOC-BRNH-PSWD-RET
SC0367        MOVE 3593   TO WA-OUTPUT-ERR-MSG-NO
SC0367        MOVE 1      TO WA-MSG-ERR-FLAG.
SC0367*
SC0367 X070-EXIT.
SC0367     EXIT.
SC0367/
161480 X200-FORMAT-SDCV-DELETE.
161490*------------------------------------------------
161500*
161510     MOVE STARTAREA TO WA-IN0014-PASSALONG.
161520     MOVE 0         TO WA-IN0014-CALL-CODE.
161530*     MOVE "T" TO IN0014-INPUT-PAYTPE.
161540     MOVE 10906 TO IN0014-TRN-NO.
161550     CALL "UT0014" USING
161570                         WA-IN0014-PASSALONG
161580                         WA-IN0014-CALL-CODE.
161590     MOVE IN0014-STATUS-LEVEL-1 TO ST-STATUS-LEVEL-1.
161600*4*  MOVE IN0014-OUTPUT-MSG TO WA-OUTPUT-MESSAGE.
161610     MOVE IN0014-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE.
161620     MOVE IN0014-BORM-RECORD-AREA TO BORM-RECORD-AREA.
161630*
161640 X299-EXIT.
161650*-------------------------------------------
161660     EXIT.
161670/
161680 X300-FORMAT-SDCV-START.
161690*---------------------------------------------
161700*
161710     MOVE STARTAREA TO WA-IN0014-PASSALONG.
161720     MOVE 0         TO WA-IN0014-CALL-CODE.
161730*     MOVE "T" TO IN0014-INPUT-PAYTPE.
161740     MOVE 10907 TO IN0014-TRN-NO.
161750     IF  WA-INPUT-PARAM-TABLE(8) = 1
161760         MOVE WA-REPAY-TXN-DATE TO IN0014-INPUT-START-DATE
161770     ELSE
161780             MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE
161790             MOVE 1 TO UT0020-FUNCTION
161800             PERFORM X600-UT0020-PARA THRU X609-EXIT
161810             MOVE UT0020-DATE-DDMMCCYY TO IN0014-INPUT-START-DATE.
161820     CALL "UT0014" USING
161840                         WA-IN0014-PASSALONG
161850                         WA-IN0014-CALL-CODE.
161860     MOVE IN0014-STATUS-LEVEL-1 TO ST-STATUS-LEVEL-1.
161870*4*  MOVE IN0014-OUTPUT-MSG TO WA-OUTPUT-MESSAGE.
161880     MOVE IN0014-OUTPUT-MESSAGE TO WA-OUTPUT-MESSAGE.
161890     MOVE IN0014-BORM-RECORD-AREA TO BORM-RECORD-AREA.
161900*
161910 X399-EXIT.
161920*--------------------
161930     EXIT.
161940/
161950 X400-FORMAT-SDCV-CALL.
161960*--------------------------------------------
161970*
161980     MOVE STARTAREA TO WA-IN0014-PASSALONG.
161990     MOVE 0         TO WA-IN0014-CALL-CODE.
162000*     MOVE "T" TO IN0014-INPUT-PAYTPE.
162010     CALL "UT0014" USING
162030                         WA-IN0014-PASSALONG
162040                         WA-IN0014-CALL-CODE.
162050     MOVE IN0014-STATUS-LEVEL-1 TO ST-STATUS-LEVEL-1.
162060     MOVE WA-IN0014-PASSALONG TO STARTAREA.
162070*
162080 X499-EXIT.
162090*--------------------
162100     EXIT.
162110/
SC3719 X420-ACCESS-SUBS.
SC3719     MOVE "SUBS"       TO DBIOMOD-FILE
SC3719                          DBIOMOD-SUFFIX.
SC3719     MOVE "DBIO"       TO DBIOMOD-PREFIX.
SC3719     MOVE ZEROES       TO DBIOMOD-KEY-NO.
SC3719     MOVE SPACES       TO DBIOMOD-RELEASE-LOCK
SC3719                          DBIOMOD-STATUS
SC3719                          DBIOMOD-ACCESS-COMMAND
SC3719                          DBIOMOD-ACCESS-COND.
SC3719
SC3719     CALL DBIOMODNAME USING
SC3719                          DBIOMOD-FILE
SC3719                          DBIOMOD-KEY
SC3719                          WA-SUBS-AREA
SC3719                          DBIOMOD-FUNCTION
SC3719                          DBIOMOD-KEY-NO
SC3719                          DBIOMOD-RELEASE-LOCK
SC3719                          DBIOMOD-ACCESS-COMMAND
SC3719                          DBIOMOD-ACCESS-COND
SC3719                          DBIOMOD-STATUS.
SC3719 X420-EXIT.
SC3719     EXIT.
SC3719
S15813 X430-GET-MARGIN-RTN.
S15813*
S15813     MOVE STRT-AREA-SOC-NO     TO PRJP-SOC-NO.
S15813     MOVE BOIS-PROJECT-ID      TO PRJP-PROJ-ID.
S15813     MOVE PRJP-KEY             TO DBIOMOD-KEY.
S15813     SET  READ-CMD             TO TRUE.
S15813     PERFORM X440-ACCESS-PRJP-RTN THRU X440-EXIT.
S15813*
S15813     IF ( DBIOMOD-STAT    NOT  =  "****" )
S15813          GO                   TO X430-EXIT
S15813     END-IF.
S15813*
S15813     INITIALIZE UT0298CA-CALL-AREA.
S15813     MOVE 04                   TO UT0298CA-CALL-CODE.
S15813     MOVE 00                   TO UT0298CA-RET-STATUS.
S15813     MOVE PRJP-SOC-NO          TO UT0298CA-CALL-SOC-NO.
S15813     MOVE PRJP-BANK-BASE-ID    TO UT0298CA-CALL-BASE-ID.
S15813     MOVE PRJP-BANK-RATE-ID    TO UT0298CA-CALL-RATE-ID.
S15813     MOVE STRT-AREA-POST-DT    TO UT0298CA-CALL-TXN-DATE.
S15813     CALL "UT0298"             USING UT0298CA-CALL-AREA.
S15813*
S15813     IF ( UT0298CA-RET-STATUS  =  0 )
S15813          COMPUTE WA-BANK-RATE =  UT0298CA-RET-EFF-RATE
S15813                               -  UT0298CA-RET-EFF-BASE
S15813                               +  PRJP-BANK-RATE-INCR
S15813     END-IF.
S15813*
S15813     INITIALIZE UT0298CA-CALL-AREA.
S15813     MOVE 04                   TO UT0298CA-CALL-CODE.
S15813     MOVE 00                   TO UT0298CA-RET-STATUS.
S15813     MOVE STRT-AREA-SOC-NO     TO UT0298CA-CALL-SOC-NO.
S15813     MOVE BORP-BASM-BASE-ID    TO UT0298CA-CALL-BASE-ID.
S15813     MOVE BORP-BASM-RATE-ID    TO UT0298CA-CALL-RATE-ID.
S15813     MOVE STRT-AREA-POST-DT    TO UT0298CA-CALL-TXN-DATE.
S15813     CALL "UT0298"             USING UT0298CA-CALL-AREA.
S15813*
S15813     IF ( UT0298CA-RET-STATUS  =  0 )
S15813          COMPUTE WA-CUST-RATE =  UT0298CA-RET-EFF-RATE
S15813                               -  UT0298CA-RET-EFF-BASE
S15813                               +  PRJP-BANK-RATE-INCR
S15813     END-IF.
S15813*
S15813     COMPUTE WA-FLOAT-RATE     =  WA-BANK-RATE
S15813                               -  WA-CUST-RATE.
S15813*
S15813     IF ( WA-FLOAT-RATE        <  0 )
S15813          MOVE 0               TO WA-FLOAT-RATE
S15813     END-IF.
S15813*
S15813 X430-EXIT.
S15813     EXIT.
S15813*
S15813 X440-ACCESS-PRJP-RTN.
S15813*
S15813     MOVE "PRJP"               TO DBIOMOD-FILE
S15813                                  DBIOMOD-SUFFIX.
S15813     MOVE "DBIO"               TO DBIOMOD-PREFIX.
S15813     MOVE ZEROES               TO DBIOMOD-KEY-NO.
S15813     MOVE SPACES               TO DBIOMOD-RELEASE-LOCK
S15813                                  DBIOMOD-STATUS
S15813                                  DBIOMOD-ACCESS-COMMAND
S15813                                  DBIOMOD-ACCESS-COND.
S15813*
S15813     CALL DBIOMODNAME          USING
S15813                                  DBIOMOD-FILE
S15813                                  DBIOMOD-KEY
S15813                                  WA-PRJP-AREA
S15813                                  DBIOMOD-FUNCTION
S15813                                  DBIOMOD-KEY-NO
S15813                                  DBIOMOD-RELEASE-LOCK
S15813                                  DBIOMOD-ACCESS-COMMAND
S15813                                  DBIOMOD-ACCESS-COND
S15813                                  DBIOMOD-STATUS.
S15813*
S15813 X440-EXIT.
S15813     EXIT.
S15813*
162120 X500-ACCESS-BLNF.
162130*----------------------------------
162140*
162150     MOVE "BLNF" TO DBIO-CALL-SYS-AREA.
162160     CALL "DBIO" USING
162180                       DBIO-CALL-PARAM
162190                       DBIO-CALL-SYS-AREA
162200                       DBIO-CALL-KEY-AREA
162210                       DBIO-CALL-STATUS
162220                       BLNF-RECORD-AREA
162230                       DBIO-CALL-REFER-AREA.
162240*
162250 X599-EXIT.
162260*--------------------
162270     EXIT.
162280/
162290 X600-UT0020-PARA.
162300*---------------------------------
162310*
162320     CALL "UT0020" USING UT0020-FUNCTION UT0020-DATE-AREA
162330                         UT0020-BINARY-DATE.
162340*
162350 X609-EXIT.
162360*--------------------
162370     EXIT.
162380/
162390 X610-UT0030-PARA.
162400*---------------------------------
162410*
162420     MOVE 1 TO UT0030-FUNCTION.
162430     CALL "UT0030" USING UT0030-FUNCTION UT0030-DATE-AREA
162440                         UT0030-BINARY-DATE.
162450*
162460 X619-EXIT.
162470*--------------------
162480     EXIT.
162490/
162500 X700-CALL-UT0250.
162510     MOVE 02    TO LINK-IN-CALL-CODE.
162520     MOVE STRT-AREA-SOC-NO TO LINK-IN-SOC-NO.
162530     CALL "UT0250" USING
162550                         LINK-AREA.
162560     IF LINK-OUT-STAT NOT = "****"
162570        MOVE 100 TO WA-OUTPUT-ERR-MSG-NO
162580        MOVE 1   TO WA-MSG-ERR-FLAG
162590        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
162600        MOVE SPACES TO UT8500CA-INPUT-MSG
162610        MOVE LINK-IN-TXCODE TO WA-STORE-TRN-NO
162620        STRING "BR0000:(X700) INVALID TRAN CODE " WA-STORE-TRN-NO
162630           DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
162640        CALL "UT8500" USING
162660                            UT8500CA-AREA.
162670*
162680 X799-EXIT.
162690      EXIT.
162700*
162710 X710-GET-RATE.
TP0053     MOVE BORM-BAD-DEBT-IND  TO WA-BAD-DEBT-IND
SC1857     IF BORP-YOUBE
TP0053        AND WA-BAD-DEBT-IND-2 < 2
SC1857        PERFORM Z200-GET-GRACE-DAYS THRU Z209-EXIT
SC1857     END-IF.
TB0159     IF BORP-YOUBE AND
TB0159        BOIS-NEXT-DUE-DATE NOT > STRT-AREA-POST-DT
SC8949*    AND WA-GRACE-DAYS > BORP-ARREARS-GRACE-PRD  
SC8949     AND (WA-GRACE-DAYS > BORP-ARREARS-GRACE-PRD 
SC8949     OR   WA-BAD-DEBT-IND-2 > 1)                 
S19226       IF  WA-BAD-DEBT-IND-2 > 1
SC1857           IF BOIS-HIGH-INT-RATE > 0
SC1857              MOVE BOIS-HIGH-INT-RATE   TO WA-INT-RATE-A
SC1857           ELSE
SC1857              MOVE BORP-HIGHER-INT-RATE TO WA-INT-RATE-A
SC1857           END-IF
S19226       ELSE
S19226           MOVE BORM-INT-RATE  TO WA-INT-RATE-A
S19226       END-IF
SC1857*          MOVE BORP-HIGHER-INT-RATE TO WA-INT-RATE-A
TB0159     ELSE
162720     IF BORM-INT-RATE = 0
TB0069     AND (BOIS-NEGO-RATE-IND = "0"
SC5150          OR  BOIS-PREF-INT-PERIOD > 0
TB0069          OR  (BOIS-NEGO-RATE-IND = "2"
TB0069               AND BOIS-NEGO-RATE-FLAG = "2"))
162730        MOVE 0     TO WA-TIER-LEVEL
162740        MOVE BORP-TIER-METH   TO WA-TIER-METHOD
TB0069        IF SOC-SITE-TIB
TB0069        AND WA-FIRST-ADV
TB0069           MOVE WA-ADV-DATE-BIN TO WA-SEARCH-RATE-DATE
TB0069        ELSE
162750           MOVE WA-DMY          TO WA-SEARCH-RATE-DATE
TB0069        END-IF
162760        MOVE BORM-LOAN-BAL    TO WA-X710-STORE-BAL
162770        SUBTRACT BORM-UNCL-NO-INT-VAL FROM BORM-LOAN-BAL
162780        IF BORP-BASM-BASE-ID = SPACES
162790        OR BORP-BASM-RATE-ID = SPACES
162800           MOVE ZERO TO WA-INT-RATE-A
162810*           PERFORM E280-FIND-RATE THRU E289-EXIT
162820        ELSE
162830            PERFORM E290-SEARCH-RATE-TABLE THRU E299A-EXIT
TB0069            IF WA-MSG-ERR-FLAG = 1
TB0069               GO TO X719-EXIT
TB0069            END-IF
162840        END-IF
162850        MOVE WA-X710-STORE-BAL TO BORM-LOAN-BAL
S16466*TB0069        IF NOT SOC-SITE-TIB
S16466*162860           PERFORM X750-SEARCH-BLDVWW THRU X759-EXIT
S16466*TB0069        END-IF
162870*       MOVE WA-INT-RATE-A   TO BORM-INT-RATE
162880     ELSE
S16466*TB0069        IF SOC-SITE-TIB
S16466*TB0069        AND WA-FIRST-ADV
S16466        IF  WA-FIRST-ADV
TB0069           MOVE WA-ADV-DATE-BIN  TO WA-INT-DATE-A
TB0069        ELSE
162890           MOVE WA-DMY        TO WA-INT-DATE-A
TB0069        END-IF
162900        MOVE BORM-INT-RATE TO WA-INT-RATE-A 
TB0159     END-IF
TB0159     END-IF.
SC7101
SC7101     IF BOIS-NEGO-RATE-IND = 3
SC7101        AND BOIS-PREF-INT-PERIOD > 0
SC7101        AND BOIS-PREF-INT-RATE = 0
SC7101        AND BORM-STAT NOT < 6
SC7101            MOVE ZERO TO WA-INT-RATE-A
SC7101     END-IF.
TB0159*
TB0159     IF BORP-YOUBE AND BOIS-PREF-INT-RATE > 0
TB0159        IF WA-FIRST-ADV
SC5753          IF BORM-STAT < 6
TB0159           PERFORM X730-GET-EXPIRY-DATE THRU X739-EXIT
TB0159           IF WA-MSG-ERR-FLAG NOT = 1
TB0159              IF BOIS-NEGO-RATE-IND = "3"
TB0159                 PERFORM X760-READ-BLDVNI THRU X769-EXIT
TB0159                 IF DBIO-CALL-STATUS NOT = "****" OR
TB0159                    DBIO-CALL-SAVE-REFER = "END."
TB0159                    PERFORM X770-CREATE-BLDVNI-REC
TB0159                            THRU X779-EXIT
TB0159                 END-IF
TB0159              END-IF
TB0159           END-IF
SC5753          END-IF
SC5753*       ELSE
SC5753*          DISPLAY 'DAAN DITO KUNDI FIRST DRAWDOWN'
SC5753*          IF BOIS-RATE-EXP-DATE >= STRT-AREA-POST-DT
SC5753*             CONTINUE
SC5753*          ELSE
SC5753*             IF BOIS-NEGO-RATE-IND = "3"
SC5753*                PERFORM X760-READ-BLDVNI THRU X769-EXIT
SC5753*                IF DBIO-CALL-STATUS = "****"
SC5753*                   MOVE BLDV-NI-RATE(1) TO WA-INT-RATE-A
SC5753*                END-IF
SC5753*             END-IF
SC5753*             INITIALIZE BOIS-PREF-INT-RATE
SC5753*                        BOIS-PREF-INT-PERIOD
SC5753*                        BORM-RT-INCR
SC5753*                        BOIS-RATE-EXP-DATE
SC5753*          END-IF
TB0159        END-IF
SC5753*       COMPUTE BORM-RT-INCR =
SC5753*               BOIS-PREF-INT-RATE - WA-INT-RATE-A
TB0159     END-IF.
162910     ADD BORM-RT-INCR TO WA-INT-RATE-A.
162920 X719-EXIT.
162930     EXIT.
162940*
TB0120 X720-CALL-UT0251.
TB0120/
TB0120     MOVE 2                  TO UT0251CA-CALL-CODE.
TB0120     MOVE STRT-AREA-SOC-NO   TO UT0251CA-SOC-NO.
TB0120     MOVE STRT-AREA-TRN-NO   TO UT0251CA-TRAN-CODE.
TB0120     CALL "UT0251" USING UT0251CA-CALL-AREA.
TB0120     IF UT0251CA-CALL-STATUS  NOT = "****"
TB0120        STRING PROGNAME ":(X720) UT0251 ERROR"
TB0120        ",FUNC=" UT0251CA-CALL-CODE
TB0120        ",STAT=" UT0251CA-CALL-STATUS
TB0120        ",KEY="  UT0251CA-CALL-KEY
TB0120        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0120        CALL "UT8500" USING UT8500CA-AREA
TB0120        GO TO X729-EXIT
TB0120     END-IF.
TB0120
TB0120 X729-EXIT.
TB0120     EXIT.
TB0120/
TB0159
TB0159 X730-GET-EXPIRY-DATE.
TB0159     MOVE WA-ADV-DATE-BIN TO  UT0020-BINARY-DATE
TB0159                              BORM-INT-START-DATE
TB0159     MOVE 1               TO  UT0020-FUNCTION
TB0159
TB0159     IF UT0020-BINARY-DATE = ZEROES
TB0159        MOVE 126          TO  WA-OUTPUT-ERR-MSG-NO
TB0159        MOVE 1            TO  WA-MSG-ERR-FLAG
TB0159        GO TO X739-EXIT
TB0159     ELSE
TB0159        PERFORM X600-UT0020-PARA THRU X609-EXIT
TB0159        MOVE UT0020-DATE-DDMMCCYY TO WA-ADV-DATE
TB0159     END-IF.
TB0159
TB0159     ADD BOIS-PREF-INT-PERIOD TO  WA-ADV-DATER-MM.
TB0159     IF WA-ADV-DATER-MM > 12
TB0159        SUBTRACT 12       FROM WA-ADV-DATER-MM
TB0159        ADD      1        TO   WA-ADV-DATER-YY
TB0159     END-IF.
SC1231     PERFORM B3200-PROC-DT THRU B3200-PROC-EXIT.
TB0159     MOVE WA-ADV-DATE     TO  UT0030-DATE-MMDDCCYY
SC1231     PERFORM B3100-CONV-DATE-TO-BINARY THRU B3100-CONV-EXIT
TB0159*    MOVE 1               TO  UT0030-FUNCTION
TB0159*    PERFORM X610-UT0030-PARA THRU X619-EXIT.
TB0159
TB0159     IF UT0030-BINARY-DATE = ZEROES
TB0159        MOVE 126          TO  WA-OUTPUT-ERR-MSG-NO
TB0159        MOVE 1            TO  WA-MSG-ERR-FLAG
TB0159        GO TO X739-EXIT
TB0159     ELSE
TB0159        MOVE UT0030-BINARY-DATE TO BOIS-RATE-EXP-DATE
TB0159     END-IF.
TB0159 X739-EXIT.
TB0159     EXIT.
TB0159
162950 X750-SEARCH-BLDVWW.
162960     IF BORP-FLEXI-CAFM-IND = 0
162970        MOVE BORP-CAFM-TYPE TO WA-CAFM-TYPE
162980     ELSE
162990     IF BORM-CAFM-TYPE > 0
163000        MOVE BORM-CAFM-TYPE TO WA-CAFM-TYPE
163010     ELSE
163020        MOVE BORP-CAFM-TYPE TO WA-CAFM-TYPE.
163030     MOVE WA-IN-PROGRESS  TO  WA-FOUND-IND.
163040     IF NO-CAP-OR-COLLARS
163050        NEXT SENTENCE
163060     ELSE
163070*
163080        MOVE ZERO              TO DBIO-CALL-REFER-AREA
163090        MOVE BORM-SOC-NO       TO WA-BORM-SOC-NO
163100        MOVE BORM-MEMB-CUST-AC TO WA-BORM-ACCT-NO
163110        MOVE WA-BORM-KEY       TO   DBIO-CALL-KEY-AREA
163120        MOVE 61                TO   DBIO-CALL-FUNC
163130        MOVE "BORM"            TO   DBIO-CALL-N-SYS
163140        MOVE "BLDV"            TO   DBIO-CALL-SYST-VAR
163150        MOVE "WW"              TO   DBIO-CALL-TXN-TYPE-AREA
163160        MOVE SPACES            TO   DBIO-CALL-STATUS
163170*
163180        PERFORM Z1000-RETRIEVE-BLDVWW THRU Z1099-EXIT
163190        UNTIL NOT NEW-RATE-IN-PROGRESS
163200        IF NEW-RATE-NOT-FOUND
163210           NEXT SENTENCE
163220        ELSE
163230           PERFORM Z1100-SET-EFF-RATE THRU Z1199-EXIT.
163240 X759-EXIT.
163250     EXIT.
163260*
TB0159
TB0159 X760-READ-BLDVNI.
TB0159     MOVE 61                 TO DBIO-CALL-FUNC
TB0159     MOVE "NI"               TO BLDV-NI-TRAN-TYPE
TB0159     MOVE STRT-AREA-SOC-NO   TO DBIO-01-SOC-NO
TB0159     MOVE WA-INPUT-ACCT-NO   TO DBIO-01-ACCT-NO
TB0159     MOVE DBIO-01-KEY        TO DBIO-CALL-KEY-AREA
TB0159     MOVE "BORM"             TO DBIO-CALL-N-SYS
TB0159     MOVE "BLDV"             TO DBIO-CALL-SYST-VAR
TB0159     MOVE "NI"               TO DBIO-CALL-CODE-B
TB0159     MOVE 0                  TO DBIO-CALL-REFER-AREA
TB0159     MOVE SPACES             TO DBIO-CALL-STATUS
TB0159     CALL "DBIO" USING DBIO-CALL-PARAM
TB0159                       DBIO-CALL-SYS-AREA
TB0159                       DBIO-CALL-KEY-AREA
TB0159                       DBIO-CALL-STATUS
TB0159                       WA-BLDV-AREA-NI
TB0159                       DBIO-CALL-REFER-AREA
TB0159                       DBIO-CALL-TXN-TYPE-AREA
TB0159
TB0159     IF WA-FIRST-ADV-FLAG = "N"
TB0159        CONTINUE
TB0159     ELSE
TB0159        IF DBIO-CALL-SAVE-REFER = "END." OR
TB0159           DBIO-CALL-STATUS NOT = "****"
TB0159           GO TO X769-EXIT
TB0159        END-IF
TB0159     END-IF.
TB0159
TB0159     IF DBIO-CALL-SAVE-REFER = "END."
TB0159        MOVE 3799             TO WA-OUTPUT-ERR-MSG-NO
TB0159        MOVE 1                TO WA-MSG-ERR-FLAG
TB0159        GO TO X769-EXIT
TB0159     ELSE
TB0159        IF DBIO-CALL-STATUS NOT = "****"
TB0159           MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
TB0159           MOVE 1                TO WA-MSG-ERR-FLAG
TB0159           MOVE "BLDV"           TO WA-OUTPUT-DATA-SET
TB0159           MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
TB0159           MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0159                                 TO UT8500CA-CALL-CODE
TB0159           MOVE SPACES           TO UT8500CA-INPUT-MSG
TB0159           STRING "BR0000:(X770) READ BLDVNI ERROR"
TB0159                  ", SAVE-REFER = " DBIO-CALL-SAVE-REFER
TB0159                  ", DBIO-STAT  = " DBIO-CALL-STATUS
TB0159                  ", KEY = " DBIO-CALL-KEY-AREA
TB0159                  DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0159           CALL "UT8500" USING UT8500CA-AREA
TB0159           GO TO X769-EXIT
TB0159        END-IF
TB0159     END-IF.
TB0159*
TB0159 X769-EXIT.
TB0159     EXIT.
TB0159
TB0159 X770-CREATE-BLDVNI-REC.
           DISPLAY 'ENTER X770-CREATE-BLDVNI-REC'.
TB0159     MOVE 62                 TO DBIO-CALL-FUNC.
TB0159     MOVE STRT-AREA-SOC-NO   TO DBIO-01-SOC-NO.
TB0159     MOVE WA-INPUT-ACCT-NO   TO DBIO-01-ACCT-NO.
TB0159     MOVE DBIO-01-KEY        TO DBIO-CALL-KEY-AREA.
TB0159     MOVE "BORM"             TO DBIO-CALL-N-SYS.
TB0159     MOVE "BLDV"             TO DBIO-CALL-SYST-VAR.
TB0159     MOVE "NI"               TO DBIO-CALL-CODE-B.
TB0159     MOVE 0                  TO DBIO-CALL-REFER-AREA.
TB0159     MOVE SPACES             TO DBIO-CALL-STATUS.
TB0159
TB0159     MOVE "NI"               TO BLDV-NI-TRAN-TYPE.
TB0159     MOVE STRT-AREA-SOC-NO   TO BLDV-NI-SOCIETY.
TB0159     MOVE WA-INPUT-ACCT-NO   TO BLDV-NI-MEMB-NO.
TB0159     MOVE BOIS-RATE-EXP-DATE TO BLDV-NI-START-DATE(1).
TB0159     MOVE WA-INT-RATE-A      TO BLDV-NI-RATE(1).
TB0159     MOVE "1"                TO BLDV-NI-RATE-FLAG(1).
TB0159
TB0159     CALL "DBIO" USING DBIO-CALL-PARAM
TB0159                       DBIO-CALL-SYS-AREA
TB0159                       DBIO-CALL-KEY-AREA
TB0159                       DBIO-CALL-STATUS
TB0159                       WA-BLDV-AREA-NI
TB0159                       DBIO-CALL-REFER-AREA
TB0159                       DBIO-CALL-TXN-TYPE-AREA.
TB0159     IF DBIO-CALL-STATUS NOT = "****"
TB0159        MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
TB0159        MOVE 1                TO WA-MSG-ERR-FLAG
TB0159        MOVE "BLDV"           TO WA-OUTPUT-DATA-SET
TB0159        MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
TB0159        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0159                              TO UT8500CA-CALL-CODE
TB0159        MOVE SPACES           TO UT8500CA-INPUT-MSG
TB0159        STRING "BR0000:(X770) WRITE BLDVNI ERROR"
TB0159               ", SAVE-REFER = " DBIO-CALL-SAVE-REFER
TB0159               ", DBIO-STAT  = " DBIO-CALL-STATUS
TB0159               ", KEY = " DBIO-CALL-KEY-AREA
TB0159               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0159        CALL "UT8500" USING UT8500CA-AREA
TB0159        GO TO X779-EXIT
TB0159     END-IF.
TB0159 X779-EXIT.
TB0159     EXIT.
S16668 X800-YOUTH-LOAN-PROCESS.
S16668     IF  WA-INPUT-PARAM-TABLE(7) = 0
S16668     AND WA-FIRST-ADV
S16668         INITIALIZE BLDV-NI-GROUP-DATA-R
S16668* GET WA-ADVANCE-DD
S16668         MOVE WA-ADV-DATE-BIN  TO WA-BIN-DATE
S16668         PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S16668         MOVE WA-DDMMCCYY-DATE(1:2) TO WA-SOURCE-REPAY-DAY
S16668* GET MATURITY DATE
S16668         INITIALIZE UT0312CA-CALL-AREA
S16668         MOVE 17              TO UT0312CA-CALL-CODE
S16668         MOVE WA-ADV-DATE-BIN TO UT0312CA-DUE-STRT-DT
S16668         MOVE BORM-LOAN-TRM   TO UT0312CA-LOAN-TERM
S16668         PERFORM X810-GET-END-DATE THRU X810-EXIT
S16668         MOVE UT0312CA-MATURITY-DT TO WA-TEMP-MATURITY-DT
S16668         IF WA-MSG-ERR-FLAG = 1
S16668            GO TO X800-EXIT
S16668         END-IF
S16668* GET 1 PERIOD END DATE
S16668         INITIALIZE UT0312CA-CALL-AREA
S16668         MOVE 17              TO UT0312CA-CALL-CODE
S17327*S16668  MOVE WA-ADV-DATE-BIN TO UT0312CA-DUE-STRT-DT
S17327         IF BORM-REFERRAL-DATE > 0
S17327            MOVE BORM-REFERRAL-DATE TO UT0312CA-DUE-STRT-DT
S17327            MOVE BORM-REFERRAL-DATE TO WA-BIN-DATE
S17327            PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S17327            MOVE WA-DDMMCCYY-DATE(1:2) TO WA-SOURCE-REPAY-DAY
S17327         ELSE
S17327            MOVE WA-ADV-DATE-BIN TO UT0312CA-DUE-STRT-DT
S17327         END-IF
S16668         MOVE 24              TO UT0312CA-LOAN-TERM
S16668         PERFORM X810-GET-END-DATE THRU X810-EXIT
S17327         IF UT0312CA-MATURITY-DT NOT > WA-ADV-DATE-BIN
S17327            MOVE "0"          TO BOIS-NEGO-RATE-IND
S17327            GO TO X800-EXIT
S17327         END-IF
S16668         MOVE UT0312CA-MATURITY-DT TO WA-BIN-DATE
S16668         IF WA-MSG-ERR-FLAG = 1
S16668            GO TO X800-EXIT
S16668         END-IF
S16668* PREPARE BLDVNI
S16668        PERFORM VARYING WA-SUB FROM 1 BY 1
S16668                 UNTIL   WA-SUB > 2
S16668         IF ( WA-SUB = 1 )
S16668            MOVE STRT-AREA-POST-DT TO BLDV-NI-CREATE-DT(WA-SUB)
S16668            MOVE WA-ADV-DATE-BIN   TO BLDV-NI-START-DATE(WA-SUB)
S16668            MOVE WA-BIN-DATE       TO BLDV-NI-END-DATE(WA-SUB)
S16668            MOVE 0              TO BLDV-NI-RATE(WA-SUB)
S16668            MOVE 3              TO BLDV-NI-RATE-FLAG(WA-SUB)
S16668         ELSE
S16668            MOVE STRT-AREA-POST-DT TO BLDV-NI-CREATE-DT(WA-SUB)
S16668            MOVE WA-BIN-DATE       TO BLDV-NI-START-DATE(WA-SUB)
S16668            MOVE WA-TEMP-MATURITY-DT
S16668                                   TO BLDV-NI-END-DATE(WA-SUB)
S16668            MOVE 0              TO BLDV-NI-RATE(WA-SUB)
S16668            MOVE 2              TO BLDV-NI-RATE-FLAG(WA-SUB)
S16668         END-IF
S16668        END-PERFORM
S16668     END-IF.
S16668     MOVE STRT-AREA-POST-DT  TO BLDV-NI-POST-DATE.
S16668     MOVE SPACE              TO BLDV-NI-DELI.
S16668     MOVE "NI"               TO BLDV-NI-TYPE
S16668                                BLDV-NI-TRAN-TYPE
S16668                                DBIO-CALL-CODE-B.
S16668     PERFORM X820-ADD-AMEND-BLDV THRU X820-EXIT.
S16668     IF  WA-MSG-ERR-FLAG = 1
S16668         GO TO X800-EXIT
S16668     END-IF.
S16668 X800-EXIT.
S16668     EXIT.
S16668 X810-GET-END-DATE.
S16668     MOVE STRT-AREA-POST-DT   TO UT0312CA-EFF-DATE.
S16668     IF ( BORM-REPAY-FREQ     >  0 )
S16668          MOVE BORM-REPAY-FREQ TO UT0312CA-REPAY-FREQ
S16668     ELSE
S16668          MOVE BORP-REPAY-FREQ TO UT0312CA-REPAY-FREQ
S16668     END-IF.
S16668     IF ( BORM-REPAY-SCHED    =  SPACE )
S16668          MOVE BORP-REPAY-SCHED TO UT0312CA-REPAY-SCHED
S16668     ELSE
S16668          MOVE BORM-REPAY-SCHED TO UT0312CA-REPAY-SCHED
S16668     END-IF.
S16668     MOVE BORM-CAPN-METHOD    TO UT0312CA-CAPN-METHOD.
S16668     MOVE WA-SOURCE-REPAY-DAY TO UT0312CA-REPAY-DAY
S16668     MOVE BOIS-DUE-DTE-IND    TO UT0312CA-1ST-DUE-DTE-IND.
S16668     SET  UT0312CA-HOLIDAY-DUE-PREV-WD TO TRUE.
S16668     CALL "UT0312"            USING UT0312CA-CALL-AREA.
S16668     IF ( UT0312CA-RET-STATUS NOT = 0 )
S16668          MOVE 296            TO WA-ERR-MSG-NO
S16668          MOVE 1              TO WA-MSG-ERR-FLAG
S16668     END-IF.
S16668 X810-EXIT.
S16668     EXIT.
S16668 X820-ADD-AMEND-BLDV.
S16668     PERFORM U100-PK-BRANCH-TERM-TELL THRU U199-EXIT.
S16668     MOVE DBIO-CALL-SAVE-REFER TO WA-REFER-X
S16668     IF  DBIO-CALL-SAVE-REFER = "END."
S16668         MOVE 0  TO DBIO-CALL-REFER-AREA
S16668         MOVE 62 TO DBIO-CALL-FUNC
S16668     ELSE
S16668         MOVE 63 TO DBIO-CALL-FUNC
S16668         MOVE 9999          TO DBIO-CALL-REFER-AREA
S16668         MOVE WA-REFER-X    TO DBIO-CALL-SAVE-REFER
S16668     END-IF.
S16668     IF  DBIO-CALL-CODE-B = "NI"
S16668         MOVE STRT-AREA-SOC-NO TO BLDV-NI-SOCIETY
S16668         MOVE WA-INPUT-ACCT-NO TO BLDV-NI-MEMB-NO
S16668         MOVE UPTELLCA-TELLER-BRANCH TO BLDV-NI-TELL-AND-BR
S16668         PERFORM X830-RW-BLDV THRU X830-EXIT
S16668     END-IF.
S16668 X820-EXIT.
S16668     EXIT.
S16668 X830-RW-BLDV.
S16668     MOVE "BORM" TO DBIO-CALL-N-SYS.
S16668     MOVE "BLDV" TO DBIO-CALL-SYST-VAR.
S16668     MOVE STRT-AREA-SOC-NO   TO DBIO-01-SOC-NO
S16668     MOVE WA-INPUT-ACCT-NO   TO DBIO-01-ACCT-NO
S16668     MOVE DBIO-01-KEY        TO DBIO-CALL-KEY-AREA.
S16668     MOVE SPACES TO DBIO-CALL-STATUS.
S16668     CALL "DBIO" USING
S16668                       DBIO-CALL-PARAM
S16668                       DBIO-CALL-SYS-AREA
S16668                       DBIO-CALL-KEY-AREA
S16668                       DBIO-CALL-STATUS
S16668                       WA-BLDV-AREA-NI
S16668                       DBIO-CALL-REFER-AREA
S16668                       DBIO-CALL-TXN-TYPE-AREA.
S16668     IF  DBIO-CALL-STATUS NOT = "****"
S16668         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
S16668         MOVE SPACES TO UT8500CA-INPUT-MSG
S16668         STRING "BR0000:(X830) PROBLEM WHILE REWRITING BLDV NI "
S16668                  DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
S16668             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S16668         CALL "UT8500" USING
S16668                             UT8500CA-AREA
S16668         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
S16668         MOVE "BLDV" TO WA-DBERR-DATA-SET
S16668         MOVE 155                 TO WA-OUTPUT-ERR-MSG-NO
S16668         MOVE 1 TO WA-MSG-ERR-FLAG.
S16668 X830-EXIT.
S16668     EXIT.
S17870
S17870 X840-CHK-YUN3-RTN.
S17870         INITIALIZE UT0312CA-CALL-AREA
S17870         MOVE 17              TO UT0312CA-CALL-CODE
S17870         IF BORM-REFERRAL-DATE > 0
S17870            MOVE BORM-REFERRAL-DATE    TO UT0312CA-DUE-STRT-DT
S17870            MOVE BORM-REFERRAL-DATE    TO WA-BIN-DATE
S17870            PERFORM D410-CONVERT-BIN-DATE THRU D419-EXIT
S17870            MOVE WA-DDMMCCYY-DATE(1:2) TO WA-SOURCE-REPAY-DAY
S17870         ELSE
S17870            MOVE BOIS-FIRST-ADV-DATE   TO UT0312CA-DUE-STRT-DT
S17870            MOVE BORM-REPAY-DAY        TO WA-SOURCE-REPAY-DAY
S17870         END-IF
S17870         MOVE 24                       TO UT0312CA-LOAN-TERM
S17870         PERFORM X810-GET-END-DATE   THRU X810-EXIT
S17870         IF WA-MSG-ERR-FLAG = 0
S17870            MOVE UT0312CA-MATURITY-DT  TO WA-BIN-DATE
S17870         ELSE
S17870            MOVE 0                     TO WA-BIN-DATE
S17870         END-IF.
S17870
S17870 X840-EXIT.
S17870     EXIT.
SC2192/
SC2192 XLOAD-ALL-RATES.
SC2192     MOVE 0                      TO WA-TIER-LEVEL.
SC2192     MOVE BORP-TIER-METH         TO WA-TIER-METHOD.
SC2192     MOVE BORM-LOAN-BAL          TO WA-X710-STORE-BAL.
SC2192     SUBTRACT BORM-UNCL-NO-INT-VAL FROM BORM-LOAN-BAL.
SC2192
SC2192     PERFORM E290-SEARCH-RATE-TABLE
SC2192        THRU E299A-EXIT.
SC2192
SC2192     IF WA-MSG-ERR-FLAG = 1
SC2192        GO TO XLOAD-ALL-RATES-EXIT
SC2192     END-IF.
SC2192
SC2192
SC2192     IF WA-ADV-DATE-BIN <= STRT-AREA-POST-DT
SC2192        IF WA-ADV-DATE-BIN <= WA-INT-DATE-A
SC5098           ADD BORM-RT-INCR TO WA-INT-RATE-A
SC5098           IF WA-INT-RATE-A NOT = WA-SAVE-INT-RATE
SC5098              MOVE "Y" TO WA-BACK-LOADED-RATE
SC2192           PERFORM M500-MAINTAIN-RATE-HISTORY
SC2192              THRU M500-EXIT
SC5098              MOVE WA-INT-RATE-A TO WA-SAVE-INT-RATE
SC5098           END-IF
SC2192
SC2192           IF WA-MSG-ERR-FLAG NOT = 0
SC2192              GO TO XLOAD-ALL-RATES-EXIT
SC2192           END-IF
SC2192
SC2192           COMPUTE WA-ADV-DATE-BIN = WA-INT-DATE-A + 1
SC2192
SC2192           IF WA-ADV-DATE-BIN > STRT-AREA-POST-DT
SC2192              MOVE "Y"              TO WA-LOADED-ALL
SC2192           END-IF
SC2192        ELSE
SC2192           COMPUTE WA-ADV-DATE-BIN = WA-ADV-DATE-BIN + 1
SC2192        END-IF
SC2192     ELSE
SC2192        MOVE "Y"                 TO WA-LOADED-ALL
SC2192     END-IF.
SC2192
SC2192 XLOAD-ALL-RATES-EXIT.
SC2192     EXIT.
SC2192
163270/
163280* ** WHEN AN OVERRIDABLE ERROR IS ENCOUNTERED, UT0060 WILL BE
163290*    CALLED IF CHECK IF THE TRAN'S ERROR HAS BEEN OVERRIDEN OR
163300*    NOT. IF IT HAS, OK. IF IT HASN'T, CHECK IF THE CURRENT TRAN
163310*    CARRIES A VALID OVERRIDE SIGNAL OR NOT.
163320*
163330*    AN "69" CAN BE USED TO OVERRIDE 1 AND ONLY 1 ERROR.
163340*    AN "61" CAN BE USED TO OVERRIDE MORE THAN 1 ERROR IF REQ'D
163350*
163360 Y000-OVERRIDABLE-ERROR-CHECK.
163380     MOVE ZERO                 TO WA-MSG-ERR-FLAG.
163400* ** READ AND TEST THE TELLER RECORD
163420     MOVE "11"                 TO UT0060CA-CALL-CODE.
163430     MOVE STRT-AREA-SOC-NO     TO UT0060CA-CALL-SOCIETY-NO.
163440     MOVE STRT-AREA-ABS-TERM   TO UT0060CA-CALL-TERM-NO.
163450     MOVE STRT-AREA-TELL-NO    TO UT0060CA-CALL-TELR-NO.
163470     IF WA-SUPERVISOR-OVERRIDE-IN-USE = SPACE OR "0"
163480        MOVE WA-OVER-RIDE      TO UT0060CA-CALL-OVERRIDE-SIGNAL
163490     ELSE
163500        MOVE SPACES            TO UT0060CA-CALL-OVERRIDE-SIGNAL
163510        MOVE WA-SUPERVISOR-OVERRIDE-IN-USE
163520                               TO UT0060CA-CALL-OVERRIDE-SIGN.
163540     IF WA-INPUT-PARAM-TABLE(29) = 1
163550        MOVE WA-UT0060-SAVE-ACC-NO  TO UT0060CA-CALL-ACC-NO
163560        MOVE WA-UT0060-SAVE-TRAN-NO TO UT0060CA-CALL-TRAN-CODE
163570        MOVE 2                      TO UT0060CA-CALL-ACC-INVOLVED
163580     ELSE
163590        MOVE WA-INPUT-ACCT-NO       TO UT0060CA-CALL-ACC-NO
163600        MOVE STRT-AREA-TRN-NO       TO UT0060CA-CALL-TRAN-CODE
163610        MOVE 1                      TO UT0060CA-CALL-ACC-INVOLVED.
163630     MOVE 1                    TO UT0060CA-CALL-PROGRESS-FLAG.
163640     MOVE SPACE                TO UT0060CA-CALL-OVERRIDE-SGNL-OL.
163650*
163660*    IF THE TRAN IS A BATCH TRAN REPRESENTING A FEE CHARGING
163670*       TO CUSTOMER COUNT, THEN THE OVERRIDE CODE "61" WILL
163680*       ENABLE THE TRAN TO OVERRIDE ALL OVERRIDABLE ERRORS,
163690*       IF ANY. (I.E. ONE "61" MAY OVERRIDE MORE THAN ONE
163700*       OVERRIDABLE ERROR, IF NEACCESSARY).
163710*    IF (STRT-BATCH-TRICKLE-TXN) AND
163720*       (WA-OVER-RIDE = "XV" OR "TT")
163730*
163740***  SET UP OVERRIDE FIELDS FOR ALL BATCH/TRICKLE FEED TXNS -
163750***  UT0060 WILL DETERMINE WHETHER TXN SHOULD BE OVERRIDDEN OR NOT
163760*
163770     IF STRT-BATCH-TRICKLE-TXN
163790        MOVE "61"              TO UT0060CA-CALL-OVERRIDE-SIGNAL
163800        MOVE WA-OVER-RIDE      TO UT0060CA-CALL-OVERRIDE-SGNL-OL.
163820     MOVE 00                   TO UT0060CA-CALL-STATUS.
163830     MOVE STRT-AREA-BATCH-TANDEM TO WK-BATCH-TANDEM.
163850     CALL "UT0060" USING
163860                         UT0060CA-AREA
163870                         MULTI-OVERRIDE-AREA
163880                         UT0060-WORK-AREA.
163900     MOVE "Y"                  TO WA-CALL-UT0060-FLAG.
163920     IF UT0060CA-CALL-STATUS = 00
163930        GO TO Y090-EXIT.
163950     IF UT0060CA-CALL-STATUS = 99
163960*  **   THE CURRENT OVERRIDE SIGNAL HAS BEEN USED, SAVE/CLEAR IT
163970        MOVE WA-OVER-RIDE TO WA-OVER-RIDE-USED
163980        MOVE WA-SUPERVISOR-OVERRIDE-IN-USE TO
163990             WA-SUPERVISOR-OVERRIDE-USED
164000        MOVE SPACE TO WA-OVER-RIDE, WA-SUPERVISOR-OVERRIDE-IN-USE
164010        GO TO Y090-EXIT.
164030     IF UT0060CA-CALL-STATUS = 98
164040*  **   THE TRAN WAS OVERRIDEN BEFORE; RESTORE OLD OVERRIDE VALUE
164050        MOVE "69" TO WA-OVER-RIDE-USED
164060        IF UT0060CA-CALL-OVERRIDE-SGNL-OL = "69"
164070           MOVE SPACE TO WA-SUPERVISOR-OVERRIDE-USED
164080           GO TO Y090-EXIT
164090        ELSE
164100           MOVE UT0060CA-CALL-OVERRIDE-SIGN-OL TO
164110                WA-SUPERVISOR-OVERRIDE-USED
164120           GO TO Y090-EXIT.
164140     IF UT0060CA-CALL-STATUS = 97
164150*  **   BATCH TRAN WITH "61"; DON'T CLEAR OVERRIDE SIGNAL
164160        MOVE "61" TO WA-OVER-RIDE-USED
164170        MOVE WA-SUPERVISOR-OVERRIDE-IN-USE TO
164180             WA-SUPERVISOR-OVERRIDE-USED
164190        GO TO Y090-EXIT.
164210     MOVE 1 TO WA-MSG-ERR-FLAG.
164230     IF UT0060CA-CALL-STATUS = 01
164240        MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
164250        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
164260        MOVE SPACES TO UT8500CA-INPUT-MSG
164270        STRING "BR0000(N000) INVALID CALL CODE "
164280                UT0060CA-CALL-CODE
164290            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
164300        CALL "UT8500" USING
164320                            UT8500CA-AREA
164330        GO TO Y090-EXIT.
164350     IF UT0060CA-CALL-STATUS = 02
164360        MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
164370        MOVE UT0060CA-CALL-TELR-NO TO WA-DISPLAY-NUMBER1
164380        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
164390        MOVE SPACES TO UT8500CA-INPUT-MSG
164400        STRING "BR0000(N000) INVALID TELLER NO "
164410                WA-DISPLAY-NUMBER1
164420            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
164430        CALL "UT8500" USING
164450                            UT8500CA-AREA
164460        GO TO Y090-EXIT.
164480     IF UT0060CA-CALL-STATUS = 03 OR 09
164490        MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
164500        MOVE UT0060CA-CALL-TERM-NO TO WA-DISPLAY-NUMBER1
164510        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
164520        MOVE SPACES TO UT8500CA-INPUT-MSG
164530        STRING "BR0000(N000) INVALID TERMINAL NO "
164540                WA-DISPLAY-NUMBER1
164550            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
164560        CALL "UT8500" USING
164580                            UT8500CA-AREA
164590        GO TO Y090-EXIT.
164600     IF UT0060CA-CALL-STATUS = 04
164610        MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
164620        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
164630        MOVE SPACES TO UT8500CA-INPUT-MSG
164640        STRING "BR0000(N000) ERROR TABLE FULL ( > 10) "
164650            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
164660        CALL "UT8500" USING
164680                            UT8500CA-AREA
164690        GO TO Y090-EXIT.
164700     IF UT0060CA-CALL-STATUS = 05 OR 06 OR 07 OR 08
164710        MOVE UT0060CA-CALL-ERROR-CODE TO WA-OUTPUT-ERR-MSG-NO
164720        GO TO Y090-EXIT.
164740* ** CALL STATUS ERROR
164760     MOVE 155 TO WA-OUTPUT-ERR-MSG-NO.
164780     MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
164790     MOVE SPACES TO UT8500CA-INPUT-MSG
164800     STRING "BR0000(N000) UT0060 CALL ERROR "
164810             UT0060CA-CALL-STATUS
164820         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
164830     CALL "UT8500" USING
164850                         UT8500CA-AREA.
164860*
164870 Y090-EXIT.
164880     EXIT.
164890/
164900 Y100-CUSM-SECURITY.
164910     MOVE STRT-AREA-SOC-NO TO SEC-SOC-NO.
164920     MOVE "CUSM" TO SEC-SYSTEM.
164930     MOVE 71 TO DBIO-CALL-FUNC.
164940*
164950 Y110-READ.
164960     CALL "DBIO" USING
164980                       DBIO-CALL-PARAM
164990                       SEC-SYSTEM
165000                       SEC-KEY-AREA
165010                       SEC-STATUS
165020                       CUSM-RECORD-AREA.
165030     IF  SEC-STATUS NOT = "****"
165040         MOVE 108 TO WA-OUTPUT-ERR-MSG-NO
165050         MOVE 1 TO WA-MSG-ERR-FLAG
165060         GO TO Y199-EXIT.
165070     IF  CUSM-CUSTOMER-NO NOT = CUSM-CUST-ACCT-NO
165080         MOVE CUSM-CUSTOMER-NO TO SEC-KEY-NO
165090         GO TO Y110-READ.
165100     MOVE 1 TO UT0450-FUNCTION.
165110     MOVE "CUSM" TO UT0450-DETAILS-TYPE.
165120     CALL "UT0450" USING
165140                         UT0450-CALL-AREA
165150                         STARTAREA
165160                         CUSM-RECORD-AREA.
165170     IF  UT0450-STATUS NOT = 0
165180         MOVE UT0450-STATUS TO WA-OUTPUT-ERR-MSG-NO
165190         MOVE 1 TO WA-MSG-ERR-FLAG.
165200*
165210 Y199-EXIT.
165220     EXIT.
165230/
165240 Y200-BORM-SECURITY.
165250     MOVE 1 TO UT0450-FUNCTION.
165260     MOVE "BORM" TO UT0450-DETAILS-TYPE.
165270     CALL "UT0450" USING
165290                         UT0450-CALL-AREA
165300                         STARTAREA
165310                         BORM-RECORD-AREA.
165320     IF  UT0450-STATUS NOT = 0
165330         MOVE UT0450-STATUS TO WA-OUTPUT-ERR-MSG-NO
165340         MOVE 1 TO WA-MSG-ERR-FLAG
165350         GO TO Y299-EXIT.
165360     IF  SOC-ACCESS-SECURITY-IND = "C"
165370         MOVE BORM-CUSTOMER-NO TO SEC-KEY-NO
165380         PERFORM Y100-CUSM-SECURITY THRU Y199-EXIT.
165390*
165400 Y299-EXIT.
165410     EXIT.
165420/
165430 Z000-WRITE-JRNL.
165440*----------------------------------------------------------------
165450*       IF CLOSED ACCOUNT AND STATEMENT REQUIRED, WRITE THE
165460*       ENQUIRY HEADER TO THE JOURNAL, TO BE USED BY SECONDARY
165470*       UPDATE FOR STATEMENT PROCESSING.
165480*----------------------------------------------------------------
165490     IF STRT-AREA-TRN-NO = 16039 OR 16059
165500         MOVE WA-INPUT-AMT TO JNRST-AMOUNT
165510                         JNRST-TO-CURR-AMOUNT
165520         MOVE WA-MULTI-BASE-CURR-AMT TO
165530                JNRST-FROM-BASE-EQUIVALENT
165540                JNRST-TO-BASE-EQUIVALENT
165550         MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
165560                                   JNRST-FROM-CURRENCY-CODE
165570                                   JNRST-TO-CURRENCY-CODE.
165590        MOVE 0 TO JNRST-DEP-LON-STMT-HDR-NO
165600        MOVE STRT-AREA-XCURR-IND      TO JNRST-XCURR-IND.
165610        IF WA-INPUT-PARAM-TABLE(25) = 1
165620           IF BORM-STATEMENT-FREQUENCY = SPACE
165630              IF BORP-STATEMENT-FREQUENCY NOT = "N"
165640                 MOVE 051 TO JNRST-DEP-LON-STMT-HDR-NO
165650              END-IF
165660           ELSE
165670              IF BORM-STATEMENT-FREQUENCY NOT = "N"
165680                 MOVE 051 TO JNRST-DEP-LON-STMT-HDR-NO
165690              END-IF
165700           END-IF
165710        END-IF.
SC5775        IF STRT-ASYNC-TPS
SC5775           IF JNRST-AMOUNT > 0 AND
SC5775                  STRT-AREA-SIGN = "-"
SC7107           AND STRT-AREA-SIGN = LINK-SIGN
S10835           AND JNRST-SYST     = "BOR"
S12263           AND NOT (BORP-YOUBE AND
S12263               (JNRST-TRAN-CODE = 18430 OR 18423))
SC5775               COMPUTE JNRST-AMOUNT = JNRST-AMOUNT * -1
SC5775               MOVE JNRST-AMOUNT TO JNRST-TO-CURR-AMOUNT
SC5775            ELSE
SC5775               MOVE JNRST-AMOUNT TO JNRST-TO-CURR-AMOUNT
SC5775            END-IF
SC5775        END-IF
SC7190        IF JNRST-TRAN-CODE = 13528 OR 13628  
SC7190           MULTIPLY -1 BY JNRST-AMOUNT       
SC7190        END-IF.                              
SC9610* Internal txn code not to have 0 as JNRST-TRANSFER-TXN-BRANCH for BIT 29 = 1
SC9610        IF ST-LOAN-BACKDATED-CORR-YES
S12488        AND WA-REPAY-PROMO <> 'BA'
S15622        AND NOT WA-REPAY-PRN-RECALC-M
SC9610           MOVE STRT-AREA-BRANCH
SC9610                TO JNRST-TRANSFER-TXN-BRANCH
SC9610        END-IF.
165730        MOVE 2 TO SY0010CA-FUNC
165740        CALL "SY0010"   USING
165760                               SY0010CA-COMMON-AREA
165770                               WA-JRNL-CALL-AREA.
165780        IF  SY0010CA-STATUS NOT = 0
165790            MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
165800            MOVE 1 TO WA-MSG-ERR-FLAG
165810            MOVE "JRNL" TO WA-DBERR-DATA-SET
165820            MOVE "ERR" TO WA-DB-ERROR.
165830*
165840 Z009-EXIT.
165850     EXIT.
165860/
165870     COPY GLCCPROC IN LIBRYMIS.
165880*
APLEXD*-----------------------------------------------------------------
APLEXD
APLEXD Z200-PB-LINE-CHK.
APLEXD     IF PBOOKCA-LINE-CNT > 0
APLEXD        PERFORM Z300-PB-LINE-PRINT THRU Z399-EXIT
APLEXD                VARYING PBOOK-I FROM 1 BY 1
APLEXD                UNTIL PBOOK-I > PBOOKCA-LINE-CNT
APLEXD     END-IF.
APLEXD     IF PBOOKCA-RCPT-CNT > 0
APLEXD        PERFORM Z400-RCPT-PRINT THRU Z499-EXIT
APLEXD                VARYING RCPT-I FROM 1 BY 1
APLEXD                UNTIL RCPT-I > PBOOKCA-RCPT-CNT
APLEXD     END-IF.
APLEXD     IF PBOOKCA-CHQ-CNT > 0
APLEXD        PERFORM Z500-CHQ-PRINT THRU Z559-EXIT
APLEXD                VARYING CHQ-I FROM 1 BY 1
APLEXD                UNTIL CHQ-I > PBOOKCA-CHQ-CNT
APLEXD     END-IF.
APLEXD Z299-EXIT.
APLEXD     EXIT.
APLEXD
APLEXD Z300-PB-LINE-PRINT.
APLEXD     MOVE PBOOKCA-LINE-MSG (PBOOK-I) TO WA-PBOOK-OUTPUT-DATA.
APLEXD     CALL "FT0000" USING STARTAREA.
APLEXD Z399-EXIT.
APLEXD     EXIT.
APLEXD
APLEXD Z400-RCPT-PRINT.
APLEXD     MOVE PBOOKCA-RCPT-MSG (RCPT-I) TO WA-PBOOK-OUTPUT-DATA.
APLEXD     CALL "FT0000" USING STARTAREA.
APLEXD Z499-EXIT.
APLEXD     EXIT.
APLEXD
APLEXD Z500-CHQ-PRINT.
APLEXD     MOVE PBOOKCA-CHQ-MSG (CHQ-I) TO WA-PBOOK-OUTPUT-DATA.
APLEXD     CALL "FT0000" USING STARTAREA.
APLEXD Z559-EXIT.
APLEXD     EXIT.
APLEXD*-----------------------------------------------------------------
166290*
166300 Z500-GLCC-TRANSFER-PROCESS.
166320     MOVE BORM-GL-CLASSIFICATION-CODE TO WA-SOUR-GL-CLASS-CODE.
166330     MOVE WA-SOUR-GL-CLASS-CODE       TO W190-GL-CLASS-CODE.
166340     MOVE SOC-GL-CLASS-CODE-STRUCTURE TO W190-GL-CODE-STRUCT.
166350     PERFORM X100-GLCC-SPLIT THRU
166360             X109-EXIT.
166370     MOVE W190-GL-CLASS-CODE(W190-BRCH-START:W190-BRCH-LEN)
166380          TO UT0099CA-BRANCH.
166400     IF WA-17046-BRANCH-CHANGE = "Y"
166410          MOVE WA-IN-17046-NEW-BRANCH TO UT0099CA-BRANCH.
166430     MOVE W190-GL-CLASS-CODE(W190-SEG-START:W190-SEG-LEN)
166440          TO UT0099CA-SEGMENT.
166450     MOVE W190-GL-CLASS-CODE(W190-CCY-START:W190-CCY-LEN)
166460          TO UT0099CA-CURRENCY.
166470     MOVE W190-GL-CLASS-CODE(W190-GROUP-START:W190-GROUP-LEN)           
166480          TO UT0099CA-GROUP-CODE.                                       
166490     MOVE WA-SAVE-COMPONENT-1   TO UT0099CA-COMPONENT-1.
166500     MOVE WA-SAVE-COMPONENT-2   TO UT0099CA-COMPONENT-2.
166510     MOVE SOC-GL-CLASS-CODE-STRUCTURE
166520             TO UT0099CA-GLCC-STRUCTURE.
166530     CALL "UT0099" USING
166550                   UT0099CA-AREA.
166560     IF UT0099CA-RETURN-STATUS NOT = 0
166570        MOVE 2083 TO WA-OUTPUT-ERR-MSG-NO
166580        MOVE 1 TO WA-MSG-ERR-FLAG
166590        GO TO Z599-EXIT.
166610     MOVE UT0099CA-GLCC-OUTPUT-KEY TO WA-DEST-GL-CLASS-CODE.
SC6855     IF BORP-YOUBE
              MOVE "Y" TO WS-TRANSFER-IND
              MOVE UT0099CA-GLCC-OUTPUT-KEY TO
                          WS-BORM-GL-CLASS-CODE
SC6855     END-IF.
166630* IF BOTH THE GLCC ARE SAME, THEN TRANSFER ENTRY IS NOT REQUIRED.
166640     IF WA-SOUR-GL-CLASS-CODE = WA-DEST-GL-CLASS-CODE
166650        GO TO Z599-EXIT.
166660*
166670* UPDATE GLCC FOR BORM RECORD
166680     MOVE WA-DEST-GL-CLASS-CODE TO BORM-GL-CLASSIFICATION-CODE.
SC2908*    IF BORP-YOUBE AND STRT-AREA-TRN-NO = 11110
SC8276*    IF BORP-YOUBE 
SC8276*      IF WA-INPUT-PARAM-TABLE(4) = 1 AND
SC8276*        WA-INPUT-PARAM-TABLE(7) = 1
SC8276*        MOVE WA-SOUR-GL-CLASS-CODE to BORM-GL-CLASSIFICATION-CODE
SC8276*      END-IF
SC8276*    END-IF
166690*
166700     INITIALIZE JNRST-DB-DATA
166710* MOVE GLCC FIELDS TO JOURNAL RECORD.
166720     MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE.
166730     MOVE WA-DEST-GL-CLASS-CODE TO JNRST-XFER-GL-CLASS-CODE.
166740     MOVE BORP-CGL-POSTING-IND  TO JNRST-CGL-POSTING-IND.
166750*
166760     MOVE "BOR"                TO JNRST-SYST.
166770     MOVE STRT-AREA-MSG-TIME   TO JNRST-TIME.
166780     MOVE STRT-AREA-SOC-NO     TO JNRST-SOC.
166790     IF (STRT-AREA-TRN-NO = 10071 OR 15071)
166800         MOVE WA-ADV-LOC-ACCT-NO   TO JNRST-CUSM-NO
166810     ELSE
166820         MOVE WA-INPUT-ACCT-NO     TO JNRST-CUSM-NO.
166830     MOVE STRT-AREA-BRANCH         TO JNRST-BRCH.
NR2001*166840     MOVE BORV-01-CODE             TO JNRST-TRN-TYP.
NR2001     MOVE BOCT-TRAN-TYPE           TO JNRST-TRN-TYP.
166850     MOVE STRT-AREA-TERM-NO        TO JNRST-TERMNL.
166860     MOVE STRT-AREA-TELL-NO        TO JNRST-TELLER.
166870* MOVE (98904) INTERNAL ACCOUNT BALANCE
166880* TRANSFER TRANSACTION CODE
166890*
166900     MOVE 98904                    TO JNRST-TRAN-CODE
166910                                      LINK-IN-TXCODE.
SC2908     IF BORP-YOUBE
SC2908*    IF JNRST-TRAN-CODE = 98904 AND STRT-AREA-TRN-NO = 11110
SC2908     IF JNRST-TRAN-CODE = 98904
SC2908       IF WA-INPUT-PARAM-TABLE(4) = 1 AND
SC2908         WA-INPUT-PARAM-TABLE(7) = 1
SC2908        MOVE WA-DEST-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
SC2908        MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-XFER-GL-CLASS-CODE
SC2908       END-IF
SC2908     END-IF
SC2908     END-IF
166920     PERFORM X700-CALL-UT0250 THRU
166930             X799-EXIT.
166940     IF WA-MSG-ERR-FLAG = 1
166950             GO TO Z599-EXIT.
166960     MOVE LINK-EDIT-TABLE          TO JNRST-EDIT-MASK.
166970     MOVE BORM-CURRENCY-IND        TO JNRST-CURRENCY-CODE.
166980     MOVE STRT-AREA-POST-DT        TO JNRST-POST-DATE.
166990     IF  WA-INPUT-PARAM-TABLE(8) = 1
167000         MOVE WA-STORE-TXN-DT      TO JNRST-TRAN-DATE
167010     ELSE
167020         MOVE STRT-AREA-POST-DT    TO JNRST-TRAN-DATE.
167030     MOVE STRT-AREA-JRNL-NO        TO JNRST-JRNL-NO.
167040     MOVE BORM-BR-NO               TO JNRST-HOME-BRNCH.
167050     MOVE BORM-ACT-TYPE            TO JNRST-ACC-TYPE.
167060     MOVE BORM-CAT                 TO JNRST-INT-CAT.
167070     MOVE WA-GLCC-XFER-AMOUNT      TO JNRST-BALANCE
167080                                      JNRST-AMOUNT.
167090     MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
167100                                      JNRST-TO-CURRENCY-CODE.
167110     MOVE 1                        TO JNRST-FLAG.
167120     MOVE ZEROES                   TO JNRST-NEW-ACC-FLG
167130                                      JNRST-LIM-TOL-FLAG
167140                                      JNRST-BOR-GROUP.
167150     MOVE SPACES                   TO JNRST-ATM-SAF-FLAG.
167160     IF BORM-CURRENCY-IND = SOC-NATIVE-CURRENCY
167170        GO TO Z500-WRITE-GLCC-XFER-JRNL.
167180* GET BASE CURRENCY EQUIVALENT FOR ACCOUNT BALANCE.
167190     MOVE UT0296-CALL-AREA         TO WA-SAVE-UT0296CA-AREA.
167200     MOVE 3                        TO UT0296CA-CALL-CODE.
167210     MOVE "LON"                    TO UT0296CA-SYSTEM.
167220     MOVE BORM-CURRENCY-IND        TO UT0296CA-FROM-CURRENCY
167230                                      UT0296CA-TO-CURRENCY.
167240     MOVE WA-GLCC-XFER-AMOUNT      TO UT0296CA-FROM-AMOUNT
167250                                      UT0296CA-TO-AMOUNT.
167260     MOVE "ZZZZ" TO UT0296CA-RATE-VERSION.
167270     MOVE 01     TO UT0296CA-RATE-TYPE.
167280     MOVE SPACES    TO UT0296CA-USER-CODES-LON.
167290     MOVE ZEROES    TO UT0296CA-COMMISSION
167300                       UT0296CA-CHANGE
167310                       UT0296CA-BACKDATED-DATE
167320                       UT0296CA-FROM-BASE-EQUIVALENT.
167330     INITIALIZE        UT0296CA-MULTI-FROM-AMOUNTS.
167340     CALL "UT0296" USING
167360                       UT0296-CALL-AREA
167370                       STRT-AREA-DATA
167380                       SOC-PARAMS.
167390     IF UT0296CA-CALL-STATUS NOT = 0
167400        MOVE UT0296CA-CALL-STATUS  TO WA-OUTPUT-ERR-MSG-NO
167410        MOVE 1                     TO WA-MSG-ERR-FLAG
167420        GO TO Z599-EXIT.
167430     MOVE UT0296RA-FROM-RATE       TO JNRST-FROM-CURRENCY-RATE.
167440     MOVE UT0296RA-EQUIV-BASE-AMOUNT TO
167450          JNRST-FROM-BASE-EQUIVALENT
167460          JNRST-TO-BASE-EQUIVALENT.
167470     MOVE UT0296CA-RATE-TYPE       TO JNRST-RATE-TYPE.
167480     MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
167490                                      JNRST-TO-CURRENCY-CODE.
167500*
167510* MOVE SAVED UT0296 AREA BACK TO ORIGINAL BUFFER.
167520*
167530     MOVE WA-SAVE-UT0296CA-AREA    TO UT0296-CALL-AREA.
167540 Z500-WRITE-GLCC-XFER-JRNL.
167550     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
167560     IF  WA-MSG-ERR-FLAG = 1
167570         GO TO Z599-EXIT.
167580*
167590 Z599-EXIT.
167600     EXIT.
TB0155*
TB0155* FSLON0041 : GL POSTING
TB0155*
TB0219 Z600-SEARCH-BUCKET-TRN.
SC1599     MOVE ZEROES TO WA-BUCKET-TRAN-X. 
TB0219     SET IX-BU TO 1
TB0219     SEARCH   WA-BUCKETS-TRAN-CODE
TB0219         AT   END
TB0219              DISPLAY "BR0000: CODE/PRIORITY NOT FOUND"
TB0219                      ", PRIORITY CODE: " WA-PRIORITY-CDE
TB0219              MOVE 1 TO WA-MSG-ERR-FLAG
TB0219         WHEN WA-PRIORITY-CDE = WA-BU-PRIORITY-CODE (IX-BU)
SC4881              MOVE WA-BU-CORR-TRAN-CODE (IX-BU) TO         
SC4881                                        WA-CORR-BUCKET-TRAN
TB0219              MOVE WA-BU-TRAN-CODE (IX-BU) TO WA-BUCKET-TRAN.
TB0219 Z609-EXIT.
TB0219      EXIT.
SC4881*                                                                 
SC4881 Z610-SEARCH-BUCKET-VIA-TRAN.                                     
SC4881     MOVE SPACES TO WA-PRIORITY-CDE.                              
SC4881     SET IX-BU TO 1                                               
SC4881     SEARCH   WA-BUCKETS-TRAN-CODE                                
SC4881         AT   END                                                 
SC4881              DISPLAY "BR0000: CODE/PRIORITY NOT FOUND"           
SC4881                      ", PRIORITY CODE: " WA-PRIORITY-CDE         
SC4881         WHEN WA-BUCKET-TRAN = WA-BU-TRAN-CODE (IX-BU)            
SC4881              MOVE WA-BU-PRIORITY-CODE (IX-BU) TO WA-PRIORITY-CDE.
SC4881                                                                  
SC4881 Z619-EXIT.                                                       
SC4881      EXIT.                                                       
SC4881*                                                                 
SC4881 Z620-SEARCH-BUCKET-VIA-CORR.                                     
SC4881     MOVE SPACES TO WA-PRIORITY-CDE.                              
SC4881     SET IX-BU TO 1                                               
SC4881     SEARCH   WA-BUCKETS-TRAN-CODE                                
SC4881         AT   END                                                 
SC4881              DISPLAY "BR0000: CODE/PRIORITY NOT FOUND"           
SC4881                      ", PRIORITY CODE: " WA-PRIORITY-CDE         
SC4881         WHEN WA-BUCKET-TRAN = WA-BU-CORR-TRAN-CODE (IX-BU)       
SC4881              MOVE WA-BU-PRIORITY-CODE (IX-BU) TO WA-PRIORITY-CDE.
SC4881           
SC4881 Z629-EXIT.
SC4881      EXIT.
TB0155 Z650-17046-MISC-GL-RTN.
SC1599     MOVE JNRST-BALANCE           TO WS-HOLD-JRNST-BALANCE
SC1599     MOVE JNRST-AMOUNT            TO WS-HOLD-JRNST-AMOUNT.
TB0155     INITIALIZE JNRST-DB-DATA
SC1599     MOVE WS-HOLD-JRNST-BALANCE   TO JNRST-BALANCE
SC1599     MOVE WS-HOLD-JRNST-AMOUNT    TO JNRST-AMOUNT.
SC8878     MOVE WA-IN-17046-OLD-BRANCH     TO JNRST-OLD-HOME-BRANCH.
SC8878     MOVE WA-IN-17046-NEW-BRANCH     TO JNRST-NEW-HOME-BRANCH.
SC8878     MOVE WA-IN-17046-OLD-ACCT-TYPE  TO JNRST-OLD-ACCT-TYPE.
SC8878     MOVE WA-IN-17046-NEW-ACCT-TYPE  TO JNRST-NEW-ACCT-TYPE.
SC8878     MOVE WA-IN-17046-OLD-ACCT-CAT   TO JNRST-OLD-INT-CAT.
SC8878     MOVE WA-IN-17046-NEW-ACCT-CAT   TO JNRST-NEW-INT-CAT.
TB0219     PERFORM Z680-GET-BUCKET-GLCC THRU Z689-EXIT.
TB0219     IF WA-MSG-ERR-FLAG = 1
TB0219             GO TO Z669-EXIT.
TB0219     PERFORM Z600-SEARCH-BUCKET-TRN THRU Z609-EXIT.
TB0219     IF WA-MSG-ERR-FLAG = 1
TB0219             GO TO Z669-EXIT.
TB0155     MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE.
TB0155     MOVE WA-DEST-GL-CLASS-CODE TO JNRST-XFER-GL-CLASS-CODE.
TB0155     MOVE BORP-CGL-POSTING-IND  TO JNRST-CGL-POSTING-IND.
TB0155*
TB0155     MOVE "BOR"                TO JNRST-SYST.
TB0155     MOVE STRT-AREA-MSG-TIME   TO JNRST-TIME.
TB0155     MOVE STRT-AREA-SOC-NO     TO JNRST-SOC.
TB0155     MOVE WA-INPUT-ACCT-NO     TO JNRST-CUSM-NO.
TB0155     MOVE STRT-AREA-BRANCH         TO JNRST-BRCH.
NR2001*TB0155     MOVE BORV-01-CODE             TO JNRST-TRN-TYP.
NR2001     MOVE BOCT-TRAN-TYPE           TO JNRST-TRN-TYP.
TB0155     MOVE STRT-AREA-TERM-NO        TO JNRST-TERMNL.
TB0155     MOVE STRT-AREA-TELL-NO        TO JNRST-TELLER.
TB0155* MOVE (98904) INTERNAL ACCOUNT BALANCE
TB0155* TRANSFER TRANSACTION CODE
TB0155*
TB0155     MOVE 98904                    TO JNRST-TRAN-CODE
TB0155                                      LINK-IN-TXCODE.
TB0155     PERFORM X700-CALL-UT0250 THRU
TB0155             X799-EXIT.
TB0155     IF WA-MSG-ERR-FLAG = 1
TB0155             GO TO Z669-EXIT.
TB0155     MOVE LINK-EDIT-TABLE          TO JNRST-EDIT-MASK.
TB0155     MOVE BORM-CURRENCY-IND        TO JNRST-CURRENCY-CODE.
TB0155     MOVE STRT-AREA-POST-DT        TO JNRST-POST-DATE.
TB0155     IF  WA-INPUT-PARAM-TABLE(8) = 1
TB0155         MOVE WA-STORE-TXN-DT      TO JNRST-TRAN-DATE
TB0155     ELSE
TB0155         MOVE STRT-AREA-POST-DT    TO JNRST-TRAN-DATE.
TB0155     MOVE STRT-AREA-JRNL-NO        TO JNRST-JRNL-NO.
TB0155     MOVE BORM-BR-NO               TO JNRST-HOME-BRNCH.
TB0155     MOVE BORM-ACT-TYPE            TO JNRST-ACC-TYPE.
TB0155     MOVE BORM-CAT                 TO JNRST-INT-CAT.
TB0155*    MOVE WA-GLCC-XFER-AMOUNT      TO JNRST-BALANCE
TB0155*    MOVE WS-UN-AMORTIZED-AMT       TO JNRST-BALANCE
TB0155*                                      JNRST-AMOUNT.
TB0155     MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
TB0155                                      JNRST-TO-CURRENCY-CODE.
TB0155     MOVE 1                        TO JNRST-FLAG.
TB0155     MOVE ZEROES                   TO JNRST-NEW-ACC-FLG
TB0155                                      JNRST-LIM-TOL-FLAG
TB0155                                      JNRST-BOR-GROUP.
TB0155     MOVE SPACES                   TO JNRST-ATM-SAF-FLAG.
SC1599     MOVE WA-BUCKET-TRAN-NO        TO JNRST-BUCKET-TRN-CODE.
SC3441     EVALUATE WA-PRIORITY-CDE
SC3441       WHEN 'R'
SC3441          MOVE '013540'            TO JNRST-BUCKET-TRN-CODE
S17182          IF   WA-ACCRUAL          =  'X'
S17182               MOVE '018420'       TO JNRST-BUCKET-TRN-CODE
S17182          END-IF
SC4000       WHEN 'I'
SC4000          IF  WA-ACCRUAL           =  'Y'
S16081              IF  (BORM-CAPN-METHOD = "X" OR
S16081                  (BORM-CAPN-METHOD = " " AND
S16081                   BORP-CAPN-METHOD = "X"))
S16081                   MOVE '013730' TO JNRST-BUCKET-TRN-CODE
S16081              ELSE
SC4000                   MOVE '013509'        TO JNRST-BUCKET-TRN-CODE
S16081              END-IF
SC4000          END-IF
SC3441     END-EVALUATE.
SC3441**   MOVE "Y"                      TO JNRST-BUCKET-FLAG.
SC3441     MOVE WA-BUCKET-FLAG           TO JNRST-BUCKET-FLAG.
TB0155     IF BORM-CURRENCY-IND = SOC-NATIVE-CURRENCY
TB0155        GO TO Z660-WRITE-GLCC-XFER-JRNL.
TB0155* GET BASE CURRENCY EQUIVALENT FOR ACCOUNT BALANCE.
TB0155     MOVE UT0296-CALL-AREA         TO WA-SAVE-UT0296CA-AREA.
TB0155     MOVE 3                        TO UT0296CA-CALL-CODE.
TB0155     MOVE "LON"                    TO UT0296CA-SYSTEM.
TB0155     MOVE BORM-CURRENCY-IND        TO UT0296CA-FROM-CURRENCY
TB0155                                      UT0296CA-TO-CURRENCY.
TB0155     MOVE WA-GLCC-XFER-AMOUNT      TO UT0296CA-FROM-AMOUNT
TB0155                                      UT0296CA-TO-AMOUNT.
TB0155     MOVE "ZZZZ" TO UT0296CA-RATE-VERSION.
TB0155     MOVE 01     TO UT0296CA-RATE-TYPE.
TB0155     MOVE SPACES    TO UT0296CA-USER-CODES-LON.
TB0155     MOVE ZEROES    TO UT0296CA-COMMISSION
TB0155                       UT0296CA-CHANGE
TB0155                       UT0296CA-BACKDATED-DATE
TB0155                       UT0296CA-FROM-BASE-EQUIVALENT.
TB0155     INITIALIZE        UT0296CA-MULTI-FROM-AMOUNTS.
TB0155     CALL "UT0296" USING
TB0155
TB0155                       UT0296-CALL-AREA
TB0155                       STRT-AREA-DATA
TB0155                       SOC-PARAMS.
TB0155     IF UT0296CA-CALL-STATUS NOT = 0
TB0155        MOVE UT0296CA-CALL-STATUS  TO WA-OUTPUT-ERR-MSG-NO
TB0155        MOVE 1                     TO WA-MSG-ERR-FLAG
TB0155        GO TO Z669-EXIT.
TB0155     MOVE UT0296RA-FROM-RATE       TO JNRST-FROM-CURRENCY-RATE.
TB0155     MOVE UT0296RA-EQUIV-BASE-AMOUNT TO
TB0155          JNRST-FROM-BASE-EQUIVALENT
TB0155          JNRST-TO-BASE-EQUIVALENT.
TB0155     MOVE UT0296CA-RATE-TYPE       TO JNRST-RATE-TYPE.
TB0155     MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
TB0155                                      JNRST-TO-CURRENCY-CODE.
TB0155*
TB0155* MOVE SAVED UT0296 AREA BACK TO ORIGINAL BUFFER.
TB0155*
TB0155     MOVE WA-SAVE-UT0296CA-AREA    TO UT0296-CALL-AREA.
TB0155 Z659-17046-EXIT.
TB0155     EXIT.
TB0155 Z660-WRITE-GLCC-XFER-JRNL.
TB0155     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
TB0155     IF  WA-MSG-ERR-FLAG = 1
TB0155         GO TO Z669-EXIT.
TB0155 Z669-EXIT.
TB0155     EXIT.
TB0155*
TB0155 Z670-GET-BOIS-RTN.
TB0155     IF WS-BOIS-EOF EQUAL ZEROES AND
TB0155        WS-TRAN-TEMP EQUAL 17046
TB0155       IF BOIS-MISC-FEE1-DUE > ZEROES      
SC1599*         BOIS-MISC-FEE1-DUE NUMERIC
TB0155          MOVE BOIS-MISC-FEE1-DUE     TO JNRST-BALANCE
TB0155                                        JNRST-AMOUNT
TB0219          MOVE BOIS-MISC-FEE1-CDE TO WA-PRIORITY-CDE
TB0155          PERFORM Z650-17046-MISC-GL-RTN THRU
TB0155                  Z669-EXIT
TB0155       END-IF
TB0219       IF BOIS-LEGAL-FEE1-DUE > ZEROES      
SC1599          MOVE BOIS-LEGAL-FEE1-DUE    TO JNRST-BALANCE
TB0155                                        JNRST-AMOUNT
TB0219          MOVE BOIS-LEGAL-FEE1-CDE TO WA-PRIORITY-CDE
TB0155          PERFORM Z650-17046-MISC-GL-RTN THRU
TB0155                  Z669-EXIT
TB0155       END-IF
SC1599*      IF BOIS-PENALTY-DUE > ZEROES      
SC1599*         MOVE BOIS-PENALTY-DUE    TO JNRST-BALANCE
SC1599*                                       JNRST-AMOUNT
SC1599*         MOVE BOIS-PENALTY-CDE TO WA-PRIORITY-CDE
SC1599*         PERFORM Z650-17046-MISC-GL-RTN THRU
SC1599*                 Z669-EXIT
SC1599*      END-IF
TB0219       IF BOIS-DEFERRED-INT-DUE > ZEROES    
SC1599          MOVE BOIS-DEFERRED-INT-DUE    TO JNRST-BALANCE
TB0155                                        JNRST-AMOUNT
TB0219          MOVE BOIS-DEFERRED-INT-CDE TO WA-PRIORITY-CDE
TB0155          PERFORM Z650-17046-MISC-GL-RTN THRU
TB0155                  Z669-EXIT
TB0155       END-IF
SC1599       IF BOIS-INTEREST-DUE > ZEROES    
SC1599          MOVE BOIS-INTEREST-DUE    TO JNRST-BALANCE
TB0155                                        JNRST-AMOUNT
TB0219          MOVE BOIS-INTEREST-CDE TO WA-PRIORITY-CDE
TB0155          PERFORM Z650-17046-MISC-GL-RTN THRU
TB0155                  Z669-EXIT
TB0155       END-IF
TB0219*      IF BOIS-PRINCIPAL > ZEROES AND
TB0219*         BOIS-PRINCIPAL NUMERIC
TB0219*         MOVE BOIS-PRINCIPAL        TO JNRST-BALANCE
TB0219*                                       JNRST-AMOUNT
TB0219*         PERFORM Z650-17046-MISC-GL-RTN THRU
TB0219*                 Z669-EXIT
TB0219*      END-IF
TB0219*      IF BOIS-FEES-AND-CHARGES > ZEROES AND
SC1599       IF BOIS-FEES-AND-CHARGES-DUE > ZEROES     
SC1599*         BOIS-FEES-AND-CHARGES NUMERIC
SC1599          MOVE BOIS-FEES-AND-CHARGES-DUE    TO JNRST-BALANCE
TB0155                                        JNRST-AMOUNT
TB0219          MOVE BOIS-FEES-AND-CHARGES-CDE TO WA-PRIORITY-CDE
TB0155          PERFORM Z650-17046-MISC-GL-RTN THRU
TB0155                  Z669-EXIT
TB0155       END-IF
SC1599       IF BOIS-MISC-FEE2-DUE > ZEROES
SC1599          MOVE BOIS-MISC-FEE2-DUE          TO JNRST-BALANCE
SC1599                                              JNRST-AMOUNT
SC1599          MOVE BOIS-MISC-FEE2-CDE          TO WA-PRIORITY-CDE
SC1599          PERFORM Z650-17046-MISC-GL-RTN THRU Z669-EXIT
SC1599       END-IF
SC1599       IF BOIS-LEGAL-FEE2-DUE > ZEROES
SC1599          MOVE BOIS-LEGAL-FEE2-DUE         TO JNRST-BALANCE
SC1599                                              JNRST-AMOUNT
SC1599          MOVE BOIS-LEGAL-FEE2-CDE         TO WA-PRIORITY-CDE
SC1599          PERFORM Z650-17046-MISC-GL-RTN THRU Z669-EXIT
SC1599       END-IF
SC1599       IF BOIS-TEMP-PAYMENT-DUE > ZEROES
SC1599          MOVE BOIS-TEMP-PAYMENT-DUE       TO JNRST-BALANCE
SC1599                                              JNRST-AMOUNT
SC1599          MOVE BOIS-TEMP-PAYMENT-CDE       TO WA-PRIORITY-CDE
SC1599          PERFORM Z650-17046-MISC-GL-RTN THRU Z669-EXIT
SC1599       END-IF
SC1599       IF BOIS-REV-RECEIVABLE-DUE > ZEROES
SC1599          MOVE BOIS-REV-RECEIVABLE-DUE     TO JNRST-BALANCE
SC1599                                              JNRST-AMOUNT
SC1599          MOVE BOIS-REV-RECEIVABLE-CDE     TO WA-PRIORITY-CDE
SC1599          PERFORM Z650-17046-MISC-GL-RTN THRU Z669-EXIT
SC1599       END-IF
TB0155     END-IF.
TB0155     MOVE 1                      TO WS-BOIS-EOF.
TB0155 Z679-GET-EXIT.
TB0155     EXIT.
TB0155*
SC3441 Z670A-GET-BOIS-RTN.
SC8878     IF WA-IN-17046-OLD-BRANCH NOT = WA-IN-17046-NEW-BRANCH
SC8878        SET WA-98904-BRANCH-CHANGE TO TRUE
SC8878     ELSE
SC8878        SET WA-98904-PROD-CHANGE TO TRUE
SC8878     END-IF.
SC4000     MOVE   'N'                  TO WA-ACCRUAL.
           PERFORM
             VARYING WA-SUB1 FROM 1 BY 1
               UNTIL WA-SUB1 > WA-MAX-HIST
S16038         MOVE  BOIS-BUCKET-DUE(WA-SUB1) TO  WA-BOIS-BUCKET-DUE
S16038         IF  BOIS-BUCKET-CDE(WA-SUB1) = "I"
S16038           ADD  BOIS-DEF-BUCKET-AMT     TO  WA-BOIS-BUCKET-DUE
S16038         END-IF
S16038*               IF BOIS-BUCKET-DUE(WA-SUB1) > 0       AND
S16038         IF  WA-BOIS-BUCKET-DUE      > 0       AND
SC3441**          BOIS-BUCKET-CDE(WA-SUB1) NOT = "P"
SC3441           (BOIS-BUCKET-CDE(WA-SUB1) NOT = "P" AND "A")
S17182         AND (WA-SUB1 <> 14)
SC8878* EVERYTHING EXCEPT P AND A MOVE WHEN BRANCH CHANGE
SC8878* ONLY "I" NEED TO MOVE WHEN PROD CHANGE
SC8878         AND (WA-98904-BRANCH-CHANGE
SC8878                 OR
SC8878             (WA-98904-PROD-CHANGE AND
SC8878                BOIS-BUCKET-CDE(WA-SUB1) = "I"))
S16038*                  MOVE BOIS-BUCKET-DUE(WA-SUB1)  TO JNRST-BALANCE
S16038            MOVE WA-BOIS-BUCKET-DUE        TO JNRST-BALANCE
                                                    JNRST-AMOUNT
                  MOVE BOIS-BUCKET-CDE(WA-SUB1)  TO WA-PRIORITY-CDE
SC3441** ---  FOR CONTROL AT SY1000 --- **
SC3441            MOVE 'L'                       TO WA-BUCKET-FLAG
                  PERFORM Z650-17046-MISC-GL-RTN THRU Z669-EXIT
SC3441** ---  FOR CONTRA  AT SY1000 --- **
SC3441            IF   WA-PRIORITY-CDE           =  'R'
SC3441                 MOVE 'A'                  TO WA-BUCKET-FLAG
SC3441                 MULTIPLY -1               BY JNRST-AMOUNT
SC3441                 PERFORM Z650-17046-MISC-GL-RTN THRU Z669-EXIT
SC3441            END-IF
               END-IF
           END-PERFORM.
S17182     IF BOIS-PRE-RECEIVABLE   > 0
S17182***     TEMPORARILY SET PRIORITY-CDE=R FOR SIMPLE FIX  ***
S17182        MOVE 'R'                      TO WA-PRIORITY-CDE
S17182        MOVE 'A'                      TO WA-BUCKET-FLAG
S17182        MOVE 'X'                      TO WA-ACCRUAL
S17182        MOVE BOIS-PRE-RECEIVABLE      TO JNRST-BALANCE
S17182                                         JNRST-AMOUNT
S17182        MULTIPLY -1                   BY JNRST-AMOUNT
S17182        PERFORM Z650-17046-MISC-GL-RTN THRU Z669-EXIT
S17182        MOVE   'N'                    TO WA-ACCRUAL
S17182     END-IF.
S15078     IF BOIS-AGREE-INT-BUCKET > 0
S15078        MOVE BOIS-AGREE-INT-BUCKET    TO JNRST-BALANCE
S15078                                         JNRST-AMOUNT
S15078        MOVE 'I'                      TO WA-PRIORITY-CDE
S15078        MOVE 'L'                      TO WA-BUCKET-FLAG
S15078        PERFORM Z650-17046-MISC-GL-RTN  THRU Z669-EXIT
S15078     END-IF.
SC4000**   IF  BORM-INT-ACCR                     >  0
SC6465     IF (BORM-INT-ACCR + BORM-INT-ADJUSTMENT) > 0
SC4000         COMPUTE WA-REPAY-AMT-TMP1-CORR ROUNDED = BORM-INT-ACCR
SC6465                                          + BORM-INT-ADJUSTMENT
SC4000         MOVE WA-REPAY-AMT-TMP1-CORR       TO JNRST-BALANCE
SC4000                                              JNRST-AMOUNT
SC4000         MOVE 'Y'                          TO WA-ACCRUAL
SC4000         MOVE 'I'                          TO WA-PRIORITY-CDE
SC4000         MOVE 'A'                          TO WA-BUCKET-FLAG
SC4000         PERFORM Z650-17046-MISC-GL-RTN  THRU Z669-EXIT
SC4000     END-IF.
SC3491     MOVE WA-SOUR-GL-CLASS-CODE    TO WA-GL-CLASS-CODE-S.
SC3491     MOVE WA-DEST-GL-CLASS-CODE    TO WA-GL-CLASS-CODE-D.
SC3491     MOVE BORM-GL-CLASSIFICATION-CODE TO WA-SAVE-GL-CLASS-CODE.
SC3491     PERFORM Z6A0-PROCESS-CIEA   THRU Z6A9-EXIT.
SC3491     MOVE WA-GL-CLASS-CODE-S       TO WA-SOUR-GL-CLASS-CODE.
SC3491     MOVE WA-GL-CLASS-CODE-D       TO WA-DEST-GL-CLASS-CODE.
SC3491     MOVE WA-SAVE-GL-CLASS-CODE TO BORM-GL-CLASSIFICATION-CODE.
       Z679A-GET-EXIT.
SC3441     EXIT.
TB0155/
TB0219 Z680-GET-BUCKET-GLCC.
TB0219     MOVE 0           TO WA-BTRN-REC-CTR
TB0219     INITIALIZE          BTRN-DATA-KEY
TB0219     MOVE BORM-SOC-NO TO BTRN-INST-NO
SC4881     IF WA-INPUT-PARAM-TABLE (25) = 1                 
SC4881      AND WA-DUMMY-LST-TWO > 0                        
SC4881**      COMPUTE BTRN-ORIG-TRAN =  WA-DUMMY-LST-TWO - 1
SC4881        COMPUTE BTRN-ORIG-TRAN =  WA-DUMMY-LST-TWO
SC4881     END-IF.                                          
TB0219     MOVE "LON"       TO BTRN-SYSTEM
TB0219     SET IX-BU        TO 1
TB0219     SET IX-BU        DOWN BY 1
TB0219     PERFORM Z690-READ-BUCKETS THRU Z699-EXIT
SC6548     MOVE 0 TO WA-EOF-FLAG
TB0219     PERFORM UNTIL WA-END-OF-FILE
TB0219         PERFORM VARYING WA-TRN-CTR FROM 1 BY 1
TB0219                 UNTIL   WA-TRN-CTR > WA-MAX-HIST
TB0219            IF BTRN-PR-CODE(WA-TRN-CTR) NOT = SPACES AND
TB0219               BTRN-NORM-TRANS(WA-TRN-CTR)  > ZEROES
TB0219               IF IX-BU < WA-MAX-BUCKET-TRANS
TB0219                  SET IX-BU UP BY 1
TB0219                  MOVE BTRN-PR-CODE   (WA-TRN-CTR)
TB0219                    TO WA-BU-PRIORITY-CODE (IX-BU)
TB0219                  MOVE BTRN-NORM-TRANS(WA-TRN-CTR)
TB0219                    TO WA-BU-TRAN-CODE     (IX-BU)
SC4881                  MOVE BTRN-CORR-TRANS(WA-TRN-CTR) 
SC4881                    TO WA-BU-CORR-TRAN-CODE (IX-BU)
TB0219               ELSE
TB0219                  SET UT8500CA-NORMAL-DISPLAY TO TRUE
TB0219                  MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*TB0219                  MOVE BORV-01-TRN-CODE TO WA-DISP-TRAN-CODE
NR2001                  MOVE BOCT-TRN-CODE TO WA-DISP-TRAN-CODE
TB0219                  STRING "BR0000: BUCKET TRANS CODES TABLE "
TB0219                         "OVERFLOW"
TB0219                         ", ACCT: " BORM-MEMB-CUST-AC
TB0219                         ", TRAN: " WA-DISP-TRAN-CODE
TB0219                         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0219                  MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
TB0219                    CALL "UT8500" USING
TB0219                                  UT8500CA-AREA
TB0219                  SET WA-END-OF-FILE TO TRUE
TB0219               END-IF
TB0219            END-IF
TB0219         END-PERFORM
SC4881         IF WA-INPUT-PARAM-TABLE(25) = 1
SC4881            SET WA-END-OF-FILE TO TRUE  
SC4881         ELSE                           
TB0219         PERFORM Z690-READ-BUCKETS THRU Z699-EXIT
SC4881         END-IF
TB0219     END-PERFORM
TB0219     SET WA-BUCKET-TRANS-COUNT TO IX-BU.
TB0219 Z689-EXIT.
TB0219     EXIT.
TB0219 Z690-READ-BUCKETS.
TB0219     MOVE BTRN-DATA-KEY         TO DBIOMOD-KEY
SC4881     IF WA-INPUT-PARAM-TABLE(25) = 1               
SC4881        MOVE "READ"             TO DBIOMOD-FUNCTION
SC4881     ELSE                                          
TB0219     MOVE "READNEXT"            TO DBIOMOD-FUNCTION.
TB0219     MOVE "BTRN"                TO DBIOMOD-FILE
TB0219                                   DBIOMOD-SUFFIX.
TB0219     MOVE "DBIO"                TO DBIOMOD-PREFIX.
TB0219     MOVE ZEROES                TO DBIOMOD-KEY-NO.
TB0219     MOVE SPACES                TO DBIOMOD-RELEASE-LOCK
TB0219                                   DBIOMOD-ACCESS-COMMAND
TB0219                                   DBIOMOD-ACCESS-COND
TB0219                                   DBIOMOD-STATUS.
TB0219
TB0219     CALL DBIOMODNAME USING        DBIOMOD-FILE
TB0219                                   DBIOMOD-KEY
TB0219                                   BTRN-RECORD-AREA
TB0219                                   DBIOMOD-FUNCTION
TB0219                                   DBIOMOD-KEY-NO
TB0219                                   DBIOMOD-RELEASE-LOCK
TB0219                                   DBIOMOD-ACCESS-COMMAND
TB0219                                   DBIOMOD-ACCESS-COND
TB0219                                   DBIOMOD-STATUS.
TB0219     IF DBIOMOD-STAT = "MRNF"
TB0219        SET WA-END-OF-FILE TO TRUE
TB0219        SET UT8500CA-NORMAL-DISPLAY TO TRUE
TB0219        MOVE SPACES TO UT8500CA-INPUT-MSG
TB0219        MOVE WA-BTRN-REC-CTR  TO WA-DISP-BTRN-CTR
TB0219        STRING "BR0000: BUCKET TRANS CODES LOADED"
TB0219               ", RECORDS: "  WA-DISP-BTRN-CTR
TB0219               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0219        MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
TB0219        CALL "UT8500" USING
TB0219        UT8500CA-AREA
TB0219        GO TO Z699-EXIT.
TB0219
TB0219     ADD 1 TO WA-BTRN-REC-CTR.
TB0219 Z699-EXIT.
TB0219     EXIT.
SC3491 Z6A0-PROCESS-CIEA.
SC3491     INITIALIZE UTCIEACA-CALL-PARAM.
           MOVE "BOR"             TO UTCIEACA-SYSTEM.
           MOVE WA-INPUT-ACCT-NO  TO UTCIEACA-ACCT-NO.
           MOVE 0                 TO UTCIEACA-TYPE.
           MOVE LOW-VALUES        TO UTCIEACA-SEQNUM-R.
           MOVE STRT-AREA-SOC-NO  TO UTCIEACA-SOC-NO.
           MOVE 05                TO UTCIEACA-CALL-CODE.
       Z6A1-READNEXT.
           MOVE ZEROES TO UTCIEACA-CALL-STATUS.
           CALL "UTCIEA" USING UTCIEACA-CALL-PARAM
SC8200                         BORM-RECORD-AREA
SC8200                         BOIS-RECORD.
           IF UTCIEACA-CALL-STATUS    NOT = ZEROS
              IF UTCIEACA-CALL-MSG-NO NOT = 188
                 MOVE 1                    TO WA-MSG-ERR-FLAG
                 MOVE UTCIEACA-CALL-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
              END-IF
              GO      TO                   Z6A9-EXIT.
           IF UTCIEACA-SOC-NO     NOT = STRT-AREA-SOC-NO
              OR UTCIEACA-SYSTEM  NOT = "BOR"
              OR UTCIEACA-ACCT-NO NOT = WA-INPUT-ACCT-NO
              GO      TO                   Z6A9-EXIT.
           MOVE 0                    TO WA-GLCC-XFER-AMOUNT.
           PERFORM
             VARYING WA-I FROM 1 BY 1   UNTIL WA-I > 3
               IF  UTCIEACA-INCOME OR UTCIEACA-EXPENSE
                   COMPUTE WA-GLCC-XFER-AMOUNT = WA-GLCC-XFER-AMOUNT
                                        + UTCIEACA-PREPAID-AMT   (WA-I)
                                        - UTCIEACA-AMORTIZED-AMT (WA-I)
               END-IF
           END-PERFORM.
           IF WA-GLCC-XFER-AMOUNT    NOT >  0
              GO TO  Z6A1-READNEXT.
           INITIALIZE                    UTCIEPCA-CALL-PARAM.
           MOVE 02                   TO  UTCIEPCA-CALL-CODE.
           MOVE UTCIEACA-TYPE        TO  UTCIEPCA-TYPE.
           MOVE STRT-AREA-SOC-NO     TO  UTCIEPCA-SOC-NO.
           CALL "UTCIEP" USING           UTCIEPCA-CALL-PARAM.
           IF  UTCIEPCA-CALL-STATUS NOT = 0
               MOVE 1   TO WA-MSG-ERR-FLAG
               MOVE 2395 TO WA-OUTPUT-ERR-MSG-NO
               GO TO Z6A9-EXIT.
           IF  UTCIEPCA-NO-AMORTIZATION
               GO TO Z6A1-READNEXT.
           IF  UTCIEPCA-INCOME
               MULTIPLY -1 BY WA-GLCC-XFER-AMOUNT.
           MOVE UTCIEPCA-CGL-COMPONENT-1 TO WA-SAVE-COMPONENT-1.
           MOVE ZEROS                    TO WA-SAVE-COMPONENT-2.
           MOVE WA-GL-CLASS-CODE-S          TO W190-GL-CLASS-CODE.
           MOVE SOC-GL-CLASS-CODE-STRUCTURE TO W190-GL-CODE-STRUCT.
           PERFORM X100-GLCC-SPLIT THRU
                   X109-EXIT.
           MOVE W190-GL-CLASS-CODE(W190-BRCH-START:W190-BRCH-LEN)
                TO UT0099CA-BRANCH.
           MOVE W190-GL-CLASS-CODE(W190-SEG-START:W190-SEG-LEN)
                TO UT0099CA-SEGMENT.
           MOVE W190-GL-CLASS-CODE(W190-CCY-START:W190-CCY-LEN)
                TO UT0099CA-CURRENCY.
           MOVE W190-GL-CLASS-CODE(W190-GROUP-START:W190-GROUP-LEN)
                TO UT0099CA-GROUP-CODE.
           MOVE WA-SAVE-COMPONENT-1   TO UT0099CA-COMPONENT-1.
           MOVE WA-SAVE-COMPONENT-2   TO UT0099CA-COMPONENT-2.
           MOVE SOC-GL-CLASS-CODE-STRUCTURE
                   TO UT0099CA-GLCC-STRUCTURE.
           CALL "UT0099" USING
                         UT0099CA-AREA.
           IF UT0099CA-RETURN-STATUS NOT = 0
              MOVE 2083 TO WA-OUTPUT-ERR-MSG-NO
              MOVE 1 TO WA-MSG-ERR-FLAG
              GO TO Z6A9-EXIT.
           MOVE UT0099CA-GLCC-OUTPUT-KEY TO BORM-GL-CLASSIFICATION-CODE
           PERFORM Z500-GLCC-TRANSFER-PROCESS THRU Z599-EXIT.
           IF  WA-MSG-ERR-FLAG = 1
               GO TO Z6A9-EXIT
           END-IF.
           GO TO Z6A1-READNEXT.
SC3491 Z6A9-EXIT.
SC3491     EXIT.
167620 Z700-GET-ARR-VALS.
167630     MOVE BORM-KEY      TO DBIOMOD-KEY.
167640     MOVE "READ"        TO DBIOMOD-FUNCTION.
167650     PERFORM M1600-ACCESS-ARRS THRU M1699-EXIT.
167670     IF DBIOMOD-STAT = "MRNF"
167680        MOVE 0          TO ARRS-TOM-ARR-INT-ACCR
167690                           ARRS-TOM-ARR-INT-INCR
167710     ELSE
167720        IF DBIOMOD-STAT NOT = "****"
167730           MOVE UT8500CA-FUNC-NORMAL-DISPLAY
167740                TO UT8500CA-CALL-CODE
167750           MOVE SPACES TO UT8500CA-INPUT-MSG
167760           STRING "BR0000:(Z700) ERROR READ ARRS "
167770                 BORM-KEY
167780             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
167790           CALL "UT8500" USING
167810                             UT8500CA-AREA
167820           GO TO Z799-EXIT.
167840 Z799-EXIT.
167850     EXIT.
167860*
167870 Z800-WRITE-ARRS.
167880     MOVE BORM-KEY              TO ARRS-KEY.
167890     MOVE "REWRITE"     TO DBIOMOD-FUNCTION.
167910     PERFORM M1600-ACCESS-ARRS THRU M1699-EXIT.
167930     IF DBIOMOD-STAT = "MRNF"
167940        MOVE "WRITE"    TO DBIOMOD-FUNCTION
167950        MOVE UT0069CA-TOM-ARR-ACRU TO ARRS-TOM-ARR-INT-ACCR
167960        MOVE UT0069CA-TOM-ARR-INCR TO ARRS-TOM-ARR-INT-INCR
167970        PERFORM M1600-ACCESS-ARRS THRU M1699-EXIT
167980     END-IF.
168000     IF DBIOMOD-STAT NOT = "****"
168010        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
168020             TO UT8500CA-CALL-CODE
168030        MOVE SPACES TO UT8500CA-INPUT-MSG
168040        STRING "BR0000:(Z700) ERROR READ ARRS "
168050                 BORM-KEY
168060        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
168070        CALL "UT8500" USING
168090                           UT8500CA-AREA
168100     END-IF.
168120 Z899-EXIT.
168130     EXIT.
168150 Z1000-RETRIEVE-BLDVWW.
168160     PERFORM Z2300-READ-BLDV  THRU  Z2399-EXIT.
168170     IF DBIO-CALL-SAVE-REFER = "END."
168180        MOVE UT8500CA-FUNC-NORMAL-DISPLAY                               
168190                                TO UT8500CA-CALL-CODE                   
168200        MOVE SPACES             TO UT8500CA-INPUT-MSG                   
168210        STRING "BR0000:(Z1000) ERROR IN BLDV-WW READ "                  
168220               "; ACCOUNT NO = "                                        
168230               DBIO-CALL-KEY                                            
168240               "; RETURN STATUS = "                                     
168250               DBIO-CALL-STATUS                                         
168260               "; DEFAULTED TO VARIABLE RATE."                          
168270               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG                
168280         MOVE "N"                TO UT8500CA-RESPONSE-REQD-FLAG         
168290         CALL "UT8500" USING                                            
168300                             UT8500CA-AREA                              
168310         MOVE WA-NEW-RATE-NOT-FOUND  TO  WA-FOUND-IND
168320         GO TO Z1099-EXIT.
168330     IF DBIO-CALL-STATUS = "****"
168340        IF BORM-SOC-NO NOT = BLDV-WW-SOCIETY OR
168350           BORM-MEMB-CUST-AC NOT = BLDV-WW-MEMB-NO
168360           MOVE WA-NEW-RATE-NOT-FOUND  TO  WA-FOUND-IND
168370        ELSE
168380         IF WA-SEARCH-RATE-DATE NOT <
168390                                BLDV-WW-CAFM-START-RTE-DTE
168400            AND WA-SEARCH-RATE-DATE <
168410                                BLDV-WW-CAFM-RESET-RTE-DTE
168420            MOVE WA-NEW-RATE-FOUND  TO  WA-FOUND-IND
168430         ELSE
168440            NEXT SENTENCE
168450     ELSE
168460         SET UT8500CA-NORMAL-DISPLAY TO TRUE
168470         MOVE SPACES TO UT8500CA-INPUT-MSG
168490         STRING "BR0000/Z1000: ERROR IN BLDV-WW READ "
168500                 "ACCOUNT NUMBER  "
168510                 DBIO-CALL-KEY
168520                 "RETURN STATUS  "
168530                 DBIO-CALL-STATUS
168540             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
168550         CALL "UT8500" USING
168560                             UT8500CA-AREA
168570         STRING "DEFAULTED TO VARIABLE RATE."
168580             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
168590         CALL "UT8500" USING
168600                             UT8500CA-AREA
168610         MOVE WA-NEW-RATE-NOT-FOUND  TO  WA-FOUND-IND.
168620*
168630 Z1099-EXIT.
168640     EXIT.
168650*
168660 Z1100-SET-EFF-RATE.
S16466     ADD BORM-RT-INCR    TO WA-INT-RATE-A.
168670     MOVE BLDV-WW-CAFM-TYPE TO WA-CAFM-TYPE.
168680     IF CAP-IN-FORCE
168690        IF WA-INT-RATE-A > BLDV-WW-CAFM-HIGH-RTE
168700           MOVE BLDV-WW-CAFM-HIGH-RTE  TO   WA-INT-RATE-A.
168710     IF FLOOR-IN-FORCE
168720        IF WA-INT-RATE-A < BLDV-WW-CAFM-LOW-RTE
168730           MOVE BLDV-WW-CAFM-LOW-RTE  TO    WA-INT-RATE-A.
168740     IF FIXED-IN-FORCE
168750        MOVE BLDV-WW-CAFM-HIGH-RTE    TO    WA-INT-RATE-A.
S16466     IF CAP-COLLARS-FLEXIBLE
S16466       IF  WA-INT-RATE-A < BLDV-WW-CAFM-LOW-RTE
S16466         NEXT SENTENCE
S16466       ELSE
S16466         IF  WA-INT-RATE-A  <  BLDV-WW-CAFM-HIGH-RTE
S16466           MOVE BLDV-WW-CAFM-LOW-RTE  TO    WA-INT-RATE-A
S16466         ELSE
S16466           MOVE BLDV-WW-CAFM-RTE      TO    WA-INT-RATE-A
S16466         END-IF
S16466       END-IF
S16466     END-IF.
S16466     SUBTRACT  BORM-RT-INCR  FROM  WA-INT-RATE-A.
168760*
168770 Z1199-EXIT.
168780     EXIT.
168790*
168800 Z2300-READ-BLDV.
168810     CALL "DBIO" USING
168830                       DBIO-CALL-PARAM
168840                       DBIO-CALL-SYS-AREA
168850                       DBIO-CALL-KEY-AREA
168860                       DBIO-CALL-STATUS
168870                       WA-BLDV-AREA-WW
168880                       DBIO-CALL-REFER-AREA
168890                       DBIO-CALL-TXN-TYPE-AREA.
168900 Z2399-EXIT.
168910     EXIT.
168920/
168940 Z3000-RETRIEVE-BBLC.
168950     INITIALIZE BBLC-KEY.
168960     MOVE "READ"               TO  DBIOMOD-FUNCTION.
168970     MOVE "BBLC"               TO  DBIOMOD-FILE
168980                                   DBIOMOD-SUFFIX.
168990     MOVE "DBIO"               TO  DBIOMOD-PREFIX.
169000     MOVE STRT-AREA-SOC-NO     TO  WA-BORM-SOC-NO
169010                                   BBLC-INST-NO.
169020     MOVE WA-INPUT-ACCT-NO     TO  WA-BORM-ACCT-NO
169030                                   BBLC-ACCT-NO.
169040     MOVE WA-BORM-KEY          TO  DBIOMOD-KEY.
169050     MOVE ZEROES               TO  DBIOMOD-KEY-NO.
169060     MOVE SPACES               TO  DBIOMOD-STATUS
169070                                   DBIOMOD-RELEASE-LOCK
169080                                   DBIOMOD-ACCESS-COMMAND
169090                                   DBIOMOD-ACCESS-COND.
169100     CALL DBIOMODNAME USING
169120                          DBIOMOD-FILE
169130                          DBIOMOD-KEY
169140                          DBIOMOD-RECORD
169150                          DBIOMOD-FUNCTION
169160                          DBIOMOD-KEY-NO
169170                          DBIOMOD-RELEASE-LOCK
169180                          DBIOMOD-ACCESS-COMMAND
169190                          DBIOMOD-ACCESS-COND
169200                          DBIOMOD-STATUS.
169210     IF DBIOMOD-STAT NOT = "****"  AND "MRNF"
169220         SET UT8500CA-NORMAL-DISPLAY TO TRUE
169230         MOVE SPACES TO UT8500CA-INPUT-MSG
169240         STRING "BR0000:(Z3000) BBLC READ ERROR " DBIOMOD-STAT
169250                " FOR " BBLC-KEY
169260             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
169270         CALL "UT8500" USING
169290                             UT8500CA-AREA
169300         MOVE "BBLC" TO WA-DBERR-DATA-SET
169310         MOVE DBIOMOD-STAT       TO WA-DB-ERROR
169320         MOVE 1                  TO WA-MSG-ERR-FLAG
169330         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO.
169340     IF DBIOMOD-STAT = "MRNF"
169350         MOVE 1                  TO WA-MSG-ERR-FLAG
169360         MOVE 188 TO WA-OUTPUT-ERR-MSG-NO.
169370 Z3099-EXIT.
169380      EXIT.
169390 Z3100-RETRIEVE-BSHR.
169400     INITIALIZE BSHR-KEY.
169410     MOVE "READ"              TO  DBIOMOD-FUNCTION.
169420     MOVE "BSHR"               TO  DBIOMOD-FILE
169430                                   DBIOMOD-SUFFIX.
169440     MOVE "DBIO"               TO  DBIOMOD-PREFIX.
169450     MOVE STRT-AREA-SOC-NO     TO  WA-BORM-SOC-NO
169460                                   BSHR-INST-NO.
169470     MOVE WA-INPUT-ACCT-NO     TO  WA-BORM-ACCT-NO
169480                                   BSHR-ACCT-NO.
169490     MOVE WA-BORM-KEY          TO  DBIOMOD-KEY.
169500     MOVE ZEROES               TO  DBIOMOD-KEY-NO.
169510     MOVE SPACES               TO  DBIOMOD-STATUS
169520                                   DBIOMOD-RELEASE-LOCK
169530                                   DBIOMOD-ACCESS-COMMAND
169540                                   DBIOMOD-ACCESS-COND.
169550     CALL DBIOMODNAME USING
169570                          DBIOMOD-FILE
169580                          DBIOMOD-KEY
169590                          DBIOMOD-RECORD2
169600                          DBIOMOD-FUNCTION
169610                          DBIOMOD-KEY-NO
169620                          DBIOMOD-RELEASE-LOCK
169630                          DBIOMOD-ACCESS-COMMAND
169640                          DBIOMOD-ACCESS-COND
169650                          DBIOMOD-STATUS.
169660     IF DBIOMOD-STAT NOT = "****" AND "MRNF"
169670         SET UT8500CA-NORMAL-DISPLAY TO TRUE
169680         MOVE SPACES TO UT8500CA-INPUT-MSG
169690         STRING "BR0000:(Z3100) BSHR READ ERROR " DBIOMOD-STAT
169700                " FOR " BSHR-KEY
169710             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
169720         MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
169730         CALL "UT8500" USING
169750                             UT8500CA-AREA
169760         MOVE "BSHR" TO WA-DBERR-DATA-SET
169770         MOVE DBIOMOD-STAT TO WA-DB-ERROR
169780         MOVE 1                  TO WA-MSG-ERR-FLAG
169790         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO.
169800     IF DBIOMOD-STAT = "MRNF"
169810         MOVE 1                  TO WA-MSG-ERR-FLAG
169820         MOVE 188 TO WA-OUTPUT-ERR-MSG-NO.
169830 Z3199-EXIT.
169840      EXIT.
169850 Z4100-CREATE-BSHR.
169860     MOVE "WRITE"              TO  DBIOMOD-FUNCTION.
169870     MOVE "BSHR"               TO  DBIOMOD-FILE
169880                                   DBIOMOD-SUFFIX.
169890     MOVE "DBIO"               TO  DBIOMOD-PREFIX.
169900     MOVE STRT-AREA-SOC-NO     TO  WA-BORM-SOC-NO
169910                                   BSHR-INST-NO.
169920     MOVE WA-INPUT-ACCT-NO     TO  WA-BORM-ACCT-NO
169930                                   BSHR-ACCT-NO.
169940     MOVE WA-BORM-KEY          TO  DBIOMOD-KEY.
169950     MOVE ZEROES               TO  DBIOMOD-KEY-NO.
169960     MOVE SPACES               TO  DBIOMOD-STATUS
169970                                   DBIOMOD-RELEASE-LOCK
169980                                   DBIOMOD-ACCESS-COMMAND
169990                                   DBIOMOD-ACCESS-COND.
170000     CALL DBIOMODNAME USING
170020                          DBIOMOD-FILE
170030                          DBIOMOD-KEY
170040                          DBIOMOD-RECORD2
170050                          DBIOMOD-FUNCTION
170060                          DBIOMOD-KEY-NO
170070                          DBIOMOD-RELEASE-LOCK
170080                          DBIOMOD-ACCESS-COMMAND
170090                          DBIOMOD-ACCESS-COND
170100                          DBIOMOD-STATUS.
170120     IF DBIOMOD-STAT NOT = "****"
170130         SET UT8500CA-NORMAL-DISPLAY TO TRUE
170140         MOVE SPACES TO UT8500CA-INPUT-MSG
170150         STRING "BR0000:(Z4100) BSHR CREATE ERROR "
170160                DBIOMOD-STAT
170170                " FOR " BSHR-KEY
170180             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
170190         MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
170200         CALL "UT8500" USING
170220                             UT8500CA-AREA
170230         MOVE "BSHR" TO WA-DBERR-DATA-SET
170240         MOVE DBIOMOD-STAT TO WA-DB-ERROR
170250         MOVE 1            TO WA-MSG-ERR-FLAG
170260         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO.
170270 Z4199-EXIT.
170280      EXIT.
170290 Z4200-AMEND-BSHR.
170300     MOVE "REWRITE"            TO  DBIOMOD-FUNCTION.
170310     MOVE "BSHR"               TO  DBIOMOD-FILE
170320                                   DBIOMOD-SUFFIX.
170330     MOVE "DBIO"               TO  DBIOMOD-PREFIX.
170340     MOVE STRT-AREA-SOC-NO     TO  WA-BORM-SOC-NO
170350                                   BSHR-INST-NO.
170360     MOVE WA-INPUT-ACCT-NO     TO  WA-BORM-ACCT-NO
170370                                   BSHR-ACCT-NO.
170380     MOVE WA-BORM-KEY          TO  DBIOMOD-KEY.
170390     MOVE ZEROES               TO  DBIOMOD-KEY-NO.
170400     MOVE SPACES               TO  DBIOMOD-STATUS
170410                                   DBIOMOD-RELEASE-LOCK
170420                                   DBIOMOD-ACCESS-COMMAND
170430                                   DBIOMOD-ACCESS-COND.
170440     CALL DBIOMODNAME USING
170460                          DBIOMOD-FILE
170470                          DBIOMOD-KEY
170480                          DBIOMOD-RECORD2
170490                          DBIOMOD-FUNCTION
170500                          DBIOMOD-KEY-NO
170510                          DBIOMOD-RELEASE-LOCK
170520                          DBIOMOD-ACCESS-COMMAND
170530                          DBIOMOD-ACCESS-COND
170540                          DBIOMOD-STATUS.
170560     IF DBIOMOD-STAT NOT = "****"
170570         SET UT8500CA-NORMAL-DISPLAY TO TRUE
170580         MOVE SPACES TO UT8500CA-INPUT-MSG
170590         STRING "BR0000:(Z4200) BSHR AMEND ERROR "
170600                DBIOMOD-STAT
170610                " FOR " BSHR-KEY
170620             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
170630         MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
170640         CALL "UT8500" USING
170660                             UT8500CA-AREA
170670         MOVE "BSHR" TO WA-DBERR-DATA-SET
170680         MOVE DBIOMOD-STAT TO WA-DB-ERROR
170690         MOVE 1            TO WA-MSG-ERR-FLAG
170700         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO.
170710 Z4299-EXIT.
170720      EXIT.
170740 Z5200-RETRIEVE-EPIP.
170760     CALL "UTEPIP"  USING
170780                             UTEPIPCA-CALL-AREA.
170800     IF UTEPIPCA-CALL-STATUS = 0
170810         MOVE WL-CALL-AREA-1 TO EPIP-RECORD-AREA.
170830 Z5299-EXIT.
170840      EXIT.
170860*NBG003
170870 X2000-READ-BIRM.
170880     MOVE "READ"               TO  DBIOMOD-FUNCTION.
170890     MOVE "BIRM"               TO  DBIOMOD-FILE
170900                                   DBIOMOD-SUFFIX.
170910     MOVE "DBIO"               TO  DBIOMOD-PREFIX.
170920     MOVE BORM-KEY             TO  DBIOMOD-KEY
170930                                   BIRM-KEY.
170940     MOVE ZEROES               TO  DBIOMOD-KEY-NO.
170950     MOVE SPACES               TO  DBIOMOD-STATUS
170960                                   DBIOMOD-RELEASE-LOCK
170970                                   DBIOMOD-ACCESS-COMMAND
170980                                   DBIOMOD-ACCESS-COND.
170990     IF BORM-IR-IND NOT = 1
171000        GO TO X2999-EXIT.
171010     CALL DBIOMODNAME USING
171030                       DBIOMOD-FILE
171040                       DBIOMOD-KEY
171050                       BIRM-RECORD
171060                       DBIOMOD-FUNCTION
171070                       DBIOMOD-KEY-NO
171080                       DBIOMOD-RELEASE-LOCK
171090                       DBIOMOD-ACCESS-COMMAND
171100                       DBIOMOD-ACCESS-COND
171110                       DBIOMOD-STATUS.
171130     IF DBIOMOD-STAT = "MRNF"
171140        GO TO X2999-EXIT.
171160     IF DBIOMOD-STAT NOT = "****"
171170         SET UT8500CA-NORMAL-DISPLAY TO TRUE
171180         MOVE SPACES TO UT8500CA-INPUT-MSG
171190         STRING "BR0000:(X2000) BIRM READ ERROR "
171200                DBIOMOD-STAT
171210               " FOR " BIRM-KEY
171220             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
171230         MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
171240         CALL "UT8500" USING
171260                          UT8500CA-AREA
171270         MOVE "BIRM" TO WA-DBERR-DATA-SET
171280         MOVE DBIOMOD-STAT TO WA-DB-ERROR
171290         MOVE 1            TO WA-MSG-ERR-FLAG
171300         MOVE 188 TO WA-OUTPUT-ERR-MSG-NO.
171310 X2999-EXIT.
171320      EXIT.
171340 X3000-WRITE-REWRITE-BIRM.
171350*    MOVE "REWRITE"            TO  DBIOMOD-FUNCTION.
171360     MOVE "BIRM"               TO  DBIOMOD-FILE
171370                                   DBIOMOD-SUFFIX.
171380     MOVE "DBIO"               TO  DBIOMOD-PREFIX.
171390     MOVE BORM-KEY             TO  DBIOMOD-KEY
171400                                   BIRM-KEY.
171410     MOVE ZEROES               TO  DBIOMOD-KEY-NO.
171420     MOVE SPACES               TO  DBIOMOD-STATUS
171430                                   DBIOMOD-RELEASE-LOCK
171440                                   DBIOMOD-ACCESS-COMMAND
171450                                   DBIOMOD-ACCESS-COND.
171470     IF BORM-IR-IND NOT = 1
171480        GO TO X3999-EXIT.
171500     CALL DBIOMODNAME USING
171520                       DBIOMOD-FILE
171530                       DBIOMOD-KEY
171540                       BIRM-RECORD
171550                       DBIOMOD-FUNCTION
171560                       DBIOMOD-KEY-NO
171570                       DBIOMOD-RELEASE-LOCK
171580                       DBIOMOD-ACCESS-COMMAND
171590                       DBIOMOD-ACCESS-COND
171600                       DBIOMOD-STATUS.
171610*
171620*    IF DBIOMOD-STAT NOT = "MRNF"
171630*       MOVE "WRITE"              TO  DBIOMOD-FUNCTION
171640*                                     BIRM-KEY
171650*       MOVE ZEROES               TO  DBIOMOD-KEY-NO
171660*       MOVE SPACES               TO  DBIOMOD-STATUS
171670*                                     DBIOMOD-RELEASE-LOCK
171680*                                     DBIOMOD-ACCESS-COMMAND
171690*                                     DBIOMOD-ACCESS-COND
171700*       CALL DBIOMODNAME USING
171710*
171720*                         DBIOMOD-FILE
171730*                         DBIOMOD-KEY
171740*                         BIRM-RECORD
171750*                         DBIOMOD-FUNCTION
171760*                         DBIOMOD-KEY-NO
171770*                         DBIOMOD-RELEASE-LOCK
171780*                         DBIOMOD-ACCESS-COMMAND
171790*                         DBIOMOD-ACCESS-COND
171800*                         DBIOMOD-STATUS.
171810*
171820      IF DBIOMOD-STAT NOT = "****"
171830            SET UT8500CA-NORMAL-DISPLAY TO TRUE
171840            MOVE SPACES TO UT8500CA-INPUT-MSG
171850            STRING "BR0000:(X3000) BIRM REWRITE ERROR "
171860                   DBIOMOD-STAT
171870                  " FOR " BIRM-KEY
171880            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
171890            MOVE "N" TO UT8500CA-RESPONSE-REQD-FLAG
171900            CALL "UT8500" USING
171920                          UT8500CA-AREA
171930         MOVE "BIRM" TO WA-DBERR-DATA-SET
171940         MOVE DBIOMOD-STAT TO WA-DB-ERROR
171950         MOVE 1            TO WA-MSG-ERR-FLAG
171960*        MOVE 3080 TO WA-OUTPUT-ERR-MSG-NO.
171970         MOVE 155  TO WA-OUTPUT-ERR-MSG-NO.
171980 X3999-EXIT.
171990      EXIT.
172000*  760167
172010*
172020 P400-MATCH-CHECK.
172030*
172040*    FIRST DECIDE IF IT'S A CORRECTION
172050*
172060     IF  WA-INPUT-PARAM-TABLE(7) = 1
172070         GO TO P450.
172080*
172090*    BUILD THE EFT MATCH RECORD.
172100*
172110     MOVE STRT-AREA-SOC-NO        TO EFTM-INST-NO.
172120*    MOVE ST-ATM-SEQ-NO           TO EFTM-SEQUENCE-NO.       TB0267 
TB0267     MOVE ST-SEQUENCE-NO          TO EFTM-SEQUENCE-NO.
TB0267     MOVE STRT-AREA-BATCH-TANDEM  TO EFTM-CHANNEL-TYPE.
172130*    MOVE TPATM-PURCH-DATE       TO EFTM-TERMINAL-DATE.      TB0267
172140*    MOVE TPATM-TPAC-POST-TIME   TO EFTM-TERMINAL-TIME.      TB0267
TB0267     MOVE WA-ACCEPT-DATE-R       TO EFTM-TERMINAL-DATE.
TB0267***
TB0267***  GET THE TRANSACTION TIME
TB0267***
TB0267     MOVE 0 TO UT1996CA-CALL-CODE.
TB0267     CALL "UT1996" USING
TB0267                   UT1996CA-CALL-AREA
TB0267     END-CALL.
TB0267     MOVE  UT1996CA-TIME          TO EFTM-TERMINAL-TIME.
S10774     IF WA-TRAN-TYPE = 0
172150     MOVE SPACES                  TO EFTM-TERMINAL-ID 
S10774     ELSE
S10774        MOVE WA-EFTM-SETLMNT-DT   TO EFTM-TERMINAL-ID
S10774     END-IF.
ST0159     MOVE WS-ORIG-ACCT-NUM        TO EFTM-ACCOUNT-NO.
172160     MOVE STRT-AREA-JRNL-NO       TO EFTM-BANCS-JOURNAL-NO.
172170*
SC3409***
SC3409***  IF NOT CORRECTION MOVE "N" TO EFTM-EC-TXN
SC3409***
SC3409     MOVE "N"                    TO EFTM-EC-TXN.
SC3409***
SC3409***  SUPPLY INITIAL VALUES FOR EFTM-BE-CORRECTED AND EFTM-EC-SEQUENCE
SC3409***
SC3409     MOVE "N"                    TO EFTM-BE-CORRECTED.
SC3409     MOVE SPACES                 TO EFTM-EC-SEQUENCE-NO.
172180     MOVE ST-ATM-SEQ-NO           TO WA-ATM-ATM-SEQ-NO.                 
172190     MOVE TPATM-TPAC-POST-TIME   TO WA-ATM-TXN-TIME.
172200     MOVE TPATM-PURCH-DATE     TO UT0030-DATE-DDMMCCYY
172210     MOVE 1            TO UT0030-FUNCTION
172220     CALL "UT0030" USING
172230                          UT0030-FUNCTION
172240                          UT0030-DATE-AREA
172250                          UT0030-BINARY-DATE
172260     MOVE UT0030-BINARY-DATE TO WA-ATM-TXN-DATE.
172270*
172280*    NOW ADD THE RECORD TO THE MATCH FILE.
172290*
172300     PERFORM M900-ADD-EFTM THRU M999-EXIT
172310     IF  DBIOMOD-STAT = "****"
172320         GO TO P499-EXIT
172330     ELSE
172340     IF  DBIOMOD-STAT = "DUPM"
172350         MOVE 459 TO WA-OUTPUT-ERR-MSG-NO
SC4404         MOVE 1   TO WA-MSG-ERR-FLAG
172360         MOVE ST-ATM-SEQ-NO TO WA-DISPLAY-NUMBER1                       
172370         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
172380                               TO UT8500CA-CALL-CODE
172390         MOVE SPACES           TO UT8500CA-INPUT-MSG
172400         STRING  "BR0000:(P400) DUPLICATE TRANSACTION: "
172410                 "ATM SEQ NO ="
172420*                WA-DISPLAY-NUMBER1                               ST0159
ST0159                 ST-SEQUENCE-NO
ST0159                 " JOURNAL NUMBER ="
ST0159                 DELIMITED BY SIZE
ST0159                 STRT-AREA-JRNL-NO
ST0159                 " BATCH TANDEM ="
ST0159                 STRT-AREA-BATCH-TANDEM
172430         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
172440         CALL "UT8500" USING
172460                             UT8500CA-AREA
172470         GO TO P499-EXIT
172480     ELSE
172490         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
172500         MOVE 1   TO WA-MSG-ERR-FLAG
172510         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
172520                               TO UT8500CA-CALL-CODE
172530         MOVE SPACES           TO UT8500CA-INPUT-MSG
172540         STRING  "BR0000:(P400) BAD EFTM ACCESS"
172550         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
172560         CALL "UT8500" USING
172580                             UT8500CA-AREA
172590         GO TO P499-EXIT.
172600     GO TO P499-EXIT.
172610*
172620*
172630 P450.
172640*
172650*    RETRIEVE THE EFT MATCH RECORD
172660*
172670*    MOVE STRT-AREA-SOC-NO        TO EFTM-INST-NO.       TB0267
172670     MOVE STRT-AREA-SOC-NO        TO EFTM-INST-NO-1
TB0212                                     EFTMCA-INST-NO-1.
172680*    MOVE TPVISA-CORR-JRNL-NO     TO EFTM-SEQUENCE-NO.   TB0267
TB0267     MOVE TPVISA-CORR-JRNL-NO     TO EFTM-BANCS-JOURNAL-NO-1
TB0212                                     EFTMCA-BANCS-JOURNAL-NO-1.
TB0267     MOVE STRT-AREA-BATCH-TANDEM  TO EFTM-CHANNEL-TYPE-1
TB0212                                     EFTMCA-CHANNEL-TYPE-1.
TB0212     MOVE 0                       TO EFTM-TERMINAL-DATE-1
TB0212                                     EFTMCA-TERMINAL-DATE-1.
ST0159     MOVE WS-ORIG-ACCT-NUM        TO EFTMCA-ACCOUNT-NO-1
ST0159                                     EFTM-ACCOUNT-NO-1.
TB0267     MOVE EFTM-KEY-1              TO DBIOMOD-KEY.
TB0267     MOVE 1                       TO DBIOMOD-KEY-NO.
SC3409***
SC3409***  MOVE "Y" TO EFTM-EC-TXN  IF CORRECTION TRANSACTION
SC3409***
SC3409     MOVE "Y"                     TO EFTM-EC-TXN.
172690*
172700*    NOW READ THE RECORD FROM THE MATCH FILE.
172710*
172720*    PERFORM M1000-READ-EFTM THRU M1099-EXIT               TB0212
TB0212     MOVE  3                       TO UTEFTMCA-CALL-CODE
TB0212     CALL "UTEFTM" USING
TB0212                           UTEFTM-CALL-AREA
TB0212                           WA-PASSALONG
TB0212     END-CALL
TB0212     MOVE UTEFTMCA-DBIO-STAT          TO DBIOMOD-STAT
S10838     IF WA-MSG-ERR-FLAG = 0
TB0212        MOVE EFTMCA-INST-NO              TO EFTM-INST-NO
TB0212        MOVE EFTMCA-SEQUENCE-NO          TO EFTM-SEQUENCE-NO
TB0212        MOVE EFTMCA-CHANNEL-TYPE         TO EFTM-CHANNEL-TYPE
TB0212        MOVE EFTMCA-TERMINAL-DATE        TO EFTM-TERMINAL-DATE
TB0212        MOVE EFTMCA-TERMINAL-TIME        TO EFTM-TERMINAL-TIME
TB0212        MOVE EFTMCA-TERMINAL-ID          TO EFTM-TERMINAL-ID
ST0159        MOVE EFTMCA-ACCOUNT-NO           TO EFTM-ACCOUNT-NO
TB0212        MOVE EFTMCA-BANCS-JOURNAL-NO     TO
TB0212                                            EFTM-BANCS-JOURNAL-NO
SC9984        MOVE EFTMCA-EC-TXN               TO EFTM-EC-TXN
TB0212        MOVE EFTMCA-BE-CORRECTED         TO EFTM-BE-CORRECTED
TB0212        MOVE EFTMCA-EC-SEQUENCE-NO       TO
TB0212                                            EFTM-EC-SEQUENCE-NO
SC9268        MOVE WS-EFTM-AREA                TO TMP-EFTM-AREA
S10838     END-IF.
SC3409*    IF  DBIOMOD-STAT = "****"                             TB0267
SC3409     IF (DBIOMOD-STAT = "****" AND EFTM-BE-CORRECTED = "Y")
SC3409*S10838      MOVE 459 TO WA-OUTPUT-ERR-MSG-NO
S10838             MOVE 132 TO WA-OUTPUT-ERR-MSG-NO
SC3409             MOVE 1   TO WA-MSG-ERR-FLAG
SC3409             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
SC3409                                   TO UT8500CA-CALL-CODE
SC3409             MOVE SPACES           TO UT8500CA-INPUT-MSG
SC3409             STRING  "BR0000:(P400) DUPLICATE TRANSACTION: "
ST0159                 ST-SEQUENCE-NO
ST0159                 " JOURNAL NUMBER ="
ST0159                 DELIMITED BY SIZE
ST0159                 STRT-AREA-JRNL-NO
ST0159                 " BATCH TANDEM ="
ST0159                 STRT-AREA-BATCH-TANDEM
SC3409             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC3409             CALL "UT8500" USING
SC3409                                UT8500CA-AREA
SC3409             GO TO P499-EXIT
SC3409     END-IF.
SC9984***
SC9984*** IF FOUND BUT THE EFTM-EC-TXN = "Y", MEANING THE
SC9984*** RECORD FOUND WAS A CORRECTION TRANSACTION
SC9984***
SC9984     IF (DBIOMOD-STAT = "****" AND EFTM-EC-TXN = "Y")
SC9984             MOVE 132 TO WA-OUTPUT-ERR-MSG-NO
SC9984             MOVE 1   TO WA-MSG-ERR-FLAG
SC9984             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
SC9984                                   TO UT8500CA-CALL-CODE
SC9984             MOVE SPACES           TO UT8500CA-INPUT-MSG
SC9984             STRING  "BR0000:(P400) DUPLICATE TRANSACTION: "
SC9984                 "ATM SEQ NO ="
SC9984                 ST-SEQUENCE-NO
SC9984                 " JOURNAL NUMBER "
SC9984                 DELIMITED BY SIZE
SC9984                 STRT-AREA-JRNL-NO
SC9984                 " BATCH TANDEM ="
SC9984                 STRT-AREA-BATCH-TANDEM
SC9984             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC9984             CALL "UT8500" USING
SC9984                                UT8500CA-AREA
SC9984             GO TO P499-EXIT
SC9984     END-IF.
SC3409***
SC3409*** IF FOUND AND CORRECTION FLAG STATUS = "N", PROCEED TO PROCESSING
SC3409***
SC3409     IF  (DBIOMOD-STAT = "****" AND EFTM-BE-CORRECTED = "N")
172740*        NOW SET UP THE ORIGINAL BANCS JOURNAL NUMBER. THE
172750*        ORIGINAL ATM CORRECTION SEQUENCE NUMBER IN THE
172760*        TRANSACTION IS OVERWRITTEN WITH THE ORIGINAL
172770*        BANCS JOURNAL NUMBER.
172780         MOVE EFTM-BANCS-JOURNAL-NO TO TPVISA-CORR-JRNL-NO
TB0267***
TB0267*** ADD THE CORRECTION TRANSACTION MESSAGES TO EFTM
TB0267***
TB0267         MOVE STRT-AREA-SOC-NO        TO EFTM-INST-NO
TB0267         MOVE ST-SEQUENCE-NO          TO EFTM-SEQUENCE-NO
TB0267         MOVE STRT-AREA-BATCH-TANDEM  TO EFTM-CHANNEL-TYPE
TB0267         MOVE WA-ACCEPT-DATE-R        TO EFTM-TERMINAL-DATE
TB0267***
TB0267***  GET THE TRANSACTION TIME
TB0267***
TB0267         MOVE 0 TO UT1996CA-CALL-CODE
TB0267         CALL "UT1996" USING
TB0267                       UT1996CA-CALL-AREA
TB0267         END-CALL
TB0267         MOVE  UT1996CA-TIME          TO EFTM-TERMINAL-TIME
S10774         IF WA-TRAN-TYPE = 0
TB0267         MOVE SPACES                  TO EFTM-TERMINAL-ID
S10774         ELSE
S10774            MOVE WA-EFTM-SETLMNT-DT   TO EFTM-TERMINAL-ID
S10774         END-IF
ST0159         MOVE WS-ORIG-ACCT-NUM        TO EFTM-ACCOUNT-NO
TB0267         MOVE STRT-AREA-JRNL-NO       TO EFTM-BANCS-JOURNAL-NO
SC9984         MOVE EFTMCA-SEQUENCE-NO      TO EFTM-EC-SEQUENCE-NO
SC3409***
SC3409*** MOVE "Y" TO EC-TXN FIELD
SC3409***
SC3409         MOVE "Y"                     TO EFTM-EC-TXN
SC3409
TB0267         PERFORM M900-ADD-EFTM THRU M999-EXIT
TB0267         IF  DBIOMOD-STAT = "****"
TB0267             GO TO P499-EXIT
TB0267         ELSE
TB0267           IF  DBIOMOD-STAT = "DUPM"
TB0267             MOVE 459 TO WA-OUTPUT-ERR-MSG-NO
TB0267             MOVE 1   TO WA-MSG-ERR-FLAG
TB0267             MOVE ST-ATM-SEQ-NO TO WA-DISPLAY-NUMBER1
TB0267             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0267                                   TO UT8500CA-CALL-CODE
TB0267             MOVE SPACES           TO UT8500CA-INPUT-MSG
TB0267             STRING  "BR0000:(P400) DUPLICATE TRANSACTION: "
TB0267                     "ATM SEQ NO ="
ST0159                     ST-SEQUENCE-NO
ST0159                     " JOURNAL NUMBER ="
ST0159                     DELIMITED BY SIZE
ST0159                     STRT-AREA-JRNL-NO
ST0159                     " BATCH TANDEM ="
ST0159                     STRT-AREA-BATCH-TANDEM
TB0267             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0267             CALL "UT8500" USING
TB0267                                UT8500CA-AREA
TB0267             GO TO P499-EXIT
TB0267           ELSE
TB0267             MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
TB0267             MOVE 1   TO WA-MSG-ERR-FLAG
TB0267             MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0267                                   TO UT8500CA-CALL-CODE
TB0267             MOVE SPACES           TO UT8500CA-INPUT-MSG
TB0267             STRING  "IN0000:(P400) BAD EFTM ACCESS"
TB0267             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0267             CALL "UT8500" USING
TB0267                                 UT8500CA-AREA
172790            GO TO P499-EXIT
TB0267            END-IF
172800     ELSE
172810     IF  DBIOMOD-STAT = "MRNF"
172820         MOVE 132 TO WA-OUTPUT-ERR-MSG-NO
172830         MOVE ST-ATM-SEQ-NO TO WA-DISPLAY-NUMBER1                       
172840         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
172850                               TO UT8500CA-CALL-CODE
172860         MOVE SPACES           TO UT8500CA-INPUT-MSG
172870         STRING  "BR0000:(P400) UNMATCHED REVERSAL: "
172880                 "CORRECTION ATM SEQ NO ="
172890                TPVISA-CORR-JRNL-NO
172900         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
172910         CALL "UT8500" USING
172920                             UT8500CA-AREA
172930         GO TO P499-EXIT
172940     ELSE
172950         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
172960         MOVE 1   TO WA-MSG-ERR-FLAG
172970         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
172980                               TO UT8500CA-CALL-CODE
172990         MOVE SPACES           TO UT8500CA-INPUT-MSG
173000         STRING  "BR0000:(P400) BAD EFTM ACCESS"
173010         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
173020         CALL "UT8500" USING
173040                             UT8500CA-AREA
173050         GO TO P499-EXIT.
173060*
173070*
173080 P499-EXIT.
173090     EXIT.
173100*
173110 M900-ADD-EFTM.
173120*
173130*
173140     MOVE "EFTM"              TO DBIOMOD-FILE
173150                                 DBIOMOD-SUFFIX.
173160     MOVE "WRITE"             TO DBIOMOD-FUNCTION.
173170     MOVE "DBIO"              TO DBIOMOD-PREFIX.
173180     MOVE EFTM-KEY            TO DBIOMOD-KEY.
173190     MOVE SPACES              TO DBIOMOD-STATUS
173200                                 DBIOMOD-RELEASE-LOCK
173210                                 DBIOMOD-ACCESS-COND
173220                                 DBIOMOD-ACCESS-COMMAND.
173230     MOVE ZEROES              TO DBIOMOD-KEY-NO.
173240     CALL DBIOMODNAME USING
173250                            DBIOMOD-FILE
173260                            DBIOMOD-KEY
173270                            WS-EFTM-AREA
173280                            DBIOMOD-FUNCTION
173290                            DBIOMOD-KEY-NO
173300                            DBIOMOD-RELEASE-LOCK
173310                            DBIOMOD-ACCESS-COMMAND
173320                            DBIOMOD-ACCESS-COND
173330                            DBIOMOD-STATUS.
173340     IF  DBIOMOD-STAT NOT = "****" AND "DUPM"
173350         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
173360         MOVE 1   TO WA-MSG-ERR-FLAG
173370         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
173380                               TO UT8500CA-CALL-CODE
173390         MOVE SPACES           TO UT8500CA-INPUT-MSG
173400         STRING  "BR0000:(M900) EFTM WRITE ERROR"
173410                 ", STAT=" DBIOMOD-STAT
173420                 ", KEY="  EFTM-KEY
173430         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
173440         CALL "UT8500" USING
173450                             UT8500CA-AREA.
173460         GO TO M999-EXIT.
173470*
173480*
173490 M999-EXIT.
173500     EXIT.
173510*
173520 M1000-READ-EFTM.
173530*
173540     MOVE "EFTM"              TO DBIOMOD-FILE
173550                                 DBIOMOD-SUFFIX.
173560     MOVE "READ"             TO DBIOMOD-FUNCTION.
173570     MOVE "DBIO"              TO DBIOMOD-PREFIX.
173580*    MOVE EFTM-KEY            TO DBIOMOD-KEY.                  TB0267
173590     MOVE SPACES              TO DBIOMOD-STATUS
173600                                 DBIOMOD-RELEASE-LOCK
173610                                 DBIOMOD-ACCESS-COND
173620                                 DBIOMOD-ACCESS-COMMAND.
173630*    MOVE ZEROES              TO DBIOMOD-KEY-NO.               TB0267
173640     CALL DBIOMODNAME USING
173650                            DBIOMOD-FILE
173660                            DBIOMOD-KEY
173670                            WS-EFTM-AREA
173680                            DBIOMOD-FUNCTION
173690                            DBIOMOD-KEY-NO
173700                            DBIOMOD-RELEASE-LOCK
173710                            DBIOMOD-ACCESS-COMMAND
173720                            DBIOMOD-ACCESS-COND
173730                            DBIOMOD-STATUS.
173740     IF  DBIOMOD-STAT NOT = "****" AND "MRNF"
173750         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
173760         MOVE 1   TO WA-MSG-ERR-FLAG
173770         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
173780                               TO UT8500CA-CALL-CODE
173790         MOVE SPACES           TO UT8500CA-INPUT-MSG
173800         STRING  "BR0000:(M1000) EFTM READ ERROR"
173810                 ", STAT=" DBIOMOD-STAT
173820                 ", KEY="  EFTM-KEY
173830         DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
173840         CALL "UT8500" USING
SC3409                             UT8500CA-AREA
SC3409         GO TO M1099-EXIT
SC3409    ELSE
SC3409         MOVE WS-EFTM-AREA TO TMP-EFTM-AREA
SC3409    END-IF.
173870*
173880 M1099-EXIT.
173890     EXIT.
173900/
173910 M1600-ACCESS-ARRS.
173920     MOVE "ARRS"               TO  DBIOMOD-FILE
173930                                   DBIOMOD-SUFFIX.
173940     MOVE "DBIO"               TO  DBIOMOD-PREFIX.
173950     MOVE ZEROES               TO  DBIOMOD-KEY-NO.
173960     MOVE SPACES               TO  DBIOMOD-STATUS
173970                                   DBIOMOD-RELEASE-LOCK
173980                                   DBIOMOD-ACCESS-COMMAND
173990                                   DBIOMOD-ACCESS-COND.
174000     CALL DBIOMODNAME USING
174010                       DBIOMOD-FILE
174020                       DBIOMOD-KEY
174030                       ARRS-RECORD-AREA
174040                       DBIOMOD-FUNCTION
174050                       DBIOMOD-KEY-NO
174060                       DBIOMOD-RELEASE-LOCK
174070                       DBIOMOD-ACCESS-COMMAND
174080                       DBIOMOD-ACCESS-COND
174090                       DBIOMOD-STATUS.
174110 M1699-EXIT.
174120     EXIT.
174130/
174140 F200-DO-NEW-REFRESH.
174150*
174160*  IF THE TRANSACTION ORIGINATED FROM AN EFT DEVICE, WE USE A CALL
174170*  CODE OF 1 TO EI0090, WHICH MEANS 'BUILD THE REFRESH AND RETURN
174180*  IMMEDIATELY WITHOUT PUTTING IT IN STORE & FORWARD'. THE REFRESH
174190*  MESSAGE IS THEN USED AS THE TRANSACTION RESPONSE. OTHERWISE, WE
174200*  USE CALL CODE 2, WHICH BUILDS THE MESSAGE AND ALSO PUTS IT IN
174210*  STORE & FORWARD.
174220*
174230     IF SOC-NO-LON-REFRESH
S17474     OR WA-MSG-TRN-NO
174240        GO TO F299-EXIT.
174250*     MOVE 9 TO EI0085CA-CALL-CODE.
174260*    MOVE 0 TO EI0085CA-FUNC.
174270*    PERFORM M1300-CALL-EI0085 THRU M1399-EXIT.
TB0226     MOVE 9 TO MI0095CA-CALL-CODE.
TB0226     MOVE 0 TO MI0095CA-FUNC.
TB0226     PERFORM M1300-CALL-MI0095 THRU M1399-EXIT.
174280     IF WA-MSG-ERR-FLAG NOT = 0
174290        CALL "FT0000" USING
174300                           STARTAREA
174310         GO TO F299-EXIT.
S18374
S18374     IF WA-RFSH-ACCT-NO(1) > 0
S18374        MOVE SPACES         TO MI0090CA-REFRESH-TYPE
S18374        MOVE 2              TO MI0090CA-CALL-CODE
S18374        MOVE 0              TO MI0090CA-FUNC-CODE
S18374        MOVE 0              TO MI0090CA-MAX-OD
S18374        IF BORM-SYS = "BOR" OR "LON"
S18374           MOVE "L"         TO MI0090CA-SYS
S18374        ELSE
S18374           MOVE " "         TO MI0090CA-SYS
S18374        END-IF
S18374        CALL "MI0090" USING LS-MI0090CA-CALL-AREA
S18374                            STARTAREA
S18374                            LS-MREF-AREA
S18374                            SOC-PARAMS
S18374                            UT1999CA-CALL-AREA
S18374                            LS-RFSH-AREA
S18374        IF MI0090CA-RETURN-CODE NOT = 0
S18374           MOVE 1           TO WA-MSG-ERR-FLAG
S18374           MOVE 4777        TO WA-OUTPUT-ERR-MSG-NO
S18374           MOVE UT8500CA-FUNC-NORMAL-DISPLAY
S18374                            TO UT8500CA-CALL-CODE
S18374           MOVE SPACES TO UT8500CA-INPUT-MSG
S18374           STRING "BR0000:(F200) ERROR RETURN FROM MI0090, "
S18374                  "STATUS=" MI0090CA-RETURN-CODE
S18374                  DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S18374           CALL "UT8500" USING UT8500CA-AREA
S18374           CALL "FT0000" USING STARTAREA
S18374           GO TO F299-EXIT
S18374        END-IF
S18374     END-IF.
S18374
S12622     MOVE STRT-AREA-TRN-NO TO LINK-IN-TXCODE.
S12622     MOVE STRT-AREA-SOC-NO TO LINK-IN-SOC-NO.
S12622     MOVE 02 TO LINK-IN-CALL-CODE.
S12622     CALL "UT0250"     USING LINK-AREA.
S12622     IF  LINK-OUT-STAT NOT = "****"
S12622         MOVE 0 TO LINK-IN-TXCODE
S12622         MOVE 1 TO WA-MSG-ERR-FLAG
S12622         MOVE 100 TO WA-OUTPUT-ERR-MSG-NO
S12622         GO TO F299-EXIT
S12622     END-IF.
S12622     MOVE LINK-EDIT-MASK   TO FIELD-B.
S12622     CALL "UT0022"     USING PUAREA.
S12622     MOVE FIELD-A          TO WA-EDIT-MASK.
174320*
174330*    IF NOTHING HAS BEEN CAPTURED FOR REFRESH WE PROCEED
174340*     TO CHECK IF THE TXN ORIGINATED FROM AN EFT SYSTEM, IN WHICH
174350*     CASE WE HAVE TO RESPOND DIRECTLY TO THE EFT SYSTEM.
174360*
174370*    IF EI0085CA-REFRESH-IND NOT = 1
S11402*SC4446     IF WA-MSG-ERR-FLAG = 0 AND STRT-AREA-TRN-NO = 12000
S11402     IF WA-MSG-ERR-FLAG = 0 AND
S12622       (STRT-AREA-TRN-NO = 12000 OR WS-DCHARGE-REFRESH OR
S12622       (((BORP-YOUBE AND BORP-YB-PROD) OR
S15999          PROD-REORG-CREDIT  OR
S12622         (BORP-CONSMR AND BORP-NEGO-PROD))
S12794*S12622          AND WA-INPUT-PARAM-TABLE(4) = 1
S12794              AND (WA-INPUT-PARAM-TABLE(4) = 1
S12794              OR  (WA-CUST-INC-EXP-FEES
S12794              OR   WA-WAVE-TRCODE
S12794              OR   WA-YOUBE-WAVE-TRCODE))
S12622          AND BOIS-CLCT-DOWNLOAD-CLS = "D"))
S12622*S11402        (STRT-AREA-TRN-NO = 12000 OR WS-DCHARGE-REFRESH)
SC4446        MOVE 1 TO MI0095CA-REFRESH-IND
SC4446        MOVE 1 TO MI0095CA-CALL-CODE.
TB0226     IF MI0095CA-REFRESH-IND NOT = 1
174380        GO TO F280-CHECK-EFT.
S12746
S12746     IF BORP-CONSMR AND BORP-NEGO-ASSOC-PROD
S12746        INITIALIZE UTAMDCCA-AREA
S12746        MOVE BORM-SOC-NO          TO UTAMDCCA-SOC-NO
S12746        MOVE BORM-CUSTOMER-NO     TO UTAMDCCA-CUSTOMER-NO
S12746        CALL "UTAMDC"  USING UTAMDCCA-CALL-AREA
S12746        IF UTAMDCCA-NPL-FLAG  = "Y" AND
S12794*S12746        NOT (STRT-AREA-TRN-NO = 12000 OR WS-DCHARGE-REFRESH)
S12794        NOT (STRT-AREA-TRN-NO = 12000 OR WS-DCHARGE-REFRESH
S12794         OR  WA-CUST-INC-EXP-FEES OR WA-YOUBE-WAVE-TRCODE
S12794         OR  WA-WAVE-TRCODE)
S12746           GO TO F280-CHECK-EFT
S12746        END-IF
S12746     END-IF.
S12746
174390*
174400*    IF  STRT-AREA-EFT-TXN                  SC7253
174410*        MOVE 1 TO MI0090CA-CALL-CODE
TB0226*        MOVE 1 TO MI0090CA-CALL-CODE       SC7253
174420*    ELSE                                   SC7253
174430*        MOVE 2 TO MI0090CA-CALL-CODE.
TB0226     MOVE 2 TO MI0090CA-CALL-CODE.
174440*    MOVE 0 TO MI0090CA-MAX-OD.
TB0226     MOVE 0 TO MI0090CA-MAX-OD.
174450     IF BORM-SYS = "BOR" OR "LON"
174460*       MOVE "L" TO MI0090CA-SYS
TB0226        MOVE "L" TO MI0090CA-SYS
174470     ELSE
174480*       MOVE " " TO MI0090CA-SYS.
TB0226        MOVE " " TO MI0090CA-SYS.
TB0274**--
TB0274     MOVE 0     TO MI0090CA-FUNC-CODE.
TB0274     MOVE SPACES TO MI0090CA-DR-CR-IND.
TB0274     MOVE SPACES TO MI0090CA-EC-FLAG.
TB0274     MOVE 0      TO MI0090CA-TXN-AMT.
TB0274     MOVE WA-OUTPUT-ERR-MSG-NO TO MI0090CA-ERR-CODE.
TB0274     MOVE 0      TO MI0090CA-TXN-DATE.
SC3827*TB0274     IF WA-VIRTUAL-ACT-TYPE
SC3827*TB0274        MOVE 1   TO MI0090CA-FUNC-CODE
SC3827*TB0274       IF WA-INPUT-PARAM-TABLE(4) = 1
SC3827*TB0274          MOVE "C"   TO MI0090CA-DR-CR-IND
SC3827*TB0274       ELSE
SC3827*TB0274          MOVE "D"   TO MI0090CA-DR-CR-IND
SC3827*TB0274       END-IF
SC3827*TB0274       MOVE WA-INPUT-AMT TO MI0090CA-TXN-AMT
SC3827*TB0274       IF WA-INPUT-PARAM-TABLE(7) = 1
SC3827*TB0274          MOVE "*"   TO MI0090CA-EC-FLAG
SC3827*TB0274       ELSE
SC3827*TB0274          MOVE SPACE TO MI0090CA-EC-FLAG
SC3827*TB0274       END-IF
SC3827*TB0274       MOVE LRTP-TXN-DATE  TO MI0090CA-TXN-DATE
SC3827*TB0274     END-IF.
TB0274**--
S11751     MOVE  SPACES               TO MI0090CA-REFRESH-TYPE.
SC4453     IF STRT-AREA-VIRTUAL-ACCT-FLAG NOT = "Y" AND NOT = "B"
SC4453        EVALUATE STRT-AREA-TRN-NO
SC4453           WHEN 7046
SC4453                MOVE ">6"       TO MI0090CA-REFRESH-TYPE
SC4453           WHEN 2000
SC4453                MOVE ">I"       TO MI0090CA-REFRESH-TYPE
SC4453           WHEN 12000
SC4453                MOVE ">I"       TO MI0090CA-REFRESH-TYPE
S12259           WHEN 12410
S11402           WHEN 13010
S11402           WHEN 13045
S11402           WHEN 13046
S11402           WHEN 13011
S11402           WHEN 15045
S11402           WHEN 15046
S11402           WHEN 13110
S11402           WHEN 13145
S11402           WHEN 13146
S11402           WHEN 13111
S11402           WHEN 15145
S11402           WHEN 15146
S18413           WHEN 14028
S18413           WHEN 19028
S18413           WHEN 14041
S18413           WHEN 19041
S16235           WHEN 13047
S16235           WHEN 15047
S16235           WHEN 13147
S16235           WHEN 15147
S11402                MOVE ">D"            TO MI0090CA-REFRESH-TYPE
S11751*          WHEN OTHER
S11751*               MOVE ">$"       TO MI0090CA-REFRESH-TYPE
SC4453        END-EVALUATE
SC4453     ELSE
SC7253***
SC7253*** let utvtac call mi0090 to save refresh record
SC7253***
SC4453        MOVE ">V"               TO MI0090CA-REFRESH-TYPE    
SC4453     END-IF.
S12622     IF WA-INPUT-PARAM-TABLE(25) <> 1
S12622      IF ((BORP-YOUBE AND BORP-YB-PROD) OR
S15999           PROD-REORG-CREDIT  OR
S12622          (BORP-CONSMR AND BORP-NEGO-PROD))
S12794*S12622          AND WA-INPUT-PARAM-TABLE(4) = 1
S12794          AND (WA-INPUT-PARAM-TABLE(4) = 1
S12794              OR  (WA-CUST-INC-EXP-FEES
S12794              OR   WA-WAVE-TRCODE
S12794              OR   WA-YOUBE-WAVE-TRCODE))
S12622          AND BOIS-CLCT-DOWNLOAD-CLS = "D"
S12622          INITIALIZE            MI0090CA-CLCT-UPLOAD-DATA
S12622          MOVE ">C"              TO MI0090CA-REFRESH-TYPE
S12622          MOVE WA-INPUT-ACCT-NO  TO MI0090CA-YB-ACCT-NO
S12622          MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE
S12622          MOVE                 2 TO UT0020-FUNCTION
S12622          PERFORM X600-UT0020-PARA THRU X609-EXIT
S12622          MOVE UT0020-DATE-CCYYMMDD TO MI0090CA-YB-POST-DATE
S12622          IF WA-INPUT-PARAM-TABLE(8) = 1
S12622             MOVE W800-CC           TO MI0090CA-YB-TXN-CC
S12622             MOVE W800-YY           TO MI0090CA-YB-TXN-YY
S12622             MOVE W800-MM           TO MI0090CA-YB-TXN-MM
S12622             MOVE W800-DD           TO MI0090CA-YB-TXN-DD
S12622          ELSE
S12622             MOVE UT0020-DATE-CCYYMMDD TO MI0090CA-YB-TXN-DATE
S12622          END-IF
S12622          IF WA-INPUT-PARAM-TABLE(7) = 1
S12622             IF WA-INPUT-PARAM-TABLE(8) = 1
S12622                MOVE W800-CC        TO MI0090CA-CORR-TXN-CC
S12622                MOVE W800-YY        TO MI0090CA-CORR-TXN-YY
S12622                MOVE W800-MM        TO MI0090CA-CORR-TXN-MM
S12622                MOVE W800-DD        TO MI0090CA-CORR-TXN-DD
S12622             ELSE
S12622              MOVE UT0020-DATE-CCYYMMDD TO MI0090CA-CORR-TXN-DATE
S12622             END-IF
S12622             MOVE WA-REPAY-TRACER-NO  TO MI0090CA-CORR-TRACER-NO
S12622          END-IF
S12622          MOVE STRT-AREA-MSG-TIME  TO MI0090CA-YB-POST-TIME
S12622          MOVE STRT-AREA-JRNL-NO   TO MI0090CA-YB-JRNL-NO
S12622          MOVE STRT-AREA-TRN-NO    TO MI0090CA-YB-TXN-CODE
S12794          IF WA-WAVE-TRCODE
S12794             MOVE 0                   TO MI0090CA-YB-TXN-AMOUNT
S12794          ELSE
S12622             MOVE WA-REPAY-AMOUNT     TO MI0090CA-YB-TXN-AMOUNT
S12794          END-IF
S12622          COMPUTE MI0090CA-YB-PRINCIPAL-PAID =
S12622                  WA-PRINCIPAL-AMT1 - BORM-LOAN-BAL
S12622      END-IF
S12622     END-IF.
SC7333     IF MI0090CA-REFRESH-TYPE = ">V" 
SC7333*      STRT-AREA-VIRTUAL-ACCT-FLAG  NOT = "B"                 SC6897
SC7333*       GO TO F299-EXIT                                       SC6897
SC6897        GO TO F280-CHECK-EFT
SC7333     END-IF.
S11402*SC4446     IF WA-MSG-ERR-FLAG = 0 AND STRT-AREA-TRN-NO = 12000
S11402     IF WA-MSG-ERR-FLAG = 0 AND (STRT-AREA-TRN-NO = 12000 OR
S11402        WS-DCHARGE-REFRESH)
SC4446        MOVE 1 TO MI0090CA-FUNC-CODE
SC4446        MOVE 2 TO MI0090CA-CALL-CODE.
174490*    CALL "EI0090" USING
174500*                        LS-MI0090CA-CALL-AREA
S11751     IF MI0090CA-REFRESH-TYPE NOT = SPACES
S11751       CALL "MI0090" USING
TB0226                         LS-MI0090CA-CALL-AREA
174510                         STARTAREA
174520                         LS-MREF-AREA
174530                         SOC-PARAMS
174540                         UT1999CA-CALL-AREA
S11751                         LS-RFSH-AREA
174560*
S11751       IF  MI0090CA-RETURN-CODE NOT = 0
174580         MOVE 1 TO WA-MSG-ERR-FLAG
SC7050*------- WRITING TO REFRESH TABLE UNSUCCESSFUL
SC7050         MOVE 4777   TO  WA-OUTPUT-ERR-MSG-NO
174590         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
174600         MOVE SPACES TO UT8500CA-INPUT-MSG
174610*        STRING "BR0000:(F250) ERROR RETURN FROM EI0090, "
TB0226         STRING "BR0000:(F250) ERROR RETURN FROM MI0090, "
174620                "STATUS="
174630*               MI0090CA-RETURN-CODE
TB0226                MI0090CA-RETURN-CODE
174640                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
174650         CALL "UT8500" USING
174660                       UT8500CA-AREA
174670         CALL "FT0000" USING
174680                       STARTAREA
174690         GO TO F299-EXIT
S11751       ELSE
S11751         MOVE "Y" TO MI0090-REFRESH-FLAG
S11751       END-IF
S11751     END-IF.
174720*
174730*    IF THE TRANSACTION ORIGINATED FROM AN ATM, AND IF NO PRIOR
174740*    ERROR HAS BEEN DETECTED, THE RESPONSE, IN REFRESH FORMAT, IS     
174750*    IN REAL TIME. IF IT ORIGINATED AT AN ATM BUT A PRIOR ERROR
174760*    CONDITION HAS OCCURRED, WE EXIT IMMEDIATELY, SINCE NO FURTHER
174770*    RESPONSE IS REQUIRED. OTHERWISE, IT MUST BE A NON-ATM TRANSAC     
174780*    AND THE RESULTING BALANCE CHANGE REFRESH HAS ALREADY BEEN
174790*    DONE BY EI0090.
174800*
SC9184*SC8686 F280-CHECK-EFT.
SC8686*
S12622     IF WA-INPUT-PARAM-TABLE(25) = 1
S12622     AND STRT-AREA-TRN-NO <> 12410
S12622     AND ((BORP-YOUBE AND BORP-YB-PROD) OR
S15999           PROD-REORG-CREDIT  OR
S12622          (BORP-CONSMR AND BORP-NEGO-PROD))
S12622     AND BOIS-CLCT-DOWNLOAD-CLS = "D"
S12746     AND UTAMDCCA-NPL-FLAG NOT = "Y"
S12622        INITIALIZE            MI0090CA-CLCT-UPLOAD-DATA
S12622        MOVE 0 TO MI0090CA-MAX-OD
S12622        IF BORM-SYS = "BOR" OR "LON"
S12622           MOVE "L" TO MI0090CA-SYS
S12622        ELSE
S12622           MOVE " " TO MI0090CA-SYS
S12622        END-IF
S12622**--
S12622        MOVE SPACES TO MI0090CA-DR-CR-IND
S12622        MOVE SPACES TO MI0090CA-EC-FLAG
S12622        MOVE 0      TO MI0090CA-TXN-AMT
S12622        MOVE WA-OUTPUT-ERR-MSG-NO TO MI0090CA-ERR-CODE
S12622        MOVE 0      TO MI0090CA-TXN-DATE
S12622**--
S12622        MOVE ">C"                TO MI0090CA-REFRESH-TYPE
S12622        MOVE WA-INPUT-ACCT-NO    TO MI0090CA-YB-ACCT-NO
S12622        MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE
S12622        MOVE                 2 TO UT0020-FUNCTION
S12622        PERFORM X600-UT0020-PARA THRU X609-EXIT
S12622        MOVE UT0020-DATE-CCYYMMDD TO MI0090CA-YB-POST-DATE
S12622        IF WA-INPUT-PARAM-TABLE(8) = 1
S12786           MOVE WA-DISCH-CC      TO MI0090CA-YB-TXN-CC
S12786           MOVE WA-DISCH-YY      TO MI0090CA-YB-TXN-YY
S12786           MOVE WA-DISCH-MM      TO MI0090CA-YB-TXN-MM
S12786           MOVE WA-DISCH-DD      TO MI0090CA-YB-TXN-DD
S12786*S12622           MOVE W800-CC          TO MI0090CA-YB-TXN-CC
S12786*S12622           MOVE W800-YY          TO MI0090CA-YB-TXN-YY
S12786*S12622           MOVE W800-MM          TO MI0090CA-YB-TXN-MM
S12786*S12622           MOVE W800-DD          TO MI0090CA-YB-TXN-DD
S12622        ELSE
S12622           MOVE UT0020-DATE-CCYYMMDD TO MI0090CA-YB-TXN-DATE
S12622        END-IF
S12622        MOVE STRT-AREA-MSG-TIME  TO MI0090CA-YB-POST-TIME
S12622        MOVE STRT-AREA-JRNL-NO   TO MI0090CA-YB-JRNL-NO
S12622        MOVE STRT-AREA-TRN-NO    TO MI0090CA-YB-TXN-CODE
S12622        MOVE WA-REPAY-AMOUNT     TO MI0090CA-YB-TXN-AMOUNT
S12622        COMPUTE MI0090CA-YB-PRINCIPAL-PAID =
S12622                WA-PRINCIPAL-AMT1 - BORM-LOAN-BAL
S12622        MOVE 1 TO MI0090CA-FUNC-CODE
S12622        MOVE 2 TO MI0090CA-CALL-CODE
S12622        CALL "MI0090" USING
S12622                      LS-MI0090CA-CALL-AREA
S12622                      STARTAREA
S12622                      LS-MREF-AREA
S12622                      SOC-PARAMS
S12622                      UT1999CA-CALL-AREA
S12622                      LS-RFSH-AREA
S12622*
S12622        IF  MI0090CA-RETURN-CODE NOT = 0
S12622            MOVE 1 TO WA-MSG-ERR-FLAG
S12622            MOVE 4777   TO  WA-OUTPUT-ERR-MSG-NO
S12622            MOVE UT8500CA-FUNC-NORMAL-DISPLAY
S12622                 TO UT8500CA-CALL-CODE
S12622            MOVE SPACES TO UT8500CA-INPUT-MSG
S12622            STRING "BR0000:(F200) ERROR RETURN FROM MI0090, "
S12622            "STATUS="
S12622            MI0090CA-RETURN-CODE
S12622            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S12622            CALL "UT8500" USING
S12622                          UT8500CA-AREA
S12622            CALL "FT0000" USING
S12622                          STARTAREA
S12622            GO TO F299-EXIT
S12622        ELSE
S12622            MOVE "Y" TO MI0090-REFRESH-FLAG
S12622        END-IF
S12622     END-IF.
S12622
S18566*SC3827     IF WA-VIRTUAL-ACT-TYPE
S18566*ST0132        MOVE 2 TO MI0090CA-CALL-CODE
S18566*SC3827        MOVE 0     TO MI0090CA-FUNC-CODE
S18566*SC3827        MOVE SPACES TO MI0090CA-DR-CR-IND
S18566*SC3827        MOVE SPACES TO MI0090CA-EC-FLAG
S18566*SC3827        MOVE 0      TO MI0090CA-TXN-AMT
S18566*SC3827        MOVE WA-OUTPUT-ERR-MSG-NO TO MI0090CA-ERR-CODE
S18566*SC3827        MOVE 0      TO MI0090CA-TXN-DATE
S18566*SC3827        MOVE 1   TO MI0090CA-FUNC-CODE
S18566*SC3827        MOVE ">L"    TO MI0090CA-REFRESH-TYPE
S18566*SC3827       IF WA-INPUT-PARAM-TABLE(4) = 1
S18566*SC3827          MOVE "C"   TO MI0090CA-DR-CR-IND
S18566*SC3827       ELSE
S18566*SC3827          MOVE "D"   TO MI0090CA-DR-CR-IND
S18566*SC3827       END-IF
S18566*SC3827       MOVE WA-INPUT-AMT TO MI0090CA-TXN-AMT
S18566*SC3827       IF WA-INPUT-PARAM-TABLE(7) = 1
S18566*SC3827          MOVE "*"   TO MI0090CA-EC-FLAG
S18566*SC3827       ELSE
S18566*SC3827          MOVE SPACE TO MI0090CA-EC-FLAG
S18566*SC3827       END-IF
S18566*SC3827       MOVE LRTP-TXN-DATE  TO MI0090CA-TXN-DATE
SC3827*    END-IF                                                 SC6329
S18566*SC3827       CALL "MI0090" USING
S18566*SC3827                           LS-MI0090CA-CALL-AREA
S18566*SC3827                           STARTAREA
S18566*SC3827                           LS-MREF-AREA
S18566*SC3827                           SOC-PARAMS
S18566*SC3827                           UT1999CA-CALL-AREA
S18566*SC3827                           LS-RFSH-AREA
S18566*SC3827       IF  MI0090CA-RETURN-CODE NOT = 0
S18566*SC3827           MOVE 1 TO WA-MSG-ERR-FLAG
S18566*SC3827           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
S18566*SC3827           MOVE SPACES TO UT8500CA-INPUT-MSG
S18566*SC3827           STRING "BR0000:(F250) ERROR RETURN FROM MI0090, "
S18566*SC3827                  "STATUS="
S18566*SC3827                  MI0090CA-RETURN-CODE
S18566*SC3827                  DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S18566*SC3827           CALL "UT8500" USING
S18566*SC3827                         UT8500CA-AREA
S18566*SC3827           CALL "FT0000" USING
S18566*SC3827                         STARTAREA
S18566*SC3827           GO TO F299-EXIT
S18566*SC3827       ELSE
S18566*SC3827           MOVE "Y" TO MI0090-REFRESH-FLAG
S18566*SC6329       END-IF
S18566*SC6329     END-IF.
SC3827**--
SC9184 F280-CHECK-EFT.
174820*
174830     IF WS-RESPONSE-SENT-FLAG = "Y"
174840        GO TO F299-EXIT.
TB0212     IF NOT STRT-AREA-EFT-TXN
TB0212        GO TO F299-EXIT
TB0212     END-IF.
174850*
174860     IF  STRT-AREA-EFT-TXN
174870*        MOVE BORM-MEMB-CUST-AC   TO UT0151CA-ACCT-IN                  SC4465
SC7006         IF FEDI-FROM-TO-GL
SC7091*        AND (STRT-AREA-TRN-NO = 11055 OR 11155)
SC7091         AND (STRT-AREA-TRN-NO = 11055 OR 11155 OR 16055 OR 16155)
SC7006            MOVE W800-FROM-ACCT    TO W800-TO-ACCT
SC7006            MOVE BORM-MEMB-CUST-AC TO W800-FROM-ACCT
SC7006         END-IF
S16871         IF STRT-DSS-BUNCH-TXN
S16871            MOVE W800-FROM-ACCT    TO W800-TO-ACCT
S16871            MOVE BORM-MEMB-CUST-AC TO W800-FROM-ACCT
S16871         END-IF
SC5293         IF STRT-AREA-TRN-NO = 14045 OR 14145
SC7091                            OR 19045 OR 19145
SC5695                            OR 11045 OR 11145
SC7091                            OR 16045 OR 16145
S18413                            OR 14041 OR 19041
SC5293            MOVE W800-TO-ACCT        TO UT0151CA-ACCT-IN
SC5293         ELSE
SC4465            MOVE W800-FROM-ACCT      TO UT0151CA-ACCT-IN
SC5293         END-IF
174880         MOVE 2                   TO UT0151CA-CALL-FUNC
174890         MOVE SOC-ACCT-NO-FORMAT  TO UT0151CA-FORMAT
174900         MOVE SOC-CHK-DGT         TO UT0151CA-CHK-DGT-TYPE
174910*
174920         CALL "UT0151" USING UT0151CA-CALL-AREA
174930             MOVE "RF" TO WA-INPUT-MSG-TYPE-X
174940             IF (STRT-AREA-TRN-NO = 19200 OR 19210)
174950                MOVE "08" TO WS-ATM-OUT-FLAG
174960             ELSE
174970                MOVE ">R" TO WS-ATM-OUT-FLAG
174980             END-IF
174990             MOVE 1 TO WS-ATM-OUT-NO-OF-ACCTS
175000             MOVE STRT-AREA-SOC-NO TO WS-ATM-OUT-INST-NO
175010             MOVE UT0151CA-ACCT-EX TO WS-ATM-OUT-ACCT-NO
175020             MOVE "L"              TO WS-ATM-OUT-DEP-LON
175030*            MOVE MREF-DATA-NO-TXNS                                    SC4465
175040*                 TO WS-ATM-OUT-REFR-NO-TXNS                           SC4465
SC4465*** HOME BRANCH OF "FROM" ACCT
SC4465             MOVE SPACES         TO DBIO-01-KEY
SC5293             IF STRT-AREA-TRN-NO NOT = 14045 AND NOT = 14145
SC5695                             AND NOT = 11045 AND NOT = 11145
SC7091                             AND NOT = 19045 AND NOT = 19145
SC7957                             AND NOT = 16045 AND NOT = 16145
S18413                             AND NOT = 14041 AND NOT = 19041
SC4465                MOVE W800-FROM-ACCT TO WS-INPUT-KEY
SC4276                                       UT0035CA-DATA
SC5293             ELSE
SC5293                MOVE W800-TO-ACCT   TO WS-INPUT-KEY
SC5293                                       UT0035CA-DATA
SC5293             END-IF
SC4465*            MOVE WA-INPUT-KEY   TO  DBIO-01-ACCT-NO                    SC5293
SC5293             MOVE WS-INPUT-KEY   TO  DBIO-01-ACCT-NO
SC4276***
SC4276*** DETERMINE IF THE ACCOUNT NUMBER's SYSTEM IS DEP OR LON
SC4276***
SC4276             MOVE STRT-AREA-SOC-NO  TO UT0035CA-INST-NO
SC4276             MOVE 1              TO UT0035CA-CALL-CODE
SC4276*            CALL "UT0035" USING STRT-AREA-DATA                   ST0142
SC4276             CALL "UT0035" USING STARTAREA                        ST0142
SC4276                            WS-UT0035CA-AREA
ST0142                            PDCS-RECORD-AREA
SC4276
SC4276             IF UT0035CA-RETURN-ERROR NOT = 0
SC4276               MOVE 1               TO WA-MSG-ERR-FLAG
SC4276               MOVE UT0035CA-RETURN-ERROR
SC4276                                  TO WA-OUTPUT-ERR-MSG-NO
SC4276               GO TO F299-EXIT
SC4276             END-IF
SC4276             EVALUATE TRUE
SC4276             WHEN APPLIC-DEP
SC3909                  IF STRT-AREA-TRN-NO NOT = 4010 AND NOT = 4110
SC3909                                 AND  NOT = 4030 AND NOT = 4030
SC5293                     MOVE WS-INPUT-KEY TO INVM-MEMB-CUST-AC
SC4276                     PERFORM B1000-READ-INVM THRU B1999-EXIT
SC3909                  END-IF
SC4276             WHEN APPLIC-LON
SC3909                  IF STRT-AREA-TRN-NO NOT = 14010 AND NOT = 14110
SC3909                                 AND  NOT = 14030 AND NOT = 14130
SC5862                                 AND NOT = 14011 AND NOT = 14111
SC7091                                 AND NOT = 19011 AND NOT = 19111
SC7091                                 AND NOT = 19030 AND NOT = 19130
S18413                                 AND NOT = 14028 AND NOT = 19028
S18413                                 AND NOT = 14041 AND NOT = 19041
TB0212*** 19055/14055 needs to read borm to get the correct info of the FROM acct
CS7091*                                AND NOT = 19055 AND NOT = 14055
S19705*RICHATR PROD. VIA EAI TO SETTLE,NO NEEDS TO READ BORM
S19705                     IF PROD-RICHART
S19705                        AND  ( STRT-AREA-TRN-NO = 15045
S19705                            OR STRT-AREA-TRN-NO = 13045
S19705                            OR STRT-AREA-TRN-NO = 13011 )
S19705                        AND    STRT-DIB-TXN
S19705                        NEXT SENTENCE
S19705                     ELSE
SC4465                        PERFORM B110-READ-BORM  THRU B110-EXIT
S19705                     END-IF
SC3909                  END-IF
SC4276             END-EVALUATE
SC4404             IF DBIO-CALL-STATUS = "****"                       
SC4404             AND WA-OUTPUT-ERR-MSG-NO = 111                    
SC4404                 MOVE 0      TO WA-MSG-ERR-FLAG               
SC4404                                WA-OUTPUT-ERR-MSG-NO         
SC4404             END-IF
SC4465***
SC4465*** MOVE DETAIL DATA HERE
SC4465***
S16945           INITIALIZE TPSR-SEC-DATA
SC4276           IF APPLIC-LON
SC3909             IF STRT-AREA-TRN-NO NOT = 14010
SC3909                             AND NOT = 14110
SC3909                             AND NOT = 14030
SC3909                             AND NOT = 14130
SC5862                             AND NOT = 14011
SC5862                             AND NOT = 14111
SC7091                             AND NOT = 19011
SC7091                             AND NOT = 19111
SC7091                             AND NOT = 19030
SC7091                             AND NOT = 19130
S18413                             AND NOT = 14028
S18413                             AND NOT = 19028
SC4465                MOVE BORM-BR-NO TO TPSR-FR-HOME-BRCH
SC3909             ELSE
SC3909                MOVE 0          TO TPSR-FR-HOME-BRCH
SC3909             END-IF
B20330*B19893             MOVE "LON"         TO TPSR-FR-ACCT-SYSTEM
B20330*B19893             MOVE BORM-MEMB-CUST-AC
B20330*B19893                                TO TPSR-FR-ACCT-NO
SC4465             MOVE BORM-CUSTOMER-NO
SC4465                  TO TPSR-CUSTOMER-NO
SC3909             MOVE 0
SC4465                  TO TPSR-SIGNATORIES
SC4465             MOVE BORM-LOAN-BAL
SC4465                  TO TPSR-CURR-BAL
S15219             IF BORP-YOUBE
S15219*SC9944      IF (BORP-YOUBE AND
S15219*SC9944         (STRT-AREA-TRN-NO = 14011 OR 14030 OR 14055 OR 14062
S15219*SC9944                            OR 14111 OR 14130 OR 14155 OR 14162
S15219*SC9944                            OR 19011 OR 19030 OR 19055 OR 19062
S15219*SC9944                            OR 19111 OR 19130 OR 19155 OR 19162
S15219*SC9944                            OR 19060 OR 19160 OR 14060 OR 14160))
SC9944                 COMPUTE TPSR-AVAIL-BAL = BOIS-ACCOUNT-LIMIT -
SC9944                                          BORM-LOAN-BAL -
S10614                                          BOIS-HOLD-AMT -
S11455                                          BOIS-UNAMORTIZED-DUE
SC9944                 IF TPSR-AVAIL-BAL < 0
SC9944                    MOVE 0 TO TPSR-AVAIL-BAL
SC9944                 END-IF
S11990                 IF BORM-STOP-TRAN-IND = "Y"
S11990                 OR BORM-STOP-TRAN-IND = "X"
S11990                 OR BORM-STOP-TRAN-IND = "F"
S12218                 OR STRT-AREA-POST-DT > BOIS-MATURITY-DATE
S11990                    IF BORM-LOAN-BAL < 0
S11990                       COMPUTE TPSR-AVAIL-BAL = 0
S11990                                           - BORM-LOAN-BAL
S11990                                           - BOIS-HOLD-AMT
S11990                                           - BOIS-UNAMORTIZED-DUE
S11990                       IF TPSR-AVAIL-BAL < 0
S11990                          MOVE 0 TO TPSR-AVAIL-BAL
S11990                       END-IF
S11990                    ELSE
S11990                       MOVE 0 TO TPSR-AVAIL-BAL
S11990                    END-IF
S11990                 END-IF
SC9944             ELSE
SC4914                 COMPUTE TPSR-AVAIL-BAL =
SC4914                         BORM-APP-AMT -
SC4914                         BORM-LOAN-BAL  -
S10614                         BOIS-HOLD-AMT
SC9944             END-IF
SC4465             IF BORM-STOP-IND NOT = 0
SC4465                MOVE 12 TO TPSR-ACCT-STATUS
SC4465             ELSE
SC4465                MOVE BORM-STAT TO TPSR-ACCT-STATUS
SC4465             END-IF
SC4465             MOVE 0
SC4465                 TO TPSR-INT-YTD
SC4465             MOVE BORM-CURRENCY-IND
SC4465                  TO TPSR-CURRENCY
SC4465             MOVE BORM-ATM-FLAG
SC4465                  TO TPSR-ATM-FLAG
TB0212             MOVE 2 TO TPSR-DECIMAL-PLACES
SC4465             MOVE BORM-ACT-TYPE
SC4465                  TO TPSR-ACCT-TYPE
SC4465             MOVE BORM-CAT
SC4465                  TO TPSR-INT-CAT
SC4465             MOVE BORM-APP-AMT
SC4465                  TO TPSR-CREDIT-LIMIT
S15492             IF ( BORP-YOUBE )
S15492                  MOVE BOIS-ACCOUNT-LIMIT TO TPSR-CREDIT-LIMIT
S15492             END-IF
SC4276           END-IF
SC4276           IF APPLIC-DEP
SC3909             IF STRT-AREA-TRN-NO NOT = 4010
SC4276                MOVE INVM-BRANCH-NO TO TPSR-FR-HOME-BRCH
SC3909             ELSE
SC3909                MOVE 0              TO TPSR-FR-HOME-BRCH
SC3909             END-IF
B20330*B19893             MOVE "DEP"             TO TPSR-FR-ACCT-SYSTEM
B20330*B19893             MOVE INVM-MEMB-CUST-AC TO TPSR-FR-ACCT-NO
SC4276             MOVE INVM-CUSTOMER-NO
SC4276                  TO TPSR-CUSTOMER-NO
SC4276             MOVE INVM-SIGNATURE-NO
SC4276                  TO TPSR-SIGNATORIES
SC4276             MOVE INVM-CURR-BAL
SC4276                  TO TPSR-CURR-BAL
SC4276*SC9732      MOVE INVM-CURR-BAL
SC4276*SC9732           TO TPSR-AVAIL-BAL
SC9732             MOVE 00                 TO UTINODCA-CALL-CODE
SC9732             MOVE INVM-SOC-NO        TO UTINODCA-SOC-NO
SC9732             MOVE INVM-MEMB-CUST-AC  TO UTINODCA-DEP-NO
SC9732             CALL "UTINOD" USING UTINOD-CALL-AREA
SC9732                                 STARTAREA
SC9732                                 WA-INVM-RECORD-AREA
SC9732             IF UTINODCA-STATUS = 0 OR 1
SC9732                MOVE UTINODCA-DATA-REC TO INOD-RECORD-AREA
SC9732                IF UTINODCA-STATUS = 0
SC9732                   MOVE INOD-TOTAL-LIMIT TO WA-OD-LINE-AMT
SC9732                ELSE
SC9732                   MOVE 0 TO WA-OD-LINE-AMT
SC9732                END-IF
SC9732             END-IF
SC9732***
SC9732*** COMPUTE AVAILABLE BALANCE
SC9732***
SC9732             COMPUTE TPSR-AVAIL-BAL = INVM-CURR-BAL
SC9732                                    - INVM-UNCL-CHQ-VAL
SC9732                                    - INVM-HOLD-VAL
SC9732                                    + INVM-CR-LIMIT
SC9732                                    + WA-OD-LINE-AMT
SC4276             MOVE INVM-CURR-STATUS
SC4276                  TO TPSR-ACCT-STATUS
SC4276             MOVE INVM-INT-AVAILABLE
SC4276                  TO TPSR-INT-YTD
TB0212             MOVE INVM-CURRENCY
SC4276                  TO TPSR-CURRENCY
SC4276             MOVE INVM-ATM-ACCT-FLAG
SC4276                  TO TPSR-ATM-FLAG
TB0212             MOVE 2
SC4276                  TO TPSR-DECIMAL-PLACES
SC4276             MOVE INVM-ACCT-TYPE
SC4276                  TO TPSR-ACCT-TYPE
SC4276             MOVE INVM-INT-CAT
SC4276                  TO TPSR-INT-CAT
SC4276             MOVE INVM-CR-LIMIT
SC4276                  TO TPSR-CREDIT-LIMIT
SC4276           END-IF
SC4465           MOVE WA-FEE-AMT    TO TPSR-FEE-CHARGE
SC4465           MOVE WS-RF-AMOUNT  TO TPSR-TRAN-AMOUNT
SC4465*** HOME BRANCH OF "TO" ACCT
SC4465*        IF STRT-AREA-TRN-NO NOT = 4050 AND              SC4276
SC4465**         IF (((STRT-AREA-TRN-NO NOT = 14050 AND NOT = 14150)
SC7091**         IF (((STRT-AREA-TRN-NO NOT = 19050 AND NOT = 19150)
CS7091           IF (((STRT-AREA-TRN-NO NOT = 19050 AND 19150 AND
CS7091                                        14050 AND 14150 )
SC4276              AND WA-INPUT-PARAM-TABLE(29) = 1)
SC3909              OR  STRT-AREA-TRN-NO = 14010 OR 14110
SC3909                                  OR 14030 OR 14131
SC7091                                  OR 19030 OR 19130
S18413                                  OR 14028 OR 19028
SC7091                                  OR 19011 OR 19111
SC5862                                  OR 14011 OR 14111)
TB0212***
TB0212***  if the TO acct is a CGL, then initialize TO account informations
TB0212***
TB0212              IF WA-STORE-TFR-SYST = 'GEN' OR 'CGL'
TB0212                 MOVE 0           TO TPSR-TO-HOME-BRCH
TB0212                                     TPSR-TO-ACCT-NO
TB0212                                     TPSR-TO-INT-CAT
TB0212                                     TPSR-TO-CURR-BAL
TB0212                                     TPSR-TO-AVAIL-BAL
TB0212                                     TPSR-TO-ACCT-STATUS
TB0212                 INITIALIZE          TPSR-TO-ACCT-SYSTEM
TB0212                 NEXT SENTENCE
TB0212              END-IF
SC4465              MOVE SPACES         TO DBIO-01-KEY
SC4276              MOVE STRT-AREA-SOC-NO TO UT0035CA-INST-NO
SC3909              IF STRT-AREA-TRN-NO = 14010 OR 14110
SC5862                                 OR 14011 OR 14111
SC5293                                 OR 14045 OR 14145
SC3909                                 OR 14030 OR 14030
SC5695                                 OR 11045 OR 11145
SC7091                                 OR 19011 OR 19111
SC7091                                 OR 19030 OR 19130
SC7091                                 OR 19045 OR 19145
SC7957                                 OR 16045 OR 16145
S18413                                 OR 14028 OR 19028
S18413                                 OR 14041 OR 19041
TB0212***
TB0212*** the CGL TO acct info of 19055 should be zeroes/spaces
TB0212***
CS7091*                             OR ((STRT-AREA-TRN-NO = 14055 OR
CS7091*                                                     19055)
SC6854*                             AND WA-STORE-TFR-SYST = 'CGL')
SC3909                 MOVE W800-FROM-ACCT TO WS-INPUT-KEY
SC3909                                        UT0035CA-DATA
SC3909              ELSE
SC4465                 MOVE W800-TO-ACCT TO WS-INPUT-KEY
SC4276                                      UT0035CA-DATA
SC3909              END-IF
SC4465*             MOVE WA-INPUT-KEY   TO  DBIO-01-ACCT-NO              SC5293
SC5293              MOVE WS-INPUT-KEY   TO  DBIO-01-ACCT-NO
SC4276***
SC4276*** DETERMINE IF THE ACCOUNT NUMBER's SYSTEM IS DEP OR LON
SC4276***                                                                                                 
SC7006          IF NOT (FEDI-FROM-TO-GL
SC7091*                 AND (STRT-AREA-TRN-NO = 11055 OR 11155))
SC7091             AND (STRT-AREA-TRN-NO = 11055 OR 11155
SC7091                                  OR 16055 OR 16155))
SC4276             MOVE 1              TO UT0035CA-CALL-CODE
SC4276*            CALL "UT0035" USING STRT-AREA-DATA                   ST0142
SC4276             CALL "UT0035" USING STARTAREA                        ST0142
SC4276                            WS-UT0035CA-AREA
ST0142                            PDCS-RECORD-AREA
SC4276
SC4276             IF UT0035CA-RETURN-ERROR NOT = 0
SC4276               MOVE 1               TO WA-MSG-ERR-FLAG
SC4276               MOVE UT0035CA-RETURN-ERROR
SC4276                                  TO WA-OUTPUT-ERR-MSG-NO
SC4276               GO TO F299-EXIT
SC4276             END-IF
SC7006          ELSE
SC7006             MOVE "GEN"  TO UT0035CA-APPLIC-NAME
SC7006          END-IF
SC4276             EVALUATE TRUE
SC4276             WHEN APPLIC-DEP
SC4276                  MOVE STRT-AREA-SOC-NO TO INVM-SOC-NO
SC4276                  MOVE W800-TO-ACCT     TO INVM-MEMB-CUST-AC
SC4276                  PERFORM B1000-READ-INVM THRU B1999-EXIT
ST0095                  MOVE "DEP"            TO TPSR-TO-ACCT-SYSTEM
SC4276             WHEN APPLIC-LON
SC4465                  PERFORM B110-READ-BORM THRU B110-EXIT
ST0095                  MOVE "LON"             TO TPSR-TO-ACCT-SYSTEM
SC7006             WHEN APPLIC-GEN
S15326                  MOVE BORM-RECORD-AREA  TO WA-SAVE-BORM-AREA
SC7006                  MOVE W800-TO-ACCT      TO DBIO-01-ACCT-NO
SC7006                  PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT
SC7006                  MOVE "GEN"             TO TPSR-TO-ACCT-SYSTEM
SC4276             END-EVALUATE
B20330             CALL "UT0024" USING
B20330                           STARTAREA
B20330                           MREF-DATA-TPS
B20330                           WA-INVM-RECORD-AREA
B20330                           GLDM-RECORD-AREA
B20330                           BORM-RECORD-AREA
B19893*ST0095             CALL "UT0024" USING
B19893*ST0095                           STARTAREA
B19893*ST0095                           MREF-DATA-TPS
B19893*SC7053                           WA-INVM-RECORD-AREA
B19893*SC7053                           GLDM-RECORD-AREA
B19893*SC7053                           BORM-RECORD-AREA
S15326             IF APPLIC-GEN
S15326                MOVE WA-SAVE-BORM-AREA TO BORM-RECORD-AREA
S15326             END-IF
SC4465         ELSE
SC3909             MOVE 0 TO TPSR-TO-HOME-BRCH
TB0212                       TPSR-TO-ACCT-NO
TB0212                       TPSR-TO-ACCT-TYPE
TB0212                       TPSR-TO-INT-CAT
TB0212                       TPSR-TO-CURR-BAL
TB0212                       TPSR-TO-AVAIL-BAL
TB0212                       TPSR-TO-ACCT-STATUS
TB0212           INITIALIZE TPSR-TO-ACCT-SYSTEM
TB0212         END-IF.
S10333           INITIALIZE TPSR-YB-NEXT-DUE-DATE
S10333                      TPSR-YB-MIN-DUE-AMOUNT
S10333                      WS-TMP-DISCHARGE-AMOUNT
S15219                      TPSR-YOUBE-INT-RATE
S10333           IF BORP-YOUBE
S10333          AND (STRT-AREA-TRN-NO NOT = 19045 AND NOT = 19145)
S10333              MOVE BOIS-NEXT-DUE-DATE     TO UT0020-BINARY-DATE
S10333              MOVE 1 TO UT0020-FUNCTION
S10333              CALL "UT0020" USING UT0020-FUNCTION
S10333                                  UT0020-DATE-AREA
S10333                                  UT0020-BINARY-DATE
S10333              MOVE UT0020-DATE-DDMMCCYY   TO TPSR-YB-NEXT-DUE-DATE
S10333              IF TPSR-YB-NEXT-DUE-DATE = 99999999
S10333                 MOVE ZEROES TO TPSR-YB-NEXT-DUE-DATE
S10333              END-IF
S10333              IF BORM-LOAN-BAL NOT > 0
S10333                 MOVE 0    TO TPSR-YB-MIN-DUE-AMOUNT
S10333              ELSE
S10333                 COMPUTE TPSR-YB-MIN-DUE-AMOUNT =
S10333                         BOIS-MIN-DUE-AMOUNT    +
S10333                         BOIS-REV-RECEIVABLE-DUE
S10333              END-IF
S11041              PERFORM Z200-GET-GRACE-DAYS THRU Z209-EXIT
S11041              IF WA-GRACE-DAYS > BORP-ARREARS-GRACE-PRD
S11041                 MOVE 0              TO WA-WORK-INT-0
S11041                 COMPUTE WA-WORK-INT-0 ROUNDED =
S11041                                 TPSR-YB-MIN-DUE-AMOUNT +
S11041                                 BORM-INT-ACCR
S11041                 MOVE WA-WORK-INT-0  TO TPSR-YB-MIN-DUE-AMOUNT
S11041              END-IF
S10333              COMPUTE WS-TMP-DISCHARGE-AMOUNT =
S10333                      BORM-LOAN-BAL           +
S10333                      BOIS-TEMP-PAYMENT-DUE   +
S10333                      BOIS-MISC-FEE1-DUE      +
S10333                      BOIS-REV-RECEIVABLE-DUE +
S10333                      BOIS-INTEREST-DUE       +
S10333                      BORM-INT-ACCR           +
S10333                      BORM-INT-ADJUSTMENT
S10333              IF WS-TMP-DISCHARGE-AMOUNT < BOIS-MIN-DUE-AMOUNT
S10333                 MOVE WS-TMP-DISCHARGE-AMOUNT TO
S10333                      TPSR-YB-MIN-DUE-AMOUNT
S10333              END-IF
S10333              IF TPSR-YB-MIN-DUE-AMOUNT NOT > 0
S10333                 MOVE 0 TO TPSR-YB-MIN-DUE-AMOUNT
S10333              END-IF
S15219*SAVE ORIGINAL WA-ADV-DATE-BIN
S15219*USE STRT-AREA-POST-DT FOR BACKDATE TXN
S15219              IF WA-FIRST-ADV
S15219                 MOVE WA-ADV-DATE-BIN   TO WA-ADV-DATE-BIN-SAVE
S15219                 MOVE STRT-AREA-POST-DT TO WA-ADV-DATE-BIN
S15219              END-IF
S15219
S15219              PERFORM H010A-GET-RATE  THRU H019A-EXIT
S15219              IF WA-MSG-ERR-FLAG = 0
S15219                 MOVE WA-INT-RATE-A    TO TPSR-YOUBE-INT-RATE
S15219              ELSE
S15219                 MOVE BORM-INT-RATE    TO TPSR-YOUBE-INT-RATE
S15219              END-IF
S15219
S15219              IF WA-FIRST-ADV
S15219                 MOVE WA-ADV-DATE-BIN-SAVE TO WA-ADV-DATE-BIN
S15219              END-IF
S10333           END-IF
SC3909             IF DBIO-CALL-STATUS = "****"
SC3909             AND WA-OUTPUT-ERR-MSG-NO = 111
SC3909                 MOVE 0      TO WA-MSG-ERR-FLAG
SC3909                                WA-OUTPUT-ERR-MSG-NO
SC3909             END-IF
TB0212             MOVE ZEROES TO TPSR-OMNI-TD-ACCT
B20330*B19893             IF TPSR-FR-ACCT-SYSTEM =  "DEP"
B20330*B19893                OR
B20330*B19893                TPSR-TO-ACCT-SYSTEM >  SPACES
B20330*B19893                CALL "UT0024"   USING  STARTAREA
B20330*B19893                                       MREF-DATA-TPS
B20330*B19893                                       WA-INVM-RECORD-AREA
B20330*B19893                                       GLDM-RECORD-AREA
B20330*B19893                                       BORM-RECORD-AREA
B20330*B19893                END-CALL
B20330*B19893             END-IF
SC4465             MOVE MREF-DATA-TPS
SC4465                  TO WS-ATM-OUT-REFR-NO-TXNS
175050             COMPUTE WA-OUTPUT-MSG-LENGTH =
175060*                LENGTH OF MREF-DATA-NO-TXNS      +                                SC4465
SC4465                 LENGTH OF MREF-DATA-TPS          +
175070                 LENGTH OF WS-ATM-OUT-FLAG        +
175080                 LENGTH OF WS-ATM-OUT-ERROR-CODE  +
175090                 LENGTH OF WS-ATM-OUT-NO-OF-ACCTS
175100             MOVE WA-OUTPUT-ERR-MSG-NO TO WS-ATM-OUT-ERROR-CODE
175110             IF  WS-ATM-OUT-ERROR-CODE < 100 OR
175120                (WS-ATM-OUT-ERROR-CODE > 900 AND < 1000)
175130                MOVE 0                 TO WS-ATM-OUT-ERROR-CODE
175140             END-IF
175150             MOVE STRT-AREA-MSG-TIME   TO WS-ATM-OUT-TIME
175160*            MOVE WA-TRN-DATE-98       TO WS-STD-DATE
175170*            MOVE WS-STD-CC            TO WS-POST-CC
175180*            MOVE WS-STD-YY            TO WS-POST-YY
175190*            MOVE WS-STD-MM            TO WS-POST-MM
175200*            MOVE WS-STD-DD            TO WS-POST-DD
175210*            MOVE WS-POST-DATE         TO WS-ATM-OUT-DATE
SC4465***
SC4465*** SUPPLY THE CORRECT DATE
SC4465***
SC4465             MOVE 1       TO UT1999CA-CALL-CODE
SC4465             CALL "UT1999"   USING
SC4465                             UT1999CA-CALL-AREA
SC4465             END-CALL
SC4465             MOVE UT1999CA-CCYYMMDD TO WS-ATM-OUT-DATE
SC4465
175220*F0998.
SC4719***
SC4719*** UNCOMMENT
SC4719***
175230*            MOVE 998 TO WA-OUTPUT-ERR-MSG-NO
SC4719             MOVE 998 TO WA-OUTPUT-ERR-MSG-NO
175240             MOVE "A" TO STRT-AREA-OK-MSG-CNTL-FLAG
175250*            CALL "FT0000" USING
175260*                          STARTAREA
175270             MOVE "Y" TO WS-RESPONSE-SENT-FLAG.
175280*
175290*
175300 F299-EXIT.
175310     EXIT.
175320*
175330*
175340 B080-CHANGE-TXCODE.
175350     MOVE 02         TO LINK-IN-CALL-CODE.
175360     MOVE STRT-AREA-SOC-NO     TO LINK-IN-SOC-NO.
175370     CALL "UT0250"   USING
175390                           LINK-AREA.
175400     IF LINK-OUT-STAT NOT = 4XSTARS
175410         MOVE 1     TO WA-MSG-ERR-FLAG
175420         MOVE 100   TO WA-OUTPUT-ERR-MSG-NO
175430     ELSE
175440         MOVE LINK-EDIT-MASK TO FIELD-B
175450         CALL "UT0022" USING PUAREA
175460         MOVE FIELD-A TO WA-EDIT-MASK
175470         MOVE LINK-EDIT-TABLE TO STRT-AREA-EDIT-MASK.
175480*
175490 B080-EXIT.
175500     EXIT.
175510*
175520 L230-CREATE-CROSS-REF.
175530***  VALIDATE SCREEN FIELDS.
175540*
175550     MOVE IN0002-CARD-NO          TO WS-EXTN-REF-NO.
175560     MOVE "Y"                     TO WS-EXTN-REF-NUM.
175570     MOVE 1                       TO WA-COUNTER.
175580     PERFORM UNTIL WA-COUNTER > 25 OR WS-EXTN-REF-NUM = "N"
175590      OR WS-EXTN-REF-NO-CHAR(WA-COUNTER) = SPACE
175600        IF WS-EXTN-REF-NO-CHAR(WA-COUNTER) NUMERIC
175610           ADD 1                  TO WA-COUNTER
175620        ELSE
175630           MOVE "N"               TO WS-EXTN-REF-NUM
175640        END-IF
175650     END-PERFORM.
175660     IF WS-EXTN-REF-NUM = "Y"
175670***  RIGHT-JUSTIFIED
175680        MOVE ZEROES               TO UT9100CA-EXTN-REF-NO
175690        COMPUTE WA-LIMIT1 = WA-COUNTER - 1
175700        COMPUTE WA-LIMIT2 = 26 - WA-LIMIT1
175710        MOVE WS-EXTN-REF-NO(1:WA-LIMIT1)
175720          TO UT9100CA-EXTN-REF-NO(WA-LIMIT2:WA-LIMIT1)
175730     ELSE
175740       MOVE IN0002-CARD-NO        TO UT9100CA-EXTN-REF-NO
175750     END-IF.
175760*
175770     MOVE 1                          TO UT9100CA-CALL-CODE.
175780     MOVE STRT-AREA-SOC-NO           TO UT9100CA-INST-NO.
175790     MOVE ZEROES                     TO UT9100RA-STATUS.
175800     CALL "UT9100" USING
175810                             UT9100CA-CALL-AREA
175820                             XREF-RECORD-AREA
175830*
175840     EVALUATE UT9100RA-STATUS
175850     WHEN 0
175860        MOVE 4                       TO UT9100CA-CALL-CODE
175870     WHEN 1
175880        MOVE 3                       TO UT9100CA-CALL-CODE
175890     WHEN 2
175900        MOVE 2087                    TO WA-OUTPUT-ERR-MSG-NO
175910        MOVE 01                      TO WA-MSG-ERR-FLAG
175920        GO TO L239-EXIT
175930     WHEN OTHER
175940        MOVE 2087                    TO WA-OUTPUT-ERR-MSG-NO
175950        MOVE 01                      TO WA-MSG-ERR-FLAG
175960        GO TO L239-EXIT
175970     END-EVALUATE.
175980*
175990     MOVE "A"                TO UT9100CA-TYPE.
176000*
176010     MOVE IN0002-REASON-NO   TO UT9100CA-REASON-CODE.
176020*
176030     MOVE SPACES                  TO WS-INTN-REF-NO.
176040     MOVE IN0002-INPUT-ACCT-NO    TO UT0151CA-ACCT-IN.
176050     MOVE 2                       TO UT0151CA-CALL-FUNC.
176060     MOVE 1                       TO UT0151CA-FORMAT.
176070     MOVE SOC-CHK-DGT             TO UT0151CA-CHK-DGT-TYPE.
176080     CALL "UT0151" USING
176090                         UT0151CA-CALL-AREA.
176100     MOVE UT0151CA-ACCT-EX        TO WS-INTN-REF-NO.
176110     MOVE "Y"                     TO WS-INTN-REF-NUM.
176120     MOVE 1                       TO WA-COUNTER.
176130     PERFORM UNTIL WA-COUNTER > 25 OR WS-INTN-REF-NUM = "N"
176140        OR WS-INTN-REF-NO-CHAR(WA-COUNTER) = SPACES
176150           IF WS-INTN-REF-NO-CHAR(WA-COUNTER) NUMERIC
176160              ADD 1                  TO WA-COUNTER
176170           ELSE
176180              MOVE "N"               TO WS-INTN-REF-NUM
176190           END-IF
176200     END-PERFORM.
176210     IF WS-INTN-REF-NUM = "N"
176220        MOVE WS-INTN-REF-NO       TO UT9100CA-INTN-REF-NO
176230     ELSE
176240*** RIGHT-JUSTIFIED
176250        MOVE ZEROES               TO UT9100CA-INTN-REF-NO
176260        COMPUTE WA-LIMIT1 = WA-COUNTER - 1
176270        COMPUTE WA-LIMIT2 = 26 - WA-LIMIT1
176280        MOVE WS-INTN-REF-NO(1:WA-LIMIT1) TO
176290             UT9100CA-INTN-REF-NO(WA-LIMIT2:WA-LIMIT1).
176300*
176310     MOVE STRT-AREA-SOC-NO           TO UT9100CA-INST-NO.
176320     MOVE ZEROES                     TO UT9100RA-STATUS.
176330     CALL "UT9100" USING
176340                             UT9100CA-CALL-AREA
176350                             XREF-RECORD-AREA
176360*
176370     EVALUATE UT9100RA-STATUS
176380     WHEN 0
176390        NEXT SENTENCE
176400     WHEN 1
176410        MOVE 869                     TO WA-OUTPUT-ERR-MSG-NO
176420        MOVE 01                      TO WA-MSG-ERR-FLAG
176430     WHEN 2
176440        MOVE 2087                    TO WA-OUTPUT-ERR-MSG-NO
176450        MOVE 01                      TO WA-MSG-ERR-FLAG
176460     WHEN 7
176470        MOVE 1047                    TO WA-OUTPUT-ERR-MSG-NO
176480        MOVE 01                      TO WA-MSG-ERR-FLAG
176490     WHEN 8
176500        MOVE 766                     TO WA-OUTPUT-ERR-MSG-NO
176510        MOVE 01                      TO WA-MSG-ERR-FLAG
176520     WHEN OTHER
176530        MOVE 2087                    TO WA-OUTPUT-ERR-MSG-NO
176540        MOVE 01                      TO WA-MSG-ERR-FLAG
176550     END-EVALUATE.
176560*
176570 L239-EXIT.
176580     EXIT.
176590*
176600 M030-WRITE-MASTER-RECORD.
176610     MOVE SPACES           TO DBIO-32-SYSTEM
176620                              DBIO-32-KEY
176630                              DBIO-32-RETURN-STATUS.
176640*    MOVE 32               TO ST-DBIO-CALL-CODE.
176650     MOVE 32               TO DBIO-CALL-FUNC.
176660     MOVE "BOR"            TO DBIO-32-SYSTEM.
176670     MOVE STRT-AREA-SOC-NO TO DBIO-32-SOC-NO.
176680     IF WA-INPUT-PARAM-TABLE(29) = 1 AND
176690        WA-INPUT-PARAM-TABLE(30) NOT = 1
176700        MOVE WS-INPUT-KEY TO DBIO-32-ACCT-NO
176710     ELSE
176720        MOVE WA-INPUT-KEY TO DBIO-32-ACCT-NO.
176730     CALL "DBIO" USING
176740                       DBIO-CALL-PARAM
176750                       DBIO-32-SYSTEM
176760                       DBIO-32-KEY
176770                       DBIO-32-RETURN-STATUS
176780                       BORM-RECORD-AREA.
176790     IF  DBIO-32-RETURN-STATUS NOT = "****"
176800         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
176810         MOVE SPACES TO UT8500CA-INPUT-MSG
176820         STRING "BR0000:(M030) MAINTAIN MASTER WRITE ERROR "
176830                 DBIO-32-RETURN-STATUS
176840             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
176850         CALL "UT8500" USING
176860                             UT8500CA-AREA
176870         MOVE 1                  TO WA-MSG-ERR-FLAG
176880         MOVE 155                TO WA-OUTPUT-ERR-MSG-NO
176890         MOVE "BORM"             TO WA-OUTPUT-DATA-SET
176900         MOVE DBIO-32-RETURN-STATUS TO WA-OUTPUT-STATUS.
176910 M039-EXIT.
176920     EXIT.
176930*
176940/
176950 M1100-CAP-TXN-DTLS.
176960     IF SOC-NO-LON-REFRESH
176970        GO TO M1199-EXIT.
TB0226     MOVE 1                  TO MI0095CA-CALL-CODE.
TB0226     MOVE 0                  TO MI0095CA-FUNC.
177000     IF WA-REFRESH-YTD-INT-FLAG = "Y"
TB0226        MOVE "Y"                TO MI0095CA-REFRESH-YTD-INT-FLAG
TB0226        MOVE WA-REFRESH-YTD-INT TO MI0095CA-INT-YTD.
177030*
TB0226     PERFORM M1300-CALL-MI0095 THRU M1399-EXIT.
177050*
TB0226     MOVE 0                  TO MI0095CA-BYPASS-ATM-CHK.
177070     INITIALIZE WA-REFRESH-YTD-INT-FLAG
177080                WA-REFRESH-YTD-INT.
177090 M1199-EXIT.
177100     EXIT.
177110/
177120 M1200-CAP-BAL-DTLS.
177130     IF SOC-NO-LON-REFRESH
177140        GO TO M1299-EXIT.
TB0226     MOVE 1                  TO MI0095CA-CALL-CODE.
TB0226     MOVE 1                  TO MI0095CA-FUNC.
177170     IF WA-REFRESH-YTD-INT-FLAG = "Y"
TB0226        MOVE "Y"                TO MI0095CA-REFRESH-YTD-INT-FLAG
TB0226        MOVE WA-REFRESH-YTD-INT TO MI0095CA-INT-YTD.
177200*
TB0226     PERFORM M1300-CALL-MI0095 THRU M1399-EXIT.
177220*
TB0226     MOVE 0                  TO MI0095CA-BYPASS-ATM-CHK.
177240     INITIALIZE WA-REFRESH-YTD-INT-FLAG
177250                WA-REFRESH-YTD-INT.
177260 M1299-EXIT.
177270     EXIT.
177280/
TB0226 M1300-CALL-MI0095.
177300*
TB0226     MOVE "L" TO MI0095CA-SYSTEM.
TB0226     MOVE STRT-AREA-RECOVERY TO MI0095CA-RECOVERY-FLAG.
TB0226     CALL "MI0095" USING
TB0226                          LS-MI0095CA
177350                          WA-EDIT-MASK
177360                          BORR-PARAMS
177370                          BORM-RECORD-AREA
NR2001*177380                          BORV-RECORD-AREA
NR2001                          BOCT-RECORD-AREA
177390                          LS-RFSH-AREA
177400                          WA-TODAY-BINARY-DATE
177410                          MULTI-OVERRIDE-AREA.
177420 M1399-EXIT.
177430      EXIT.
TB0274**--
       M1350-MOVE-CREATE-LRTP.
           MOVE STRT-AREA-JRNL-NO     TO LRTP-REC-ID.
           MOVE "2000"        TO LRTP-FUNCTION-TYPE.
           MOVE WA-OUTPUT-ERR-MSG-NO      TO LRTP-RETURN-CODE.
           MOVE "1"           TO LRTP-ACCT-TYPE.
           MOVE WA-INPUT-KEY  TO LRTP-ACCT-NO.
           MOVE SPACES        TO LRTP-ID-NO
                                   LRTP-PROJECT-NO.
           MOVE STRT-AREA-POST-DT           TO UT0020-BINARY-DATE.
SC3827*    SUBTRACT SOC-TAIWAN-YEAR-BASE    FROM UT0020-BINARY-DATE
           MOVE 2                           TO UT0020-FUNCTION.
           CALL "UT0020" USING
                                               UT0020-FUNCTION
                                               UT0020-DATE-AREA
                                               UT0020-BINARY-DATE.
           MOVE UT0020-DATE-CCYYMMDD        TO LRTP-ACCT-DATE
                                               LRTP-TXN-DATE.
           MOVE WA-ACCEPT-TIME              To LRTP-TXN-TIME.
           MOVE WA-INPUT-AMT                To LRTP-TXN-AMT.
           IF  WA-INPUT-PARAM-TABLE(4) = 1
                MOVE "C"                    TO LRTP-DR-CR-IND
           ELSE
                MOVE "D"                    TO LRTP-DR-CR-IND
           END-iF.
           IF WA-INPUT-PARAM-TABLE(7) = 1
                MOVE "*"                    To LRTP-EC-FLAG
           ELSE
                MOVE SPACES                 TO LRTP-EC-FLAG
           END-IF.
           MOVE "WRITE"           TO DBIOMOD-FUNCTION.
           PERFORM M1360-ACCESS-LRTP  THRU M1369-EXIT.
       M1359-EXIT.
             EXIT.
       M1360-ACCESS-LRTP.
           MOVE SPACES            TO   DBIOMOD-STAT.
           MOVE "LRTP"            TO   DBIOMOD-FILE
                                       DBIOMOD-SUFFIX.
           MOVE LRTP-KEY          TO   DBIOMOD-KEY.
           MOVE "DBIO"            TO   DBIOMOD-PREFIX.
           MOVE ZEROES            TO   DBIOMOD-KEY-NO.
           MOVE SPACES            TO   DBIOMOD-STATUS
                                       DBIOMOD-RELEASE-LOCK
                                       DBIOMOD-ACCESS-COMMAND
                                       DBIOMOD-ACCESS-COND.
           CALL DBIOMODNAME    USING
                                   DBIOMOD-FILE
                                   DBIOMOD-KEY
                                   LRTP-RECORD-AREA
                                   DBIOMOD-FUNCTION
                                   DBIOMOD-KEY-NO
                                   DBIOMOD-RELEASE-LOCK
                                   DBIOMOD-ACCESS-COMMAND
                                   DBIOMOD-ACCESS-COND
                                   DBIOMOD-STATUS.
SC7637     IF  DBIOMOD-STAT NOT = "****" AND "DUPM"
               MOVE 1                TO WA-MSG-ERR-FLAG
               MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
               MOVE 'LRTP'           TO WA-OUTPUT-DATA-SET
               MOVE DBIOMOD-STAT     TO WA-OUTPUT-STATUS
               MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
               MOVE SPACES TO UT8500CA-INPUT-MSG
               STRING "IN0000:(M1360) LRTP ACCESS ERROR"
                      ", STAT="  DBIOMOD-STAT
                      ", KEY="   DBIOMOD-KEY
                      ", FUNC="  DBIOMOD-FUNCTION
                      DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
               CALL   "UT8500" USING UT8500CA-AREA
           END-IF.      
       M1369-EXIT.
           EXIT.      
TB0274**--
TB0027*
TB0027 N1600-SEND-WARNING-MSG.
TB0027     MOVE 2                 TO UT9000-CALL-CODE.
TB0027     MOVE SPACES            TO UT9000-CALL-STATUS.
TB0027     MOVE STRT-AREA-SOC-NO  TO UT9000-INST-NO.
TB0027     MOVE "ERM"             TO UT9000-CALLING-ID.
TB0027     MOVE SOC-LANGUAGE-CODE TO UT9000-LANGUAGE-CODE.
TB0027     MOVE 1                 TO UT9000-SEQUENCE-NO.
TB0027     PERFORM U9100-RETRIEVE-TEXT  
TB0027                            THRU  U9199-EXIT.
TB0027     IF UT9000-CALL-STATUS  NOT = "0"
TB0027        MOVE SPACES         TO WA-OUTPUT-WARNING-MSG-TEXT
TB0027     ELSE
TB0027        MOVE UT9000RA-LINE1 TO WA-OUTPUT-WARNING-MSG-TEXT
TB0027     END-IF.
TB0027     MOVE    998            TO WA-OUTPUT-ERR-MSG-NO.
TB0027     MOVE    50             TO WA-OUTPUT-MSG-LENGTH.
TB0107     MOVE    08             TO WA-INPUT-MSG-TYPE.
TB0027     CALL    "FT0000"       USING
TB0027                                  STARTAREA.
TB0027 N1699-EXIT.
TB0027      EXIT.
TB0095
TB0095 J100-UPDATE-BOIS.
S20780      IF BORP-ACCT-TYPE-1-2 = "71" AND
S20780         BOIS-NEGO-RATE-IND = "3"   AND
S20780         BOIS-REPAY-PEN-METH = "0"  AND
S20780         BOIS-CLOSE-PEN-METH = "0"
S20780         GO   TO                       J199-EXIT
S20780      END-IF.
SC4645      IF BOIS-PEN-TERM (1)             =    ZEROS
S16665       IF  BORP-REPAY-PEN-METH     NOT =    '0'
S16665        IF BORP-PEN-TERM(1)        NOT =    0
SC4645         MOVE BORP-PEN-TERM(1)         TO   WA-REM-TERM
SC4645         PERFORM J200-VALIDATE-DATE    THRU J200-EXIT
SC4645         IF  WA-MSG-ERR-FLAG           =    0
SC4645             MOVE UT0312CA-MATURITY-DT TO   BOIS-PEN-TERM (1)
SC4645         ELSE
SC4645             GO   TO                   J199-EXIT
SC4645         END-IF
S16665        END-IF
S16665        IF BORP-PEN-TERM(2)        NOT =    0
SC4645         MOVE BORP-PEN-TERM(2)         TO   WA-REM-TERM
SC4645         PERFORM J200-VALIDATE-DATE    THRU J200-EXIT
SC4645         IF  WA-MSG-ERR-FLAG           =    0
SC4645             MOVE UT0312CA-MATURITY-DT TO   BOIS-PEN-TERM (2)
SC4645         ELSE
SC4645             GO   TO                   J199-EXIT
SC4645         END-IF
S16665        END-IF
S16665       END-IF
SC4645      END-IF.
SC4645      IF BOIS-CLOSE-PEN-TERM (1)       =    ZEROS
S16665       IF  BORP-CLOSE-PEN-METH     NOT =    '0'
S16665        IF BORP-CLOSE-PEN-TERM(1)  NOT =    0
SC4645         MOVE BORP-CLOSE-PEN-TERM(1)   TO   WA-REM-TERM
SC4645         PERFORM J200-VALIDATE-DATE    THRU J200-EXIT
SC4645         IF  WA-MSG-ERR-FLAG           =    0
SC4645             MOVE UT0312CA-MATURITY-DT TO BOIS-CLOSE-PEN-TERM(1)
SC4645         ELSE
SC4645             GO   TO                   J199-EXIT
SC4645         END-IF
S16665        END-IF
S16665        IF BORP-CLOSE-PEN-TERM(2)  NOT =    0
SC4645         MOVE BORP-CLOSE-PEN-TERM(2)   TO   WA-REM-TERM
SC4645         PERFORM J200-VALIDATE-DATE    THRU J200-EXIT
SC4645         IF  WA-MSG-ERR-FLAG           =    0
SC4645             MOVE UT0312CA-MATURITY-DT TO BOIS-CLOSE-PEN-TERM(2)
SC4645         ELSE
SC4645             GO   TO                   J199-EXIT
SC4645         END-IF
S16665        END-IF
S17067        IF BORP-CLOSE-PEN-TERM3    NOT =    0
S17067         MOVE BORP-CLOSE-PEN-TERM3     TO   WA-REM-TERM
S17067         PERFORM J200-VALIDATE-DATE    THRU J200-EXIT
S17067         IF  WA-MSG-ERR-FLAG           =    0
S17067             MOVE UT0312CA-MATURITY-DT TO BOIS-CLOSE-PEN-TERM3
S17067         ELSE
S17067             GO   TO                   J199-EXIT
S17067         END-IF
S17067        END-IF
S16665       END-IF
SC4645      END-IF.
SC4645** -- COMMENT OUT FOLLOWING ROUTINES -- **
TB0095*     MOVE UT1999CA-CCYYMMDD  TO UT0030-DATE-CCYYMMDD.
TB0095*     ADD  BORP-PEN-TERM(01)  TO UT0030-DATE-MM2.
TB0095*     PERFORM J200-VALIDATE-DATE THRU J200-EXIT.
TB0095*     MOVE UT0030-BINARY-DATE TO BOIS-PEN-TERM(01).
TB0095*-----------------------------
TB0095*     MOVE UT1999CA-CCYYMMDD  TO UT0030-DATE-CCYYMMDD.
TB0095*     ADD  BORP-PEN-TERM(02)  TO UT0030-DATE-MM2.
TB0095*     PERFORM J200-VALIDATE-DATE THRU J200-EXIT.
TB0095*     MOVE UT0030-BINARY-DATE TO BOIS-PEN-TERM(02).
TB0095*-----------------------------
TB0095*     MOVE UT1999CA-CCYYMMDD  TO UT0030-DATE-CCYYMMDD.
TB0095*     PERFORM J200-VALIDATE-DATE THRU J200-EXIT.
TB0095*     MOVE UT0030-BINARY-DATE TO BOIS-REPAY-START-ACCU-DATE.
TB0095*-----------------------------
TB0095*     MOVE UT1999CA-CCYYMMDD  TO UT0030-DATE-CCYYMMDD.
TB0095*     ADD  BORP-CLOSE-PEN-TERM(01) TO UT0030-DATE-MM2.
TB0095*     PERFORM J200-VALIDATE-DATE THRU J200-EXIT.
TB0095*     MOVE UT0030-BINARY-DATE TO BOIS-CLOSE-PEN-TERM(01).
TB0095*-----------------------------
TB0095*     MOVE UT1999CA-CCYYMMDD  TO UT0030-DATE-CCYYMMDD.
TB0095*     ADD  BORP-CLOSE-PEN-TERM(02) TO UT0030-DATE-MM2.
TB0095*     PERFORM J200-VALIDATE-DATE THRU J200-EXIT.
TB0095*     MOVE UT0030-BINARY-DATE TO BOIS-CLOSE-PEN-TERM(02).
TB0095 J199-EXIT.
TB0095      EXIT.
TB0095*
TB0095 J200-VALIDATE-DATE.
SC4645     INITIALIZE UT0312CA-CALL-PARAMETER.
SC4645     MOVE 16                      TO  UT0312CA-CALL-CODE.
SC4645
SC4645     IF WA-INPUT-PARAM-TABLE (8) NOT = 1
SC4645        MOVE STRT-AREA-POST-DT    TO  UT0312CA-DUE-STRT-DT
SC4645     ELSE
SC4645*SC4799 MOVE WA-ADV-TXN-DATE      TO  UT0312CA-DUE-STRT-DT
SC4799** WA-ADV-TXN-DATE is formatted as DDMMYYYYY             
SC4799** Reformat it to make it binary.                        
SC4799        MOVE WA-ADV-TXN-DATE      TO UT0030-DATE-DDMMCCYY
SC4799        CALL "UT0030" USING  UT0030-FUNCTION             
SC4799                             UT0030-DATE-AREA            
SC4799                             UT0030-BINARY-DATE          
SC4799        MOVE UT0030-BINARY-DATE TO UT0312CA-DUE-STRT-DT  
SC4645     END-IF.
SC4645
SC4645     MOVE UT0312CA-DUE-STRT-DT    TO  UT0312CA-EFF-DATE.
SC4645     MOVE WA-REM-TERM             TO  UT0312CA-LOAN-TERM.
SC4645     CALL "UT0312"  USING UT0312CA-CALL-AREA.
SC4645     IF   UT0312CA-RET-STATUS NOT = ZEROES
SC4645          MOVE 1                  TO WA-MSG-ERR-FLAG
SC4645          MOVE 3026               TO WA-OUTPUT-ERR-MSG-NO
SC4645          GO   TO                 J200-EXIT
SC4645     END-IF.
SC4645** -- COMMENT OUT FOLLOWING ROUTINES -- **
TB0095*     IF UT0030-DATE-MM2 > 12
TB0095*        ADD 1                TO UT0030-DATE-CCYY2
TB0095*        SUBTRACT 12        FROM UT0030-DATE-MM2.
TB0095*     MOVE  2                 TO UT0030-FUNCTION.
TB0095*     CALL "UT0030" USING  UT0030-FUNCTION
TB0095*                          UT0030-DATE-AREA
TB0095*                          UT0030-BINARY-DATE.
TB0095*     IF UT0030-BINARY-DATE = 0
TB0095*        MOVE 1               TO UT0030-DATE-DD2
TB0095*        ADD  1               TO UT0030-DATE-MM2
TB0095*        GO TO J200-VALIDATE-DATE.
TB0095 J200-EXIT.
TB0095      EXIT.
TB0095*
TB0082**--
       H200-POST-TO-GL-ACCT.
      *=====================
           IF WA-INPUT-PARAM-TABLE(10) = 0 AND
              WA-INPUT-PARAM-TABLE(5) = 1
              IF WA-ADV-AMOUNT < WA-ZERO
                 MULTIPLY WA-ADV-AMOUNT BY -1
                   GIVING WA-ADVANCE-AMOUNT
              ELSE
                 MOVE WA-ADV-AMOUNT TO WA-ADVANCE-AMOUNT
              END-IF
              MOVE WA-ADV-AMOUNT    TO WA-GL-AMOUNT
           END-IF.
      *
           MOVE WA-SAVE-FROM-BRANCH     TO WA-SUSP-BRANCH.
      *
           IF STRT-AREA-TRN-NO = 11057 OR 11157 OR 16057 OR 16157
S11455                        OR 11069 OR 11169 OR 16069 OR 16169
SC4522     OR (FEDI-FROM-TO-GL AND (STRT-AREA-TRN-NO = 11055 OR 11155))
SC7091     OR (FEDI-FROM-TO-GL AND (STRT-AREA-TRN-NO = 16055 OR 16155))
S16788         MOVE SPACES     TO  WA-GL-NAME-1   WA-GL-NAME-2
S16788         MOVE SPACES     TO  WA-GL-IN-ACCTNO-CHQNO-X
S10445         IF NOT (STRT-AREA-TRN-NO =  11057 OR 11157 OR
S11455                                     11069 OR 11169 OR
S11455                                     16069 OR 16169 OR
S10445                                     16057 OR 16157)
                  MOVE SPACES            TO WA-GL-NAME-1
                  MOVE WA-INPUT-ACCT-NO  TO WA-FORMAT-LOAN-ACCT-NO
SC4690                                      WA-SAVE-LOAN-ACCT-NO
                  STRING "AVAILMENT FROM "  WA-FORMAT-LOAN-ACCT-NO
                         DELIMITED BY SIZE INTO WA-GL-NAME-1
S10445         END-IF
S11219         IF STRT-AREA-TRN-NO =  11057 OR 11157 OR 16057 OR 16157
S11455                             OR 11069 OR 11169 OR 16069 OR 16169
S11219            MOVE WA-INPUT-ACCT-NO  TO WA-SAVE-LOAN-ACCT-NO      
S11219         END-IF                                                 
               MOVE WA-DEP-ACCT-NO    TO SUSP-ACCT-NO
           END-IF.
      *
           IF WA-MSG-ERR-FLAG = 0
              MOVE ZEROES TO WA-BANK-NUMBER
              MOVE ZEROES TO WA-REGION-ID
           ELSE
              GO TO H200-EXIT
           END-IF.
      *
           IF STRT-AREA-TRN-NO = 11057 OR 11157 OR 16057 OR 16157
S11455                        OR 11069 OR 11169 OR 16069 OR 16169
SC4522     OR (FEDI-FROM-TO-GL AND (STRT-AREA-TRN-NO = 11055 OR 11155))
SC7091     OR (FEDI-FROM-TO-GL AND (STRT-AREA-TRN-NO = 16055 OR 16155))
              MOVE SUSP-ACCT-NO TO DBIO-01-ACCT-NO
                                   WA-GL-ACCT-NO
                                   WA-NARR-TRF-ACCT
              PERFORM V700-READ-GLDM-RECORD
                 THRU V799-EXIT
SC2302        SET WA-POST-TO-GL          TO TRUE
SC2302        MOVE GLDM-BRANCH           TO WA-GLDM-BRANCH
           END-IF.
      *
           IF WA-MSG-ERR-FLAG = 1
              GO TO H200-EXIT
           ELSE
              MOVE 2                     TO UT0120CA-CALL-CODE
              MOVE STRT-AREA-SOC-NO      TO UT0120CA-CALL-INST
              MOVE GLDM-PRODUCT-TYPE     TO UT0120CA-CALL-PRODUCT-TYPE
              MOVE GLDM-PRODUCT-CATEGORY TO UT0120CA-CALL-PRODUCT-CAT
              MOVE 0                     TO UT0120CA-CALL-STATUS
              CALL "UT0120" USING
                            UT0120CA-CALL-AREA
              IF UT0120CA-CALL-STATUS NOT = 0
                 MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
                 MOVE SPACES TO UT8500CA-INPUT-MSG
                 STRING "BR0000(M300): ERROR IN GLPPARAM READ "
                        UT0120CA-CALL-STATUS " KEY :" UT0120CA-CALL-KEY
                        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
                 CALL "UT8500" USING
                               UT8500CA-AREA
                 MOVE 1092 TO WA-OUTPUT-ERR-MSG-NO
                 MOVE 1    TO WA-MSG-ERR-FLAG
                 GO        TO H200-EXIT
              END-IF
           END-IF.
S10535**CHECK GLDM STATUS                         
S10535     IF GLDM-STATUS NOT = 01                
S10535        IF GLDM-STATUS = 99                 
S10535            MOVE 110 TO WA-OUTPUT-ERR-MSG-NO
S10535        ELSE                                
S10535            MOVE 114 TO WA-OUTPUT-ERR-MSG-NO
S10535        END-IF                              
S10535        MOVE 1    TO WA-MSG-ERR-FLAG        
S10535        GO        TO H200-EXIT              
S10535     END-IF.                                
SC4624     IF STRT-AREA-TRN-NO = 11057 OR 11157
S10445                        OR 16057 OR 16157
S11455                        OR 11069 OR 11169
S11455                        OR 16069 OR 16169
SC4624        MOVE "BOR"            TO WA-NARR-TRF-ACCT-SYS
SC4624        MOVE WA-INPUT-ACCT-NO TO WA-NARR-TRF-ACCT.
           IF STRT-AREA-TRN-NO = 16057 OR 16157
S11455                        OR 16069 OR 16169
              MOVE WA-ADV-TXN-DATE TO WA-GL-TXN-DATE
           END-IF.
      *
           IF WA-INPUT-PARAM-TABLE(7) = 1
SC2302*       MOVE 20130 TO STRT-AREA-TRN-NO
SC2302        MOVE 20145 TO STRT-AREA-TRN-NO
                            LINK-IN-TXCODE
                            WA-DUMMY-TRN-NO
           ELSE
SC2302*       MOVE 20030 TO STRT-AREA-TRN-NO
SC2302        MOVE 20045 TO STRT-AREA-TRN-NO
                            LINK-IN-TXCODE
                            WA-DUMMY-TRN-NO
           END-IF.
           IF WA-INPUT-PARAM-TABLE(8) = 1
              IF WA-INPUT-PARAM-TABLE(7) = 1
SC2302*          MOVE 25130 TO STRT-AREA-TRN-NO
SC2302           MOVE 25145 TO STRT-AREA-TRN-NO
                               LINK-IN-TXCODE
                               WA-DUMMY-TRN-NO
              ELSE
SC2302*          MOVE 25030 TO STRT-AREA-TRN-NO
SC2302           MOVE 25045 TO STRT-AREA-TRN-NO
                               LINK-IN-TXCODE
                               WA-DUMMY-TRN-NO
              END-IF
           END-IF.
           MOVE WA-ADV-AMOUNT TO WA-SAVE-STAMPED-AMT
           MOVE 00            TO WA-GL-NON-VALUE-DAYS
           MOVE 00            TO WA-GL-DEFER-DAYS
           MOVE 00            TO WA-GL-DEBIT-DEFER-DAYS
           PERFORM X700-CALL-UT0250
              THRU X799-EXIT.
           IF WA-MSG-ERR-FLAG = 1
               GO TO H200-EXIT
           END-IF.
           MOVE LINK-EDIT-TABLE     TO STRT-AREA-EDIT-MASK
                                       JNRST-EDIT-MASK.
           MOVE 3                   TO GL-TRANS-IND.
SC7989     MOVE "0"                 TO GL-DONT-WRITE-GLDM-IND.
           MOVE WA-SAVE-STAMPED-AMT TO WA-GL-AMOUNT.
           MOVE 1                   TO WA-GL-CHQ-TYPE.
           IF WA-INPUT-PARAM-TABLE (7) = 1
               MOVE WA-TRE-ACNO     TO WA-GL-CORR-JRNL-NO
           ELSE
               MOVE 0               TO WA-GL-CORR-JRNL-NO
           END-IF.
S16945     IF  STRT-MORTGAGE-TXN
S16945         AND  STRT-AREA-TRN-NO = 20045
S16945         MOVE WA-INPUT-MSG    TO WA-SAV-INPUT-MSG
S16945     END-IF.
SC7323     MOVE NARRATIVE-11045     TO WA-NARR-TEXT
           MOVE WA-GL-TXN-AREA      TO WA-INPUT-MSG.
           CALL "GL0023" USING
                         STARTAREA
                         GL-PASSALONG
                         MULTI-OVERRIDE-AREA
                         W300-ERROR-AREA
                         CHECK-RESPONSE-AREA
TB0137                   UTVTACCA-CALL-PARAM.
           IF ST-STATUS-LEVEL-1 NOT = 0
               MOVE 1 TO WA-MSG-ERR-FLAG
           END-IF.
S16945     IF  STRT-MORTGAGE-TXN
S16945         AND  STRT-AREA-TRN-NO = 20045
S16945         MOVE WA-SAV-INPUT-MSG           TO  WA-INPUT-MSG
S16945     END-IF.
       H200-EXIT.
      *----------
          EXIT.
       GET-PREV-DUE-DATE.
      *==================
           INITIALIZE UT0312CA-CALL-PARAMETER
           MOVE 05                     TO UT0312CA-CALL-CODE.
           MOVE STRT-AREA-POST-DT      TO UT0312CA-EFF-DATE.
           IF BORM-DUE-STRT-DATE = 0
               MOVE STRT-AREA-POST-DT  TO UT0312CA-DUE-STRT-DT
           ELSE
               MOVE BORM-DUE-STRT-DATE TO UT0312CA-DUE-STRT-DT
           END-IF.
           MOVE BORM-REPAY-FREQ        TO UT0312CA-REPAY-FREQ.
           IF BORM-REPAY-SCHED = SPACE
              MOVE BORP-REPAY-SCHED    TO UT0312CA-REPAY-SCHED
           ELSE
              MOVE BORM-REPAY-SCHED    TO UT0312CA-REPAY-SCHED
           END-IF.
           MOVE BORM-CAPN-METHOD       TO UT0312CA-CAPN-METHOD.
           MOVE BORP-ACCRUE-METHOD     TO UT0312CA-ACCRUE-METHOD.
           MOVE BORM-LOAN-TRM          TO UT0312CA-LOAN-TERM.
           MOVE BORM-TERM-BASIS        TO UT0312CA-TERM-BASIS.
           MOVE BORM-REPAY-DAY         TO UT0312CA-REPAY-DAY.
           SET UT0312CA-HOLIDAY-DUE-PREV-WD TO TRUE.
           MOVE BORM-KEY              TO UT0312CA-ACCT-KEY.
           MOVE BORP-INT-DAYS-YR      TO UT0312CA-INT-NO-DAYS-YR
DUEIND     MOVE BOIS-DUE-DTE-IND      TO UT0312CA-1ST-DUE-DTE-IND
           CALL "UT0312" USING
                         UT0312CA-CALL-AREA.
           IF UT0312CA-RET-STATUS <> ZERO
              MOVE  1                  TO WA-MSG-ERR-FLAG
              MOVE 3026                TO WA-OUTPUT-ERR-MSG-NO
              MOVE UT0312CA-RET-STATUS TO WA-OUTPUT-STATUS
              MOVE UT8500CA-FUNC-NORMAL-DISPLAY
                                       TO UT8500CA-CALL-CODE
              MOVE SPACES              TO UT8500CA-INPUT-MSG
              STRING "BR0000:(GP1000) ERROR CALLING UT0312"
                     ", STATUS="  UT0312CA-RET-STATUS
                     DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
              CALL "UT8500"  USING
                             UT8500CA-AREA
              GO TO GET-PREV-DUE-DATE-EXIT
           END-IF.
           IF WA-MSG-ERR-FLAG = 1
              GO TO GET-PREV-DUE-DATE-EXIT
           ELSE
              MOVE UT0312CA-PREV-DUE-DT TO WA-PREV-DUE-DATE
           END-IF.
       GET-PREV-DUE-DATE-EXIT.
      *-----------------------
           EXIT.
NR2001*       FIND-MATCH-BORV.
NR2001*      *================
NR2001*
NR2001*           MOVE 0                  TO DBIO-CALL-REFER-AREA.
NR2001*NR0050     MOVE SPACES             TO DBIO-CALL-SAVE-REFER.
NR2001*           MOVE 01                 TO DBIO-CALL-TXN-TYPE.
NR2001*           MOVE "BOR"              TO DBIO-CALL-SYS-AREA.
NR2001*           MOVE STRT-AREA-SOC-NO   TO WA-BORM-SOC-NO.
NR2001*           MOVE BORM-MEMB-CUST-AC  TO WA-BORM-ACCT-NO.
NR2001*           MOVE WA-BORM-KEY        TO DBIO-CALL-KEY-AREA.
NR2001*           MOVE 07                 TO DBIO-CALL-FUNC.
NR2001*           MOVE "N"                TO WA-FOUND-SW
NR2001*                                      WA-END-OF-SEARCH-SW.
NR2001*
NR2001*           PERFORM DBIO-READ-BORV
NR2001*              THRU DBIO-READ-BORV-EXIT
NR2001*             UNTIL WA-88-END-OF-SEARCH.
NR2001*
NR2001*       FIND-MATCH-BORV-EXIT.
NR2001*      *---------------------
NR2001*           EXIT.
NR2001 FIND-MATCH-BOCT.
NR2001*================
NR2001
NR2001     INITIALIZE UTBOCTCA-CALL-AREA.
NR2001     MOVE STRT-AREA-SOC-NO  TO BOCT-INST-NO.
NR2001     MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO.
NR2001     MOVE 0                 TO BOCT-REC-NO.
NR2003*NR2001     MOVE 999999999         TO BOCT-TRN-DATE.
NR2003     MOVE STRT-AREA-POST-DT TO BOCT-TRN-DATE.
NR2001     MOVE 1                 TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT TO TRUE.
NR2001     MOVE 01                TO WS-BOCT-TRAN-TYPE.
NR2001     MOVE "N"                TO WA-FOUND-SW
NR2001                                WA-END-OF-SEARCH-SW.
NR2001
NR2001     PERFORM DBIO-READ-BOCT
NR2001        THRU DBIO-READ-BOCT-EXIT
NR2001       UNTIL WA-88-END-OF-SEARCH.
NR2001
NR2001 FIND-MATCH-BOCT-EXIT.
NR2001*---------------------
NR2001     EXIT.
NR2001*       DBIO-READ-BORV.
NR2001*      *===============
NR2001*
NR2001*           MOVE SPACES              TO DBIO-CALL-STATUS.
NR2001*           CALL "DBIO"   USING         DBIO-CALL-PARAM
NR2001*                                       DBIO-CALL-SYS-AREA
NR2001*                                       DBIO-CALL-KEY-AREA
NR2001*                                       DBIO-CALL-STATUS
NR2001*                                       BORV-RECORD-AREA
NR2001*                                       DBIO-CALL-REFER-AREA
NR2001*                                       DBIO-CALL-TXN-TYPE-AREA.
NR2001*           IF DBIO-CALL-STATUS NOT = "****"
NR2001*              IF DBIO-CALL-STATUS  =  "XCOT"
NR2001*                 MOVE  "Y"  TO  WA-END-OF-SEARCH-SW
NR2001*              ELSE
NR2001*                 MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*                 MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*                 STRING "BR0000:(W110) PROBLEM WHILE READING BORV "
NR2001*                         WA-INPUT-KEY
NR2001*                     DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*                 CALL "UT8500" USING
NR2001*                                  UT8500CA-AREA
NR2001*                 MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001*                 MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001*                 STRING DBIO-CALL-STATUS
NR2001*                     DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001*                 CALL "UT8500" USING
NR2001*                                  UT8500CA-AREA
NR2001*              END-IF
NR2001*           ELSE
NR2001*              IF BORV-01-TRN-CODE  =  16057 OR 16055
NR2001*S11455                             OR 16068 OR 16069
NR2001*              IF NOT (((BORV-01-STATUS > 19) AND (BORV-01-STATUS < 40))
NR2001*                  OR ((BORV-01-STATUS > 69) AND (BORV-01-STATUS < 90)))
NR2001*                 MOVE "Y"  TO  WA-13500-FOUND-SW
NR2001*                 MOVE "Y"  TO  WA-END-OF-SEARCH-SW
NR2001*                 MOVE BORV-01-TRN-DATE TO BORM-ADV-DATE
NR2001*              END-IF
NR2001*              END-IF
NR2001*           END-IF.
NR2001*
NR2001*       DBIO-READ-BORV-EXIT.
NR2001*      *--------------------
NR2001*           EXIT.
NR2001 DBIO-READ-BOCT.
NR2001*===============
NR2001
NR2001     MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO.
NR2001     MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO.
NR2001     MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO.
NR2001     MOVE BOCT-TRN-DATE       TO UTBOCTCA-CALL-DATE.
NR2001     MOVE 1                   TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT   TO TRUE.
NR2001     CALL "UTBOCT"         USING UTBOCTCA-CALL-AREA
NR2001                                 BOCT-RECORD-AREA.
NR2001     IF NOT UTBOCTCA-OK
NR2001        IF UTBOCTCA-EOF
NR2001           MOVE  "Y"  TO  WA-END-OF-SEARCH-SW
NR2001        ELSE
NR2001           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001           MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001           STRING "BR0000:(DBIO-READ-BOCT)PROBLEM IN READING BOCT"
NR2001                  ", CALLCODE=" UTBOCTCA-CALL-CODE
NR2001                  ", STATUS="   UTBOCTCA-STATUS
NR2001                  ", CALLKEY="  UTBOCTCA-CALL-KEY
NR2001               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001           CALL "UT8500" USING
NR2001                            UT8500CA-AREA
NR2001           MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
NR2001           MOVE SPACES TO UT8500CA-INPUT-MSG
NR2001           STRING DBIO-CALL-STATUS
NR2001               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
NR2001           CALL "UT8500" USING
NR2001                            UT8500CA-AREA
NR2001           MOVE  "Y"  TO  WA-END-OF-SEARCH-SW
NR2001        END-IF
NR2001     ELSE
S15787*NR2003        IF BOCT-TRN-DATE < WA-STORE-TXN-DT
S15787*NR2003           MOVE "Y"  TO  WA-END-OF-SEARCH-SW
S15787*NR2003           GO TO DBIO-READ-BOCT-EXIT
S15787*NR2003        END-IF
NR2001        IF BOCT-TRAN-TYPE NOT = WS-BOCT-TRAN-TYPE
NR2001           GO TO DBIO-READ-BOCT          
NR2001        END-IF
NR2001        IF BOCT-TRN-CODE     =  16057 OR 16055
NR2001                             OR 16068 OR 16069
S12770                             OR 16063
S15787                             OR 11057 OR 11055 OR 11068
S15787                             OR 11069 OR 11063 OR 11060
NR2001        IF NOT (((BOCT-STAT > 19) AND (BOCT-STAT < 40))
NR2001            OR ((BOCT-STAT > 69) AND (BOCT-STAT < 90)))                  
NR2001           MOVE "Y"  TO  WA-13500-FOUND-SW
NR2001           MOVE "Y"  TO  WA-END-OF-SEARCH-SW
NR2001           MOVE BOCT-TRN-DATE TO BORM-ADV-DATE
NR2001        END-IF
NR2001        END-IF
NR2001     END-IF.
NR2001
NR2001 DBIO-READ-BOCT-EXIT.
NR2001*--------------------
NR2001     EXIT.           
TB0082**--
TB0102/
TB0102 DISCHARGE-JR01.
NR2001*TB0102     PERFORM DBIO-READ-BORV
NR2001*TB0102        THRU DBIO-READ-BORV-EXIT.
NR2001     PERFORM DBIO-READ-BOCT
NR2001        THRU DBIO-READ-BOCT-EXIT.
TB0102
NR2001*TB0102     IF DBIO-CALL-STATUS NOT = "****"
NR2001     IF NOT UTBOCTCA-OK
TB0102        MOVE "Y"         TO WA-TRAN-NO-MORE-FLAG
TB0102        GO TO DISCHARGE-JR01-EXIT
TB0102     END-IF.
TB0102
NR2003*TB0223 IF STRT-AREA-TRN-NO = 17467
NR2003*TB0223    MOVE STRT-AREA-POST-DT      TO UT0030-DATE-DDMMCCYY
NR2003*TB0223 ELSE
NR2003*TB0102    MOVE WA-DISCH-I-TRAN-DATE   TO UT0030-DATE-DDMMCCYY
NR2003*S12777    IF ( WA-INPUT-PARAM-TABLE(4) = 1
NR2003*S12777    OR   WA-INPUT-PARAM-TABLE(5) = 1 )
NR2003*S12777    AND  WA-INPUT-PARAM-TABLE(25) = 0
NR2003*S12777         MOVE WA-REPAY-TXN-DATE TO UT0030-DATE-DDMMCCYY
NR2003*S12777    END-IF
NR2003*TB0223 END-IF.
TB0223
NR2003*TB0102     CALL "UT0030" USING  UT0030-FUNCTION
NR2003*TB0102                                  UT0030-DATE-AREA
NR2003*TB0102                                  UT0030-BINARY-DATE.
TB0223*    MOVE UT0030-BINARY-DATE TO WA-DISCH-I-TRAN-DATE.
NR2003*TB0223     MOVE UT0030-BINARY-DATE TO WA-JR01-TRAN-DATE.
TB0102
NR2003     IF STRT-AREA-TRN-NO = 17467
NR2003        MOVE STRT-AREA-POST-DT      TO WA-JR01-TRAN-DATE
NR2003     ELSE
NR2003        MOVE WA-DISCH-I-TRAN-DATE   TO UT0030-DATE-DDMMCCYY
NR2003        IF ( WA-INPUT-PARAM-TABLE(4) = 1
NR2003        OR   WA-INPUT-PARAM-TABLE(5) = 1 )
NR2003        AND  WA-INPUT-PARAM-TABLE(25) = 0
NR2003             MOVE WA-REPAY-TXN-DATE TO UT0030-DATE-DDMMCCYY
NR2003        END-IF
NR2003
NR2003        CALL "UT0030" USING  UT0030-FUNCTION
NR2003                                     UT0030-DATE-AREA
NR2003                                     UT0030-BINARY-DATE
NR2003        MOVE UT0030-BINARY-DATE     TO WA-JR01-TRAN-DATE
NR2003     END-IF.
TB0223*    IF BORV-01-TRN-DATE  < WA-DISCH-I-TRAN-DATE
NR2001*TB0223     IF BORV-01-TRN-DATE  < WA-JR01-TRAN-DATE
NR2001     IF BOCT-TRN-DATE  < WA-JR01-TRAN-DATE
TB0102        MOVE "Y"                       TO WA-TRAN-NO-MORE-FLAG
TB0102        GO TO DISCHARGE-JR01-EXIT
TB0102     END-IF.
TB0102
NR2001*TB0102     IF BORV-01-JRNL-NO NOT = STRT-AREA-JRNL-NO
NR2001     IF BOCT-JRNL-NO NOT = STRT-AREA-JRNL-NO
TB0102        GO TO DISCHARGE-JR01-EXIT
TB0102     END-IF.
TB0102
S11177     IF STRT-AREA-TRN-NO = 17467  
NR2001*S11177      AND BORV-01-TRN-CODE = 13509
NR2001      AND BOCT-TRN-CODE = 13509
S11177        GO TO DISCHARGE-JR01-EXIT
S11177     END-IF.                      
S11177                                  
NR2001*TB0102     IF BORV-01-TRN-CODE = STRT-AREA-TRN-NO
NR2001*SC4881      OR (BORV-01-TRN-CODE = 13048 OR 13049 OR 13148 OR 13149) 
NR2001     IF BOCT-TRN-CODE = STRT-AREA-TRN-NO
NR2001      OR (BOCT-TRN-CODE = 13048 OR 13049 OR 13148 OR 13149)
TB0102        GO TO DISCHARGE-JR01-EXIT
TB0102     END-IF.
TB0102
SC6271     IF (STRT-AREA-TRN-NO = 16010 OR 16045 OR 16046
SC8399                        OR 16044 OR 16048 OR 16144 OR 16148
S10982                        OR 16120 OR 16049 OR 16149
S10542                        OR 16111 OR 16130
S11617                        OR 16129
S17282                        OR 16102
S12394                        OR 16101
S18530                        OR 16020
S12668                        OR 16030
S15700                        OR 19011 OR 19030 OR 19045
SC6271                        OR 16110 OR 16145 OR 16146)
NR2001*SC6271      AND (BORV-01-TRN-CODE NOT = 18403            
NR2001      AND (BOCT-TRN-CODE    NOT = 18403            
SC6271                              AND 18503)           
SC6271        GO TO DISCHARGE-JR01-EXIT                  
SC6271     END-IF                                        
SC4881**                                                              
SC4881     IF (BR0025CA-AGR-INT NOT = 0                               
SC4881      OR BR0025CA-AGR-ARR > 0)                                  
SC4881      AND (WA-DUMMY-TRN-NO = 13010 OR 13110 OR 13045 OR 13145   
SC4881           OR 13046 OR 13146 OR 15009 OR 15109 OR 15045 OR 15145
S18413           OR 14028 OR 19028 OR 14041 OR 19041
S16235*SC4881           OR 15046 OR 15146)
S16235           OR 15046 OR 15146 OR 13047 OR 13147 OR 15047 OR 15147)
SC4881                                                                
NR2001*SC4881        MOVE BORV-01-TRN-CODE TO WA-BUCKET-TRAN                 
NR2001        MOVE BOCT-TRN-CODE TO WA-BUCKET-TRAN
SC4881        IF WA-INPUT-PARAM-TABLE(7) = 0                          
SC4881           PERFORM Z610-SEARCH-BUCKET-VIA-TRAN                  
SC4881              THRU Z619-EXIT                                    
SC4881        ELSE                                                    
SC4881           PERFORM Z620-SEARCH-BUCKET-VIA-CORR                  
SC4881              THRU Z629-EXIT                                    
SC4881        END-IF                                                  
SC4881                                                                
SC4881        IF WA-MSG-ERR-FLAG NOT = 0                              
SC4881           GO TO DISCHARGE-JR01-EXIT                            
SC4881        END-IF                                                  
SC4881                                                                
SC4881        IF WA-PRIORITY-CDE = "I"                                
SC4881         AND BR0025CA-AGR-INT NOT = 0                           
NR2001*SC4881           ADD  BR0025CA-AGR-INT  TO BORV-01-AMOUNT             
NR2001           ADD  BR0025CA-AGR-INT  TO BOCT-01-AMOUNT
SC4881           MOVE 0                 TO BR0025CA-AGR-INT
SC4881        END-IF                                       
SC4881                                                     
SC4881        IF WA-PRIORITY-CDE = "A"                     
SC4881         AND BR0025CA-AGR-ARR NOT = 0                
NR2001*SC4881           ADD  BR0025CA-AGR-ARR  TO BORV-01-AMOUNT  
NR2001           ADD  BR0025CA-AGR-ARR  TO BOCT-01-AMOUNT
SC4881           MOVE 0                 TO BR0025CA-AGR-ARR
SC4881        END-IF                                       
SC4881     END-IF.                                         
SC4881                                                     
NR2001*TB0102     MOVE BORV-01-TRN-CODE       TO LINK-IN-TXCODE
NR2001     MOVE BOCT-TRN-CODE          TO LINK-IN-TXCODE
TB0102                                    JNRST-TRAN-CODE
TB0102     PERFORM X700-CALL-UT0250
TB0102        THRU X799-EXIT
TB0102
TB0102     IF WA-MSG-ERR-FLAG = 1
TB0102       GO TO DISCHARGE-JR01-EXIT
TB0102     ELSE
TB0102       MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
TB0102     END-IF
TB0102
TB0223
TB0223     IF STRT-AREA-TRN-NO = 17467
TB0223        MOVE BR17467-INP-MORTGAGE-NO TO JNRST-LEDG-CODE
TB0223        MOVE BR17467-INP-SUB-LEDGER-CD TO JNRST-SUB-LEDG-CODE
SC5863        MOVE WA-SAVE-BRCH-NO         TO JNRST-TRANSFER-TXN-BRANCH
SC5863        MOVE WA-SAVE-GL-BR-NO        TO JNRST-HOME-BRNCH         
TB0223     END-IF.
SC7091     IF STRT-AREA-TRN-NO = 13020
SC7091        MOVE STRT-AREA-BRANCH        TO JNRST-TRANSFER-TXN-BRANCH
SC7091     END-IF.
SC5863                                                                 
NR2001*SC5863     IF BORV-01-TRN-CODE = 18403                                 
NR2001     IF BOCT-TRN-CODE    = 18403
SC5566                        OR 18503
S16347      IF NOT (STRT-AREA-TRN-NO = 13010 OR 13110 OR 13045 OR
S16347               13145 OR 13046 OR 13146 OR 15009 OR 15109 OR
S16347               15045 OR 15145 OR 15046 OR 15146 OR 13047 OR
S18413               14028 OR 19028 OR 14041 OR 19041 OR
S16347               13147 OR 15047 OR 15147)
SC5863        MOVE WA-SAVE-GL-BR-NO        TO JNRST-TRANSFER-TXN-BRANCH
SC5863                                        JNRST-HOME-BRNCH         
S16347      END-IF
SC5863     END-IF.                                                     
TB0223
SC1772***  JOURNAL AMT SIGN SHOULD BE SAME AS TRANSACTION AMT.
SC1772*    COMPUTE JNRST-AMOUNT = BORV-01-AMOUNT * -1
NR2001*SC1772     MOVE BORV-01-AMOUNT        TO JNRST-AMOUNT.
NR2001     MOVE BOCT-01-AMOUNT        TO JNRST-AMOUNT.
TB0102     MOVE 0                     TO JNRST-BALANCE
TB0102     MOVE 0                     TO JNRST-ARR
TB0102     MOVE BORM-GROUP TO JNRST-BOR-GROUP
TB0102     MOVE BORM-SUB-GROUP TO JNRST-BOR-SUB-GROUP
TB0102     MOVE 0 TO WA-ST-ENQ-CODE
TB0102     MOVE BORM-CURRENCY-IND TO JNRST-CURRENCY-CODE
TB0102                               JNRST-TO-CURRENCY-CODE
SC4485**                                                         
SC4485     IF STRT-AREA-TRN-NO = 13046 OR 13146 OR 15046 OR 15146
S16235                        OR 13047 OR 13147 OR 15047 OR 15147
NR2001*SC5566        IF BORV-01-TRN-CODE NOT = 18403 AND 18503
NR2001        IF BOCT-TRN-CODE NOT = 18403 AND 18503
SC4485           MOVE WA-SAVE-BRCH-NO  TO JNRST-TRANSFER-TXN-BRANCH 
SC5566        END-IF
SC4485     END-IF                                                
TB0102* GET BASE CURRENCY EQUIVALENT FOR ACCOUNT BALANCE.
TB0102     IF BORM-CURRENCY-IND NOT = SOC-NATIVE-CURRENCY
TB0102        MOVE UT0296-CALL-AREA         TO WA-SAVE-UT0296CA-AREA
TB0102        MOVE 3                        TO UT0296CA-CALL-CODE
TB0102        MOVE "LON"                    TO UT0296CA-SYSTEM
TB0102        MOVE BORM-CURRENCY-IND        TO UT0296CA-FROM-CURRENCY
TB0102                                         UT0296CA-TO-CURRENCY
TB0102        MOVE JNRST-AMOUNT             TO UT0296CA-FROM-AMOUNT
TB0102                                         UT0296CA-TO-AMOUNT
TB0102        MOVE "ZZZZ" TO UT0296CA-RATE-VERSION
TB0102        MOVE 01     TO UT0296CA-RATE-TYPE
TB0102        MOVE SPACES    TO UT0296CA-USER-CODES-LON
TB0102        MOVE ZEROES    TO UT0296CA-COMMISSION
TB0102                          UT0296CA-CHANGE
TB0102                          UT0296CA-BACKDATED-DATE
TB0102                          UT0296CA-FROM-BASE-EQUIVALENT
TB0102        INITIALIZE        UT0296CA-MULTI-FROM-AMOUNTS
TB0102        CALL "UT0296" USING
TB0102                          UT0296-CALL-AREA
TB0102                          STRT-AREA-DATA
TB0102                          SOC-PARAMS
TB0102
TB0102        IF UT0296CA-CALL-STATUS NOT = 0
TB0102           MOVE UT0296CA-CALL-STATUS  TO WA-OUTPUT-ERR-MSG-NO
TB0102           MOVE 1                     TO WA-MSG-ERR-FLAG
TB0102           GO TO DISCHARGE-JR01-EXIT
TB0102        END-IF
TB0102
TB0102        MOVE UT0296RA-FROM-RATE       TO JNRST-FROM-CURRENCY-RATE
TB0102        MOVE UT0296RA-EQUIV-BASE-AMOUNT TO
TB0102             JNRST-FROM-BASE-EQUIVALENT
TB0102             JNRST-TO-BASE-EQUIVALENT
TB0102        MOVE UT0296CA-RATE-TYPE       TO JNRST-RATE-TYPE
TB0102        MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
TB0102                                         JNRST-TO-CURRENCY-CODE
SC4881        MOVE WA-SAVE-UT0296CA-AREA    TO UT0296-CALL-AREA
TB0102     END-IF.
TB0102*
TB0102* MOVE SAVED UT0296 AREA BACK TO ORIGINAL BUFFER.
TB0102*
SC4881**   MOVE WA-SAVE-UT0296CA-AREA    TO UT0296-CALL-AREA.
TB0102
TB0102     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
TB0102
TB0102 DISCHARGE-JR01-EXIT.
TB0102     EXIT.
TB0102
SC4475 CREATE-13509-JR01.                                  
SC4475                                                     
SC4475     CALL "UT0030" USING  UT0030-FUNCTION            
SC4475                          UT0030-DATE-AREA           
SC4475                          UT0030-BINARY-DATE.        
SC4475     MOVE UT0030-BINARY-DATE TO WA-JR01-TRAN-DATE.   
SC5306     IF WA-INPUT-PARAM-TABLE (7) = 1
SC5306        MOVE 13609               TO LINK-IN-TXCODE
SC5306                                    JNRST-TRAN-CODE
SC5306     ELSE
SC4475        MOVE 13509               TO LINK-IN-TXCODE
SC4475                                    JNRST-TRAN-CODE  
SC5306     END-IF.
S16081*
S16081     IF  (BORM-CAPN-METHOD = "X" OR
S16081         (BORM-CAPN-METHOD = " " AND
S16081          BORP-CAPN-METHOD = "X"))
S16081        IF WA-INPUT-PARAM-TABLE (7) = 1
S16081           MOVE 13830               TO LINK-IN-TXCODE
S16081                                       JNRST-TRAN-CODE
S16081        ELSE
S16081           MOVE 13730               TO LINK-IN-TXCODE
S16081                                       JNRST-TRAN-CODE
S16081        END-IF
S16081     END-IF.
S16081*
SC7418     IF STRT-AREA-TRN-NO = 17033
SC7418        AND BR17033-AGREE-IND = 0
SC7418        MOVE 13609       TO LINK-IN-TXCODE
SC7418                            JNRST-TRAN-CODE
SC7418     END-IF.
SC4475     PERFORM X700-CALL-UT0250                        
SC4475        THRU X799-EXIT                               
SC4475                                                     
SC4475     IF WA-MSG-ERR-FLAG = 1                          
SC4475       GO TO CREATE-13509-JR01-EXIT                  
SC4475     ELSE                                            
SC4475       MOVE LINK-EDIT-TABLE        TO JNRST-EDIT-MASK
SC7107       MOVE LINK-SIGN              TO STRT-AREA-SIGN
SC4475     END-IF                                          
SC4475                                                     
SC4475     MOVE 0                        TO JNRST-LEDG-CODE
SC4475                                                     
SC4475     IF WA-INPUT-PARAM-TABLE (7) = 1                 
SC4475        COMPUTE JNRST-AMOUNT = JNRST-AMOUNT * -1     
CS4463     ELSE                                          
CS4463        IF JNRST-AMOUNT < 0                        
CS4463           COMPUTE JNRST-AMOUNT = JNRST-AMOUNT * -1
CS4463        END-IF                                     
SC4475     END-IF.                                         
SC7418     IF STRT-AREA-TRN-NO = 17033
SC7418        AND BR17033-AGREE-IND = 0
SC7418        COMPUTE JNRST-AMOUNT = JNRST-AMOUNT * -1
SC7418     END-IF.
SC4475                                                     
SC4475     MOVE 0                        TO JNRST-BALANCE           
SC4475     MOVE 0                        TO JNRST-ARR               
SC4475     MOVE BORM-GROUP               TO JNRST-BOR-GROUP         
SC4475     MOVE BORM-SUB-GROUP           TO JNRST-BOR-SUB-GROUP     
CS4463     MOVE JNRST-TRANSFER-TXN-BRANCH TO WA-SAVE-TRN-TXN-BRANCH
SC4475*    MOVE BORM-BR-NO               TO JNRST-BRCH                 SC8070
SC4475*                                     JNRST-TRANSFER-TXN-BRANCH  SC8070
SC8070     MOVE STRT-AREA-BRANCH         TO JNRST-BRCH
SC8070     MOVE BORM-BR-NO               TO JNRST-TRANSFER-TXN-BRANCH
SC4475     MOVE BORM-CURRENCY-IND        TO JNRST-CURRENCY-CODE     
SC4475                                      JNRST-TO-CURRENCY-CODE  
SC7418     MOVE BORM-BR-NO               TO JNRST-HOME-BRNCH.
SC7418     MOVE BORM-ACT-TYPE            TO JNRST-ACC-TYPE.
S12697     MOVE BORM-CAT                 TO JNRST-INT-CAT.
SC4475     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.                  
CS4463     MOVE WA-SAVE-TRN-TXN-BRANCH   TO JNRST-TRANSFER-TXN-BRANCH.
SC4475                                                              
SC4475 CREATE-13509-JR01-EXIT.                                      
SC4475     EXIT.                                                    
SC4881/                                                     
SC4881 CREATE-AGR-GLIF.                                     
SC4881     PERFORM Z600-SEARCH-BUCKET-TRN                   
SC4881        THRU Z609-EXIT.                               
SC4881                                                      
SC4881     IF WA-MSG-ERR-FLAG = 1                           
SC4881        GO TO CREATE-AGR-GLIF-EXIT                    
SC4881     END-IF.                                          
SC4881                                                      
SC4881     IF WA-INPUT-PARAM-TABLE(7) = 0                   
SC4881        MOVE WA-BUCKET-TRAN         TO LINK-IN-TXCODE 
SC4881                                       JNRST-TRAN-CODE
SC4881     ELSE                                             
SC4881        MOVE WA-CORR-BUCKET-TRAN    TO LINK-IN-TXCODE 
SC4881                                       JNRST-TRAN-CODE
SC4881     END-IF.                                          
SC4881                                                      
SC4881     PERFORM X700-CALL-UT0250                         
SC4881        THRU X799-EXIT.                               
SC4881                                                      
SC4881     IF WA-MSG-ERR-FLAG = 1                           
SC4881       GO TO CREATE-AGR-GLIF-EXIT                     
SC4881     ELSE                                         
SC4881       MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
SC4881     END-IF                                       
SC4881                                                  
SC4881     PERFORM Z000-WRITE-JRNL                      
SC4881        THRU Z009-EXIT.                           
SC4881                                                  
SC4881 CREATE-AGR-GLIF-EXIT.                            
SC4881     EXIT.                                        
SC4921 NPL-TO-NORMAL-PROCESS.
SC4921     IF WA-17003-CORR-TRAN-CD <> 17103
SC4921        MOVE BORM-GL-CLASSIFICATION-CODE
SC4921                       TO WA-SOUR-GL-CLASS-CODE
S15998*SC7791        IF BOIS-921-FLAG > 0
S15998*SC7791           MOVE BORM-GL-CLASSIFICATION-CODE
S15998*SC7791                       TO WA-DEST-GL-CLASS-CODE
S15998*SC7791        ELSE
SC4921           MOVE BORP-NON-CGL-COMPONENT-1
SC4921                       TO UT0099CA-COMPONENT-1
SC4921           MOVE BORP-NON-CGL-COMPONENT-2
SC4921                       TO UT0099CA-COMPONENT-2
SC4921           PERFORM NPL-BUILD-CGL THRU
SC4921                NPL-BUILD-CGL-EXIT
SC4921           MOVE UT0099CA-GLCC-OUTPUT-KEY
SC4921                       TO WA-DEST-GL-CLASS-CODE
S15998*SC7791        END-IF
SC4921     ELSE
S15998*SC7791        IF BOIS-921-FLAG > 0
S15998*SC7791           MOVE  BORM-GL-CLASSIFICATION-CODE
S15998*SC7791                       TO WA-SOUR-GL-CLASS-CODE
S15998*SC7791        ELSE
SC4921           MOVE BORP-CGL-COMPONENT-1-DR
SC4921                       TO UT0099CA-COMPONENT-1
SC4921           MOVE BORP-CGL-COMPONENT-1-DR
SC4921                       TO UT0099CA-COMPONENT-2
SC4921
SC4921           PERFORM NPL-BUILD-CGL THRU
SC4921                NPL-BUILD-CGL-EXIT
SC4921
SC4921           MOVE UT0099CA-GLCC-OUTPUT-KEY
SC4921                       TO WA-SOUR-GL-CLASS-CODE
S15998*SC7791        END-IF
SC4921        MOVE BORM-GL-CLASSIFICATION-CODE
SC4921                       TO WA-DEST-GL-CLASS-CODE
SC4921     END-IF
SC4921     MOVE 0                   TO WA-GL-INDX
SC4921                                 WA-TMP-GL-P.
SC4921     PERFORM
SC4921       VARYING WA-GL-INDX FROM 1 BY 1
SC4921       UNTIL WA-GL-INDX > 5
SC4921         IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "P"
S15728            AND BORM-LOAN-BAL <> 0
S15728*SC4921            AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
SC4921            MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) TO
SC4921                 WA-TMP-GL-P
SC4921            MOVE WA-SOUR-GL-CLASS-CODE TO
SC4921                                JNRST-GL-CLASS-CODE
SC4921            MOVE WA-DEST-GL-CLASS-CODE TO
SC4921                                JNRST-XFER-GL-CLASS-CODE
SC4921            IF WA-17003-CORR-TRAN-CD <> 17103
SC4921              COMPUTE WA-GLCC-XFER-AMOUNT =
SC4921                  BORM-LOAN-BAL * -1
SC4921            ELSE
SC4921              MOVE BORM-LOAN-BAL
SC4921                              TO WA-GLCC-XFER-AMOUNT
SC4921            END-IF
SC4921            MOVE 98924           TO JNRST-TRAN-CODE
SC4921                                  LINK-IN-TXCODE
SC4921            PERFORM WRITE-TO-JOURNAL-PROCESS
SC4921               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
SC4921         END-IF
S16997         IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "I"
S16997         AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
S16997         AND (STRT-TRICKLE-TXN AND BORP-PUBLIC-CONFER)
S16997            MOVE WA-DEST-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
S16997            MOVE WA-SOUR-GL-CLASS-CODE TO
S16997                                JNRST-XFER-GL-CLASS-CODE
S16997            MOVE 13530           TO JNRST-TRAN-CODE
S16997                                    LINK-IN-TXCODE
S16997            MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
S16997                                   TO WA-GLCC-XFER-AMOUNT
S16997            PERFORM WRITE-TO-JOURNAL-PROCESS
S16997               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S16997         END-IF
SC4921     END-PERFORM.
S15728*SC4921     IF WA-TMP-GL-P > 0
S15728     IF ( BORM-LOAN-BAL > WA-TMP-GL-P )
S15922*S12590     AND NOT (STRT-TRICKLE-TXN AND BORP-SUB-TYPE = ("A" OR "G"))
S15922     AND NOT (STRT-TRICKLE-TXN AND BORP-PUBLIC-CONFER)
SC4921        COMPUTE WA-TMP-GL-P = BORM-LOAN-BAL -
SC4921                              WA-TMP-GL-P
SC4921        IF WA-TMP-GL-P = 0
SC4921           GO TO NPL-TO-NORMAL-PROCESS-EXIT
SC4921        END-IF
SC4921        MOVE WA-DEST-GL-CLASS-CODE TO
SC4921                            JNRST-GL-CLASS-CODE
S15998*SC7791        IF BOIS-921-FLAG > 0
S15998*SC7791           MOVE SPACES TO WA-SOUR-GL-CLASS-CODE
S15998*SC7791        ELSE
SC4921           MOVE WA-SOUR-GL-CLASS-CODE TO
SC4921                            JNRST-XFER-GL-CLASS-CODE
S15998*SC7791        END-IF
SC4921        IF WA-17003-CORR-TRAN-CD <> 17103
SC4921          COMPUTE WA-GLCC-XFER-AMOUNT =
SC4921                  WA-TMP-GL-P * -1
SC4921        ELSE
SC4921          MOVE WA-TMP-GL-P TO WA-GLCC-XFER-AMOUNT
SC4921        END-IF
SC4921        MOVE 98927           TO JNRST-TRAN-CODE
SC4921                                LINK-IN-TXCODE
SC4921        PERFORM WRITE-TO-JOURNAL-PROCESS
SC4921           THRU WRITE-TO-JOURNAL-PROCESS-EXIT
SC4921     END-IF.
S11368*
S11368     IF  WA-ACT-TYPE-790
S11368     AND BOIS-LEGAL-FEE1-DUE > 0
S11368      IF WA-17003-CORR-TRAN-CD <> 17103
S11368        MOVE BORP-CGL-COMPONENT-1-DR
S11368                    TO UT0099CA-COMPONENT-1
S11368        MOVE BORP-CGL-COMPONENT-2-DR
S11368                    TO UT0099CA-COMPONENT-2
S11368
S11368        PERFORM NPL-BUILD-CGL THRU
S11368                NPL-BUILD-CGL-EXIT
S11368
S11368        MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S11368                           JNRST-GL-CLASS-CODE
S11368                           WA-SOUR-GL-CLASS-CODE
S11368
S11368        MOVE 98928         TO JNRST-TRAN-CODE
S11368                             LINK-IN-TXCODE
S11368                             STRT-AREA-TRN-NO
S11368
S11368        PERFORM X700-CALL-UT0250 THRU X799-EXIT
S11368
S11368        IF WA-MSG-ERR-FLAG = 1
S15020           GO TO NPL-TO-NORMAL-PROCESS-EXIT
S15020*S11368           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11368        ELSE
S11368           MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11368           MOVE LINK-SIGN       TO STRT-AREA-SIGN
S11368        END-IF
S11368
S11368        PERFORM X720-CALL-UT0251
S11368        THRU X729-EXIT
S11368
S11368        IF WA-MSG-ERR-FLAG NOT =  0
S15020           GO TO NPL-TO-NORMAL-PROCESS-EXIT
S15020*S11368           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11368        END-IF
S11368        MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11368                       UT0099CA-COMPONENT-1
S11368
S11368        PERFORM NPL-BUILD-CGL THRU
S11368                NPL-BUILD-CGL-EXIT
S11368        MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11368                       JNRST-XFER-GL-CLASS-CODE
S11368                           WA-DEST-GL-CLASS-CODE
S11368        COMPUTE WA-WORK-INT-0 ROUNDED = BOIS-LEGAL-FEE1-DUE
S11368        COMPUTE WA-GLCC-XFER-AMOUNT = WA-WORK-INT-0 * (-1)
S11368        PERFORM WRITE-TO-JOURNAL-PROCESS
S11368                          THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11368      ELSE
S11368        MOVE BORP-CGL-COMPONENT-1-DR
S11368                    TO UT0099CA-COMPONENT-1
S11368        MOVE BORP-CGL-COMPONENT-2-DR
S11368                    TO UT0099CA-COMPONENT-2
S11368
S11368        PERFORM NPL-BUILD-CGL THRU
S11368                NPL-BUILD-CGL-EXIT
S11368
S11368        MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S11368                           JNRST-GL-CLASS-CODE
S11368                           WA-SOUR-GL-CLASS-CODE
S11368
S11368        MOVE 98928         TO JNRST-TRAN-CODE
S11368                             LINK-IN-TXCODE
S11368                             STRT-AREA-TRN-NO
S11368
S11368        PERFORM X700-CALL-UT0250 THRU X799-EXIT
S11368
S11368        IF WA-MSG-ERR-FLAG = 1
S15020           GO TO NPL-TO-NORMAL-PROCESS-EXIT
S15020*S11368           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11368        ELSE
S11368           MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11368           MOVE LINK-SIGN       TO STRT-AREA-SIGN
S11368        END-IF
S11368
S11368        PERFORM X720-CALL-UT0251
S11368        THRU X729-EXIT
S11368
S11368        IF WA-MSG-ERR-FLAG NOT =  0
S15020           GO TO NPL-TO-NORMAL-PROCESS-EXIT
S15020*S11368           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11368        END-IF
S11368        MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11368                       UT0099CA-COMPONENT-1
S11368
S11368        PERFORM NPL-BUILD-CGL THRU
S11368                NPL-BUILD-CGL-EXIT
S11368        MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11368                       JNRST-XFER-GL-CLASS-CODE
S11368                           WA-DEST-GL-CLASS-CODE
S11368        COMPUTE WA-WORK-INT-0 ROUNDED = BOIS-LEGAL-FEE1-DUE
S11368        MOVE WA-WORK-INT-0 TO WA-GLCC-XFER-AMOUNT
S11368        PERFORM WRITE-TO-JOURNAL-PROCESS
S11368                          THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11368      END-IF
S11368     END-IF.
S11368*
S11368     IF WA-ACT-TYPE-790
S11368       MOVE 0                   TO WA-GL-INDX
S11368       PERFORM VARYING WA-GL-INDX FROM 1 BY 1
S11368         UNTIL WA-GL-INDX > 5
S11368         IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "P"
S11368         AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
S11368            IF WA-17003-CORR-TRAN-CD <> 17103
S11368               MOVE BORP-CGL-COMPONENT-1-DR
S11368                   TO UT0099CA-COMPONENT-1
S11368               MOVE BORP-CGL-COMPONENT-2-DR
S11368                   TO UT0099CA-COMPONENT-2
S11368               PERFORM NPL-BUILD-CGL THRU
S11368                       NPL-BUILD-CGL-EXIT
S11368               MOVE UT0099CA-GLCC-OUTPUT-KEY
S11368                   TO JNRST-GL-CLASS-CODE
S11368                      WA-SOUR-GL-CLASS-CODE
S11368               MOVE 98929   TO JNRST-TRAN-CODE
S11368                               LINK-IN-TXCODE
S11368                              STRT-AREA-TRN-NO
S11368               PERFORM X700-CALL-UT0250 THRU
S11368                       X799-EXIT
S11368               IF WA-MSG-ERR-FLAG = 1
S15020                  GO TO NPL-TO-NORMAL-PROCESS-EXIT
S15020*S11368                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11368               ELSE
S11368                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11368                  MOVE LINK-SIGN TO STRT-AREA-SIGN
S11368               END-IF
S11368               PERFORM X720-CALL-UT0251 THRU 
S11368                       X729-EXIT
S11368               IF WA-MSG-ERR-FLAG NOT =  0
S15020                  GO TO NPL-TO-NORMAL-PROCESS-EXIT
S15020*S11368                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11368               END-IF
S11368               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11368                      UT0099CA-COMPONENT-1
S11368               PERFORM NPL-BUILD-CGL THRU
S11368                       NPL-BUILD-CGL-EXIT
S11368               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11368                      JNRST-XFER-GL-CLASS-CODE
S11368                      WA-DEST-GL-CLASS-CODE
S11368               COMPUTE WA-GLCC-XFER-AMOUNT = BORM-LOAN-BAL * -1
S11368               PERFORM WRITE-TO-JOURNAL-PROCESS
S11368                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11368               MOVE 17003            TO STRT-AREA-TRN-NO
S11368            ELSE
S11368               MOVE BORP-CGL-COMPONENT-1-DR
S11368                      TO UT0099CA-COMPONENT-1
S11368               MOVE BORP-CGL-COMPONENT-2-DR
S11368                      TO UT0099CA-COMPONENT-2
S11368               PERFORM NPL-BUILD-CGL THRU
S11368                      NPL-BUILD-CGL-EXIT
S11368               MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S11368                      JNRST-GL-CLASS-CODE
S11368                      WA-SOUR-GL-CLASS-CODE
S11368               MOVE 98929         TO JNRST-TRAN-CODE
S11368                                     LINK-IN-TXCODE
S11368                                     STRT-AREA-TRN-NO
S11368               PERFORM X700-CALL-UT0250 THRU X799-EXIT
S11368               IF WA-MSG-ERR-FLAG = 1
S15020                  GO TO NPL-TO-NORMAL-PROCESS-EXIT
S15020*S11368                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11368               ELSE
S11368                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11368                  MOVE LINK-SIGN       TO STRT-AREA-SIGN
S11368               END-IF
S11368               PERFORM X720-CALL-UT0251 THRU X729-EXIT
S11368               IF WA-MSG-ERR-FLAG NOT =  0
S15020                  GO TO NPL-TO-NORMAL-PROCESS-EXIT
S15020*S11368                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11368               END-IF
S11368               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11368                      UT0099CA-COMPONENT-1
S11368               PERFORM NPL-BUILD-CGL THRU
S11368                      NPL-BUILD-CGL-EXIT
S11368               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11368                      JNRST-XFER-GL-CLASS-CODE
S11368                      WA-DEST-GL-CLASS-CODE
S11368               MOVE BORM-LOAN-BAL TO WA-GLCC-XFER-AMOUNT
S11368               PERFORM WRITE-TO-JOURNAL-PROCESS
S11368                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11368               MOVE 17003            TO STRT-AREA-TRN-NO
S11368            END-IF
S11368         END-IF
S11368       END-PERFORM
S11368     END-IF.
S11368*
SC4921 NPL-TO-NORMAL-PROCESS-EXIT.
SC4921     EXIT.
SC5843 921-TO-NPL-PROCESS.
SC5843     INITIALIZE JNRST-DB-DATA
SC5843     IF WA-17003-CORR-TRAN-CD <> 17103
SC5843        MOVE BORP-CGL-COMPONENT-1-DR
SC5843                    TO UT0099CA-COMPONENT-1
SC5843        MOVE BORP-CGL-COMPONENT-2-DR
SC5843                    TO UT0099CA-COMPONENT-2
SC5843
SC5843        PERFORM NPL-BUILD-CGL THRU
SC5843                NPL-BUILD-CGL-EXIT
SC5843
SC5843        MOVE UT0099CA-GLCC-OUTPUT-KEY TO
SC5843                           JNRST-GL-CLASS-CODE
KEEJET                           WA-SOUR-GL-CLASS-CODE
SC5843
SC5843        MOVE 13509         TO JNRST-TRAN-CODE
SC5843                             LINK-IN-TXCODE
SC5843                             STRT-AREA-TRN-NO
SC7107
SC7107        PERFORM X700-CALL-UT0250 THRU X799-EXIT
SC7107
SC7107        IF WA-MSG-ERR-FLAG = 1
SC7107           GO TO 921-TO-NPL-PROCESS-EXIT
SC7107        ELSE
SC7107           MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
SC7107           MOVE LINK-SIGN       TO STRT-AREA-SIGN
SC7107        END-IF
SC7107
SC5843        PERFORM X720-CALL-UT0251
SC5843        THRU X729-EXIT
SC5843
SC5843        IF WA-MSG-ERR-FLAG NOT =  0
SC5843           GO TO 921-TO-NPL-PROCESS-EXIT
SC5843        END-IF
SC5843        MOVE UT0251RA-CGL-COMPONENT-1-SB TO
SC5843                       UT0099CA-COMPONENT-1
SC5843
SC5843        PERFORM NPL-BUILD-CGL THRU
SC5843                NPL-BUILD-CGL-EXIT
SC5843        MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
SC5843                       JNRST-XFER-GL-CLASS-CODE
KEEJET                       WA-DEST-GL-CLASS-CODE
SC5843        COMPUTE WA-WORK-INT-0 ROUNDED = BORM-INT-ACCR
JET                                   + BORM-INT-ADJUSTMENT
SC5843        MOVE WA-WORK-INT-0 TO WA-GLCC-XFER-AMOUNT
SC5843     ELSE
SC5843        MOVE BORP-CGL-COMPONENT-1-DR
SC5843                    TO UT0099CA-COMPONENT-1
SC5843        MOVE BORP-CGL-COMPONENT-2-DR
SC5843                    TO UT0099CA-COMPONENT-2
SC5843
SC5843        PERFORM NPL-BUILD-CGL THRU
SC5843                NPL-BUILD-CGL-EXIT
SC5843
SC5843        MOVE UT0099CA-GLCC-OUTPUT-KEY TO
SC5843                           JNRST-GL-CLASS-CODE
KEEJET                           WA-SOUR-GL-CLASS-CODE
SC5843
SC5843        MOVE 13609         TO JNRST-TRAN-CODE
SC5843                             LINK-IN-TXCODE
SC5843                             STRT-AREA-TRN-NO
SC5843        PERFORM X720-CALL-UT0251
SC5843        THRU X729-EXIT
SC5843
SC5843        IF WA-MSG-ERR-FLAG NOT =  0
SC5843           GO TO 921-TO-NPL-PROCESS-EXIT
SC5843        END-IF
SC5843        MOVE UT0251RA-CGL-COMPONENT-1-SB TO
SC5843                       UT0099CA-COMPONENT-1
SC5843
SC5843        PERFORM NPL-BUILD-CGL THRU
SC5843                NPL-BUILD-CGL-EXIT
SC5843
SC5843        MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
SC5843                       JNRST-XFER-GL-CLASS-CODE
KEEJET                       WA-DEST-GL-CLASS-CODE
SC5843        COMPUTE WA-WORK-INT-0 ROUNDED =
JET               (BORM-INT-ACCR + BORM-INT-ADJUSTMENT) * -1
SC5843
SC5843        MOVE WA-WORK-INT-0 TO WA-GLCC-XFER-AMOUNT
SC5843     END-IF.
SC5843
SC5843
SC5843     PERFORM WRITE-TO-JOURNAL-PROCESS
SC5843               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
SC5843     MOVE 17003         TO STRT-AREA-TRN-NO
SC5843     IF WA-17003-CORR-TRAN-CD <> 17103
ST0102        IF NOT BORP-YOUBE                   
SC5843           MOVE 0   TO BORM-INT-ACCR          
JET              MOVE 0   TO BORM-INT-ADJUSTMENT    
ST0102        END-IF                              
SC5843        MOVE BORP-CGL-COMPONENT-1-DR
SC5843                       TO UT0099CA-COMPONENT-1
SC5843        MOVE BORP-CGL-COMPONENT-2-DR
SC5843                       TO UT0099CA-COMPONENT-2
SC5843
SC5843        PERFORM NPL-BUILD-CGL THRU
SC5843                NPL-BUILD-CGL-EXIT
SC5843
SC5843        MOVE UT0099CA-GLCC-OUTPUT-KEY
SC5843                       TO WA-SOUR-GL-CLASS-CODE
SC5843        MOVE BORM-GL-CLASSIFICATION-CODE
SC5843                       TO WA-DEST-GL-CLASS-CODE
SC5843     ELSE
SC5843        MOVE BORP-CGL-COMPONENT-1-DR
SC5843                       TO UT0099CA-COMPONENT-1
SC5843        MOVE BORP-CGL-COMPONENT-2-DR
SC5843                       TO UT0099CA-COMPONENT-2
SC5843
SC5843        PERFORM NPL-BUILD-CGL THRU
SC5843                NPL-BUILD-CGL-EXIT
SC5843
SC5843        MOVE UT0099CA-GLCC-OUTPUT-KEY
SC5843                       TO WA-SOUR-GL-CLASS-CODE
SC5843        MOVE BORM-GL-CLASSIFICATION-CODE
SC5843                       TO WA-DEST-GL-CLASS-CODE
SC5843     END-IF
SC5843     MOVE 0                   TO WA-GL-INDX.
SC5843     PERFORM
SC5843       VARYING WA-GL-INDX FROM 1 BY 1
SC5843       UNTIL WA-GL-INDX > 5
SC5843         IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "I"
SC5843            AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
SC5843            IF WA-17003-CORR-TRAN-CD <> 17103
SC5843                MOVE WA-SOUR-GL-CLASS-CODE TO
SC5843                                JNRST-GL-CLASS-CODE
SC5843                MOVE WA-DEST-GL-CLASS-CODE TO
SC5843                                JNRST-XFER-GL-CLASS-CODE
SC5843                MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
SC5843                              TO WA-GLCC-XFER-AMOUNT
SC5843            ELSE
SC5843                MOVE BORP-921-L-CGL-1
SC5843                       TO UT0099CA-COMPONENT-1
SC5843                MOVE BORP-921-L-CGL-2
SC5843                       TO UT0099CA-COMPONENT-2
SC5843                PERFORM NPL-BUILD-CGL THRU
SC5843                NPL-BUILD-CGL-EXIT
SC5843                MOVE UT0099CA-GLCC-OUTPUT-KEY
SC5843                       TO JNRST-XFER-GL-CLASS-CODE
SC5843                MOVE WA-DEST-GL-CLASS-CODE
SC5843                       TO JNRST-GL-CLASS-CODE
SC5843                COMPUTE WA-GLCC-XFER-AMOUNT =
SC5843                        UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
SC5843                            * -1
SC5843            END-IF
SC5843            MOVE 98921        TO JNRST-TRAN-CODE
SC5843                                   LINK-IN-TXCODE
SC5843            PERFORM WRITE-TO-JOURNAL-PROCESS
SC5843               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
SC5843         END-IF
SC5843     END-PERFORM.
SC5843
SC5843 921-TO-NPL-PROCESS-EXIT.
SC5843     EXIT.
TB0211
TB0211 NORMAL-TO-NPL-PROCESS.
TB0211     INITIALIZE JNRST-DB-DATA
SC2263     IF WA-17003-CORR-TRAN-CD <> 17103
SC2263        MOVE BORP-CGL-COMPONENT-1-DR
SC2263                    TO UT0099CA-COMPONENT-1
SC2263        MOVE BORP-CGL-COMPONENT-2-DR
SC2263                    TO UT0099CA-COMPONENT-2
SC2263
SC2263        PERFORM NPL-BUILD-CGL THRU
SC2263                NPL-BUILD-CGL-EXIT
SC2263
SC2263        MOVE UT0099CA-GLCC-OUTPUT-KEY TO
SC2263                           JNRST-GL-CLASS-CODE
KEEJET                           WA-SOUR-GL-CLASS-CODE
SC2263        MOVE 13509         TO JNRST-TRAN-CODE
SC2263                             LINK-IN-TXCODE
SC2263                             STRT-AREA-TRN-NO
SC7107
SC7107        PERFORM X700-CALL-UT0250 THRU X799-EXIT
SC7107
SC7107        IF WA-MSG-ERR-FLAG = 1
SC7107           GO TO NORMAL-TO-NPL-PROCESS-EXIT
SC7107        ELSE
SC7107           MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
SC7107           MOVE LINK-SIGN       TO STRT-AREA-SIGN
SC7107        END-IF
SC7107
SC2263        PERFORM X720-CALL-UT0251
SC2263        THRU X729-EXIT
SC2263
SC2263        IF WA-MSG-ERR-FLAG NOT =  0
SC2263           GO TO NORMAL-TO-NPL-PROCESS-EXIT
SC2263        END-IF
SC2263        MOVE UT0251RA-CGL-COMPONENT-1-SB TO
SC2263                       UT0099CA-COMPONENT-1
SC2263
SC2263        PERFORM NPL-BUILD-CGL THRU
SC2263                NPL-BUILD-CGL-EXIT
SC2263        MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
SC2263                       JNRST-XFER-GL-CLASS-CODE
KEEJET                           WA-DEST-GL-CLASS-CODE
              COMPUTE WA-WORK-INT-0 ROUNDED = BORM-INT-ACCR
JET                   + BORM-INT-ADJUSTMENT
SC2263        MOVE WA-WORK-INT-0 TO WA-GLCC-XFER-AMOUNT
SC4696     ELSE
SC2263        MOVE BORP-CGL-COMPONENT-1-DR
SC2263                    TO UT0099CA-COMPONENT-1
SC2263        MOVE BORP-CGL-COMPONENT-2-DR
SC2263                    TO UT0099CA-COMPONENT-2
SC2263
SC2263        PERFORM NPL-BUILD-CGL THRU
SC2263                NPL-BUILD-CGL-EXIT
SC2263
SC2263        MOVE UT0099CA-GLCC-OUTPUT-KEY TO
SC2263                           JNRST-GL-CLASS-CODE
KEEJET                           WA-SOUR-GL-CLASS-CODE
SC2263        MOVE 13609         TO JNRST-TRAN-CODE
SC2263                             LINK-IN-TXCODE
SC2263                             STRT-AREA-TRN-NO
SC2263        PERFORM X720-CALL-UT0251
SC2263        THRU X729-EXIT
SC2263
SC2263        IF WA-MSG-ERR-FLAG NOT =  0
SC2263           GO TO NORMAL-TO-NPL-PROCESS-EXIT
SC2263        END-IF
SC2263        MOVE UT0251RA-CGL-COMPONENT-1-SB TO
SC2263                       UT0099CA-COMPONENT-1
SC2263
SC2263        PERFORM NPL-BUILD-CGL THRU
SC2263                NPL-BUILD-CGL-EXIT
SC2263
SC2263        MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
SC2263                       JNRST-XFER-GL-CLASS-CODE
KEEJET                           WA-DEST-GL-CLASS-CODE
S11616
S11616        PERFORM VARYING WA-GL-INDX FROM 1 BY 1
S11616          UNTIL WA-GL-INDX > 5
S11616         IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "I"
S15492          IF NOT ( BR0001CA-OVER-DUE-BILLING )
S11616            COMPUTE WA-WORK-INT-0 ROUNDED =
S11616               (UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) -
S11616               BOIS-INTEREST-DUE) * -1
S15492          ELSE
S15492            COMPUTE WA-WORK-INT-0 ROUNDED =
S15492               (UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) -
S15492               (BOIS-INTEREST-DUE - BR0001CA-INTEREST-DUE)) * -1
S15492          END-IF
S15871          IF ( BOIS-AGREE-FUNC-USE
S15871          AND  BOIS-AGREE-INT-BUCKET > 0 )
S15871               ADD  BOIS-AGREE-INT-BUCKET TO WA-WORK-INT-0
S15871          END-IF
S11616         END-IF
S11616        END-PERFORM
      *S11616 COMPUTE WA-WORK-INT-0 ROUNDED =
JET   *S11616     (BORM-INT-ACCR + BORM-INT-ADJUSTMENT) * -1
SC2263        MOVE WA-WORK-INT-0 TO WA-GLCC-XFER-AMOUNT
SC4696     END-IF.
SC2263
SC2263
S15020     IF ( GL-LINK-USE
S15020     AND  GL-LINK-GLIF-NO-I
S15020     AND (JNRST-TRAN-CODE = 13509
S16081     OR   JNRST-TRAN-CODE = 13730
S16081     OR   JNRST-TRAN-CODE = 13830
S15020     OR   JNRST-TRAN-CODE = 13609))
S15020          NEXT SENTENCE
S15020     ELSE
S15020          PERFORM WRITE-TO-JOURNAL-PROCESS
SC2263               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S15020     END-IF.
S15020*SC2263     PERFORM WRITE-TO-JOURNAL-PROCESS
S15492*
S15492     IF  WA-17003-CORR-TRAN-CD = 17103
S15492     AND BR0001CA-OVER-DUE-BILLING
S15492     AND BR0001CA-INTEREST-DUE > 0
S15492        INITIALIZE JNRST-DB-DATA
S15492        MOVE BORP-CGL-COMPONENT-1-DR
S15492                    TO UT0099CA-COMPONENT-1
S15492        MOVE BORP-CGL-COMPONENT-2-DR
S15492                    TO UT0099CA-COMPONENT-2
S15492        PERFORM NPL-BUILD-CGL THRU
S15492                NPL-BUILD-CGL-EXIT
S15492        MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S15492                           JNRST-GL-CLASS-CODE
S15492                           WA-SOUR-GL-CLASS-CODE
S15492        MOVE 13509         TO JNRST-TRAN-CODE
S15492                             LINK-IN-TXCODE
S15492                             STRT-AREA-TRN-NO
S15492        PERFORM X700-CALL-UT0250 THRU X799-EXIT
S15492        IF WA-MSG-ERR-FLAG = 1
S15492           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S15492        ELSE
S15492           MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S15492           MOVE LINK-SIGN       TO STRT-AREA-SIGN
S15492        END-IF
S15492        PERFORM X720-CALL-UT0251 THRU X729-EXIT
S15492        IF WA-MSG-ERR-FLAG NOT =  0
S15492           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S15492        END-IF
S15492        MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S15492                       UT0099CA-COMPONENT-1
S15492        PERFORM NPL-BUILD-CGL THRU NPL-BUILD-CGL-EXIT
S15492        MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S15492                           JNRST-XFER-GL-CLASS-CODE
S15492                           WA-DEST-GL-CLASS-CODE
S15492        COMPUTE WA-WORK-INT-0 ROUNDED = BR0001CA-INTEREST-DUE
S15492        MOVE WA-WORK-INT-0 TO WA-GLCC-XFER-AMOUNT
S15492        PERFORM WRITE-TO-JOURNAL-PROCESS THRU
S15492                WRITE-TO-JOURNAL-PROCESS-EXIT
S15492     END-IF.
S15492*
S11313*
S11313     IF  WA-ACT-TYPE-790
S11313     AND BOIS-LEGAL-FEE1-DUE > 0
S11313      IF WA-17003-CORR-TRAN-CD <> 17103
S11313        MOVE BORP-CGL-COMPONENT-1-DR
S11313                    TO UT0099CA-COMPONENT-1
S11313        MOVE BORP-CGL-COMPONENT-2-DR
S11313                    TO UT0099CA-COMPONENT-2
S11313
S11313        PERFORM NPL-BUILD-CGL THRU
S11313                NPL-BUILD-CGL-EXIT
S11313
S11313        MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S11313                           JNRST-GL-CLASS-CODE
S11313                           WA-SOUR-GL-CLASS-CODE
S11313
S11313        MOVE 98928         TO JNRST-TRAN-CODE
S11313                             LINK-IN-TXCODE
S11313                             STRT-AREA-TRN-NO
S11313
S11313        PERFORM X700-CALL-UT0250 THRU X799-EXIT
S11313
S11313        IF WA-MSG-ERR-FLAG = 1
S11313           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313        ELSE
S11313           MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11313           MOVE LINK-SIGN       TO STRT-AREA-SIGN
S11313        END-IF
S11313
S11313        PERFORM X720-CALL-UT0251
S11313        THRU X729-EXIT
S11313
S11313        IF WA-MSG-ERR-FLAG NOT =  0
S11313           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313        END-IF
S11313        MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11313                       UT0099CA-COMPONENT-1
S11313
S11313        PERFORM NPL-BUILD-CGL THRU
S11313                NPL-BUILD-CGL-EXIT
S11313        MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11313                       JNRST-XFER-GL-CLASS-CODE
S11313                           WA-DEST-GL-CLASS-CODE
S11313        COMPUTE WA-WORK-INT-0 ROUNDED = BOIS-LEGAL-FEE1-DUE
S11313        MOVE WA-WORK-INT-0 TO WA-GLCC-XFER-AMOUNT
S11313        PERFORM WRITE-TO-JOURNAL-PROCESS
S11313                          THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11313      ELSE
S11313        MOVE BORP-CGL-COMPONENT-1-DR
S11313                    TO UT0099CA-COMPONENT-1
S11313        MOVE BORP-CGL-COMPONENT-2-DR
S11313                    TO UT0099CA-COMPONENT-2
S11313
S11313        PERFORM NPL-BUILD-CGL THRU
S11313                NPL-BUILD-CGL-EXIT
S11313
S11313        MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S11313                           JNRST-GL-CLASS-CODE
S11313                           WA-SOUR-GL-CLASS-CODE
S11313
S11313        MOVE 98928         TO JNRST-TRAN-CODE
S11313                             LINK-IN-TXCODE
S11313                             STRT-AREA-TRN-NO
S11313
S11313        PERFORM X700-CALL-UT0250 THRU X799-EXIT
S11313
S11313        IF WA-MSG-ERR-FLAG = 1
S11313           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313        ELSE
S11313           MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11313           MOVE LINK-SIGN       TO STRT-AREA-SIGN
S11313        END-IF
S11313
S11313        PERFORM X720-CALL-UT0251
S11313        THRU X729-EXIT
S11313
S11313        IF WA-MSG-ERR-FLAG NOT =  0
S11313           GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313        END-IF
S11313        MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11313                       UT0099CA-COMPONENT-1
S11313
S11313        PERFORM NPL-BUILD-CGL THRU
S11313                NPL-BUILD-CGL-EXIT
S11313        MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11313                       JNRST-XFER-GL-CLASS-CODE
S11313                           WA-DEST-GL-CLASS-CODE
S11313        COMPUTE WA-WORK-INT-0 ROUNDED = BOIS-LEGAL-FEE1-DUE
S11313        COMPUTE WA-GLCC-XFER-AMOUNT = WA-WORK-INT-0 * (-1)
S11313        PERFORM WRITE-TO-JOURNAL-PROCESS
S11313                          THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11313      END-IF
S11313     END-IF.
S11313*
SC2263     MOVE 17003         TO STRT-AREA-TRN-NO
SC2263     IF WA-17003-CORR-TRAN-CD <> 17103
ST0102        IF NOT BORP-YOUBE                 
SC2263           MOVE 0   TO BORM-INT-ACCR        
JET              MOVE 0   TO BORM-INT-ADJUSTMENT  
ST0102        END-IF                            
SC2263        MOVE BORP-CGL-COMPONENT-1-DR
SC2263                       TO UT0099CA-COMPONENT-1
SC2263        MOVE BORP-CGL-COMPONENT-2-DR
SC2263                       TO UT0099CA-COMPONENT-2
SC2263
SC2263        PERFORM NPL-BUILD-CGL THRU
SC2263                NPL-BUILD-CGL-EXIT
SC2263
SC2263        MOVE UT0099CA-GLCC-OUTPUT-KEY
SC2263                       TO WA-SOUR-GL-CLASS-CODE
SC2263        MOVE BORM-GL-CLASSIFICATION-CODE
SC2263                       TO WA-DEST-GL-CLASS-CODE
SC2263     ELSE
SC2263        MOVE BORP-NON-CGL-COMPONENT-1
SC2263                       TO UT0099CA-COMPONENT-1
SC2263        MOVE BORP-NON-CGL-COMPONENT-2
SC2263                       TO UT0099CA-COMPONENT-2
SC2263
SC2263        PERFORM NPL-BUILD-CGL THRU
SC2263                NPL-BUILD-CGL-EXIT
SC2263        MOVE UT0099CA-GLCC-OUTPUT-KEY
SC2263                       TO WA-SOUR-GL-CLASS-CODE
SC2263        MOVE BORM-GL-CLASSIFICATION-CODE
SC2263                       TO WA-DEST-GL-CLASS-CODE
SC2263     END-IF
SC2263     MOVE 0                   TO WA-GL-INDX.
SC2263     PERFORM
SC2263       VARYING WA-GL-INDX FROM 1 BY 1
SC2263       UNTIL WA-GL-INDX > 5
SC4693         IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "P"
SC4693            AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
SC2263*        IF BOIS-GL-BUCKET-CDE(WA-GL-INDX) = "P"
SC2263*           AND BOIS-GL-BUCKET-DUE(WA-GL-INDX) <> 0
SC2263            MOVE WA-SOUR-GL-CLASS-CODE TO
SC2263                                JNRST-GL-CLASS-CODE
SC2263            MOVE WA-DEST-GL-CLASS-CODE TO
SC2263                                JNRST-XFER-GL-CLASS-CODE
SC2263            MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
SC2263                              TO WA-GLCC-XFER-AMOUNT
SC2263            MOVE 98924           TO JNRST-TRAN-CODE
SC2263                                  LINK-IN-TXCODE
S15020           IF   NOT ( GL-LINK-USE AND GL-LINK-GLIF-NO-P )
SC2263            PERFORM WRITE-TO-JOURNAL-PROCESS
SC2263               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S15020           END-IF
SC2263         END-IF
SC4696         IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "I"
SC4696            AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
SC2263*        IF BOIS-GL-BUCKET-CDE(WA-GL-INDX) = "I"
SC2263*           AND BOIS-GL-BUCKET-DUE(WA-GL-INDX) <> 0
SC2263            IF WA-17003-CORR-TRAN-CD <> 17103
SC2263                MOVE WA-SOUR-GL-CLASS-CODE TO
SC2263                                JNRST-GL-CLASS-CODE
SC2263                MOVE WA-DEST-GL-CLASS-CODE TO
SC2263                                JNRST-XFER-GL-CLASS-CODE
SC2263                MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
SC2263                              TO WA-GLCC-XFER-AMOUNT
                  ELSE
SC2263                MOVE BORP-NON-CGL-COMPONENT-1
SC2263                       TO UT0099CA-COMPONENT-1
SC2263                MOVE BORP-NON-CGL-COMPONENT-2
SC2263                       TO UT0099CA-COMPONENT-2
SC2263                PERFORM NPL-BUILD-CGL THRU
SC2263                NPL-BUILD-CGL-EXIT
SC2263                MOVE UT0099CA-GLCC-OUTPUT-KEY
SC2263*SC4969                TO WA-SOUR-GL-CLASS-CODE
SC2263*SC4969         MOVE WA-SOUR-GL-CLASS-CODE TO
SC2263                       TO JNRST-XFER-GL-CLASS-CODE
SC2263                MOVE WA-DEST-GL-CLASS-CODE
SC2263                       TO JNRST-GL-CLASS-CODE
                      COMPUTE WA-GLCC-XFER-AMOUNT =
                              UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
                                  * -1
                  END-IF
SC2263            MOVE 98921        TO JNRST-TRAN-CODE
SC2263                                   LINK-IN-TXCODE
S15020           IF   NOT ( GL-LINK-USE AND GL-LINK-GLIF-NO-I )
SC2263            PERFORM WRITE-TO-JOURNAL-PROCESS
SC2263               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S15020           END-IF
S16997           IF NOT WA-ACT-TYPE-790
S16997             IF WA-17003-CORR-TRAN-CD <> 17103
S16997               MOVE WA-DEST-GL-CLASS-CODE TO
S16997                                    JNRST-GL-CLASS-CODE
S16997               MOVE 13530        TO JNRST-TRAN-CODE
S16997                                    LINK-IN-TXCODE
S16997               COMPUTE WA-GLCC-XFER-AMOUNT =
S16997                      UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) * -1
S16997             ELSE
S16997               MOVE WA-SOUR-GL-CLASS-CODE
S16997                                 TO JNRST-GL-CLASS-CODE
S16997               MOVE 13630        TO JNRST-TRAN-CODE
S16997                                    LINK-IN-TXCODE
S16997               COMPUTE WA-GLCC-XFER-AMOUNT =
S16997                      UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
S16997             END-IF
S16997             IF   NOT ( GL-LINK-USE AND GL-LINK-GLIF-NO-I )
S16997               PERFORM WRITE-TO-JOURNAL-PROCESS
S16997                  THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S16997             END-IF
S16997           END-IF
SC2263         END-IF
SC2263     END-PERFORM.
S11313*
S11313     IF WA-ACT-TYPE-790
S11313       MOVE 0                   TO WA-GL-INDX
S11313       PERFORM VARYING WA-GL-INDX FROM 1 BY 1
S11313         UNTIL WA-GL-INDX > 5
S11313         IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "P"
S11313         AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
S11313            IF WA-17003-CORR-TRAN-CD <> 17103
S11313               MOVE BORP-CGL-COMPONENT-1-DR
S11313                   TO UT0099CA-COMPONENT-1
S11313               MOVE BORP-CGL-COMPONENT-2-DR
S11313                   TO UT0099CA-COMPONENT-2
S11313               PERFORM NPL-BUILD-CGL THRU
S11313                       NPL-BUILD-CGL-EXIT
S11313               MOVE UT0099CA-GLCC-OUTPUT-KEY
S11313                   TO JNRST-GL-CLASS-CODE
S11313                      WA-SOUR-GL-CLASS-CODE
S11313               MOVE 98929   TO JNRST-TRAN-CODE
S11313                               LINK-IN-TXCODE
S11313                              STRT-AREA-TRN-NO
S11313               PERFORM X700-CALL-UT0250 THRU
S11313                       X799-EXIT
S11313               IF WA-MSG-ERR-FLAG = 1
S11313                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313               ELSE
S11313                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11313                  MOVE LINK-SIGN TO STRT-AREA-SIGN
S11313               END-IF
S11313               PERFORM X720-CALL-UT0251 THRU 
S11313                       X729-EXIT
S11313               IF WA-MSG-ERR-FLAG NOT =  0
S11313                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313               END-IF
S11313               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11313                      UT0099CA-COMPONENT-1
S11313               PERFORM NPL-BUILD-CGL THRU
S11313                       NPL-BUILD-CGL-EXIT
S11313               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11313                      JNRST-XFER-GL-CLASS-CODE
S11313                      WA-DEST-GL-CLASS-CODE
S11313               MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) TO
S11313                      WA-GLCC-XFER-AMOUNT
S11313               PERFORM WRITE-TO-JOURNAL-PROCESS
S11313                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11313               MOVE 17003            TO STRT-AREA-TRN-NO
S11313            ELSE
S11313               MOVE BORP-CGL-COMPONENT-1-DR
S11313                      TO UT0099CA-COMPONENT-1
S11313               MOVE BORP-CGL-COMPONENT-2-DR
S11313                      TO UT0099CA-COMPONENT-2
S11313               PERFORM NPL-BUILD-CGL THRU
S11313                      NPL-BUILD-CGL-EXIT
S11313               MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S11313                      JNRST-GL-CLASS-CODE
S11313                      WA-SOUR-GL-CLASS-CODE
S11313               MOVE 98929         TO JNRST-TRAN-CODE
S11313                                     LINK-IN-TXCODE
S11313                                     STRT-AREA-TRN-NO
S11313               PERFORM X700-CALL-UT0250 THRU X799-EXIT
S11313               IF WA-MSG-ERR-FLAG = 1
S11313                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313               ELSE
S11313                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11313                  MOVE LINK-SIGN       TO STRT-AREA-SIGN
S11313               END-IF
S11313               PERFORM X720-CALL-UT0251 THRU X729-EXIT
S11313               IF WA-MSG-ERR-FLAG NOT =  0
S11313                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313               END-IF
S11313               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11313                      UT0099CA-COMPONENT-1
S11313               PERFORM NPL-BUILD-CGL THRU
S11313                      NPL-BUILD-CGL-EXIT
S11313               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11313                      JNRST-XFER-GL-CLASS-CODE
S11313                      WA-DEST-GL-CLASS-CODE
S11313               COMPUTE WA-GLCC-XFER-AMOUNT = 
S11313                    UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) * (-1)
S11313               PERFORM WRITE-TO-JOURNAL-PROCESS
S11313                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11313               MOVE 17003            TO STRT-AREA-TRN-NO
S11313            END-IF
S11313         END-IF
S11313         IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "I"
S11313         AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
S11313            IF WA-17003-CORR-TRAN-CD <> 17103
S11313               MOVE BORP-CGL-COMPONENT-1-DR
S11313                   TO UT0099CA-COMPONENT-1
S11313               MOVE BORP-CGL-COMPONENT-2-DR
S11313                   TO UT0099CA-COMPONENT-2
S11313               PERFORM NPL-BUILD-CGL THRU
S11313                       NPL-BUILD-CGL-EXIT
S11313               MOVE UT0099CA-GLCC-OUTPUT-KEY
S11313                   TO JNRST-GL-CLASS-CODE
S11313                      WA-SOUR-GL-CLASS-CODE
S11313               MOVE 98930   TO JNRST-TRAN-CODE
S11313                               LINK-IN-TXCODE
S11313                              STRT-AREA-TRN-NO
S11313               PERFORM X700-CALL-UT0250 THRU
S11313                       X799-EXIT
S11313               IF WA-MSG-ERR-FLAG = 1
S11313                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313               ELSE
S11313                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11313                  MOVE LINK-SIGN TO STRT-AREA-SIGN
S11313               END-IF
S11313               PERFORM X720-CALL-UT0251 THRU 
S11313                       X729-EXIT
S11313               IF WA-MSG-ERR-FLAG NOT =  0
S11313                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313               END-IF
S11313               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11313                      UT0099CA-COMPONENT-1
S11313               PERFORM NPL-BUILD-CGL THRU
S11313                       NPL-BUILD-CGL-EXIT
S11313               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11313                      JNRST-XFER-GL-CLASS-CODE
S11313                      WA-DEST-GL-CLASS-CODE
S11313               MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) TO
S11313                      WA-GLCC-XFER-AMOUNT
S11313               PERFORM WRITE-TO-JOURNAL-PROCESS
S11313                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11313               MOVE 17003            TO STRT-AREA-TRN-NO
S11313            ELSE
S11313               MOVE BORP-CGL-COMPONENT-1-DR
S11313                      TO UT0099CA-COMPONENT-1
S11313               MOVE BORP-CGL-COMPONENT-2-DR
S11313                      TO UT0099CA-COMPONENT-2
S11313               PERFORM NPL-BUILD-CGL THRU
S11313                      NPL-BUILD-CGL-EXIT
S11313               MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S11313                      JNRST-GL-CLASS-CODE
S11313                      WA-SOUR-GL-CLASS-CODE
S11313               MOVE 98930         TO JNRST-TRAN-CODE
S11313                                     LINK-IN-TXCODE
S11313                                     STRT-AREA-TRN-NO
S11313               PERFORM X700-CALL-UT0250 THRU X799-EXIT
S11313               IF WA-MSG-ERR-FLAG = 1
S11313                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313               ELSE
S11313                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11313                  MOVE LINK-SIGN       TO STRT-AREA-SIGN
S11313               END-IF
S11313               PERFORM X720-CALL-UT0251 THRU X729-EXIT
S11313               IF WA-MSG-ERR-FLAG NOT =  0
S11313                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11313               END-IF
S11313               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11313                      UT0099CA-COMPONENT-1
S11313               PERFORM NPL-BUILD-CGL THRU
S11313                      NPL-BUILD-CGL-EXIT
S11313               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11313                      JNRST-XFER-GL-CLASS-CODE
S11313                      WA-DEST-GL-CLASS-CODE
S11313               COMPUTE WA-GLCC-XFER-AMOUNT = 
S11313                    UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) * (-1)
S11313               PERFORM WRITE-TO-JOURNAL-PROCESS
S11313                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11313               MOVE 17003            TO STRT-AREA-TRN-NO
S11313            END-IF
S11313         END-IF
S11313       END-PERFORM
S11313     END-IF.
S11313*
TB0211 NORMAL-TO-NPL-PROCESS-EXIT.
TB0211     EXIT.
TB0211
SC2263  NPL-BUILD-CGL.
SC2263* GL CLASSIFICATION CODE IS BUILT HERE. (ANZ023).
SC2263*
SC2263*    MOVE STRT-AREA-BRANCH        TO UT0099CA-BRANCH.
SC6108     MOVE BORM-BR-NO              TO UT0099CA-BRANCH.
SC2263*    MOVE BORP-CGL-COMPONENT-1-DR TO UT0099CA-COMPONENT-1.
SC2263*    MOVE BORP-CGL-COMPONENT-2-DR TO UT0099CA-COMPONENT-2.
SC2263     MOVE CUSM-LANGUAGE-CODE TO UT0099CA-SEGMENT.
SC2263     MOVE CUSM-SEGMENT-CODE  TO UT0099CA-GROUP-CODE.
SC2263     MOVE CUSM-GROUP-CODE    TO UT0099CA-CURRENCY
SC2263*    MOVE WA-CUSM-SEGMENT-CODE    TO UT0099CA-SEGMENT.
SC2263*    MOVE WA-CUSM-GROUP-CODE      TO UT0099CA-GROUP-CODE.
SC2263     MOVE BORP-CURRENCY-IND
SC2263                                  TO UT0099CA-CURRENCY.
SC2263     MOVE SOC-GL-CLASS-CODE-STRUCTURE TO
SC2263          UT0099CA-GLCC-STRUCTURE.
SC2263     CALL "UT0099" USING
SC2263                 UT0099CA-AREA.
SC2263 NPL-BUILD-CGL-EXIT.
SC2263     EXIT.
TB0211 NPL-TO-BAD-DEBT-PROCESS.
SC5014     IF WA-17003-CORR-TRAN-CD <> 17103
SC5014        MOVE BORM-GL-CLASSIFICATION-CODE
SC5190                       TO WA-SOUR-GL-CLASS-CODE
SC5190        MOVE BORP-BAD-D-CGL-1
SC5190                       TO UT0099CA-COMPONENT-1
SC5190        MOVE BORP-BAD-D-CGL-2
SC5190                       TO UT0099CA-COMPONENT-2
SC5190
SC5190        PERFORM NPL-BUILD-CGL THRU
SC5190                NPL-BUILD-CGL-EXIT
SC5190        MOVE UT0099CA-GLCC-OUTPUT-KEY
SC5190                       TO WA-DEST-GL-CLASS-CODE
SC5014     ELSE
SC5014        MOVE BORP-BAD-D-CGL-1
SC5014                       TO UT0099CA-COMPONENT-1
SC5014        MOVE BORP-BAD-D-CGL-2
SC5014                       TO UT0099CA-COMPONENT-2
SC5014
SC5014        PERFORM NPL-BUILD-CGL THRU
SC5014                NPL-BUILD-CGL-EXIT
SC5014
SC5014        MOVE UT0099CA-GLCC-OUTPUT-KEY
SC5014                       TO WA-SOUR-GL-CLASS-CODE
SC5014        MOVE BORM-GL-CLASSIFICATION-CODE
SC5014                       TO WA-DEST-GL-CLASS-CODE
SC5014     END-IF
SC5014     MOVE 0                   TO WA-GL-INDX.
SC5014     PERFORM
SC5014       VARYING WA-GL-INDX FROM 1 BY 1
SC5014       UNTIL WA-GL-INDX > 5
SC5014         IF (UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "P" OR "I")
SC5014            AND (UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0)
SC5014            MOVE WA-SOUR-GL-CLASS-CODE TO
SC5014                                JNRST-GL-CLASS-CODE
SC5014            MOVE WA-DEST-GL-CLASS-CODE TO
SC5014                                JNRST-XFER-GL-CLASS-CODE
SC5014            MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
SC5014                              TO WA-GLCC-XFER-AMOUNT
S16997            IF  UT0073CA-GL-BUCKET-CDE (WA-GL-INDX) = "I"
S16997                MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
S16997                                         TO WA-NON-TAX-AMT
S16997            END-IF
SC5014            MOVE 98924           TO JNRST-TRAN-CODE
SC5014                                  LINK-IN-TXCODE
SC5014            PERFORM WRITE-TO-JOURNAL-PROCESS
SC5014               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
SC5014         END-IF
SC5014     END-PERFORM.
S16997     IF  NOT WA-ACT-TYPE-790
S16997     AND WA-NON-TAX-AMT <> 0
S16997         MOVE WA-NON-TAX-AMT TO WA-GLCC-XFER-AMOUNT
S16997         MOVE WA-SOUR-GL-CLASS-CODE    TO JNRST-GL-CLASS-CODE
S16997         IF WA-17003-CORR-TRAN-CD <> 17103
S16997            MOVE 13530                 TO JNRST-TRAN-CODE
S16997                                          LINK-IN-TXCODE
S16997         ELSE
S16997            COMPUTE WA-GLCC-XFER-AMOUNT = WA-GLCC-XFER-AMOUNT
S16997                                        * -1
S16997            MOVE WA-DEST-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
S16997            MOVE 13630                 TO JNRST-TRAN-CODE
S16997                                          LINK-IN-TXCODE
S16997         END-IF
S16997         PERFORM WRITE-TO-JOURNAL-PROCESS
S16997                 THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S16997     END-IF.
S16997     IF  NOT WA-ACT-TYPE-790
S16997     AND WA-NON-TAX-AMT <> 0
S16997         MOVE WA-NON-TAX-AMT TO WA-GLCC-XFER-AMOUNT
S16997         MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
S16997         MOVE WA-DEST-GL-CLASS-CODE TO
S16997                                JNRST-XFER-GL-CLASS-CODE
S16997         MOVE 13531                 TO JNRST-TRAN-CODE
S16997                                       LINK-IN-TXCODE
S16997         IF WA-17003-CORR-TRAN-CD = 17103
S16997            COMPUTE WA-GLCC-XFER-AMOUNT =
S16997                    WA-GLCC-XFER-AMOUNT * -1
S16997         END-IF
S16997         PERFORM WRITE-TO-JOURNAL-PROCESS
S16997                 THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S16997     END-IF.
S11555*
S11555     IF WA-ACT-TYPE-790
S11555       MOVE 0                   TO WA-GL-INDX
S11555       PERFORM VARYING WA-GL-INDX FROM 1 BY 1
S11555         UNTIL WA-GL-INDX > 5
S11555         IF (UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "P" OR "I")
S11555         AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
S11555            IF WA-17003-CORR-TRAN-CD <> 17103
S11555               MOVE BORP-CGL-COMPONENT-1-DR
S11555                   TO UT0099CA-COMPONENT-1
S11555               MOVE BORP-CGL-COMPONENT-2-DR
S11555                   TO UT0099CA-COMPONENT-2
S11555               PERFORM NPL-BUILD-CGL THRU
S11555                       NPL-BUILD-CGL-EXIT
S11555               MOVE UT0099CA-GLCC-OUTPUT-KEY
S11555                   TO JNRST-GL-CLASS-CODE
S11555                      WA-SOUR-GL-CLASS-CODE
S11555               MOVE 98931   TO JNRST-TRAN-CODE
S11555                               LINK-IN-TXCODE
S11555                              STRT-AREA-TRN-NO
S11555               PERFORM X700-CALL-UT0250 THRU
S11555                       X799-EXIT
S11555               IF WA-MSG-ERR-FLAG = 1
S15728                  GO TO NPL-TO-BAD-DEBT-PROCESS-EXIT
S15728*S11555                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11555               ELSE
S11555                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11555                  MOVE LINK-SIGN TO STRT-AREA-SIGN
S11555               END-IF
S11555               PERFORM X720-CALL-UT0251 THRU 
S11555                       X729-EXIT
S11555               IF WA-MSG-ERR-FLAG NOT =  0
S15728                  GO TO NPL-TO-BAD-DEBT-PROCESS-EXIT
S15728*S11555                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11555               END-IF
S11555               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11555                      UT0099CA-COMPONENT-1
S11555               PERFORM NPL-BUILD-CGL THRU
S11555                       NPL-BUILD-CGL-EXIT
S11555               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11555                      JNRST-XFER-GL-CLASS-CODE
S11555                      WA-DEST-GL-CLASS-CODE
S11555               MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) TO
S11555                      WA-GLCC-XFER-AMOUNT
S11555               PERFORM WRITE-TO-JOURNAL-PROCESS
S11555                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11555               MOVE 17003            TO STRT-AREA-TRN-NO
S11555            ELSE
S11555               MOVE BORP-CGL-COMPONENT-1-DR
S11555                      TO UT0099CA-COMPONENT-1
S11555               MOVE BORP-CGL-COMPONENT-2-DR
S11555                      TO UT0099CA-COMPONENT-2
S11555               PERFORM NPL-BUILD-CGL THRU
S11555                      NPL-BUILD-CGL-EXIT
S11555               MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S11555                      JNRST-GL-CLASS-CODE
S11555                      WA-SOUR-GL-CLASS-CODE
S11555               MOVE 98931         TO JNRST-TRAN-CODE
S11555                                     LINK-IN-TXCODE
S11555                                     STRT-AREA-TRN-NO
S11555               PERFORM X700-CALL-UT0250 THRU X799-EXIT
S11555               IF WA-MSG-ERR-FLAG = 1
S15728                  GO TO NPL-TO-BAD-DEBT-PROCESS-EXIT
S15728*S11555                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11555               ELSE
S11555                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11555                  MOVE LINK-SIGN       TO STRT-AREA-SIGN
S11555               END-IF
S11555               PERFORM X720-CALL-UT0251 THRU X729-EXIT
S11555               IF WA-MSG-ERR-FLAG NOT =  0
S15728                  GO TO NPL-TO-BAD-DEBT-PROCESS-EXIT
S15728*S11555                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11555               END-IF
S11555               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11555                      UT0099CA-COMPONENT-1
S11555               PERFORM NPL-BUILD-CGL THRU
S11555                      NPL-BUILD-CGL-EXIT
S11555               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11555                      JNRST-XFER-GL-CLASS-CODE
S11555                      WA-DEST-GL-CLASS-CODE
S11555               COMPUTE WA-GLCC-XFER-AMOUNT = 
S11555                    UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) * (-1)
S11555               PERFORM WRITE-TO-JOURNAL-PROCESS
S11555                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11555               MOVE 17003            TO STRT-AREA-TRN-NO
S11555            END-IF
S11555         END-IF
S11555       END-PERFORM
S11555     END-IF.
S11555*
TB0211 NPL-TO-BAD-DEBT-PROCESS-EXIT.
TB0211     EXIT.
SC4071 FULL-BAD-DEBT-GLIF.
SC4071     IF WA-17003-CORR-TRAN-CD <> 17103
S15998*SC7866        IF BOIS-921-FLAG > 0
S15998*SC7866           MOVE BORP-921-L-CGL-1 TO UT0099CA-COMPONENT-1
S15998*SC7866           MOVE BORP-921-L-CGL-2 TO UT0099CA-COMPONENT-2
S15998*SC7866        ELSE
SC4071        MOVE BORP-NON-CGL-COMPONENT-1
SC4071                       TO UT0099CA-COMPONENT-1
SC4071        MOVE BORP-NON-CGL-COMPONENT-2
SC4071                       TO UT0099CA-COMPONENT-2
S15998*SC7866        END-IF
SC4071
SC4071        PERFORM NPL-BUILD-CGL THRU
SC4071                NPL-BUILD-CGL-EXIT
SC4071
SC4071        MOVE UT0099CA-GLCC-OUTPUT-KEY
SC4071                       TO WA-SOUR-GL-CLASS-CODE
SC4071        MOVE BORM-GL-CLASSIFICATION-CODE
SC4071                       TO WA-DEST-GL-CLASS-CODE
SC4071     ELSE
SC5014        MOVE BORP-BAD-D-CGL-1
SC5014                       TO UT0099CA-COMPONENT-1
SC5014        MOVE BORP-BAD-D-CGL-2
SC5014                       TO UT0099CA-COMPONENT-2
SC4071
SC4071        PERFORM NPL-BUILD-CGL THRU
SC4071                NPL-BUILD-CGL-EXIT
SC4071
SC4071        MOVE BORM-GL-CLASSIFICATION-CODE
SC4071                       TO WA-SOUR-GL-CLASS-CODE
SC4071        MOVE UT0099CA-GLCC-OUTPUT-KEY
SC4071                       TO WA-DEST-GL-CLASS-CODE
SC4071     END-IF
S16503     IF BORP-RENEW
S16503     AND BORM-SPL-LOAN-CDE    =  "4"
S16503     AND BOIS-FIRST-ADV-DATE  =  STRT-AREA-POST-DT
S16503         PERFORM X900-READ-RENB-RTN THRU X900-EXIT
S16503         IF DBIOMOD-STAT      =  "****"
S16503         AND RENB-SEP-IND     =  "3"
S17306             MOVE 18407      TO UT0145CA-CALL-TRAN
S16503             PERFORM X910-REPL-COMPONENT THRU X910-EXIT
S16503         END-IF
S16503     END-IF
SC4071     MOVE 0                   TO WA-GL-INDX.
SC4071     PERFORM
SC4071       VARYING WA-GL-INDX FROM 1 BY 1
SC4071       UNTIL WA-GL-INDX > 5
SC4071         IF (UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "P" OR "I")
SC4071            AND (UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0)
SC4071            MOVE WA-SOUR-GL-CLASS-CODE TO
SC4071                                JNRST-GL-CLASS-CODE
SC4071            MOVE WA-DEST-GL-CLASS-CODE TO
SC4071                                JNRST-XFER-GL-CLASS-CODE
SC5173            IF WA-17003-CORR-TRAN-CD = 17103
SC5173               COMPUTE WA-GLCC-XFER-AMOUNT =
SC5173                      UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) * -1
SC5173            ELSE
SC4071               MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
SC4071                              TO WA-GLCC-XFER-AMOUNT
SC5173            END-IF
S16997            IF  UT0073CA-GL-BUCKET-CDE (WA-GL-INDX) = "I"
S16997                ADD  UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
S16997                                         TO WA-NON-TAX-AMT
S16997                MOVE WA-GLCC-XFER-AMOUNT TO WA-INT-DUE-14
S16997            END-IF
SC4071            MOVE 98924           TO JNRST-TRAN-CODE
SC4071                                  LINK-IN-TXCODE
SC4071            PERFORM WRITE-TO-JOURNAL-PROCESS
SC4071               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
SC4071         END-IF
SC4071         IF (UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "L" OR "R")
SC4071            AND (UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0)
SC4071            MOVE WA-SOUR-GL-CLASS-CODE TO
SC4071                                JNRST-GL-CLASS-CODE
SC4071            MOVE WA-DEST-GL-CLASS-CODE TO
SC4071                                JNRST-XFER-GL-CLASS-CODE
SC5173            IF WA-17003-CORR-TRAN-CD <> 17103
SC5173               COMPUTE WA-GLCC-XFER-AMOUNT =
SC5173                      UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) * -1
SC5173            ELSE
SC4071               MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
SC4071                              TO WA-GLCC-XFER-AMOUNT
SC5173            END-IF
SC5173            IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "L"
SC5173                MOVE 98922        TO JNRST-TRAN-CODE
SC5173                                      LINK-IN-TXCODE
SC5173            ELSE
SC5173                MOVE 98925        TO JNRST-TRAN-CODE
SC5173                                      LINK-IN-TXCODE
S16997                ADD  UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
S16997                                        TO WA-NON-TAX-AMT
SC5173            END-IF
SC4071            PERFORM WRITE-TO-JOURNAL-PROCESS
SC4071               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
SC4071         END-IF
SC4071         IF (UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "X" OR "T")
SC4071            AND (UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0)
SC4071            MOVE WA-SOUR-GL-CLASS-CODE TO
SC4071                                JNRST-GL-CLASS-CODE
SC4071            MOVE WA-DEST-GL-CLASS-CODE TO
SC4071                                JNRST-XFER-GL-CLASS-CODE
SC5173            IF WA-17003-CORR-TRAN-CD <> 17103
SC5173               COMPUTE WA-GLCC-XFER-AMOUNT =
SC5173                      UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) * -1
SC5173            ELSE
SC4071               MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX)
SC4071                              TO WA-GLCC-XFER-AMOUNT
SC5173            END-IF
SC5173            IF UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "X"
SC5173                MOVE 98923        TO JNRST-TRAN-CODE
SC5173                                      LINK-IN-TXCODE
SC5173            ELSE
SC5173                MOVE 98926        TO JNRST-TRAN-CODE
SC5173                                      LINK-IN-TXCODE
SC5173            END-IF
SC4071            PERFORM WRITE-TO-JOURNAL-PROCESS
SC4071               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
SC4071         END-IF
SC4071     END-PERFORM.
S16997     IF  NOT WA-ACT-TYPE-790
S16997     AND WA-INT-DUE-14  <> 0
S16997         MOVE WA-INT-DUE-14  TO WA-GLCC-XFER-AMOUNT
S16997         MOVE WA-SOUR-GL-CLASS-CODE    TO JNRST-GL-CLASS-CODE
S16997         IF WA-17003-CORR-TRAN-CD <> 17103
S16997            MOVE 13530                 TO JNRST-TRAN-CODE
S16997                                          LINK-IN-TXCODE
S16997         ELSE
S16997            MOVE 13630                 TO JNRST-TRAN-CODE
S16997                                          LINK-IN-TXCODE
S16997         END-IF
S16997         PERFORM WRITE-TO-JOURNAL-PROCESS
S16997                 THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S16997     END-IF.
S16997     IF  NOT WA-ACT-TYPE-790
S16997     AND WA-NON-TAX-AMT <> 0
S16997
S16997         MOVE WA-NON-TAX-AMT TO WA-GLCC-XFER-AMOUNT
S16997         MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE
S16997         MOVE WA-DEST-GL-CLASS-CODE TO
S16997                                JNRST-XFER-GL-CLASS-CODE
S16997         MOVE 13531                 TO JNRST-TRAN-CODE
S16997                                       LINK-IN-TXCODE
S16997         IF WA-17003-CORR-TRAN-CD = 17103
S16997            COMPUTE WA-GLCC-XFER-AMOUNT =
S16997                    WA-GLCC-XFER-AMOUNT * -1
S16997         END-IF
S16997         PERFORM WRITE-TO-JOURNAL-PROCESS
S16997                 THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S16997     END-IF.
S11555*
S11555     IF WA-ACT-TYPE-790
S11555       MOVE 0                   TO WA-GL-INDX
S11555       PERFORM VARYING WA-GL-INDX FROM 1 BY 1
S11555         UNTIL WA-GL-INDX > 5
S11555         IF (UT0073CA-GL-BUCKET-CDE(WA-GL-INDX) = "P" OR "I")
S11555         AND UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) <> 0
S11555            IF WA-17003-CORR-TRAN-CD <> 17103
S11555               MOVE BORP-CGL-COMPONENT-1-DR
S11555                   TO UT0099CA-COMPONENT-1
S11555               MOVE BORP-CGL-COMPONENT-2-DR
S11555                   TO UT0099CA-COMPONENT-2
S11555               PERFORM NPL-BUILD-CGL THRU
S11555                       NPL-BUILD-CGL-EXIT
S11555               MOVE UT0099CA-GLCC-OUTPUT-KEY
S11555                   TO JNRST-GL-CLASS-CODE
S11555                      WA-SOUR-GL-CLASS-CODE
S11555               MOVE 98931   TO JNRST-TRAN-CODE
S11555                               LINK-IN-TXCODE
S11555                              STRT-AREA-TRN-NO
S11555               PERFORM X700-CALL-UT0250 THRU
S11555                       X799-EXIT
S11555               IF WA-MSG-ERR-FLAG = 1
S15728                  GO TO FULL-BAD-DEBT-GLIF-EXIT
S15728*S11555                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11555               ELSE
S11555                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11555                  MOVE LINK-SIGN TO STRT-AREA-SIGN
S11555               END-IF
S11555               PERFORM X720-CALL-UT0251 THRU 
S11555                       X729-EXIT
S11555               IF WA-MSG-ERR-FLAG NOT =  0
S15728                  GO TO FULL-BAD-DEBT-GLIF-EXIT
S15728*S11555                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11555               END-IF
S11555               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11555                      UT0099CA-COMPONENT-1
S11555               PERFORM NPL-BUILD-CGL THRU
S11555                       NPL-BUILD-CGL-EXIT
S11555               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11555                      JNRST-XFER-GL-CLASS-CODE
S11555                      WA-DEST-GL-CLASS-CODE
S11555               MOVE UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) TO
S11555                      WA-GLCC-XFER-AMOUNT
S11555               PERFORM WRITE-TO-JOURNAL-PROCESS
S11555                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11555               MOVE 17003            TO STRT-AREA-TRN-NO
S11555            ELSE
S11555               MOVE BORP-CGL-COMPONENT-1-DR
S11555                      TO UT0099CA-COMPONENT-1
S11555               MOVE BORP-CGL-COMPONENT-2-DR
S11555                      TO UT0099CA-COMPONENT-2
S11555               PERFORM NPL-BUILD-CGL THRU
S11555                      NPL-BUILD-CGL-EXIT
S11555               MOVE UT0099CA-GLCC-OUTPUT-KEY TO
S11555                      JNRST-GL-CLASS-CODE
S11555                      WA-SOUR-GL-CLASS-CODE
S11555               MOVE 98931         TO JNRST-TRAN-CODE
S11555                                     LINK-IN-TXCODE
S11555                                     STRT-AREA-TRN-NO
S11555               PERFORM X700-CALL-UT0250 THRU X799-EXIT
S11555               IF WA-MSG-ERR-FLAG = 1
S15728                  GO TO FULL-BAD-DEBT-GLIF-EXIT
S15728*S11555                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11555               ELSE
S11555                  MOVE LINK-EDIT-TABLE TO JNRST-EDIT-MASK
S11555                  MOVE LINK-SIGN       TO STRT-AREA-SIGN
S11555               END-IF
S11555               PERFORM X720-CALL-UT0251 THRU X729-EXIT
S11555               IF WA-MSG-ERR-FLAG NOT =  0
S15728                  GO TO FULL-BAD-DEBT-GLIF-EXIT
S15728*S11555                  GO TO NORMAL-TO-NPL-PROCESS-EXIT
S11555               END-IF
S11555               MOVE UT0251RA-CGL-COMPONENT-1-SB TO
S11555                      UT0099CA-COMPONENT-1
S11555               PERFORM NPL-BUILD-CGL THRU
S11555                      NPL-BUILD-CGL-EXIT
S11555               MOVE UT0099CA-GLCC-OUTPUT-KEY  TO
S11555                      JNRST-XFER-GL-CLASS-CODE
S11555                      WA-DEST-GL-CLASS-CODE
S11555               COMPUTE WA-GLCC-XFER-AMOUNT = 
S11555                    UT0073CA-GL-BUCKET-DUE(WA-GL-INDX) * (-1)
S11555               PERFORM WRITE-TO-JOURNAL-PROCESS
S11555                      THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11555               MOVE 17003            TO STRT-AREA-TRN-NO
S11555            END-IF
S11555         END-IF
S11555       END-PERFORM
S11555     END-IF.
S11555*
SC4071 FULL-BAD-DEBT-GLIF-EXIT.
SC4071     EXIT.
S11659 COUNTERFEIT-GLIF.
S11659     IF WA-17003-CORR-TRAN-CD <> 17103
S15998*S11659        IF BOIS-921-FLAG > 0
S15998*S11659           MOVE BORP-921-L-CGL-1 TO UT0099CA-COMPONENT-1
S15998*S11659           MOVE BORP-921-L-CGL-2 TO UT0099CA-COMPONENT-2
S15998*S11659        ELSE
S11659           MOVE BORP-BAD-D-CGL-1 TO UT0099CA-COMPONENT-1
S11659           MOVE BORP-BAD-D-CGL-2 TO UT0099CA-COMPONENT-2
S15998*S11659        END-IF
S11659        PERFORM NPL-BUILD-CGL THRU
S11659                NPL-BUILD-CGL-EXIT
S11659        MOVE UT0099CA-GLCC-OUTPUT-KEY
S11659                       TO WA-SOUR-GL-CLASS-CODE
S11659        MOVE BORM-GL-CLASSIFICATION-CODE
S11659                       TO WA-DEST-GL-CLASS-CODE
S11659     ELSE
S11659        MOVE BORP-COUNTERFEIT-CGL-1
S11659                       TO UT0099CA-COMPONENT-1
S11659        MOVE BORP-COUNTERFEIT-CGL-2
S11659                       TO UT0099CA-COMPONENT-2
S11659        PERFORM NPL-BUILD-CGL THRU
S11659                NPL-BUILD-CGL-EXIT
S11659        MOVE BORM-GL-CLASSIFICATION-CODE
S11659                       TO WA-SOUR-GL-CLASS-CODE
S11659        MOVE UT0099CA-GLCC-OUTPUT-KEY
S11659                       TO WA-DEST-GL-CLASS-CODE
S11659     END-IF
S11659     MOVE 0                   TO WA-GL-INDX.
S11659     PERFORM
S11659       VARYING WA-GL-INDX FROM 1 BY 1
S11659       UNTIL WA-GL-INDX > 5
S11659         IF (BOIS-GL-BUCKET-CDE(WA-GL-INDX) = "I" OR "P" OR "B")
S11659         AND (BOIS-GL-BUCKET-DUE(WA-GL-INDX) <> 0)
S11659            MOVE WA-SOUR-GL-CLASS-CODE TO
S11659                                JNRST-GL-CLASS-CODE
S11659            MOVE WA-DEST-GL-CLASS-CODE TO
S11659                                JNRST-XFER-GL-CLASS-CODE
S11659            IF WA-17003-CORR-TRAN-CD = 17103
S11659               COMPUTE WA-GLCC-XFER-AMOUNT =
S11659                      BOIS-GL-BUCKET-DUE(WA-GL-INDX) * -1
S11659            ELSE
S11659               MOVE BOIS-GL-BUCKET-DUE(WA-GL-INDX)
S11659                              TO WA-GLCC-XFER-AMOUNT
S11659            END-IF
S11659            MOVE 98924           TO JNRST-TRAN-CODE
S11659                                  LINK-IN-TXCODE
S11659            PERFORM WRITE-TO-JOURNAL-PROCESS
S11659               THRU WRITE-TO-JOURNAL-PROCESS-EXIT
S11659         END-IF
S11659     END-PERFORM.
S11659 COUNTERFEIT-GLIF-EXIT.
S11659     EXIT.
TB0211
TB0211 CORRECTION-PROCESS.
TB0211     PERFORM X720-CALL-UT0251
TB0211        THRU X729-EXIT.
TB0211
TB0211     IF WA-MSG-ERR-FLAG NOT =  0
TB0211        GO TO CORRECTION-PROCESS-EXIT
TB0211     END-IF.
TB0211
TB0211*--- for normal correction
TB0211     IF BORM-BAD-DEBT-IND = 0
TB0211        MOVE BORM-GL-CLASSIFICATION-CODE
TB0211                             TO WA-SOUR-GL-CLASS-CODE
TB0211        MOVE SPACES          TO WA-DEST-GL-CLASS-CODE
TB0211     END-IF.
TB0211*--- for npl correction
TB0211     IF BORM-BAD-DEBT-IND = 52
TB0211        MOVE 0               TO WA-GL-INDX
TB0211        PERFORM
TB0211          VARYING WA-GL-INDX FROM 1 BY 1
TB0211            UNTIL WA-GL-INDX > 5
TB0211          IF BOIS-GL-BUCKET-CDE(WA-GL-INDX) = "P"
TB0211             MOVE BOIS-GL-BUCKET-DUE(WA-GL-INDX)
TB0211                             TO WA-GLCC-XFER-AMOUNT
TB0211          END-IF
TB0211        END-PERFORM
TB0211        MOVE UT0251RA-CGL-COMPONENT-1-SB
TB0211                             TO WA-SOUR-GL-CLASS-CODE
TB0211        MOVE BORP-NON-CGL-COMPONENT-1
TB0211                             TO WA-DEST-GL-CLASS-CODE
TB0211     END-IF.
TB0211*--- for bad debt correction
TB0211     IF BORM-BAD-DEBT-IND = 53 OR 54
TB0211        MOVE 0               TO WA-GL-INDX
TB0211        PERFORM
TB0211          VARYING WA-GL-INDX FROM 1 BY 1
TB0211            UNTIL WA-GL-INDX > 5
TB0211          IF BOIS-GL-BUCKET-CDE(WA-GL-INDX) = "B"
TB0211             MOVE BOIS-GL-BUCKET-DUE(WA-GL-INDX)
TB0211                             TO WA-GLCC-XFER-AMOUNT
TB0211          END-IF
TB0211        END-PERFORM
TB0211        MOVE UT0251RA-CGL-COMPONENT-1-SB
TB0211                             TO WA-SOUR-GL-CLASS-CODE
TB0211        MOVE BORP-BAD-D-CGL-1
TB0211                             TO WA-DEST-GL-CLASS-CODE
TB0211     END-IF.
TB0211 CORRECTION-PROCESS-EXIT.
TB0211     EXIT.
TB0211
TB0211 WRITE-TO-JOURNAL-PROCESS.
S15799* // DR/CR SAME GLCLASS STILL WRITE TO JRNL
S15799*TB0211     IF WA-SOUR-GL-CLASS-CODE = WA-DEST-GL-CLASS-CODE
S15799*TB0211        GO TO WRITE-TO-JOURNAL-PROCESS-EXIT
S15799*TB0211     END-IF.
TB0211
TB0211*SC4696  IF WA-GLCC-XFER-AMOUNT <  0
TB0211*SC4696 GO TO WRITE-TO-JOURNAL-PROCESS-EXIT
TB0211*SC4696 END-IF.
TB0211
TB0211*    INITIALIZE JNRST-DB-DATA
TB0211*     MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE.
TB0211*    MOVE WA-DEST-GL-CLASS-CODE TO JNRST-XFER-GL-CLASS-CODE.
TB0211     MOVE BORP-CGL-POSTING-IND  TO JNRST-CGL-POSTING-IND.
TB0211     MOVE "BOR"                 TO JNRST-SYST.
TB0211     MOVE STRT-AREA-MSG-TIME    TO JNRST-TIME.
TB0211     MOVE STRT-AREA-SOC-NO      TO JNRST-SOC.
TB0211     MOVE BOIS-MEMB-CUST-AC     TO JNRST-CUSM-NO.
TB0211     MOVE STRT-AREA-BRANCH      TO JNRST-BRCH.
TB0211     MOVE 00                    TO JNRST-TRN-TYP.
TB0211     MOVE STRT-AREA-TERM-NO     TO JNRST-TERMNL.
TB0211     MOVE STRT-AREA-TELL-NO     TO JNRST-TELLER.
TB0211*SC2263     MOVE STRT-AREA-TRN-NO      TO JNRST-TRAN-CODE
TB0211*SC2263                            LINK-IN-TXCODE.
SC2263*     MOVE 98904                 TO JNRST-TRAN-CODE
SC2263*                                    LINK-IN-TXCODE.
TB0211     PERFORM X700-CALL-UT0250
TB0211        THRU X799-EXIT.
TB0211
TB0211     IF WA-MSG-ERR-FLAG NOT =  0
TB0211        GO TO WRITE-TO-JOURNAL-PROCESS-EXIT
TB0211     END-IF.
TB0211
TB0211     MOVE LINK-EDIT-TABLE       TO JNRST-EDIT-MASK.
TB0211     MOVE BORM-CURRENCY-IND     TO JNRST-CURRENCY-CODE.
TB0211     MOVE STRT-AREA-POST-DT     TO JNRST-POST-DATE.
TB0211     MOVE STRT-AREA-POST-DT     TO JNRST-TRAN-DATE.
TB0211     MOVE STRT-AREA-JRNL-NO     TO JNRST-JRNL-NO.
TB0211     MOVE BORM-BR-NO            TO JNRST-HOME-BRNCH.
TB0211     MOVE BORM-ACT-TYPE         TO JNRST-ACC-TYPE.
TB0211     MOVE BORM-CAT              TO JNRST-INT-CAT.
TB0211*--- MOVE WA-GLCC-XFER-AMOUNT   TO JNRST-BALANCE
TB0211*---                               JNRST-AMOUNT.
TB0211*SC2263    MOVE WA-GLCC-XFER-AMOUNT   TO JNRST-TO-CURR-AMOUNT.
SC2263     MOVE WA-GLCC-XFER-AMOUNT   TO JNRST-AMOUNT.
SC9862     COMPUTE WA-ROUND-AMNT-0 ROUNDED = WA-GLCC-XFER-AMOUNT.
SC9862     MOVE WA-ROUND-AMNT-0       TO JNRST-AMOUNT.
TB0211     MOVE BORM-CURRENCY-IND     TO JNRST-FROM-CURRENCY-CODE
TB0211                                   JNRST-TO-CURRENCY-CODE.
TB0211     MOVE 1                     TO JNRST-FLAG.
TB0211     MOVE ZEROES                TO JNRST-NEW-ACC-FLG
TB0211                                   JNRST-LIM-TOL-FLAG
TB0211                                   JNRST-BOR-GROUP.
TB0211     MOVE SPACES                TO JNRST-ATM-SAF-FLAG.
TB0211
TB0211*--- GET BASE CURRENCY EQUIVALENT FOR ACCOUNT BALANCE
TB0211     IF BORM-CURRENCY-IND NOT = SOC-NATIVE-CURRENCY
TB0211        MOVE UT0296-CALL-AREA         TO WA-SAVE-UT0296CA-AREA
TB0211        MOVE 3                        TO UT0296CA-CALL-CODE
TB0211        MOVE "LON"                    TO UT0296CA-SYSTEM
TB0211        MOVE BORM-CURRENCY-IND        TO UT0296CA-FROM-CURRENCY
TB0211                                         UT0296CA-TO-CURRENCY
TB0211        MOVE WA-GLCC-XFER-AMOUNT      TO UT0296CA-FROM-AMOUNT
TB0211                                         UT0296CA-TO-AMOUNT
TB0211        MOVE "ZZZZ"    TO UT0296CA-RATE-VERSION
TB0211        MOVE 01        TO UT0296CA-RATE-TYPE
TB0211        MOVE SPACES    TO UT0296CA-USER-CODES-LON
TB0211        MOVE ZEROES    TO UT0296CA-COMMISSION
TB0211                          UT0296CA-CHANGE
TB0211                          UT0296CA-BACKDATED-DATE
TB0211                          UT0296CA-FROM-BASE-EQUIVALENT
TB0211        INITIALIZE        UT0296CA-MULTI-FROM-AMOUNTS
TB0211        CALL "UT0296" USING
TB0211                          UT0296-CALL-AREA
TB0211                          STRT-AREA-DATA
TB0211                          SOC-PARAMS
TB0211
TB0211        IF UT0296CA-CALL-STATUS NOT = 0
TB0211           MOVE UT0296CA-CALL-STATUS  TO WA-OUTPUT-ERR-MSG-NO
TB0211           MOVE 1                     TO WA-MSG-ERR-FLAG
TB0211           GO TO WRITE-TO-JOURNAL-PROCESS-EXIT
TB0211        END-IF
TB0211
TB0211        MOVE UT0296RA-FROM-RATE       TO JNRST-FROM-CURRENCY-RATE
TB0211        MOVE UT0296RA-EQUIV-BASE-AMOUNT TO
TB0211                                       JNRST-FROM-BASE-EQUIVALENT
TB0211                                       JNRST-TO-BASE-EQUIVALENT
TB0211        MOVE UT0296CA-RATE-TYPE       TO JNRST-RATE-TYPE
TB0211        MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
TB0211                                         JNRST-TO-CURRENCY-CODE
TB0211     END-IF.
TB0211*--- MOVE SAVED UT0296 AREA BACK TO ORIGINAL BUFFER.
TB0211     MOVE WA-SAVE-UT0296CA-AREA       TO UT0296-CALL-AREA.
TB0211
TB0211     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
TB0211
TB0211 WRITE-TO-JOURNAL-PROCESS-EXIT.
TB0211     EXIT.
TB0211
TB0198 AGREE-INSTALL-VALIDATION.
SC3673*    DISPLAY "AGREE-INSTALL-VALIDATION."
SC9299*** Do not validate prin credit transactions here.
SC9299     IF STRT-AREA-TRN-NO = 13031 OR 11044 OR 11048
SC9299                        OR 13131 OR 11144 OR 11148
SC9299*S12384                 OR 16030 OR 16044 OR 16048
S12384                        OR 16044 OR 16048
S10542                        OR 16144 OR 16148
S11617                        OR 16129
S17282                        OR 16102
SC9299*S10542                 OR 16130 OR 16144 OR 16148
SC9299        GO TO AGREE-INSTALL-VALIDATION-EXIT       
SC9299     END-IF.
SC9299                                                  
SC3429     IF BOIS-LAST-TERM-PAID < (BORM-LOAN-TRM - BORM-REM-REPAYS)
SC3429       OR BOIS-ARREARS-CTR  > 0                                
SC3429        GO TO AGREE-INSTALL-VALIDATION-EXIT                    
SC3429     END-IF.                                                   
SC3429                                                               
TB0198     MOVE "N"                    TO WA-REPAY-NN-FOUND-FLAG.    
TB0198
TB0198     MOVE WA-REPAY-TXN-DATE      TO UT0030-DATE-DDMMCCYY.
TB0198     CALL "UT0030" USING  UT0030-FUNCTION
TB0198                                  UT0030-DATE-AREA
TB0198                                  UT0030-BINARY-DATE.
TB0198     MOVE UT0030-BINARY-DATE TO WA-AGREE-REPAY-DT-BIN.
SC3673
SC3673     IF UT0030-BINARY-DATE = 0
SC3673        MOVE STRT-AREA-POST-DT   TO WA-AGREE-REPAY-DT-BIN
SC3673     END-IF.
TB0198
TB0198     MOVE "NN"              TO DBIO-CALL-TXN-TYPE-AREA.
TB0198     MOVE 0                 TO DBIO-CALL-REFER-AREA.
TB0198
TB0198     PERFORM GET-NEXT-DUE-AMT
TB0198        THRU GET-NEXT-DUE-AMT-EXIT.
TB0198
TB0198     IF WA-MSG-ERR-FLAG NOT = 0
TB0198        GO TO AGREE-INSTALL-VALIDATION-EXIT
TB0198     END-IF.
TB0198
TB0198*    IF NOT WA-REPAY-NN-FOUND
TB0198*       MOVE 2801 TO WA-OUTPUT-ERR-MSG-NO
TB0198*       MOVE 1 TO WA-MSG-ERR-FLAG
TB0198*       GO TO AGREE-INSTALL-VALIDATION-EXIT
TB0198*    END-IF.
TB0198
SC3673*    IF UT0312CA-NEGO-REPAY-TYPE = "I" AND
SC3673*     UT0312CA-IRREGULAR-REPAY-AMT = 0
SC5028    IF UT0312CA-NEGO-REPAY-TYPE = "I"
SC3673        PERFORM ZZ001-CALL-UT0075
SC3673           THRU ZZ001-EXIT
SC3673
SC3673        IF WA-MSG-ERR-FLAG NOT = 0
SC3673           GO TO AGREE-INSTALL-VALIDATION-EXIT
SC3673        END-IF
SC3673
SC5028        COMPUTE WA-NEW-DUE-AMT    = UT0075CA-INTEREST-DUE
SC5028                                  + UT0312CA-IRREGULAR-PREV-REPAY
SC5028                                  + UT0312CA-IRREGULAR-REPAY-AMT
SC3673*       IF (UT0075CA-INTEREST-DUE + UT0312CA-IRREGULAR-PREV-REPAY)
SC5028**       NOT EQUAL WA-REPAY-AMOUNT
SC5028        IF  WA-NEW-DUE-AMT    NOT = WA-REPAY-AMOUNT
SC3673           MOVE 2802 TO WA-OUTPUT-ERR-MSG-NO
SC3673           MOVE 1 TO WA-MSG-ERR-FLAG
SC3673           GO TO AGREE-INSTALL-VALIDATION-EXIT
SC3673        END-IF
SC3673     ELSE
SC3673**** Reallign codes for condition.
TB0198        IF (UT0312CA-IRREGULAR-REPAY-AMT + 
TB0198         UT0312CA-IRREGULAR-PREV-REPAY)
TB0198         NOT = WA-REPAY-AMOUNT 
S16269           COMPUTE WA-CALC-DUE-AMT = UT0312CA-IRREGULAR-REPAY-AMT
S16269                              + UT0312CA-IRREGULAR-PREV-REPAY
S16269           IF ( BORP-MAX-REPAY-AMT-PC = 0 )
S16269                MOVE WA-CALC-DUE-AMT TO WA-WORK-MAX-AMT
S16269           ELSE
S16269                COMPUTE WA-WORK-MAX-AMT ROUNDED =
S16269                     WA-CALC-DUE-AMT * BORP-MAX-REPAY-AMT-PC
S16269           END-IF
S16269           IF ( BORP-MIN-REPAY-AMT-PC = 0 )
S16269                MOVE WA-CALC-DUE-AMT TO WA-WORK-MIN-AMT
S16269           ELSE
S16269                COMPUTE WA-WORK-MIN-AMT ROUNDED =
S16269                     WA-CALC-DUE-AMT * BORP-MIN-REPAY-AMT-PC
S16269           END-IF
S16269           IF ( WA-REPAY-AMOUNT < WA-WORK-MIN-AMT )
S16269            IF (BORP-RECEIVABLE-YES)
S18530            AND NOT ((STRT-AREA-TRN-NO = 11030 OR 16030) AND
S18530                      WA-REPAY-PROMO = 'BA')
S16269                MOVE "Y"        TO WA-REPAY-PRN-RECALC
S16269                GO              TO AGREE-INSTALL-VALIDATION-EXIT
S16269            END-IF
S16269           END-IF
S16269           IF ( WA-REPAY-AMOUNT > WA-WORK-MAX-AMT )
S16269            IF (BORP-RECEIVABLE-YES)
S18530            AND NOT ((STRT-AREA-TRN-NO = 11030 OR 16030) AND
S18530                      WA-REPAY-PROMO = 'BA')
S16269                MOVE "Y"        TO WA-REPAY-PRN-RECALC
S16269                GO              TO AGREE-INSTALL-VALIDATION-EXIT
S16269            END-IF
S16269           END-IF
S16269*S15871           IF BORP-RECEIVABLE-YES
S16269*S15871              MOVE "Y" TO WA-REPAY-PRN-RECALC
S16269*S15871              GO       TO AGREE-INSTALL-VALIDATION-EXIT
S16269*S15871           END-IF
S16269          IF NOT (BOIS-AGREE-CONFER)
TB0198           MOVE 2802 TO WA-OUTPUT-ERR-MSG-NO
TB0198           MOVE 1 TO WA-MSG-ERR-FLAG
TB0198           GO TO AGREE-INSTALL-VALIDATION-EXIT
S16269          END-IF
SC3673        END-IF
TB0198     END-IF.
TB0198
TB0198 AGREE-INSTALL-VALIDATION-EXIT.
TB0198     EXIT.
TB0198/
TB0198 GET-NEXT-DUE-AMT.
TB0198*==================
TB0198     INITIALIZE UT0312CA-CALL-PARAMETER
TB0198     MOVE 05                     TO UT0312CA-CALL-CODE.
TB0198
TB0198     IF BOIS-LAST-ADV-PYMT-DATE > STRT-AREA-POST-DT
TB0198        MOVE BOIS-LAST-ADV-PYMT-DATE TO UT0312CA-PREV-DUE-DT
TB0198                                        UT0312CA-EFF-DATE
SC4259**                                      UT0312CA-DUE-STRT-DT
TB0198     ELSE 
TB0198        MOVE STRT-AREA-POST-DT       TO UT0312CA-PREV-DUE-DT
TB0198                                        UT0312CA-EFF-DATE
SC4259**                                      UT0312CA-DUE-STRT-DT
S10970        IF BOIS-LAST-UNPAID-DUE-DATE >  STRT-AREA-POST-DT
S10970           COMPUTE UT0312CA-EFF-DATE =  BOIS-LAST-UNPAID-DUE-DATE
S10970                                     -  1
S10970           MOVE UT0312CA-EFF-DATE    TO UT0312CA-PREV-DUE-DT
S10970        END-IF
TB0198     END-IF.
SC4259     MOVE BORM-DUE-STRT-DATE         TO UT0312CA-DUE-STRT-DT.
TB0198
TB0198     MOVE BORM-REPAY-FREQ        TO UT0312CA-REPAY-FREQ.
TB0198     IF BORM-REPAY-SCHED = SPACE
TB0198        MOVE BORP-REPAY-SCHED    TO UT0312CA-REPAY-SCHED
TB0198     ELSE
TB0198        MOVE BORM-REPAY-SCHED    TO UT0312CA-REPAY-SCHED
TB0198     END-IF.
TB0198
TB0198     MOVE BORM-CAPN-METHOD       TO UT0312CA-CAPN-METHOD.
TB0198     MOVE BORP-ACCRUE-METHOD     TO UT0312CA-ACCRUE-METHOD.
TB0198     MOVE BORM-LOAN-TRM          TO UT0312CA-LOAN-TERM.
TB0198     MOVE BORM-TERM-BASIS        TO UT0312CA-TERM-BASIS.
TB0198     MOVE BORM-REPAY-DAY         TO UT0312CA-REPAY-DAY.
TB0198
TB0198     SET UT0312CA-HOLIDAY-DUE-PREV-WD TO TRUE.
TB0198
TB0198     MOVE BORM-KEY              TO UT0312CA-ACCT-KEY.
TB0198     MOVE BORP-INT-DAYS-YR      TO UT0312CA-INT-NO-DAYS-YR
TB0198
DUEIND     MOVE BOIS-DUE-DTE-IND      TO UT0312CA-1ST-DUE-DTE-IND
TB0198     CALL "UT0312" USING 
TB0198                   UT0312CA-CALL-AREA.
TB0198
TB0198     IF UT0312CA-RET-STATUS NOT = ZERO
TB0198        MOVE 1                   TO WA-MSG-ERR-FLAG
TB0198        MOVE 3026                TO WA-OUTPUT-ERR-MSG-NO 
TB0198        MOVE UT0312CA-RET-STATUS TO WA-OUTPUT-STATUS  
TB0198        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TB0198                                 TO UT8500CA-CALL-CODE
TB0198        MOVE SPACES              TO UT8500CA-INPUT-MSG
TB0198        STRING "BR0000:(GET-NEXT-DUE-AMT) ERROR CALLING UT0312"
TB0198               ", STATUS="  UT0312CA-RET-STATUS
TB0198               DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TB0198        CALL "UT8500"  USING
TB0198                       UT8500CA-AREA
TB0198        GO TO GET-NEXT-DUE-AMT-EXIT
TB0198     END-IF.
TB0198
TB0198 GET-NEXT-DUE-AMT-EXIT.
TB0198*-----------------------
TB0198     EXIT.
TB0198/
SC3429**** BLDVNN                                            
SC3429 GET-NEG-AGREE-DUE.                                    
SC3429     MOVE 0                     TO DBIO-CALL-REFER-AREA
SC3429                                   WA-BLDVNN-SUB       
SC3429                                   WA-AGR-REPAY        
SC3429     MOVE "N"                   TO WA-BLDVNN-FOUND     
SC3429     MOVE BORM-KEY              TO DBIO-CALL-KEY-AREA. 
SC3429     MOVE "BORM"                TO DBIO-CALL-N-SYS.    
SC3429     MOVE "BLDV"                TO DBIO-CALL-SYST-VAR. 
SC3429     MOVE "NN"                  TO DBIO-CALL-CODE-B.   
SC3429     MOVE "BEGN"                TO DBIO-CALL-SAVE-REFER
SC3429     MOVE "****"                TO DBIO-CALL-STATUS    
SC3429     MOVE 61                    TO DBIO-CALL-FUNC      
SC3429                                                       
SC3429     PERFORM AGREE-LOAD-NEG-REPAY                      
SC3429        THRU AGREE-LOAD-NEG-REPAY-EXIT                 
SC3429       UNTIL DBIO-CALL-SAVE-REFER = "END." OR          
SC3429             DBIO-CALL-STATUS NOT = "****" OR          
SC3429             WA-BLDVNN-FOUND = "Y".                    
SC3429                                                       
SC3429 GET-NEG-AGREE-DUE-EXIT.                               
SC3429     EXIT.                                             
SC3429/                                                      
SC3429 AGREE-LOAD-NEG-REPAY.                             
SC3429     CALL "DBIO" USING                             
SC3429                       DBIO-CALL-PARAM             
SC3429                       DBIO-CALL-SYS-AREA          
SC3429                       DBIO-CALL-KEY-AREA          
SC3429                       DBIO-CALL-STATUS            
SC3429                       WS-BLDV-AREA-NN             
SC3429                       DBIO-CALL-REFER-AREA        
SC3429                       DBIO-CALL-TXN-TYPE-AREA.    
SC3429                                                   
SC3429     IF DBIO-CALL-STATUS NOT = "****"              
SC3429       OR DBIO-CALL-SAVE-REFER = "END."            
SC3429         GO TO AGREE-LOAD-NEG-REPAY-EXIT.          
SC3429                                                   
SC3429     PERFORM VARYING WA-BLDVNN-SUB FROM 1 BY 1     
SC3429       UNTIL WA-BLDVNN-SUB > 15                    
SC3429          OR WA-BLDVNN-FOUND = "Y"                 
SC3429                                                   
SC3429        IF  BLDV-NN-START-DATE (WA-BLDVNN-SUB) = 0 
SC3429            MOVE 999999999 TO WA-START-DATE-BIN    
SC3429        ELSE                                       
SC3429            MOVE BLDV-NN-START-DATE (WA-BLDVNN-SUB)
SC3429                 TO WA-START-DATE-BIN              
SC3429        END-IF                                                 
SC3429                                                               
SC3429        IF WA-START-DATE-BIN >= WA-AGREE-REPAY-DT-BIN          
SC3429           IF WA-START-DATE-BIN = WA-AGREE-REPAY-DT-BIN        
SC3429              MOVE BLDV-NN-AGR-REPAYMENT (WA-BLDVNN-SUB)       
SC3429                                     TO WA-AGR-REPAY           
SC3429           ELSE                                                
SC3429              IF WA-BLDVNN-SUB > 1                             
SC3429                 MOVE BLDV-NN-AGR-REPAYMENT (WA-BLDVNN-SUB - 1)
SC3429                                     TO WA-AGR-REPAY           
SC3429              END-IF                                           
SC3429           END-IF                                              
SC3429                                                               
SC3429           MOVE "Y"               TO WA-BLDVNN-FOUND           
SC3429           MOVE 15                TO WA-BLDVNN-SUB             
SC3429        END-IF                                                 
SC3429     END-PERFORM.                                              
SC3429                                                               
SC3429 AGREE-LOAD-NEG-REPAY-EXIT.                                    
SC3429     EXIT.                                                     
SC3429/                                                              
TB0198 TRANSFER-NPL-PROCESS.
TB0198     PERFORM X720-CALL-UT0251
TB0198        THRU X729-EXIT.           
TB0198
TB0198     IF WA-MSG-ERR-FLAG NOT =  0
TB0198        GO TO TRANSFER-NPL-PROCESS-EXIT
TB0198     END-IF.
TB0198   
TB0102     IF STRT-AREA-TRN-NO = 13010 OR 13045 OR 13046
TB0102                        OR 13110 OR 13145 OR 13146
S16235                        OR 13047 OR 13147
TB0102        IF WA-AGR-TRANSFER-FLAG = "I"
TB0102           IF WA-INPUT-PARAM-TABLE (7) = 0
TB0102              MOVE UT0251RA-CGL-COMPONENT-1-SB
TB0102                                    TO WA-SOUR-GL-CLASS-CODE
TB0102              MOVE BORP-NPL-I-CGL-1 TO WA-DEST-GL-CLASS-CODE
TB0102           ELSE
TB0102               MOVE BORP-NPL-I-CGL-1 TO WA-SOUR-GL-CLASS-CODE
TB0102               MOVE UT0251RA-CGL-COMPONENT-1-SB
TB0102                                    TO WA-DEST-GL-CLASS-CODE
TB0102           END-IF
TB0102
TB0102           MOVE WA-DISCH-I-INT-BUCKET  TO WA-GLCC-XFER-AMOUNT
TB0102        ELSE
TB0102           IF WA-INPUT-PARAM-TABLE (7) = 0
TB0102              MOVE BORM-GL-CLASSIFICATION-CODE
TB0102                                    TO WA-SOUR-GL-CLASS-CODE
TB0102              MOVE BORP-NON-CGL-COMPONENT-1
TB0102                                    TO WA-DEST-GL-CLASS-CODE
TB0102           ELSE
TB0102              MOVE BORP-NON-CGL-COMPONENT-1
TB0102                                    TO WA-SOUR-GL-CLASS-CODE
TB0102              MOVE BORM-GL-CLASSIFICATION-CODE
TB0102                                    TO WA-DEST-GL-CLASS-CODE
TB0102           END-IF
TB0102
TB0102           MOVE WA-DISCH-I-LOAN-BAL    TO WA-GLCC-XFER-AMOUNT
TB0102        END-IF
TB0102
TB0102        GO TO TRANSFER-NPL-PROCESS-CONT
TB0102     END-IF
TB0102
TB0198     IF WA-AGR-TRANSFER-FLAG = "I"
TB0198        IF BR17033-AGREE-IND = 2 
S15871        OR BR17033-AGREE-IND = 4
TB0198           MOVE UT0251RA-CGL-COMPONENT-1-SB
TB0198                                    TO WA-SOUR-GL-CLASS-CODE
TB0198           MOVE BORP-NPL-I-CGL-1    TO WA-DEST-GL-CLASS-CODE
TB0198        END-IF
TB0198    
TB0198        IF BR17033-AGREE-IND = 0 
TB0198           MOVE BORP-NPL-I-CGL-1    TO WA-SOUR-GL-CLASS-CODE
TB0198           MOVE UT0251RA-CGL-COMPONENT-1-SB
TB0198                                    TO WA-DEST-GL-CLASS-CODE
TB0198        END-IF
TB0198
TB0198        MOVE BR17033-INT-BUCKET  TO WA-GLCC-XFER-AMOUNT
TB0198     ELSE
TB0198        IF BR17033-AGREE-IND = 2 
S15871        OR BR17033-AGREE-IND = 4
TB0198           MOVE BORM-GL-CLASSIFICATION-CODE
TB0198                                    TO WA-SOUR-GL-CLASS-CODE
TB0198           MOVE BORP-NON-CGL-COMPONENT-1
TB0198                                    TO WA-DEST-GL-CLASS-CODE
TB0198        END-IF
TB0198    
TB0198        IF BR17033-AGREE-IND = 0 
TB0198           MOVE BORP-NON-CGL-COMPONENT-1 
TB0198                                    TO WA-SOUR-GL-CLASS-CODE
TB0198           MOVE BORM-GL-CLASSIFICATION-CODE
TB0198                                    TO WA-DEST-GL-CLASS-CODE
TB0198        END-IF
TB0198
TB0198        MOVE BORM-LOAN-BAL          TO WA-GLCC-XFER-AMOUNT
TB0198     END-IF.
TB0198
TB0102 TRANSFER-NPL-PROCESS-CONT.
TB0198* IF BOTH THE GLCC ARE SAME, THEN TRANSFER ENTRY IS NOT REQUIRED.
TB0198     IF WA-SOUR-GL-CLASS-CODE = WA-DEST-GL-CLASS-CODE
TB0198        GO TO TRANSFER-NPL-PROCESS-EXIT
TB0198     END-IF.
TB0198
TB0198     IF WA-GLCC-XFER-AMOUNT <= 0 
TB0198        GO TO TRANSFER-NPL-PROCESS-EXIT
TB0198     END-IF.
TB0198*
TB0198     INITIALIZE JNRST-DB-DATA
TB0198* MOVE GLCC FIELDS TO JOURNAL RECORD.
TB0198     MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE.
TB0198     MOVE WA-DEST-GL-CLASS-CODE TO JNRST-XFER-GL-CLASS-CODE.
TB0198     MOVE BORP-CGL-POSTING-IND  TO JNRST-CGL-POSTING-IND.
TB0198*
TB0198     MOVE "BOR"                TO JNRST-SYST.
TB0198     MOVE STRT-AREA-MSG-TIME   TO JNRST-TIME.
TB0198     MOVE STRT-AREA-SOC-NO     TO JNRST-SOC.
TB0198     MOVE BR17033-ACCT-NO      TO JNRST-CUSM-NO.
TB0198     MOVE STRT-AREA-BRANCH     TO JNRST-BRCH.
TB0198     MOVE 00                   TO JNRST-TRN-TYP.
TB0198     MOVE STRT-AREA-TERM-NO    TO JNRST-TERMNL.
TB0198     MOVE STRT-AREA-TELL-NO    TO JNRST-TELLER.
TB0198* MOVE (98904) INTERNAL ACCOUNT BALANCE
TB0198* TRANSFER TRANSACTION CODE
TB0198*
TB0198     MOVE 98904                TO JNRST-TRAN-CODE
TB0198                                  LINK-IN-TXCODE.
TB0198     PERFORM X700-CALL-UT0250 THRU
TB0198             X799-EXIT.
TB0198
TB0198     IF WA-MSG-ERR-FLAG NOT =  0
TB0198        GO TO TRANSFER-NPL-PROCESS-EXIT
TB0198     END-IF.
TB0198
TB0198     MOVE LINK-EDIT-TABLE          TO JNRST-EDIT-MASK.
TB0198     MOVE BORM-CURRENCY-IND        TO JNRST-CURRENCY-CODE.
TB0198     MOVE STRT-AREA-POST-DT        TO JNRST-POST-DATE.
TB0198     IF  WA-INPUT-PARAM-TABLE(8) = 1
TB0198         MOVE WA-STORE-TXN-DT      TO JNRST-TRAN-DATE
TB0198     ELSE
TB0198         MOVE STRT-AREA-POST-DT    TO JNRST-TRAN-DATE.
TB0198     MOVE STRT-AREA-JRNL-NO        TO JNRST-JRNL-NO.
TB0198     MOVE BORM-BR-NO               TO JNRST-HOME-BRNCH.
TB0198     MOVE BORM-ACT-TYPE            TO JNRST-ACC-TYPE.
TB0198     MOVE BORM-CAT                 TO JNRST-INT-CAT.
TB0198     MOVE WA-GLCC-XFER-AMOUNT      TO JNRST-BALANCE
TB0198                                      JNRST-AMOUNT.
TB0198     MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
TB0198                                      JNRST-TO-CURRENCY-CODE.
TB0198     MOVE 1                        TO JNRST-FLAG.
TB0198     MOVE ZEROES                   TO JNRST-NEW-ACC-FLG
TB0198                                      JNRST-LIM-TOL-FLAG
TB0198                                      JNRST-BOR-GROUP.
TB0198     MOVE SPACES                   TO JNRST-ATM-SAF-FLAG.
TB0198
TB0198* GET BASE CURRENCY EQUIVALENT FOR ACCOUNT BALANCE.
TB0198     IF BORM-CURRENCY-IND NOT = SOC-NATIVE-CURRENCY
TB0198        MOVE UT0296-CALL-AREA         TO WA-SAVE-UT0296CA-AREA
TB0198        MOVE 3                        TO UT0296CA-CALL-CODE
TB0198        MOVE "LON"                    TO UT0296CA-SYSTEM
TB0198        MOVE BORM-CURRENCY-IND        TO UT0296CA-FROM-CURRENCY
TB0198                                         UT0296CA-TO-CURRENCY
TB0198        MOVE WA-GLCC-XFER-AMOUNT      TO UT0296CA-FROM-AMOUNT
TB0198                                         UT0296CA-TO-AMOUNT
TB0198        MOVE "ZZZZ" TO UT0296CA-RATE-VERSION
TB0198        MOVE 01     TO UT0296CA-RATE-TYPE
TB0198        MOVE SPACES    TO UT0296CA-USER-CODES-LON
TB0198        MOVE ZEROES    TO UT0296CA-COMMISSION
TB0198                          UT0296CA-CHANGE
TB0198                          UT0296CA-BACKDATED-DATE
TB0198                          UT0296CA-FROM-BASE-EQUIVALENT
TB0198        INITIALIZE        UT0296CA-MULTI-FROM-AMOUNTS
TB0198        CALL "UT0296" USING
TB0198                          UT0296-CALL-AREA
TB0198                          STRT-AREA-DATA
TB0198                          SOC-PARAMS
TB0198
TB0198        IF UT0296CA-CALL-STATUS NOT = 0
TB0198           MOVE UT0296CA-CALL-STATUS  TO WA-OUTPUT-ERR-MSG-NO
TB0198           MOVE 1                     TO WA-MSG-ERR-FLAG
TB0198           GO TO TRANSFER-NPL-PROCESS-EXIT
TB0198        END-IF
TB0198
TB0198        MOVE UT0296RA-FROM-RATE       TO JNRST-FROM-CURRENCY-RATE
TB0198        MOVE UT0296RA-EQUIV-BASE-AMOUNT TO
TB0198             JNRST-FROM-BASE-EQUIVALENT
TB0198             JNRST-TO-BASE-EQUIVALENT
TB0198        MOVE UT0296CA-RATE-TYPE       TO JNRST-RATE-TYPE
TB0198        MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
TB0198                                         JNRST-TO-CURRENCY-CODE
TB0198     END-IF.
TB0198*
TB0198* MOVE SAVED UT0296 AREA BACK TO ORIGINAL BUFFER.
TB0198*
TB0198     MOVE WA-SAVE-UT0296CA-AREA    TO UT0296-CALL-AREA.
TB0198
TB0198     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
TB0198
TB0198     IF  WA-MSG-ERR-FLAG = 1
TB0198         GO TO TRANSFER-NPL-PROCESS-EXIT
TB0198     END-IF.
TB0198*
S15871*TB0198     IF BR17033-AGREE-IND = 2
S15871     IF (BR17033-AGREE-IND = 2 OR 4)
S16235*TB0102      OR STRT-AREA-TRN-NO = 13010 OR 13045 OR 13046
S16235      OR STRT-AREA-TRN-NO = 13010 OR 13045 OR 13046 OR 13047
TB0198        PERFORM TRANSFER-TO-MISC-INC
TB0198           THRU TRANSFER-TO-MISC-INC-EXIT
TB0198          VARYING WA-AGR-SUB FROM 1 BY 1
TB0198            UNTIL WA-AGR-SUB > 5
TB0198     END-IF.
TB0198
TB0198 TRANSFER-NPL-PROCESS-EXIT.
TB0198     EXIT.
TB0198/
TB0198 TRANSFER-TO-MISC-INC.
TB0102     IF STRT-AREA-TRN-NO NOT EQUAL 17033
TB0102        IF BOIS-GL-BUCKET-CDE (WA-AGR-SUB)
TB0102          = WA-AGR-TRANSFER-FLAG
TB0102           GO TO TRANSFER-TO-MISC-INC-CONT
TB0102        ELSE
TB0102           GO TO TRANSFER-TO-MISC-INC-EXIT
TB0102        END-IF
TB0102
TB0102        IF BOIS-GL-BUCKET-DUE (WA-AGR-SUB)
TB0102          <  WA-GLCC-XFER-AMOUNT
TB0102           GO TO TRANSFER-TO-MISC-INC-CONT
TB0102        ELSE
TB0102           GO TO TRANSFER-TO-MISC-INC-EXIT
TB0102        END-IF
TB0102     END-IF.
TB0102
TB0198     IF BR17033-GL-BUCKET-CDE (WA-AGR-SUB) 
TB0198       NOT = WA-AGR-TRANSFER-FLAG
TB0198        GO TO TRANSFER-TO-MISC-INC-EXIT
TB0198     END-IF.
TB0198
TB0198     IF BR17033-GL-BUCKET-DUE (WA-AGR-SUB) 
TB0198       >  WA-GLCC-XFER-AMOUNT 
TB0198        GO TO TRANSFER-TO-MISC-INC-EXIT
TB0198     END-IF.
TB0198
TB0102 TRANSFER-TO-MISC-INC-CONT.
TB0198     MOVE 13527               TO LINK-IN-TXCODE
TB0198                                 JNRST-TRAN-CODE.
TB0198     PERFORM X700-CALL-UT0250 
TB0198        THRU X799-EXIT
TB0198
TB0198     IF WA-MSG-ERR-FLAG = 1
TB0198        GO TO TRANSFER-TO-MISC-INC-EXIT
TB0198     ELSE
TB0198        MOVE LINK-EDIT-TABLE     TO JNRST-EDIT-MASK
TB0198     END-IF
TB0198
TB0198*    MOVE WA-LEDG-CODE          TO JNRST-LEDG-CODE
TB0198*    MOVE WA-DISCH-I-SUB-LEDG-CODE TO JNRST-SUB-LEDG-CODE
TB0198     MOVE WA-DEST-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE.
TB0102     IF STRT-AREA-TRN-NO EQUAL 17033
TB0198        COMPUTE JNRST-AMOUNT = WA-GLCC-XFER-AMOUNT -
TB0198                               BR17033-GL-BUCKET-DUE (WA-AGR-SUB)
TB0102     ELSE
TB0102        COMPUTE JNRST-AMOUNT = WA-GLCC-XFER-AMOUNT -
TB0102                               BOIS-GL-BUCKET-DUE (WA-AGR-SUB)
TB0102     END-IF.
TB0198
TB0198     IF JNRST-AMOUNT <= 0 
TB0198        GO TO TRANSFER-TO-MISC-INC-EXIT
TB0198     END-IF
TB0198  
TB0198     MOVE 0                     TO JNRST-BALANCE.
TB0198     MOVE 0                     TO JNRST-ARR.
TB0198     MOVE BORM-GROUP            TO JNRST-BOR-GROUP.
TB0198     MOVE BORM-SUB-GROUP        TO JNRST-BOR-SUB-GROUP.
TB0198     MOVE BORM-CURRENCY-IND     TO JNRST-CURRENCY-CODE
TB0198                                   JNRST-TO-CURRENCY-CODE.
TB0198     MOVE SOC-NATIVE-CURRENCY   TO JNRST-FROM-CURRENCY-CODE.
TB0198         
TB0198* GET BASE CURRENCY EQUIVALENT FOR ACCOUNT BALANCE.
TB0198     IF BORM-CURRENCY-IND NOT = SOC-NATIVE-CURRENCY
TB0198        MOVE UT0296-CALL-AREA         TO WA-SAVE-UT0296CA-AREA
TB0198        MOVE 3                        TO UT0296CA-CALL-CODE
TB0198        MOVE "LON"                    TO UT0296CA-SYSTEM
TB0198        MOVE BORM-CURRENCY-IND        TO UT0296CA-FROM-CURRENCY
TB0198                                         UT0296CA-TO-CURRENCY
TB0198        MOVE WA-GLCC-XFER-AMOUNT      TO UT0296CA-FROM-AMOUNT
TB0198                                         UT0296CA-TO-AMOUNT
TB0198        MOVE "ZZZZ" TO UT0296CA-RATE-VERSION
TB0198        MOVE 01     TO UT0296CA-RATE-TYPE
TB0198        MOVE SPACES    TO UT0296CA-USER-CODES-LON
TB0198        MOVE ZEROES    TO UT0296CA-COMMISSION
TB0198                          UT0296CA-CHANGE
TB0198                          UT0296CA-BACKDATED-DATE
TB0198                          UT0296CA-FROM-BASE-EQUIVALENT
TB0198        INITIALIZE        UT0296CA-MULTI-FROM-AMOUNTS
TB0198        CALL "UT0296" USING
TB0198                          UT0296-CALL-AREA
TB0198                          STRT-AREA-DATA
TB0198                          SOC-PARAMS
TB0198
TB0198        IF UT0296CA-CALL-STATUS NOT = 0
TB0198           MOVE UT0296CA-CALL-STATUS  TO WA-OUTPUT-ERR-MSG-NO
TB0198           MOVE 1                     TO WA-MSG-ERR-FLAG
TB0198           GO TO TRANSFER-TO-MISC-INC-EXIT
TB0198        END-IF
TB0198
TB0198        MOVE UT0296RA-FROM-RATE       TO JNRST-FROM-CURRENCY-RATE
TB0198        MOVE UT0296RA-EQUIV-BASE-AMOUNT TO
TB0198             JNRST-FROM-BASE-EQUIVALENT
TB0198             JNRST-TO-BASE-EQUIVALENT
TB0198        MOVE UT0296CA-RATE-TYPE       TO JNRST-RATE-TYPE
TB0198        MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
TB0198                                         JNRST-TO-CURRENCY-CODE
TB0198     END-IF.
TB0198*
TB0198*
TB0198* MOVE SAVED UT0296 AREA BACK TO ORIGINAL BUFFER.
TB0198*
TB0198     MOVE WA-SAVE-UT0296CA-AREA    TO UT0296-CALL-AREA.
TB0198
TB0198     PERFORM Z000-WRITE-JRNL 
TB0198        THRU Z009-EXIT.
TB0198
TB0198     IF  WA-MSG-ERR-FLAG = 1
TB0198         GO TO TRANSFER-TO-MISC-INC-EXIT
TB0198     END-IF.
TB0198
TB0198 TRANSFER-TO-MISC-INC-EXIT.
TB0198     EXIT.
TB0158*
TB0158*** INTEREST / PENALTY ADJUSTMENT FSLON003
TB0158*** YAKEE
TB0158*
TB0158 Z10240-JRNL-RTN.
SC4682*    MOVE WA-SOUR-GL-CLASS-CODE TO JNRST-GL-CLASS-CODE.
SC4682*    MOVE WA-DEST-GL-CLASS-CODE TO JNRST-XFER-GL-CLASS-CODE.
S12524     MOVE JNRST-BATCH-NO           TO WS-PROMO-NO.
SC4682     MOVE BORM-GL-CLASSIFICATION-CODE TO JNRST-GL-CLASS-CODE.
TB0158     MOVE BORP-CGL-POSTING-IND  TO JNRST-CGL-POSTING-IND.
TB0158     MOVE "BOR"                TO JNRST-SYST.
TB0158     MOVE STRT-AREA-MSG-TIME   TO JNRST-TIME.
TB0158     MOVE STRT-AREA-SOC-NO     TO JNRST-SOC.
TB0158     MOVE WA-INPUT-ACCT-NO     TO JNRST-CUSM-NO.
TB0158     MOVE STRT-AREA-BRANCH         TO JNRST-BRCH.
S12524*
S12524     IF ( WS-AMC-PROMO-NO )
S12524          MOVE BORM-BR-NO          TO JNRST-BRCH
S12524     END-IF.
S12524*
S17306     IF  STRT-AREA-TRN-NO          =  10241
S17306     AND STRT-TRICKLE-TXN
S17306     AND WA-BONUS-EXCHANGE
S17306         MOVE 13509                    TO UT0145CA-CALL-TRAN
S17306         PERFORM X910-REPL-COMPONENT THRU X910-EXIT
S17306         MOVE WA-DEST-GL-CLASS-CODE    TO JNRST-GL-CLASS-CODE
S17306         MOVE "C6"                     TO JNRST-BATCH-NO
S17306     END-IF.
TB0158     MOVE STRT-AREA-TERM-NO        TO JNRST-TERMNL.
TB0158     MOVE STRT-AREA-TELL-NO        TO JNRST-TELLER.
SC4333     PERFORM X700-CALL-UT0250 THRU X799-EXIT.
SC4333     IF WA-MSG-ERR-FLAG = 1
SC4333        GO TO Z10240-JRNL-EXIT
SC4333     END-IF.
SC4333     MOVE LINK-EDIT-TABLE          TO JNRST-EDIT-MASK.
TB0158*    PERFORM X700-CALL-UT0250 THRU
TB0158*            X799-EXIT.
TB0158*    IF WA-MSG-ERR-FLAG = 1
TB0158*            GO TO Z10240-JRNL-EXIT
TB0158*    END-IF.
TB0158*    MOVE LINK-EDIT-TABLE          TO JNRST-EDIT-MASK.
TB0158     MOVE BORM-CURRENCY-IND        TO JNRST-CURRENCY-CODE.
TB0158     MOVE STRT-AREA-POST-DT        TO JNRST-POST-DATE.
TB0158     IF  WA-INPUT-PARAM-TABLE(8) = 1
TB0158         MOVE WA-STORE-TXN-DT      TO JNRST-TRAN-DATE
TB0158     ELSE
TB0158         MOVE STRT-AREA-POST-DT    TO JNRST-TRAN-DATE
TB0158     END-IF.
TB0158     MOVE STRT-AREA-JRNL-NO        TO JNRST-JRNL-NO.
TB0158     MOVE BORM-BR-NO               TO JNRST-HOME-BRNCH.
TB0158     MOVE BORM-ACT-TYPE            TO JNRST-ACC-TYPE.
TB0158     MOVE BORM-CAT                 TO JNRST-INT-CAT.
TB0158     MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
TB0158                                      JNRST-TO-CURRENCY-CODE.
TB0158     MOVE 1                        TO JNRST-FLAG.
TB0158     MOVE ZEROES                   TO JNRST-NEW-ACC-FLG
TB0158                                      JNRST-LIM-TOL-FLAG
TB0158                                      JNRST-BOR-GROUP
TB0158     MOVE SPACES                   TO JNRST-ATM-SAF-FLAG.
TB0158     IF BORM-CURRENCY-IND NOT EQUAL SOC-NATIVE-CURRENCY
TB0158* GET BASE CURRENCY EQUIVALENT FOR ACCOUNT BALANCE
TB0158        MOVE UT0296-CALL-AREA         TO WA-SAVE-UT0296CA-AREA
TB0158        MOVE 3                        TO UT0296CA-CALL-CODE
TB0158        MOVE "LON"                    TO UT0296CA-SYSTEM
TB0158        MOVE BORM-CURRENCY-IND        TO UT0296CA-FROM-CURRENCY
TB0158                                         UT0296CA-TO-CURRENCY
TB0158        MOVE WA-GLCC-XFER-AMOUNT      TO UT0296CA-FROM-AMOUNT
TB0158                                         UT0296CA-TO-AMOUNT
TB0158        MOVE "ZZZZ" TO UT0296CA-RATE-VERSION
TB0158        MOVE 01     TO UT0296CA-RATE-TYPE
TB0158        MOVE SPACES    TO UT0296CA-USER-CODES-LON
TB0158        MOVE ZEROES    TO UT0296CA-COMMISSION
TB0158                          UT0296CA-CHANGE
TB0158                          UT0296CA-BACKDATED-DATE
TB0158                          UT0296CA-FROM-BASE-EQUIVALENT
TB0158        INITIALIZE        UT0296CA-MULTI-FROM-AMOUNTS
TB0158        CALL "UT0296" USING
TB0158                          UT0296-CALL-AREA
TB0158                          STRT-AREA-DATA
TB0158                          SOC-PARAMS
TB0158        IF UT0296CA-CALL-STATUS NOT = 0
TB0158           MOVE UT0296CA-CALL-STATUS  TO WA-OUTPUT-ERR-MSG-NO
TB0158           MOVE 1                     TO WA-MSG-ERR-FLAG
TB0158           GO TO Z10240-JRNL-EXIT
TB0158        END-IF
TB0158        MOVE UT0296RA-FROM-RATE       TO JNRST-FROM-CURRENCY-RATE
TB0158        MOVE UT0296RA-EQUIV-BASE-AMOUNT TO
TB0158             JNRST-FROM-BASE-EQUIVALENT
TB0158             JNRST-TO-BASE-EQUIVALENT
TB0158        MOVE UT0296CA-RATE-TYPE       TO JNRST-RATE-TYPE
TB0158        MOVE BORM-CURRENCY-IND        TO JNRST-FROM-CURRENCY-CODE
TB0158                                         JNRST-TO-CURRENCY-CODE
TB0158*
TB0158* MOVE SAVED UT0296 AREA BACK TO ORIGINAL BUFFER.
TB0158*
TB0158        MOVE WA-SAVE-UT0296CA-AREA    TO UT0296-CALL-AREA
TB0158     END-IF.
TB0158     PERFORM Z000-WRITE-JRNL THRU Z009-EXIT.
TB0158
TB0158 Z10240-JRNL-EXIT.
TB0158     EXIT.
TB0215 Z10725-JNRST-RTN.
TB0215     INITIALIZE WA-JRNL-CALL-AREA.
TB0215     PERFORM Z1000-ONLREQ-PRINT-JNRST-RTN THRU
TB0215             Z1000-ONLREQ-PRINT-JNRST-EXIT.
TB0215     MOVE OUTPUT-10725-ACCT-NO     TO JNRST-CUSM-NO.
TB0215     MOVE STRT-AREA-TRN-NO         TO JNRST-TRAN-CODE.
TB0215     MOVE OUTPUT-10725-TERM-FROM   TO JNRST-PRN-FROM-TERM.
TB0215     MOVE OUTPUT-10725-TERM-TO     TO JNRST-PRN-TO-TERM.
S18252     MOVE OUTPUT-10725-ADDR-SEL    TO JNRST-PRN-ADDR-SEL.
TB0215
TB0215     PERFORM Z000-WRITE-JRNL THRU
TB0215             Z009-EXIT.
TB0215 Z10725-JNRST-EXIT.
TB0215     EXIT.
TB0215*
TB0215 Z10726-JNRST-RTN.
TB0215     INITIALIZE WA-JRNL-CALL-AREA.
TB0215     PERFORM Z1000-ONLREQ-PRINT-JNRST-RTN THRU
TB0215             Z1000-ONLREQ-PRINT-JNRST-EXIT.
TB0215     MOVE OUTPUT-10726-CUSM-NO     TO JNRST-CUSM-NO.
TB0215     MOVE STRT-AREA-TRN-NO         TO JNRST-TRAN-CODE.
TB0215     MOVE OUTPUT-10726-REP-MONTH   TO JNRST-PRN-REP-MONTH.
TB0215     MOVE OUTPUT-10726-REP-DATE    TO JNRST-PRN-REP-DATE.
TB0215     MOVE OUTPUT-10726-ACCT-NO     TO JNRST-PRN-CUST-ID.
TB0215     MOVE OUTPUT-10726-TYPE        TO JNRST-PRN-TYPE.
TB0215     PERFORM Z000-WRITE-JRNL THRU
TB0215             Z009-EXIT.
TB0215 Z10726-JNRST-EXIT.
TB0215     EXIT.
TB0215*
TB0215 Z1000-ONLREQ-PRINT-JNRST-RTN.
TB0215     DISPLAY 'Z1000-ONLREQ-PRINT-JNRST-RTN.'
TB0215     MOVE "BOR"                    TO JNRST-SYST.
TB0215     MOVE STRT-AREA-MSG-TIME       TO JNRST-TIME.
TB0215     MOVE STRT-AREA-SOC-NO         TO JNRST-SOC.
TB0215     MOVE STRT-AREA-BRANCH         TO JNRST-BRCH.
TB0215     MOVE STRT-AREA-TERM-NO        TO JNRST-TERMNL.
TB0215     MOVE STRT-AREA-TELL-NO        TO JNRST-TELLER.
TB0215     MOVE STRT-AREA-EDIT-MASK      TO JNRST-EDIT-MASK.
TB0215     MOVE STRT-AREA-POST-DT        TO JNRST-TRAN-DATE
TB0215                                      JNRST-POST-DATE.
TB0215 Z1000-ONLREQ-PRINT-JNRST-EXIT.
TB0215     EXIT.
TB0169*
TB0219 H400-ACCESS-INOD.
TB0219
TB0219     MOVE "****"          TO DBIOMOD-STAT.
TB0219     MOVE "DBIO"          TO DBIOMOD-PREFIX.
TB0219     MOVE "INOD"          TO DBIOMOD-FILE
TB0219                             DBIOMOD-SUFFIX.
TB0219     MOVE SPACES          TO DBIOMOD-RELEASE-LOCK
TB0219                             DBIOMOD-ACCESS-COMMAND
TB0219                             DBIOMOD-ACCESS-COND.
TB0219
TB0219     CALL DBIOMODNAME USING
TB0219                             DBIOMOD-FILE
TB0219                             DBIOMOD-KEY
TB0219                             INOD-RECORD-AREA
TB0219                             DBIOMOD-FUNCTION
TB0219                             DBIOMOD-KEY-NO
TB0219                             DBIOMOD-RELEASE-LOCK
TB0219                             DBIOMOD-ACCESS-COMMAND
TB0219                             DBIOMOD-ACCESS-COND
TB0219                             DBIOMOD-STATUS.
TB0219
TB0219 H499-EXIT.
TB0219     EXIT.
TB0016**--
       D400-READ-RELM.
      *===============
           MOVE SPACES           TO UT0400CA-CALL-STATUS.
           MOVE STRT-AREA-SOC-NO TO UT0400CA-RELM-INST-1
                                    UT0400CA-RELM-INST-1-REL.
           CALL "UT0400" USING
                         UT0400-CALL-AREA.
           IF UT0400CA-CALL-STATUS EQUAL "RCNF"
              MOVE "Y" TO WA-RCNF-RELM
              GO TO D499-EXIT
           ELSE
              MOVE "N" TO WA-RCNF-RELM
              GO TO D499-EXIT
           END-IF.
           IF UT0400CA-CALL-STATUS NOT = "****"
              MOVE 155    TO WA-OUTPUT-ERR-MSG-NO
              MOVE "RELM" TO WA-OUTPUT-DATA-SET
              MOVE UT0400CA-CALL-STATUS         TO WA-OUTPUT-STATUS
              MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
              MOVE SPACES                       TO UT8500CA-INPUT-MSG
              STRING "UT0001:(D400) 'RELM' READ ERROR, STAT- "
                       UT0400CA-CALL-STATUS
                     " " RELM-ALT-KEY-1
                     " " RELM-ALT-KEY-2
                  DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
              CALL "UT8500" USING
                            UT8500CA-AREA
              MOVE 1   TO WA-MSG-ERR-FLAG
           END-IF.
       D499-EXIT.
      *----------
           EXIT.
       MOVE-RELM-1.
      *============
           MOVE RELM-INST-1         TO UT0400CA-RELM-INST-1.
           MOVE RELM-ID-1           TO UT0400CA-RELM-ID-1.
           MOVE RELM-ENTITY-1       TO UT0400CA-RELM-ENTITY-1.
           MOVE RELM-RELATIONSHIP-1 TO UT0400CA-RELM-RELATIONSHIP-1.
           MOVE RELM-INST-1-REL     TO UT0400CA-RELM-INST-1-REL.
           MOVE RELM-ID-1-REL       TO UT0400CA-RELM-ID-1-REL.
           MOVE RELM-ENTITY-1-REL   TO UT0400CA-RELM-ENTITY-1-REL.
       MOVE-RELM-1-EXIT.
      *-----------------
           EXIT.
S16618 D410-GET-GUAR-ID.
S16618    MOVE STRT-AREA-SOC-NO           TO GTEM-SOC-NO
S16618    MOVE RELM-ID-1-REL              TO GTEM-GTE-NO
S16618    MOVE 71                         TO DBIO-CALL-FUNC
S16618    MOVE GTEM-KEY                   TO DBIO-CALL-KEY-AREA
S16618    MOVE "GTEM"                     TO DBIO-CALL-SYS-AREA
S16618    MOVE SPACES                     TO DBIO-CALL-STATUS
S16618    CALL "DBIO" USING
S16618                DBIO-CALL-PARAM
S16618                DBIO-CALL-SYS-AREA
S16618                DBIO-CALL-KEY-AREA
S16618                DBIO-CALL-STATUS
S16618                WA-GTEM-AREA
S16618                DBIO-CALL-REFER-AREA.
S16618
S16618 D410-EXIT.
S16618    EXIT.
S16618
       DISPLAY-RELM-DATA.
      *==================
           MOVE RELM-ID-1-REL          TO UT0151CA-ACCT-IN.
           MOVE 2                      TO UT0151CA-CALL-FUNC.
           MOVE SOC-FAC-COLL-NO-FORMAT TO UT0151CA-FORMAT.
           MOVE SOC-CHK-DGT            TO UT0151CA-CHK-DGT-TYPE.
           CALL "UT0151" USING
                                UT0151CA-CALL-AREA.
           IF UT0151CA-STATUS NOT = 0
              MOVE UT8500CA-FUNC-NORMAL-DISPLAY
                                   TO UT8500CA-CALL-CODE
              MOVE SPACES          TO UT8500CA-INPUT-MSG
              STRING "BR0000:(G9200) UT0151 CALL ERROR; A/C NO - "
                   UT0151CA-ACCT-IN "; STATUS - " UT0151CA-STATUS
                   DELIMITED  BY SIZE INTO UT8500CA-INPUT-MSG
              CALL "UT8500"   USING
                              UT8500CA-AREA
              MOVE 1 TO WA-MSG-ERR-FLAG
              GO     TO DISPLAY-RELM-DATA-EXIT
           END-IF.
           EVALUATE WA-GTE-TO-LON-CTR
               WHEN 1
                    MOVE UT0151CA-ACCT-EX TO WA-12006-GTEE-NO-1
               WHEN 2
                    MOVE UT0151CA-ACCT-EX TO WA-12006-GTEE-NO-2
               WHEN 3
                    MOVE UT0151CA-ACCT-EX TO WA-12006-GTEE-NO-3
           END-EVALUATE.
       DISPLAY-RELM-DATA-EXIT.
      *-----------------------
           EXIT.
TB0016**--
SC4522 FEDI-TXN-PROCESS.
SC4522     IF FEDI-NO-FEE
SC4522        GO TO FEDI-TXN-EXIT
SC4522     END-IF.
SC6077     SET USE-HOME-BRCH TO TRUE.
SC4522     MOVE BORM-CURRENCY-IND TO WA-BORM-CURRENCY.
SC4522     MOVE WA-INPUT-MSG     TO SAVE-INPUT-MESSAGE.
SC4522     MOVE STRT-AREA-TRN-NO TO SAVE-TXN-NO.
SC4522     MOVE BORM-RECORD-AREA TO WA-SAVE-BORM-AREA.
SC5378     MOVE WA-EDIT-MASK     TO WA-SAVE-PROC-BITS.
SC6077     MOVE BORM-CUSTOMER-NO TO WA-SAVE-BORM-CUSTOMER-NO.
SC6077     MOVE BORM-BR-NO       TO WA-SAVE-BORM-BRANCH-NO.
SC6077     MOVE BORM-CURRENCY-IND TO WA-SAVE-BORM-CURRENCY.
SC6077     MOVE STRT-AREA-DATA   TO WA-SAVE-STRT-AREA.
SC4522     MOVE UTVTACCA-AREA    TO WA-SAVE-UTVTACCA-AREA.
SC6077     MOVE WA-DUMMY-TRN-NO  TO WA-SAVE-DUMMY-TRN-NO.
SC6077     IF WA-SAVED-PARAM-TABLE(29) = 1
SC6077        MOVE W800-PROMO-NO TO WA-SAVE-PROMO-NO
SC6077     ELSE
SC6077        MOVE IN0020-BATCH-NO TO WA-SAVE-PROMO-NO
SC6077     END-IF.
SC4522     MOVE "N"                TO STRT-AREA-VIRTUAL-ACCT-FLAG.
SC4522     INITIALIZE UTVTACCA-AREA.
SC4522
SC4522 FEDI-HAND-FEE.
SC4522***                                                 ***
SC4522*** H A N D L I N G    F E E    P R O C E S S I N G ***
SC4522***                                                 ***
SC4522* THERE ARE NO CUSTOMER FEE PROCESS, CUSTOMER FEE IS INCLUDED
SC4522* IN W800-TRF-AMOUNT, ONLY FEE CLEARING IN GEN WILL BE PROCESSED
SC4522* HERE.
SC4522        MOVE SAVE-INPUT-MESSAGE TO WA-INPUT-MSG     
SC4522        IF  WA-HAND-RECEIVED = 0
SC4522        AND WA-HAND-RECEIVABLE = 0
SC4522            GO TO FEDI-NET-FEE.
SC4522
SC4522        IF WA-HAND-RECEIVABLE > 0
SC4522           MOVE WA-INPUT-KEY-R TO WA-INPUT-ACCT
SC4522           MOVE WA-SUSP-KEY-FHND-FEE TO WA-SUSP-TYPE-ID
SC6077           SET USE-SETT-BRCH TO TRUE
SC4522           PERFORM F100-GET-SUSP-ACCT THRU F100-EXIT
SC4522           IF  WA-MSG-ERR-FLAG = 1
SC4522              GO TO FEDI-TXN-EXIT
SC4522           END-IF
SC4522           MOVE SUSP-ACCT-NO TO WA-FISCHND-SUSP-ACCT
SC4522                                WA-INPUT-KEY-R
SC4522           MOVE WA-HAND-RECEIVABLE TO WA-FISC-SUSP-AMT
SC4522                                WA-TEMP-AMT2
SC4522                                WA-GL-AMOUNT
SC4522           PERFORM F145-CREDIT-FEDI-SUSP-GL THRU
SC4522                   F145-EXIT
SC4522           IF  WA-MSG-ERR-FLAG = 1
SC4522               GO TO FEDI-TXN-EXIT
SC4522           END-IF
SC4522        END-IF.
SC4522        IF WA-HAND-RECEIVED >= WA-HAND-RECEIVABLE
SC4522           IF WA-HAND-RECEIVED > WA-HAND-RECEIVABLE
SC4522               MOVE SAVE-INPUT-MESSAGE TO WA-INPUT-MSG     
SC4522               MOVE WA-BORM-CURRENCY TO BORM-CURRENCY-IND
SC4522               MOVE WA-INPUT-KEY-R    TO WA-INPUT-ACCT
SC4522               MOVE WA-SUSP-KEY-BHND-FEE TO WA-SUSP-TYPE-ID
SC6077               SET USE-HOME-BRCH TO TRUE
SC4522               PERFORM F100-GET-SUSP-ACCT THRU F100-EXIT
SC4522               IF  WA-MSG-ERR-FLAG = 1
SC4522                  GO TO FEDI-TXN-EXIT
SC4522               END-IF
SC4522               MOVE SUSP-ACCT-NO      TO WA-BRCH-SUSP-ACCT
SC4522                                      WA-INPUT-KEY-R
SC4522               COMPUTE WA-BRCH-SUSP-AMT = WA-HAND-RECEIVED
SC4522                       - WA-HAND-RECEIVABLE
SC4522               MOVE WA-BRCH-SUSP-AMT  TO WA-GL-AMOUNT
SC4522                                      WA-TEMP-AMT2
SC4522               PERFORM F145-CREDIT-FEDI-SUSP-GL THRU
SC4522                       F145-EXIT
SC4522               IF  WA-MSG-ERR-FLAG = 1
SC4522                   GO TO FEDI-TXN-EXIT
SC4522               END-IF
SC4522           END-IF
SC4522        ELSE
SC4522           MOVE SAVE-INPUT-MESSAGE TO WA-INPUT-MSG     
SC4522           MOVE WA-BORM-CURRENCY TO BORM-CURRENCY-IND
SC4522           MOVE WA-INPUT-KEY-R     TO WA-INPUT-ACCT
SC4522           MOVE WA-SUSP-KEY-BHND-SUBS TO WA-SUSP-TYPE-ID
SC6077           SET USE-HOME-BRCH TO TRUE
SC4522           PERFORM F100-GET-SUSP-ACCT THRU F100-EXIT
SC4522           IF  WA-MSG-ERR-FLAG = 1
SC4522              GO TO FEDI-TXN-EXIT
SC4522           END-IF
SC4522           MOVE SUSP-ACCT-NO       TO WA-BRHND-SUSP-ACCT
SC4522                                   WA-INPUT-KEY-R
SC4522           COMPUTE WA-BRHND-SUSP-AMT = WA-HAND-RECEIVABLE
SC4522                   - WA-HAND-RECEIVED
SC4522           MOVE WA-BRHND-SUSP-AMT  TO WA-FISC-SUSP-AMT
SC4522                                      WA-TEMP-AMT2
SC4522                                      WA-GL-AMOUNT
SC4522           PERFORM F140-DEBIT-FEDI-SUSP-GL THRU
SC4522                   F140-EXIT
SC4522           IF  WA-MSG-ERR-FLAG = 1
SC4522               GO TO FEDI-TXN-EXIT
SC4522           END-IF
SC4522        END-IF.
SC4522
SC4522 FEDI-NET-FEE.
SC4522***                                                 ***
SC4522*** N E T W O R K    T R A N S M I S S I O N    FEE ***
SC4522***                                                 ***
SC4522        IF  WA-NET-RECEIVED = 0
SC4522        AND WA-NET-RECEIVABLE = 0
SC4522            GO TO FEDI-FINISH. 
SC4522
SC4522        MOVE SAVE-INPUT-MESSAGE TO WA-INPUT-MSG     
SC4522        IF WA-NET-RECEIVABLE > 0
SC4522           MOVE WA-BORM-CURRENCY TO BORM-CURRENCY-IND
SC4522           MOVE WA-INPUT-KEY-R    TO WA-INPUT-ACCT
SC4522           MOVE WA-SUSP-KEY-FNET-FEE TO WA-SUSP-TYPE-ID
SC6077           SET USE-SETT-BRCH TO TRUE
SC4522           PERFORM F100-GET-SUSP-ACCT THRU F100-EXIT
SC4522           IF  WA-MSG-ERR-FLAG = 1
SC4522              GO TO FEDI-TXN-EXIT
SC4522           END-IF
SC4522           MOVE SUSP-ACCT-NO      TO WA-FISC-SUSP-ACCT
SC4522                                  WA-INPUT-KEY-R
SC4522           MOVE WA-NET-RECEIVABLE TO WA-BRNET-SUSP-AMT
SC4522                                     WA-TEMP-AMT2
SC4522                                     WA-GL-AMOUNT
SC4522           PERFORM F145-CREDIT-FEDI-SUSP-GL THRU
SC4522                   F145-EXIT
SC4522           IF  WA-MSG-ERR-FLAG = 1
SC4522               GO TO FEDI-TXN-EXIT
SC4522           END-IF
SC4522        END-IF.
SC4522        IF WA-NET-RECEIVED < WA-NET-RECEIVABLE
SC4522           MOVE SAVE-INPUT-MESSAGE TO WA-INPUT-MSG     
SC4522           MOVE WA-BORM-CURRENCY TO BORM-CURRENCY-IND
SC4522           MOVE WA-INPUT-KEY-R    TO WA-INPUT-ACCT
SC4522           MOVE WA-SUSP-KEY-BNET-SUBS TO WA-SUSP-TYPE-ID
SC6077           SET USE-HOME-BRCH TO TRUE
SC4522           PERFORM F100-GET-SUSP-ACCT THRU F100-EXIT
SC4522           IF  WA-MSG-ERR-FLAG = 1
SC4522              GO TO FEDI-TXN-EXIT
SC4522           END-IF
SC4522           MOVE SUSP-ACCT-NO      TO WA-BRNET-SUSP-ACCT
SC4522                                     WA-INPUT-KEY-R
SC4522           COMPUTE WA-FISCHND-SUSP-AMT = WA-NET-RECEIVABLE
SC4522                   - WA-NET-RECEIVED
SC4522           MOVE WA-FISCHND-SUSP-AMT TO WA-BRNET-SUSP-AMT
SC4522                                     WA-TEMP-AMT2
SC4522                                     WA-GL-AMOUNT
SC4522           PERFORM F140-DEBIT-FEDI-SUSP-GL THRU
SC4522                   F140-EXIT
SC4522           IF  WA-MSG-ERR-FLAG = 1
SC4522               GO TO FEDI-TXN-EXIT
SC4522           END-IF
SC4522        END-IF.
SC7685        IF WA-NET-RECEIVED > WA-NET-RECEIVABLE
SC7685           MOVE SAVE-INPUT-MESSAGE TO WA-INPUT-MSG
SC7685           MOVE WA-BORM-CURRENCY TO BORM-CURRENCY-IND
SC7685           MOVE WA-INPUT-KEY-R    TO WA-INPUT-ACCT
SC7685           MOVE WA-SUSP-KEY-BHND-FEE TO WA-SUSP-TYPE-ID
SC7685           SET USE-HOME-BRCH TO TRUE
SC7685           PERFORM F100-GET-SUSP-ACCT THRU F100-EXIT
SC7685           IF WA-MSG-ERR-FLAG = 1
SC7685              GO TO FEDI-TXN-EXIT
SC7685           END-IF
SC7685           MOVE SUSP-ACCT-NO      TO WA-BRCH-SUSP-ACCT
SC7685                                     WA-INPUT-KEY-R
SC7685           COMPUTE WA-BRCH-SUSP-AMT = WA-NET-RECEIVED
SC7685                       - WA-NET-RECEIVABLE
SC7685           MOVE WA-BRCH-SUSP-AMT  TO WA-GL-AMOUNT
SC7685                                     WA-TEMP-AMT2
SC7685           PERFORM F145-CREDIT-FEDI-SUSP-GL THRU F145-EXIT
SC7685           IF WA-MSG-ERR-FLAG = 1
SC7685              GO TO FEDI-TXN-EXIT
SC7685           END-IF
SC7685        END-IF.
SC4522
SC4522 FEDI-FINISH.
SC6077        MOVE WA-SAVE-STRT-AREA  TO STRT-AREA-DATA.
SC6077        MOVE WA-SAVE-DUMMY-TRN-NO  TO WA-DUMMY-TRN-NO.
SC4522        MOVE WA-SAVE-UTVTACCA-AREA TO UTVTACCA-AREA.
SC4522        MOVE SAVE-TXN-NO TO STRT-AREA-TRN-NO.
SC4522        MOVE SAVE-INPUT-MESSAGE TO WA-INPUT-MSG.    
SC5378        MOVE WA-SAVE-PROC-BITS  TO WA-EDIT-MASK.
SC4522        MOVE WA-SAVE-BORM-AREA  TO BORM-RECORD-AREA.
SC4522
SC4522 FEDI-TXN-EXIT.
SC4522     EXIT.
SC4522
SC5378*
SC5378 FEDI-CREDIT-TXN-CODE-SETUP.
SC5378     IF WA-SAVED-PARAM-TABLE(7) = 1
SC5378        IF WA-SAVED-PARAM-TABLE(29) = 1
SC5378           MOVE 20145 TO STRT-AREA-TRN-NO
SC5378        ELSE
SC5378           MOVE 20130 TO STRT-AREA-TRN-NO
SC5378        END-IF
SC5378     ELSE
SC5378        IF WA-SAVED-PARAM-TABLE(29) = 1
SC5378           MOVE 20045 TO STRT-AREA-TRN-NO
SC5378        ELSE
SC5378           MOVE 20030 TO STRT-AREA-TRN-NO
SC5378        END-IF
SC5378     END-IF.
SC5378 FEDI-CREDIT-EXIT.
SC5378     EXIT.
SC5378
SC5378 FEDI-DEBIT-TXN-CODE-SETUP.
SC5378     IF WA-SAVED-PARAM-TABLE(7) = 1
SC5378        IF WA-SAVED-PARAM-TABLE(29) = 1
SC5378           MOVE 20155 TO STRT-AREA-TRN-NO
SC5378        ELSE
SC5378           MOVE 20150 TO STRT-AREA-TRN-NO
SC5378        END-IF
SC5378     ELSE
SC5378        IF WA-SAVED-PARAM-TABLE(29) = 1
SC5378           MOVE 20055 TO STRT-AREA-TRN-NO
SC5378        ELSE
SC5378           MOVE 20050 TO STRT-AREA-TRN-NO
SC5378        END-IF
SC5378     END-IF.
SC5378 FEDI-DEBIT-EXIT.
SC5378     EXIT.
SC5378*
SC4522 F100-GET-SUSP-ACCT.
SC4522     MOVE 0                          TO WA-MSG-ERR-FLAG
SC4522                                        WA-OUTPUT-ERR-MSG-NO.
SC4522     MOVE STRT-AREA-TRN-NO           TO WA-SUSP-TRAN-CODE.
SC4522     MOVE STRT-AREA-EDIT-MASK        TO WA-SUSP-EDIT-MASK.
SC4522     MOVE WA-INPUT-MSG               TO WA-SUSP-INPUT-MESSAGE.
SC4522     MOVE WA-INPUT-KEY-R             TO WA-SUSP-ACCT-NO.
SC6077     MOVE WA-SAVE-BORM-AREA          TO WA-SUSP-MAST.
SC6077     MOVE WA-SAVE-BORM-CUSTOMER-NO   TO WA-SUSP-CUST-NO.
SC6077     IF USE-SETT-BRCH
SC6077        MOVE SOC-SETTLE-BRANCH       TO WA-SUSP-HOME-BR
SC6077     ELSE
SC6077        MOVE WA-SAVE-BORM-BRANCH-NO  TO WA-SUSP-HOME-BR
SC6077     END-IF.
SC6077     MOVE WA-SAVE-BORM-CURRENCY      TO WA-SUSP-TYPE-CURRENCY.
SC4522     MOVE WA-SUSP-HOME-BR            TO WA-SUSP-BRANCH.
SC4522     PERFORM V910-READ-SUSPENSE-MASTER THRU V919-EXIT.
SC4522
SC4522 F100-EXIT.
SC4522     EXIT.
SC4522
SC4522 F140-DEBIT-FEDI-SUSP-GL.
SC5378     PERFORM FEDI-DEBIT-TXN-CODE-SETUP THRU FEDI-DEBIT-EXIT.
SC4522     MOVE SPACES         TO WA-GL-TXN-AREA.
SC4522     MOVE WA-TEMP-AMT2   TO WA-GL-AMOUNT.
SC4522     PERFORM Z5200-PROCESS-SUSP THRU Z5200-EXIT. 
SC4522     IF  WA-MSG-ERR-FLAG = 1
SC4522         GO TO F140-EXIT
SC4522     END-IF.
SC6077     MOVE WA-GL-AMOUNT     TO WA-SAVE-ACCT-AMT.
SC6077     MOVE STRT-AREA-TRN-NO TO WA-DUMMY-TRN-NO.
SC6077     PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
SC4522 F140-EXIT.
SC4522     EXIT.
SC4522
SC4522 F145-CREDIT-FEDI-SUSP-GL.
SC5378     PERFORM FEDI-CREDIT-TXN-CODE-SETUP THRU FEDI-CREDIT-EXIT.
SC4522     MOVE SPACES         TO WA-GL-TXN-AREA.
SC4522     MOVE WA-TEMP-AMT2   TO WA-GL-AMOUNT.
SC4522     PERFORM Z5200-PROCESS-SUSP THRU Z5200-EXIT. 
SC4522     IF  WA-MSG-ERR-FLAG = 1
SC4522         GO TO F145-EXIT
SC4522     END-IF.
SC6077     MOVE WA-GL-AMOUNT     TO WA-SAVE-ACCT-AMT.
SC6077     MOVE STRT-AREA-TRN-NO TO WA-DUMMY-TRN-NO.
SC6077     PERFORM E000-COMPLETION-PARA THRU E099-EXIT.
SC4522 F145-EXIT.
SC4522     EXIT.
SC4522
SC4522 Z5200-PROCESS-SUSP.
SC4522     MOVE SPACES                      TO DBIO-01-KEY.
SC4522     MOVE WA-INPUT-KEY-R              TO DBIO-01-ACCT-NO.
SC4522     PERFORM V700-READ-GLDM-RECORD THRU V799-EXIT.
SC4522     IF  WA-MSG-ERR-FLAG = 1
SC4522         GO TO Z5200-EXIT
SC4522     END-IF.
SC4522     MOVE WA-INPUT-KEY-R              TO WA-GL-ACCT-NO.
SC4522     MOVE STRT-AREA-POST-DT           TO UT0020-BINARY-DATE.
SC4522     MOVE 1                           TO UT0020-FUNCTION.
SC4522     PERFORM X600-UT0020-PARA THRU X609-EXIT.
SC4522     MOVE UT0020-DATE-DDMMCCYY        TO WA-GL-TXN-DATE.
SC4522     MOVE STRT-AREA-TRN-NO            TO LINK-IN-TXCODE.
SC4522     PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
SC4522     IF  WA-MSG-ERR-FLAG = 1
SC4522         GO TO Z5200-EXIT
SC4522     END-IF.
SC4522     MOVE 3                           TO GL-TRANS-IND.
SC4522     MOVE "0"                         TO GL-DONT-WRITE-GLDM-IND.
SC4522     MOVE SPACES                      TO WA-GL-DESC
SC4522                                         WA-GL-NAME-1
SC4522                                         WA-GL-NAME-2
SC4522                                         WA-GL-PROMO-NO.
SC4522     MOVE 0                           TO WA-GL-CHQ-NO
SC4522                                         WA-GL-CHQ-TYPE
SC4522                                         WA-GL-VALUE-DATE
SC4522                                         WA-GL-MSG-TYPE.
SC4522     MOVE WA-MULTI-CURR-AMT           TO WA-GL-SUSP-DESC-CURR-AMT.
SC4522     MOVE SOC-NATIVE-CURRENCY         TO WA-GL-SUSP-DESC-CURRENCY.
SC4522     MOVE WA-SUSP-TYPE-CURRENCY       TO WA-GL-CURRENCY.
SC4522     MOVE WA-SUSP-ACCT-NO             TO UT0151CA-ACCT-IN.
SC4522     MOVE 2                           TO UT0151CA-CALL-FUNC.
SC4522     MOVE SOC-ACCT-NO-FORMAT          TO UT0151CA-FORMAT.
SC4522     MOVE SOC-CHK-DGT                 TO UT0151CA-CHK-DGT-TYPE.
SC4522     CALL "UT0151" USING
SC4522                                         UT0151CA-CALL-AREA.
SC4522     IF UT0151CA-STATUS NOT = 0
SC4522        MOVE 1                        TO WA-MSG-ERR-FLAG
SC4522        GO TO Z5200-EXIT
SC4522     END-IF.
SC4522     MOVE UT0151CA-ACCT-EX            TO WA-GL-SUSP-DESC-ACCT-NO.
SC4522     MOVE CHECK-RESPONSE-ERR-NO       TO WA-GL-SUSP-DESC-ERR-NO.
SC4522     MOVE WA-IN-NARR-TEXT             TO WA-NARR-TEXT.
SC4522     MOVE WA-IN-SOURCE-APPLN          TO WA-SOURCE-APPLN.
SC6077     IF FEDI-FROM-TO-GL OR FEDI-FEE
SC6077        MOVE  0                       TO WA-GL-DEFER-DAYS
SC6077                                         WA-GL-DEBIT-DEFER-DAYS
SC6077        MOVE WA-SAVE-PROMO-NO         TO WA-GL-PROMO-NO
SC6077     END-IF.
SC4522     MOVE WA-GL-TXN-AREA              TO WA-INPUT-MSG.     
SC4522     IF  WA-INPUT-PARAM-TABLE(4) = "1"
SC4522         CALL "GL0023" USING
SC4522                                         STARTAREA
SC4522                                         GL-PASSALONG
SC4522                                         MULTI-OVERRIDE-AREA
SC4522                                         W300-ERROR-AREA
SC4522                                         CHECK-RESPONSE-AREA
SC4522                                         UTVTACCA-CALL-PARAM
SC4522     ELSE
SC4522         IF WA-INPUT-PARAM-TABLE(5) = "1"
SC4522             CALL "GL0024" USING
SC4522                                         STARTAREA
SC4522                                         GL-PASSALONG
SC4522                                         MULTI-OVERRIDE-AREA
SC4522                                         W300-ERROR-AREA
SC4522                                         CHECK-RESPONSE-AREA.
SC4522     IF ST-STATUS-LEVEL-1 NOT = ZERO
SC4522        MOVE 1                        TO WA-MSG-ERR-FLAG
SC4522     END-IF.
SC4522
SC4522 Z5200-EXIT.
SC4522       EXIT.
SC4522
SC4522 J220-VAL-FEDI-BP-ACCT.
SC4522        MOVE 01               TO UTSHRECA-CALL-CODE
SC4522        MOVE STRT-AREA-SOC-NO TO UTSHRECA-INST-NO
SC4522        CALL "UTSHRE" USING
SC4522                            UTSHRE-CALL-AREA
SC4522                            WA-PASSALONG
SC4522        IF NOT UTSHRECA-STATUS-OK
SC4522           MOVE 1    TO WA-MSG-ERR-FLAG
SC4522           MOVE 2368 TO WA-OUTPUT-ERR-MSG-NO
SC4522        END-IF.
SC4522 J229-EXIT.
SC4522     EXIT.
SC4522
SC4522 J230-VALIDATE-FEDI-CIF.
SC4522   MOVE SPACES            TO WA-VAL-FLG
SC4522                             WA-VAL-FIELD1
SC4522                             WA-VAL-FIELD2.
SC4522   EVALUATE STRT-AREA-TRN-NO
SC4522     WHEN 11045
SC4522     WHEN 11145
SC4522     WHEN 11055
SC4522     WHEN 11155
SC7091     WHEN 16045
SC7091     WHEN 16145
SC7091     WHEN 16055
SC7091     WHEN 16155
SC4522        MOVE VAL-FLG-11045     TO WA-VAL-FLG
SC4522        MOVE VAL-FIELD1-11045  TO WA-VAL-FIELD1
SC4522        MOVE VAL-FIELD2-11045  TO WA-VAL-FIELD2
SC4522     WHEN 11050
SC4522     WHEN 11150
SC7091     WHEN 16050
SC7091     WHEN 16150
SC4522        MOVE VAL-FLG-11050     TO WA-VAL-FLG
SC4522        MOVE VAL-FIELD1-11050  TO WA-VAL-FIELD1
SC4522        MOVE VAL-FIELD2-11050  TO WA-VAL-FIELD2
SC4522     WHEN 1030
SC4522     WHEN 1130
SC4522        MOVE VAL-FLG-11030     TO WA-VAL-FLG
SC4522        MOVE VAL-FIELD1-11030  TO WA-VAL-FIELD1
SC4522        MOVE VAL-FIELD2-11030  TO WA-VAL-FIELD2
SC4522   END-EVALUATE.
SC4522   IF WA-VAL-FLG = '1' OR '2'
SC4522      MOVE 01 TO UT0038CA-CALL-CODE
SC4522      MOVE STRT-AREA-SOC-NO TO UT0038CA-FEDI-SOC-NO
SC4522      MOVE WA-INPUT-KEY     TO UT0038CA-CUST-AC-TO
SC4522      MOVE WA-VAL-FLG       TO UT0038CA-FEDI-VAL-FLG   
SC4522      MOVE WA-VAL-FIELD1    TO UT0038CA-FEDI-VAL-FIELD1
SC4522      MOVE WA-VAL-FIELD2    TO UT0038CA-FEDI-VAL-FIELD2
SC4522      CALL "UT0038" USING UT0038-CALL-AREA 
SC4522                          STARTAREA
SC4522      IF UT0038CA-STATUS NOT = 0
SC4522         MOVE 1 TO WA-MSG-ERR-FLAG
SC4522         MOVE UT0038CA-OUT-ERR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
SC4522      END-IF
SC4522   END-IF.
SC4522 J239-EXIT.
SC4522     EXIT.
SC4522
SC4522 J240-SET-FEDI-FEE-FLAG.
SC4522   MOVE 0     TO WA-NET-RECEIVABLE
SC4522                 WA-NET-RECEIVED
SC4522                 WA-HAND-RECEIVABLE
SC4522                 WA-HAND-RECEIVED.
SC4522   MOVE SPACE TO WA-CHARGE-TYPE.
SC4522   EVALUATE STRT-AREA-TRN-NO
SC4522     WHEN 11045
SC4522     WHEN 11145
SC4522     WHEN 11055
SC4522     WHEN 11155
SC7091     WHEN 16045
SC7091     WHEN 16145
SC7091     WHEN 16055
SC7091     WHEN 16155
SC4522        IF NET-RECEIVABLE-11045 NUMERIC
SC4522           MOVE NET-RECEIVABLE-11045  TO WA-NET-RECEIVABLE
SC4522        END-IF
SC4522        IF NET-RECEIVED-11045 NUMERIC
SC4522           MOVE NET-RECEIVED-11045    TO WA-NET-RECEIVED  
SC4522        END-IF
SC4522        MOVE CHARGE-TYPE-11045     TO WA-CHARGE-TYPE
SC4522     WHEN 11050
SC4522     WHEN 11150
SC7091     WHEN 16050
SC7091     WHEN 16150
SC4522        IF HAND-RECEIVABLE-11050 NUMERIC
SC4522           MOVE HAND-RECEIVABLE-11050 TO WA-HAND-RECEIVABLE
SC4522        END-IF
SC4522        IF HAND-RECEIVED-11050 NUMERIC
SC4522           MOVE HAND-RECEIVED-11050   TO WA-HAND-RECEIVED  
SC4522        END-IF
SC4522        IF NET-RECEIVABLE-11050 NUMERIC
SC4522           MOVE NET-RECEIVABLE-11050  TO WA-NET-RECEIVABLE
SC4522        END-IF
SC4522        IF NET-RECEIVED-11050 NUMERIC
SC4522           MOVE NET-RECEIVED-11050    TO WA-NET-RECEIVED  
SC4522        END-IF
SC4522        MOVE CHARGE-TYPE-11050     TO WA-CHARGE-TYPE
SC4522   END-EVALUATE.
SC4522   IF (WA-CHARGE-TYPE = '1' OR '2')
SC4522   AND (WA-NET-RECEIVABLE > 0  OR
SC4522        WA-NET-RECEIVED > 0    OR
SC4522        WA-HAND-RECEIVABLE > 0 OR
SC4522        WA-HAND-RECEIVED > 0)
SC4522     MOVE "Y" TO WA-FEDI-FEE-FLAG
SC5378     IF WA-INPUT-PARAM-TABLE(29) = 1
SC5378        COMPUTE WA-FEDI-TO-TXN-AMT = WA-INPUT-AMT -
SC5378                                   WA-NET-RECEIVED -
SC5378                                   WA-HAND-RECEIVED
SC5378        MOVE WA-FEDI-TO-TXN-AMT TO FEDI-TO-TXN-AMT
SC5378     END-IF
SC4522   END-IF.
SC4522 J249-EXIT.
SC4522     EXIT.
SC4522
SC4522 FEDI-WRITE-VTPV.
SC4522   INITIALIZE WA-VTPV-RECORD-AREA.
SC4522   MOVE 0                   TO VTPV-ENTERPRISE-CODE.
SC4522   MOVE WA-FEDI-ACCT        TO VTPV-NOMINATED-ACCT-NO.
SC4522   IF WA-INPUT-PARAM-TABLE(4)  = 1 
SC4522      MOVE BORM-MEMB-CUST-AC TO VTPV-VT-ACCT
SC4522      MOVE WA-FEDI-ACCT      TO VTPV-TRANS-OUT-ACCT
SC4522   ELSE
SC4522      IF WA-INPUT-PARAM-TABLE(5) = 1
SC4522         MOVE BORM-MEMB-CUST-AC TO VTPV-TRANS-OUT-ACCT
SC4522         MOVE WA-FEDI-ACCT      TO VTPV-VT-ACCT
SC4522      END-IF
SC4522   END-IF.
SC4522   MOVE SOC-BANK-NO         TO VTPV-TRANSFER-BANK.
SC4522   MOVE WA-SAVE-FROM-BRANCH TO VTPV-TRANSFER-BRANCH.
SC4522   MOVE WA-SAVE-TO-BRANCH   TO VTPV-TO-ACT-BRANCH.
SC4522   MOVE STRT-AREA-TERM-NO   TO VTPV-TERM-NO.
SC4522   MOVE STRT-AREA-BRANCH    TO VTPV-TXN-BRANCH.
SC4522   MOVE STRT-AREA-TELL-NO   TO VTPV-TELL-NO.
SC4522   MOVE STRT-AREA-JRNL-NO   TO VTPV-JRNL-NO.
SC4522   MOVE W800-BAL            TO VTPV-DEPOSIT-AMOUNT.
SC4522   MOVE WA-FEDI-COM-CODE    TO VTPV-COMPANY-CODE.
SC4522   MOVE WA-FEDI-PAY-TYPE    TO VTPV-PAY-ITEM.
SC4522   MOVE NARRATIVE-11045     TO VTPV-BILL-DATA.
SC9973   MOVE UT1996CA-DATE       TO VTPV-SYS-DATE.
SC4522   SET VTPV-PYMT-BY-TRANSFER TO TRUE.
SC4522   PERFORM WRITE-VTPV THRU VTPV-EXIT.
SC4522   IF WA-MSG-ERR-FLAG = 1
SC4522      GO TO FEDI-VTPV-EXIT
SC4522   END-IF.
SC4522 FEDI-VTPV-EXIT.
SC4522     EXIT.
SC4522
TB0273 WRITE-VTPV.
TB0273     ADD 1 TO VTPV-COUNTER.
TB0273     MOVE STRT-AREA-TRN-NO TO WA-TRAN-X.
TB0273     IF CORRECTION-TXN
TB0273        MULTIPLY UTVTACCA-DEPOSIT-AMT BY -1 GIVING
TB0273            UTVTACCA-DEPOSIT-AMT.
TB0273     IF STRT-AREA-BATCH-TANDEM IS NUMERIC
TB0273        IF STRT-AREA-BATCH-TANDEM = "0"
TB0273           MOVE "OTC" TO VTPV-CHANNEL
TB0273        ELSE
TB0273           MOVE "ATM" TO VTPV-CHANNEL
TB0273        END-IF
TB0273     ELSE
TB0273        EVALUATE STRT-AREA-BATCH-TANDEM
TB0273            WHEN "I"
TB0273*               MOVE "IRV"  TO VTPV-CHANNEL    SC5960
SC5960                MOVE "IVR"  TO VTPV-CHANNEL
TB0273            WHEN "N"
TB0273                MOVE "IBB"  TO VTPV-CHANNEL
TB0273            WHEN "F"
TB0273                MOVE "FEDI" TO VTPV-CHANNEL
TB0273            WHEN "L"
TB0273                MOVE "B2B"  TO VTPV-CHANNEL
TB0273            WHEN "M"
TB0273                MOVE "REM"  TO VTPV-CHANNEL
TB0273            WHEN "P"
TB0273                MOVE "PDC"  TO VTPV-CHANNEL
TB0273            WHEN OTHER
TB0273                MOVE "OTHR" TO VTPV-CHANNEL
TB0273        END-EVALUATE.
TB0273     MOVE STRT-AREA-POST-DT        TO VTPV-TXN-DATE.
TB0273     MOVE STRT-AREA-MSG-TIME       TO VTPV-TXN-TIME.
TB0273     COMPUTE VTPV-TXN-TIME = STRT-AREA-MSG-TIME +
TB0273                             VTPV-COUNTER.
TB0273     MOVE "WRITE"           TO DBIOMOD-FUNCTION.
TB0273     MOVE ZEROES                   TO DBIOMOD-KEY-NO.
S19311*TB0113     MOVE VTPV-KEY                 TO DBIOMOD-KEY.
S19311     MOVE VTPV-KEY                 TO WA-VTPV-KEY.
S19311     MOVE VTPV-JRNL-NO             TO WA-VTPV-JRNL-NO.
S19311     MOVE WA-VTPV-KEY-AREA         TO DBIOMOD-KEY.
TB0273     PERFORM D200-READ-WRITE-VTPV THRU D299-EXIT.
TB0273
TB0273     IF READ-VTAM-RETURN-CD = 1
TB0273          MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
TB0273          MOVE 1 TO WA-MSG-ERR-FLAG
TB0273     END-IF.
TB0273
TB0273 VTPV-EXIT.
TB0273     EXIT.
TB0273 D200-READ-WRITE-VTPV.
TB0273
TB0273     MOVE "VTPV"            TO DBIOMOD-FILE
TB0273                               DBIOMOD-SUFFIX.
TB0273     MOVE "DBIO"            TO DBIOMOD-PREFIX.
TB0273     MOVE SPACES            TO DBIOMOD-RELEASE-LOCK
TB0273                               DBIOMOD-ACCESS-COMMAND
TB0273                               DBIOMOD-ACCESS-COND
TB0273                               DBIOMOD-STATUS.
TB0273
TB0273     CALL DBIOMODNAME USING
TB0273                             DBIOMOD-FILE
TB0273                             DBIOMOD-KEY
TB0273                             WA-VTPV-RECORD-AREA
TB0273                             DBIOMOD-FUNCTION
TB0273                             DBIOMOD-KEY-NO
TB0273                             DBIOMOD-RELEASE-LOCK
TB0273                             DBIOMOD-ACCESS-COMMAND
TB0273                             DBIOMOD-ACCESS-COND
TB0273                             DBIOMOD-STATUS.
TB0273
TB0273     IF DBIOMOD-STAT NOT = "****"
TB0273        MOVE 1 TO READ-VTAM-RETURN-CD
TB0273     ELSE
TB0273        MOVE 0 TO READ-VTAM-RETURN-CD
TB0273     END-IF.
TB0273
TB0273 D299-EXIT.
TB0273     EXIT.
SC5130
SC9693* DELETE BY PENNY ( UT0800  SUBSTITUTE FOR VA-POST-TO-VTPV
SC9693*                   WRITE VTPV TABLE  )
SC5130*VA-POST-TO-VTPV.
SC5130*    IF STRT-AREA-VIRTUAL-ACCT-FLAG NOT = "Y"
SC8085*    OR (UTVTACCA-POST-METHOD = "B" OR "C")
SC5130*       GO TO VA-EXIT.
SC5130*    MOVE WA-SAVE-UTVTAC-AREA TO UTVTACCA-CALL-PARAM.
SC7253*    MOVE "L"        TO UTVTACCA-SYS.
SC5130*    IF (UTVTACCA-ENTERPRISE-CODE <> 0) AND
SC5130*       (UTVTACCA-ENTERPRISE-CODE IS NUMERIC) AND
SC5130*       (WA-MSG-ERR-FLAG = 0)
SC5130*       MOVE 2              TO UTVTACCA-CALL-CODE
SC5130*       MOVE WA-INPUT-AMT   TO UTVTACCA-DEPOSIT-AMT
SC5340*       IF STRT-BANCSLINK
SC5340*           MOVE BORM-BR-NO          TO UTVTACCA-TRANSFER-BRANCH
SC5340*           MOVE WA-SAVE-TO-BRANCH   TO UTVTACCA-TO-ACCT-BRANCH
SC5340*       END-IF
SC5130*       CALL "UTVTAC"     USING
SC5130*                              STARTAREA
SC5130*                              UTVTACCA-CALL-PARAM
SC5130*       IF UTVTACCA-RET-STATUS  NOT = 0
SC5130*          MOVE 1                     TO WA-MSG-ERR-FLAG
SC5130*          MOVE UTVTACCA-ERROR-MSG-NO TO WA-OUTPUT-ERR-MSG-NO
SC4453*       ELSE                                                                  SC7253
SC4453*          MOVE WS-VIRTUAL-MSG TO MI0090CA-DATA-AREA                          SC7253
SC4453*          MOVE WA-OUTPUT-MSG TO  MI0090CA-DATA-AREA                          SC4453
SC5130*    END-IF.
SC5130*VA-EXIT.
SC5130*    EXIT.
SC9693*-----END DELETE
SC0883*CALCULATION OF MINIMUM DUE AMT FOR YOUBE LOAN
SC0883 Z100-CALCULATE-MIN-DUE-AMT.
S17192    MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE.
S17192    ADD  1                 TO UT0020-BINARY-DATE.
S17192    MOVE 2                 TO UT0020-FUNCTION.
S17192    CALL "UT0020"       USING UT0020-FUNCTION
S17192                              UT0020-DATE-AREA
S17192                              UT0020-BINARY-DATE.
S17192    MOVE UT0020-DATE-CCYYMMDD TO BMPT-EFFECTIVE-DATE.
SC0883    MOVE STRT-AREA-SOC-NO    TO BMPT-INST-NO
SC0883    MOVE "BOR"               TO BMPT-SYSTEM
SC0883    MOVE BORM-ACT-TYPE       TO BMPT-ACCT-TYPE
SC0883    MOVE BORM-CAT            TO BMPT-INT-CAT
S17192**SC0883 MOVE "99999999"          TO BMPT-EFFECTIVE-DATE
SC0883    MOVE BMPT-KEY            TO DBIOMOD-KEY
SC0883    MOVE ZEROES              TO DBIOMOD-KEY-NO
SC0883    MOVE "READNEXT"          TO DBIOMOD-FUNCTION
SC0883    MOVE "BMPT"              TO DBIOMOD-FILE
SC0883                                DBIOMOD-SUFFIX.
SC0883    MOVE "DBIO"              TO DBIOMOD-PREFIX
SC0883    MOVE SPACES              TO DBIOMOD-RELEASE-LOCK
SC0883                                DBIOMOD-STATUS
SC0883                                DBIOMOD-ACCESS-COMMAND
SC0883                                DBIOMOD-ACCESS-COND.
SC0883    CALL DBIOMODNAME USING    DBIOMOD-FILE
SC0883                              DBIOMOD-KEY
SC0883                              BMPT-RECORD-AREA
SC0883                              DBIOMOD-FUNCTION
SC0883                              DBIOMOD-KEY-NO
SC0883                              DBIOMOD-RELEASE-LOCK
SC0883                              DBIOMOD-ACCESS-COMMAND
SC0883                              DBIOMOD-ACCESS-COND
SC0883                              DBIOMOD-STATUS.
SC0883    IF DBIOMOD-STAT = "MRNF" OR
SC0883       DBIOMOD-STAT NOT = "****"
SC0883       MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO
SC0883            UT8500CA-CALL-CODE
SC0883       MOVE SPACES TO UT8500CA-INPUT-MSG
SC0883       STRING "BR0000:YOUBE PROCESS "
SC0883              "ERROR READING BMPTPARM TABLE " DBIOMOD-STAT
SC0883              "KEY " BMPT-KEY
SC0883              DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC0883              CALL "UT8500" USING UT8500CA-AREA
SC0883              GO TO Z109-EXIT.
SC2593    MOVE WA-DMY TO UT0020-BINARY-DATE.
SC2593    MOVE 2      TO UT0020-FUNCTION.
SC2593    CALL "UT0020"   USING UT0020-FUNCTION
SC2593                    UT0020-DATE-AREA
SC2593                    UT0020-BINARY-DATE.
SC2593    MOVE UT0020-DATE-CCYYMMDD TO WA-TODAY-DATE.
SC0883
SC0883*   IF BMPT-EFFECTIVE-DATE <= WA-TODAY-BINARY-DATE
SC2593    IF BMPT-EFFECTIVE-DATE <= WA-TODAY-DATE
SC0883       MOVE 0 TO RANGE-FOUND-SW
SC0883       PERFORM VARYING CTR FROM 1 BY 1 UNTIL RANGE-FOUND OR
SC0883                       CTR > 26
SC0883           IF BORM-LOAN-BAL >= BMPT-MIN-AMOUNT(CTR) AND
SC0883              BORM-LOAN-BAL <= BMPT-MAX-AMOUNT(CTR)
SC0883              MOVE BMPT-MAX-AMOUNT(CTR) TO WA-MAX-AMOUNT
SC0883              MOVE 1 TO RANGE-FOUND-SW
SC0883           END-IF
SC0883       END-PERFORM
SC0883
SC0883       MOVE 0 TO WA-MIN-DUE-AMT
SC0883       SUBTRACT 1 FROM CTR
SC0883       MOVE BOIS-REV-RECEIVABLE-DUE  TO WA-REV-RECEIVABLE
SC0883
SC0883       IF BMPT-MIN-REPAYMENT(CTR) NOT ZEROES
SC0883          MOVE BMPT-MIN-REPAYMENT(CTR) TO WA-FIX-MIN-REPAYMENT
SC9654                                          WA-MIN-DUE-AMT
SC9654*         COMPUTE WA-MIN-DUE-AMT = WA-REV-RECEIVABLE +  
SC9654*                WA-FIX-MIN-REPAYMENT                   
SC0883       ELSE
SC0883         IF BMPT-MIN-PAYMT-RATIO(CTR) NOT ZEROES
SC0883            MOVE BMPT-MIN-PAYMT-RATIO(CTR) TO WA-PAYMT-RATIO
SC9654*             COMPUTE WA-MIN-DUE-AMT = WA-REV-RECEIVABLE + 
S11743*             COMPUTE WA-MIN-DUE-AMT =                     
S11743*                     (WA-MAX-AMOUNT * (WA-PAYMT-RATIO / 100))
S11743              MOVE ZEROES                  TO WA-ROUND-AMNT-0
S11743              COMPUTE WA-ROUND-AMNT-0 ROUNDED =              
S11743                      (BORM-LOAN-BAL * WA-PAYMT-RATIO)       
S11743              MOVE WA-ROUND-AMNT-0         TO WA-MIN-DUE-AMT 
SC0883         END-IF
SC0883       END-IF
SC0883    END-IF.
SC0883
SC0883 Z109-EXIT.
SC0883    EXIT.
SC0883*
SC1857 Z200-GET-GRACE-DAYS.
SC1857     MOVE BOIS-NEXT-DUE-DATE  TO UT0020-BINARY-DATE.
SC1857     MOVE 2                   TO UT0020-FUNCTION.
SC1857     CALL "UT0020"         USING UT0020-FUNCTION
SC1857                                 UT0020-DATE-AREA
SC1857                                 UT0020-BINARY-DATE.
SC1857     MOVE UT0020-DATE-CCYYMMDD
SC1857                           TO UT0310CA-CALENDAR-IN-CCYYMMDD.
SC1857
SC1857     MOVE STRT-AREA-POST-DT   TO UT0020-BINARY-DATE.
SC1857     MOVE 2                   TO UT0020-FUNCTION.
SC1857     CALL "UT0020"         USING UT0020-FUNCTION
SC1857                                 UT0020-DATE-AREA
SC1857                                 UT0020-BINARY-DATE.
SC1857     MOVE UT0020-DATE-CCYYMMDD
SC1857                           TO UT0310CA-CALENDAR-OUT-CCYYMMDD.
SC1857
SC1857     MOVE 00               TO UT0310CA-CALENDAR-CODE.
SC1857     MOVE 03               TO UT0310CA-CALL-FUNC.
SC1857     MOVE STRT-AREA-SOC-NO TO UT0310CA-SOC-NO.
SC1857     CALL "UT0310"      USING UT0310CA-REC.
SC1857     IF UT0310CA-CALL-STATUS = 0
SC1857        MOVE UT0310CA-WORK-DAYS   TO WA-GRACE-DAYS
SC1857     ELSE
SC1857        MOVE 0                    TO WA-GRACE-DAYS
SC1857     END-IF.
SC1857 Z209-EXIT.
SC1857     EXIT.
SC1857*
TBN226 Z999-CLCM-85007-SCHED.
      *=================
SC5868     MOVE WA-SAVE-INPUT-ACCT-NO TO BR0000-85007-CUST-ACCT-NO.
SC4446*    MOVE BORM-MEMB-CUST-AC TO BR0000-85007-CUST-ACCT-NO.          SC4446
SC4446*    MOVE BORM-ACT-TYPE     TO BR0000-85007-ACCT-TYPE.             SC4446
SC4446*    MOVE BORM-CAT          TO BR0000-85007-INT-CAT.               SC4446
SC4446*    MOVE "LON"             TO BR0000-85007-SYSTEM.                SC4446
SC5286*** GET ID-NO FROM A/C                     
              MOVE "EE"                TO DBIO-CALL-TXN-TYPE-AREA.
              MOVE SPACES              TO DBIO-CALL-PARAM.
              MOVE 0                   TO DBIO-CALL-REFER-AREA.
              MOVE 61                  TO DBIO-CALL-FUNC.
              MOVE STRT-AREA-SOC-NO    TO WA-SOC-NO.
              MOVE WA-INPUT-ACCT-NO    TO WA-CUST-NO.
              MOVE WA-DUMMY-KEY        TO DBIO-CALL-KEY-AREA.
              PERFORM U200-CUSVEE-ACCESS THRU U299-EXIT.
              IF DBIO-CALL-STATUS NOT = "****"
               MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
               MOVE SPACES TO UT8500CA-INPUT-MSG
               STRING "BR0000 Z999: PROBLEM IN CUSVEE-ACCESS "
                   DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
               CALL "UT8500" USING
                                   UT8500CA-AREA
               MOVE 155            TO WA-OUTPUT-ERR-MSG-NO
               MOVE 1              TO WA-MSG-ERR-FLAG
               CALL "FT0000" USING STARTAREA
               GO                  TO Z999-CLCM-EXIT
              ELSE
                 MOVE CUSV-EE-ID-NO(1) TO WA-IDNO-KEY.          
SC5286***********END OF GET IDNO*****************     
TBN226     MOVE STRT-AREA-SOC-NO TO CLCM-INST-NO.
TBN226     MOVE WA-ID-NO         TO CLCM-CUST-ID-NO.
TBN226     MOVE WA-ID-TYPE       TO CLCM-CUST-ID-TYPE.
TBN226     MOVE "IVR"            TO CLCM-CHANNEL.
TBN226     MOVE CLCM-KEY         TO DBIOMOD-KEY.
TBN226     MOVE 0                TO DBIOMOD-KEY-NO.
TB0226     SET READ-CMD          TO TRUE.
TBN226
TBN226     MOVE "CLCM"         TO DBIOMOD-FILE
TBN226                            DBIOMOD-SUFFIX.
TBN226     MOVE "DBIO"         TO DBIOMOD-PREFIX.
TBN226     MOVE SPACES         TO DBIOMOD-RELEASE-LOCK
TBN226     MOVE SPACES         TO DBIOMOD-ACCESS-COMMAND
TB0226                            DBIOMOD-ACCESS-COND
TBN226                            DBIOMOD-STATUS.
TBN226     CALL DBIOMODNAME USING DBIOMOD-FILE
TBN226                            DBIOMOD-KEY
TBN226                            WA-CLCM-REC
TBN226                            DBIOMOD-FUNCTION
TBN226                            DBIOMOD-KEY-NO
TBN226                            DBIOMOD-RELEASE-LOCK
TBN226                            DBIOMOD-ACCESS-COMMAND
TBN226                            DBIOMOD-ACCESS-COND
TBN226                            DBIOMOD-STATUS.
TBN226     IF DBIOMOD-STAT = "****"
TBN226        IF CLCM-FLAG-NO
TBN226           MOVE "A" TO BR0000-85007-FUNCTION
TBN226           MOVE CLCM-CUST-ID-TYPE   TO BR0000-85007-CUST-ID-TYPE
TBN226           MOVE CLCM-CUST-ID-NO     TO BR0000-85007-CUST-ID-NO
TBN226           MOVE CLCM-CHANNEL        TO BR0000-85007-CHANNEL
TBN226           MOVE CLCM-ACCESS-FLAG    TO BR0000-85007-ACC-FLAG
TBN226           MOVE CLCM-FUNCTION-RANGE TO BR0000-85007-FUNC-RANGE
TBN226*
TBN226           MOVE 998   TO WA-OUTPUT-ERR-MSG-NO
TBN226           MOVE 85007 TO STRT-AREA-TRN-NO
SC5868           MOVE 38    TO WA-OUTPUT-MSG-LENGTH
TBN226           MOVE 6     TO STRT-AREA-IEXEC-CNTL
SC4085           MOVE 03    TO WA-INPUT-MSG-TYPE
TBN226        END-IF
SC2881     ELSE IF DBIOMOD-STAT = "MRNF"
SC2881           MOVE "A" TO BR0000-85007-FUNCTION
SC2881           MOVE WA-ID-TYPE          TO BR0000-85007-CUST-ID-TYPE
SC2881           MOVE WA-ID-NO            TO BR0000-85007-CUST-ID-NO
SC2881           MOVE "IVR"               TO BR0000-85007-CHANNEL
SC2881*          MOVE "N"                 TO BR0000-85007-ACC-FLAG
SC3773           MOVE "Y"                 TO BR0000-85007-ACC-FLAG
SC2881           MOVE "0"                 TO BR0000-85007-FUNC-RANGE
SC2881*
SC2881           MOVE 998   TO WA-OUTPUT-ERR-MSG-NO
SC2881           MOVE 85007 TO STRT-AREA-TRN-NO
SC5868           MOVE 38    TO WA-OUTPUT-MSG-LENGTH
SC2881           MOVE 6     TO STRT-AREA-IEXEC-CNTL
SC4085           MOVE 03    TO WA-INPUT-MSG-TYPE
TBN226     ELSE
TBN226        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
TBN226                           TO UT8500CA-CALL-CODE
TBN226        MOVE SPACES TO UT8500CA-INPUT-MSG
TBN226        STRING "BR0000(CLCM): ERROR IN CLCM READ "
TBN226                    DBIO-CALL-STATUS
TBN226        DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
TBN226        CALL "UT8500" USING
TBN226                           UT8500CA-AREA
TBN226        MOVE 155          TO WA-OUTPUT-ERR-MSG-NO
TBN226        MOVE 1            TO WA-MSG-ERR-FLAG
TBN226        MOVE "CLCM"       TO WA-OUTPUT-DATA-SET
TBN226     END-IF.
TBN226     CALL "FT0000" USING STARTAREA.
TBN226
TBN226 Z999-CLCM-EXIT.
TBN226*-----------------------
TBN226     EXIT.
SC1231 B3100-CONV-DATE-TO-BINARY.
SC1231     MOVE 01 TO UT0030-FUNCTION
SC1231     CALL "UT0030" USING UT0030-FUNCTION
SC1231                         UT0030-DATE-AREA
SC1231                         UT0030-BINARY-DATE.
SC1231 B3100-CONV-EXIT.
SC1231     EXIT.
SC1231 B3200-PROC-DT.
SC1231     IF WA-ADV-DATER-MM = 2
SC1231        IF WA-ADV-DATER-DD > 28
SC1231           MOVE 29 TO WA-ADV-DATER-DD
SC1231           MOVE 1               TO  UT0030-FUNCTION
SC1231           MOVE WA-ADV-DATE     TO  UT0030-DATE-DDMMCCYY
SC1231           CALL "UT0030" USING UT0030-FUNCTION
SC1231                               UT0030-DATE-AREA
SC1231                               UT0030-BINARY-DATE
SC1231           IF UT0030-BINARY-DATE = 0
SC1231              MOVE 28 TO WA-ADV-DATER-DD
SC1231           END-IF
SC1231        END-IF
SC1231     ELSE
SC1231        IF WA-ADV-MONTH-31
SC1231           IF WA-ADV-DATER-DD > 31
SC1231              MOVE 31 TO WA-ADV-DATER-DD
SC1231           END-IF
SC1231        ELSE
SC1231          IF WA-ADV-DATER-DD > 30
SC1231             MOVE 30 TO WA-ADV-DATER-DD
SC1231          END-IF
SC1231        END-IF
SC1231     END-IF.
SC1231 B3200-PROC-EXIT.
SC1231     EXIT.
SC3865/                                                   
SC3865 NEGO-RATE-SET.                                     
SC3865     MOVE 61                 TO DBIO-CALL-FUNC      
SC3865     MOVE "NI"               TO BLDV-NI-TRAN-TYPE   
SC3865     MOVE STRT-AREA-SOC-NO   TO DBIO-01-SOC-NO      
SC3865     MOVE WA-INPUT-ACCT-NO   TO DBIO-01-ACCT-NO     
SC3865     MOVE DBIO-01-KEY        TO DBIO-CALL-KEY-AREA  
SC3865     MOVE "BORM"             TO DBIO-CALL-N-SYS     
SC3865     MOVE "BLDV"             TO DBIO-CALL-SYST-VAR  
SC3865     MOVE "NI"               TO DBIO-CALL-CODE-B    
SC3865     MOVE 0                  TO DBIO-CALL-REFER-AREA
SC3865     MOVE SPACES             TO DBIO-CALL-STATUS    
SC3865     CALL "DBIO" USING DBIO-CALL-PARAM              
SC3865                       DBIO-CALL-SYS-AREA           
SC3865                       DBIO-CALL-KEY-AREA           
SC3865                       DBIO-CALL-STATUS             
SC3865                       WA-BLDV-AREA-NI              
SC3865                       DBIO-CALL-REFER-AREA         
SC3865                       DBIO-CALL-TXN-TYPE-AREA      
SC3865                                                    
SC3865     IF DBIO-CALL-SAVE-REFER = "END."               
SC3865      OR DBIO-CALL-STATUS = "MRNF"                  
SC3865        GO TO NEGO-RATE-SET-EXIT                    
SC3865     END-IF.                                            
SC5219     MOVE 0                       TO    WA-SUB1.
SC5219     PERFORM VARYING WA-CNT FROM 1 BY 1 UNTIL WA-CNT > 15
SC5219       IF BLDV-NI-START-DATE (WA-CNT)      >= STRT-AREA-POST-DT
SC5219          IF   BLDV-NI-START-DATE (WA-CNT)  = STRT-AREA-POST-DT
SC5219            IF WA-CNT                       = 1
SC5219            OR BLDV-NI-START-DATE (WA-CNT) <> BOIS-LAST-EXP-DATE
S11115            OR BLDV-NI-END-DATE (WA-CNT)   <> BOIS-RATE-EXP-DATE
SC5219               MOVE WA-CNT                 TO WA-SUB1
SC5219               MOVE 15                     TO WA-CNT
S11115            ELSE
S11115              IF ( BLDV-NI-RATE-FLAG (WA-CNT) = '1'
S11115               AND BLDV-NI-RATE (WA-CNT)     <> BORM-STORE-RATE )
S11115              OR ( BLDV-NI-RATE-FLAG (WA-CNT) = '2'
S11115               AND BLDV-NI-RATE (WA-CNT)     <> BORM-RT-INCR )
S11115              OR ( BLDV-NI-RATE-FLAG (WA-CNT) = '3'
S11115               AND BLDV-NI-RATE (WA-CNT)     <> BORM-STORE-RATE )
S11115              OR ( BLDV-NI-RATE-FLAG (WA-CNT) <>
S11115                                           BOIS-NEGO-RATE-FLAG )
S11115                   MOVE WA-CNT             TO WA-SUB1
S11115                   MOVE 15                 TO WA-CNT
S11115              END-IF
SC5219            END-IF
SC5219          ELSE
SC5219            IF BLDV-NI-START-DATE (WA-CNT) <> BOIS-RATE-EXP-DATE
SC5219               MOVE WA-CNT                 TO WA-SUB1
SC5219            END-IF
SC5219            MOVE 15                        TO WA-CNT
SC5219          END-IF
SC5219       ELSE
SC5219          IF BLDV-NI-START-DATE (WA-CNT)   =  ZEROS
SC5219               MOVE 15                     TO WA-CNT
SC5219          END-IF
SC5219       END-IF
SC5219     END-PERFORM.
S16253     MOVE 0                                TO WS-NEW-EXP-DATE.
S16253     PERFORM VARYING WA-CNT FROM 1 BY 1 UNTIL WA-CNT > 15
S16253       IF ( BLDV-NI-START-DATE (WA-CNT)     >  0
S16253       AND  BLDV-NI-END-DATE   (WA-CNT)     >  0
S16253       AND  BLDV-NI-CREATE-DT  (WA-CNT)     >  0
S16253       AND  BLDV-NI-RATE-FLAG  (WA-CNT) NOT =  " " )
S16253            MOVE BLDV-NI-END-DATE (WA-CNT) TO WS-NEW-EXP-DATE
S16253       END-IF
S16253     END-PERFORM.
SC5219     IF WA-SUB1                = ZEROS
S16253        IF ( WS-NEW-EXP-DATE   > 0
S16253        AND  BOIS-RATE-EXP-DATE NOT = WS-NEW-EXP-DATE )
S16253             MOVE WS-NEW-EXP-DATE TO BOIS-RATE-EXP-DATE
S16253        END-IF
SC5219        GO    TO               NEGO-RATE-SET-EXIT.
SC5219     IF BLDV-NI-START-DATE(WA-SUB1) > STRT-AREA-POST-DT
SC5219**      MOVE BLDV-NI-END-DATE(WA-SUB1)  TO BOIS-RATE-EXP-DATE
SC0224        MOVE BLDV-NI-START-DATE(WA-SUB1) TO BOIS-RATE-EXP-DATE
SC5219                                     BOIS-NEGO-NEXT-RATE-DATE
SC0224        MOVE "X"                        TO WA-UPDATE-INT-INCR
SC5219        GO    TO               NEGO-RATE-SET-EXIT
SC5219     END-IF.
SC3865                                                        
SC5219     IF BLDV-NI-START-DATE (WA-SUB1) = STRT-AREA-POST-DT
SC3865        MOVE BORM-STORE-RATE      TO WA-SAVE-INT-RATE   
SC5219        MOVE BLDV-NI-END-DATE(WA-SUB1)  TO BOIS-RATE-EXP-DATE
SC4383                                     BOIS-NEGO-NEXT-RATE-DATE
SC5219        IF BLDV-NI-RATE-FLAG (WA-SUB1) = 2
SC4430           MOVE 0                 TO BORM-INT-RATE          
SC5219           MOVE BLDV-NI-RATE-FLAG (WA-SUB1) TO BOIS-NEGO-RATE-FLAG
SC4383           MOVE 0                 TO BORM-RT-INCR
SC3865           PERFORM X710-GET-RATE  THRU  X719-EXIT       
SC3865           IF WA-MSG-ERR-FLAG = 1                       
SC3865              GO TO NEGO-RATE-SET-EXIT                  
SC3865           END-IF                                       
SC3865                                                        
SC3865**SC4430   MOVE WA-INT-RATE-BASM  TO WA-INT-RATE-A      
SC3865**SC4430   ADD  BLDV-NI-RATE(1)   TO WA-INT-RATE-A      
SC3865**SC4430   MOVE BLDV-NI-RATE(1)   TO BORM-INT-INCR      
SC3865**SC4430   MOVE WA-INT-RATE-A     TO BORM-STORE-RATE    
SC4430           COMPUTE WA-INT-RATE-A-NEG = WA-INT-RATE-A  
SC5219                                     + BLDV-NI-RATE(WA-SUB1)
SC4430           MOVE WA-INT-RATE-A-NEG TO BORM-STORE-RATE  
SC4430                                     WA-INT-RATE-A    
SC5219           MOVE BLDV-NI-RATE(WA-SUB1)   TO BORM-RT-INCR
S16064         IF  BOIS-EFR-CHNG-IND  NOT =  "1"
S11337           MOVE "0"                     TO BOIS-EFR-CHNG-IND
S16064         END-IF
SC3865        ELSE                                            
SC5219           MOVE BLDV-NI-RATE(WA-SUB1)   TO BORM-INT-RATE
SC3865                                     BORM-STORE-RATE    
SC3865                                     WA-INT-RATE-A      
SC3865           MOVE ZEROES            TO BORM-INT-INCR      
SC4383           MOVE 0                 TO BORM-RT-INCR
S16064         IF  BOIS-EFR-CHNG-IND  NOT =  "1"
S11337           MOVE SPACES            TO BOIS-EFR-CHNG-IND
S16064         END-IF
SC3865        END-IF                                          
SC3865                                                        
SC5219        MOVE BLDV-NI-RATE-FLAG(WA-SUB1) TO BOIS-NEGO-RATE-FLAG
SC3865                                                       
SC3865        MOVE STRT-AREA-POST-DT TO WA-ADV-DATE-BIN      
SC3865                                                       
SC3865        IF BORM-STORE-RATE NOT = WA-SAVE-INT-RATE      
SC3865           PERFORM M500-MAINTAIN-RATE-HISTORY          
SC3865              THRU M500-EXIT                           
SC3865        END-IF                                         
SC3865                                                       
SC3865        MOVE "Y"                  TO WA-UPDATE-INT-INCR
S18344*S15727 IF ( BORP-FINE-METH    =  14 )
S18344        IF ( PROD-CAR-SME )
S15727             SET  BROKERAGE-FEE-TYPE TO TRUE
S15727             PERFORM N800-PROCESS-BANK-RATE THRU N800-EXIT
S15727             IF ( WA-MSG-ERR-FLAG = 1 )
S15727                  GO              TO NEGO-RATE-SET-EXIT
S15727             END-IF
S15727             MOVE WS-BANK-RATE    TO BOIS-BANK-RATE
S15727        END-IF
SC3865     END-IF.                                           
SC3865
SC3865 NEGO-RATE-SET-EXIT.                                   
SC3865     EXIT.                                             
SC5203**--
SC5203 O143-CHECK-XFAR.
SC5203
SC5203     INITIALIZE                XFAR-KEY.
SC5203     MOVE STRT-AREA-SOC-NO  TO XFAR-SOC-NO.
SC5203     MOVE "BOR"             TO XFAR-SYSTEM.
SC5203     MOVE BORM-MEMB-CUST-AC TO XFAR-ACCT-NO.
SC5203     MOVE 71                TO DBIO-CALL-FUNC.
SC5203
SC5203     PERFORM G600-ACCESS-XFAR THRU G699-EXIT
SC5203     IF WS-NO-REC-FOUND  = "N"
SC5203        GO TO O143-EXIT
SC5203     ELSE
SC5203        PERFORM G610-ACCESS-XPFM THRU G610-EXIT
SC5203        VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB > 3
SC5203             OR XFAR-EXPOSURE-NO(WS-SUB) = 0
SC5203        IF WA-MSG-ERR-FLAG  = 1
SC5203           PERFORM E000-COMPLETION-PARA
SC5203              THRU E099-EXIT
SC5203           GO TO O143-EXIT
SC5203        ELSE
SC5203           MOVE STRT-AREA-SOC-NO     TO XFAR-SOC-NO
SC5203           MOVE "BOR"                TO XFAR-SYSTEM
SC5203           MOVE BORM-MEMB-CUST-AC    TO XFAR-ACCT-NO
SC5203           MOVE 73                   TO DBIO-CALL-FUNC
SC5203
SC5203           PERFORM G600-ACCESS-XFAR THRU G699-EXIT
SC5203           IF WA-MSG-ERR-FLAG  = 1
SC5203              PERFORM E000-COMPLETION-PARA
SC5203                 THRU E099-EXIT
SC5203              GO TO O143-EXIT
SC5203           END-IF
SC5203        END-IF
SC5203     END-IF.
SC5203
SC5203 O143-EXIT.
SC5203
SC5203 G600-ACCESS-XFAR.
SC5203
SC5203     MOVE XFAR-KEY          TO DBIO-CALL-KEY-AREA
SC5203     MOVE "XFAR    "        TO DBIO-CALL-SYS-AREA
SC5203     MOVE SPACES            TO DBIO-CALL-STATUS.
SC5203     CALL "DBIO" USING         DBIO-CALL-PARAM
SC5203                               DBIO-CALL-SYS-AREA
SC5203                               DBIO-CALL-KEY-AREA
SC5203                               DBIO-CALL-STATUS
SC5203                               XFAR-AREA
SC5203                               DBIO-CALL-REFER-AREA.
SC5203     IF DBIO-CALL-STATUS  = "MRNF"
SC5203        MOVE "N" TO WS-NO-REC-FOUND
SC5203        GO TO G699-EXIT
SC6376     ELSE
SC6376        IF DBIO-CALL-STATUS = "****"
SC6376           MOVE "Y" TO WS-NO-REC-FOUND
SC6376        END-IF
SC5203     END-IF.
SC5203
SC5203     IF DBIO-CALL-STATUS <> "****"
SC5203        MOVE "N"              TO WS-NO-REC-FOUND
SC5203        MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
SC5203        MOVE DBIO-CALL-N-SYS  TO WA-OUTPUT-DATA-SET
SC5203        MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
SC5203        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
SC5203        MOVE SPACES TO UT8500CA-INPUT-MSG
SC5203        STRING "BR0000:(G100) 'XFAR' READ ERROR, STAT- "
SC5203                DBIO-CALL-STATUS ", KEY- "
SC5203                DBIO-CALL-KEY-AREA
SC5203                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC5203        CALL "UT8500" USING
SC5203                      UT8500CA-AREA
SC5203        MOVE 1 TO WA-MSG-ERR-FLAG
SC5203        GO TO G699-EXIT
SC5203     END-IF.
SC5203
SC5203 G699-EXIT.
SC5203     EXIT.
SC5203
SC5203 G610-ACCESS-XPFM.
SC5203
SC5203     INITIALIZE                       XPFM-KEY.
SC5203     MOVE STRT-AREA-SOC-NO         TO XPFM-INST-NO.
SC5203     MOVE XFAR-EXPOSURE-NO(WS-SUB) TO XPFM-FACILITY-NO.
SC5203     MOVE 71                       TO DBIO-CALL-FUNC.
SC5203     MOVE XPFM-KEY                 TO DBIO-CALL-KEY-AREA
SC5203     PERFORM G200-READ-XPFM
SC5203        THRU G299-EXIT.
SC5203
SC5203     IF WA-MSG-ERR-FLAG > 0
SC5203        PERFORM E000-COMPLETION-PARA
SC5203           THRU E099-EXIT
SC5203        GO TO G610-EXIT
SC5203     END-IF.
SC5203
SC5203     IF XPFM-DRAWDOWN-ACCT-OPN
SC5203        MOVE XPFM-RESERVED-LIMIT TO WA-RESERVED-AMT
SC5203        COMPUTE WA-RESERVED-AMT =
SC5203                WA-RESERVED-AMT - BORM-APPLIC-AMOUNT
SC5203        INITIALIZE                       XPFM-KEY
SC5203        MOVE STRT-AREA-SOC-NO         TO XPFM-INST-NO
SC5203        MOVE XFAR-EXPOSURE-NO(WS-SUB) TO XPFM-FACILITY-NO
SC5203        MOVE WA-RESERVED-AMT          TO XPFM-RESERVED-LIMIT
SC5203        MOVE 74                       TO DBIO-CALL-FUNC
SC5203        MOVE XPFM-KEY                 TO DBIO-CALL-KEY-AREA
SC5203        PERFORM G200-READ-XPFM
SC5203           THRU G299-EXIT
SC5203        IF WA-MSG-ERR-FLAG > 0
SC5203           PERFORM E000-COMPLETION-PARA
SC5203              THRU E099-EXIT
SC5203           GO TO G610-EXIT
SC5203        END-IF
SC5203     END-IF.
SC5203
SC5203 G610-EXIT.
SC5203     EXIT.
SC5203
SC5203 G200-READ-XPFM.
SC5203
SC5203     MOVE "XPFM    "           TO DBIO-CALL-SYS-AREA.
SC5203     MOVE SPACES               TO DBIO-CALL-STATUS.
SC5203     CALL "DBIO" USING            DBIO-CALL-PARAM
SC5203                                  DBIO-CALL-SYS-AREA
SC5203                                  DBIO-CALL-KEY-AREA
SC5203                                  DBIO-CALL-STATUS
SC5203                                  XPFM-AREA
SC5203                                  DBIO-CALL-REFER-AREA.
SC5203     IF DBIO-CALL-STATUS NOT = "****"
SC5203        IF DBIO-CALL-STATUS  = "MRNF"
SC5203           MOVE 1702          TO WA-OUTPUT-ERR-MSG-NO
SC5203        ELSE
SC5203           MOVE 155           TO WA-OUTPUT-ERR-MSG-NO
SC5203        END-IF
SC5203        MOVE DBIO-CALL-N-SYS  TO WA-OUTPUT-DATA-SET
SC5203        MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
SC5203        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
SC5203        MOVE SPACES TO UT8500CA-INPUT-MSG
SC5203        STRING "BR0000:(G200) 'XPFM' READ ERROR, STAT- "
SC5203                DBIO-CALL-STATUS ", KEY- "
SC5203                DBIO-CALL-KEY-AREA
SC5203                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC5203        CALL "UT8500" USING
SC5203                      UT8500CA-AREA
SC5203        MOVE 1 TO WA-MSG-ERR-FLAG
SC5203        GO TO G299-EXIT
SC5203     END-IF.
SC5203
SC5203 G299-EXIT.
SC5203     EXIT.
SC5203**--
S15779 G300-FORMAT-MICV.
S15779
S15779     MOVE 03                     TO WK5003-CALL-CODE.
S15779     MOVE BORM-CUSTOMER-NO       TO WK5003-CIF-NO.
S15779     PERFORM G310-CALL-UT5003  THRU G319-EXIT.
S15779     IF   WA-MSG-ERR-FLAG        =  1
S15779          GO                     TO G399-EXIT.
S15779     MOVE UT5003CA-ID-NO         TO MICM-ID-NO.
S15779     MOVE UT5003CA-ID-TYPE       TO MICM-ID-TYPE.
S15779 G302.
S15779     MOVE ZERO TO DBIO-CALL-REFER-AREA.
S15779     MOVE STRT-AREA-SOC-NO OF STARTAREA TO MICV-SOC-NO.
S15779     MOVE MICM-IDENTITY-NO TO MICV-IDENTITY-NO.
S15779     MOVE MICV-KEY TO DBIO-CALL-KEY-AREA.
S15779 G303.
S15779     MOVE 81 TO DBIO-CALL-FUNC.
S15779     PERFORM G320-ACCESS-MICV THRU G329-EXIT.
S15779     IF DBIO-CALL-SAVE-REFER = "END."
S15779        INITIALIZE WA-MICV-AREA
S15779        MOVE ZERO TO ID-SUB
S15779        MOVE 82 TO DBIO-CALL-FUNC
S15779        GO TO G304.
S15779     IF DBIO-CALL-STATUS NOT = "****"
S15779        MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
S15779        MOVE 1   TO WA-MSG-ERR-FLAG
S15779        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
S15779        MOVE SPACES TO UT8500CA-INPUT-MSG
S15779        STRING "BR0000:(G300) 'MICV' READ ERROR, STAT- "
S15779                DBIO-CALL-STATUS
S15779               ", KEY- " DBIO-CALL-KEY-AREA
S15779            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S15779        CALL "UT8500" USING UT8500CA-AREA
S15779        GO TO G399-EXIT.
S15779     MOVE ZERO TO ID-SUB.
S15779     MOVE 84 TO DBIO-CALL-FUNC.
S15779 G304.
S15779     IF ID-SUB < 20
S15779        ADD 1 TO ID-SUB
S15779     ELSE
S15779        GO TO G303.
S15779     IF BORM-MEMB-CUST-AC  = MICV-ACCOUNT-NO(ID-SUB)
S17464        IF STRT-AREA-TRN-NO  = 17200
S17464           MOVE "P" TO MICV-STATUS(ID-SUB)
S17464        ELSE
S15779           MOVE "C" TO MICV-STATUS(ID-SUB)
S17464        END-IF
S15779     ELSE
S15779        GO TO G304.
S15779
S15779     MOVE STRT-AREA-SOC-NO OF STARTAREA TO MICV-SOC-NO.
S15779     MOVE MICM-IDENTITY-NO TO MICV-IDENTITY-NO.
S15779     MOVE MICV-KEY TO DBIO-CALL-KEY-AREA.
S15779     PERFORM G320-ACCESS-MICV THRU G329-EXIT.
S15779     IF DBIO-CALL-STATUS NOT = "****"
B19432*S15779        IF DBIO-CALL-STATUS = "XNOT"
B19432        IF DBIO-CALL-STATUS = "HELD"
S15779           PERFORM G320-ACCESS-MICV THRU G329-EXIT
S15779             VARYING WA-HELD-COUNT FROM 1 BY 1
S15779             UNTIL DBIO-CALL-STATUS = "****"
B19392*S15779                OR WA-HELD-COUNT > 5
B19392                OR WA-HELD-COUNT > DLAYHERECA-RETRIES-50
S15779           IF DBIO-CALL-STATUS = "****"
S15779              GO TO G399-EXIT
S15779           ELSE
S15779              MOVE 112 TO WA-OUTPUT-ERR-MSG-NO
S15779           END-IF
S15779        ELSE
S15779           MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
S15779        END-IF
S15779        MOVE 155 TO WA-ERR-MSG-NO
S15779        MOVE 1   TO WA-MSG-ERR-FLAG
S15779        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
S15779        MOVE SPACES TO UT8500CA-INPUT-MSG
S15779        STRING "BR0000:(G300) 'MICV' (RE)WRITE ERROR, STAT- "
S15779                DBIO-CALL-STATUS
S15779               ", KEY- " DBIO-CALL-KEY-AREA
S15779            DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S15779        CALL "UT8500" USING UT8500CA-AREA
S15779        GO TO G399-EXIT.
S15779*
S15779 G399-EXIT.
S15779     EXIT.
S15779 G310-CALL-UT5003.
S15779
S15779     INITIALIZE                          UT5003CA-CALL-AREA.
S15779     MOVE WK5003-CALL-CODE       TO      UT5003CA-CALL-CODE.
S15779     MOVE WK5003-ID-NO-G         TO      UT5003CA-ID-NO-G.
S15779     MOVE WK5003-CIF-NO-G        TO      UT5003CA-CIF-NO-G.
S15779     MOVE STRT-AREA-SOC-NO OF STARTAREA  TO  UT5003CA-SOC-NO.
S15779     MOVE SOC-CUST-NO-FORMAT     TO      UT5003CA-CUST-NO-FORMAT.
S15779     MOVE SOC-CHK-DGT            TO      UT5003CA-CHK-DGT.
S15779     CALL "UT5003"               USING   UT5003CA-CALL-AREA.
S15779     IF  UT5003CA-CALL-STATUS        NOT =   0
S15779         MOVE 1                      TO  WA-MSG-ERR-FLAG
S15779         MOVE UT5003CA-ERR-MSG-NO    TO  WA-OUTPUT-ERR-MSG-NO
S15779         MOVE UT8500CA-FUNC-NORMAL-DISPLAY
S15779                                     TO  UT8500CA-CALL-CODE
S15779         MOVE SPACES                 TO  UT8500CA-INPUT-MSG
S15779         STRING "BR0000:(G310) UT5003 CALL ERROR"
S15779                "; ID-"   UT5003CA-ID-NO-G
S15779                "; CIF-"  UT5003CA-CIF-NO-G
S15779                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S15779         CALL "UT8500"   USING       UT8500CA-AREA
S15779     END-IF.
S15779
S15779 G319-EXIT.
S15779     EXIT.
S15779
S15779 G320-ACCESS-MICV.
S15779     CALL "DBIO" USING
S15779                       DBIO-CALL-PARAM
S15779                       MICM-MICV-SYSTEM
S15779                       DBIO-CALL-KEY-AREA
S15779                       DBIO-CALL-STATUS
S15779                       WA-MICV-AREA
S15779                       DBIO-CALL-REFER-AREA.
B19432*S15779     IF DBIO-CALL-STATUS = "XNOT"
B19432     IF DBIO-CALL-STATUS = "HELD"
S15779        DISPLAY "BR0000(G320): MICV HELD KEY - "
S15779                 DBIO-CALL-KEY-AREA
B19392*S15779        CALL "DLAYHERE" USING WA-DELAY-TIME
B19392        CALL "DLAYHERE" USING DLAYHERECA-TIME-10
S15779        DISPLAY "BR0000(G320): TRYING AGAIN "
S15779     END-IF.
S15779 G329-EXIT.
S15779     EXIT.
SC5286 U200-CUSVEE-ACCESS.
090780*
090790      MOVE SPACES TO DBIO-CALL-STATUS.
090800      MOVE "CUSM" TO DBIO-CALL-N-SYS.
090810      MOVE "CUSV" TO DBIO-CALL-SYST-VAR.
090820      CALL "DBIO" USING
090840                  DBIO-CALL-PARAM
090850                  DBIO-CALL-SYS-AREA
090860                  DBIO-CALL-KEY-AREA
090870                  DBIO-CALL-STATUS
090880                  WA-CUSV-AREA-EE
090890                  DBIO-CALL-REFER-AREA
090900                  DBIO-CALL-TXN-TYPE-AREA.
090910*
090920 U299-EXIT.
090930     EXIT.
SC5286*******FAD-END
SC6096 U300-FILL-FORM77.
SC6096     MOVE WA-DISCH-I-ACCT-NO TO VCHR077-ACCT-NO.    
           MOVE WA-DISCH-I-AMOUNT TO VCHR077-TXN-AMT.
SC6542*    MOVE WA-SAVE-BORM-INT-RATE TO VCHR077-RATE.
SC7923*SC7312     IF BORP-ACCT-TYPE = 7103
SC7923     IF BORP-INT-RATE-PRINT = "N"
SC7312        MOVE 0             TO VCHR077-RATE
SC7312     ELSE
SC6542*       PERFORM X710-GET-RATE THRU X719-EXIT                       SC7697
SC6542*       MOVE WA-INT-RATE-A TO VCHR077-RATE                         SC7697
SC7697        MOVE WA-SAVE-BORM-INT-RATE TO VCHR077-RATE
SC7312     END-IF.
           MOVE WA-SAVE-BORM-LOAN-TERM TO VCHR077-TERM.
           MOVE WA-DISCH-I-ACCT-NO TO VCHR077-ACCT-NO
                                      UT0500CA-CUSM-NO
           MOVE 1                 TO UT0500CA-CALL-CODE
           PERFORM V500-CALL-UT0500 THRU V599-EXIT
           IF UT0500RA-CALL-STATUS NOT = 0
              MOVE SPACES TO VCHR077-ACCT-NAME
           ELSE
              MOVE UT0500RA-FULL-NAME TO VCHR077-ACCT-NAME
           END-IF.
SC6714*    IF STRT-AREA-TRN-NO = 13010 OR 13110
SC7187     IF STRT-AREA-TRN-NO = 13010 OR 13110 OR 13011
SC6714        MOVE SPACES TO VCHR075-TRF-ACCT-NME
SC6714     ELSE
              MOVE WA-DEP-TRF-ACCT-NO TO VCHR077-TRF-ACCT-NO
                                         UT0500CA-CUSM-NO
              MOVE 1                  TO UT0500CA-CALL-CODE
              PERFORM V500-CALL-UT0500 THRU V599-EXIT
              IF UT0500RA-CALL-STATUS NOT = 0
                 MOVE SPACES TO VCHR075-TRF-ACCT-NME
              ELSE
                 MOVE UT0500RA-FULL-NAME TO VCHR077-TRF-NAME
              END-IF
SC6714     END-IF.
           MOVE WA-PRINCIPAL-AMT1 TO VCHR077-PRINCIPAL-AMT1.
           MOVE BORM-LOAN-BAL TO VCHR077-PRINCIPAL-AMT2.
S18344*SC7304     IF BORP-YOUBE OR BORP-FINE-METH = 14
S18344     IF BORP-YOUBE OR PROD-CAR-SME
SC7304        IF STRT-AREA-TRN-NO = 13011
SC7304           MOVE 0 TO VCHR077-RATE
SC7304                     VCHR077-TERM
SC7304                     VCHR077-DAYS
SC7304                     VCHR077-DUE-DAYS
SC7304                     VCHR077-PRINCIPAL-AMT1
SC7304                     VCHR077-PRINCIPAL-AMT2
SC7304           MOVE SPACES TO VCHR077-STRT-DATE
SC7304                          VCHR077-END-DATE
SC7304        END-IF
SC7304     END-IF.
SC6096 U399-FORM77-EXIT.
           EXIT.
NR2001*SC6096 N600-SEARCH-BORV-VCRH.
NR2001 N600-SEARCH-BOCT-VCRH.
CS6906*    MOVE BOIS-INST-NO TO BORM-SOC-NO
CS6906*    MOVE WA-DISCH-I-ACCT-NO TO BORM-MEMB-CUST-AC
CS6906*    MOVE SPACES   TO DBIO-CALL-PARAM
CS6906*                     DBIO-CALL-SYS-AREA
CS6906*                     DBIO-CALL-KEY-AREA
CS6906*                     DBIO-CALL-STATUS
CS6906*    MOVE ZERO     TO DBIO-CALL-REFER-AREA
CS6906*    MOVE 07       TO DBIO-CALL-FUNC
CS6906*    MOVE "BOR"    TO DBIO-CALL-SYS
CS6906*    MOVE BORM-KEY TO DBIO-CALL-KEY
CS6906*    MOVE 01       TO DBIO-CALL-TXN-TYPE
CS6906*
CS6906*    MOVE "N"      TO WA-TRN-MATCH-FOUND
CS6906*
SC6548     IF BOIS-PREV-DUE-DATE > 0
SC6548        MOVE BOIS-PREV-DUE-DATE TO WA-SAVE-BORM-ADV-DATE
SC6548     ELSE
SC6548        MOVE BORM-DUE-STRT-DATE TO WA-SAVE-BORM-ADV-DATE
SC6548     END-IF
SC6548     MOVE WA-SAVE-BORM-ADV-DATE TO UT0020-BINARY-DATE
SC6548     MOVE 1        TO UT0020-FUNCTION
SC6548     PERFORM X600-UT0020-PARA THRU X609-EXIT
SC6548     MOVE UT0020-DATE-DDMMCCYY  TO VCHR077-STRT-DATE
SC6096*    MOVE WA-SAVE-BORM-ADV-DATE TO UT0020-BINARY-DATE
SC6096*    MOVE 1        TO UT0020-FUNCTION
SC6096*    PERFORM X600-UT0020-PARA THRU X609-EXIT
SC6096*    MOVE UT0020-DATE-DDMMCCYY TO VCHR077-STRT-DATE
SC6548*    MOVE STRT-AREA-POST-DT
SC6548*                  TO UT0020-BINARY-DATE
SC6548*    MOVE 1        TO UT0020-FUNCTION
SC6548*    PERFORM X600-UT0020-PARA THRU X609-EXIT
SC6548*    MOVE UT0020-DATE-DDMMCCYY TO VCHR077-END-DATE
SC6548     MOVE WA-DISCH-I-TRAN-DATE TO VCHR077-END-DATE
SC6548     MOVE WA-DISCH-I-TRAN-DATE TO UT0030-DATE-DDMMCCYY
SC6548     CALL "UT0030" USING  UT0030-FUNCTION
SC6548                                  UT0030-DATE-AREA
SC6548                                  UT0030-BINARY-DATE
SC6548*    COMPUTE VCHR077-DUE-DAYS = STRT-AREA-POST-DT -
SC6096     IF UT0030-BINARY-DATE = BOIS-MATURITY-DATE
SC6096        MOVE 0 TO  VCHR077-DUE-DAYS
SC6096     ELSE
SC6544      IF UT0030-BINARY-DATE > BOIS-LAST-UNPAID-DUE-DATE
SC6548         COMPUTE VCHR077-DUE-DAYS = UT0030-BINARY-DATE -
                                  BOIS-LAST-UNPAID-DUE-DATE
SC6544      ELSE
SC6544         MOVE 0 TO  VCHR077-DUE-DAYS
SC6544      END-IF
SC6544     END-IF
SC6548*SC6548     IF BOIS-PREV-DUE-DATE > 0
SC6544*SC6548        MOVE BOIS-PREV-DUE-DATE TO WA-SAVE-BORM-ADV-DATE
SC6096*SC6548     ELSE
SC6096*SC6548        MOVE 1        TO UT0020-FUNCTION
SC6096*SC6548        PERFORM X600-UT0020-PARA THRU X609-EXIT
SC6096*SC6548        MOVE UT0020-DATE-DDMMCCYY TO VCHR077-STRT-DATE
SC6544*SC6548     END-IF
           COMPUTE VCHR077-DAYS =
SC6548*               STRT-AREA-POST-DT - WA-SAVE-BORM-ADV-DATE
SC6548                UT0030-BINARY-DATE - WA-SAVE-BORM-ADV-DATE
S16235*           IF STRT-AREA-TRN-NO NOT = 13045 OR 13046
S16235     IF STRT-AREA-TRN-NO NOT = 13045 OR 13046 OR 13047
              MOVE SPACES  TO  VCHR077-TRF-NAME
              MOVE ZEROES  TO  VCHR077-TRF-ACCT-NO
      *       MOVE WA-GLDM-LEDGER-NAME TO VCHR077-TRF-NAME
           ELSE
              MOVE SPACES  TO  VCHR077-TRF-NAME
              MOVE ZEROES  TO  VCHR077-TRF-ACCT-NO
           END-IF
           PERFORM Z680-GET-BUCKET-GLCC
                 THRU Z689-EXIT
CS6906 
CS6906     MOVE BOIS-INST-NO TO BORM-SOC-NO            
CS6906     MOVE WA-DISCH-I-ACCT-NO TO BORM-MEMB-CUST-AC
NR2001*CS6906     MOVE SPACES   TO DBIO-CALL-PARAM            
NR2001*CS6906                      DBIO-CALL-SYS-AREA         
NR2001*CS6906                      DBIO-CALL-KEY-AREA         
NR2001*CS6906                      DBIO-CALL-STATUS           
NR2001*CS6906     MOVE ZERO     TO DBIO-CALL-REFER-AREA       
NR2001*CS6906     MOVE 07       TO DBIO-CALL-FUNC             
NR2001*CS6906     MOVE "BOR"    TO DBIO-CALL-SYS              
NR2001*CS6906     MOVE BORM-KEY TO DBIO-CALL-KEY              
NR2001*CS6906     MOVE 01       TO DBIO-CALL-TXN-TYPE         
NR2001*CS6906                                                 
NR2001*CS6906     MOVE "N"      TO WA-TRN-MATCH-FOUND         
NR2001*CS6906                                                       
NR2001*           PERFORM N700-READ-BORV-VCHR
NR2001     INITIALIZE UTBOCTCA-CALL-AREA.
NR2001     MOVE BORM-SOC-NO       TO BOCT-INST-NO.
NR2001     MOVE BORM-MEMB-CUST-AC TO BOCT-ACCT-NO.
NR2001     MOVE 0                 TO BOCT-REC-NO.
NR2001     MOVE 999999999         TO BOCT-TRN-DATE.
NR2001     MOVE 1                 TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT TO TRUE.
NR2001     MOVE 01                TO WS-BOCT-TRAN-TYPE.
NR2001     MOVE "N"               TO WA-TRN-MATCH-FOUND.         
NR2001     PERFORM N700-READ-BOCT-VCHR
              THRU N799-EXIT
             UNTIL WA-TRN-MATCH-FOUND = "Y".
       N699-EXIT.
           EXIT.
NR2001*SC6096 N700-READ-BORV-VCHR.
NR2001*           CALL "DBIO" USING
NR2001*                       DBIO-CALL-PARAM
NR2001*                       DBIO-CALL-SYS-AREA
NR2001*                       DBIO-CALL-KEY-AREA
NR2001*                       DBIO-CALL-STATUS
NR2001*                       BORV-RECORD-AREA
NR2001*                       DBIO-CALL-REFER-AREA
NR2001*                       DBIO-CALL-TXN-TYPE.
NR2001*           IF (DBIO-CALL-STATUS NOT = "****")
NR2001*              AND (DBIO-CALL-STATUS  =  "XCOT")
NR2001*SC7082        MOVE "Y"          TO WA-TRN-MATCH-FOUND
NR2001*              GO TO N799-EXIT
NR2001*           END-IF.
NR2001*
NR2001*           IF BORV-01-JRNL-NO = STRT-AREA-JRNL-NO
NR2001*             EXHIBIT NAMED BORV-01-TRN-CODE
NR2001*             MOVE BORV-01-TRN-CODE TO WA-BUCKET-TRAN
NR2001*             MOVE BORV-01-AMOUNT TO VCHR077-TXN-AMT
NR2001*             PERFORM Z610-SEARCH-BUCKET-VIA-TRAN
NR2001*                        THRU Z619-EXIT
NR2001*
NR2001*             EXHIBIT NAMED WA-PRIORITY-CDE
NR2001*             EXHIBIT NAMED WA-BUCKET-TRAN
NR2001*             EVALUATE WA-PRIORITY-CDE
NR2001*             WHEN "A"
NR2001*                 COMPUTE VCHR077-PENALTY =
NR2001*                         BORV-01-AMOUNT * -1
NR2001*             WHEN "I"
NR2001*                 COMPUTE VCHR077-INT-AMT =
NR2001*                         BORV-01-AMOUNT * -1
NR2001*             WHEN "L"
NR2001*                 COMPUTE VCHR077-LEGAL-FEE1-DUE =
NR2001*                         BORV-01-AMOUNT * -1
NR2001*             WHEN "M"
NR2001*                 COMPUTE VCHR077-MISC-FEE1 =
NR2001*                         BORV-01-AMOUNT * -1
NR2001*             WHEN "X"
NR2001*                 COMPUTE VCHR077-LEGAL-FEE2-DUE =
NR2001*                         BORV-01-AMOUNT * -1
NR2001*             WHEN "T"
NR2001*                 COMPUTE VCHR077-TEMP-PYMNT-DR  =
NR2001*                         BORV-01-AMOUNT * -1
NR2001*             WHEN "P"
NR2001*                 COMPUTE VCHR077-PRINCIPAL-AMT  =
NR2001*                         BORV-01-AMOUNT * -1
NR2001*             WHEN "R"
NR2001*                 COMPUTE VCHR077-REV-RECEIVABLE =
NR2001*                         BORV-01-AMOUNT * -1
NR2001*             WHEN "Z"
NR2001*                 COMPUTE VCHR077-MISC-FEE2 =
NR2001*                         BORV-01-AMOUNT * -1
NR2001*             WHEN OTHER
NR2001*                 CONTINUE
NR2001*             END-EVALUATE
NR2001*           ELSE
NR2001*              MOVE "Y"          TO WA-TRN-MATCH-FOUND
NR2001*           END-IF.
NR2001*       N799-EXIT.
NR2001*           EXIT.           
NR2001 N700-READ-BOCT-VCHR.
NR2001     MOVE BOCT-INST-NO        TO UTBOCTCA-INST-NO.
NR2001     MOVE BOCT-ACCT-NO        TO UTBOCTCA-ACCT-NO.
NR2001     MOVE BOCT-REC-NO         TO UTBOCTCA-REC-NO.
NR2001     MOVE BOCT-TRN-DATE       TO UTBOCTCA-CALL-DATE.
NR2001     MOVE 1                   TO UTBOCTCA-KEY-NO.
NR2001     SET  UTBOCTCA-READNEXT   TO TRUE.
NR2001     CALL "UTBOCT"         USING UTBOCTCA-CALL-AREA
NR2001                                 BOCT-RECORD-AREA.
NR2001     IF NOT UTBOCTCA-OK
NR2001        MOVE "Y"          TO WA-TRN-MATCH-FOUND
NR2001        GO TO N799-EXIT
NR2001     END-IF.
NR2001     IF BOCT-TRAN-TYPE NOT = WS-BOCT-TRAN-TYPE
NR2001        GO TO N799-EXIT
NR2001     END-IF.
NR2001     IF BOCT-JRNL-NO = STRT-AREA-JRNL-NO
NR2001       EXHIBIT NAMED BOCT-TRN-CODE
NR2001       MOVE BOCT-TRN-CODE  TO WA-BUCKET-TRAN
NR2001       MOVE BOCT-01-AMOUNT TO VCHR077-TXN-AMT             
NR2001       PERFORM Z610-SEARCH-BUCKET-VIA-TRAN
NR2001                  THRU Z619-EXIT
NR2001
NR2001       EXHIBIT NAMED WA-PRIORITY-CDE
NR2001       EXHIBIT NAMED WA-BUCKET-TRAN
NR2001       EVALUATE WA-PRIORITY-CDE
NR2001       WHEN "A"
NR2001           COMPUTE VCHR077-PENALTY =
NR2001                   BOCT-01-AMOUNT * -1
NR2001       WHEN "I"
NR2001           COMPUTE VCHR077-INT-AMT =
NR2001                   BOCT-01-AMOUNT * -1
NR2001       WHEN "L"
NR2001           COMPUTE VCHR077-LEGAL-FEE1-DUE =
NR2001                   BOCT-01-AMOUNT * -1
NR2001       WHEN "M"
NR2001           COMPUTE VCHR077-MISC-FEE1 =
NR2001                   BOCT-01-AMOUNT * -1
NR2001       WHEN "X"
NR2001           COMPUTE VCHR077-LEGAL-FEE2-DUE =
NR2001                   BOCT-01-AMOUNT * -1
NR2001       WHEN "T"
NR2001           COMPUTE VCHR077-TEMP-PYMNT-DR  =
NR2001                   BOCT-01-AMOUNT * -1
NR2001       WHEN "P"
NR2001           COMPUTE VCHR077-PRINCIPAL-AMT  =
NR2001                   BOCT-01-AMOUNT * -1
NR2001       WHEN "R"
NR2001           COMPUTE VCHR077-REV-RECEIVABLE =
NR2001                   BOCT-01-AMOUNT * -1
NR2001       WHEN "Z"
NR2001           COMPUTE VCHR077-MISC-FEE2 =
NR2001                   BOCT-01-AMOUNT * -1
NR2001       WHEN OTHER
NR2001           CONTINUE
NR2001       END-EVALUATE
NR2001     ELSE
NR2001        MOVE "Y"          TO WA-TRN-MATCH-FOUND
NR2001     END-IF.
NR2001 N799-EXIT.
NR2001     EXIT.
S15727 N800-PROCESS-BANK-RATE.
S15727*
S15727     INITIALIZE UTCIEACA-CALL-PARAM.
S15727     SET  UTCIEACA-READ     TO TRUE.
S15727     MOVE BORM-SOC-NO       TO UTCIEACA-SOC-NO.
S15727     MOVE BORM-MEMB-CUST-AC TO UTCIEACA-ACCT-NO.
S15727     MOVE BORM-SYS          TO UTCIEACA-SYSTEM.
S15727     MOVE WS-CIEA-TYPE      TO UTCIEACA-TYPE.
S15727     MOVE ZEROS             TO UTCIEACA-SEQNUM.
S15727*
S15727     CALL "UTCIEA"          USING UTCIEACA-CALL-PARAM
S15727                                  BORM-RECORD-AREA
S15727                                  BOIS-RECORD.
S15727*
S15727     IF ( UTCIEACA-CALL-STATUS NOT = ZEROS )
S15727          GO                TO N800-EXIT
S15727     ELSE
S15727          COMPUTE WS-BANK-RATE =   BORM-STORE-RATE
S15727                               -   UTCIEACA-RATE (1)
S15727                               -   UTCIEACA-RATE (2)
S15727                               -   UTCIEACA-RATE (3)
S15727          IF ( WS-BANK-RATE    <   0 )
S15727               MOVE 0          TO  WS-BANK-RATE
S15727          END-IF
S15727     END-IF.
S15727*
S15727 N800-EXIT.
S15727     EXIT.
SC6376**--
SC6376 O144-CHECK-ACFR.
SC6376
SC6376     INITIALIZE                ACFR-KEY.
SC6376     MOVE STRT-AREA-SOC-NO  TO ACFR-SOC-NO.
SC6376     MOVE "BOR"             TO ACFR-SYSTEM.
SC6376     MOVE BORM-MEMB-CUST-AC TO ACFR-ACCT-NO.
SC6376     MOVE 71                TO DBIO-CALL-FUNC.
SC6376
SC6376     PERFORM G700-ACCESS-ACFR THRU G799-EXIT
SC6376     IF WS-NO-REC-FOUND  = "N"
SC6376        GO TO O144-EXIT
SC6376     ELSE
SC6376        MOVE STRT-AREA-SOC-NO     TO ACFR-SOC-NO
SC6376        MOVE "BOR"                TO ACFR-SYSTEM
SC6376        MOVE BORM-MEMB-CUST-AC    TO ACFR-ACCT-NO
SC6376        MOVE 73                   TO DBIO-CALL-FUNC
SC6376
SC6376        PERFORM G700-ACCESS-ACFR THRU G799-EXIT
SC6376        IF WA-MSG-ERR-FLAG  = 1
SC6376           PERFORM E000-COMPLETION-PARA
SC6376              THRU E099-EXIT
SC6376           GO TO O144-EXIT
SC6376        END-IF
SC6376     END-IF.
SC6376
SC6376 O144-EXIT.
SC6376
S11773 O150-GET-REASON-CODE.
S11773     INITIALIZE RSNC-DATA-KEY.
S11773     MOVE STRT-AREA-SOC-NO            TO RSNC-INST-NO.
S11773     MOVE WA-CANC-REAS-CODE           TO RSNC-REASON-CODE.
S11773
S11773 O150-REASON-READ.
S11773     MOVE "READ"                      TO DBIOMOD-FUNCTION.
S11773     MOVE SPACES                      TO DBIOMOD-STAT.
S11773     MOVE "RSNC"                      TO DBIOMOD-FILE
S11773                                         DBIOMOD-SUFFIX.
S11773     MOVE "DBIO"                      TO DBIOMOD-PREFIX.
S11773     MOVE RSNC-DATA-KEY               TO DBIOMOD-KEY.
S11773     MOVE ZEROES                      TO DBIOMOD-KEY-NO.
S11773     MOVE SPACES                      TO DBIOMOD-RELEASE-LOCK
S11773                                         DBIOMOD-ACCESS-COMMAND
S11773                                         DBIOMOD-ACCESS-COND
S11773                                         DBIOMOD-STATUS.
S11773
S11773     CALL DBIOMODNAME USING
S11773                      DBIOMOD-FILE
S11773                      DBIOMOD-KEY
S11773                      WA-REASON-CODE-REC
S11773                      DBIOMOD-FUNCTION
S11773                      DBIOMOD-KEY-NO
S11773                      DBIOMOD-RELEASE-LOCK
S11773                      DBIOMOD-ACCESS-COMMAND
S11773                      DBIOMOD-ACCESS-COND
S11773                      DBIOMOD-STATUS.
S11773
S11773     IF DBIOMOD-STAT = "MRNF"
S11773        MOVE 4274 TO WA-OUTPUT-ERR-MSG-NO
S11773        MOVE 1    TO WA-MSG-ERR-FLAG
S11773        GO TO O150-EXIT
S11773     END-IF.
S11773
S11773     IF DBIOMOD-STAT NOT = "****"
S11773        MOVE UT8500CA-FUNC-NORMAL-DISPLAY
S11773                                      TO UT8500CA-CALL-CODE
S11773        MOVE SPACES TO UT8500CA-INPUT-MSG
S11773        STRING "BR0000:(O150)"
S11773                " PROBLEM WHILE READING 'RSNC' "
S11773                DBIO-CALL-KEY-AREA " " DBIO-CALL-STATUS
S11773                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
S11773         CALL "UT8500" USING
S11773               UT8500CA-AREA
S11773         MOVE DBIO-CALL-STATUS TO WA-DB-ERROR
S11773         MOVE "RSNC" TO WA-DBERR-DATA-SET
S11773         MOVE 155  TO WA-OUTPUT-ERR-MSG-NO
S11773         MOVE 1    TO WA-MSG-ERR-FLAG
S11773     END-IF.
S11773
S11773 O150-EXIT.
S11773     EXIT.
S11773
SC6376 G700-ACCESS-ACFR.
SC6376
SC6376     MOVE ACFR-KEY          TO DBIO-CALL-KEY-AREA
SC6376     MOVE "ACFR    "        TO DBIO-CALL-SYS-AREA
SC6376     MOVE SPACES            TO DBIO-CALL-STATUS.
SC6376     CALL "DBIO" USING         DBIO-CALL-PARAM
SC6376                               DBIO-CALL-SYS-AREA
SC6376                               DBIO-CALL-KEY-AREA
SC6376                               DBIO-CALL-STATUS
SC6376                               ACFR-AREA
SC6376                               DBIO-CALL-REFER-AREA.
SC6376
SC6376     IF DBIO-CALL-STATUS  = "MRNF"
SC6376        MOVE "N" TO WS-NO-REC-FOUND
SC6376        GO TO G799-EXIT
SC6376     ELSE
SC6376        IF DBIO-CALL-STATUS = "****"
SC6376           MOVE "Y" TO WS-NO-REC-FOUND
SC6376        END-IF
SC6376     END-IF.
SC6376
SC6376     IF DBIO-CALL-STATUS <> "****"
SC6376        MOVE "N"              TO WS-NO-REC-FOUND
SC6376        MOVE 155              TO WA-OUTPUT-ERR-MSG-NO
SC6376        MOVE DBIO-CALL-N-SYS  TO WA-OUTPUT-DATA-SET
SC6376        MOVE DBIO-CALL-STATUS TO WA-OUTPUT-STATUS
SC6376        MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE
SC6376        MOVE SPACES TO UT8500CA-INPUT-MSG
SC6376        STRING "BR0000:(G700) 'ACFR' READ ERROR, STAT- "
SC6376                DBIO-CALL-STATUS ", KEY- "
SC6376                DBIO-CALL-KEY-AREA
SC6376                DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG
SC6376        CALL "UT8500" USING
SC6376                      UT8500CA-AREA
SC6376        MOVE 1 TO WA-MSG-ERR-FLAG
SC6376        GO TO G799-EXIT
SC6376     END-IF.
SC6376
SC6376 G799-EXIT.
SC6376     EXIT.
SC6376**--
ST0081 R000-READ-FACM.
ST0081
ST0081      MOVE STRT-AREA-SOC-NO TO FACM-INST-NO.
ST0081      MOVE ACFR-FACILITY-NO TO FACM-FACILITY-NO.
ST0081
ST0081      MOVE 71       TO DBIO-CALL-FUNC.
ST0081      MOVE "FACM"   TO DBIO-CALL-SYS-AREA.
ST0081      MOVE FACM-KEY TO DBIO-CALL-KEY-AREA.
ST0081      MOVE SPACES   TO DBIO-CALL-STATUS.
ST0081
ST0081      CALL "DBIO" USING DBIO-CALL-PARAM
ST0081                        DBIO-CALL-SYS-AREA
ST0081                        DBIO-CALL-KEY-AREA
ST0081                        DBIO-CALL-STATUS
ST0081                        FACM-AREA.
ST0081
ST0081      IF DBIO-CALL-STATUS NOT = "****"
ST0081         DISPLAY "BR0000: (R000) ERROR READING FACM"
ST0081                 ", KEY = " FACM-KEY
ST0081                 ", STATUS = " DBIO-CALL-STATUS
ST0081         MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
ST0081         MOVE 1   TO WA-MSG-ERR-FLAG
ST0081      END-IF.
ST0081
ST0081 R099-EXIT.
ST0081     EXIT.
ST0081
ST0081 Q000-REVALUATION.
ST0081
SC7541* BOTH REPAYMENT AND DISCHARGE DO NOT NEED REVALUATION
SC7541     IF WA-INPUT-PARAM-TABLE(4) = 1
SC7541     OR WA-INPUT-PARAM-TABLE(25) = 1
SC7541        GO TO Q000-EXIT
SC7541     END-IF.
SC7541*
SC9409*    IF WA-INPUT-PARAM-TABLE(29) = 1
SC9409*       MOVE STRT-AREA-TRN-NO TO WA-UT0060-SAVE-TRAN-NO
SC9409*       MOVE WA-INPUT-KEY-R   TO WA-UT0060-SAVE-ACC-NO
SC9409*    END-IF.
SC7689
ST0081     INITIALIZE WA-DRAWDOWN-TYPE.
ST0081     MOVE FACM-CUSTOMER-NO TO WA-HDR-CUST-NO.
ST0081     PERFORM Q100-READ-FACO-HDR-REC THRU Q100-EXIT.
ST0081     IF UTFACOCA-REVAL-FLAG = "Y"
ST0081        PERFORM Q200-GET-PARENT THRU Q200-EXIT
ST0081        IF WA-MSG-ERR-FLAG = 1
ST0081           GO TO Q000-EXIT
ST0081        END-IF
ST0081        INITIALIZE UTFACRCA-CALL-AREA
ST0081        IF WA-PARENT-CIF-NO = ZEROES
ST0081           MOVE 2                    TO UTFACRCA-CALL-CODE
ST0081           MOVE UTFACOCA-CUSTOMER-NO TO UTFACRCA-CALL-CUST-NO
ST0081        ELSE
ST0081           MOVE 1                TO UTFACRCA-CALL-CODE
ST0081           MOVE WA-PARENT-CIF-NO TO UTFACRCA-CALL-CUST-NO
ST0081        END-IF
ST0081        CALL "UTFACR" USING UTFACRCA-CALL-AREA
ST0081                            STARTAREA
S10389                            MULTI-OVERRIDE-AREA
ST0081        IF UTFACRCA-CALL-STATUS NOT = 0
ST0081           MOVE UTFACRCA-CALL-ERR-MSG-NO
ST0081                  TO WA-OUTPUT-ERR-MSG-NO
ST0081           MOVE 1 TO WA-MSG-ERR-FLAG
ST0081        END-IF
ST0081     END-IF.
ST0081     IF UTFACOCA-REVAL-FLAG = "N"
ST0081        SET WA-NEGATIVE-DRAWDOWN TO TRUE
ST0081        MOVE 4782 TO UT0060CA-CALL-ERROR-CODE
ST0081        PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
ST0081        IF WA-MSG-ERR-FLAG = 0
ST0081           MOVE 4782 TO WA-ERR-MSG-NO
ST0081        ELSE
ST0081           MOVE 4782 TO WA-OUTPUT-ERR-MSG-NO
ST0081           MOVE 1    TO WA-MSG-ERR-FLAG
ST0081        END-IF
ST0081     END-IF.
ST0081     IF UTFACOCA-REVAL-FLAG = "S"
ST0081        SET WA-NEGATIVE-DRAWDOWN TO TRUE
ST0081        INITIALIZE UTFACRCA-CALL-AREA
ST0081        MOVE 2                    TO UTFACRCA-CALL-CODE
ST0081        MOVE UTFACOCA-CUSTOMER-NO TO UTFACRCA-CALL-CUST-NO
ST0081        CALL "UTFACR" USING UTFACRCA-CALL-AREA
ST0081                            STARTAREA
S10389                            MULTI-OVERRIDE-AREA
ST0081        IF UTFACRCA-CALL-STATUS = 0
ST0081           MOVE 4783 TO UT0060CA-CALL-ERROR-CODE
ST0081           PERFORM Y000-OVERRIDABLE-ERROR-CHECK THRU Y090-EXIT
ST0081           IF WA-MSG-ERR-FLAG = 0
ST0081              MOVE 4783 TO WA-ERR-MSG-NO
ST0081           ELSE
ST0081              MOVE 4783 TO WA-OUTPUT-ERR-MSG-NO
ST0081              MOVE 1    TO WA-MSG-ERR-FLAG
ST0081           END-IF
ST0081        ELSE
ST0081           MOVE UTFACRCA-CALL-ERR-MSG-NO
ST0081                  TO WA-OUTPUT-ERR-MSG-NO
ST0081           MOVE 1 TO WA-MSG-ERR-FLAG
ST0081        END-IF
ST0081     END-IF.
ST0081
ST0081 Q000-EXIT.
ST0081     EXIT.
ST0081
ST0081 Q100-READ-FACO-HDR-REC.
ST0081
ST0081     INITIALIZE UTFACOCA-CALL-PARAM.
ST0081     MOVE 01               TO UTFACOCA-CALL-CODE.
ST0081     MOVE ZEROES           TO UTFACOCA-CALL-STATUS
ST0081                              UTFACOCA-CALL-MSG-NO.
ST0081     MOVE STRT-AREA-SOC-NO TO UTFACOCA-CALL-INST-NO.
ST0081     MOVE WA-HDR-CUST-NO   TO UTFACOCA-CALL-CUSTOMER-NO.
ST0081     MOVE 99999999         TO UTFACOCA-CALL-FACILITY-NO.
ST0081     MOVE "HDR"            TO UTFACOCA-CALL-LEVEL1-CODE
ST0081                              UTFACOCA-CALL-LEVEL2-CODE
ST0081                              UTFACOCA-CALL-LEVEL3-CODE
ST0081     MOVE "TWD"            TO UTFACOCA-CALL-CURRENCY.
ST0081
S10104     CALL "UTFACO" USING UTFACOCA-CALL-PARAM
S10104                          STARTAREA
S10104                          MULTI-OVERRIDE-AREA.
ST0081
ST0081     IF UTFACOCA-CALL-STATUS NOT = 0
ST0081        DISPLAY "BR0000:(Q100) FACO HEADER RECORD NOT FOUND"
ST0081        MOVE 869 TO WA-OUTPUT-ERR-MSG-NO
ST0081        MOVE 1   TO WA-MSG-ERR-FLAG
ST0081     END-IF.
ST0081
ST0081 Q100-EXIT.
ST0081     EXIT.
ST0081
ST0081 Q200-GET-PARENT.
ST0081
ST0081     INITIALIZE UT0400-CALL-AREA.
ST0081     MOVE 02               TO UT0400CA-CALL-CODE.
ST0081     MOVE "****"           TO UT0400CA-CALL-STATUS.
ST0081     MOVE "RELM"           TO UT0400CA-RELM-TABLE.
ST0081     MOVE STRT-AREA-SOC-NO TO UT0400CA-RELM-INST-1
ST0081                              UT0400CA-RELM-INST-1-REL.
ST0081     MOVE UTFACOCA-CALL-CUSTOMER-NO
ST0081                           TO UT0400CA-RELM-ID-1.
ST0081     MOVE "CUS"            TO UT0400CA-RELM-ENTITY-1
ST0081                              UT0400CA-RELM-ENTITY-1-REL.
ST0081     MOVE 2101             TO UT0400CA-RELM-RELATIONSHIP-1.
ST0081     MOVE 2                TO UT0400CA-KEY-NO.
ST0081     MOVE 0                TO UT0400CA-RELM-ID-1-REL.
ST0081
ST0081     CALL "UT0400" USING UT0400-CALL-AREA.
ST0081
ST0081     IF UT0400CA-CALL-STATUS = "****"
ST0081        MOVE RELM-ID-1 TO UT0400CA-RELM-ID-1
ST0081     ELSE
ST0081        IF UT0400CA-CALL-STATUS NOT = "RCNF" AND "MRNF"
ST0081           DISPLAY "BR0000: (Q200) UT0400 CALL ERROR"
ST0081           MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
ST0081           MOVE 1   TO WA-MSG-ERR-FLAG
ST0081           GO TO Q200-EXIT
ST0081        END-IF
ST0081     END-IF.
ST0081
ST0081     MOVE 2100   TO UT0400CA-RELM-RELATIONSHIP-1.
ST0081     MOVE SPACES TO UT0400CA-CALL-STATUS.
ST0081
ST0081     CALL "UT0400" USING UT0400-CALL-AREA.
ST0081
ST0081     IF UT0400CA-CALL-STATUS = "****"
ST0081        MOVE RELM-ID-1 TO WA-PARENT-CIF-NO
ST0081     ELSE
ST0081        IF UT0400CA-CALL-STATUS = "RCNF" OR "MRNF"
ST0081           MOVE ZEROES TO WA-PARENT-CIF-NO
ST0081        ELSE
ST0081           DISPLAY "BR0000: (Q200) UT0400 CALL ERROR"
ST0081           MOVE 155 TO WA-OUTPUT-ERR-MSG-NO
ST0081           MOVE 1   TO WA-MSG-ERR-FLAG
ST0081        END-IF
ST0081     END-IF.
ST0081
ST0081 Q200-EXIT.
ST0081      EXIT.
ST0081
S11542                                                          
S11542 Q300-CALC-INT-DIFF.                                      
S11542*------------------                                       
S11542*                                                         
S11542     MOVE 0                          TO WA-INT-RATE-CALC  
S11542                                        WA-INT-FROM-DATE  
S11542                                        WA-INT-TO-DATE    
S11542                                        WA-GRACE-DAYS     
S11542                                        WA-GRACE-INT-DAYS.
S11542     IF BOIS-NEXT-DUE-DATE NOT < STRT-AREA-POST-DT        
S11542        ADD BORM-INT-INCR            TO BORM-INT-ACCR     
S11542     ELSE                                                 
S11542        MOVE BOIS-NEXT-DUE-DATE      TO WA-INT-FROM-DATE  
S11542        MOVE STRT-AREA-POST-DT       TO WA-INT-TO-DATE    
S11542        PERFORM Q320-GET-GRACE-DAYS                       
S11542           THRU Q320-EXIT
S11542        IF WA-GRACE-DAYS > BORP-ARREARS-GRACE-PRD         
S19226           IF BORM-BAD-DEBT-IND(2:1) > 1
S11542              MOVE BOIS-HIGH-INT-RATE   TO WA-INT-RATE-CALC
S19226           ELSE
S19226              MOVE BORM-INT-RATE        TO WA-INT-RATE-CALC
S19226           END-IF
S11542           PERFORM Q310-RECALC-INT-INCR                   
S11542              THRU Q310-EXIT                              
S11542           ADD UT0069CA-LI-INCR      TO BORM-INT-ACCR     
S11542        ELSE                                              
S11542           ADD BORM-INT-INCR         TO BORM-INT-ACCR     
S11542        END-IF                                            
S11542     END-IF.                                              
S11542     IF BOIS-NEXT-DUE-DATE = STRT-AREA-POST-DT            
S17240        COMPUTE WA-WORK-INT-0 ROUNDED = BORM-INT-ACCR
S17240        MOVE WA-WORK-INT-0           TO BOIS-INTEREST-DUE
S17240**S11542   MOVE BORM-INT-ACCR           TO BOIS-INTEREST-DUE
S11542        MOVE ZEROES                  TO BORM-INT-ACCR     
S11542     END-IF.                                              
S11542*                                                         
S11542 Q300-EXIT.                                               
S11542*---------                                                     
S11542     EXIT.                                                     
S11542                                                               
S11542 Q310-RECALC-INT-INCR.                                         
S11542*--------------------                                          
S11542*                                                              
S11542     MOVE 02                     TO UT0069CA-CALL-CODE.        
S11542     MOVE 0                      TO UT0069CA-RET-STATUS.       
S11542     MOVE 0                      TO UT0069CA-FUN-CODE.         
S11542     MOVE BORM-SOC-NO            TO UT0069CA-SOC-NO.           
S11542     MOVE BORM-MEMB-CUST-AC      TO UT0069CA-ACCT-NO.          
S11542     MOVE BORM-ACT-TYPE          TO UT0069CA-ACCT-TYPE.        
S11542     MOVE BORM-CAT               TO UT0069CA-INT-CAT.          
S11542     MOVE 0                      TO UT0069CA-RET-STATUS.       
S11542     MOVE 0                      TO UT0069CA-FUN-CODE.         
S11542     MOVE BORM-STAT              TO UT0069CA-LOAN-STATUS.      
S11542     MOVE BORM-BORR-TYPE         TO UT0069CA-BORR-TYPE.        
S11542     MOVE BORM-PAY-DAY           TO UT0069CA-PAY-DAY.          
S11542     MOVE BORM-CAPN-METHOD       TO UT0069CA-INT-METHOD.       
S11542     MOVE 0                      TO UT0069CA-RT-INCR.          
S11542     MOVE WA-INT-RATE-CALC       TO UT0069CA-LI-RATE.          
S11542     MOVE STRT-AREA-POST-DT      TO UT0069CA-LI-EFF-DATE.      
S11542     MOVE BORP-COMM-INT          TO UT0069CA-CI-RATE.          
S11542     MOVE BORM-LOAN-BAL          TO UT0069CA-LOAN-BAL          
S11542                                    UT0069CA-THEO-LOAN-BAL.    
S11542     MOVE 0                      TO UT0069CA-DEBIT-ARREAR-FLAG.
S11542     ADD  BORM-APP-AMT                                         
S11542          BORM-ADD-LOAN-APP      GIVING UT0069CA-APP-AMT.      
S11542     ADD  BORM-ADV-VAL                                         
S11542          BORM-ADD-LOAN-ADV      GIVING UT0069CA-ADV-AMT.      
S11542     MOVE BORM-PRINC-REDUCT-EFF  TO UT0069CA-PRINC-REDUCT.     
S11542     MOVE BORM-LST-FIN-DATE      TO UT0069CA-LST-FIN-DT.          
S11542     MOVE BORM-APPRV-DATE        TO UT0069CA-APPRV-DT.            
S11542     MOVE BORM-ADV-DATE          TO UT0069CA-ADV-DT.              
S11542     MOVE BORM-DUE-STRT-DATE     TO UT0069CA-DUE-STRT-DATE.       
S11542     MOVE BORM-INT-START-DATE    TO UT0069CA-INT-START-DT.        
NR2001*S11542     MOVE BORM-LAST-BORV-46-DATE TO UT0069CA-LAST-BORV46-DATE.    
NR2001*S11542     MOVE BORV-RECORD-AREA       TO UT0069CA-TRANSACTION.         
NR2001     MOVE BORM-LAST-BORV-46-DATE TO UT0069CA-LAST-BOCT46-DATE.
NR2001     MOVE BOCT-RECORD-AREA       TO UT0069CA-TRANSACTION.
S11542     MOVE 1                      TO UT0069CA-NO-INCR-DAYS.        
S11542     MOVE BORM-INT-ACCR          TO UT0069CA-LI-ACCR.             
S11542     MOVE BORM-BPI-ACCR          TO UT0069CA-BPI-ACCR.            
S11542     MOVE BORM-CI-ACCR           TO UT0069CA-CI-ACCR.             
S11542     MOVE BORM-ARR-INT-ACCR      TO UT0069CA-ARR-ACCR.            
S11542     MOVE ZEROS                  TO UT0069CA-ARR-CALC-BASE.       
S11542     MOVE BORM-TOM-ACRU-AMT      TO UT0069CA-TOM-ACRU.            
S11542     MOVE BORM-INT-ADJUSTMENT                                     
S11542                                 TO UT0069CA-INT-ADJ-AMT.         
S11542     MOVE BORM-FCC-CLUS          TO UT0069CA-FCC-CLUS.            
S11542     MOVE 0                      TO UT0069CA-PREPAY-DISCOUNT-RATE.
S11542                                                                  
S11542     CALL "UT0069"            USING UT0069-LINKAGE.               
S11542                                                                  
S11542     IF UT0069CA-RET-STATUS NOT = 0                               
S11542         SET UT8500CA-NORMAL-DISPLAY TO TRUE                      
S11542         MOVE UT8500CA-FUNC-NORMAL-DISPLAY TO UT8500CA-CALL-CODE  
S11542         MOVE SPACES TO UT8500CA-INPUT-MSG                        
S11542         STRING "BR0000:(Q300) INTEREST NOT CALCULATED FOR CT "   
S11542                 BORM-KEY                                         
S11542             DELIMITED BY SIZE INTO UT8500CA-INPUT-MSG            
S11542         CALL "UT8500" USING  UT8500CA-AREA                       
S11542     END-IF.                                                      
S11542*                                                                 
S11542 Q310-EXIT.                                                  
S11542*---------                                                   
S11542     EXIT.                                                   
S11542                                                             
S11542 Q320-GET-GRACE-DAYS.                                        
S11542*-------------------                                         
S11542*                                                            
S11542     MOVE WA-INT-FROM-DATE    TO UT0020-BINARY-DATE.         
S11542     MOVE 2                   TO UT0020-FUNCTION.            
S11542     CALL "UT0020"         USING UT0020-FUNCTION             
S11542                                 UT0020-DATE-AREA            
S11542                                 UT0020-BINARY-DATE.         
S11542     MOVE UT0020-DATE-CCYYMMDD                               
S11542                           TO UT0310CA-CALENDAR-IN-CCYYMMDD. 
S11542                                                             
S11542     MOVE WA-INT-TO-DATE      TO UT0020-BINARY-DATE.         
S11542     MOVE 2                   TO UT0020-FUNCTION.            
S11542     CALL "UT0020"         USING UT0020-FUNCTION             
S11542                                 UT0020-DATE-AREA            
S11542                                 UT0020-BINARY-DATE.         
S11542     MOVE UT0020-DATE-CCYYMMDD                               
S11542                           TO UT0310CA-CALENDAR-OUT-CCYYMMDD.
S11542                                                             
S11542     MOVE 00               TO UT0310CA-CALENDAR-CODE.        
S11542     MOVE BORM-SOC-NO      TO UT0310CA-SOC-NO.               
S11542     MOVE 03               TO UT0310CA-CALL-FUNC.            
S11542     CALL "UT0310"      USING UT0310CA-REC.                  
S11542     IF UT0310CA-CALL-STATUS = 0                             
S11542        MOVE UT0310CA-WORK-DAYS   TO WA-GRACE-DAYS           
S11542        MOVE UT0310CA-ELAPSE-DAYS TO WA-GRACE-INT-DAYS       
S11542     ELSE                                                    
S11542        MOVE 0                    TO WA-GRACE-DAYS    
S11542                                     WA-GRACE-INT-DAYS
S11542     END-IF.                                          
S11542*                                                     
S11542 Q320-EXIT.                                           
S11542*---------                                            
S11542     EXIT.                                            
S11542                                                      
S12725 Q330-EATM-CHECK-RTN.
S12725     MOVE STRT-AREA-SOC-NO  TO WS-TELM-SOC-NO.
S12725     MOVE STRT-AREA-TELL-NO TO WS-TELM-TELLER.
S12725     MOVE 71                TO WS-TELM-FUNC.
S12725     MOVE SPACES            TO WS-TELM-STATUS-1.
S12725     CALL "DBIO" USING
S12725                               WS-TELM-PARAM
S12725                               WS-TELM-SYS
S12725                               WS-TELM-KEY
S12725                               WS-TELM-STATUS-1
S12725                               TELM-RECORD-AREA.
S12725
S12725     IF WS-TELM-STATUS-1 NOT = "****"
S12725        DISPLAY "BR0000:(Q330) READ TELM ERROR KEY- "
S12725        WS-TELM-KEY ", STAT- " WS-TELM-STATUS-1
S12725        GO                  TO Q330-EXIT
S12725     END-IF.
S12725
S12725 Q330-EXIT.
S12725     EXIT.
S12725
SC8720 B4300-READ-ANUM.
SC8720     CALL "DBIO" USING
SC8720                       DBIO-CALL-PARAM
SC8720                       DBIO-CALL-SYS-AREA
SC8720                       DBIO-CALL-KEY-AREA
SC8720                       DBIO-CALL-STATUS
SC8720                       ANUM-DATA-REC-WA.
SC8720 B4300-EXIT.
SC8720     EXIT.
SC9859 B6100-FIND-WK-DAY.
SC9859     MOVE 0                  TO UT0310CA-CALENDAR-CODE.
SC9859     MOVE ZEROES             TO UT0310CA-CALL-STATUS
SC9859                                UT0310CA-CALENDAR-METHOD.
SC9859     MOVE STRT-AREA-SOC-NO   TO UT0310CA-SOC-NO.
SC9859     CALL "UT0310"        USING UT0310CA-REC.
SC9859*
SC9859     MOVE UT0310CA-CALENDAR-OUT-CCYYMMDD
SC9859                             TO UT0030-DATE-CCYYMMDD.
SC9859     MOVE 2                  TO UT0030-FUNCTION.
SC9859     CALL "UT0030"        USING UT0030-FUNCTION
SC9859                                UT0030-DATE-AREA
SC9859                                UT0030-BINARY-DATE.
SC9859*
SC9859*
SC9859 B6199-EXIT.
SC9859     EXIT.
S15228 B7000-CONV-TXCODE.
S15228     COMPUTE STRT-AREA-TRN-NO = STRT-AREA-TRN-NO - 5000.
S15228     MOVE STRT-AREA-TRN-NO TO LINK-IN-TXCODE.
S15228     PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
S15228     IF  WA-MSG-ERR-FLAG = 1
S15228         GO TO B7000-EXIT
S15228     END-IF.
S15228     MOVE STRT-AREA-POST-DT TO UT0020-BINARY-DATE.
S15228     MOVE 1                 TO UT0020-FUNCTION.
S15228     CALL "UT0020" USING
S15228                               UT0020-FUNCTION
S15228                               UT0020-DATE-AREA
S15228                               UT0020-BINARY-DATE.
S15228     MOVE UT0020-DATE-DDMMCCYY TO WA-REPAY-TXN-DATE.
S15228 B7000-EXIT.
S15228     EXIT.
S18413 B7100-CHNG-TXCODE.
S18413     IF  (BORM-REPAY-SCHED      = "F" OR "G")
S18413     AND  BOIS-MISC-FEE1-DUE    = 0
S18413     AND  BOIS-MISC-FEE2-DUE    = 0
S18413     AND  BOIS-LEGAL-FEE1-DUE   = 0
S18413     AND  BOIS-LEGAL-FEE2-DUE   = 0
S18413     AND  BOIS-PRE-RECEIVABLE   = 0
S18413          NEXT SENTENCE
S18413     ELSE
S18413          GO   TO   B7100-EXIT
S18413     END-IF.
S18413
S18413     COMPUTE WA-UNPAID-TERM     = BORM-LOAN-TRM
S18413                                - BOIS-LAST-TERM-PAID.
S18413     IF BOIS-NEXT-DUE-DATE      < BOIS-MATURITY-DATE
S18413     AND WA-UNPAID-TERM         = 1
S18413     AND (BORM-STAT         NOT = 50)
S18413     AND BORM-1-ADDL-BILLING
S18413         ADD 1                 TO WA-UNPAID-TERM
S18413     END-IF.
S18413     IF  BORM-1-ADDL-BILLING
S18413     AND BOIS-NEXT-DUE-DATE     = BOIS-MATURITY-DATE
S18413     AND WA-UNPAID-TERM     NOT > 1
S18413         ADD 1                 TO WA-UNPAID-TERM
S18413     END-IF.
S18413
S18413     IF  WA-UNPAID-TERM         = 1
S18413     AND WA-REPAY-AMOUNT       >= BORM-LOAN-BAL
S18413         NEXT SENTENCE
S18413     ELSE
S18413         GO   TO   B7100-EXIT
S18413     END-IF.
S18413
S18413     EVALUATE STRT-AREA-TRN-NO
S18413       WHEN 14030
S18413       WHEN 19030
S18413            COMPUTE STRT-AREA-TRN-NO = STRT-AREA-TRN-NO - 2
S18413       WHEN 14045
S18413       WHEN 19045
S18413            COMPUTE STRT-AREA-TRN-NO = STRT-AREA-TRN-NO - 4
S18413       WHEN OTHER
S18413            GO  TO  B7100-EXIT
S18413     END-EVALUATE.
S18413
S18413     MOVE STRT-AREA-TRN-NO        TO WS-REQD-VCHR-TC.
S18413     MOVE STRT-AREA-TRN-NO        TO LINK-IN-TXCODE.
S18413     PERFORM B080-CHANGE-TXCODE THRU B080-EXIT.
S18413     IF  WA-MSG-ERR-FLAG = 1
S18413         GO TO B7100-EXIT
S18413     END-IF.
S18413
S18413     MOVE WA-REPAY-AMOUNT             TO WA-BR0023-DUE-AMT.
S18413     MOVE WA-INPUT-MSG                TO WA-FEP-INPUT-AREA.
S18413     INITIALIZE WA-INPUT-DISCH-MSG.
S18413
S18413     MOVE WA-FEP-INPUT-AREA (1:16)    TO WA-DISCH-I-ACCT-NO.
S18413     MOVE WA-BR0023-DUE-AMT           TO WA-DISCH-I-AMOUNT
S18413                                         WA-SAVE-TXN-AMT.
S18413     MOVE WA-FEP-INPUT-AREA (40:8)    TO WA-DISCH-I-TRAN-DATE.
S18413     MOVE WA-FEP-INPUT-AREA (38:2)    TO WA-DISCH-I-PROMO-CODE.
S18413     MOVE "53"                        TO WA-DISCH-I-REASON-CD.
S18413
S18413     IF WA-INPUT-PARAM-TABLE(29)      =  1
S18413        MOVE WA-FEP-INPUT-AREA(65:16) TO WA-DEP-TRF-ACCT-NO
S18413        MOVE WA-FEP-INPUT-AREA(656:33) TO WA-14041-ATM-INFO
S18413        MOVE "3"                      TO WA-14041-REPAY-SOURCE
S18413        MOVE "3"                      TO WA-14041-LOANER-DATA(1:1)
S18413     ELSE
S18413        MOVE WA-FEP-INPUT-AREA(606:74) TO WA-14028-ATM-INFO
S18413        MOVE "3"                      TO WA-14028-REPAY-SOURCE
S18413        MOVE "3"                      TO WA-14028-LOANER-DATA(1:1)
S18413     END-IF.
S18413 B7100-EXIT.
S18413     EXIT.
NR2001*S10971 FIND-BORV-TYPE-36.
NR2001*S10971     PERFORM DBIO-READ-BORV                      
NR2001*S10971        THRU DBIO-READ-BORV-EXIT.                
NR2001*S10971                                                 
NR2001*S10971     IF DBIO-CALL-STATUS NOT = "****"            
NR2001*S10971        MOVE "Y"         TO WA-TRAN-NO-MORE-FLAG 
NR2001*S10971        GO TO FIND-BORV-TYPE-36-EXIT             
NR2001*S10971     END-IF.                                     
NR2001*S10971                                                 
NR2001*S10971     IF BORV-36-POST-DATE < WA-FIND-TRN-DATE     
NR2001*S10971        MOVE "Y"         TO WA-TRAN-NO-MORE-FLAG 
NR2001*S10971        GO TO FIND-BORV-TYPE-36-EXIT             
NR2001*S10971     END-IF                                      
NR2001*S10971                                                
NR2001*S10971     IF BORV-36-POST-DATE NOT = WA-FIND-TRN-DATE
NR2001*S10971        GO TO FIND-BORV-TYPE-36-EXIT            
NR2001*S10971     END-IF                                     
NR2001*S10971                                                
NR2001*S10971     IF BORV-36-JRNL-NO NOT = WA-FIND-JRNL-NO   
NR2001*S10971        GO TO FIND-BORV-TYPE-36-EXIT            
NR2001*S10971     END-IF                                     
NR2001*S10971                                                
NR2001*S10971     MOVE BORV-36-ACCOUNT-NO TO WA-FIND-ACCT-NO.
NR2001*S10971     MOVE "Y"         TO WA-TRAN-NO-MORE-FLAG.  
NR2001*S10971                                                
NR2001*S10971 FIND-BORV-TYPE-36-EXIT.                        
NR2001*S10971     EXIT.                                      
NR2001 FIND-BOCT-TYPE-36.                              
NR2001     PERFORM DBIO-READ-BOCT
NR2001        THRU DBIO-READ-BOCT-EXIT.
NR2001                                                 
NR2001     IF NOT UTBOCTCA-OK   
NR2001        MOVE "Y"         TO WA-TRAN-NO-MORE-FLAG 
NR2001        GO TO FIND-BOCT-TYPE-36-EXIT             
NR2001     END-IF.                                     
NR2001                                                 
NR2003     IF BOCT-TRN-DATE < WA-FIND-TRN-DATE
NR2003        MOVE "Y"         TO WA-TRAN-NO-MORE-FLAG
NR2003        GO TO FIND-BOCT-TYPE-36-EXIT
NR2003     END-IF
NR2003
NR2001     IF BOCT-TRAN-TYPE NOT = WS-BOCT-TRAN-TYPE
NR2001        GO TO FIND-BOCT-TYPE-36-EXIT
NR2001     END-IF
NR2001
NR2003*NR2001     IF BOCT-TRN-DATE < WA-FIND-TRN-DATE
NR2003*NR2001        MOVE "Y"         TO WA-TRAN-NO-MORE-FLAG
NR2003*NR2001        GO TO FIND-BOCT-TYPE-36-EXIT
NR2003*NR2001     END-IF
NR2001
NR2001     IF BOCT-TRN-DATE NOT = WA-FIND-TRN-DATE
NR2001        GO TO FIND-BOCT-TYPE-36-EXIT            
NR2001     END-IF                                     
NR2001                                                
NR2001     IF BOCT-JRNL-NO NOT = WA-FIND-JRNL-NO   
NR2001        GO TO FIND-BOCT-TYPE-36-EXIT            
NR2001     END-IF                                     
NR2001                                                
NR2001     MOVE BOCT-36-ACCOUNT-NO TO WA-FIND-ACCT-NO.
NR2001     MOVE "Y"         TO WA-TRAN-NO-MORE-FLAG.  
NR2001                                                
NR2001 FIND-BOCT-TYPE-36-EXIT.                        
NR2001     EXIT.
S16503 X900-READ-RENB-RTN.
S16503     MOVE BORM-CUSTOMER-NO        TO RENB-KEY1-CUST-NO.
S16503     MOVE BORM-MEMB-CUST-AC(3:14) TO RENB-KEY1-ACCT-NO.
S16503     MOVE 1                       TO DBIOMOD-KEY-NO.
S16503     MOVE RENB-ALT-KEY-1          TO DBIOMOD-KEY.
S16503     MOVE "READ"                  TO DBIOMOD-FUNCTION.
S16503     MOVE "RENB"                  TO DBIOMOD-FILE
S16503                                     DBIOMOD-SUFFIX.
S16503     MOVE "DBIO"                  TO DBIOMOD-PREFIX.
S16503     MOVE SPACES                  TO DBIOMOD-RELEASE-LOCK
S16503                                     DBIOMOD-ACCESS-COMMAND
S16503                                     DBIOMOD-ACCESS-COND
S16503                                     DBIOMOD-STATUS.
S16503     CALL DBIOMODNAME USING  DBIOMOD-FILE
S16503                             DBIOMOD-KEY
S16503                             WA-RENB-RECORD-AREA
S16503                             DBIOMOD-FUNCTION
S16503                             DBIOMOD-KEY-NO
S16503                             DBIOMOD-RELEASE-LOCK
S16503                             DBIOMOD-ACCESS-COMMAND
S16503                             DBIOMOD-ACCESS-COND
S16503                             DBIOMOD-STATUS.
S16503 X900-EXIT.
S16503     EXIT.
S16503 X910-REPL-COMPONENT.
S16503     MOVE 03                        TO UT0145CA-CALL-CODE.
S16503     MOVE STRT-AREA-SOC-NO          TO UT0145CA-CALL-INST.
S17306**S16503 MOVE 18407                     TO UT0145CA-CALL-TRAN.
S16503     MOVE BORM-ACT-TYPE             TO UT0145CA-CALL-PRODUCT-TYPE.
S16503     MOVE BORM-CAT                  TO UT0145CA-CALL-PRODUCT-CAT.
S16503     CALL "UT0145"               USING UT0145CA-CALL-AREA.
S16503     IF   UT0145CA-CALL-STATUS      =  0
S16503       IF UT0145RA-COMPONENT-1      >  0
S16503          MOVE UT0145RA-COMPONENT-1 TO UT0099CA-COMPONENT-1
S16503       END-IF
S16503       IF UT0145RA-COMPONENT-2      >  0
S16503          MOVE UT0145RA-COMPONENT-2 TO UT0099CA-COMPONENT-2
S16503       END-IF
S16503
S16503       PERFORM NPL-BUILD-CGL      THRU NPL-BUILD-CGL-EXIT
S16503       MOVE UT0099CA-GLCC-OUTPUT-KEY
S16503                                    TO WA-DEST-GL-CLASS-CODE
S17306       IF UT0145RA-COMPONENT-1      >  0
S17306          MOVE UT0145RA-COMPONENT-1-CON TO UT0099CA-COMPONENT-1
S17306       END-IF
S17306       IF UT0145RA-COMPONENT-2      >  0
S17306          MOVE UT0145RA-COMPONENT-2-CON TO UT0099CA-COMPONENT-2
S17306       END-IF
S17306
S17306       PERFORM NPL-BUILD-CGL      THRU NPL-BUILD-CGL-EXIT
S17306       MOVE UT0099CA-GLCC-OUTPUT-KEY
S17306                                     TO WA-GL-CLASS-CODE-D
S16503     END-IF.
S16503 X910-EXIT.
S16503     EXIT.
S17197
S17197 X920-ALBPS-RTN.
S17197
S17197     IF BORP-ALBPS
S17197        IF NOT STRT-BANCSLINK
S17197           MOVE 1    TO WA-MSG-ERR-FLAG
S17197           MOVE 5449 TO WA-OUTPUT-ERR-MSG-NO
S17197           PERFORM E000-COMPLETION-PARA THRU E099-EXIT
S17197           GO TO X920-EXIT
S17197        END-IF
S17197        MOVE 2                  TO UT9000-CALL-CODE
S17197        MOVE SPACES             TO UT9000-CALL-STATUS
S17197        MOVE STRT-AREA-SOC-NO   TO UT9000-INST-NO
S17197        MOVE W-PROGRAM-NAME     TO UT9000-CALLING-ID
S17197        MOVE SOC-LANGUAGE-CODE  TO UT9000-LANGUAGE-CODE
S17197        MOVE 7                  TO UT9000-REPORT-NO
S17197        MOVE 1                  TO UT9000-SEQUENCE-NO
S17197        PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT
S17197        IF UT9000-CALL-STATUS   =  "0"
S17197           MOVE "02"            TO UT0082-CALL-CODE
S17197           MOVE "Y"             TO UT0082-NEW-LINE-FLAG
S17197           MOVE UT9000-SOURCE-LENGTH TO UT0082-MSG-LENGTH
S17197           MOVE UT9000CA-SOURCE-DATA TO UT0082-MSG-TEXT
S17197           CALL "UT0082"     USING UT0082-CALL-AREA
S17197                                   STARTAREA
S17197           IF UT0082-CALL-STATUS = ZEROS
S17197              MOVE "09"         TO UT0082-CALL-CODE
S17197              CALL "UT0082"  USING UT0082-CALL-AREA
S17197                                   STARTAREA
S17197           END-IF
S17197        END-IF
S17197     END-IF.
S17197
S17197 X920-EXIT.
S17197     EXIT.
S17197
S17306 X930-ADD-EXTRA-LOG.
S17306     INITIALIZE BOCT-TRAN-20.
S17306
S17306     MOVE  2                      TO UT9000-CALL-CODE.
S17306     MOVE  SPACES                 TO UT9000-CALL-STATUS.
S17306     MOVE  STRT-AREA-SOC-NO       TO UT9000-INST-NO.
S17306     MOVE  "BR0000"               TO UT9000-CALLING-ID.
S17306     MOVE  SOC-LANGUAGE-CODE      TO UT9000-LANGUAGE-CODE.
S17306     MOVE  1                      TO UT9000-SEQUENCE-NO.
S17306     PERFORM U9100-RETRIEVE-TEXT  THRU U9199-EXIT.
S17306     IF UT9000-CALL-STATUS        =  "0"
S17306        MOVE UT9000CA-SOURCE-DATA TO WA-BONUS-TEXT
S17306     END-IF.
S17306     MOVE WA-20-CHQ-PAYEE         TO BOCT-20-CHQ-PAYEE.
S17306     MOVE 20                      TO BOCT-TRAN-TYPE.
S17306     MOVE 0                       TO BOCT-STAT.
S17306     MOVE STRT-AREA-POST-DT       TO BOCT-TRN-DATE.
S17306     MOVE STRT-AREA-TRN-NO        TO BOCT-TRN-CODE.
S17306     PERFORM W500-ADD-TXN       THRU W599-EXIT.
S17306 X930-EXIT.
S17306     EXIT.
S17808 X940-GRACE-RTN.
S17808
S17808     IF STRT-BANCSLINK
S17808        MOVE 2                  TO UT9000-CALL-CODE
S17808        MOVE SPACES             TO UT9000-CALL-STATUS
S17808        MOVE STRT-AREA-SOC-NO   TO UT9000-INST-NO
S17808        MOVE W-PROGRAM-NAME     TO UT9000-CALLING-ID
S17808        MOVE SOC-LANGUAGE-CODE  TO UT9000-LANGUAGE-CODE
S17808        MOVE 21                 TO UT9000-REPORT-NO
S17808        MOVE 1                  TO UT9000-SEQUENCE-NO
S17808        PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT
S17808        IF UT9000-CALL-STATUS   =  "0"
S17808           MOVE "02"            TO UT0082-CALL-CODE
S17808           MOVE "Y"             TO UT0082-NEW-LINE-FLAG
S17808           MOVE UT9000-SOURCE-LENGTH TO UT0082-MSG-LENGTH
S17808           MOVE UT9000CA-SOURCE-DATA TO UT0082-MSG-TEXT
S17808           CALL "UT0082"     USING UT0082-CALL-AREA
S17808                                   STARTAREA
S17808           IF UT0082-CALL-STATUS = ZEROS
S17808              MOVE "09"         TO UT0082-CALL-CODE
S17808              CALL "UT0082"  USING UT0082-CALL-AREA
S17808                                   STARTAREA
S17808           END-IF
S17808        END-IF
S17808     END-IF.
S17808
S17808 X940-EXIT.
S17808     EXIT.
S19468 X950-ACH-CHECK-RTN.
S19468     INITIALIZE BLDV-AREA-PP.
S19468     INITIALIZE WA-BLDV-PP-ACHDT.
S19468     MOVE WA-BORM-KEY           TO DBIO-CALL-KEY-AREA.
S19468     MOVE "BORMBLDV"            TO DBIO-CALL-SYS-AREA.
S19468     MOVE "PP"                  TO BLDV-PP-TRAN-TYPE
S19468                                   DBIO-CALL-CODE-B.
S19468     MOVE 61                    TO DBIO-CALL-FUNC.
S19468     MOVE 0                     TO DBIO-CALL-REFER-AREA.
S19468     MOVE SPACE                 TO DBIO-CALL-SAVE-REFER.
S19468     MOVE SPACES                TO DBIO-CALL-STATUS.
S19468     CALL "DBIO" USING
S19468                       DBIO-CALL-PARAM
S19468                       DBIO-CALL-SYS-AREA
S19468                       DBIO-CALL-KEY-AREA
S19468                       DBIO-CALL-STATUS
S19468                       BLDV-AREA-PP
S19468                       DBIO-CALL-REFER-AREA
S19468                       DBIO-CALL-CODE-B.
S19468     IF   DBIO-CALL-STATUS = "****"
S19468          IF   BLDV-PP-ACHDT IS NUMERIC
S19468               MOVE BLDV-PP-ACHDT TO WA-BLDV-PP-ACHDT
S19468          ELSE
S19468               GO  TO  X950-EXIT
S19468          END-IF
S19468          IF  (BLDV-PP-FUN = "A" OR BLDV-PP-FUN = "C")
S19468          AND  BLDV-PP-RCODE-REASON = "00"
S19468          AND  STRT-AREA-POST-DT <= WA-BLDV-PP-ACHDT
S19468               PERFORM X951-ACH-POPUP-MSG THRU X951-EXIT
S19468          ELSE
S19468               GO  TO  X950-EXIT
S19468          END-IF
S19468     END-IF.
S19468
S19468 X950-EXIT.
S19468     EXIT.
S19468
S19468 X951-ACH-POPUP-MSG.
S19468     MOVE 2                  TO UT9000-CALL-CODE.
S19468     MOVE SPACES             TO UT9000-CALL-STATUS.
S19468     MOVE STRT-AREA-SOC-NO   TO UT9000-INST-NO.
S19468     MOVE W-PROGRAM-NAME     TO UT9000-CALLING-ID.
S19468     MOVE SOC-LANGUAGE-CODE  TO UT9000-LANGUAGE-CODE.
S19468     MOVE 8                  TO UT9000-REPORT-NO.
S19468     MOVE 1                  TO UT9000-SEQUENCE-NO.
S19468     PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT.
S19468     IF UT9000-CALL-STATUS   =  "0"
S19468        MOVE "02"            TO UT0082-CALL-CODE
S19468        MOVE "Y"             TO UT0082-NEW-LINE-FLAG
S19468        MOVE UT9000-SOURCE-LENGTH TO UT0082-MSG-LENGTH
S19468        MOVE UT9000CA-SOURCE-DATA TO UT0082-MSG-TEXT
S19468        CALL "UT0082"     USING UT0082-CALL-AREA
S19468                                STARTAREA
S19468        IF UT0082-CALL-STATUS = ZEROS
S19468           MOVE "09"         TO UT0082-CALL-CODE
S19468           CALL "UT0082"  USING UT0082-CALL-AREA
S19468                                STARTAREA
S19468        END-IF
S19468     END-IF.
S19468
S19468 X951-EXIT.
S19468     EXIT.
S20487 X953-ACH-POPUP-MSG.
S20487     MOVE 2                  TO UT9000-CALL-CODE.
S20487     MOVE SPACES             TO UT9000-CALL-STATUS.
S20487     MOVE STRT-AREA-SOC-NO   TO UT9000-INST-NO.
S20487     MOVE W-PROGRAM-NAME     TO UT9000-CALLING-ID.
S20487     MOVE SOC-LANGUAGE-CODE  TO UT9000-LANGUAGE-CODE.
S20699     IF   WK-TWO-HOUSE-IND-OK
S20487          MOVE 9             TO UT9000-REPORT-NO.
S20699     IF   WK-ONE-HOUSE-IND-OK
S20699          MOVE 10            TO UT9000-REPORT-NO.
S20487     MOVE 1                  TO UT9000-SEQUENCE-NO.
S20487     PERFORM U9100-RETRIEVE-TEXT THRU U9199-EXIT.
S20487     IF UT9000-CALL-STATUS   =  "0"
S20487        MOVE "02"            TO UT0082-CALL-CODE
S20487        MOVE "Y"             TO UT0082-NEW-LINE-FLAG
S20487        MOVE UT9000-SOURCE-LENGTH TO UT0082-MSG-LENGTH
S20487        MOVE UT9000CA-SOURCE-DATA TO UT0082-MSG-TEXT
S20487        CALL "UT0082"     USING UT0082-CALL-AREA
S20487                                STARTAREA
S20487        IF UT0082-CALL-STATUS = ZEROS
S20487           MOVE "09"         TO UT0082-CALL-CODE
S20487           CALL "UT0082"  USING UT0082-CALL-AREA
S20487                                STARTAREA
S20487        END-IF
S20487     END-IF.
S20487 X953-EXIT.
S20487     EXIT.
S18577 X9000-CHK-YB-RTN.
S18577     IF  ( BORM-ACT-TYPE(1:2)        =  71 OR 72 OR 73 )
S18577     OR  ( BORM-ACT-TYPE             =  7501 )
S18577      IF ((BORM-MEMB-CUST-AC(3:1)    =  0
S18577      AND  BORM-MEMB-CUST-AC(6:2)    =  51
S18577      AND  BORM-MEMB-CUST-AC(15:2)   =  66)
S18577      OR  (BORM-MEMB-CUST-AC(3:1)    =  2
S18577      AND  BORM-MEMB-CUST-AC(7:2)    =  66))
S18577          SET WA-YOUBE-PROD          TO TRUE
S18577      END-IF
S18577     END-IF.
S18577 X9000-EXIT.
S18577     EXIT.
